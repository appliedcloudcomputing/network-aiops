var Du=Object.defineProperty;var Mu=(e,t,n)=>t in e?Du(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ns=(e,t,n)=>Mu(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function Gu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lc={exports:{}},Va={},cc={exports:{}},F={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jr=Symbol.for("react.element"),Vu=Symbol.for("react.portal"),Hu=Symbol.for("react.fragment"),Fu=Symbol.for("react.strict_mode"),Wu=Symbol.for("react.profiler"),Uu=Symbol.for("react.provider"),zu=Symbol.for("react.context"),$u=Symbol.for("react.forward_ref"),Bu=Symbol.for("react.suspense"),Zu=Symbol.for("react.memo"),qu=Symbol.for("react.lazy"),Mi=Symbol.iterator;function Ku(e){return e===null||typeof e!="object"?null:(e=Mi&&e[Mi]||e["@@iterator"],typeof e=="function"?e:null)}var dc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uc=Object.assign,pc={};function Gn(e,t,n){this.props=e,this.context=t,this.refs=pc,this.updater=n||dc}Gn.prototype.isReactComponent={};Gn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Gn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function mc(){}mc.prototype=Gn.prototype;function Mo(e,t,n){this.props=e,this.context=t,this.refs=pc,this.updater=n||dc}var Go=Mo.prototype=new mc;Go.constructor=Mo;uc(Go,Gn.prototype);Go.isPureReactComponent=!0;var Gi=Array.isArray,gc=Object.prototype.hasOwnProperty,Vo={current:null},fc={key:!0,ref:!0,__self:!0,__source:!0};function hc(e,t,n){var a,s={},o=null,i=null;if(t!=null)for(a in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)gc.call(t,a)&&!fc.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps,l)s[a]===void 0&&(s[a]=l[a]);return{$$typeof:jr,type:e,key:o,ref:i,props:s,_owner:Vo.current}}function Qu(e,t){return{$$typeof:jr,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ho(e){return typeof e=="object"&&e!==null&&e.$$typeof===jr}function Yu(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Vi=/\/+/g;function rs(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Yu(""+e.key):t.toString(36)}function na(e,t,n,a,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case jr:case Vu:i=!0}}if(i)return i=e,s=s(i),e=a===""?"."+rs(i,0):a,Gi(s)?(n="",e!=null&&(n=e.replace(Vi,"$&/")+"/"),na(s,t,n,"",function(d){return d})):s!=null&&(Ho(s)&&(s=Qu(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Vi,"$&/")+"/")+e)),t.push(s)),1;if(i=0,a=a===""?".":a+":",Gi(e))for(var l=0;l<e.length;l++){o=e[l];var c=a+rs(o,l);i+=na(o,t,n,c,s)}else if(c=Ku(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=a+rs(o,l++),i+=na(o,t,n,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Or(e,t,n){if(e==null)return e;var a=[],s=0;return na(e,a,"","",function(o){return t.call(n,o,s++)}),a}function Xu(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var we={current:null},ra={transition:null},Ju={ReactCurrentDispatcher:we,ReactCurrentBatchConfig:ra,ReactCurrentOwner:Vo};function _c(){throw Error("act(...) is not supported in production builds of React.")}F.Children={map:Or,forEach:function(e,t,n){Or(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Or(e,function(){t++}),t},toArray:function(e){return Or(e,function(t){return t})||[]},only:function(e){if(!Ho(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};F.Component=Gn;F.Fragment=Hu;F.Profiler=Wu;F.PureComponent=Mo;F.StrictMode=Fu;F.Suspense=Bu;F.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ju;F.act=_c;F.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=uc({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Vo.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)gc.call(t,c)&&!fc.hasOwnProperty(c)&&(a[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:jr,type:e.type,key:s,ref:o,props:a,_owner:i}};F.createContext=function(e){return e={$$typeof:zu,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Uu,_context:e},e.Consumer=e};F.createElement=hc;F.createFactory=function(e){var t=hc.bind(null,e);return t.type=e,t};F.createRef=function(){return{current:null}};F.forwardRef=function(e){return{$$typeof:$u,render:e}};F.isValidElement=Ho;F.lazy=function(e){return{$$typeof:qu,_payload:{_status:-1,_result:e},_init:Xu}};F.memo=function(e,t){return{$$typeof:Zu,type:e,compare:t===void 0?null:t}};F.startTransition=function(e){var t=ra.transition;ra.transition={};try{e()}finally{ra.transition=t}};F.unstable_act=_c;F.useCallback=function(e,t){return we.current.useCallback(e,t)};F.useContext=function(e){return we.current.useContext(e)};F.useDebugValue=function(){};F.useDeferredValue=function(e){return we.current.useDeferredValue(e)};F.useEffect=function(e,t){return we.current.useEffect(e,t)};F.useId=function(){return we.current.useId()};F.useImperativeHandle=function(e,t,n){return we.current.useImperativeHandle(e,t,n)};F.useInsertionEffect=function(e,t){return we.current.useInsertionEffect(e,t)};F.useLayoutEffect=function(e,t){return we.current.useLayoutEffect(e,t)};F.useMemo=function(e,t){return we.current.useMemo(e,t)};F.useReducer=function(e,t,n){return we.current.useReducer(e,t,n)};F.useRef=function(e){return we.current.useRef(e)};F.useState=function(e){return we.current.useState(e)};F.useSyncExternalStore=function(e,t,n){return we.current.useSyncExternalStore(e,t,n)};F.useTransition=function(){return we.current.useTransition()};F.version="18.3.1";cc.exports=F;var _=cc.exports;const ep=Gu(_);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tp=_,np=Symbol.for("react.element"),rp=Symbol.for("react.fragment"),ap=Object.prototype.hasOwnProperty,sp=tp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,op={key:!0,ref:!0,__self:!0,__source:!0};function yc(e,t,n){var a,s={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)ap.call(t,a)&&!op.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:np,type:e,key:o,ref:i,props:s,_owner:sp.current}}Va.Fragment=rp;Va.jsx=yc;Va.jsxs=yc;lc.exports=Va;var r=lc.exports,Fs={},vc={exports:{}},Re={},xc={exports:{}},bc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,D){var V=P.length;P.push(D);e:for(;0<V;){var ee=V-1>>>1,ie=P[ee];if(0<s(ie,D))P[ee]=D,P[V]=ie,V=ee;else break e}}function n(P){return P.length===0?null:P[0]}function a(P){if(P.length===0)return null;var D=P[0],V=P.pop();if(V!==D){P[0]=V;e:for(var ee=0,ie=P.length,Lr=ie>>>1;ee<Lr;){var Mt=2*(ee+1)-1,ts=P[Mt],Gt=Mt+1,Rr=P[Gt];if(0>s(ts,V))Gt<ie&&0>s(Rr,ts)?(P[ee]=Rr,P[Gt]=V,ee=Gt):(P[ee]=ts,P[Mt]=V,ee=Mt);else if(Gt<ie&&0>s(Rr,V))P[ee]=Rr,P[Gt]=V,ee=Gt;else break e}}return D}function s(P,D){var V=P.sortIndex-D.sortIndex;return V!==0?V:P.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,m=null,g=3,v=!1,b=!1,y=!1,O=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(P){for(var D=n(d);D!==null;){if(D.callback===null)a(d);else if(D.startTime<=P)a(d),D.sortIndex=D.expirationTime,t(c,D);else break;D=n(d)}}function w(P){if(y=!1,f(P),!b)if(n(c)!==null)b=!0,M(S);else{var D=n(d);D!==null&&de(w,D.startTime-P)}}function S(P,D){b=!1,y&&(y=!1,h(I),I=-1),v=!0;var V=g;try{for(f(D),m=n(c);m!==null&&(!(m.expirationTime>D)||P&&!H());){var ee=m.callback;if(typeof ee=="function"){m.callback=null,g=m.priorityLevel;var ie=ee(m.expirationTime<=D);D=e.unstable_now(),typeof ie=="function"?m.callback=ie:m===n(c)&&a(c),f(D)}else a(c);m=n(c)}if(m!==null)var Lr=!0;else{var Mt=n(d);Mt!==null&&de(w,Mt.startTime-D),Lr=!1}return Lr}finally{m=null,g=V,v=!1}}var k=!1,A=null,I=-1,T=5,E=-1;function H(){return!(e.unstable_now()-E<T)}function U(){if(A!==null){var P=e.unstable_now();E=P;var D=!0;try{D=A(!0,P)}finally{D?N():(k=!1,A=null)}}else k=!1}var N;if(typeof p=="function")N=function(){p(U)};else if(typeof MessageChannel<"u"){var x=new MessageChannel,j=x.port2;x.port1.onmessage=U,N=function(){j.postMessage(null)}}else N=function(){O(U,0)};function M(P){A=P,k||(k=!0,N())}function de(P,D){I=O(function(){P(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){b||v||(b=!0,M(S))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(P){switch(g){case 1:case 2:case 3:var D=3;break;default:D=g}var V=g;g=D;try{return P()}finally{g=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,D){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var V=g;g=P;try{return D()}finally{g=V}},e.unstable_scheduleCallback=function(P,D,V){var ee=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?ee+V:ee):V=ee,P){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=V+ie,P={id:u++,callback:D,priorityLevel:P,startTime:V,expirationTime:ie,sortIndex:-1},V>ee?(P.sortIndex=V,t(d,P),n(c)===null&&P===n(d)&&(y?(h(I),I=-1):y=!0,de(w,V-ee))):(P.sortIndex=ie,t(c,P),b||v||(b=!0,M(S))),P},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(P){var D=g;return function(){var V=g;g=D;try{return P.apply(this,arguments)}finally{g=V}}}})(bc);xc.exports=bc;var ip=xc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lp=_,Le=ip;function C(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wc=new Set,ur={};function rn(e,t){En(e,t),En(e+"Capture",t)}function En(e,t){for(ur[e]=t,e=0;e<t.length;e++)wc.add(t[e])}var ut=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ws=Object.prototype.hasOwnProperty,cp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hi={},Fi={};function dp(e){return Ws.call(Fi,e)?!0:Ws.call(Hi,e)?!1:cp.test(e)?Fi[e]=!0:(Hi[e]=!0,!1)}function up(e,t,n,a){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function pp(e,t,n,a){if(t===null||typeof t>"u"||up(e,t,n,a))return!0;if(a)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Se(e,t,n,a,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var ge={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ge[e]=new Se(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ge[t]=new Se(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ge[e]=new Se(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ge[e]=new Se(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ge[e]=new Se(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ge[e]=new Se(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ge[e]=new Se(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ge[e]=new Se(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ge[e]=new Se(e,5,!1,e.toLowerCase(),null,!1,!1)});var Fo=/[\-:]([a-z])/g;function Wo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Fo,Wo);ge[t]=new Se(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Fo,Wo);ge[t]=new Se(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Fo,Wo);ge[t]=new Se(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ge[e]=new Se(e,1,!1,e.toLowerCase(),null,!1,!1)});ge.xlinkHref=new Se("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ge[e]=new Se(e,1,!1,e.toLowerCase(),null,!0,!0)});function Uo(e,t,n,a){var s=ge.hasOwnProperty(t)?ge[t]:null;(s!==null?s.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(pp(t,n,s,a)&&(n=null),a||s===null?dp(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,a=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}var ft=lp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dr=Symbol.for("react.element"),pn=Symbol.for("react.portal"),mn=Symbol.for("react.fragment"),zo=Symbol.for("react.strict_mode"),Us=Symbol.for("react.profiler"),Sc=Symbol.for("react.provider"),kc=Symbol.for("react.context"),$o=Symbol.for("react.forward_ref"),zs=Symbol.for("react.suspense"),$s=Symbol.for("react.suspense_list"),Bo=Symbol.for("react.memo"),yt=Symbol.for("react.lazy"),Cc=Symbol.for("react.offscreen"),Wi=Symbol.iterator;function Fn(e){return e===null||typeof e!="object"?null:(e=Wi&&e[Wi]||e["@@iterator"],typeof e=="function"?e:null)}var Y=Object.assign,as;function Qn(e){if(as===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);as=t&&t[1]||""}return`
`+as+e}var ss=!1;function os(e,t){if(!e||ss)return"";ss=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var a=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){a=d}e.call(t.prototype)}else{try{throw Error()}catch(d){a=d}e()}}catch(d){if(d&&a&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=a.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{ss=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Qn(e):""}function mp(e){switch(e.tag){case 5:return Qn(e.type);case 16:return Qn("Lazy");case 13:return Qn("Suspense");case 19:return Qn("SuspenseList");case 0:case 2:case 15:return e=os(e.type,!1),e;case 11:return e=os(e.type.render,!1),e;case 1:return e=os(e.type,!0),e;default:return""}}function Bs(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case mn:return"Fragment";case pn:return"Portal";case Us:return"Profiler";case zo:return"StrictMode";case zs:return"Suspense";case $s:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case kc:return(e.displayName||"Context")+".Consumer";case Sc:return(e._context.displayName||"Context")+".Provider";case $o:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bo:return t=e.displayName||null,t!==null?t:Bs(e.type)||"Memo";case yt:t=e._payload,e=e._init;try{return Bs(e(t))}catch{}}return null}function gp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bs(t);case 8:return t===zo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function It(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ac(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fp(e){var t=Ac(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){a=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(i){a=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Mr(e){e._valueTracker||(e._valueTracker=fp(e))}function Nc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=Ac(e)?e.checked?"true":"false":e.value),e=a,e!==n?(t.setValue(e),!0):!1}function fa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Zs(e,t){var n=t.checked;return Y({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Ui(e,t){var n=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;n=It(t.value!=null?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jc(e,t){t=t.checked,t!=null&&Uo(e,"checked",t,!1)}function qs(e,t){jc(e,t);var n=It(t.value),a=t.type;if(n!=null)a==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ks(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ks(e,t.type,It(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function zi(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ks(e,t,n){(t!=="number"||fa(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Yn=Array.isArray;function kn(e,t,n,a){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&a&&(e[n].defaultSelected=!0)}else{for(n=""+It(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,a&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Qs(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(C(91));return Y({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $i(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(C(92));if(Yn(n)){if(1<n.length)throw Error(C(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:It(n)}}function Tc(e,t){var n=It(t.value),a=It(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),a!=null&&(e.defaultValue=""+a)}function Bi(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ec(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ys(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ec(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gr,Pc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,a,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,a,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gr=Gr||document.createElement("div"),Gr.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var tr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hp=["Webkit","ms","Moz","O"];Object.keys(tr).forEach(function(e){hp.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),tr[t]=tr[e]})});function Ic(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||tr.hasOwnProperty(e)&&tr[e]?(""+t).trim():t+"px"}function Lc(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var a=n.indexOf("--")===0,s=Ic(n,t[n],a);n==="float"&&(n="cssFloat"),a?e.setProperty(n,s):e[n]=s}}var _p=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xs(e,t){if(t){if(_p[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(C(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(C(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(C(61))}if(t.style!=null&&typeof t.style!="object")throw Error(C(62))}}function Js(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eo=null;function Zo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var to=null,Cn=null,An=null;function Zi(e){if(e=Pr(e)){if(typeof to!="function")throw Error(C(280));var t=e.stateNode;t&&(t=za(t),to(e.stateNode,e.type,t))}}function Rc(e){Cn?An?An.push(e):An=[e]:Cn=e}function Oc(){if(Cn){var e=Cn,t=An;if(An=Cn=null,Zi(e),t)for(e=0;e<t.length;e++)Zi(t[e])}}function Dc(e,t){return e(t)}function Mc(){}var is=!1;function Gc(e,t,n){if(is)return e(t,n);is=!0;try{return Dc(e,t,n)}finally{is=!1,(Cn!==null||An!==null)&&(Mc(),Oc())}}function mr(e,t){var n=e.stateNode;if(n===null)return null;var a=za(n);if(a===null)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(C(231,t,typeof n));return n}var no=!1;if(ut)try{var Wn={};Object.defineProperty(Wn,"passive",{get:function(){no=!0}}),window.addEventListener("test",Wn,Wn),window.removeEventListener("test",Wn,Wn)}catch{no=!1}function yp(e,t,n,a,s,o,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(u){this.onError(u)}}var nr=!1,ha=null,_a=!1,ro=null,vp={onError:function(e){nr=!0,ha=e}};function xp(e,t,n,a,s,o,i,l,c){nr=!1,ha=null,yp.apply(vp,arguments)}function bp(e,t,n,a,s,o,i,l,c){if(xp.apply(this,arguments),nr){if(nr){var d=ha;nr=!1,ha=null}else throw Error(C(198));_a||(_a=!0,ro=d)}}function an(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Vc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qi(e){if(an(e)!==e)throw Error(C(188))}function wp(e){var t=e.alternate;if(!t){if(t=an(e),t===null)throw Error(C(188));return t!==e?null:e}for(var n=e,a=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(a=s.return,a!==null){n=a;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return qi(s),e;if(o===a)return qi(s),t;o=o.sibling}throw Error(C(188))}if(n.return!==a.return)n=s,a=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,a=o;break}if(l===a){i=!0,a=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,a=s;break}if(l===a){i=!0,a=o,n=s;break}l=l.sibling}if(!i)throw Error(C(189))}}if(n.alternate!==a)throw Error(C(190))}if(n.tag!==3)throw Error(C(188));return n.stateNode.current===n?e:t}function Hc(e){return e=wp(e),e!==null?Fc(e):null}function Fc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Fc(e);if(t!==null)return t;e=e.sibling}return null}var Wc=Le.unstable_scheduleCallback,Ki=Le.unstable_cancelCallback,Sp=Le.unstable_shouldYield,kp=Le.unstable_requestPaint,te=Le.unstable_now,Cp=Le.unstable_getCurrentPriorityLevel,qo=Le.unstable_ImmediatePriority,Uc=Le.unstable_UserBlockingPriority,ya=Le.unstable_NormalPriority,Ap=Le.unstable_LowPriority,zc=Le.unstable_IdlePriority,Ha=null,nt=null;function Np(e){if(nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(Ha,e,void 0,(e.current.flags&128)===128)}catch{}}var qe=Math.clz32?Math.clz32:Ep,jp=Math.log,Tp=Math.LN2;function Ep(e){return e>>>=0,e===0?32:31-(jp(e)/Tp|0)|0}var Vr=64,Hr=4194304;function Xn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function va(e,t){var n=e.pendingLanes;if(n===0)return 0;var a=0,s=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?a=Xn(l):(o&=i,o!==0&&(a=Xn(o)))}else i=n&~s,i!==0?a=Xn(i):o!==0&&(a=Xn(o));if(a===0)return 0;if(t!==0&&t!==a&&!(t&s)&&(s=a&-a,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(a&4&&(a|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)n=31-qe(t),s=1<<n,a|=e[n],t&=~s;return a}function Pp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ip(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-qe(o),l=1<<i,c=s[i];c===-1?(!(l&n)||l&a)&&(s[i]=Pp(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function ao(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $c(){var e=Vr;return Vr<<=1,!(Vr&4194240)&&(Vr=64),e}function ls(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Tr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qe(t),e[t]=n}function Lp(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-qe(n),o=1<<s;t[s]=0,a[s]=-1,e[s]=-1,n&=~o}}function Ko(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-qe(n),s=1<<a;s&t|e[a]&t&&(e[a]|=t),n&=~s}}var z=0;function Bc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Zc,Qo,qc,Kc,Qc,so=!1,Fr=[],kt=null,Ct=null,At=null,gr=new Map,fr=new Map,xt=[],Rp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qi(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":gr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fr.delete(t.pointerId)}}function Un(e,t,n,a,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:o,targetContainers:[s]},t!==null&&(t=Pr(t),t!==null&&Qo(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Op(e,t,n,a,s){switch(t){case"focusin":return kt=Un(kt,e,t,n,a,s),!0;case"dragenter":return Ct=Un(Ct,e,t,n,a,s),!0;case"mouseover":return At=Un(At,e,t,n,a,s),!0;case"pointerover":var o=s.pointerId;return gr.set(o,Un(gr.get(o)||null,e,t,n,a,s)),!0;case"gotpointercapture":return o=s.pointerId,fr.set(o,Un(fr.get(o)||null,e,t,n,a,s)),!0}return!1}function Yc(e){var t=zt(e.target);if(t!==null){var n=an(t);if(n!==null){if(t=n.tag,t===13){if(t=Vc(n),t!==null){e.blockedOn=t,Qc(e.priority,function(){qc(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function aa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=oo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var a=new n.constructor(n.type,n);eo=a,n.target.dispatchEvent(a),eo=null}else return t=Pr(n),t!==null&&Qo(t),e.blockedOn=n,!1;t.shift()}return!0}function Yi(e,t,n){aa(e)&&n.delete(t)}function Dp(){so=!1,kt!==null&&aa(kt)&&(kt=null),Ct!==null&&aa(Ct)&&(Ct=null),At!==null&&aa(At)&&(At=null),gr.forEach(Yi),fr.forEach(Yi)}function zn(e,t){e.blockedOn===t&&(e.blockedOn=null,so||(so=!0,Le.unstable_scheduleCallback(Le.unstable_NormalPriority,Dp)))}function hr(e){function t(s){return zn(s,e)}if(0<Fr.length){zn(Fr[0],e);for(var n=1;n<Fr.length;n++){var a=Fr[n];a.blockedOn===e&&(a.blockedOn=null)}}for(kt!==null&&zn(kt,e),Ct!==null&&zn(Ct,e),At!==null&&zn(At,e),gr.forEach(t),fr.forEach(t),n=0;n<xt.length;n++)a=xt[n],a.blockedOn===e&&(a.blockedOn=null);for(;0<xt.length&&(n=xt[0],n.blockedOn===null);)Yc(n),n.blockedOn===null&&xt.shift()}var Nn=ft.ReactCurrentBatchConfig,xa=!0;function Mp(e,t,n,a){var s=z,o=Nn.transition;Nn.transition=null;try{z=1,Yo(e,t,n,a)}finally{z=s,Nn.transition=o}}function Gp(e,t,n,a){var s=z,o=Nn.transition;Nn.transition=null;try{z=4,Yo(e,t,n,a)}finally{z=s,Nn.transition=o}}function Yo(e,t,n,a){if(xa){var s=oo(e,t,n,a);if(s===null)ys(e,t,a,ba,n),Qi(e,a);else if(Op(s,e,t,n,a))a.stopPropagation();else if(Qi(e,a),t&4&&-1<Rp.indexOf(e)){for(;s!==null;){var o=Pr(s);if(o!==null&&Zc(o),o=oo(e,t,n,a),o===null&&ys(e,t,a,ba,n),o===s)break;s=o}s!==null&&a.stopPropagation()}else ys(e,t,a,null,n)}}var ba=null;function oo(e,t,n,a){if(ba=null,e=Zo(a),e=zt(e),e!==null)if(t=an(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Vc(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ba=e,null}function Xc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cp()){case qo:return 1;case Uc:return 4;case ya:case Ap:return 16;case zc:return 536870912;default:return 16}default:return 16}}var wt=null,Xo=null,sa=null;function Jc(){if(sa)return sa;var e,t=Xo,n=t.length,a,s="value"in wt?wt.value:wt.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(a=1;a<=i&&t[n-a]===s[o-a];a++);return sa=s.slice(e,1<a?1-a:void 0)}function oa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Wr(){return!0}function Xi(){return!1}function Oe(e){function t(n,a,s,o,i){this._reactName=n,this._targetInst=s,this.type=a,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Wr:Xi,this.isPropagationStopped=Xi,this}return Y(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wr)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wr)},persist:function(){},isPersistent:Wr}),t}var Vn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jo=Oe(Vn),Er=Y({},Vn,{view:0,detail:0}),Vp=Oe(Er),cs,ds,$n,Fa=Y({},Er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ei,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$n&&($n&&e.type==="mousemove"?(cs=e.screenX-$n.screenX,ds=e.screenY-$n.screenY):ds=cs=0,$n=e),cs)},movementY:function(e){return"movementY"in e?e.movementY:ds}}),Ji=Oe(Fa),Hp=Y({},Fa,{dataTransfer:0}),Fp=Oe(Hp),Wp=Y({},Er,{relatedTarget:0}),us=Oe(Wp),Up=Y({},Vn,{animationName:0,elapsedTime:0,pseudoElement:0}),zp=Oe(Up),$p=Y({},Vn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Bp=Oe($p),Zp=Y({},Vn,{data:0}),el=Oe(Zp),qp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Qp[e])?!!t[e]:!1}function ei(){return Yp}var Xp=Y({},Er,{key:function(e){if(e.key){var t=qp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=oa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Kp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ei,charCode:function(e){return e.type==="keypress"?oa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?oa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Jp=Oe(Xp),e0=Y({},Fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tl=Oe(e0),t0=Y({},Er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ei}),n0=Oe(t0),r0=Y({},Vn,{propertyName:0,elapsedTime:0,pseudoElement:0}),a0=Oe(r0),s0=Y({},Fa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),o0=Oe(s0),i0=[9,13,27,32],ti=ut&&"CompositionEvent"in window,rr=null;ut&&"documentMode"in document&&(rr=document.documentMode);var l0=ut&&"TextEvent"in window&&!rr,ed=ut&&(!ti||rr&&8<rr&&11>=rr),nl=" ",rl=!1;function td(e,t){switch(e){case"keyup":return i0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var gn=!1;function c0(e,t){switch(e){case"compositionend":return nd(t);case"keypress":return t.which!==32?null:(rl=!0,nl);case"textInput":return e=t.data,e===nl&&rl?null:e;default:return null}}function d0(e,t){if(gn)return e==="compositionend"||!ti&&td(e,t)?(e=Jc(),sa=Xo=wt=null,gn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ed&&t.locale!=="ko"?null:t.data;default:return null}}var u0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function al(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!u0[e.type]:t==="textarea"}function rd(e,t,n,a){Rc(a),t=wa(t,"onChange"),0<t.length&&(n=new Jo("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var ar=null,_r=null;function p0(e){gd(e,0)}function Wa(e){var t=_n(e);if(Nc(t))return e}function m0(e,t){if(e==="change")return t}var ad=!1;if(ut){var ps;if(ut){var ms="oninput"in document;if(!ms){var sl=document.createElement("div");sl.setAttribute("oninput","return;"),ms=typeof sl.oninput=="function"}ps=ms}else ps=!1;ad=ps&&(!document.documentMode||9<document.documentMode)}function ol(){ar&&(ar.detachEvent("onpropertychange",sd),_r=ar=null)}function sd(e){if(e.propertyName==="value"&&Wa(_r)){var t=[];rd(t,_r,e,Zo(e)),Gc(p0,t)}}function g0(e,t,n){e==="focusin"?(ol(),ar=t,_r=n,ar.attachEvent("onpropertychange",sd)):e==="focusout"&&ol()}function f0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wa(_r)}function h0(e,t){if(e==="click")return Wa(t)}function _0(e,t){if(e==="input"||e==="change")return Wa(t)}function y0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qe=typeof Object.is=="function"?Object.is:y0;function yr(e,t){if(Qe(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var s=n[a];if(!Ws.call(t,s)||!Qe(e[s],t[s]))return!1}return!0}function il(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ll(e,t){var n=il(e);e=0;for(var a;n;){if(n.nodeType===3){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=il(n)}}function od(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?od(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function id(){for(var e=window,t=fa();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=fa(e.document)}return t}function ni(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function v0(e){var t=id(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&od(n.ownerDocument.documentElement,n)){if(a!==null&&ni(n)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(a.start,s);a=a.end===void 0?o:Math.min(a.end,s),!e.extend&&o>a&&(s=a,a=o,o=s),s=ll(n,o);var i=ll(n,a);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var x0=ut&&"documentMode"in document&&11>=document.documentMode,fn=null,io=null,sr=null,lo=!1;function cl(e,t,n){var a=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lo||fn==null||fn!==fa(a)||(a=fn,"selectionStart"in a&&ni(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),sr&&yr(sr,a)||(sr=a,a=wa(io,"onSelect"),0<a.length&&(t=new Jo("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=fn)))}function Ur(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hn={animationend:Ur("Animation","AnimationEnd"),animationiteration:Ur("Animation","AnimationIteration"),animationstart:Ur("Animation","AnimationStart"),transitionend:Ur("Transition","TransitionEnd")},gs={},ld={};ut&&(ld=document.createElement("div").style,"AnimationEvent"in window||(delete hn.animationend.animation,delete hn.animationiteration.animation,delete hn.animationstart.animation),"TransitionEvent"in window||delete hn.transitionend.transition);function Ua(e){if(gs[e])return gs[e];if(!hn[e])return e;var t=hn[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ld)return gs[e]=t[n];return e}var cd=Ua("animationend"),dd=Ua("animationiteration"),ud=Ua("animationstart"),pd=Ua("transitionend"),md=new Map,dl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rt(e,t){md.set(e,t),rn(t,[e])}for(var fs=0;fs<dl.length;fs++){var hs=dl[fs],b0=hs.toLowerCase(),w0=hs[0].toUpperCase()+hs.slice(1);Rt(b0,"on"+w0)}Rt(cd,"onAnimationEnd");Rt(dd,"onAnimationIteration");Rt(ud,"onAnimationStart");Rt("dblclick","onDoubleClick");Rt("focusin","onFocus");Rt("focusout","onBlur");Rt(pd,"onTransitionEnd");En("onMouseEnter",["mouseout","mouseover"]);En("onMouseLeave",["mouseout","mouseover"]);En("onPointerEnter",["pointerout","pointerover"]);En("onPointerLeave",["pointerout","pointerover"]);rn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rn("onBeforeInput",["compositionend","keypress","textInput","paste"]);rn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jn));function ul(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,bp(a,t,void 0,e),e.currentTarget=null}function gd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var a=e[n],s=a.event;a=a.listeners;e:{var o=void 0;if(t)for(var i=a.length-1;0<=i;i--){var l=a[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;ul(s,l,d),o=c}else for(i=0;i<a.length;i++){if(l=a[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;ul(s,l,d),o=c}}}if(_a)throw e=ro,_a=!1,ro=null,e}function B(e,t){var n=t[go];n===void 0&&(n=t[go]=new Set);var a=e+"__bubble";n.has(a)||(fd(t,e,2,!1),n.add(a))}function _s(e,t,n){var a=0;t&&(a|=4),fd(n,e,a,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function vr(e){if(!e[zr]){e[zr]=!0,wc.forEach(function(n){n!=="selectionchange"&&(S0.has(n)||_s(n,!1,e),_s(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zr]||(t[zr]=!0,_s("selectionchange",!1,t))}}function fd(e,t,n,a){switch(Xc(t)){case 1:var s=Mp;break;case 4:s=Gp;break;default:s=Yo}n=s.bind(null,t,n,e),s=void 0,!no||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),a?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function ys(e,t,n,a,s){var o=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var i=a.tag;if(i===3||i===4){var l=a.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=a.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=zt(l),i===null)return;if(c=i.tag,c===5||c===6){a=o=i;continue e}l=l.parentNode}}a=a.return}Gc(function(){var d=o,u=Zo(n),m=[];e:{var g=md.get(e);if(g!==void 0){var v=Jo,b=e;switch(e){case"keypress":if(oa(n)===0)break e;case"keydown":case"keyup":v=Jp;break;case"focusin":b="focus",v=us;break;case"focusout":b="blur",v=us;break;case"beforeblur":case"afterblur":v=us;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Ji;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Fp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=n0;break;case cd:case dd:case ud:v=zp;break;case pd:v=a0;break;case"scroll":v=Vp;break;case"wheel":v=o0;break;case"copy":case"cut":case"paste":v=Bp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=tl}var y=(t&4)!==0,O=!y&&e==="scroll",h=y?g!==null?g+"Capture":null:g;y=[];for(var p=d,f;p!==null;){f=p;var w=f.stateNode;if(f.tag===5&&w!==null&&(f=w,h!==null&&(w=mr(p,h),w!=null&&y.push(xr(p,w,f)))),O)break;p=p.return}0<y.length&&(g=new v(g,b,null,n,u),m.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",g&&n!==eo&&(b=n.relatedTarget||n.fromElement)&&(zt(b)||b[pt]))break e;if((v||g)&&(g=u.window===u?u:(g=u.ownerDocument)?g.defaultView||g.parentWindow:window,v?(b=n.relatedTarget||n.toElement,v=d,b=b?zt(b):null,b!==null&&(O=an(b),b!==O||b.tag!==5&&b.tag!==6)&&(b=null)):(v=null,b=d),v!==b)){if(y=Ji,w="onMouseLeave",h="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(y=tl,w="onPointerLeave",h="onPointerEnter",p="pointer"),O=v==null?g:_n(v),f=b==null?g:_n(b),g=new y(w,p+"leave",v,n,u),g.target=O,g.relatedTarget=f,w=null,zt(u)===d&&(y=new y(h,p+"enter",b,n,u),y.target=f,y.relatedTarget=O,w=y),O=w,v&&b)t:{for(y=v,h=b,p=0,f=y;f;f=sn(f))p++;for(f=0,w=h;w;w=sn(w))f++;for(;0<p-f;)y=sn(y),p--;for(;0<f-p;)h=sn(h),f--;for(;p--;){if(y===h||h!==null&&y===h.alternate)break t;y=sn(y),h=sn(h)}y=null}else y=null;v!==null&&pl(m,g,v,y,!1),b!==null&&O!==null&&pl(m,O,b,y,!0)}}e:{if(g=d?_n(d):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var S=m0;else if(al(g))if(ad)S=_0;else{S=f0;var k=g0}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(S=h0);if(S&&(S=S(e,d))){rd(m,S,n,u);break e}k&&k(e,g,d),e==="focusout"&&(k=g._wrapperState)&&k.controlled&&g.type==="number"&&Ks(g,"number",g.value)}switch(k=d?_n(d):window,e){case"focusin":(al(k)||k.contentEditable==="true")&&(fn=k,io=d,sr=null);break;case"focusout":sr=io=fn=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,cl(m,n,u);break;case"selectionchange":if(x0)break;case"keydown":case"keyup":cl(m,n,u)}var A;if(ti)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else gn?td(e,n)&&(I="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(ed&&n.locale!=="ko"&&(gn||I!=="onCompositionStart"?I==="onCompositionEnd"&&gn&&(A=Jc()):(wt=u,Xo="value"in wt?wt.value:wt.textContent,gn=!0)),k=wa(d,I),0<k.length&&(I=new el(I,e,null,n,u),m.push({event:I,listeners:k}),A?I.data=A:(A=nd(n),A!==null&&(I.data=A)))),(A=l0?c0(e,n):d0(e,n))&&(d=wa(d,"onBeforeInput"),0<d.length&&(u=new el("onBeforeInput","beforeinput",null,n,u),m.push({event:u,listeners:d}),u.data=A))}gd(m,t)})}function xr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wa(e,t){for(var n=t+"Capture",a=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=mr(e,n),o!=null&&a.unshift(xr(e,o,s)),o=mr(e,t),o!=null&&a.push(xr(e,o,s))),e=e.return}return a}function sn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pl(e,t,n,a,s){for(var o=t._reactName,i=[];n!==null&&n!==a;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===a)break;l.tag===5&&d!==null&&(l=d,s?(c=mr(n,o),c!=null&&i.unshift(xr(n,c,l))):s||(c=mr(n,o),c!=null&&i.push(xr(n,c,l)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var k0=/\r\n?/g,C0=/\u0000|\uFFFD/g;function ml(e){return(typeof e=="string"?e:""+e).replace(k0,`
`).replace(C0,"")}function $r(e,t,n){if(t=ml(t),ml(e)!==t&&n)throw Error(C(425))}function Sa(){}var co=null,uo=null;function po(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var mo=typeof setTimeout=="function"?setTimeout:void 0,A0=typeof clearTimeout=="function"?clearTimeout:void 0,gl=typeof Promise=="function"?Promise:void 0,N0=typeof queueMicrotask=="function"?queueMicrotask:typeof gl<"u"?function(e){return gl.resolve(null).then(e).catch(j0)}:mo;function j0(e){setTimeout(function(){throw e})}function vs(e,t){var n=t,a=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(a===0){e.removeChild(s),hr(t);return}a--}else n!=="$"&&n!=="$?"&&n!=="$!"||a++;n=s}while(n);hr(t)}function Nt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function fl(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Hn=Math.random().toString(36).slice(2),tt="__reactFiber$"+Hn,br="__reactProps$"+Hn,pt="__reactContainer$"+Hn,go="__reactEvents$"+Hn,T0="__reactListeners$"+Hn,E0="__reactHandles$"+Hn;function zt(e){var t=e[tt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pt]||n[tt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=fl(e);e!==null;){if(n=e[tt])return n;e=fl(e)}return t}e=n,n=e.parentNode}return null}function Pr(e){return e=e[tt]||e[pt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _n(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(C(33))}function za(e){return e[br]||null}var fo=[],yn=-1;function Ot(e){return{current:e}}function Z(e){0>yn||(e.current=fo[yn],fo[yn]=null,yn--)}function $(e,t){yn++,fo[yn]=e.current,e.current=t}var Lt={},ye=Ot(Lt),Ne=Ot(!1),Yt=Lt;function Pn(e,t){var n=e.type.contextTypes;if(!n)return Lt;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function je(e){return e=e.childContextTypes,e!=null}function ka(){Z(Ne),Z(ye)}function hl(e,t,n){if(ye.current!==Lt)throw Error(C(168));$(ye,t),$(Ne,n)}function hd(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return n;a=a.getChildContext();for(var s in a)if(!(s in t))throw Error(C(108,gp(e)||"Unknown",s));return Y({},n,a)}function Ca(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Lt,Yt=ye.current,$(ye,e),$(Ne,Ne.current),!0}function _l(e,t,n){var a=e.stateNode;if(!a)throw Error(C(169));n?(e=hd(e,t,Yt),a.__reactInternalMemoizedMergedChildContext=e,Z(Ne),Z(ye),$(ye,e)):Z(Ne),$(Ne,n)}var it=null,$a=!1,xs=!1;function _d(e){it===null?it=[e]:it.push(e)}function P0(e){$a=!0,_d(e)}function Dt(){if(!xs&&it!==null){xs=!0;var e=0,t=z;try{var n=it;for(z=1;e<n.length;e++){var a=n[e];do a=a(!0);while(a!==null)}it=null,$a=!1}catch(s){throw it!==null&&(it=it.slice(e+1)),Wc(qo,Dt),s}finally{z=t,xs=!1}}return null}var vn=[],xn=0,Aa=null,Na=0,Me=[],Ge=0,Xt=null,lt=1,ct="";function Ft(e,t){vn[xn++]=Na,vn[xn++]=Aa,Aa=e,Na=t}function yd(e,t,n){Me[Ge++]=lt,Me[Ge++]=ct,Me[Ge++]=Xt,Xt=e;var a=lt;e=ct;var s=32-qe(a)-1;a&=~(1<<s),n+=1;var o=32-qe(t)+s;if(30<o){var i=s-s%5;o=(a&(1<<i)-1).toString(32),a>>=i,s-=i,lt=1<<32-qe(t)+s|n<<s|a,ct=o+e}else lt=1<<o|n<<s|a,ct=e}function ri(e){e.return!==null&&(Ft(e,1),yd(e,1,0))}function ai(e){for(;e===Aa;)Aa=vn[--xn],vn[xn]=null,Na=vn[--xn],vn[xn]=null;for(;e===Xt;)Xt=Me[--Ge],Me[Ge]=null,ct=Me[--Ge],Me[Ge]=null,lt=Me[--Ge],Me[Ge]=null}var Ie=null,Pe=null,q=!1,Ze=null;function vd(e,t){var n=Ve(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function yl(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ie=e,Pe=Nt(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ie=e,Pe=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Xt!==null?{id:lt,overflow:ct}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ve(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ie=e,Pe=null,!0):!1;default:return!1}}function ho(e){return(e.mode&1)!==0&&(e.flags&128)===0}function _o(e){if(q){var t=Pe;if(t){var n=t;if(!yl(e,t)){if(ho(e))throw Error(C(418));t=Nt(n.nextSibling);var a=Ie;t&&yl(e,t)?vd(a,n):(e.flags=e.flags&-4097|2,q=!1,Ie=e)}}else{if(ho(e))throw Error(C(418));e.flags=e.flags&-4097|2,q=!1,Ie=e}}}function vl(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ie=e}function Br(e){if(e!==Ie)return!1;if(!q)return vl(e),q=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!po(e.type,e.memoizedProps)),t&&(t=Pe)){if(ho(e))throw xd(),Error(C(418));for(;t;)vd(e,t),t=Nt(t.nextSibling)}if(vl(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(C(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Pe=Nt(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Pe=null}}else Pe=Ie?Nt(e.stateNode.nextSibling):null;return!0}function xd(){for(var e=Pe;e;)e=Nt(e.nextSibling)}function In(){Pe=Ie=null,q=!1}function si(e){Ze===null?Ze=[e]:Ze.push(e)}var I0=ft.ReactCurrentBatchConfig;function Bn(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(C(309));var a=n.stateNode}if(!a)throw Error(C(147,e));var s=a,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(C(284));if(!n._owner)throw Error(C(290,e))}return e}function Zr(e,t){throw e=Object.prototype.toString.call(t),Error(C(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xl(e){var t=e._init;return t(e._payload)}function bd(e){function t(h,p){if(e){var f=h.deletions;f===null?(h.deletions=[p],h.flags|=16):f.push(p)}}function n(h,p){if(!e)return null;for(;p!==null;)t(h,p),p=p.sibling;return null}function a(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function s(h,p){return h=Pt(h,p),h.index=0,h.sibling=null,h}function o(h,p,f){return h.index=f,e?(f=h.alternate,f!==null?(f=f.index,f<p?(h.flags|=2,p):f):(h.flags|=2,p)):(h.flags|=1048576,p)}function i(h){return e&&h.alternate===null&&(h.flags|=2),h}function l(h,p,f,w){return p===null||p.tag!==6?(p=Ns(f,h.mode,w),p.return=h,p):(p=s(p,f),p.return=h,p)}function c(h,p,f,w){var S=f.type;return S===mn?u(h,p,f.props.children,w,f.key):p!==null&&(p.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===yt&&xl(S)===p.type)?(w=s(p,f.props),w.ref=Bn(h,p,f),w.return=h,w):(w=ma(f.type,f.key,f.props,null,h.mode,w),w.ref=Bn(h,p,f),w.return=h,w)}function d(h,p,f,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==f.containerInfo||p.stateNode.implementation!==f.implementation?(p=js(f,h.mode,w),p.return=h,p):(p=s(p,f.children||[]),p.return=h,p)}function u(h,p,f,w,S){return p===null||p.tag!==7?(p=Qt(f,h.mode,w,S),p.return=h,p):(p=s(p,f),p.return=h,p)}function m(h,p,f){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Ns(""+p,h.mode,f),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Dr:return f=ma(p.type,p.key,p.props,null,h.mode,f),f.ref=Bn(h,null,p),f.return=h,f;case pn:return p=js(p,h.mode,f),p.return=h,p;case yt:var w=p._init;return m(h,w(p._payload),f)}if(Yn(p)||Fn(p))return p=Qt(p,h.mode,f,null),p.return=h,p;Zr(h,p)}return null}function g(h,p,f,w){var S=p!==null?p.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return S!==null?null:l(h,p,""+f,w);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Dr:return f.key===S?c(h,p,f,w):null;case pn:return f.key===S?d(h,p,f,w):null;case yt:return S=f._init,g(h,p,S(f._payload),w)}if(Yn(f)||Fn(f))return S!==null?null:u(h,p,f,w,null);Zr(h,f)}return null}function v(h,p,f,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return h=h.get(f)||null,l(p,h,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Dr:return h=h.get(w.key===null?f:w.key)||null,c(p,h,w,S);case pn:return h=h.get(w.key===null?f:w.key)||null,d(p,h,w,S);case yt:var k=w._init;return v(h,p,f,k(w._payload),S)}if(Yn(w)||Fn(w))return h=h.get(f)||null,u(p,h,w,S,null);Zr(p,w)}return null}function b(h,p,f,w){for(var S=null,k=null,A=p,I=p=0,T=null;A!==null&&I<f.length;I++){A.index>I?(T=A,A=null):T=A.sibling;var E=g(h,A,f[I],w);if(E===null){A===null&&(A=T);break}e&&A&&E.alternate===null&&t(h,A),p=o(E,p,I),k===null?S=E:k.sibling=E,k=E,A=T}if(I===f.length)return n(h,A),q&&Ft(h,I),S;if(A===null){for(;I<f.length;I++)A=m(h,f[I],w),A!==null&&(p=o(A,p,I),k===null?S=A:k.sibling=A,k=A);return q&&Ft(h,I),S}for(A=a(h,A);I<f.length;I++)T=v(A,h,I,f[I],w),T!==null&&(e&&T.alternate!==null&&A.delete(T.key===null?I:T.key),p=o(T,p,I),k===null?S=T:k.sibling=T,k=T);return e&&A.forEach(function(H){return t(h,H)}),q&&Ft(h,I),S}function y(h,p,f,w){var S=Fn(f);if(typeof S!="function")throw Error(C(150));if(f=S.call(f),f==null)throw Error(C(151));for(var k=S=null,A=p,I=p=0,T=null,E=f.next();A!==null&&!E.done;I++,E=f.next()){A.index>I?(T=A,A=null):T=A.sibling;var H=g(h,A,E.value,w);if(H===null){A===null&&(A=T);break}e&&A&&H.alternate===null&&t(h,A),p=o(H,p,I),k===null?S=H:k.sibling=H,k=H,A=T}if(E.done)return n(h,A),q&&Ft(h,I),S;if(A===null){for(;!E.done;I++,E=f.next())E=m(h,E.value,w),E!==null&&(p=o(E,p,I),k===null?S=E:k.sibling=E,k=E);return q&&Ft(h,I),S}for(A=a(h,A);!E.done;I++,E=f.next())E=v(A,h,I,E.value,w),E!==null&&(e&&E.alternate!==null&&A.delete(E.key===null?I:E.key),p=o(E,p,I),k===null?S=E:k.sibling=E,k=E);return e&&A.forEach(function(U){return t(h,U)}),q&&Ft(h,I),S}function O(h,p,f,w){if(typeof f=="object"&&f!==null&&f.type===mn&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case Dr:e:{for(var S=f.key,k=p;k!==null;){if(k.key===S){if(S=f.type,S===mn){if(k.tag===7){n(h,k.sibling),p=s(k,f.props.children),p.return=h,h=p;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===yt&&xl(S)===k.type){n(h,k.sibling),p=s(k,f.props),p.ref=Bn(h,k,f),p.return=h,h=p;break e}n(h,k);break}else t(h,k);k=k.sibling}f.type===mn?(p=Qt(f.props.children,h.mode,w,f.key),p.return=h,h=p):(w=ma(f.type,f.key,f.props,null,h.mode,w),w.ref=Bn(h,p,f),w.return=h,h=w)}return i(h);case pn:e:{for(k=f.key;p!==null;){if(p.key===k)if(p.tag===4&&p.stateNode.containerInfo===f.containerInfo&&p.stateNode.implementation===f.implementation){n(h,p.sibling),p=s(p,f.children||[]),p.return=h,h=p;break e}else{n(h,p);break}else t(h,p);p=p.sibling}p=js(f,h.mode,w),p.return=h,h=p}return i(h);case yt:return k=f._init,O(h,p,k(f._payload),w)}if(Yn(f))return b(h,p,f,w);if(Fn(f))return y(h,p,f,w);Zr(h,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,p!==null&&p.tag===6?(n(h,p.sibling),p=s(p,f),p.return=h,h=p):(n(h,p),p=Ns(f,h.mode,w),p.return=h,h=p),i(h)):n(h,p)}return O}var Ln=bd(!0),wd=bd(!1),ja=Ot(null),Ta=null,bn=null,oi=null;function ii(){oi=bn=Ta=null}function li(e){var t=ja.current;Z(ja),e._currentValue=t}function yo(e,t,n){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function jn(e,t){Ta=e,oi=bn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ae=!0),e.firstContext=null)}function Fe(e){var t=e._currentValue;if(oi!==e)if(e={context:e,memoizedValue:t,next:null},bn===null){if(Ta===null)throw Error(C(308));bn=e,Ta.dependencies={lanes:0,firstContext:e}}else bn=bn.next=e;return t}var $t=null;function ci(e){$t===null?$t=[e]:$t.push(e)}function Sd(e,t,n,a){var s=t.interleaved;return s===null?(n.next=n,ci(t)):(n.next=s.next,s.next=n),t.interleaved=n,mt(e,a)}function mt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var vt=!1;function di(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function dt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function jt(e,t,n){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,W&2){var s=a.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),a.pending=t,mt(e,n)}return s=a.interleaved,s===null?(t.next=t,ci(a)):(t.next=s.next,s.next=t),a.interleaved=t,mt(e,n)}function ia(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,Ko(e,n)}}function bl(e,t){var n=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,n===a)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:a.shared,effects:a.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ea(e,t,n,a){var s=e.updateQueue;vt=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var m=s.baseState;i=0,u=d=c=null,l=o;do{var g=l.lane,v=l.eventTime;if((a&g)===g){u!==null&&(u=u.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=e,y=l;switch(g=t,v=n,y.tag){case 1:if(b=y.payload,typeof b=="function"){m=b.call(v,m,g);break e}m=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=y.payload,g=typeof b=="function"?b.call(v,m,g):b,g==null)break e;m=Y({},m,g);break e;case 2:vt=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else v={eventTime:v,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=v,c=m):u=u.next=v,i|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(u===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);en|=i,e.lanes=i,e.memoizedState=m}}function wl(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],s=a.callback;if(s!==null){if(a.callback=null,a=n,typeof s!="function")throw Error(C(191,s));s.call(a)}}}var Ir={},rt=Ot(Ir),wr=Ot(Ir),Sr=Ot(Ir);function Bt(e){if(e===Ir)throw Error(C(174));return e}function ui(e,t){switch($(Sr,t),$(wr,e),$(rt,Ir),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ys(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ys(t,e)}Z(rt),$(rt,t)}function Rn(){Z(rt),Z(wr),Z(Sr)}function Cd(e){Bt(Sr.current);var t=Bt(rt.current),n=Ys(t,e.type);t!==n&&($(wr,e),$(rt,n))}function pi(e){wr.current===e&&(Z(rt),Z(wr))}var K=Ot(0);function Pa(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var bs=[];function mi(){for(var e=0;e<bs.length;e++)bs[e]._workInProgressVersionPrimary=null;bs.length=0}var la=ft.ReactCurrentDispatcher,ws=ft.ReactCurrentBatchConfig,Jt=0,Q=null,se=null,le=null,Ia=!1,or=!1,kr=0,L0=0;function fe(){throw Error(C(321))}function gi(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qe(e[n],t[n]))return!1;return!0}function fi(e,t,n,a,s,o){if(Jt=o,Q=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,la.current=e===null||e.memoizedState===null?M0:G0,e=n(a,s),or){o=0;do{if(or=!1,kr=0,25<=o)throw Error(C(301));o+=1,le=se=null,t.updateQueue=null,la.current=V0,e=n(a,s)}while(or)}if(la.current=La,t=se!==null&&se.next!==null,Jt=0,le=se=Q=null,Ia=!1,t)throw Error(C(300));return e}function hi(){var e=kr!==0;return kr=0,e}function et(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return le===null?Q.memoizedState=le=e:le=le.next=e,le}function We(){if(se===null){var e=Q.alternate;e=e!==null?e.memoizedState:null}else e=se.next;var t=le===null?Q.memoizedState:le.next;if(t!==null)le=t,se=e;else{if(e===null)throw Error(C(310));se=e,e={memoizedState:se.memoizedState,baseState:se.baseState,baseQueue:se.baseQueue,queue:se.queue,next:null},le===null?Q.memoizedState=le=e:le=le.next=e}return le}function Cr(e,t){return typeof t=="function"?t(e):t}function Ss(e){var t=We(),n=t.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=e;var a=se,s=a.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}a.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,a=a.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((Jt&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=m,i=a):c=c.next=m,Q.lanes|=u,en|=u}d=d.next}while(d!==null&&d!==o);c===null?i=a:c.next=l,Qe(a,t.memoizedState)||(Ae=!0),t.memoizedState=a,t.baseState=i,t.baseQueue=c,n.lastRenderedState=a}if(e=n.interleaved,e!==null){s=e;do o=s.lane,Q.lanes|=o,en|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ks(e){var t=We(),n=t.queue;if(n===null)throw Error(C(311));n.lastRenderedReducer=e;var a=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);Qe(o,t.memoizedState)||(Ae=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,a]}function Ad(){}function Nd(e,t){var n=Q,a=We(),s=t(),o=!Qe(a.memoizedState,s);if(o&&(a.memoizedState=s,Ae=!0),a=a.queue,_i(Ed.bind(null,n,a,e),[e]),a.getSnapshot!==t||o||le!==null&&le.memoizedState.tag&1){if(n.flags|=2048,Ar(9,Td.bind(null,n,a,s,t),void 0,null),ce===null)throw Error(C(349));Jt&30||jd(n,t,s)}return s}function jd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Q.updateQueue,t===null?(t={lastEffect:null,stores:null},Q.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Td(e,t,n,a){t.value=n,t.getSnapshot=a,Pd(t)&&Id(e)}function Ed(e,t,n){return n(function(){Pd(t)&&Id(e)})}function Pd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qe(e,n)}catch{return!0}}function Id(e){var t=mt(e,1);t!==null&&Ke(t,e,1,-1)}function Sl(e){var t=et();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cr,lastRenderedState:e},t.queue=e,e=e.dispatch=D0.bind(null,Q,e),[t.memoizedState,e]}function Ar(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},t=Q.updateQueue,t===null?(t={lastEffect:null,stores:null},Q.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e)),e}function Ld(){return We().memoizedState}function ca(e,t,n,a){var s=et();Q.flags|=e,s.memoizedState=Ar(1|t,n,void 0,a===void 0?null:a)}function Ba(e,t,n,a){var s=We();a=a===void 0?null:a;var o=void 0;if(se!==null){var i=se.memoizedState;if(o=i.destroy,a!==null&&gi(a,i.deps)){s.memoizedState=Ar(t,n,o,a);return}}Q.flags|=e,s.memoizedState=Ar(1|t,n,o,a)}function kl(e,t){return ca(8390656,8,e,t)}function _i(e,t){return Ba(2048,8,e,t)}function Rd(e,t){return Ba(4,2,e,t)}function Od(e,t){return Ba(4,4,e,t)}function Dd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Md(e,t,n){return n=n!=null?n.concat([e]):null,Ba(4,4,Dd.bind(null,t,e),n)}function yi(){}function Gd(e,t){var n=We();t=t===void 0?null:t;var a=n.memoizedState;return a!==null&&t!==null&&gi(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Vd(e,t){var n=We();t=t===void 0?null:t;var a=n.memoizedState;return a!==null&&t!==null&&gi(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Hd(e,t,n){return Jt&21?(Qe(n,t)||(n=$c(),Q.lanes|=n,en|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ae=!0),e.memoizedState=n)}function R0(e,t){var n=z;z=n!==0&&4>n?n:4,e(!0);var a=ws.transition;ws.transition={};try{e(!1),t()}finally{z=n,ws.transition=a}}function Fd(){return We().memoizedState}function O0(e,t,n){var a=Et(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},Wd(e))Ud(t,n);else if(n=Sd(e,t,n,a),n!==null){var s=be();Ke(n,e,a,s),zd(n,t,a)}}function D0(e,t,n){var a=Et(e),s={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wd(e))Ud(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,Qe(l,i)){var c=t.interleaved;c===null?(s.next=s,ci(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Sd(e,t,s,a),n!==null&&(s=be(),Ke(n,e,a,s),zd(n,t,a))}}function Wd(e){var t=e.alternate;return e===Q||t!==null&&t===Q}function Ud(e,t){or=Ia=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zd(e,t,n){if(n&4194240){var a=t.lanes;a&=e.pendingLanes,n|=a,t.lanes=n,Ko(e,n)}}var La={readContext:Fe,useCallback:fe,useContext:fe,useEffect:fe,useImperativeHandle:fe,useInsertionEffect:fe,useLayoutEffect:fe,useMemo:fe,useReducer:fe,useRef:fe,useState:fe,useDebugValue:fe,useDeferredValue:fe,useTransition:fe,useMutableSource:fe,useSyncExternalStore:fe,useId:fe,unstable_isNewReconciler:!1},M0={readContext:Fe,useCallback:function(e,t){return et().memoizedState=[e,t===void 0?null:t],e},useContext:Fe,useEffect:kl,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ca(4194308,4,Dd.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ca(4194308,4,e,t)},useInsertionEffect:function(e,t){return ca(4,2,e,t)},useMemo:function(e,t){var n=et();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=et();return t=n!==void 0?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=O0.bind(null,Q,e),[a.memoizedState,e]},useRef:function(e){var t=et();return e={current:e},t.memoizedState=e},useState:Sl,useDebugValue:yi,useDeferredValue:function(e){return et().memoizedState=e},useTransition:function(){var e=Sl(!1),t=e[0];return e=R0.bind(null,e[1]),et().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=Q,s=et();if(q){if(n===void 0)throw Error(C(407));n=n()}else{if(n=t(),ce===null)throw Error(C(349));Jt&30||jd(a,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,kl(Ed.bind(null,a,o,e),[e]),a.flags|=2048,Ar(9,Td.bind(null,a,o,n,t),void 0,null),n},useId:function(){var e=et(),t=ce.identifierPrefix;if(q){var n=ct,a=lt;n=(a&~(1<<32-qe(a)-1)).toString(32)+n,t=":"+t+"R"+n,n=kr++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=L0++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},G0={readContext:Fe,useCallback:Gd,useContext:Fe,useEffect:_i,useImperativeHandle:Md,useInsertionEffect:Rd,useLayoutEffect:Od,useMemo:Vd,useReducer:Ss,useRef:Ld,useState:function(){return Ss(Cr)},useDebugValue:yi,useDeferredValue:function(e){var t=We();return Hd(t,se.memoizedState,e)},useTransition:function(){var e=Ss(Cr)[0],t=We().memoizedState;return[e,t]},useMutableSource:Ad,useSyncExternalStore:Nd,useId:Fd,unstable_isNewReconciler:!1},V0={readContext:Fe,useCallback:Gd,useContext:Fe,useEffect:_i,useImperativeHandle:Md,useInsertionEffect:Rd,useLayoutEffect:Od,useMemo:Vd,useReducer:ks,useRef:Ld,useState:function(){return ks(Cr)},useDebugValue:yi,useDeferredValue:function(e){var t=We();return se===null?t.memoizedState=e:Hd(t,se.memoizedState,e)},useTransition:function(){var e=ks(Cr)[0],t=We().memoizedState;return[e,t]},useMutableSource:Ad,useSyncExternalStore:Nd,useId:Fd,unstable_isNewReconciler:!1};function $e(e,t){if(e&&e.defaultProps){t=Y({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function vo(e,t,n,a){t=e.memoizedState,n=n(a,t),n=n==null?t:Y({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Za={isMounted:function(e){return(e=e._reactInternals)?an(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=be(),s=Et(e),o=dt(a,s);o.payload=t,n!=null&&(o.callback=n),t=jt(e,o,s),t!==null&&(Ke(t,e,s,a),ia(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=be(),s=Et(e),o=dt(a,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=jt(e,o,s),t!==null&&(Ke(t,e,s,a),ia(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=be(),a=Et(e),s=dt(n,a);s.tag=2,t!=null&&(s.callback=t),t=jt(e,s,a),t!==null&&(Ke(t,e,a,n),ia(t,e,a))}};function Cl(e,t,n,a,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,o,i):t.prototype&&t.prototype.isPureReactComponent?!yr(n,a)||!yr(s,o):!0}function $d(e,t,n){var a=!1,s=Lt,o=t.contextType;return typeof o=="object"&&o!==null?o=Fe(o):(s=je(t)?Yt:ye.current,a=t.contextTypes,o=(a=a!=null)?Pn(e,s):Lt),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Za,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function Al(e,t,n,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&Za.enqueueReplaceState(t,t.state,null)}function xo(e,t,n,a){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},di(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Fe(o):(o=je(t)?Yt:ye.current,s.context=Pn(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(vo(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Za.enqueueReplaceState(s,s.state,null),Ea(e,n,s,a),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function On(e,t){try{var n="",a=t;do n+=mp(a),a=a.return;while(a);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function Cs(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var H0=typeof WeakMap=="function"?WeakMap:Map;function Bd(e,t,n){n=dt(-1,n),n.tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Oa||(Oa=!0,Po=a),bo(e,t)},n}function Zd(e,t,n){n=dt(-1,n),n.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var s=t.value;n.payload=function(){return a(s)},n.callback=function(){bo(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){bo(e,t),typeof a!="function"&&(Tt===null?Tt=new Set([this]):Tt.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Nl(e,t,n){var a=e.pingCache;if(a===null){a=e.pingCache=new H0;var s=new Set;a.set(t,s)}else s=a.get(t),s===void 0&&(s=new Set,a.set(t,s));s.has(n)||(s.add(n),e=em.bind(null,e,t,n),t.then(e,e))}function jl(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Tl(e,t,n,a,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=dt(-1,1),t.tag=2,jt(n,t,1))),n.lanes|=1),e)}var F0=ft.ReactCurrentOwner,Ae=!1;function xe(e,t,n,a){t.child=e===null?wd(t,null,n,a):Ln(t,e.child,n,a)}function El(e,t,n,a,s){n=n.render;var o=t.ref;return jn(t,s),a=fi(e,t,n,a,o,s),n=hi(),e!==null&&!Ae?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gt(e,t,s)):(q&&n&&ri(t),t.flags|=1,xe(e,t,a,s),t.child)}function Pl(e,t,n,a,s){if(e===null){var o=n.type;return typeof o=="function"&&!Ai(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,qd(e,t,o,a,s)):(e=ma(n.type,null,a,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:yr,n(i,a)&&e.ref===t.ref)return gt(e,t,s)}return t.flags|=1,e=Pt(o,a),e.ref=t.ref,e.return=t,t.child=e}function qd(e,t,n,a,s){if(e!==null){var o=e.memoizedProps;if(yr(o,a)&&e.ref===t.ref)if(Ae=!1,t.pendingProps=a=o,(e.lanes&s)!==0)e.flags&131072&&(Ae=!0);else return t.lanes=e.lanes,gt(e,t,s)}return wo(e,t,n,a,s)}function Kd(e,t,n){var a=t.pendingProps,s=a.children,o=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$(Sn,Ee),Ee|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$(Sn,Ee),Ee|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=o!==null?o.baseLanes:n,$(Sn,Ee),Ee|=a}else o!==null?(a=o.baseLanes|n,t.memoizedState=null):a=n,$(Sn,Ee),Ee|=a;return xe(e,t,s,n),t.child}function Qd(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function wo(e,t,n,a,s){var o=je(n)?Yt:ye.current;return o=Pn(t,o),jn(t,s),n=fi(e,t,n,a,o,s),a=hi(),e!==null&&!Ae?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gt(e,t,s)):(q&&a&&ri(t),t.flags|=1,xe(e,t,n,s),t.child)}function Il(e,t,n,a,s){if(je(n)){var o=!0;Ca(t)}else o=!1;if(jn(t,s),t.stateNode===null)da(e,t),$d(t,n,a),xo(t,n,a,s),a=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Fe(d):(d=je(n)?Yt:ye.current,d=Pn(t,d));var u=n.getDerivedStateFromProps,m=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";m||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==a||c!==d)&&Al(t,i,a,d),vt=!1;var g=t.memoizedState;i.state=g,Ea(t,a,i,s),c=t.memoizedState,l!==a||g!==c||Ne.current||vt?(typeof u=="function"&&(vo(t,n,u,a),c=t.memoizedState),(l=vt||Cl(t,n,l,a,g,c,d))?(m||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),i.props=a,i.state=c,i.context=d,a=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,kd(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:$e(t.type,l),i.props=d,m=t.pendingProps,g=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=Fe(c):(c=je(n)?Yt:ye.current,c=Pn(t,c));var v=n.getDerivedStateFromProps;(u=typeof v=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==m||g!==c)&&Al(t,i,a,c),vt=!1,g=t.memoizedState,i.state=g,Ea(t,a,i,s);var b=t.memoizedState;l!==m||g!==b||Ne.current||vt?(typeof v=="function"&&(vo(t,n,v,a),b=t.memoizedState),(d=vt||Cl(t,n,d,a,g,b,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(a,b,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(a,b,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=b),i.props=a,i.state=b,i.context=c,a=d):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),a=!1)}return So(e,t,n,a,o,s)}function So(e,t,n,a,s,o){Qd(e,t);var i=(t.flags&128)!==0;if(!a&&!i)return s&&_l(t,n,!1),gt(e,t,o);a=t.stateNode,F0.current=t;var l=i&&typeof n.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&i?(t.child=Ln(t,e.child,null,o),t.child=Ln(t,null,l,o)):xe(e,t,l,o),t.memoizedState=a.state,s&&_l(t,n,!0),t.child}function Yd(e){var t=e.stateNode;t.pendingContext?hl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&hl(e,t.context,!1),ui(e,t.containerInfo)}function Ll(e,t,n,a,s){return In(),si(s),t.flags|=256,xe(e,t,n,a),t.child}var ko={dehydrated:null,treeContext:null,retryLane:0};function Co(e){return{baseLanes:e,cachePool:null,transitions:null}}function Xd(e,t,n){var a=t.pendingProps,s=K.current,o=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),$(K,s&1),e===null)return _o(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=a.children,e=a.fallback,o?(a=t.mode,o=t.child,i={mode:"hidden",children:i},!(a&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Qa(i,a,0,null),e=Qt(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Co(n),t.memoizedState=ko,e):vi(t,i));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return W0(e,t,i,a,l,s,n);if(o){o=a.fallback,i=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:a.children};return!(i&1)&&t.child!==s?(a=t.child,a.childLanes=0,a.pendingProps=c,t.deletions=null):(a=Pt(s,c),a.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Pt(l,o):(o=Qt(o,i,n,null),o.flags|=2),o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,i=e.child.memoizedState,i=i===null?Co(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=ko,a}return o=e.child,e=o.sibling,a=Pt(o,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=n),a.return=t,a.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function vi(e,t){return t=Qa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function qr(e,t,n,a){return a!==null&&si(a),Ln(t,e.child,null,n),e=vi(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function W0(e,t,n,a,s,o,i){if(n)return t.flags&256?(t.flags&=-257,a=Cs(Error(C(422))),qr(e,t,i,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=a.fallback,s=t.mode,a=Qa({mode:"visible",children:a.children},s,0,null),o=Qt(o,s,i,null),o.flags|=2,a.return=t,o.return=t,a.sibling=o,t.child=a,t.mode&1&&Ln(t,e.child,null,i),t.child.memoizedState=Co(i),t.memoizedState=ko,o);if(!(t.mode&1))return qr(e,t,i,null);if(s.data==="$!"){if(a=s.nextSibling&&s.nextSibling.dataset,a)var l=a.dgst;return a=l,o=Error(C(419)),a=Cs(o,a,void 0),qr(e,t,i,a)}if(l=(i&e.childLanes)!==0,Ae||l){if(a=ce,a!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(a.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,mt(e,s),Ke(a,e,s,-1))}return Ci(),a=Cs(Error(C(421))),qr(e,t,i,a)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=tm.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Pe=Nt(s.nextSibling),Ie=t,q=!0,Ze=null,e!==null&&(Me[Ge++]=lt,Me[Ge++]=ct,Me[Ge++]=Xt,lt=e.id,ct=e.overflow,Xt=t),t=vi(t,a.children),t.flags|=4096,t)}function Rl(e,t,n){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),yo(e.return,t,n)}function As(e,t,n,a,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=a,o.tail=n,o.tailMode=s)}function Jd(e,t,n){var a=t.pendingProps,s=a.revealOrder,o=a.tail;if(xe(e,t,a.children,n),a=K.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Rl(e,n,t);else if(e.tag===19)Rl(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if($(K,a),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Pa(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),As(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Pa(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}As(t,!0,n,null,o);break;case"together":As(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function da(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),en|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(C(153));if(t.child!==null){for(e=t.child,n=Pt(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Pt(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function U0(e,t,n){switch(t.tag){case 3:Yd(t),In();break;case 5:Cd(t);break;case 1:je(t.type)&&Ca(t);break;case 4:ui(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,s=t.memoizedProps.value;$(ja,a._currentValue),a._currentValue=s;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?($(K,K.current&1),t.flags|=128,null):n&t.child.childLanes?Xd(e,t,n):($(K,K.current&1),e=gt(e,t,n),e!==null?e.sibling:null);$(K,K.current&1);break;case 19:if(a=(n&t.childLanes)!==0,e.flags&128){if(a)return Jd(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$(K,K.current),a)break;return null;case 22:case 23:return t.lanes=0,Kd(e,t,n)}return gt(e,t,n)}var eu,Ao,tu,nu;eu=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ao=function(){};tu=function(e,t,n,a){var s=e.memoizedProps;if(s!==a){e=t.stateNode,Bt(rt.current);var o=null;switch(n){case"input":s=Zs(e,s),a=Zs(e,a),o=[];break;case"select":s=Y({},s,{value:void 0}),a=Y({},a,{value:void 0}),o=[];break;case"textarea":s=Qs(e,s),a=Qs(e,a),o=[];break;default:typeof s.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Sa)}Xs(n,a);var i;n=null;for(d in s)if(!a.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ur.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in a){var c=a[d];if(l=s!=null?s[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ur.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&B("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};nu=function(e,t,n,a){n!==a&&(t.flags|=4)};function Zn(e,t){if(!q)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function he(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,a=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,a|=s.subtreeFlags&14680064,a|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function z0(e,t,n){var a=t.pendingProps;switch(ai(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return he(t),null;case 1:return je(t.type)&&ka(),he(t),null;case 3:return a=t.stateNode,Rn(),Z(Ne),Z(ye),mi(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Br(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ze!==null&&(Ro(Ze),Ze=null))),Ao(e,t),he(t),null;case 5:pi(t);var s=Bt(Sr.current);if(n=t.type,e!==null&&t.stateNode!=null)tu(e,t,n,a,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(C(166));return he(t),null}if(e=Bt(rt.current),Br(t)){a=t.stateNode,n=t.type;var o=t.memoizedProps;switch(a[tt]=t,a[br]=o,e=(t.mode&1)!==0,n){case"dialog":B("cancel",a),B("close",a);break;case"iframe":case"object":case"embed":B("load",a);break;case"video":case"audio":for(s=0;s<Jn.length;s++)B(Jn[s],a);break;case"source":B("error",a);break;case"img":case"image":case"link":B("error",a),B("load",a);break;case"details":B("toggle",a);break;case"input":Ui(a,o),B("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!o.multiple},B("invalid",a);break;case"textarea":$i(a,o),B("invalid",a)}Xs(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?a.textContent!==l&&(o.suppressHydrationWarning!==!0&&$r(a.textContent,l,e),s=["children",l]):typeof l=="number"&&a.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&$r(a.textContent,l,e),s=["children",""+l]):ur.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&B("scroll",a)}switch(n){case"input":Mr(a),zi(a,o,!0);break;case"textarea":Mr(a),Bi(a);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(a.onclick=Sa)}a=s,t.updateQueue=a,a!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ec(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=i.createElement(n,{is:a.is}):(e=i.createElement(n),n==="select"&&(i=e,a.multiple?i.multiple=!0:a.size&&(i.size=a.size))):e=i.createElementNS(e,n),e[tt]=t,e[br]=a,eu(e,t,!1,!1),t.stateNode=e;e:{switch(i=Js(n,a),n){case"dialog":B("cancel",e),B("close",e),s=a;break;case"iframe":case"object":case"embed":B("load",e),s=a;break;case"video":case"audio":for(s=0;s<Jn.length;s++)B(Jn[s],e);s=a;break;case"source":B("error",e),s=a;break;case"img":case"image":case"link":B("error",e),B("load",e),s=a;break;case"details":B("toggle",e),s=a;break;case"input":Ui(e,a),s=Zs(e,a),B("invalid",e);break;case"option":s=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},s=Y({},a,{value:void 0}),B("invalid",e);break;case"textarea":$i(e,a),s=Qs(e,a),B("invalid",e);break;default:s=a}Xs(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?Lc(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Pc(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&pr(e,c):typeof c=="number"&&pr(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ur.hasOwnProperty(o)?c!=null&&o==="onScroll"&&B("scroll",e):c!=null&&Uo(e,o,c,i))}switch(n){case"input":Mr(e),zi(e,a,!1);break;case"textarea":Mr(e),Bi(e);break;case"option":a.value!=null&&e.setAttribute("value",""+It(a.value));break;case"select":e.multiple=!!a.multiple,o=a.value,o!=null?kn(e,!!a.multiple,o,!1):a.defaultValue!=null&&kn(e,!!a.multiple,a.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Sa)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return he(t),null;case 6:if(e&&t.stateNode!=null)nu(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(C(166));if(n=Bt(Sr.current),Bt(rt.current),Br(t)){if(a=t.stateNode,n=t.memoizedProps,a[tt]=t,(o=a.nodeValue!==n)&&(e=Ie,e!==null))switch(e.tag){case 3:$r(a.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$r(a.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else a=(n.nodeType===9?n:n.ownerDocument).createTextNode(a),a[tt]=t,t.stateNode=a}return he(t),null;case 13:if(Z(K),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(q&&Pe!==null&&t.mode&1&&!(t.flags&128))xd(),In(),t.flags|=98560,o=!1;else if(o=Br(t),a!==null&&a.dehydrated!==null){if(e===null){if(!o)throw Error(C(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(C(317));o[tt]=t}else In(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;he(t),o=!1}else Ze!==null&&(Ro(Ze),Ze=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||K.current&1?oe===0&&(oe=3):Ci())),t.updateQueue!==null&&(t.flags|=4),he(t),null);case 4:return Rn(),Ao(e,t),e===null&&vr(t.stateNode.containerInfo),he(t),null;case 10:return li(t.type._context),he(t),null;case 17:return je(t.type)&&ka(),he(t),null;case 19:if(Z(K),o=t.memoizedState,o===null)return he(t),null;if(a=(t.flags&128)!==0,i=o.rendering,i===null)if(a)Zn(o,!1);else{if(oe!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Pa(e),i!==null){for(t.flags|=128,Zn(o,!1),a=i.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;n!==null;)o=n,e=a,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return $(K,K.current&1|2),t.child}e=e.sibling}o.tail!==null&&te()>Dn&&(t.flags|=128,a=!0,Zn(o,!1),t.lanes=4194304)}else{if(!a)if(e=Pa(i),e!==null){if(t.flags|=128,a=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Zn(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!q)return he(t),null}else 2*te()-o.renderingStartTime>Dn&&n!==1073741824&&(t.flags|=128,a=!0,Zn(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=te(),t.sibling=null,n=K.current,$(K,a?n&1|2:n&1),t):(he(t),null);case 22:case 23:return ki(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?Ee&1073741824&&(he(t),t.subtreeFlags&6&&(t.flags|=8192)):he(t),null;case 24:return null;case 25:return null}throw Error(C(156,t.tag))}function $0(e,t){switch(ai(t),t.tag){case 1:return je(t.type)&&ka(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Rn(),Z(Ne),Z(ye),mi(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pi(t),null;case 13:if(Z(K),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(C(340));In()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Z(K),null;case 4:return Rn(),null;case 10:return li(t.type._context),null;case 22:case 23:return ki(),null;case 24:return null;default:return null}}var Kr=!1,_e=!1,B0=typeof WeakSet=="function"?WeakSet:Set,L=null;function wn(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(a){X(e,t,a)}else n.current=null}function No(e,t,n){try{n()}catch(a){X(e,t,a)}}var Ol=!1;function Z0(e,t){if(co=xa,e=id(),ni(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var a=n.getSelection&&n.getSelection();if(a&&a.rangeCount!==0){n=a.anchorNode;var s=a.anchorOffset,o=a.focusNode;a=a.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,c=-1,d=0,u=0,m=e,g=null;t:for(;;){for(var v;m!==n||s!==0&&m.nodeType!==3||(l=i+s),m!==o||a!==0&&m.nodeType!==3||(c=i+a),m.nodeType===3&&(i+=m.nodeValue.length),(v=m.firstChild)!==null;)g=m,m=v;for(;;){if(m===e)break t;if(g===n&&++d===s&&(l=i),g===o&&++u===a&&(c=i),(v=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=v}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(uo={focusedElem:e,selectionRange:n},xa=!1,L=t;L!==null;)if(t=L,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,L=e;else for(;L!==null;){t=L;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b.memoizedProps,O=b.memoizedState,h=t.stateNode,p=h.getSnapshotBeforeUpdate(t.elementType===t.type?y:$e(t.type,y),O);h.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var f=t.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(C(163))}}catch(w){X(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,L=e;break}L=t.return}return b=Ol,Ol=!1,b}function ir(e,t,n){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&No(t,n,o)}s=s.next}while(s!==a)}}function qa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function jo(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function ru(e){var t=e.alternate;t!==null&&(e.alternate=null,ru(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[tt],delete t[br],delete t[go],delete t[T0],delete t[E0])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function au(e){return e.tag===5||e.tag===3||e.tag===4}function Dl(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||au(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function To(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Sa));else if(a!==4&&(e=e.child,e!==null))for(To(e,t,n),e=e.sibling;e!==null;)To(e,t,n),e=e.sibling}function Eo(e,t,n){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Eo(e,t,n),e=e.sibling;e!==null;)Eo(e,t,n),e=e.sibling}var pe=null,Be=!1;function ht(e,t,n){for(n=n.child;n!==null;)su(e,t,n),n=n.sibling}function su(e,t,n){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(Ha,n)}catch{}switch(n.tag){case 5:_e||wn(n,t);case 6:var a=pe,s=Be;pe=null,ht(e,t,n),pe=a,Be=s,pe!==null&&(Be?(e=pe,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):pe.removeChild(n.stateNode));break;case 18:pe!==null&&(Be?(e=pe,n=n.stateNode,e.nodeType===8?vs(e.parentNode,n):e.nodeType===1&&vs(e,n),hr(e)):vs(pe,n.stateNode));break;case 4:a=pe,s=Be,pe=n.stateNode.containerInfo,Be=!0,ht(e,t,n),pe=a,Be=s;break;case 0:case 11:case 14:case 15:if(!_e&&(a=n.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){s=a=a.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&No(n,t,i),s=s.next}while(s!==a)}ht(e,t,n);break;case 1:if(!_e&&(wn(n,t),a=n.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(l){X(n,t,l)}ht(e,t,n);break;case 21:ht(e,t,n);break;case 22:n.mode&1?(_e=(a=_e)||n.memoizedState!==null,ht(e,t,n),_e=a):ht(e,t,n);break;default:ht(e,t,n)}}function Ml(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new B0),t.forEach(function(a){var s=nm.bind(null,e,a);n.has(a)||(n.add(a),a.then(s,s))})}}function Ue(e,t){var n=t.deletions;if(n!==null)for(var a=0;a<n.length;a++){var s=n[a];try{var o=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:pe=l.stateNode,Be=!1;break e;case 3:pe=l.stateNode.containerInfo,Be=!0;break e;case 4:pe=l.stateNode.containerInfo,Be=!0;break e}l=l.return}if(pe===null)throw Error(C(160));su(o,i,s),pe=null,Be=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){X(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ou(t,e),t=t.sibling}function ou(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ue(t,e),Ye(e),a&4){try{ir(3,e,e.return),qa(3,e)}catch(y){X(e,e.return,y)}try{ir(5,e,e.return)}catch(y){X(e,e.return,y)}}break;case 1:Ue(t,e),Ye(e),a&512&&n!==null&&wn(n,n.return);break;case 5:if(Ue(t,e),Ye(e),a&512&&n!==null&&wn(n,n.return),e.flags&32){var s=e.stateNode;try{pr(s,"")}catch(y){X(e,e.return,y)}}if(a&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&jc(s,o),Js(l,i);var d=Js(l,o);for(i=0;i<c.length;i+=2){var u=c[i],m=c[i+1];u==="style"?Lc(s,m):u==="dangerouslySetInnerHTML"?Pc(s,m):u==="children"?pr(s,m):Uo(s,u,m,d)}switch(l){case"input":qs(s,o);break;case"textarea":Tc(s,o);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var v=o.value;v!=null?kn(s,!!o.multiple,v,!1):g!==!!o.multiple&&(o.defaultValue!=null?kn(s,!!o.multiple,o.defaultValue,!0):kn(s,!!o.multiple,o.multiple?[]:"",!1))}s[br]=o}catch(y){X(e,e.return,y)}}break;case 6:if(Ue(t,e),Ye(e),a&4){if(e.stateNode===null)throw Error(C(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(y){X(e,e.return,y)}}break;case 3:if(Ue(t,e),Ye(e),a&4&&n!==null&&n.memoizedState.isDehydrated)try{hr(t.containerInfo)}catch(y){X(e,e.return,y)}break;case 4:Ue(t,e),Ye(e);break;case 13:Ue(t,e),Ye(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(wi=te())),a&4&&Ml(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(_e=(d=_e)||u,Ue(t,e),_e=d):Ue(t,e),Ye(e),a&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(L=e,u=e.child;u!==null;){for(m=L=u;L!==null;){switch(g=L,v=g.child,g.tag){case 0:case 11:case 14:case 15:ir(4,g,g.return);break;case 1:wn(g,g.return);var b=g.stateNode;if(typeof b.componentWillUnmount=="function"){a=g,n=g.return;try{t=a,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(y){X(a,n,y)}}break;case 5:wn(g,g.return);break;case 22:if(g.memoizedState!==null){Vl(m);continue}}v!==null?(v.return=g,L=v):Vl(m)}u=u.sibling}e:for(u=null,m=e;;){if(m.tag===5){if(u===null){u=m;try{s=m.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=m.stateNode,c=m.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Ic("display",i))}catch(y){X(e,e.return,y)}}}else if(m.tag===6){if(u===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(y){X(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Ue(t,e),Ye(e),a&4&&Ml(e);break;case 21:break;default:Ue(t,e),Ye(e)}}function Ye(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(au(n)){var a=n;break e}n=n.return}throw Error(C(160))}switch(a.tag){case 5:var s=a.stateNode;a.flags&32&&(pr(s,""),a.flags&=-33);var o=Dl(e);Eo(e,o,s);break;case 3:case 4:var i=a.stateNode.containerInfo,l=Dl(e);To(e,l,i);break;default:throw Error(C(161))}}catch(c){X(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function q0(e,t,n){L=e,iu(e)}function iu(e,t,n){for(var a=(e.mode&1)!==0;L!==null;){var s=L,o=s.child;if(s.tag===22&&a){var i=s.memoizedState!==null||Kr;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||_e;l=Kr;var d=_e;if(Kr=i,(_e=c)&&!d)for(L=s;L!==null;)i=L,c=i.child,i.tag===22&&i.memoizedState!==null?Hl(s):c!==null?(c.return=i,L=c):Hl(s);for(;o!==null;)L=o,iu(o),o=o.sibling;L=s,Kr=l,_e=d}Gl(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,L=o):Gl(e)}}function Gl(e){for(;L!==null;){var t=L;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_e||qa(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!_e)if(n===null)a.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:$e(t.type,n.memoizedProps);a.componentDidUpdate(s,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&wl(t,o,a);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}wl(t,i,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var m=u.dehydrated;m!==null&&hr(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(C(163))}_e||t.flags&512&&jo(t)}catch(g){X(t,t.return,g)}}if(t===e){L=null;break}if(n=t.sibling,n!==null){n.return=t.return,L=n;break}L=t.return}}function Vl(e){for(;L!==null;){var t=L;if(t===e){L=null;break}var n=t.sibling;if(n!==null){n.return=t.return,L=n;break}L=t.return}}function Hl(e){for(;L!==null;){var t=L;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{qa(4,t)}catch(c){X(t,n,c)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var s=t.return;try{a.componentDidMount()}catch(c){X(t,s,c)}}var o=t.return;try{jo(t)}catch(c){X(t,o,c)}break;case 5:var i=t.return;try{jo(t)}catch(c){X(t,i,c)}}}catch(c){X(t,t.return,c)}if(t===e){L=null;break}var l=t.sibling;if(l!==null){l.return=t.return,L=l;break}L=t.return}}var K0=Math.ceil,Ra=ft.ReactCurrentDispatcher,xi=ft.ReactCurrentOwner,He=ft.ReactCurrentBatchConfig,W=0,ce=null,ne=null,me=0,Ee=0,Sn=Ot(0),oe=0,Nr=null,en=0,Ka=0,bi=0,lr=null,Ce=null,wi=0,Dn=1/0,ot=null,Oa=!1,Po=null,Tt=null,Qr=!1,St=null,Da=0,cr=0,Io=null,ua=-1,pa=0;function be(){return W&6?te():ua!==-1?ua:ua=te()}function Et(e){return e.mode&1?W&2&&me!==0?me&-me:I0.transition!==null?(pa===0&&(pa=$c()),pa):(e=z,e!==0||(e=window.event,e=e===void 0?16:Xc(e.type)),e):1}function Ke(e,t,n,a){if(50<cr)throw cr=0,Io=null,Error(C(185));Tr(e,n,a),(!(W&2)||e!==ce)&&(e===ce&&(!(W&2)&&(Ka|=n),oe===4&&bt(e,me)),Te(e,a),n===1&&W===0&&!(t.mode&1)&&(Dn=te()+500,$a&&Dt()))}function Te(e,t){var n=e.callbackNode;Ip(e,t);var a=va(e,e===ce?me:0);if(a===0)n!==null&&Ki(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(n!=null&&Ki(n),t===1)e.tag===0?P0(Fl.bind(null,e)):_d(Fl.bind(null,e)),N0(function(){!(W&6)&&Dt()}),n=null;else{switch(Bc(a)){case 1:n=qo;break;case 4:n=Uc;break;case 16:n=ya;break;case 536870912:n=zc;break;default:n=ya}n=fu(n,lu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function lu(e,t){if(ua=-1,pa=0,W&6)throw Error(C(327));var n=e.callbackNode;if(Tn()&&e.callbackNode!==n)return null;var a=va(e,e===ce?me:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Ma(e,a);else{t=a;var s=W;W|=2;var o=du();(ce!==e||me!==t)&&(ot=null,Dn=te()+500,Kt(e,t));do try{X0();break}catch(l){cu(e,l)}while(!0);ii(),Ra.current=o,W=s,ne!==null?t=0:(ce=null,me=0,t=oe)}if(t!==0){if(t===2&&(s=ao(e),s!==0&&(a=s,t=Lo(e,s))),t===1)throw n=Nr,Kt(e,0),bt(e,a),Te(e,te()),n;if(t===6)bt(e,a);else{if(s=e.current.alternate,!(a&30)&&!Q0(s)&&(t=Ma(e,a),t===2&&(o=ao(e),o!==0&&(a=o,t=Lo(e,o))),t===1))throw n=Nr,Kt(e,0),bt(e,a),Te(e,te()),n;switch(e.finishedWork=s,e.finishedLanes=a,t){case 0:case 1:throw Error(C(345));case 2:Wt(e,Ce,ot);break;case 3:if(bt(e,a),(a&130023424)===a&&(t=wi+500-te(),10<t)){if(va(e,0)!==0)break;if(s=e.suspendedLanes,(s&a)!==a){be(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=mo(Wt.bind(null,e,Ce,ot),t);break}Wt(e,Ce,ot);break;case 4:if(bt(e,a),(a&4194240)===a)break;for(t=e.eventTimes,s=-1;0<a;){var i=31-qe(a);o=1<<i,i=t[i],i>s&&(s=i),a&=~o}if(a=s,a=te()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*K0(a/1960))-a,10<a){e.timeoutHandle=mo(Wt.bind(null,e,Ce,ot),a);break}Wt(e,Ce,ot);break;case 5:Wt(e,Ce,ot);break;default:throw Error(C(329))}}}return Te(e,te()),e.callbackNode===n?lu.bind(null,e):null}function Lo(e,t){var n=lr;return e.current.memoizedState.isDehydrated&&(Kt(e,t).flags|=256),e=Ma(e,t),e!==2&&(t=Ce,Ce=n,t!==null&&Ro(t)),e}function Ro(e){Ce===null?Ce=e:Ce.push.apply(Ce,e)}function Q0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var a=0;a<n.length;a++){var s=n[a],o=s.getSnapshot;s=s.value;try{if(!Qe(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bt(e,t){for(t&=~bi,t&=~Ka,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qe(t),a=1<<n;e[n]=-1,t&=~a}}function Fl(e){if(W&6)throw Error(C(327));Tn();var t=va(e,0);if(!(t&1))return Te(e,te()),null;var n=Ma(e,t);if(e.tag!==0&&n===2){var a=ao(e);a!==0&&(t=a,n=Lo(e,a))}if(n===1)throw n=Nr,Kt(e,0),bt(e,t),Te(e,te()),n;if(n===6)throw Error(C(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Wt(e,Ce,ot),Te(e,te()),null}function Si(e,t){var n=W;W|=1;try{return e(t)}finally{W=n,W===0&&(Dn=te()+500,$a&&Dt())}}function tn(e){St!==null&&St.tag===0&&!(W&6)&&Tn();var t=W;W|=1;var n=He.transition,a=z;try{if(He.transition=null,z=1,e)return e()}finally{z=a,He.transition=n,W=t,!(W&6)&&Dt()}}function ki(){Ee=Sn.current,Z(Sn)}function Kt(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,A0(n)),ne!==null)for(n=ne.return;n!==null;){var a=n;switch(ai(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&ka();break;case 3:Rn(),Z(Ne),Z(ye),mi();break;case 5:pi(a);break;case 4:Rn();break;case 13:Z(K);break;case 19:Z(K);break;case 10:li(a.type._context);break;case 22:case 23:ki()}n=n.return}if(ce=e,ne=e=Pt(e.current,null),me=Ee=t,oe=0,Nr=null,bi=Ka=en=0,Ce=lr=null,$t!==null){for(t=0;t<$t.length;t++)if(n=$t[t],a=n.interleaved,a!==null){n.interleaved=null;var s=a.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,a.next=i}n.pending=a}$t=null}return e}function cu(e,t){do{var n=ne;try{if(ii(),la.current=La,Ia){for(var a=Q.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Ia=!1}if(Jt=0,le=se=Q=null,or=!1,kr=0,xi.current=null,n===null||n.return===null){oe=1,Nr=t,ne=null;break}e:{var o=e,i=n.return,l=n,c=t;if(t=me,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,m=u.tag;if(!(u.mode&1)&&(m===0||m===11||m===15)){var g=u.alternate;g?(u.updateQueue=g.updateQueue,u.memoizedState=g.memoizedState,u.lanes=g.lanes):(u.updateQueue=null,u.memoizedState=null)}var v=jl(i);if(v!==null){v.flags&=-257,Tl(v,i,l,o,t),v.mode&1&&Nl(o,d,t),t=v,c=d;var b=t.updateQueue;if(b===null){var y=new Set;y.add(c),t.updateQueue=y}else b.add(c);break e}else{if(!(t&1)){Nl(o,d,t),Ci();break e}c=Error(C(426))}}else if(q&&l.mode&1){var O=jl(i);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Tl(O,i,l,o,t),si(On(c,l));break e}}o=c=On(c,l),oe!==4&&(oe=2),lr===null?lr=[o]:lr.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var h=Bd(o,c,t);bl(o,h);break e;case 1:l=c;var p=o.type,f=o.stateNode;if(!(o.flags&128)&&(typeof p.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Tt===null||!Tt.has(f)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=Zd(o,l,t);bl(o,w);break e}}o=o.return}while(o!==null)}pu(n)}catch(S){t=S,ne===n&&n!==null&&(ne=n=n.return);continue}break}while(!0)}function du(){var e=Ra.current;return Ra.current=La,e===null?La:e}function Ci(){(oe===0||oe===3||oe===2)&&(oe=4),ce===null||!(en&268435455)&&!(Ka&268435455)||bt(ce,me)}function Ma(e,t){var n=W;W|=2;var a=du();(ce!==e||me!==t)&&(ot=null,Kt(e,t));do try{Y0();break}catch(s){cu(e,s)}while(!0);if(ii(),W=n,Ra.current=a,ne!==null)throw Error(C(261));return ce=null,me=0,oe}function Y0(){for(;ne!==null;)uu(ne)}function X0(){for(;ne!==null&&!Sp();)uu(ne)}function uu(e){var t=gu(e.alternate,e,Ee);e.memoizedProps=e.pendingProps,t===null?pu(e):ne=t,xi.current=null}function pu(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=$0(n,t),n!==null){n.flags&=32767,ne=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{oe=6,ne=null;return}}else if(n=z0(n,t,Ee),n!==null){ne=n;return}if(t=t.sibling,t!==null){ne=t;return}ne=t=e}while(t!==null);oe===0&&(oe=5)}function Wt(e,t,n){var a=z,s=He.transition;try{He.transition=null,z=1,J0(e,t,n,a)}finally{He.transition=s,z=a}return null}function J0(e,t,n,a){do Tn();while(St!==null);if(W&6)throw Error(C(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(C(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Lp(e,o),e===ce&&(ne=ce=null,me=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qr||(Qr=!0,fu(ya,function(){return Tn(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=He.transition,He.transition=null;var i=z;z=1;var l=W;W|=4,xi.current=null,Z0(e,n),ou(n,e),v0(uo),xa=!!co,uo=co=null,e.current=n,q0(n),kp(),W=l,z=i,He.transition=o}else e.current=n;if(Qr&&(Qr=!1,St=e,Da=s),o=e.pendingLanes,o===0&&(Tt=null),Np(n.stateNode),Te(e,te()),t!==null)for(a=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],a(s.value,{componentStack:s.stack,digest:s.digest});if(Oa)throw Oa=!1,e=Po,Po=null,e;return Da&1&&e.tag!==0&&Tn(),o=e.pendingLanes,o&1?e===Io?cr++:(cr=0,Io=e):cr=0,Dt(),null}function Tn(){if(St!==null){var e=Bc(Da),t=He.transition,n=z;try{if(He.transition=null,z=16>e?16:e,St===null)var a=!1;else{if(e=St,St=null,Da=0,W&6)throw Error(C(331));var s=W;for(W|=4,L=e.current;L!==null;){var o=L,i=o.child;if(L.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(L=d;L!==null;){var u=L;switch(u.tag){case 0:case 11:case 15:ir(8,u,o)}var m=u.child;if(m!==null)m.return=u,L=m;else for(;L!==null;){u=L;var g=u.sibling,v=u.return;if(ru(u),u===d){L=null;break}if(g!==null){g.return=v,L=g;break}L=v}}}var b=o.alternate;if(b!==null){var y=b.child;if(y!==null){b.child=null;do{var O=y.sibling;y.sibling=null,y=O}while(y!==null)}}L=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,L=i;else e:for(;L!==null;){if(o=L,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ir(9,o,o.return)}var h=o.sibling;if(h!==null){h.return=o.return,L=h;break e}L=o.return}}var p=e.current;for(L=p;L!==null;){i=L;var f=i.child;if(i.subtreeFlags&2064&&f!==null)f.return=i,L=f;else e:for(i=p;L!==null;){if(l=L,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:qa(9,l)}}catch(S){X(l,l.return,S)}if(l===i){L=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,L=w;break e}L=l.return}}if(W=s,Dt(),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(Ha,e)}catch{}a=!0}return a}finally{z=n,He.transition=t}}return!1}function Wl(e,t,n){t=On(n,t),t=Bd(e,t,1),e=jt(e,t,1),t=be(),e!==null&&(Tr(e,1,t),Te(e,t))}function X(e,t,n){if(e.tag===3)Wl(e,e,n);else for(;t!==null;){if(t.tag===3){Wl(t,e,n);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Tt===null||!Tt.has(a))){e=On(n,e),e=Zd(t,e,1),t=jt(t,e,1),e=be(),t!==null&&(Tr(t,1,e),Te(t,e));break}}t=t.return}}function em(e,t,n){var a=e.pingCache;a!==null&&a.delete(t),t=be(),e.pingedLanes|=e.suspendedLanes&n,ce===e&&(me&n)===n&&(oe===4||oe===3&&(me&130023424)===me&&500>te()-wi?Kt(e,0):bi|=n),Te(e,t)}function mu(e,t){t===0&&(e.mode&1?(t=Hr,Hr<<=1,!(Hr&130023424)&&(Hr=4194304)):t=1);var n=be();e=mt(e,t),e!==null&&(Tr(e,t,n),Te(e,n))}function tm(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),mu(e,n)}function nm(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(C(314))}a!==null&&a.delete(t),mu(e,n)}var gu;gu=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ne.current)Ae=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ae=!1,U0(e,t,n);Ae=!!(e.flags&131072)}else Ae=!1,q&&t.flags&1048576&&yd(t,Na,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;da(e,t),e=t.pendingProps;var s=Pn(t,ye.current);jn(t,n),s=fi(null,t,a,e,s,n);var o=hi();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,je(a)?(o=!0,Ca(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,di(t),s.updater=Za,t.stateNode=s,s._reactInternals=t,xo(t,a,e,n),t=So(null,t,a,!0,o,n)):(t.tag=0,q&&o&&ri(t),xe(null,t,s,n),t=t.child),t;case 16:a=t.elementType;e:{switch(da(e,t),e=t.pendingProps,s=a._init,a=s(a._payload),t.type=a,s=t.tag=am(a),e=$e(a,e),s){case 0:t=wo(null,t,a,e,n);break e;case 1:t=Il(null,t,a,e,n);break e;case 11:t=El(null,t,a,e,n);break e;case 14:t=Pl(null,t,a,$e(a.type,e),n);break e}throw Error(C(306,a,""))}return t;case 0:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:$e(a,s),wo(e,t,a,s,n);case 1:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:$e(a,s),Il(e,t,a,s,n);case 3:e:{if(Yd(t),e===null)throw Error(C(387));a=t.pendingProps,o=t.memoizedState,s=o.element,kd(e,t),Ea(t,a,null,n);var i=t.memoizedState;if(a=i.element,o.isDehydrated)if(o={element:a,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=On(Error(C(423)),t),t=Ll(e,t,a,n,s);break e}else if(a!==s){s=On(Error(C(424)),t),t=Ll(e,t,a,n,s);break e}else for(Pe=Nt(t.stateNode.containerInfo.firstChild),Ie=t,q=!0,Ze=null,n=wd(t,null,a,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(In(),a===s){t=gt(e,t,n);break e}xe(e,t,a,n)}t=t.child}return t;case 5:return Cd(t),e===null&&_o(t),a=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,po(a,s)?i=null:o!==null&&po(a,o)&&(t.flags|=32),Qd(e,t),xe(e,t,i,n),t.child;case 6:return e===null&&_o(t),null;case 13:return Xd(e,t,n);case 4:return ui(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Ln(t,null,a,n):xe(e,t,a,n),t.child;case 11:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:$e(a,s),El(e,t,a,s,n);case 7:return xe(e,t,t.pendingProps,n),t.child;case 8:return xe(e,t,t.pendingProps.children,n),t.child;case 12:return xe(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,$(ja,a._currentValue),a._currentValue=i,o!==null)if(Qe(o.value,i)){if(o.children===s.children&&!Ne.current){t=gt(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===a){if(o.tag===1){c=dt(-1,n&-n),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),yo(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(C(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),yo(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}xe(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,a=t.pendingProps.children,jn(t,n),s=Fe(s),a=a(s),t.flags|=1,xe(e,t,a,n),t.child;case 14:return a=t.type,s=$e(a,t.pendingProps),s=$e(a.type,s),Pl(e,t,a,s,n);case 15:return qd(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:$e(a,s),da(e,t),t.tag=1,je(a)?(e=!0,Ca(t)):e=!1,jn(t,n),$d(t,a,s),xo(t,a,s,n),So(null,t,a,!0,e,n);case 19:return Jd(e,t,n);case 22:return Kd(e,t,n)}throw Error(C(156,t.tag))};function fu(e,t){return Wc(e,t)}function rm(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ve(e,t,n,a){return new rm(e,t,n,a)}function Ai(e){return e=e.prototype,!(!e||!e.isReactComponent)}function am(e){if(typeof e=="function")return Ai(e)?1:0;if(e!=null){if(e=e.$$typeof,e===$o)return 11;if(e===Bo)return 14}return 2}function Pt(e,t){var n=e.alternate;return n===null?(n=Ve(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ma(e,t,n,a,s,o){var i=2;if(a=e,typeof e=="function")Ai(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case mn:return Qt(n.children,s,o,t);case zo:i=8,s|=8;break;case Us:return e=Ve(12,n,t,s|2),e.elementType=Us,e.lanes=o,e;case zs:return e=Ve(13,n,t,s),e.elementType=zs,e.lanes=o,e;case $s:return e=Ve(19,n,t,s),e.elementType=$s,e.lanes=o,e;case Cc:return Qa(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Sc:i=10;break e;case kc:i=9;break e;case $o:i=11;break e;case Bo:i=14;break e;case yt:i=16,a=null;break e}throw Error(C(130,e==null?e:typeof e,""))}return t=Ve(i,n,t,s),t.elementType=e,t.type=a,t.lanes=o,t}function Qt(e,t,n,a){return e=Ve(7,e,a,t),e.lanes=n,e}function Qa(e,t,n,a){return e=Ve(22,e,a,t),e.elementType=Cc,e.lanes=n,e.stateNode={isHidden:!1},e}function Ns(e,t,n){return e=Ve(6,e,null,t),e.lanes=n,e}function js(e,t,n){return t=Ve(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sm(e,t,n,a,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ls(0),this.expirationTimes=ls(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ls(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ni(e,t,n,a,s,o,i,l,c){return e=new sm(e,t,n,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ve(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},di(o),e}function om(e,t,n){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pn,key:a==null?null:""+a,children:e,containerInfo:t,implementation:n}}function hu(e){if(!e)return Lt;e=e._reactInternals;e:{if(an(e)!==e||e.tag!==1)throw Error(C(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(je(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(C(171))}if(e.tag===1){var n=e.type;if(je(n))return hd(e,n,t)}return t}function _u(e,t,n,a,s,o,i,l,c){return e=Ni(n,a,!0,e,s,o,i,l,c),e.context=hu(null),n=e.current,a=be(),s=Et(n),o=dt(a,s),o.callback=t??null,jt(n,o,s),e.current.lanes=s,Tr(e,s,a),Te(e,a),e}function Ya(e,t,n,a){var s=t.current,o=be(),i=Et(s);return n=hu(n),t.context===null?t.context=n:t.pendingContext=n,t=dt(o,i),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=jt(s,t,i),e!==null&&(Ke(e,s,i,o),ia(e,s,i)),i}function Ga(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ul(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ji(e,t){Ul(e,t),(e=e.alternate)&&Ul(e,t)}function im(){return null}var yu=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ti(e){this._internalRoot=e}Xa.prototype.render=Ti.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(C(409));Ya(e,t,null,null)};Xa.prototype.unmount=Ti.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;tn(function(){Ya(null,e,null,null)}),t[pt]=null}};function Xa(e){this._internalRoot=e}Xa.prototype.unstable_scheduleHydration=function(e){if(e){var t=Kc();e={blockedOn:null,target:e,priority:t};for(var n=0;n<xt.length&&t!==0&&t<xt[n].priority;n++);xt.splice(n,0,e),n===0&&Yc(e)}};function Ei(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ja(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function zl(){}function lm(e,t,n,a,s){if(s){if(typeof a=="function"){var o=a;a=function(){var d=Ga(i);o.call(d)}}var i=_u(t,a,e,0,null,!1,!1,"",zl);return e._reactRootContainer=i,e[pt]=i.current,vr(e.nodeType===8?e.parentNode:e),tn(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof a=="function"){var l=a;a=function(){var d=Ga(c);l.call(d)}}var c=Ni(e,0,!1,null,null,!1,!1,"",zl);return e._reactRootContainer=c,e[pt]=c.current,vr(e.nodeType===8?e.parentNode:e),tn(function(){Ya(t,c,n,a)}),c}function es(e,t,n,a,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var c=Ga(i);l.call(c)}}Ya(t,i,e,s)}else i=lm(n,t,e,s,a);return Ga(i)}Zc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Xn(t.pendingLanes);n!==0&&(Ko(t,n|1),Te(t,te()),!(W&6)&&(Dn=te()+500,Dt()))}break;case 13:tn(function(){var a=mt(e,1);if(a!==null){var s=be();Ke(a,e,1,s)}}),ji(e,1)}};Qo=function(e){if(e.tag===13){var t=mt(e,134217728);if(t!==null){var n=be();Ke(t,e,134217728,n)}ji(e,134217728)}};qc=function(e){if(e.tag===13){var t=Et(e),n=mt(e,t);if(n!==null){var a=be();Ke(n,e,t,a)}ji(e,t)}};Kc=function(){return z};Qc=function(e,t){var n=z;try{return z=e,t()}finally{z=n}};to=function(e,t,n){switch(t){case"input":if(qs(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var s=za(a);if(!s)throw Error(C(90));Nc(a),qs(a,s)}}}break;case"textarea":Tc(e,n);break;case"select":t=n.value,t!=null&&kn(e,!!n.multiple,t,!1)}};Dc=Si;Mc=tn;var cm={usingClientEntryPoint:!1,Events:[Pr,_n,za,Rc,Oc,Si]},qn={findFiberByHostInstance:zt,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dm={bundleType:qn.bundleType,version:qn.version,rendererPackageName:qn.rendererPackageName,rendererConfig:qn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ft.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Hc(e),e===null?null:e.stateNode},findFiberByHostInstance:qn.findFiberByHostInstance||im,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yr.isDisabled&&Yr.supportsFiber)try{Ha=Yr.inject(dm),nt=Yr}catch{}}Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cm;Re.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ei(t))throw Error(C(200));return om(e,t,null,n)};Re.createRoot=function(e,t){if(!Ei(e))throw Error(C(299));var n=!1,a="",s=yu;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ni(e,1,!1,null,null,n,!1,a,s),e[pt]=t.current,vr(e.nodeType===8?e.parentNode:e),new Ti(t)};Re.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(C(188)):(e=Object.keys(e).join(","),Error(C(268,e)));return e=Hc(t),e=e===null?null:e.stateNode,e};Re.flushSync=function(e){return tn(e)};Re.hydrate=function(e,t,n){if(!Ja(t))throw Error(C(200));return es(null,e,t,!0,n)};Re.hydrateRoot=function(e,t,n){if(!Ei(e))throw Error(C(405));var a=n!=null&&n.hydratedSources||null,s=!1,o="",i=yu;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=_u(t,null,e,1,n??null,s,!1,o,i),e[pt]=t.current,vr(e),a)for(e=0;e<a.length;e++)n=a[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Xa(t)};Re.render=function(e,t,n){if(!Ja(t))throw Error(C(200));return es(null,e,t,!1,n)};Re.unmountComponentAtNode=function(e){if(!Ja(e))throw Error(C(40));return e._reactRootContainer?(tn(function(){es(null,null,e,!1,function(){e._reactRootContainer=null,e[pt]=null})}),!0):!1};Re.unstable_batchedUpdates=Si;Re.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!Ja(n))throw Error(C(200));if(e==null||e._reactInternals===void 0)throw Error(C(38));return es(e,t,n,!1,a)};Re.version="18.3.1-next-f1338f8080-20240426";function vu(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vu)}catch(e){console.error(e)}}vu(),vc.exports=Re;var um=vc.exports,$l=um;Fs.createRoot=$l.createRoot,Fs.hydrateRoot=$l.hydrateRoot;const pm={none:"",sm:"p-3",md:"p-4",lg:"p-6"},mm={default:"bg-slate-800 border border-slate-700",gradient:"bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700",bordered:"bg-slate-800/50 backdrop-blur-sm border border-slate-700"},R=({children:e,className:t="",variant:n="default",padding:a="lg",hover:s=!1})=>{const o="rounded-xl transition-all",i=s?"hover:border-slate-600 hover:scale-[1.02]":"";return r.jsx("div",{className:`${o} ${mm[n]} ${pm[a]} ${i} ${t}`,children:e})},J=({title:e,subtitle:t,action:n})=>r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-white",children:e}),t&&r.jsx("p",{className:"text-sm text-slate-400",children:t})]}),n]}),gm={success:"bg-emerald-500/20 text-emerald-400",error:"bg-red-500/20 text-red-400",warning:"bg-amber-500/20 text-amber-400",info:"bg-blue-500/20 text-blue-400",default:"bg-slate-500/20 text-slate-400"},fm={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"},ae=({children:e,variant:t="default",size:n="md",className:a="",pill:s=!0})=>{const o=s?"rounded-full":"rounded";return r.jsx("span",{className:`inline-flex items-center font-medium ${o} ${gm[t]} ${fm[n]} ${a}`,children:e})},hm=({change:e,trend:t})=>{const n=t==="up"?"success":t==="down"?"error":"default";return r.jsx(ae,{variant:n,size:"sm",children:e})},_m={primary:"bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:from-cyan-600 hover:to-blue-700 shadow-lg shadow-cyan-500/25",secondary:"bg-slate-700 text-white hover:bg-slate-600 border border-slate-600",ghost:"text-slate-400 hover:text-white hover:bg-slate-700",danger:"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30"},ym={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},G=({children:e,variant:t="primary",size:n="md",fullWidth:a=!1,isLoading:s=!1,leftIcon:o,rightIcon:i,className:l="",disabled:c,...d})=>{const u="inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-slate-900",m=a?"w-full":"",g=c||s?"opacity-50 cursor-not-allowed":"";return r.jsxs("button",{className:`${u} ${_m[t]} ${ym[n]} ${m} ${g} ${l}`,disabled:c||s,...d,children:[s?r.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):o,e,i]})},vm={sm:"h-1",md:"h-2",lg:"h-3"},er=({value:e,max:t=100,color:n="bg-cyan-500",label:a,showValue:s=!1,size:o="md",className:i=""})=>{const l=Math.min(100,Math.max(0,e/t*100));return r.jsxs("div",{className:i,children:[(a||s)&&r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a&&r.jsx("span",{className:"text-white font-medium",children:a}),s&&r.jsxs("span",{className:"text-slate-400",children:[l.toFixed(0),"%"]})]}),r.jsx("div",{className:`${vm[o]} bg-slate-700 rounded-full overflow-hidden`,children:r.jsx("div",{className:`h-full ${n} rounded-full transition-all duration-500`,style:{width:`${l}%`}})})]})},xm=({label:e,value:t,color:n})=>r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-white font-medium",children:e}),r.jsxs("span",{className:"text-slate-400",children:[t,"%"]})]}),r.jsx(er,{value:t,color:n,size:"md"})]}),bm=[{id:"dashboard",label:"Dashboard",icon:"dashboard"},{id:"compliance",label:"Compliance",icon:"compliance"},{id:"monitoring",label:"Real-Time Monitoring",icon:"monitoring"},{id:"dependencymap",label:"Dependency Map",icon:"topology"},{id:"incidents",label:"Incident Correlation",icon:"incidents"},{id:"cloudmanagement",label:"Cloud Management",icon:"cloud"},{id:"pathanalysis",label:"Path Analysis",icon:"path"},{id:"routeintelligence",label:"Route Intelligence",icon:"route"},{id:"tickets",label:"Create Ticket",icon:"ticket"},{id:"statusboard",label:"Ticket Status",icon:"kanban"},{id:"rulegenerator",label:"Rule Generator",icon:"code"},{id:"validation",label:"Validation",icon:"validation"},{id:"conflicts",label:"Conflict Detection",icon:"conflicts"},{id:"settings",label:"Settings",icon:"settings"}],Bl={dashboard:{title:"Executive Dashboard",subtitle:"High-level overview of security posture and operations"},compliance:{title:"Compliance Dashboard",subtitle:"Framework compliance scores and violation tracking"},monitoring:{title:"Real-Time Monitoring",subtitle:"Live metrics across AWS, Azure, GCP & On-Premises infrastructure"},dependencymap:{title:"Application Dependency Map",subtitle:"Real-time service topology with health scores and latency monitoring"},incidents:{title:"Incident Correlation",subtitle:"AI-powered root cause analysis across multi-cloud infrastructure"},cloudmanagement:{title:"Multi-Cloud Management",subtitle:"Unified view of AWS, Azure & GCP security controls"},pathanalysis:{title:"Network Path Analysis",subtitle:"Trace traffic flow through security controls and routing components"},routeintelligence:{title:"Route Intelligence",subtitle:"AI-powered anomaly detection for network routing issues"},tickets:{title:"Create Policy Change Request",subtitle:"ServiceNow Integration - Automated Risk Assessment"},statusboard:{title:"Ticket Status Board",subtitle:"Track policy change requests through approval workflow"},rulegenerator:{title:"Multi-Cloud Rule Generator",subtitle:"Generate platform-specific firewall rules from unified policy"},validation:{title:"Rule Validation Dashboard",subtitle:"Syntax, Conflict Detection & Compliance Validation"},conflicts:{title:"Conflict Detection Engine",subtitle:"Identify Allow/Deny conflicts, Shadowing & Redundancy issues"},settings:{title:"Settings & Configuration",subtitle:"Manage cloud connections, integrations, users, and system preferences"}},Zl="dashboard",Zt={score:{excellent:{stroke:"#10b981"},good:{stroke:"#06b6d4"},warning:{stroke:"#f59e0b"},critical:{stroke:"#ef4444"}},framework:{emerald:{bg:"bg-emerald-500",bgLight:"bg-emerald-500/10",border:"border-emerald-500/30",text:"text-emerald-400",gradient:"from-emerald-500 to-emerald-600"},blue:{bg:"bg-blue-500",bgLight:"bg-blue-500/10",border:"border-blue-500/30",text:"text-blue-400",gradient:"from-blue-500 to-blue-600"},purple:{bg:"bg-purple-500",bgLight:"bg-purple-500/10",border:"border-purple-500/30",text:"text-purple-400",gradient:"from-purple-500 to-purple-600"},amber:{bg:"bg-amber-500",bgLight:"bg-amber-500/10",border:"border-amber-500/30",text:"text-amber-400",gradient:"from-amber-500 to-amber-600"}},alert:{critical:{bg:"bg-red-500/10",border:"border-red-500/30",borderLeft:"border-l-red-500",hover:"hover:bg-red-500/20"},warning:{bg:"bg-amber-500/10",border:"border-amber-500/30",borderLeft:"border-l-amber-500",hover:"hover:bg-amber-500/20"},info:{bg:"bg-blue-500/10",border:"border-blue-500/30",borderLeft:"border-l-blue-500",hover:"hover:bg-blue-500/20"}}},wm={arcRatio:.75},ql={name:"Atlas AIOps",tagline:"Multi-Cloud Manager"},Pi={REAL_TIME:2e3,ALERTS:5e3,METRICS:1e3},xu={MAX_ALERTS:15,TRAFFIC_GRAPH_POINTS:60},Xr={activeConnections:{min:30,max:70},ingress:{min:10,max:40},egress:{min:8,max:35},firewallCpu:{min:50,max:85}},Kl={WARNING:60,CRITICAL:75},bu={sm:{width:80,radius:30,strokeWidth:6},md:{width:128,radius:45,strokeWidth:10},lg:{width:160,radius:55,strokeWidth:12}},Sm=e=>{switch(e){case"critical":return{stroke:Zt.score.critical.stroke,bg:"from-red-500/20 to-red-600/10",text:"text-red-400",dot:"bg-red-500 animate-pulse"};case"warning":return{stroke:Zt.score.warning.stroke,bg:"from-amber-500/20 to-amber-600/10",text:"text-amber-400",dot:"bg-amber-500 animate-pulse"};case"good":return{stroke:Zt.score.excellent.stroke,bg:"from-emerald-500/20 to-emerald-600/10",text:"text-emerald-400",dot:"bg-emerald-500"};default:return{stroke:Zt.score.good.stroke,bg:"from-cyan-500/20 to-cyan-600/10",text:"text-cyan-400",dot:"bg-cyan-500"}}},km=e=>{switch(e){case"critical":return"Critical";case"warning":return"Warning";case"good":case"normal":return"Normal";default:return"Unknown"}},Jr=({value:e,label:t,sublabel:n,status:a,icon:s,size:o="md",animated:i=!0})=>{const[l,c]=_.useState(0);_.useEffect(()=>{if(i){const b=setTimeout(()=>c(e),100);return()=>clearTimeout(b)}else c(e)},[e,i]);const d=bu[o],u=2*Math.PI*d.radius,m=wm.arcRatio,g=u-l/100*u*m,v=Sm(a);return r.jsxs("div",{className:`bg-gradient-to-br ${v.bg} backdrop-blur-sm rounded-2xl p-6 border border-white/10 hover:border-white/20 transition-all`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-white font-semibold text-lg",children:t}),n&&r.jsx("p",{className:"text-slate-400 text-sm",children:n})]}),s&&r.jsx("div",{className:"text-2xl",children:s})]}),r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsxs("div",{className:"relative",children:[r.jsxs("svg",{className:"transform -rotate-135",width:d.width,height:d.width,children:[r.jsx("circle",{cx:d.width/2,cy:d.width/2,r:d.radius,fill:"none",stroke:"rgba(255,255,255,0.1)",strokeWidth:d.strokeWidth,strokeDasharray:u,strokeDashoffset:u*(1-m),strokeLinecap:"round"}),r.jsx("circle",{cx:d.width/2,cy:d.width/2,r:d.radius,fill:"none",stroke:v.stroke,strokeWidth:d.strokeWidth,strokeDasharray:u,strokeDashoffset:g,strokeLinecap:"round",className:"transition-all duration-1000 ease-out",style:{filter:`drop-shadow(0 0 8px ${v.stroke})`}})]}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("span",{className:"text-3xl font-bold text-white",children:Math.round(l)}),r.jsx("span",{className:"text-lg text-slate-400",children:"%"})]})})]}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("div",{className:`w-3 h-3 rounded-full ${v.dot}`}),r.jsx("span",{className:`text-sm font-medium ${v.text}`,children:km(a)})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-500",children:"Current"}),r.jsxs("span",{className:"text-white font-mono",children:[Math.round(l),"%"]})]}),r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-500",children:"Max"}),r.jsx("span",{className:"text-white font-mono",children:"100%"})]})]})]})]})]})},Cm=({score:e,size:t="lg"})=>{const n=bu[t],a=2*Math.PI*(n.radius+5),s=e>=98?"#10b981":e>=95?"#06b6d4":"#f59e0b";return r.jsxs("div",{className:"relative",style:{width:n.width,height:n.width},children:[r.jsxs("svg",{className:"-rotate-90",width:n.width,height:n.width,children:[r.jsx("circle",{cx:n.width/2,cy:n.width/2,r:n.radius+5,fill:"none",stroke:"rgba(255,255,255,0.1)",strokeWidth:n.strokeWidth+2}),r.jsx("circle",{cx:n.width/2,cy:n.width/2,r:n.radius+5,fill:"none",stroke:s,strokeWidth:n.strokeWidth+2,strokeDasharray:`${e/100*a} ${a}`,strokeLinecap:"round",className:"transition-all duration-1000"})]}),r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[r.jsx("span",{className:"text-5xl font-bold text-white",children:e}),r.jsx("span",{className:"text-lg text-slate-400",children:"%"})]})]})},Am={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},Ql={success:"bg-emerald-500",error:"bg-red-500",warning:"bg-amber-500",info:"bg-blue-500",default:"bg-slate-500",operational:"bg-emerald-500",degraded:"bg-amber-500",down:"bg-red-500",critical:"bg-red-500"},Ii=({status:e,size:t="md",pulse:n=!1,className:a=""})=>{const s=Ql[e]||Ql.default,o=n||e==="critical"||e==="degraded"?"animate-pulse":"";return r.jsx("div",{className:`rounded-full ${Am[t]} ${s} ${o} ${a}`})},Nm=({label:e="LIVE",className:t=""})=>r.jsxs("div",{className:`flex items-center gap-2 ${t}`,children:[r.jsx(Ii,{status:"success",size:"md",pulse:!0}),r.jsx("span",{className:"text-emerald-400 font-medium",children:e})]}),jm=({name:e,status:t,latency:n,icon:a})=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{children:a}),r.jsx("span",{className:"text-white text-sm",children:e})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-slate-400 text-xs font-mono",children:n}),r.jsx(Ii,{status:t,pulse:t!=="operational"})]})]}),wu=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),Tm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Su=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Em=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Pm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Im=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),Lm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),Rm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),Om=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),Dm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),Mm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),Gm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Vm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),Hm=({className:e="w-5 h-5"})=>r.jsxs("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Fm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),ku=({className:e="w-6 h-6"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),Wm=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),Cu=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Um=({className:e="w-5 h-5"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),zm=({className:e="w-6 h-6"})=>r.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),$m={dashboard:wu,compliance:Tm,monitoring:Su,topology:Em,incidents:Pm,cloud:Im,path:Lm,route:Rm,ticket:Om,kanban:Dm,code:Mm,validation:Gm,conflicts:Vm,settings:Hm},Bm=({name:e,className:t})=>{const n=$m[e]||wu;return r.jsx(n,{className:t})},Zm=({value:e,onChange:t,placeholder:n="Search...",className:a=""})=>r.jsxs("div",{className:`relative ${a}`,children:[r.jsx("input",{type:"text",value:e,onChange:s=>t==null?void 0:t(s.target.value),placeholder:n,className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),r.jsx(Fm,{className:"w-5 h-5 text-slate-400 absolute left-3 top-2.5"})]}),qm=({time:e,label:t="Current Time (UTC)",format:n="24h",className:a=""})=>{const s=e.toLocaleTimeString("en-US",{hour12:n==="12h"});return r.jsxs("div",{className:`bg-slate-800 rounded-xl px-6 py-3 border border-slate-700 ${a}`,children:[r.jsx("div",{className:"text-xs text-slate-400 mb-1",children:t}),r.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:s})]})},Km=({time:e,label:t="Current Time (UTC)",format:n="24h",className:a=""})=>{const s=e.toLocaleTimeString("en-US",{hour12:n==="12h"});return r.jsxs("div",{className:`bg-slate-800/50 backdrop-blur-sm rounded-xl px-6 py-3 border border-slate-700 ${a}`,children:[r.jsx("div",{className:"text-xs text-slate-400 mb-1",children:t}),r.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:s})]})},Qm=({label:e,value:t,change:n,trend:a="stable",icon:s,className:o=""})=>r.jsxs(R,{hover:!0,className:o,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s&&r.jsx("span",{className:"text-3xl",children:s}),n&&r.jsx(hm,{change:n,trend:a})]}),r.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:t}),r.jsx("div",{className:"text-sm text-slate-400",children:e})]}),Ym=({label:e,value:t,unit:n="",icon:a,trend:s,colorClass:o="from-cyan-500/20 to-cyan-600/10"})=>{const i=l=>l.includes("")?"text-emerald-400":l.includes("")?"text-red-400":"text-slate-400";return r.jsxs("div",{className:`bg-gradient-to-br ${o} backdrop-blur-sm rounded-xl p-3 border border-white/10`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"text-slate-400 text-xs",children:e}),r.jsx("span",{className:"text-lg",children:a})]}),r.jsxs("div",{className:"flex items-baseline gap-1",children:[r.jsx("span",{className:"text-xl font-bold text-white",children:t}),r.jsx("span",{className:"text-slate-400 text-xs",children:n})]}),s&&r.jsx("div",{className:`text-xs mt-1 ${i(s)}`,children:s})]})},Ts=({label:e,value:t,valueColor:n="text-white"})=>r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`text-2xl font-bold ${n}`,children:t}),r.jsx("div",{className:"text-xs text-slate-400",children:e})]}),ea=({label:e,error:t,className:n="",...a})=>r.jsxs("div",{children:[e&&r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),r.jsx("input",{className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
          focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed
          ${t?"border-red-500":""} ${n}`,...a}),t&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:t})]}),Xm=({label:e,error:t,className:n="",children:a,...s})=>r.jsxs("div",{children:[e&&r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),r.jsx("select",{className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
          focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed
          ${t?"border-red-500":""} ${n}`,...s,children:a}),t&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:t})]}),Jm=({isOpen:e,onClose:t,title:n,children:a,size:s="md"})=>{if(!e)return null;const o={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};return r.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl w-full ${o[s]}`,onClick:i=>i.stopPropagation(),children:[n&&r.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a]})})]})},eg=({menuItems:e,activeView:t,collapsed:n,onViewChange:a,onToggleCollapse:s})=>r.jsxs("aside",{className:`${n?"w-20":"w-64"} bg-slate-800 border-r border-slate-700 flex flex-col transition-all duration-300`,children:[r.jsx(tg,{collapsed:n}),r.jsx(ng,{menuItems:e,activeView:t,collapsed:n,onViewChange:a}),r.jsx(ag,{collapsed:n,onToggleCollapse:s})]}),tg=({collapsed:e})=>r.jsx("div",{className:"p-4 border-b border-slate-700",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0",children:r.jsx(zm,{className:"w-6 h-6 text-white"})}),!e&&r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-white",children:ql.name}),r.jsx("p",{className:"text-xs text-slate-400",children:ql.tagline})]})]})}),ng=({menuItems:e,activeView:t,collapsed:n,onViewChange:a})=>r.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:r.jsx("ul",{className:"space-y-2",children:e.map(s=>r.jsx(rg,{item:s,isActive:t===s.id,collapsed:n,onClick:()=>a(s.id)},s.id))})}),rg=({item:e,isActive:t,collapsed:n,onClick:a})=>r.jsx("li",{children:r.jsxs("button",{onClick:a,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${t?"bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-lg shadow-cyan-500/25":"text-slate-400 hover:bg-slate-700 hover:text-white"}`,title:n?e.label:void 0,"aria-current":t?"page":void 0,children:[r.jsx(Bm,{name:e.icon}),!n&&r.jsx("span",{className:"font-medium",children:e.label})]})}),ag=({collapsed:e,onToggleCollapse:t})=>r.jsx("div",{className:"p-4 border-t border-slate-700",children:r.jsxs("button",{onClick:t,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":e?"Expand sidebar":"Collapse sidebar",children:[r.jsx(Wm,{className:`w-5 h-5 transition-transform ${e?"rotate-180":""}`}),!e&&r.jsx("span",{className:"text-sm",children:"Collapse"})]})}),sg=({viewInfo:e,notifications:t,onNotificationClick:n})=>r.jsx("header",{className:"bg-slate-800 border-b border-slate-700 px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(og,{title:e.title,subtitle:e.subtitle}),r.jsx(ig,{notifications:t,onNotificationClick:n})]})}),og=({title:e,subtitle:t})=>r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:e}),r.jsx("p",{className:"text-sm text-slate-400",children:t})]}),ig=({notifications:e,onNotificationClick:t})=>r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Zm,{className:"w-64"}),r.jsx(lg,{count:e,onClick:t}),r.jsx(cg,{})]}),lg=({count:e,onClick:t})=>r.jsxs("button",{onClick:t,className:"relative p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":`Notifications (${e} unread)`,children:[r.jsx(ku,{className:"w-6 h-6"}),e>0&&r.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:e})]}),cg=()=>r.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-slate-700",children:[r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-medium text-white",children:"Admin User"}),r.jsx("div",{className:"text-xs text-slate-400",children:"Security Team"})]}),r.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:"AU"})]}),dg=({children:e,menuItems:t,activeView:n,viewInfo:a,sidebarCollapsed:s,notifications:o,onViewChange:i,onToggleSidebar:l,onNotificationClick:c})=>r.jsxs("div",{className:"min-h-screen bg-slate-900 flex",children:[r.jsx(eg,{menuItems:t,activeView:n,collapsed:s,onViewChange:i,onToggleCollapse:l}),r.jsxs("main",{className:"flex-1 flex flex-col",children:[r.jsx(sg,{viewInfo:a,notifications:o,onNotificationClick:c}),r.jsx("div",{className:"flex-1 overflow-auto bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e})]})]}),re=({children:e,className:t=""})=>r.jsx("div",{className:`p-6 ${t}`,children:e}),ug={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6"},pg={sm:"gap-3",md:"gap-4",lg:"gap-6"},Li=({children:e,cols:t=4,gap:n="lg",className:a=""})=>r.jsx("div",{className:`grid ${ug[t]} ${pg[n]} ${a}`,children:e});function Au(e={}){const{refreshInterval:t=Pi.METRICS}=e,[n,a]=_.useState(new Date);return _.useEffect(()=>{const s=setInterval(()=>{a(new Date)},t);return()=>clearInterval(s)},[t]),n}function mg(e=!1){const[t,n]=_.useState(e),a=_.useCallback(()=>{n(o=>!o)},[]),s=_.useCallback(o=>{n(o)},[]);return[t,a,s]}function gg(e=Zl){const[t,n]=_.useState(e),a=_.useMemo(()=>Bl[t]||Bl[Zl],[t]),s=_.useCallback(o=>{n(o)},[]);return{activeView:t,viewInfo:a,setActiveView:s}}const fg={headers:{"Content-Type":"application/json"},timeout:3e4};class hg{constructor(t="",n={}){ns(this,"baseUrl");ns(this,"defaultConfig");this.baseUrl=t,this.defaultConfig={...fg,...n}}async request(t,n={}){const a=`${this.baseUrl}${t}`,s={...n,headers:{...this.defaultConfig.headers,...n.headers}};try{const o=new AbortController,i=n.timeout||this.defaultConfig.timeout,l=setTimeout(()=>o.abort(),i),c=await fetch(a,{...s,signal:o.signal});if(clearTimeout(l),!c.ok){const u=await c.json().catch(()=>({}));throw{status:c.status,message:u.message||c.statusText,code:u.code}}return{data:await c.json(),status:c.status}}catch(o){throw o.name==="AbortError"?{status:408,message:"Request timeout",code:"TIMEOUT"}:o}}async get(t,n){return this.request(t,{method:"GET",...n})}async post(t,n,a){return this.request(t,{method:"POST",body:n?JSON.stringify(n):void 0,...a})}async put(t,n,a){return this.request(t,{method:"PUT",body:n?JSON.stringify(n):void 0,...a})}async patch(t,n,a){return this.request(t,{method:"PATCH",body:n?JSON.stringify(n):void 0,...a})}async delete(t,n){return this.request(t,{method:"DELETE",...n})}}new hg("/api");const _g=async()=>[{label:"Active Rules",value:"4,892",change:"+12",trend:"up",icon:"",color:"cyan"},{label:"Security Groups",value:"247",change:"+3",trend:"up",icon:"",color:"purple"},{label:"Transit Gateways",value:"18",change:"0",trend:"stable",icon:"",color:"emerald"},{label:"Open Tickets",value:"23",change:"-5",trend:"down",icon:"",color:"amber"}],yg=async()=>[{id:1,action:"Rule deployed",target:"sg-web-prod",user:"automation",time:"2 min ago",status:"success"},{id:2,action:"Policy change approved",target:"CHG0012347",user:"j.smith",time:"15 min ago",status:"success"},{id:3,action:"Validation failed",target:"Allow-External-SSH",user:"system",time:"32 min ago",status:"error"},{id:4,action:"Compliance scan completed",target:"PCI-DSS",user:"scanner",time:"1 hour ago",status:"success"},{id:5,action:"Anomaly detected",target:"tgw-prod-east",user:"ai-engine",time:"2 hours ago",status:"warning"}],vg=async()=>[{name:"AWS",value:65,color:"bg-orange-500"},{name:"Azure",value:25,color:"bg-blue-500"},{name:"GCP",value:10,color:"bg-red-500"}],xg=async()=>({activeConnections:49,ingress:24,egress:18,firewallCpu:67}),bg=async()=>[{label:"Blocked Attacks",value:"1,247",unit:"/hr",icon:"",color:"red",trend:" -12%"},{label:"Policy Changes",value:"23",unit:"pending",icon:"",color:"amber",trend:" +5"},{label:"Compliance",value:"98.5",unit:"%",icon:"",color:"emerald",trend:" +0.2%"},{label:"Avg Latency",value:"12",unit:"ms",icon:"",color:"cyan",trend:" -2ms"},{label:"Active Rules",value:"4,892",unit:"",icon:"",color:"purple"},{label:"TGW Attachments",value:"18",unit:"active",icon:"",color:"cyan"}],wg=async()=>[{name:"AWS",status:"operational",latency:"12ms",icon:""},{name:"Azure",status:"operational",latency:"18ms",icon:""},{name:"GCP",status:"degraded",latency:"45ms",icon:""},{name:"Palo Alto",status:"operational",latency:"3ms",icon:""}],Sg=async()=>({compliance:"98.5%",uptime:"99.9%",avgLatency:"12ms"}),kg=async()=>({packetDropRate:.05+Math.random()*.1,throughput:{ingress:24.5+Math.random()*5,egress:18.2+Math.random()*3},connections:{active:Math.floor(45e3+Math.random()*1e4),blocked:Math.floor(1200+Math.random()*300)},latency:{avg:12,p95:28,p99:45},firewallHealth:{cpu:Math.floor(55+Math.random()*20),memory:Math.floor(45+Math.random()*15),sessions:Math.floor(30+Math.random()*25)}}),Cg=()=>[{id:1,type:"critical",message:"Firewall CPU exceeded 65% threshold",source:"pa-fw-prod-east",time:new Date(Date.now()-3e4),acknowledged:!1},{id:2,type:"warning",message:"Asymmetric routing detected on db-cluster path",source:"tgw-prod",time:new Date(Date.now()-12e4),acknowledged:!1},{id:3,type:"info",message:"New security group rule deployed successfully",source:"sg-web-prod",time:new Date(Date.now()-3e5),acknowledged:!0},{id:4,type:"warning",message:"High connection rate from 203.0.113.0/24",source:"alb-prod",time:new Date(Date.now()-45e4),acknowledged:!1},{id:5,type:"critical",message:"Black hole route detected for 10.60.0.0/16",source:"rtb-prod-main",time:new Date(Date.now()-6e5),acknowledged:!1},{id:6,type:"info",message:"Compliance scan completed - 98.5% score",source:"atlas-scanner",time:new Date(Date.now()-9e5),acknowledged:!0},{id:7,type:"warning",message:"SSL certificate expires in 14 days",source:"cert-manager",time:new Date(Date.now()-12e5),acknowledged:!1},{id:8,type:"info",message:"Transit Gateway attachment created",source:"tgw-attach-analytics",time:new Date(Date.now()-15e5),acknowledged:!0}],Ag=()=>{const e=[{type:"info",message:"Health check passed for web-servers",source:"alb-prod"},{type:"warning",message:"Elevated latency on cross-region traffic",source:"cloud-router-us"},{type:"info",message:"Auto-scaling triggered for app-tier",source:"asg-app-prod"},{type:"warning",message:"Connection pool nearing capacity",source:"rds-primary"}];return e[Math.floor(Math.random()*e.length)]},Ng=e=>({id:Date.now(),...e,time:new Date,acknowledged:!1}),jg=e=>{const t=Math.floor((Date.now()-e.getTime())/1e3);return t<60?`${t}s ago`:t<3600?`${Math.floor(t/60)}m ago`:`${Math.floor(t/3600)}h ago`},Tg=e=>({critical:"",warning:"",info:""})[e]||"",Nu=e=>({critical:e.filter(t=>t.type==="critical"&&!t.acknowledged).length,warning:e.filter(t=>t.type==="warning"&&!t.acknowledged).length,info:e.filter(t=>t.type==="info"&&!t.acknowledged).length,unacknowledged:e.filter(t=>!t.acknowledged).length}),Eg=async()=>[{id:"pci-dss",name:"PCI-DSS",fullName:"Payment Card Industry Data Security Standard",score:100,status:"compliant",icon:"",color:"emerald",totalControls:264,passedControls:264,failedControls:0,violations:[],lastAudit:"2026-01-12T10:00:00Z",nextAudit:"2026-02-12T10:00:00Z",categories:[{name:"Network Security",score:100,controls:45},{name:"Access Control",score:100,controls:38},{name:"Data Protection",score:100,controls:52},{name:"Monitoring & Testing",score:100,controls:67},{name:"Security Policies",score:100,controls:62}]},{id:"hipaa",name:"HIPAA",fullName:"Health Insurance Portability and Accountability Act",score:97,status:"compliant",icon:"",color:"blue",totalControls:189,passedControls:183,failedControls:6,violations:[{id:"HIPAA-001",control:"164.312(a)(1)",description:"Access control - Unique user identification",severity:"medium",resource:"legacy-app-server",remediation:"Implement individual user accounts for legacy application"},{id:"HIPAA-002",control:"164.312(b)",description:"Audit controls - Hardware, software, and procedural mechanisms",severity:"low",resource:"db-analytics-01",remediation:"Enable detailed audit logging on analytics database"},{id:"HIPAA-003",control:"164.312(c)(1)",description:"Integrity - Electronic mechanisms to corroborate data integrity",severity:"medium",resource:"file-server-phi",remediation:"Implement file integrity monitoring on PHI storage"},{id:"HIPAA-004",control:"164.312(d)",description:"Person or entity authentication",severity:"low",resource:"vpn-gateway",remediation:"Upgrade to certificate-based authentication"},{id:"HIPAA-005",control:"164.312(e)(1)",description:"Transmission security - Integrity controls",severity:"medium",resource:"api-internal",remediation:"Enable TLS 1.3 for internal API communications"},{id:"HIPAA-006",control:"164.308(a)(5)",description:"Security awareness and training",severity:"low",resource:"org-wide",remediation:"Complete annual security training for 12 employees"}],lastAudit:"2026-01-10T14:00:00Z",nextAudit:"2026-02-10T14:00:00Z",categories:[{name:"Administrative Safeguards",score:96,controls:54},{name:"Physical Safeguards",score:100,controls:28},{name:"Technical Safeguards",score:95,controls:42},{name:"Organizational Requirements",score:98,controls:35},{name:"Policies & Documentation",score:97,controls:30}]},{id:"soc2",name:"SOC 2",fullName:"Service Organization Control 2",score:99,status:"compliant",icon:"",color:"purple",totalControls:312,passedControls:309,failedControls:3,violations:[{id:"SOC2-001",control:"CC6.1",description:"Logical and physical access controls",severity:"low",resource:"dev-environment",remediation:"Implement stricter access controls for development environment"},{id:"SOC2-002",control:"CC7.2",description:"System monitoring activities",severity:"low",resource:"logging-service",remediation:"Increase log retention period to 12 months"},{id:"SOC2-003",control:"CC9.2",description:"Vendor risk management",severity:"medium",resource:"third-party-integrations",remediation:"Complete vendor security assessments for 2 pending vendors"}],lastAudit:"2026-01-08T09:00:00Z",nextAudit:"2026-04-08T09:00:00Z",categories:[{name:"Security",score:99,controls:89},{name:"Availability",score:100,controls:45},{name:"Processing Integrity",score:99,controls:52},{name:"Confidentiality",score:100,controls:68},{name:"Privacy",score:98,controls:58}]},{id:"nist",name:"NIST",fullName:"NIST Cybersecurity Framework",score:98,status:"compliant",icon:"",color:"amber",totalControls:423,passedControls:415,failedControls:8,violations:[{id:"NIST-001",control:"ID.AM-5",description:"Resources prioritization based on classification",severity:"low",resource:"asset-inventory",remediation:"Complete criticality classification for 15 new assets"},{id:"NIST-002",control:"ID.RA-1",description:"Asset vulnerabilities identified and documented",severity:"medium",resource:"vuln-scanner",remediation:"Run vulnerability scan on newly deployed infrastructure"},{id:"NIST-003",control:"PR.AC-4",description:"Access permissions managed with least privilege",severity:"medium",resource:"iam-policies",remediation:"Review and reduce overly permissive IAM roles"},{id:"NIST-004",control:"PR.DS-1",description:"Data-at-rest is protected",severity:"low",resource:"backup-storage",remediation:"Enable encryption on backup storage volumes"},{id:"NIST-005",control:"PR.IP-1",description:"Baseline configuration created and maintained",severity:"low",resource:"config-management",remediation:"Update baseline configs for 3 new service types"},{id:"NIST-006",control:"DE.AE-3",description:"Event data aggregated and correlated",severity:"medium",resource:"siem-platform",remediation:"Configure correlation rules for new log sources"},{id:"NIST-007",control:"DE.CM-7",description:"Monitoring for unauthorized activities",severity:"low",resource:"endpoint-protection",remediation:"Deploy endpoint monitoring to 8 new workstations"},{id:"NIST-008",control:"RS.CO-3",description:"Information sharing with stakeholders",severity:"low",resource:"incident-response",remediation:"Update incident notification procedures"}],lastAudit:"2026-01-05T11:00:00Z",nextAudit:"2026-03-05T11:00:00Z",categories:[{name:"Identify",score:97,controls:78},{name:"Protect",score:98,controls:124},{name:"Detect",score:97,controls:89},{name:"Respond",score:99,controls:67},{name:"Recover",score:100,controls:65}]},{id:"gdpr",name:"GDPR",fullName:"General Data Protection Regulation",score:94,status:"compliant",icon:"",color:"blue",totalControls:156,passedControls:147,failedControls:9,violations:[{id:"GDPR-001",control:"Art. 5(1)(c)",description:"Data minimization - Personal data shall be adequate, relevant and limited",severity:"medium",resource:"customer-db",remediation:"Review and remove unnecessary personal data fields from customer database"},{id:"GDPR-002",control:"Art. 5(1)(e)",description:"Storage limitation - Data kept no longer than necessary",severity:"high",resource:"analytics-platform",remediation:"Implement automated data retention policies for analytics data"},{id:"GDPR-003",control:"Art. 12",description:"Transparent information and communication",severity:"low",resource:"privacy-policy",remediation:"Update privacy policy with clearer data processing descriptions"},{id:"GDPR-004",control:"Art. 15",description:"Right of access by data subject",severity:"medium",resource:"data-portal",remediation:"Implement self-service data access request portal"},{id:"GDPR-005",control:"Art. 17",description:"Right to erasure (right to be forgotten)",severity:"medium",resource:"backup-system",remediation:"Ensure deletion requests propagate to backup systems within 30 days"},{id:"GDPR-006",control:"Art. 25",description:"Data protection by design and default",severity:"low",resource:"new-services",remediation:"Complete privacy impact assessment for 2 new service deployments"},{id:"GDPR-007",control:"Art. 30",description:"Records of processing activities",severity:"low",resource:"documentation",remediation:"Update processing activity records for Q4 changes"},{id:"GDPR-008",control:"Art. 33",description:"Notification of data breach within 72 hours",severity:"low",resource:"incident-process",remediation:"Update breach notification runbook with new contact procedures"},{id:"GDPR-009",control:"Art. 35",description:"Data protection impact assessment",severity:"medium",resource:"ai-features",remediation:"Complete DPIA for new AI-powered features processing personal data"}],lastAudit:"2026-01-11T08:00:00Z",nextAudit:"2026-04-11T08:00:00Z",categories:[{name:"Lawfulness & Transparency",score:96,controls:28},{name:"Data Subject Rights",score:91,controls:35},{name:"Data Security",score:98,controls:32},{name:"Accountability",score:93,controls:31},{name:"International Transfers",score:95,controls:30}]}],Ri=e=>Zt.framework[e]||Zt.framework.emerald,ju=e=>{const t=e.reduce((i,l)=>i+l.violations.length,0),n=e.reduce((i,l)=>i+l.totalControls,0),a=e.reduce((i,l)=>i+l.passedControls,0),s=e.reduce((i,l)=>i+l.violations.filter(c=>c.severity==="medium").length,0),o=e.reduce((i,l)=>i+l.violations.filter(c=>c.severity==="low").length,0);return{totalViolations:t,totalControls:n,passedControls:a,failedControls:n-a,mediumViolations:s,lowViolations:o,compliantFrameworks:e.filter(i=>i.status==="compliant").length}},Pg=(e,t="json")=>{const n={generatedAt:new Date().toISOString(),summary:ju(e),frameworks:e.map(a=>({name:a.name,fullName:a.fullName,score:a.score,status:a.status,totalControls:a.totalControls,passedControls:a.passedControls,failedControls:a.failedControls,lastAudit:a.lastAudit,nextAudit:a.nextAudit,violations:a.violations,categories:a.categories}))};if(t==="json")return JSON.stringify(n,null,2);if(t==="csv"){const a=["Framework","Violation ID","Control","Description","Severity","Resource","Remediation"],s=e.flatMap(o=>o.violations.map(i=>[o.name,i.id,i.control,`"${i.description.replace(/"/g,'""')}"`,i.severity,i.resource,`"${i.remediation.replace(/"/g,'""')}"`]));return[a.join(","),...s.map(o=>o.join(","))].join(`
`)}return JSON.stringify(n,null,2)},Ig=async(e,t)=>{const n=Pg(e,t),a=new Date().toISOString().split("T")[0],s={csv:"text/csv",json:"application/json",pdf:"application/json"};return{filename:`compliance-report-${a}.${t}`,content:n,mimeType:s[t]}},Xe=[{id:"aws-1",provider:"aws",name:"Production AWS",status:"connected",region:"us-east-1",accountId:"123456789012",lastSync:new Date(Date.now()-5*60*1e3).toISOString(),credentials:{type:"access_key",configured:!0}},{id:"azure-1",provider:"azure",name:"Azure Enterprise",status:"connected",region:"eastus",subscriptionId:"sub-abc123-def456",lastSync:new Date(Date.now()-10*60*1e3).toISOString(),credentials:{type:"service_principal",configured:!0}},{id:"gcp-1",provider:"gcp",name:"GCP Analytics",status:"error",region:"us-central1",projectId:"analytics-prod-12345",lastSync:new Date(Date.now()-60*60*1e3).toISOString(),credentials:{type:"service_account",configured:!0}},{id:"onprem-1",provider:"onprem",name:"DC-East Datacenter",status:"connected",datacenterName:"DC-EAST-01",lastSync:new Date(Date.now()-2*60*1e3).toISOString(),credentials:{type:"api_key",configured:!0}}],Es={instanceUrl:"https://company.service-now.com",username:"api_integration",isConfigured:!0,autoCreateTickets:!0,defaultAssignmentGroup:"Network Operations",defaultPriority:"medium",syncInterval:5},Ps={type:"splunk",endpoint:"https://splunk.company.com:8089",isConfigured:!0,forwardAlerts:!0,forwardLogs:!1,alertSeverityThreshold:"medium"},Is={type:"datadog",apiEndpoint:"https://api.datadoghq.com",isConfigured:!0,collectMetrics:!0,collectTraces:!0,sampleRate:.1},at=[{id:"user-1",email:"admin@company.com",name:"System Administrator",role:"admin",status:"active",lastLogin:new Date(Date.now()-30*60*1e3).toISOString(),createdAt:"2024-01-15T10:00:00Z",permissions:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!0,canModifySettings:!0,canViewAuditLogs:!0,canManageUsers:!0,canExportData:!0}},{id:"user-2",email:"operator@company.com",name:"Network Operator",role:"operator",status:"active",lastLogin:new Date(Date.now()-2*60*60*1e3).toISOString(),createdAt:"2024-02-20T14:30:00Z",permissions:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!0}},{id:"user-3",email:"viewer@company.com",name:"Security Viewer",role:"viewer",status:"active",lastLogin:new Date(Date.now()-24*60*60*1e3).toISOString(),createdAt:"2024-03-10T09:15:00Z",permissions:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!1}},{id:"user-4",email:"auditor@company.com",name:"Compliance Auditor",role:"auditor",status:"active",lastLogin:new Date(Date.now()-48*60*60*1e3).toISOString(),createdAt:"2024-03-25T11:00:00Z",permissions:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!0,canManageUsers:!1,canExportData:!0}}],Ls={channels:[{id:"email-1",type:"email",name:"Operations Team",isEnabled:!0,config:{recipients:"ops@company.com"}},{id:"slack-1",type:"slack",name:"#network-alerts",isEnabled:!0,config:{channel:"#network-alerts",webhook:"https://hooks.slack.com/..."}},{id:"pagerduty-1",type:"pagerduty",name:"Critical Alerts",isEnabled:!0,config:{serviceKey:"pd-service-key",severity:"critical"}},{id:"teams-1",type:"teams",name:"Security Team",isEnabled:!1,config:{webhook:"https://outlook.office.com/webhook/..."}}],alertThreshold:"warning",quietHours:{enabled:!0,start:"22:00",end:"07:00",timezone:"America/New_York"},digest:{enabled:!0,frequency:"daily"}},Rs=[{id:"log-1",timestamp:new Date(Date.now()-5*60*1e3).toISOString(),user:"admin@company.com",action:"UPDATE_SETTINGS",resource:"ServiceNow Configuration",details:"Updated sync interval from 10 to 5 minutes",ipAddress:"10.0.1.50",status:"success"},{id:"log-2",timestamp:new Date(Date.now()-30*60*1e3).toISOString(),user:"operator@company.com",action:"CREATE_RULE",resource:"Firewall Rule",details:"Created rule: Allow HTTPS from DMZ to Production",ipAddress:"10.0.1.51",status:"success"},{id:"log-3",timestamp:new Date(Date.now()-60*60*1e3).toISOString(),user:"admin@company.com",action:"TEST_CONNECTION",resource:"GCP Analytics",details:"Connection test failed: Invalid credentials",ipAddress:"10.0.1.50",status:"failure"},{id:"log-4",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),user:"admin@company.com",action:"ADD_USER",resource:"User Management",details:"Added new user: viewer@company.com with role: viewer",ipAddress:"10.0.1.50",status:"success"},{id:"log-5",timestamp:new Date(Date.now()-3*60*60*1e3).toISOString(),user:"operator@company.com",action:"APPROVE_TICKET",resource:"Ticket CHG0012345",details:"Approved policy change request for web server access",ipAddress:"10.0.1.51",status:"success"},{id:"log-6",timestamp:new Date(Date.now()-4*60*60*1e3).toISOString(),user:"auditor@company.com",action:"EXPORT_REPORT",resource:"Compliance Report",details:"Exported PCI-DSS compliance report for Q4 2024",ipAddress:"10.0.1.55",status:"success"},{id:"log-7",timestamp:new Date(Date.now()-5*60*60*1e3).toISOString(),user:"admin@company.com",action:"UPDATE_PERMISSIONS",resource:"User Management",details:"Updated permissions for operator@company.com",ipAddress:"10.0.1.50",status:"success"},{id:"log-8",timestamp:new Date(Date.now()-24*60*60*1e3).toISOString(),user:"system",action:"SYNC_CLOUD",resource:"AWS Production",details:"Automatic sync completed: 847 resources discovered",ipAddress:"127.0.0.1",status:"success"}],ue=e=>new Promise(t=>setTimeout(t,e)),ke={async getSettings(){return await ue(500),{cloudConnections:Xe,serviceNow:Es,siem:Ps,apm:Is,users:at,notifications:Ls}},async getCloudConnections(){return await ue(300),Xe},async testCloudConnection(e){await ue(2e3);const t=Xe.find(n=>n.id===e);return t?t.status==="error"?{success:!1,message:"Authentication failed. Please verify credentials."}:{success:!0,message:"Connection successful. All services accessible."}:{success:!1,message:"Connection not found"}},async updateCloudConnection(e,t){await ue(500);const n=Xe.findIndex(a=>a.id===e);if(n===-1)throw new Error("Connection not found");return Xe[n]={...Xe[n],...t},Xe[n]},async addCloudConnection(e){await ue(500);const t={...e,id:`${e.provider}-${Date.now()}`};return Xe.push(t),t},async deleteCloudConnection(e){await ue(300);const t=Xe.findIndex(n=>n.id===e);t!==-1&&Xe.splice(t,1)},async updateServiceNowConfig(e){return await ue(500),Object.assign(Es,e),Es},async testServiceNowConnection(){return await ue(1500),{success:!0,message:"ServiceNow connection verified successfully."}},async updateSIEMConfig(e){return await ue(500),Object.assign(Ps,e),Ps},async updateAPMConfig(e){return await ue(500),Object.assign(Is,e),Is},async getUsers(){return await ue(300),at},async addUser(e){await ue(500);const t={...e,id:`user-${Date.now()}`,createdAt:new Date().toISOString()};return at.push(t),t},async updateUser(e,t){await ue(500);const n=at.findIndex(a=>a.id===e);if(n===-1)throw new Error("User not found");return at[n]={...at[n],...t},at[n]},async deleteUser(e){await ue(300);const t=at.findIndex(n=>n.id===e);t!==-1&&at.splice(t,1)},async updateNotificationPreferences(e){return await ue(500),Object.assign(Ls,e),Ls},async getAuditLogs(e){await ue(400);let t=[...Rs];return e!=null&&e.user&&(t=t.filter(n=>n.user.toLowerCase().includes(e.user.toLowerCase()))),e!=null&&e.action&&(t=t.filter(n=>n.action===e.action)),e!=null&&e.startDate&&(t=t.filter(n=>new Date(n.timestamp)>=new Date(e.startDate))),e!=null&&e.endDate&&(t=t.filter(n=>new Date(n.timestamp)<=new Date(e.endDate))),t.sort((n,a)=>new Date(a.timestamp).getTime()-new Date(n.timestamp).getTime())},async exportAuditLogs(e){if(await ue(1e3),e==="json")return JSON.stringify(Rs,null,2);const t=["Timestamp","User","Action","Resource","Details","IP Address","Status"],n=Rs.map(a=>[a.timestamp,a.user,a.action,a.resource,a.details,a.ipAddress,a.status]);return[t.join(","),...n.map(a=>a.join(","))].join(`
`)}},nn=e=>!e||e==="*"||e==="any"||e==="0.0.0.0/0"?"0.0.0.0/0":!e.includes("/")&&!e.includes("-")?`${e}/32`:e,Lg=e=>{const{name:t,sourceIp:n,destinationIp:a,port:s,protocol:o,action:i,direction:l,description:c}=e,d=nn(n),u=nn(a);if(i==="deny")return`# AWS Security Groups do not support explicit deny rules
# Consider using Network ACLs for deny rules
# aws ec2 create-network-acl-entry --network-acl-id <acl-id> \\
#   --rule-number 100 --protocol ${o==="any"?"-1":o} \\
#   --port-range From=${s},To=${s} --cidr-block ${d} \\
#   --rule-action deny --${l==="inbound"?"ingress":"egress"}`;const m=o==="icmp"?"":`--port ${s}`,g=l==="inbound"||l==="both",v=[];return g&&v.push(`# ${t} - ${c||"Inbound rule"}
aws ec2 authorize-security-group-ingress \\
  --group-id <security-group-id> \\
  --protocol ${o==="any"?"-1":o} ${m} \\
  --cidr ${d} \\
  --tag-specifications 'ResourceType=security-group-rule,Tags=[{Key=Name,Value=${t}}]'`),(l==="outbound"||l==="both")&&v.push(`# ${t} - ${c||"Outbound rule"}
aws ec2 authorize-security-group-egress \\
  --group-id <security-group-id> \\
  --protocol ${o==="any"?"-1":o} ${m} \\
  --cidr ${u}`),v.join(`

`)},Rg=e=>{const{name:t,sourceIp:n,destinationIp:a,port:s,protocol:o,action:i,direction:l,priority:c=100,description:d}=e,u=n==="*"||!n?"*":nn(n),m=a==="*"||!a?"*":nn(a);return`# ${t} - ${d||"Azure NSG Rule"}
az network nsg rule create \\
  --resource-group <resource-group-name> \\
  --nsg-name <nsg-name> \\
  --name "${t.replace(/\s+/g,"-")}" \\
  --priority ${c} \\
  --direction ${l==="inbound"?"Inbound":"Outbound"} \\
  --access ${i==="allow"?"Allow":"Deny"} \\
  --protocol ${o==="any"?"*":o.charAt(0).toUpperCase()+o.slice(1)} \\
  --source-address-prefixes "${u}" \\
  --source-port-ranges "*" \\
  --destination-address-prefixes "${m}" \\
  --destination-port-ranges "${s||"*"}"`},Og=e=>{const{name:t,sourceIp:n,port:a,protocol:s,action:o,direction:i,priority:l=1e3,description:c}=e,d=t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),u=nn(n),m=s==="icmp"?"":a?` --rules ${s}:${a}`:` --rules ${s}`;return o==="deny"?`# ${t} - ${c||"GCP Deny Rule"}
gcloud compute firewall-rules create ${d} \\
  --project=<project-id> \\
  --network=<vpc-network> \\
  --priority=${l} \\
  --direction=${i==="inbound"?"INGRESS":"EGRESS"} \\
  --action=DENY \\
  --source-ranges="${u}"${m} \\
  --description="${c||t}"`:`# ${t} - ${c||"GCP Allow Rule"}
gcloud compute firewall-rules create ${d} \\
  --project=<project-id> \\
  --network=<vpc-network> \\
  --priority=${l} \\
  --direction=${i==="inbound"?"INGRESS":"EGRESS"} \\
  --action=ALLOW \\
  --source-ranges="${u}"${m} \\
  --target-tags=<target-tags> \\
  --description="${c||t}"`},Dg=e=>{const{name:t,sourceIp:n,destinationIp:a,port:s,action:o,description:i}=e,l="untrust",c="trust",d="any",u=s?`tcp-${s}`:"any";return`# ${t} - ${i||"Palo Alto Security Rule"}
set rulebase security rules "${t}" from ${l}
set rulebase security rules "${t}" to ${c}
set rulebase security rules "${t}" source ${n||"any"}
set rulebase security rules "${t}" destination ${a||"any"}
set rulebase security rules "${t}" application ${d}
set rulebase security rules "${t}" service ${u}
set rulebase security rules "${t}" action ${o}
set rulebase security rules "${t}" log-start yes
set rulebase security rules "${t}" log-end yes
set rulebase security rules "${t}" description "${i||t}"`},Mg=e=>{const{name:t,sourceIp:n,destinationIp:a,port:s,protocol:o,action:i,direction:l,description:c}=e,d=l==="inbound"?"outside_access_in":"inside_access_out",u=n!=null&&n.includes("/")?`${n.split("/")[0]} ${Yl(n)}`:`host ${n||"any"}`,m=a!=null&&a.includes("/")?`${a.split("/")[0]} ${Yl(a)}`:`host ${a||"any"}`,g=s?`eq ${s}`:"";return`! ${t} - ${c||"Cisco ASA Rule"}
access-list ${d} extended ${i==="allow"?"permit":"deny"} ${o} ${u} ${m} ${g}
! Apply to interface (if not already applied)
! access-group ${d} in interface outside`},Gg=e=>{const{name:t,sourceIp:n,destinationIp:a,port:s,action:o,description:i}=e,l=s?`TCP/${s}`:"ALL";return`# ${t} - ${i||"FortiGate Policy"}
config firewall policy
    edit 0
        set name "${t}"
        set srcintf "wan1"
        set dstintf "lan"
        set srcaddr "${n||"all"}"
        set dstaddr "${a||"all"}"
        set action ${o}
        set schedule "always"
        set service "${l}"
        set logtraffic all
        set comments "${i||t}"
    next
end`},Vg=e=>{const{name:t,sourceIp:n,destinationIp:a,port:s,protocol:o,action:i,direction:l,description:c}=e,d=l==="inbound"?"INPUT":"OUTPUT",u=i==="allow"?"ACCEPT":"DROP",m=n&&n!=="*"?`-s ${nn(n)}`:"",g=a&&a!=="*"?`-d ${nn(a)}`:"",v=o!=="any"?`-p ${o}`:"",b=s&&o!=="icmp"&&o!=="any"?`--dport ${s}`:"";return`# ${t} - ${c||"iptables rule"}
iptables -A ${d} ${v} ${m} ${g} ${b} -j ${u} -m comment --comment "${t}"

# For persistent rules, save with:
# iptables-save > /etc/iptables/rules.v4

# Or using nftables equivalent:
# nft add rule inet filter ${d.toLowerCase()} ${o!=="any"?`${o} `:""}${b?`dport ${s} `:""}${m?`ip saddr ${n} `:""}${g?`ip daddr ${a} `:""}${u.toLowerCase()}`};function Yl(e){const n=~(2**(32-parseInt(e.split("/")[1]||"32",10))-1);return[n>>>24&255,n>>>16&255,n>>>8&255,n&255].join(".")}const Hg=e=>{var n;const t=[];return(n=e.name)!=null&&n.trim()||t.push("Rule name is required"),e.sourceIp&&!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$|^\*$|^any$/.test(e.sourceIp)&&t.push("Invalid source IP format"),e.destinationIp&&!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$|^\*$|^any$/.test(e.destinationIp)&&t.push("Invalid destination IP format"),e.port&&!/^\d+(-\d+)?$/.test(e.port)&&t.push("Invalid port format (use single port or range like 80-443)"),e.port&&e.port.split("-").map(Number).some(s=>s<1||s>65535)&&t.push("Port must be between 1 and 65535"),t},Fg=(e,t)=>{const n=[];return t==="aws"&&e.action==="deny"&&n.push("AWS Security Groups do not support deny rules. Consider using Network ACLs."),(!e.sourceIp||e.sourceIp==="*"||e.sourceIp==="0.0.0.0/0")&&n.push("Source IP is open to all (0.0.0.0/0). This may pose security risks."),e.port==="22"&&e.action==="allow"&&(!e.sourceIp||e.sourceIp==="0.0.0.0/0")&&n.push("SSH (port 22) is open to the internet. Restrict source IPs for security."),e.port==="3389"&&e.action==="allow"&&(!e.sourceIp||e.sourceIp==="0.0.0.0/0")&&n.push("RDP (port 3389) is open to the internet. Restrict source IPs for security."),n},Wg={aws:Lg,azure:Rg,gcp:Og,palo_alto:Dg,cisco_asa:Mg,fortinet:Gg,iptables:Vg},Os=e=>new Promise(t=>setTimeout(t,e)),Xl={async generateRules(e,t){await Os(500);const n=Hg(e);return t.map(a=>{const s=Fg(e,a),o=Wg[a];if(n.length>0)return{platform:a,syntax:"",isValid:!1,validationErrors:n,warnings:s};try{const i=o(e);return{platform:a,syntax:i,isValid:!0,warnings:s}}catch(i){return{platform:a,syntax:"",isValid:!1,validationErrors:[`Failed to generate rule: ${i instanceof Error?i.message:"Unknown error"}`],warnings:s}}})},async getTemplates(){return await Os(300),Ug},async validateSyntax(e,t){return await Os(200),t.trim()?{isValid:!0,errors:[]}:{isValid:!1,errors:["Empty rule syntax"]}}},Ug=[{id:"web-server-http",name:"Web Server HTTP",description:"Allow HTTP traffic (port 80) to web servers",category:"web",input:{name:"Allow-HTTP-Inbound",description:"Allow HTTP traffic from any source",sourceIp:"0.0.0.0/0",destinationIp:"",port:"80",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"web-server-https",name:"Web Server HTTPS",description:"Allow HTTPS traffic (port 443) to web servers",category:"web",input:{name:"Allow-HTTPS-Inbound",description:"Allow HTTPS traffic from any source",sourceIp:"0.0.0.0/0",destinationIp:"",port:"443",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"ssh-management",name:"SSH Management",description:"Allow SSH access from management network",category:"management",input:{name:"Allow-SSH-Management",description:"Allow SSH from management subnet",sourceIp:"10.0.0.0/8",destinationIp:"",port:"22",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"database-mysql",name:"MySQL Database",description:"Allow MySQL connections from application tier",category:"database",input:{name:"Allow-MySQL-AppTier",description:"Allow MySQL from application servers",sourceIp:"10.1.0.0/16",destinationIp:"",port:"3306",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"database-postgres",name:"PostgreSQL Database",description:"Allow PostgreSQL connections from application tier",category:"database",input:{name:"Allow-PostgreSQL-AppTier",description:"Allow PostgreSQL from application servers",sourceIp:"10.1.0.0/16",destinationIp:"",port:"5432",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"rdp-management",name:"RDP Management",description:"Allow RDP access from management network",category:"management",input:{name:"Allow-RDP-Management",description:"Allow RDP from management subnet",sourceIp:"10.0.0.0/8",destinationIp:"",port:"3389",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"deny-all-inbound",name:"Deny All Inbound",description:"Default deny rule for all inbound traffic",category:"security",input:{name:"Deny-All-Inbound",description:"Block all inbound traffic by default",sourceIp:"0.0.0.0/0",destinationIp:"",port:"",protocol:"any",action:"deny",direction:"inbound"},platforms:["azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"icmp-ping",name:"Allow ICMP Ping",description:"Allow ICMP echo requests for ping",category:"management",input:{name:"Allow-ICMP-Ping",description:"Allow ICMP for network diagnostics",sourceIp:"10.0.0.0/8",destinationIp:"",port:"",protocol:"icmp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]}],zg=[{sg_id:"sg-0f1e2d3c4b5a6001",name:"sg-webapp-prod",vpc:"vpc-prod-us-east-1",description:"Production web application tier"},{sg_id:"sg-0f1e2d3c4b5a6002",name:"sg-database-prod",vpc:"vpc-prod-us-east-1",description:"Production database tier"},{sg_id:"sg-0f1e2d3c4b5a6003",name:"sg-redis-prod",vpc:"vpc-prod-us-east-1",description:"Production Redis cache cluster"},{sg_id:"sg-0f1e2d3c4b5a6004",name:"sg-api-gateway",vpc:"vpc-prod-us-east-1",description:"API Gateway services"},{sg_id:"sg-0f1e2d3c4b5a6005",name:"sg-microservices",vpc:"vpc-prod-us-east-1",description:"Microservices tier"},{sg_id:"sg-0f1e2d3c4b5a6006",name:"sg-kafka-prod",vpc:"vpc-prod-us-east-1",description:"Kafka message broker cluster"},{sg_id:"sg-0f1e2d3c4b5a6007",name:"sg-analytics-prod",vpc:"vpc-prod-us-east-1",description:"Analytics and data science workloads"},{sg_id:"sg-0f1e2d3c4b5a6008",name:"sg-bastion",vpc:"vpc-prod-us-east-1",description:"Bastion host for SSH access"},{sg_id:"sg-0f1e2d3c4b5a6009",name:"sg-alb-public",vpc:"vpc-prod-us-east-1",description:"Public Application Load Balancer"},{sg_id:"sg-0f1e2d3c4b5a6010",name:"sg-alb-internal",vpc:"vpc-prod-us-east-1",description:"Internal Application Load Balancer"},{sg_id:"sg-0f1e2d3c4b5a6011",name:"sg-monitoring",vpc:"vpc-prod-us-east-1",description:"Monitoring stack (Prometheus/Grafana)"},{sg_id:"sg-0f1e2d3c4b5a6012",name:"sg-eks-nodes",vpc:"vpc-prod-us-east-1",description:"EKS worker nodes"},{sg_id:"sg-0f1e2d3c4b5a6013",name:"sg-eks-control",vpc:"vpc-prod-us-east-1",description:"EKS control plane"},{sg_id:"sg-0f1e2d3c4b5a6014",name:"sg-jenkins",vpc:"vpc-devops-us-east-1",description:"Jenkins CI/CD server"},{sg_id:"sg-0f1e2d3c4b5a6015",name:"sg-splunk",vpc:"vpc-prod-us-east-1",description:"Splunk SIEM cluster"},{sg_id:"sg-0f1e2d3c4b5a6016",name:"sg-vault",vpc:"vpc-prod-us-east-1",description:"HashiCorp Vault cluster"},{sg_id:"sg-0f1e2d3c4b5a6017",name:"sg-elasticsearch",vpc:"vpc-prod-us-east-1",description:"Elasticsearch cluster"},{sg_id:"sg-0f1e2d3c4b5a6018",name:"sg-payment",vpc:"vpc-pci-us-east-1",description:"Payment processing (PCI-DSS)"},{sg_id:"sg-0f1e2d3c4b5a6019",name:"sg-recommendation",vpc:"vpc-prod-us-east-1",description:"ML recommendation engine"},{sg_id:"sg-0f1e2d3c4b5a6020",name:"sg-nat-gateway",vpc:"vpc-prod-us-east-1",description:"NAT Gateway security group"}],$g=[{rule_id:"sgr-0a1b2c3d4e5f0001",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS from Internet via ALB"},{rule_id:"sgr-0a1b2c3d4e5f0002",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"80",source:"0.0.0.0/0",description:"HTTP redirect to HTTPS"},{rule_id:"sgr-0a1b2c3d4e5f0003",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"10.100.0.0/16",description:"SSH from VPN CIDR"},{rule_id:"sgr-0a1b2c3d4e5f0004",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-alb-public",description:"Application port from ALB"},{rule_id:"sgr-0a1b2c3d4e5f0005",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"PostgreSQL to database tier"},{rule_id:"sgr-0a1b2c3d4e5f0006",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache access"},{rule_id:"sgr-0a1b2c3d4e5f0007",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS to external APIs"},{rule_id:"sgr-0a1b2c3d4e5f0008",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka message publishing"},{rule_id:"sgr-0a1b2c3d4e5f0009",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Node exporter metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0010",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Microservices API calls"},{rule_id:"sgr-0a1b2c3d4e5f0011",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-webapp-prod",description:"PostgreSQL from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0012",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-api-gateway",description:"PostgreSQL from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0013",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-microservices",description:"PostgreSQL from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0014",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-analytics-prod",description:"PostgreSQL from analytics"},{rule_id:"sgr-0a1b2c3d4e5f0015",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"10.100.0.0/16",description:"PostgreSQL from VPN for DBA access"},{rule_id:"sgr-0a1b2c3d4e5f0016",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"sg-bastion",description:"SSH from bastion host"},{rule_id:"sgr-0a1b2c3d4e5f0017",security_group:"sg-database-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for backups via prefix list"},{rule_id:"sgr-0a1b2c3d4e5f0018",security_group:"sg-database-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"10.120.0.0/16",description:"Replication to DR region"},{rule_id:"sgr-0a1b2c3d4e5f0019",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Node exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0020",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"9187",source:"sg-monitoring",description:"PostgreSQL exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0021",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-webapp-prod",description:"Redis from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0022",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-api-gateway",description:"Redis from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0023",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-microservices",description:"Redis from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0024",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-recommendation",description:"Redis from recommendation engine"},{rule_id:"sgr-0a1b2c3d4e5f0025",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"16379",source:"sg-redis-prod",description:"Redis cluster bus port"},{rule_id:"sgr-0a1b2c3d4e5f0026",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"26379",source:"sg-redis-prod",description:"Redis Sentinel port"},{rule_id:"sgr-0a1b2c3d4e5f0027",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"9121",source:"sg-monitoring",description:"Redis exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0028",security_group:"sg-redis-prod",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cluster replication"},{rule_id:"sgr-0a1b2c3d4e5f0029",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-alb-public",description:"HTTPS from public ALB"},{rule_id:"sgr-0a1b2c3d4e5f0030",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-alb-internal",description:"HTTPS from internal ALB"},{rule_id:"sgr-0a1b2c3d4e5f0031",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"8443",source:"10.100.0.0/16",description:"API access from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0032",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Route to microservices"},{rule_id:"sgr-0a1b2c3d4e5f0033",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database queries"},{rule_id:"sgr-0a1b2c3d4e5f0034",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache"},{rule_id:"sgr-0a1b2c3d4e5f0035",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka event publishing"},{rule_id:"sgr-0a1b2c3d4e5f0036",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Prometheus metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0037",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-api-gateway",description:"API gateway requests"},{rule_id:"sgr-0a1b2c3d4e5f0038",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Inter-service communication"},{rule_id:"sgr-0a1b2c3d4e5f0039",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"Web tier service calls"},{rule_id:"sgr-0a1b2c3d4e5f0040",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database access"},{rule_id:"sgr-0a1b2c3d4e5f0041",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache access"},{rule_id:"sgr-0a1b2c3d4e5f0042",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka messaging"},{rule_id:"sgr-0a1b2c3d4e5f0043",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"External HTTPS APIs"},{rule_id:"sgr-0a1b2c3d4e5f0044",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"9200",source:"sg-elasticsearch",description:"Elasticsearch logging"},{rule_id:"sgr-0a1b2c3d4e5f0045",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"8200",source:"sg-vault",description:"Vault secrets retrieval"},{rule_id:"sgr-0a1b2c3d4e5f0046",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Prometheus metrics"},{rule_id:"sgr-0a1b2c3d4e5f0047",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-webapp-prod",description:"Kafka from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0048",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-api-gateway",description:"Kafka from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0049",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-microservices",description:"Kafka from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0050",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-analytics-prod",description:"Kafka from analytics"},{rule_id:"sgr-0a1b2c3d4e5f0051",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9093",source:"sg-kafka-prod",description:"Kafka inter-broker SSL"},{rule_id:"sgr-0a1b2c3d4e5f0052",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"2181",source:"sg-kafka-prod",description:"Zookeeper client port"},{rule_id:"sgr-0a1b2c3d4e5f0053",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"2888",source:"sg-kafka-prod",description:"Zookeeper peer port"},{rule_id:"sgr-0a1b2c3d4e5f0054",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"3888",source:"sg-kafka-prod",description:"Zookeeper leader election"},{rule_id:"sgr-0a1b2c3d4e5f0055",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9999",source:"sg-monitoring",description:"JMX metrics for Kafka"},{rule_id:"sgr-0a1b2c3d4e5f0056",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"8888",source:"10.100.0.0/16",description:"Jupyter notebook from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0057",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"4040",source:"10.100.0.0/16",description:"Spark UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0058",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"sg-bastion",description:"SSH from bastion"},{rule_id:"sgr-0a1b2c3d4e5f0059",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database queries"},{rule_id:"sgr-0a1b2c3d4e5f0060",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka streaming"},{rule_id:"sgr-0a1b2c3d4e5f0061",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 data lake access"},{rule_id:"sgr-0a1b2c3d4e5f0062",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"External ML APIs"},{rule_id:"sgr-0a1b2c3d4e5f0063",security_group:"sg-bastion",type:"Inbound",protocol:"TCP",port_range:"22",source:"10.100.0.0/16",description:"SSH from VPN only"},{rule_id:"sgr-0a1b2c3d4e5f0064",security_group:"sg-bastion",type:"Outbound",protocol:"TCP",port_range:"22",source:"10.0.0.0/8",description:"SSH to all internal hosts"},{rule_id:"sgr-0a1b2c3d4e5f0065",security_group:"sg-bastion",type:"Outbound",protocol:"TCP",port_range:"3389",source:"10.0.0.0/8",description:"RDP to Windows hosts"},{rule_id:"sgr-0a1b2c3d4e5f0066",security_group:"sg-alb-public",type:"Inbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS from Internet"},{rule_id:"sgr-0a1b2c3d4e5f0067",security_group:"sg-alb-public",type:"Inbound",protocol:"TCP",port_range:"80",source:"0.0.0.0/0",description:"HTTP redirect"},{rule_id:"sgr-0a1b2c3d4e5f0068",security_group:"sg-alb-public",type:"Outbound",protocol:"TCP",port_range:"443",source:"sg-api-gateway",description:"To API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0069",security_group:"sg-alb-public",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"To web application"},{rule_id:"sgr-0a1b2c3d4e5f0070",security_group:"sg-alb-internal",type:"Inbound",protocol:"TCP",port_range:"443",source:"10.0.0.0/8",description:"HTTPS from internal"},{rule_id:"sgr-0a1b2c3d4e5f0071",security_group:"sg-alb-internal",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"To microservices"},{rule_id:"sgr-0a1b2c3d4e5f0072",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"9090",source:"10.100.0.0/16",description:"Prometheus UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0073",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"3000",source:"10.100.0.0/16",description:"Grafana from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0074",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"9093",source:"10.100.0.0/16",description:"Alertmanager from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0075",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"9100",source:"10.0.0.0/8",description:"Node exporter scrape all"},{rule_id:"sgr-0a1b2c3d4e5f0076",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"9090",source:"10.0.0.0/8",description:"Application metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0077",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"PagerDuty/Slack alerts"},{rule_id:"sgr-0a1b2c3d4e5f0078",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-eks-control",description:"Kubelet API from control plane"},{rule_id:"sgr-0a1b2c3d4e5f0079",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"10250",source:"sg-eks-control",description:"Kubelet from control plane"},{rule_id:"sgr-0a1b2c3d4e5f0080",security_group:"sg-eks-nodes",type:"Inbound",protocol:"ALL",port_range:"ALL",source:"sg-eks-nodes",description:"Node to node all traffic"},{rule_id:"sgr-0a1b2c3d4e5f0081",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"30000-32767",source:"sg-alb-internal",description:"NodePort services from ALB"},{rule_id:"sgr-0a1b2c3d4e5f0082",security_group:"sg-eks-nodes",type:"Outbound",protocol:"ALL",port_range:"ALL",source:"0.0.0.0/0",description:"All outbound for pods"},{rule_id:"sgr-0a1b2c3d4e5f0083",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"10.100.0.0/16",description:"Kubernetes API from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0084",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-eks-nodes",description:"Kubernetes API from nodes"},{rule_id:"sgr-0a1b2c3d4e5f0085",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-jenkins",description:"Kubernetes API from CI/CD"},{rule_id:"sgr-0a1b2c3d4e5f0086",security_group:"sg-jenkins",type:"Inbound",protocol:"TCP",port_range:"8080",source:"10.100.0.0/16",description:"Jenkins UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0087",security_group:"sg-jenkins",type:"Inbound",protocol:"TCP",port_range:"50000",source:"10.80.0.0/16",description:"Jenkins agent connection"},{rule_id:"sgr-0a1b2c3d4e5f0088",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"22",source:"10.0.0.0/8",description:"SSH to build agents"},{rule_id:"sgr-0a1b2c3d4e5f0089",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"Git and registry access"},{rule_id:"sgr-0a1b2c3d4e5f0090",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"443",source:"sg-eks-control",description:"Kubernetes deployment"},{rule_id:"sgr-0a1b2c3d4e5f0091",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"9997",source:"10.0.0.0/8",description:"Log forwarding from all"},{rule_id:"sgr-0a1b2c3d4e5f0092",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"8000",source:"10.100.0.0/16",description:"Splunk Web from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0093",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"8089",source:"10.90.0.0/16",description:"Splunk API from monitoring"},{rule_id:"sgr-0a1b2c3d4e5f0094",security_group:"sg-splunk",type:"Inbound",protocol:"UDP",port_range:"514",source:"10.0.0.0/8",description:"Syslog UDP from all"},{rule_id:"sgr-0a1b2c3d4e5f0095",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"514",source:"10.0.0.0/8",description:"Syslog TCP from all"},{rule_id:"sgr-0a1b2c3d4e5f0096",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.30.0.0/16",description:"Vault API from applications"},{rule_id:"sgr-0a1b2c3d4e5f0097",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.80.0.0/16",description:"Vault API from CI/CD"},{rule_id:"sgr-0a1b2c3d4e5f0098",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.100.0.0/16",description:"Vault UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0099",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8201",source:"sg-vault",description:"Vault cluster port"},{rule_id:"sgr-0a1b2c3d4e5f0100",security_group:"sg-vault",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-68a54001",description:"DynamoDB for storage backend"},{rule_id:"sgr-0a1b2c3d4e5f0101",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"sg-microservices",description:"ES API from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0102",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"sg-splunk",description:"ES API from Splunk"},{rule_id:"sgr-0a1b2c3d4e5f0103",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"10.100.0.0/16",description:"Kibana from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0104",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9300",source:"sg-elasticsearch",description:"ES cluster transport"},{rule_id:"sgr-0a1b2c3d4e5f0105",security_group:"sg-elasticsearch",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for snapshots"},{rule_id:"sgr-0a1b2c3d4e5f0106",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"8443",source:"sg-api-gateway",description:"Payment API from gateway"},{rule_id:"sgr-0a1b2c3d4e5f0107",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"443",source:"203.0.113.0/24",description:"Stripe webhooks"},{rule_id:"sgr-0a1b2c3d4e5f0108",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"443",source:"199.16.156.0/24",description:"PayPal webhooks"},{rule_id:"sgr-0a1b2c3d4e5f0109",security_group:"sg-payment",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"Payment provider APIs"},{rule_id:"sgr-0a1b2c3d4e5f0110",security_group:"sg-payment",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Transaction database"},{rule_id:"sgr-0a1b2c3d4e5f0111",security_group:"sg-recommendation",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-api-gateway",description:"ML API from gateway"},{rule_id:"sgr-0a1b2c3d4e5f0112",security_group:"sg-recommendation",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"ML API from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0113",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"User profiles database"},{rule_id:"sgr-0a1b2c3d4e5f0114",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Feature caching"},{rule_id:"sgr-0a1b2c3d4e5f0115",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for model artifacts"},{rule_id:"sgr-0a1b2c3d4e5f0116",security_group:"sg-nat-gateway",type:"Inbound",protocol:"ALL",port_range:"ALL",source:"10.0.0.0/8",description:"NAT from private subnets"},{rule_id:"sgr-0a1b2c3d4e5f0117",security_group:"sg-nat-gateway",type:"Outbound",protocol:"ALL",port_range:"ALL",source:"0.0.0.0/0",description:"NAT to Internet"},{rule_id:"sgr-0a1b2c3d4e5f0118",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"9997",source:"sg-splunk",description:"Log forwarding to Splunk"},{rule_id:"sgr-0a1b2c3d4e5f0119",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-recommendation",description:"PostgreSQL from recommendation"},{rule_id:"sgr-0a1b2c3d4e5f0120",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-payment",description:"PostgreSQL from payment service"}],dr={security_groups:zg,rules:$g},Bg=[{nsg_id:"nsg-webapp-prod",name:"nsg-webapp-prod",resource_group:"rg-production-eastus",location:"eastus",description:"Production web application NSG"},{nsg_id:"nsg-database-prod",name:"nsg-database-prod",resource_group:"rg-production-eastus",location:"eastus",description:"Production database NSG"},{nsg_id:"nsg-api-prod",name:"nsg-api-prod",resource_group:"rg-production-eastus",location:"eastus",description:"API tier NSG"},{nsg_id:"nsg-aks-nodes",name:"nsg-aks-nodes",resource_group:"rg-aks-eastus",location:"eastus",description:"AKS worker nodes NSG"},{nsg_id:"nsg-management",name:"nsg-management",resource_group:"rg-management",location:"eastus",description:"Management subnet NSG"},{nsg_id:"nsg-dmz",name:"nsg-dmz",resource_group:"rg-production-eastus",location:"eastus",description:"DMZ subnet NSG"}],Zg=[{rule_name:"Allow-HTTPS-Internet-Inbound",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"443"},{rule_name:"Allow-HTTP-Redirect-Inbound",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"80"},{rule_name:"Allow-AppGW-to-WebApp",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"GatewaySubnet",destination_asg:"asg-webapp",port:"8080"},{rule_name:"Allow-WebApp-to-API",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-api",port:"8080"},{rule_name:"Allow-API-Internal-Comm",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-api",port:"8080"},{rule_name:"Allow-WebApp-to-SQL",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-API-to-SQL",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-Analytics-to-SQL",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-Jenkins-to-SQL",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-jenkins",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-VPN-to-SQL",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-WebApp-to-Redis",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-redis",port:"6379"},{rule_name:"Allow-API-to-Redis",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-redis",port:"6379"},{rule_name:"Allow-Redis-Cluster-Internal",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"16379"},{rule_name:"Allow-Redis-Sentinel",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"26379"},{rule_name:"Allow-WebApp-to-Kafka",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-API-to-Kafka",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-Analytics-to-Kafka",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-Kafka-Inter-Broker",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"9093"},{rule_name:"Allow-Kafka-Zookeeper",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"2181"},{rule_name:"Allow-Kafka-ZK-Peer",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"2888"},{rule_name:"Allow-Prometheus-Scrape-All",priority:200,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"*",port:"9090"},{rule_name:"Allow-NodeExporter-Scrape",priority:210,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"*",port:"9100"},{rule_name:"Allow-Grafana-VPN",priority:220,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"3000"},{rule_name:"Allow-Prometheus-VPN",priority:230,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"9090"},{rule_name:"Allow-Alertmanager-VPN",priority:240,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"9093"},{rule_name:"Allow-AKS-NodePort-Range",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-appgw",destination_asg:"asg-aks-nodes",port:"30000-32767"},{rule_name:"Allow-AKS-Kubelet",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureKubernetes",destination_asg:"asg-aks-nodes",port:"10250"},{rule_name:"Allow-AKS-DNS",priority:120,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"asg-aks-nodes",destination_asg:"asg-aks-nodes",port:"53"},{rule_name:"Allow-AKS-Node-Internal",priority:130,direction:"Inbound",access:"Allow",protocol:"*",source_asg:"asg-aks-nodes",destination_asg:"asg-aks-nodes",port:"*"},{rule_name:"Allow-AKS-Metrics",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"asg-aks-nodes",port:"10255"},{rule_name:"Allow-Bastion-SSH-All",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureBastionSubnet",destination_asg:"*",port:"22"},{rule_name:"Allow-Bastion-RDP-All",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureBastionSubnet",destination_asg:"*",port:"3389"},{rule_name:"Allow-VPN-SSH",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"*",port:"22"},{rule_name:"Allow-Jenkins-VPN",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-jenkins",port:"8080"},{rule_name:"Allow-Jenkins-Agent",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.80.0.0/16",destination_asg:"asg-jenkins",port:"50000"},{rule_name:"Allow-ES-from-API",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-elasticsearch",port:"9200"},{rule_name:"Allow-ES-from-WebApp",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-elasticsearch",port:"9200"},{rule_name:"Allow-ES-Cluster-Transport",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-elasticsearch",destination_asg:"asg-elasticsearch",port:"9300"},{rule_name:"Allow-Kibana-VPN",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-elasticsearch",port:"5601"},{rule_name:"Allow-CosmosDB-Access",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"AzureCosmosDB",port:"443"},{rule_name:"Allow-Storage-Access",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"Storage",port:"443"},{rule_name:"Allow-KeyVault-Access",priority:120,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureKeyVault",port:"443"},{rule_name:"Allow-EventHub-Access",priority:130,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"EventHub",port:"5671"},{rule_name:"Allow-ServiceBus-Access",priority:140,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"ServiceBus",port:"5671"},{rule_name:"Allow-AzureMonitor-Outbound",priority:150,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureMonitor",port:"443"},{rule_name:"Allow-AzureAD-Outbound",priority:160,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureActiveDirectory",port:"443"},{rule_name:"Allow-ACR-Outbound",priority:170,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-aks-nodes",destination_asg:"AzureContainerRegistry",port:"443"},{rule_name:"Deny-Internet-DB-Outbound",priority:4e3,direction:"Outbound",access:"Deny",protocol:"*",source_asg:"asg-database",destination_asg:"Internet",port:"*"},{rule_name:"Allow-LB-Health-Probe",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureLoadBalancer",destination_asg:"*",port:"*"},{rule_name:"Allow-FrontDoor-to-AppGW",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureFrontDoor.Backend",destination_asg:"asg-appgw",port:"443"},{rule_name:"Allow-VNet-Internal",priority:65e3,direction:"Inbound",access:"Allow",protocol:"*",source_asg:"VirtualNetwork",destination_asg:"VirtualNetwork",port:"*"},{rule_name:"Allow-PostgreSQL-Flexible",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"5432"},{rule_name:"Allow-MySQL-Flexible",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"3306"},{rule_name:"Allow-Synapse-Analytics",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"Sql",port:"1433"},{rule_name:"Allow-DataFactory-Integration",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"DataFactory",port:"443"},{rule_name:"Deny-All-Inbound-Default",priority:65500,direction:"Inbound",access:"Deny",protocol:"*",source_asg:"*",destination_asg:"*",port:"*"},{rule_name:"Allow-Analytics-Jupyter",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-analytics",port:"8888"},{rule_name:"Allow-Analytics-Spark-UI",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-analytics",port:"4040"},{rule_name:"Allow-Analytics-to-Storage",priority:120,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"Storage.EastUS",port:"443"},{rule_name:"Allow-WebApp-HTTPS-Out",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"Internet",port:"443"},{rule_name:"Allow-API-HTTPS-Out",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"Internet",port:"443"},{rule_name:"Allow-NTP-Outbound",priority:200,direction:"Outbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"*",port:"123"},{rule_name:"Allow-DNS-Outbound",priority:210,direction:"Outbound",access:"Allow",protocol:"*",source_asg:"*",destination_asg:"*",port:"53"},{rule_name:"Allow-SMTP-Outbound",priority:300,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"*",port:"587"},{rule_name:"Allow-SignalR-WebSocket",priority:160,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"443"},{rule_name:"Allow-AppInsights-Outbound",priority:180,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"ApplicationInsightsAvailability",port:"443"},{rule_name:"Allow-Redis-Enterprise-Sync",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"8443"},{rule_name:"Allow-SQL-Managed-Instance",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"11000-11999"},{rule_name:"Allow-SFTP-Partner-Access",priority:170,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"198.51.100.0/24",destination_asg:"asg-webapp",port:"22"},{rule_name:"Allow-VPN-Gateway-IKE",priority:100,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"GatewaySubnet",port:"500"},{rule_name:"Allow-VPN-Gateway-NAT-T",priority:110,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"GatewaySubnet",port:"4500"},{rule_name:"Allow-ExpressRoute-BGP",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"GatewaySubnet",destination_asg:"GatewaySubnet",port:"179"},{rule_name:"Allow-APIM-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"ApiManagement",destination_asg:"asg-api",port:"3443"},{rule_name:"Allow-APIM-Gateway",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-api",port:"443"},{rule_name:"Allow-ServiceFabric-Cluster",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-webapp",port:"19000-19080"},{rule_name:"Allow-AKS-Tunnel-Front",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"9000"},{rule_name:"Allow-AKS-Tunnel-TCP",priority:160,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"1194"},{rule_name:"Allow-AKS-Tunnel-UDP",priority:170,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"1194"},{rule_name:"Allow-HDInsight-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"HDInsight",destination_asg:"asg-analytics",port:"443"},{rule_name:"Allow-Databricks-Control",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureDatabricks",destination_asg:"asg-analytics",port:"443"},{rule_name:"Allow-ML-Studio-Compute",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureMachineLearning",destination_asg:"asg-analytics",port:"44224"},{rule_name:"Allow-Batch-NodeMgmt",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"BatchNodeManagement",destination_asg:"asg-analytics",port:"29876-29877"},{rule_name:"Allow-LogAnalytics-Agent",priority:200,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureMonitor",port:"443"},{rule_name:"Allow-ASE-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AppServiceManagement",destination_asg:"asg-webapp",port:"454-455"},{rule_name:"Allow-ASE-Internal-LB",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-webapp",port:"16001"},{rule_name:"Deny-SQL-Internet-Inbound",priority:4090,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"asg-database",port:"1433"},{rule_name:"Deny-SSH-Internet-Inbound",priority:4091,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"*",port:"22"},{rule_name:"Deny-RDP-Internet-Inbound",priority:4092,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"*",port:"3389"},{rule_name:"Allow-Private-Endpoint-SQL",priority:200,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"PrivateEndpoints",port:"1433"},{rule_name:"Allow-Private-Endpoint-Storage",priority:210,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"PrivateEndpoints",port:"443"},{rule_name:"Allow-Private-Endpoint-KV",priority:220,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"PrivateEndpoints",port:"443"},{rule_name:"Allow-Defender-Communication",priority:190,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureSecurityCenter",port:"443"},{rule_name:"Allow-Update-Management",priority:195,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureUpdateDelivery",port:"443"},{rule_name:"Allow-Guest-Config",priority:196,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"GuestAndHybridManagement",port:"443"},{rule_name:"Allow-ServiceTags-AzureCloud",priority:3900,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureCloud",port:"443"},{rule_name:"Allow-Backup-to-RSV",priority:180,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureBackup",port:"443"},{rule_name:"Allow-ASR-Replication",priority:185,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureSiteRecovery",port:"443"},{rule_name:"Deny-All-Outbound-Default",priority:65500,direction:"Outbound",access:"Deny",protocol:"*",source_asg:"*",destination_asg:"*",port:"*"}],qt={network_security_groups:Bg,rules:Zg},qg=[{network_id:"vpc-production",name:"vpc-production",project:"company-prod-12345",description:"Production VPC network"},{network_id:"vpc-staging",name:"vpc-staging",project:"company-staging-12345",description:"Staging VPC network"},{network_id:"vpc-development",name:"vpc-development",project:"company-dev-12345",description:"Development VPC network"},{network_id:"vpc-shared-services",name:"vpc-shared-services",project:"company-shared-12345",description:"Shared services VPC"},{network_id:"vpc-data-analytics",name:"vpc-data-analytics",project:"company-analytics-12345",description:"Data analytics VPC"}],Kg=[{rule_name:"allow-https-ingress",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["web-server"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-http-ingress",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["web-server"],protocols:"tcp:80",logging:"Enabled"},{rule_name:"allow-ssh-iap",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:["allow-ssh"],protocols:"tcp:22",logging:"Enabled"},{rule_name:"allow-ssh-vpn",network:"vpc-production",priority:1010,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["allow-ssh"],protocols:"tcp:22",logging:"Enabled"},{rule_name:"allow-rdp-iap",network:"vpc-production",priority:1020,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:["allow-ssh"],protocols:"tcp:3389",logging:"Enabled"},{rule_name:"allow-db-from-app-postgres",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432",logging:"Enabled"},{rule_name:"allow-db-from-app-mysql",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-web",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-analytics",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-vpn",network:"vpc-production",priority:1004,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-redis-from-app",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-redis-from-web",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-redis-cluster-bus",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["redis-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:16379",logging:"Disabled"},{rule_name:"allow-redis-sentinel",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:["redis-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:26379",logging:"Disabled"},{rule_name:"allow-internal-all",network:"vpc-production",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"deny-all-ingress",network:"vpc-production",priority:65535,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-gke-master-to-nodes-https",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["172.16.0.0/28"],target_tags:["gke-node"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-gke-master-to-nodes-kubelet",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["172.16.0.0/28"],target_tags:["gke-node"],protocols:"tcp:10250",logging:"Enabled"},{rule_name:"allow-gke-node-to-node",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"all",logging:"Disabled"},{rule_name:"allow-gke-node-to-pods",network:"vpc-production",priority:1010,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-health-check-tcp",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.191.0.0/16","130.211.0.0/22"],target_tags:["allow-health-check"],protocols:"tcp",logging:"Enabled"},{rule_name:"allow-health-check-ssl",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.191.0.0/16","130.211.0.0/22"],target_tags:["allow-health-check"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-lb-to-backend-http",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:80",logging:"Enabled"},{rule_name:"allow-lb-to-backend-https",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-lb-to-backend-8080",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-kafka-producer",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server","web-server"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9092",logging:"Enabled"},{rule_name:"allow-kafka-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["kafka-broker"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9092,tcp:9093",logging:"Disabled"},{rule_name:"allow-kafka-jmx",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9999",logging:"Disabled"},{rule_name:"allow-zookeeper-client",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["kafka-broker"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:2181",logging:"Enabled"},{rule_name:"allow-zookeeper-peer",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["zookeeper"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:2888",logging:"Disabled"},{rule_name:"allow-zookeeper-election",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["zookeeper"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:3888",logging:"Disabled"},{rule_name:"allow-prometheus-scrape-9090",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:[],protocols:"tcp:9090",logging:"Disabled"},{rule_name:"allow-prometheus-scrape-9100",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:[],protocols:"tcp:9100",logging:"Disabled"},{rule_name:"allow-grafana-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["monitoring"],protocols:"tcp:3000",logging:"Enabled"},{rule_name:"allow-alertmanager-vpn",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["monitoring"],protocols:"tcp:9093",logging:"Enabled"},{rule_name:"allow-elasticsearch-api",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["log-shipper","app-server"],source_ranges:[],target_tags:["elasticsearch"],protocols:"tcp:9200",logging:"Enabled"},{rule_name:"allow-elasticsearch-cluster",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["elasticsearch"],source_ranges:[],target_tags:["elasticsearch"],protocols:"tcp:9300",logging:"Disabled"},{rule_name:"allow-kibana-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["elasticsearch"],protocols:"tcp:5601",logging:"Enabled"},{rule_name:"allow-vault-api",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server","web-server","jenkins"],source_ranges:[],target_tags:["vault-server"],protocols:"tcp:8200",logging:"Enabled"},{rule_name:"allow-vault-cluster",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["vault-server"],source_ranges:[],target_tags:["vault-server"],protocols:"tcp:8201",logging:"Disabled"},{rule_name:"allow-vault-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["vault-server"],protocols:"tcp:8200",logging:"Enabled"},{rule_name:"allow-jenkins-vpn",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["jenkins"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-jenkins-agent",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.80.0.0/16"],target_tags:["jenkins"],protocols:"tcp:50000",logging:"Enabled"},{rule_name:"allow-cloud-sql-proxy",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:3307",logging:"Enabled"},{rule_name:"allow-memorystore-redis",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-pubsub-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["pubsub-client"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-bigquery-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-cloud-storage",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-monitoring-agent",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-analytics-jupyter",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8888",logging:"Enabled"},{rule_name:"allow-analytics-spark",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:4040",logging:"Enabled"},{rule_name:"allow-analytics-airflow",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"deny-egress-internet",network:"vpc-production",priority:65535,direction:"EGRESS",action:"deny",source_tags:[],source_ranges:[],target_tags:["no-internet"],protocols:"all",logging:"Enabled"},{rule_name:"allow-nat-egress",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["needs-nat"],source_ranges:[],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-cloud-functions-vpc",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.8.0.0/28"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-cloud-run-vpc",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.8.0.16/28"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-gke-ingress-nginx",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["gke-node"],protocols:"tcp:80,tcp:443",logging:"Enabled"},{rule_name:"allow-ml-training-gpu",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["ml-training"],protocols:"tcp:6006,tcp:8888",logging:"Enabled"},{rule_name:"allow-ml-training-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["ml-training"],source_ranges:[],target_tags:["ml-training"],protocols:"all",logging:"Disabled"},{rule_name:"allow-dataflow-worker",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:["analytics-server"],protocols:"tcp:12345-12346",logging:"Enabled"},{rule_name:"allow-dataproc-master",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8088,tcp:9870,tcp:8080",logging:"Enabled"},{rule_name:"allow-dataproc-worker",network:"vpc-data-analytics",priority:1001,direction:"INGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:["analytics-server"],protocols:"all",logging:"Disabled"},{rule_name:"allow-composer-airflow",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8080,tcp:3306,tcp:6379",logging:"Enabled"},{rule_name:"allow-bigtable-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-spanner-api",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-firestore-api",network:"vpc-production",priority:1002,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-artifact-registry",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["gke-node","jenkins"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-gcr-io",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["gke-node","jenkins"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-web-to-app",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-app-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-grpc-internal",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:50051",logging:"Enabled"},{rule_name:"allow-envoy-admin",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:15000",logging:"Disabled"},{rule_name:"allow-istio-pilot",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"tcp:15010,tcp:15012",logging:"Enabled"},{rule_name:"allow-istio-telemetry",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"tcp:15014",logging:"Disabled"},{rule_name:"allow-kiali-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["gke-node"],protocols:"tcp:20001",logging:"Enabled"},{rule_name:"allow-jaeger-vpn",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["gke-node"],protocols:"tcp:16686",logging:"Enabled"},{rule_name:"deny-ssh-public",network:"vpc-production",priority:2e3,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:22",logging:"Enabled"},{rule_name:"deny-rdp-public",network:"vpc-production",priority:2001,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:3389",logging:"Enabled"},{rule_name:"deny-mysql-public",network:"vpc-production",priority:2002,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:3306",logging:"Enabled"},{rule_name:"deny-postgres-public",network:"vpc-production",priority:2003,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:5432",logging:"Enabled"},{rule_name:"allow-vpn-tunnel",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["198.51.100.0/24"],target_tags:[],protocols:"udp:500,udp:4500,esp",logging:"Enabled"},{rule_name:"allow-cloud-dns-forwarding",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.199.192.0/19"],target_tags:[],protocols:"tcp:53,udp:53",logging:"Enabled"},{rule_name:"allow-private-google-access",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-iap-forwarding",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:[],protocols:"tcp:22,tcp:3389",logging:"Enabled"},{rule_name:"allow-interconnect-attachment",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-stackdriver-agent",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-secret-manager",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-kms-api",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"staging-allow-https",network:"vpc-staging",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["web-server"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"staging-allow-all-internal",network:"vpc-staging",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"dev-allow-all-vpn",network:"vpc-development",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"dev-allow-all-internal",network:"vpc-development",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"shared-allow-dns",network:"vpc-shared-services",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:53,udp:53",logging:"Enabled"},{rule_name:"shared-allow-ntp",network:"vpc-shared-services",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"udp:123",logging:"Disabled"},{rule_name:"shared-allow-ldap",network:"vpc-shared-services",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:389,tcp:636",logging:"Enabled"},{rule_name:"shared-allow-smtp",network:"vpc-shared-services",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:25,tcp:587",logging:"Enabled"},{rule_name:"allow-vertex-ai-training",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:["ml-training"],protocols:"tcp:2222,tcp:6006",logging:"Enabled"},{rule_name:"allow-vertex-ai-prediction",network:"vpc-data-analytics",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["ml-training"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-notebooks-api",network:"vpc-data-analytics",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"}],Mn={networks:qg,rules:Kg},Qg=()=>{const e=new Map;dr.security_groups.forEach(n=>e.set(n.name,n));const t=new Map;return dr.rules.forEach(n=>{t.has(n.security_group)||t.set(n.security_group,{inbound:[],outbound:[]});const a=t.get(n.security_group);n.type==="Inbound"?a.inbound.push(n):a.outbound.push(n)}),dr.security_groups.map(n=>{var a,s;return{id:n.sg_id,name:n.name,description:n.description,vpcId:n.vpc,vpcName:n.vpc,provider:"aws",inboundRules:(((a=t.get(n.name))==null?void 0:a.inbound)||[]).map(o=>({id:o.rule_id,protocol:o.protocol.toLowerCase(),portRange:o.port_range,source:o.source,description:o.description})),outboundRules:(((s=t.get(n.name))==null?void 0:s.outbound)||[]).map(o=>({id:o.rule_id,protocol:o.protocol.toLowerCase(),portRange:o.port_range,source:o.source,description:o.description}))}})},Yg=()=>{const e=new Map;return qt.rules.forEach(t=>{const n=t.destination_asg||"default";e.has(n)||e.set(n,{inbound:[],outbound:[]});const a=e.get(n);t.direction==="Inbound"?a.inbound.push(t):a.outbound.push(t)}),qt.network_security_groups.map(t=>({id:t.nsg_id,name:t.name,description:t.description,vpcId:t.resource_group,vpcName:t.resource_group,provider:"azure",inboundRules:qt.rules.filter(n=>n.direction==="Inbound").slice(0,10).map((n,a)=>({id:`${t.nsg_id}-in-${a}`,protocol:n.protocol.toLowerCase(),portRange:String(n.port),source:n.source_asg,description:n.rule_name})),outboundRules:qt.rules.filter(n=>n.direction==="Outbound").slice(0,5).map((n,a)=>({id:`${t.nsg_id}-out-${a}`,protocol:n.protocol.toLowerCase(),portRange:String(n.port),source:n.destination_asg,description:n.rule_name}))}))},Xg=()=>{const e=new Map;return Mn.rules.forEach(t=>{e.has(t.network)||e.set(t.network,[]),e.get(t.network).push(t)}),Mn.networks.map(t=>{const n=e.get(t.name)||[];return{id:t.network_id,name:t.name,description:t.description,vpcId:t.project,vpcName:t.project,provider:"gcp",inboundRules:n.filter(a=>a.direction==="INGRESS").slice(0,10).map((a,s)=>{var o,i;return{id:`${t.network_id}-in-${s}`,protocol:a.protocols.split(":")[0]||"tcp",portRange:a.protocols.split(":")[1]||"all",source:((o=a.source_ranges)==null?void 0:o.join(", "))||((i=a.source_tags)==null?void 0:i.join(", "))||"any",description:a.rule_name}}),outboundRules:n.filter(a=>a.direction==="EGRESS").slice(0,5).map((a,s)=>{var o;return{id:`${t.network_id}-out-${s}`,protocol:a.protocols.split(":")[0]||"tcp",portRange:a.protocols.split(":")[1]||"all",source:((o=a.target_tags)==null?void 0:o.join(", "))||"any",description:a.rule_name}})}})},Ds={aws:{provider:"aws",vpcCount:5,subnetCount:24,securityGroupCount:dr.security_groups.length,loadBalancerCount:8,transitGatewayCount:2,totalInstances:156,regions:["us-east-1","us-west-2","eu-west-1","ap-southeast-1"],healthScore:94,issueCount:3,lastSync:new Date(Date.now()-5*60*1e3).toISOString()},azure:{provider:"azure",vpcCount:qt.network_security_groups.length,subnetCount:15,securityGroupCount:qt.network_security_groups.length,loadBalancerCount:5,transitGatewayCount:1,totalInstances:89,regions:["eastus","westeurope","southeastasia"],healthScore:87,issueCount:5,lastSync:new Date(Date.now()-8*60*1e3).toISOString()},gcp:{provider:"gcp",vpcCount:Mn.networks.length,subnetCount:12,securityGroupCount:Mn.rules.length,loadBalancerCount:4,transitGatewayCount:0,totalInstances:67,regions:["us-central1","europe-west1"],healthScore:92,issueCount:2,lastSync:new Date(Date.now()-3*60*1e3).toISOString()}},Ms={aws:[{id:"vpc-prod-us-east-1",name:"Production VPC US-East-1",cidrBlock:"10.0.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:8,securityGroupCount:dr.security_groups.filter(e=>e.vpc==="vpc-prod-us-east-1").length||15,instanceCount:45},{id:"vpc-devops-us-east-1",name:"DevOps VPC",cidrBlock:"10.80.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:4,securityGroupCount:8,instanceCount:23},{id:"vpc-pci-us-east-1",name:"PCI-DSS VPC",cidrBlock:"10.90.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:4,securityGroupCount:6,instanceCount:12},{id:"vpc-dmz-01",name:"DMZ VPC",cidrBlock:"172.16.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:2,securityGroupCount:10,instanceCount:8},{id:"vpc-default",name:"Default VPC",cidrBlock:"172.31.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!0,subnetCount:6,securityGroupCount:8,instanceCount:68}],azure:qt.network_security_groups.map((e,t)=>({id:`vnet-${e.location}-${t}`,name:`${e.resource_group} VNet`,cidrBlock:`10.${10+t}.0.0/16`,region:e.location,provider:"azure",status:"active",isDefault:!1,subnetCount:6,securityGroupCount:12,instanceCount:34})),gcp:Mn.networks.map(e=>({id:e.network_id,name:e.name,cidrBlock:"auto",region:"us-central1",provider:"gcp",status:"active",isDefault:!1,subnetCount:8,securityGroupCount:Mn.rules.filter(t=>t.network===e.name).length,instanceCount:45}))},Jl={aws:Qg(),azure:Yg(),gcp:Xg()},Jg={aws:[{id:"alb-prod-web",name:"prod-web-alb",type:"application",scheme:"internet-facing",state:"active",dnsName:"prod-web-alb-123456.us-east-1.elb.amazonaws.com",vpcId:"vpc-prod-us-east-1",listenerCount:2,targetGroupCount:3,healthyTargets:6,totalTargets:6},{id:"nlb-prod-api",name:"prod-api-nlb",type:"network",scheme:"internal",state:"active",dnsName:"prod-api-nlb-789012.us-east-1.elb.amazonaws.com",vpcId:"vpc-prod-us-east-1",listenerCount:1,targetGroupCount:1,healthyTargets:4,totalTargets:4},{id:"alb-staging",name:"staging-alb",type:"application",scheme:"internet-facing",state:"active",dnsName:"staging-alb-345678.us-west-2.elb.amazonaws.com",vpcId:"vpc-staging-01",listenerCount:1,targetGroupCount:2,healthyTargets:2,totalTargets:2}],azure:[{id:"lb-prod-web",name:"prod-web-lb",type:"application",scheme:"internet-facing",state:"active",dnsName:"prod-web-lb.eastus.cloudapp.azure.com",vpcId:"vnet-prod-01",listenerCount:2,targetGroupCount:2,healthyTargets:4,totalTargets:5},{id:"lb-prod-internal",name:"prod-internal-lb",type:"network",scheme:"internal",state:"active",dnsName:"prod-internal-lb.internal",vpcId:"vnet-prod-01",listenerCount:1,targetGroupCount:1,healthyTargets:3,totalTargets:3}],gcp:[{id:"lb-prod",name:"production-lb",type:"application",scheme:"internet-facing",state:"active",dnsName:"34.120.123.45",vpcId:"vpc-production",listenerCount:1,targetGroupCount:2,healthyTargets:5,totalTargets:5}]},ef={aws:[{id:"tgw-prod",name:"production-tgw",state:"available",routeTables:3,region:"us-east-1",attachments:[{id:"tgw-attach-1",resourceType:"vpc",resourceId:"vpc-prod-us-east-1",resourceName:"Production VPC",state:"available"},{id:"tgw-attach-2",resourceType:"vpc",resourceId:"vpc-devops-us-east-1",resourceName:"DevOps VPC",state:"available"},{id:"tgw-attach-3",resourceType:"vpc",resourceId:"vpc-pci-us-east-1",resourceName:"PCI-DSS VPC",state:"available"},{id:"tgw-attach-4",resourceType:"vpn",resourceId:"vpn-onprem",resourceName:"On-Premises VPN",state:"available"}]},{id:"tgw-dr",name:"disaster-recovery-tgw",state:"available",routeTables:1,region:"us-west-2",attachments:[{id:"tgw-attach-5",resourceType:"vpc",resourceId:"vpc-staging-01",resourceName:"Staging VPC",state:"available"},{id:"tgw-attach-6",resourceType:"peering",resourceId:"tgw-prod",resourceName:"Production TGW Peering",state:"available"}]}],azure:[{id:"vhub-prod",name:"production-virtual-hub",state:"available",routeTables:2,region:"eastus",attachments:[{id:"conn-1",resourceType:"vpc",resourceId:"vnet-eastus-0",resourceName:"Production VNet",state:"available"},{id:"conn-2",resourceType:"vpc",resourceId:"vnet-eastus-1",resourceName:"Development VNet",state:"available"}]}],gcp:[]},Je=e=>new Promise(t=>setTimeout(t,e)),ve={async getOverview(e){return await Je(300),Ds[e]},async getAllOverviews(){return await Je(500),Object.values(Ds)},async getVPCs(e){return await Je(400),Ms[e]||[]},async getVPCDetails(e,t){return await Je(200),(Ms[e]||[]).find(a=>a.id===t)||null},async getSubnets(e,t){var o;await Je(300);const n=(o=Ms[e])==null?void 0:o.find(i=>i.id===t);if(!n)return[];const a=[],s=e==="aws"?["a","b","c"]:e==="azure"?["1","2","3"]:["a","b"];for(let i=0;i<n.subnetCount;i++){const l=i<n.subnetCount/2;a.push({id:`${t}-subnet-${i+1}`,name:`${l?"public":"private"}-subnet-${i%3+1}`,vpcId:t,cidrBlock:`10.${i}.0.0/24`,availabilityZone:`${n.region}${s[i%s.length]}`,isPublic:l,availableIps:250-Math.floor(Math.random()*100),instanceCount:Math.floor(n.instanceCount/n.subnetCount)})}return a},async getSecurityGroups(e,t){await Je(400);let n=Jl[e]||[];return t&&(n=n.filter(a=>a.vpcId===t)),n},async getSecurityGroupDetails(e,t){return await Je(200),(Jl[e]||[]).find(a=>a.id===t)||null},async getLoadBalancers(e){return await Je(400),Jg[e]||[]},async getTransitGateways(e){return await Je(400),ef[e]||[]},async syncResources(e){return await Je(2e3),Ds[e].lastSync=new Date().toISOString(),{success:!0,message:`Successfully synced ${e.toUpperCase()} resources`}}},tf={total_validations:110,pass:45,fail:32,warning:23,exception:7,pending_review:3,by_severity:{critical:8,high:18,medium:35,low:29,info:20}},nf=[{validation_id:"VAL-0001",rule_reference:"sgr-0a1b2c3d4e5f0001",rule_name:"Web-HTTPS-Inbound",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"INFO",status:"PASS",expected_value:"Restricted source CIDR or security group",actual_value:"0.0.0.0/0 (Acceptable for public HTTPS)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Public web server - 0.0.0.0/0 is expected for port 443",remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0002",rule_reference:"sgr-legacy-ssh-001",rule_name:"Legacy-SSH-Any-Source",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"CRITICAL",status:"FAIL",expected_value:"Restricted source CIDR (VPN or bastion only)",actual_value:"0.0.0.0/0 to port 22",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict SSH access to VPN CIDR 10.100.0.0/16 or bastion security group sg-bastion",ticket_reference:null},{validation_id:"VAL-0003",rule_reference:"sgr-rdp-any-001",rule_name:"Legacy-RDP-Any-Source",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"CRITICAL",status:"FAIL",expected_value:"Restricted source CIDR (VPN only)",actual_value:"0.0.0.0/0 to port 3389",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict RDP access to VPN CIDR 10.100.0.0/16 or use Azure Bastion/AWS SSM",ticket_reference:null},{validation_id:"VAL-0004",rule_reference:"sgr-0a1b2c3d4e5f0011",rule_name:"Database-PostgreSQL-Access",platform:"AWS",validation_category:"SECURITY",validation_check:"DATABASE_ACCESS_RESTRICTION",check_description:"Validates that database ports are only accessible from application tiers",severity:"LOW",status:"PASS",expected_value:"Source restricted to application security groups",actual_value:"sg-webapp-prod",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012346"},{validation_id:"VAL-0005",rule_reference:"nsg-rule-db-any",rule_name:"Database-Any-Access",platform:"Azure",validation_category:"SECURITY",validation_check:"DATABASE_ACCESS_RESTRICTION",check_description:"Validates that database ports are only accessible from application tiers",severity:"HIGH",status:"FAIL",expected_value:"Source restricted to application ASGs",actual_value:"Source: * (Any)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Change source from '*' to 'asg-webapp' or 'asg-api' application security groups",ticket_reference:null},{validation_id:"VAL-0006",rule_reference:"pa-rule-any-any",rule_name:"Allow-Any-Any-Trust",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_RULE",check_description:"Validates that rules do not allow any-to-any traffic without restrictions",severity:"CRITICAL",status:"FAIL",expected_value:"Specific source, destination, application, and service",actual_value:"Source: any, Dest: any, App: any, Service: any",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace with specific rules for required traffic flows. Remove this overly permissive rule.",ticket_reference:null},{validation_id:"VAL-0007",rule_reference:"sgr-0a1b2c3d4e5f0021",rule_name:"Redis-Cache-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DESCRIPTION_REQUIRED",check_description:"Validates that all rules have meaningful descriptions",severity:"LOW",status:"PASS",expected_value:"Non-empty description explaining rule purpose",actual_value:"Allow Redis access from web tier for session caching",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012347"},{validation_id:"VAL-0008",rule_reference:"sgr-nodesc-001",rule_name:"Unnamed-Rule-8080",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DESCRIPTION_REQUIRED",check_description:"Validates that all rules have meaningful descriptions",severity:"MEDIUM",status:"FAIL",expected_value:"Non-empty description explaining rule purpose",actual_value:"(empty)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add description: 'Allow application traffic from [source] for [purpose]'",ticket_reference:null},{validation_id:"VAL-0009",rule_reference:"gcp-allow-all-egress",rule_name:"default-allow-all-egress",platform:"GCP",validation_category:"SECURITY",validation_check:"UNRESTRICTED_EGRESS",check_description:"Validates that egress rules are restricted to required destinations",severity:"HIGH",status:"WARNING",expected_value:"Egress restricted to specific destinations or services",actual_value:"0.0.0.0/0 for all protocols",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Consider restricting egress to specific destinations. Implement egress filtering for sensitive workloads.",ticket_reference:null},{validation_id:"VAL-0010",rule_reference:"nsg-webapp-prod-100",rule_name:"Allow-HTTPS-Internet-Inbound",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.3",check_description:"Validates DMZ architecture with restricted database access",severity:"LOW",status:"PASS",expected_value:"Web tier in DMZ, databases in private subnet",actual_value:"NSG properly segments web and database tiers",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0011",rule_reference:"pa-rule-pci-violation",rule_name:"Direct-Internet-to-DB",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.3",check_description:"Validates DMZ architecture with restricted database access",severity:"CRITICAL",status:"FAIL",expected_value:"No direct internet access to cardholder data environment",actual_value:"Rule allows Untrust zone to Database zone on port 5432",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove direct internet to database rule. Route through application tier in DMZ.",ticket_reference:null},{validation_id:"VAL-0012",rule_reference:"sgr-0a1b2c3d4e5f0047",rule_name:"Kafka-Producer-Access",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"PORT_RANGE_VALIDATION",check_description:"Validates that port ranges are correctly specified",severity:"LOW",status:"PASS",expected_value:"Valid port number or range (1-65535)",actual_value:"9092",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012348"},{validation_id:"VAL-0013",rule_reference:"nsg-invalid-port",rule_name:"Invalid-Port-Range",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"PORT_RANGE_VALIDATION",check_description:"Validates that port ranges are correctly specified",severity:"HIGH",status:"FAIL",expected_value:"Valid port number or range (1-65535)",actual_value:"Port range: 0-70000 (invalid)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Correct port range to valid values (1-65535). Split into multiple rules if needed.",ticket_reference:null},{validation_id:"VAL-0014",rule_reference:"sgr-dup-rule-001",rule_name:"Duplicate-HTTPS-Rule-1",platform:"AWS",validation_category:"REDUNDANCY",validation_check:"DUPLICATE_RULE_DETECTION",check_description:"Identifies duplicate or overlapping rules",severity:"MEDIUM",status:"WARNING",expected_value:"Unique rule without duplicates",actual_value:"Duplicate of sgr-dup-rule-002 (same source, port, protocol)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove duplicate rule sgr-dup-rule-002 or consolidate into single rule",ticket_reference:null},{validation_id:"VAL-0015",rule_reference:"gcp-conflict-001",rule_name:"Allow-SSH-Specific",platform:"GCP",validation_category:"CONFLICT",validation_check:"CONFLICTING_RULE_DETECTION",check_description:"Identifies rules that conflict with each other",severity:"HIGH",status:"FAIL",expected_value:"No conflicting allow/deny rules for same traffic",actual_value:"Conflicts with deny-ssh-all (priority 100 vs 1000)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review priority ordering. Higher priority deny rule (100) will block this allow rule (1000).",ticket_reference:null},{validation_id:"VAL-0016",rule_reference:"pa-expired-rule-001",rule_name:"Temp-Vendor-Access-Expired",platform:"Palo Alto",validation_category:"EXPIRATION",validation_check:"RULE_EXPIRATION_CHECK",check_description:"Validates that temporary rules are removed after expiration",severity:"MEDIUM",status:"FAIL",expected_value:"Rule should be disabled or removed after 2025-12-31",actual_value:"Rule still active, expired 13 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Disable or remove expired rule. If still needed, create new change request for extension.",ticket_reference:"CHG0011234"},{validation_id:"VAL-0017",rule_reference:"sgr-0a1b2c3d4e5f0086",rule_name:"Jenkins-CI-CD-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"TICKET_REFERENCE_REQUIRED",check_description:"Validates that all rules have associated change tickets",severity:"LOW",status:"PASS",expected_value:"Valid change ticket reference",actual_value:"CHG0012359",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012359"},{validation_id:"VAL-0018",rule_reference:"nsg-no-ticket-001",rule_name:"Unknown-Rule-No-Ticket",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"TICKET_REFERENCE_REQUIRED",check_description:"Validates that all rules have associated change tickets",severity:"MEDIUM",status:"FAIL",expected_value:"Valid change ticket reference",actual_value:"(no ticket reference)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Create change ticket documenting rule purpose and approval. Tag rule with ticket number.",ticket_reference:null},{validation_id:"VAL-0019",rule_reference:"sgr-0a1b2c3d4e5f0096",rule_name:"Vault-Secrets-Access",platform:"AWS",validation_category:"SECURITY",validation_check:"SENSITIVE_SERVICE_PROTECTION",check_description:"Validates that sensitive services have restricted access",severity:"LOW",status:"PASS",expected_value:"Vault access restricted to specific application groups",actual_value:"Source: 10.30.0.0/16 (Application CIDR only)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012360"},{validation_id:"VAL-0020",rule_reference:"gcp-vault-any",rule_name:"Vault-Any-Access",platform:"GCP",validation_category:"SECURITY",validation_check:"SENSITIVE_SERVICE_PROTECTION",check_description:"Validates that sensitive services have restricted access",severity:"HIGH",status:"FAIL",expected_value:"Vault access restricted to specific application groups",actual_value:"Source: 0.0.0.0/0 (unrestricted)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict Vault access to application network tags only. Remove public access.",ticket_reference:null},{validation_id:"VAL-0021",rule_reference:"pa-rule-payment",rule_name:"Allow-Payment-Processing",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.2",check_description:"Validates firewall rules restrict inbound and outbound traffic to CDE",severity:"LOW",status:"PASS",expected_value:"Traffic limited to payment processing requirements only",actual_value:"Source: AG-Payment-Servers, Dest: AG-Payment-Providers, App: ssl",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012352"},{validation_id:"VAL-0022",rule_reference:"sgr-wide-port-range",rule_name:"Wide-Port-Range-Rule",platform:"AWS",validation_category:"SECURITY",validation_check:"EXCESSIVE_PORT_RANGE",check_description:"Validates that port ranges are not excessively wide",severity:"HIGH",status:"FAIL",expected_value:"Specific ports or narrow ranges",actual_value:"Port range: 1-65535 (all ports)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict to specific ports required. Split into multiple rules for different services.",ticket_reference:null},{validation_id:"VAL-0023",rule_reference:"nsg-webapp-prod-100",rule_name:"Allow-HTTPS-Internet-Inbound",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"SOC2_ACCESS_CONTROL",check_description:"Validates logical access controls per SOC2 CC6.1",severity:"LOW",status:"PASS",expected_value:"Access restricted based on business requirements",actual_value:"HTTPS only, appropriate for public web application",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0024",rule_reference:"gcp-allow-https-ingress",rule_name:"allow-https-ingress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"LOGGING_ENABLED",check_description:"Validates that firewall logging is enabled for audit",severity:"MEDIUM",status:"PASS",expected_value:"Logging enabled",actual_value:"logging: true",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0025",rule_reference:"gcp-internal-no-log",rule_name:"allow-internal-traffic",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"LOGGING_ENABLED",check_description:"Validates that firewall logging is enabled for audit",severity:"MEDIUM",status:"WARNING",expected_value:"Logging enabled",actual_value:"logging: false",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Enable logging for audit trail. Consider log sampling for high-volume rules.",ticket_reference:null},{validation_id:"VAL-0026",rule_reference:"pa-security-profile",rule_name:"Allow-HTTPS-Inbound-DMZ",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SECURITY_PROFILE_ATTACHED",check_description:"Validates that security profiles are attached to allow rules",severity:"LOW",status:"PASS",expected_value:"Security profile group attached",actual_value:"Profile: Web-Protection (AV, AS, VP, URL, FP)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0027",rule_reference:"pa-no-profile",rule_name:"Allow-Internal-No-Profile",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SECURITY_PROFILE_ATTACHED",check_description:"Validates that security profiles are attached to allow rules",severity:"HIGH",status:"FAIL",expected_value:"Security profile group attached",actual_value:"Profile: (none)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Attach appropriate security profile (Internal-Protection or similar)",ticket_reference:null},{validation_id:"VAL-0028",rule_reference:"sgr-0a1b2c3d4e5f0073",rule_name:"Grafana-Dashboard-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"NAMING_CONVENTION",check_description:"Validates rule naming follows organizational standards",severity:"INFO",status:"PASS",expected_value:"Format: [Action]-[Service]-[Direction]-[Source]",actual_value:"Allow-Grafana-VPN-Inbound",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012367"},{validation_id:"VAL-0029",rule_reference:"nsg-bad-name",rule_name:"rule1",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"NAMING_CONVENTION",check_description:"Validates rule naming follows organizational standards",severity:"LOW",status:"FAIL",expected_value:"Format: [Action]-[Service]-[Direction]-[Source]",actual_value:"rule1",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Rename to follow convention, e.g., 'Allow-HTTPS-Inbound-Internet'",ticket_reference:null},{validation_id:"VAL-0030",rule_reference:"sgr-0a1b2c3d4e5f0052",rule_name:"Kafka-Zookeeper-Internal",platform:"AWS",validation_category:"PERFORMANCE",validation_check:"RULE_HIT_COUNT",check_description:"Identifies rules with zero or very low hit counts",severity:"INFO",status:"PASS",expected_value:"Hit count > 0 in last 30 days",actual_value:"Hit count: 1,245,678",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012368"},{validation_id:"VAL-0031",rule_reference:"pa-zero-hits",rule_name:"Allow-Legacy-FTP",platform:"Palo Alto",validation_category:"PERFORMANCE",validation_check:"RULE_HIT_COUNT",check_description:"Identifies rules with zero or very low hit counts",severity:"LOW",status:"WARNING",expected_value:"Hit count > 0 in last 30 days",actual_value:"Hit count: 0 (last 90 days)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review if rule is still needed. Consider disabling for 30 days before removal.",ticket_reference:null},{validation_id:"VAL-0032",rule_reference:"sgr-icmp-unrestricted",rule_name:"Allow-ICMP-All",platform:"AWS",validation_category:"SECURITY",validation_check:"ICMP_RESTRICTION",check_description:"Validates ICMP is restricted appropriately",severity:"MEDIUM",status:"FAIL",expected_value:"ICMP restricted to specific types (echo-request/reply) or internal only",actual_value:"All ICMP types from 0.0.0.0/0",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict to ICMP types 0 and 8 (echo) from internal networks only",ticket_reference:null},{validation_id:"VAL-0033",rule_reference:"nsg-telnet-allow",rule_name:"Allow-Telnet-Internal",platform:"Azure",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"FAIL",expected_value:"No Telnet (port 23), use SSH instead",actual_value:"Port 23 allowed from internal networks",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Migrate to SSH (port 22). Remove Telnet rule after migration.",ticket_reference:null},{validation_id:"VAL-0034",rule_reference:"gcp-ftp-allow",rule_name:"allow-ftp-partner",platform:"GCP",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"FAIL",expected_value:"No unencrypted FTP (port 21), use SFTP instead",actual_value:"Port 21 allowed from partner IPs",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Migrate partners to SFTP (port 22) or FTPS (port 990). Update partner documentation.",ticket_reference:null},{validation_id:"VAL-0035",rule_reference:"pa-http-internal",rule_name:"Allow-HTTP-Internal",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"UNENCRYPTED_WEB_TRAFFIC",check_description:"Validates that HTTP is redirected to HTTPS",severity:"MEDIUM",status:"WARNING",expected_value:"HTTP redirected to HTTPS or blocked",actual_value:"HTTP (port 80) allowed internally",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Internal applications not yet migrated to HTTPS",remediation:"Plan migration of internal applications to HTTPS. Block HTTP after migration.",ticket_reference:"CHG0012500"},{validation_id:"VAL-0036",rule_reference:"sgr-0a1b2c3d4e5f0107",rule_name:"Payment-Webhook-Stripe",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.4",check_description:"Validates personal firewall on mobile/employee-owned devices",severity:"INFO",status:"PASS",expected_value:"N/A for server rules",actual_value:"Server-side rule, requirement not applicable",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012352"},{validation_id:"VAL-0037",rule_reference:"nsg-storage-endpoint",rule_name:"Allow-Storage-Endpoint",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"SERVICE_TAG_USAGE",check_description:"Validates use of service tags for Azure services",severity:"LOW",status:"PASS",expected_value:"Service tag used instead of IP ranges",actual_value:"Destination: Storage",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012384"},{validation_id:"VAL-0038",rule_reference:"nsg-hardcoded-ips",rule_name:"Allow-Azure-Services-IPs",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"SERVICE_TAG_USAGE",check_description:"Validates use of service tags for Azure services",severity:"MEDIUM",status:"FAIL",expected_value:"Service tag used instead of IP ranges",actual_value:"Hardcoded IPs: 20.38.147.0/24, 20.150.0.0/24",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace hardcoded IPs with appropriate Azure service tags (e.g., AzureCloud, Storage)",ticket_reference:null},{validation_id:"VAL-0039",rule_reference:"sgr-s3-prefix-list",rule_name:"Allow-S3-VPC-Endpoint",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"PREFIX_LIST_USAGE",check_description:"Validates use of prefix lists for AWS services",severity:"LOW",status:"PASS",expected_value:"Prefix list used for AWS service endpoints",actual_value:"Destination: pl-63a5400a (S3)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012384"},{validation_id:"VAL-0040",rule_reference:"gcp-network-tags",rule_name:"allow-web-to-app",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"NETWORK_TAG_USAGE",check_description:"Validates use of network tags instead of IP ranges",severity:"LOW",status:"PASS",expected_value:"Network tags used for source/target",actual_value:"Source: web-server, Target: app-server",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012371"},{validation_id:"VAL-0041",rule_reference:"pa-address-group",rule_name:"Allow-App-to-DB",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"ADDRESS_GROUP_USAGE",check_description:"Validates use of address groups instead of individual IPs",severity:"LOW",status:"PASS",expected_value:"Address groups used for source/destination",actual_value:"Source: AG-App-Servers, Dest: AG-DB-Servers",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012346"},{validation_id:"VAL-0042",rule_reference:"pa-individual-ips",rule_name:"Allow-Specific-Hosts",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"ADDRESS_GROUP_USAGE",check_description:"Validates use of address groups instead of individual IPs",severity:"LOW",status:"WARNING",expected_value:"Address groups used for source/destination",actual_value:"Source: 10.30.1.15, 10.30.1.16, 10.30.1.17, 10.30.1.18",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Create address group for these hosts and reference group in rule",ticket_reference:null},{validation_id:"VAL-0043",rule_reference:"sgr-0a1b2c3d4e5f0080",rule_name:"EKS-Node-Communication",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"SELF_REFERENCING_GROUP",check_description:"Validates self-referencing security group for cluster communication",severity:"INFO",status:"PASS",expected_value:"Self-reference for internal cluster traffic",actual_value:"Source: sg-eks-nodes (self-reference)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0044",rule_reference:"nsg-mgmt-ports",rule_name:"Allow-Management-Ports",platform:"Azure",validation_category:"SECURITY",validation_check:"MANAGEMENT_PORT_PROTECTION",check_description:"Validates management ports have additional restrictions",severity:"MEDIUM",status:"PASS",expected_value:"SSH/RDP restricted to bastion or VPN only",actual_value:"Source: AzureBastionSubnet, Ports: 22, 3389",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012372"},{validation_id:"VAL-0045",rule_reference:"gcp-iap-ssh",rule_name:"allow-ssh-iap",platform:"GCP",validation_category:"SECURITY",validation_check:"IAP_TUNNEL_USAGE",check_description:"Validates SSH access uses Identity-Aware Proxy",severity:"LOW",status:"PASS",expected_value:"SSH from IAP range 35.235.240.0/20",actual_value:"Source: 35.235.240.0/20 (IAP range)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012430"},{validation_id:"VAL-0046",rule_reference:"sgr-expired-temp",rule_name:"Temp-Debug-Access",platform:"AWS",validation_category:"EXPIRATION",validation_check:"TEMPORARY_RULE_AUDIT",check_description:"Validates temporary rules have expiration dates",severity:"MEDIUM",status:"FAIL",expected_value:"Expiration date set for temporary rules",actual_value:"No expiration date, created 180 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add expiration date or convert to permanent rule with proper documentation",ticket_reference:"CHG0011000"},{validation_id:"VAL-0047",rule_reference:"pa-app-default",rule_name:"Allow-Web-Apps",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"APPLICATION_IDENTIFICATION",check_description:"Validates application identification is used instead of port-based",severity:"LOW",status:"PASS",expected_value:"Application-ID used instead of service ports",actual_value:"Application: web-browsing, ssl; Service: application-default",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0048",rule_reference:"pa-port-based",rule_name:"Allow-Port-8080",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"APPLICATION_IDENTIFICATION",check_description:"Validates application identification is used instead of port-based",severity:"MEDIUM",status:"WARNING",expected_value:"Application-ID used instead of service ports",actual_value:"Application: any; Service: tcp/8080",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace 'any' application with specific App-ID (e.g., web-browsing, ssl)",ticket_reference:null},{validation_id:"VAL-0049",rule_reference:"sgr-0a1b2c3d4e5f0091",rule_name:"Splunk-Log-Ingestion",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"AUDIT_LOG_PROTECTION",check_description:"Validates audit/log systems have proper access controls",severity:"LOW",status:"PASS",expected_value:"Log ingestion restricted to internal sources",actual_value:"Source: 10.0.0.0/8 (internal only)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012373"},{validation_id:"VAL-0050",rule_reference:"nsg-subnet-overlap",rule_name:"Allow-Subnet-Overlap",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"CIDR_OVERLAP_DETECTION",check_description:"Validates no overlapping CIDR ranges in rules",severity:"MEDIUM",status:"WARNING",expected_value:"No overlapping source/destination CIDRs",actual_value:"10.0.0.0/8 overlaps with 10.30.0.0/16 in other rule",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Use more specific CIDR ranges to avoid overlap confusion",ticket_reference:null},{validation_id:"VAL-0051",rule_reference:"gcp-deny-all-ingress",rule_name:"deny-all-ingress",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"DEFAULT_DENY_EXISTS",check_description:"Validates default deny rule exists at lowest priority",severity:"LOW",status:"PASS",expected_value:"Default deny rule at priority 65535",actual_value:"Priority: 65535, Action: deny, Direction: INGRESS",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0052",rule_reference:"pa-default-deny",rule_name:"Default-Deny-All",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"DEFAULT_DENY_EXISTS",check_description:"Validates default deny rule exists at end of policy",severity:"LOW",status:"PASS",expected_value:"Default deny rule at bottom of rulebase",actual_value:"Rule at position 105, Action: Deny, any-any",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0053",rule_reference:"sgr-dns-udp-only",rule_name:"Allow-DNS-Outbound",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"DNS_TCP_UDP_REQUIRED",check_description:"Validates DNS rules allow both TCP and UDP",severity:"LOW",status:"WARNING",expected_value:"DNS on both TCP/53 and UDP/53",actual_value:"UDP/53 only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add TCP/53 rule for DNS over TCP (large responses, zone transfers)",ticket_reference:null},{validation_id:"VAL-0054",rule_reference:"nsg-sql-internet",rule_name:"Deny-SQL-Internet",platform:"Azure",validation_category:"SECURITY",validation_check:"DATABASE_INTERNET_BLOCK",check_description:"Validates database ports are blocked from internet",severity:"LOW",status:"PASS",expected_value:"Database ports blocked from internet",actual_value:"Deny rule for 1433, 3306, 5432 from Internet",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012363"},{validation_id:"VAL-0055",rule_reference:"gcp-smb-exposed",rule_name:"allow-smb-external",platform:"GCP",validation_category:"SECURITY",validation_check:"DANGEROUS_PORT_EXPOSURE",check_description:"Validates dangerous ports are not exposed to internet",severity:"CRITICAL",status:"FAIL",expected_value:"SMB (445) not exposed to internet",actual_value:"Port 445 exposed to 0.0.0.0/0",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Remove SMB exposure to internet. High risk of exploitation.",ticket_reference:null},{validation_id:"VAL-0056",rule_reference:"pa-zone-protection",rule_name:"Untrust-Zone-Protection",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"ZONE_PROTECTION_PROFILE",check_description:"Validates zone protection profiles are applied",severity:"LOW",status:"PASS",expected_value:"Zone protection profile on untrust zone",actual_value:"Profile: External-Zone-Protection applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0057",rule_reference:"sgr-0a1b2c3d4e5f0018",rule_name:"Database-Replication-DR",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"DR_CONNECTIVITY",check_description:"Validates DR site connectivity is properly configured",severity:"LOW",status:"PASS",expected_value:"Replication traffic to DR site allowed",actual_value:"PostgreSQL (5432) to DR CIDR 10.120.0.0/16",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012380"},{validation_id:"VAL-0058",rule_reference:"nsg-priority-gap",rule_name:"Rule-Priority-100",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"PRIORITY_SPACING",check_description:"Validates adequate priority spacing for future rules",severity:"INFO",status:"WARNING",expected_value:"Priority spacing of at least 10",actual_value:"Rules at 100, 101, 102 (gap of 1)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Consider renumbering priorities with larger gaps (100, 110, 120)",ticket_reference:null},{validation_id:"VAL-0059",rule_reference:"gcp-priority-order",rule_name:"allow-specific-after-deny",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"PRIORITY_ORDER_VALIDATION",check_description:"Validates rule priority order is logical",severity:"HIGH",status:"FAIL",expected_value:"Allow rules have higher priority (lower number) than deny",actual_value:"Allow at 2000, Deny at 1000 (deny processed first)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Adjust priority: Allow rule should be < 1000 to be processed before deny",ticket_reference:null},{validation_id:"VAL-0060",rule_reference:"pa-rule-shadowed",rule_name:"Allow-HTTP-Specific",platform:"Palo Alto",validation_category:"REDUNDANCY",validation_check:"SHADOWED_RULE_DETECTION",check_description:"Identifies rules shadowed by more general rules above",severity:"MEDIUM",status:"WARNING",expected_value:"Rule not shadowed by broader rule",actual_value:"Shadowed by 'Allow-Any-HTTP' at position 5",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Reorder rules or remove shadowed rule if redundant",ticket_reference:null},{validation_id:"VAL-0061",rule_reference:"sgr-nat-gateway",rule_name:"NAT-Gateway-Outbound",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"NAT_GATEWAY_RULES",check_description:"Validates NAT gateway security group configuration",severity:"LOW",status:"PASS",expected_value:"NAT gateway allows outbound to internet",actual_value:"Outbound: 0.0.0.0/0, Protocol: ALL",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012400"},{validation_id:"VAL-0062",rule_reference:"nsg-keyvault-private",rule_name:"Allow-KeyVault-Private-Endpoint",platform:"Azure",validation_category:"SECURITY",validation_check:"PRIVATE_ENDPOINT_USAGE",check_description:"Validates private endpoints for sensitive services",severity:"LOW",status:"PASS",expected_value:"Key Vault accessed via private endpoint",actual_value:"Destination: Private endpoint 10.50.1.5",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012390"},{validation_id:"VAL-0063",rule_reference:"gcp-vpc-peering",rule_name:"allow-peered-vpc-traffic",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"VPC_PEERING_RULES",check_description:"Validates firewall rules for VPC peering",severity:"LOW",status:"PASS",expected_value:"Peered VPC traffic properly allowed",actual_value:"Source: 10.200.0.0/16 (peered VPC)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012450"},{validation_id:"VAL-0064",rule_reference:"pa-edl-malicious",rule_name:"Block-Malicious-IPs-EDL",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"THREAT_FEED_INTEGRATION",check_description:"Validates threat intelligence feeds are integrated",severity:"LOW",status:"PASS",expected_value:"External dynamic list for threat IPs",actual_value:"Source: EDL-Malicious-IPs (updated hourly)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012350"},{validation_id:"VAL-0065",rule_reference:"sgr-container-registry",rule_name:"ECR-Pull-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"CONTAINER_REGISTRY_ACCESS",check_description:"Validates container registry access is properly configured",severity:"LOW",status:"PASS",expected_value:"ECR access via VPC endpoint",actual_value:"Destination: vpce-ecr, Port: 443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012374"},{validation_id:"VAL-0066",rule_reference:"nsg-aks-nodeport",rule_name:"Allow-AKS-NodePort-Range",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"KUBERNETES_NODEPORT_RANGE",check_description:"Validates Kubernetes NodePort range is properly configured",severity:"LOW",status:"PASS",expected_value:"NodePort range 30000-32767",actual_value:"Port range: 30000-32767",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0067",rule_reference:"gcp-gke-master-node",rule_name:"allow-gke-master-to-nodes",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"GKE_MASTER_ACCESS",check_description:"Validates GKE master to node communication",severity:"LOW",status:"PASS",expected_value:"Master can reach nodes on 443, 10250",actual_value:"Source: gke-master tag, Ports: 443, 10250",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0068",rule_reference:"pa-hipaa-encryption",rule_name:"Allow-Healthcare-Data",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"HIPAA_ENCRYPTION_REQUIREMENT",check_description:"Validates healthcare data is transmitted encrypted",severity:"LOW",status:"PASS",expected_value:"Only encrypted protocols for PHI",actual_value:"Application: ssl; Service: tcp/443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012455"},{validation_id:"VAL-0069",rule_reference:"sgr-unencrypted-phi",rule_name:"Allow-HTTP-Healthcare",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"HIPAA_ENCRYPTION_REQUIREMENT",check_description:"Validates healthcare data is transmitted encrypted",severity:"CRITICAL",status:"FAIL",expected_value:"Only encrypted protocols for PHI",actual_value:"HTTP (80) allowed for healthcare application",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Migrate to HTTPS. Unencrypted PHI transmission violates HIPAA.",ticket_reference:null},{validation_id:"VAL-0070",rule_reference:"nsg-monitoring-access",rule_name:"Allow-Monitoring-Agents",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"MONITORING_EGRESS",check_description:"Validates monitoring agent egress is allowed",severity:"LOW",status:"PASS",expected_value:"Monitoring agents can reach collectors",actual_value:"Destination: AzureMonitor, Port: 443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012387"},{validation_id:"VAL-0071",rule_reference:"gcp-healthcheck-ranges",rule_name:"allow-health-check",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"HEALTH_CHECK_RANGES",check_description:"Validates GCP health check ranges are allowed",severity:"LOW",status:"PASS",expected_value:"Source: 35.191.0.0/16, 130.211.0.0/22",actual_value:"Source: 35.191.0.0/16, 130.211.0.0/22",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012370"},{validation_id:"VAL-0072",rule_reference:"pa-decryption-policy",rule_name:"SSL-Decryption-Web",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SSL_DECRYPTION_ENABLED",check_description:"Validates SSL decryption is enabled for inspection",severity:"LOW",status:"PASS",expected_value:"SSL decryption enabled for outbound web",actual_value:"Decryption: Forward Proxy, Profile: SSL-Decrypt-Standard",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0073",rule_reference:"sgr-vpc-flow-logs",rule_name:"VPC-Flow-Logs-Config",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"FLOW_LOGS_ENABLED",check_description:"Validates VPC flow logs are enabled for audit",severity:"INFO",status:"PASS",expected_value:"Flow logs enabled on VPC",actual_value:"Flow logs: ENABLED, Destination: S3",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0074",rule_reference:"nsg-flow-logs-disabled",rule_name:"NSG-No-Flow-Logs",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"NSG_FLOW_LOGS_ENABLED",check_description:"Validates NSG flow logs are enabled for audit",severity:"MEDIUM",status:"FAIL",expected_value:"NSG flow logs enabled",actual_value:"Flow logs: DISABLED",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Enable NSG flow logs for compliance and troubleshooting",ticket_reference:null},{validation_id:"VAL-0075",rule_reference:"gcp-org-policy",rule_name:"Org-Policy-Compliance",platform:"GCP",validation_category:"COMPLIANCE",validation_check:"ORG_POLICY_COMPLIANCE",check_description:"Validates firewall rules comply with organization policies",severity:"LOW",status:"PASS",expected_value:"Rules comply with org constraints",actual_value:"All rules comply with compute.restrictVpcPeering",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0076",rule_reference:"pa-commit-validation",rule_name:"Pending-Commit-Rules",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"UNCOMMITTED_CHANGES",check_description:"Validates no uncommitted changes pending",severity:"INFO",status:"WARNING",expected_value:"No uncommitted changes",actual_value:"3 uncommitted rule changes",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Commit pending changes or revert if not needed",ticket_reference:null},{validation_id:"VAL-0077",rule_reference:"sgr-deprecated-ami",rule_name:"Allow-Deprecated-AMI-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DEPRECATED_RESOURCE_REFERENCE",check_description:"Validates rules don't reference deprecated resources",severity:"LOW",status:"WARNING",expected_value:"No deprecated resource references",actual_value:"References deprecated security group sg-legacy-app",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Update rule to reference current security group",ticket_reference:null},{validation_id:"VAL-0078",rule_reference:"nsg-gdpr-data",rule_name:"Allow-EU-Data-Processing",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"GDPR_DATA_RESIDENCY",check_description:"Validates EU data stays within approved regions",severity:"LOW",status:"PASS",expected_value:"EU data within EU regions only",actual_value:"Destination: EU West, EU North only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012456"},{validation_id:"VAL-0079",rule_reference:"gcp-cross-region",rule_name:"allow-cross-region-db",platform:"GCP",validation_category:"COMPLIANCE",validation_check:"GDPR_DATA_RESIDENCY",check_description:"Validates EU data stays within approved regions",severity:"HIGH",status:"EXCEPTION",expected_value:"EU data within EU regions only",actual_value:"Cross-region replication to US for DR",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Approved exception for DR - Standard Contractual Clauses in place",remediation:null,ticket_reference:"EXC-0012"},{validation_id:"VAL-0080",rule_reference:"pa-url-filtering",rule_name:"Block-Malicious-URLs",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"URL_FILTERING_ENABLED",check_description:"Validates URL filtering is enabled for web traffic",severity:"LOW",status:"PASS",expected_value:"URL filtering profile attached",actual_value:"Profile: URL-Block-Profile (malware, phishing blocked)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0081",rule_reference:"sgr-stale-rule",rule_name:"Allow-Old-Partner-Access",platform:"AWS",validation_category:"EXPIRATION",validation_check:"STALE_RULE_DETECTION",check_description:"Identifies rules not modified in over 1 year",severity:"LOW",status:"WARNING",expected_value:"Rule reviewed within last year",actual_value:"Last modified: 2024-06-15 (577 days ago)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review rule validity. Update or remove if no longer needed.",ticket_reference:null},{validation_id:"VAL-0082",rule_reference:"nsg-asg-membership",rule_name:"Allow-ASG-WebApp",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"ASG_MEMBERSHIP_VALIDATION",check_description:"Validates ASG has active members",severity:"MEDIUM",status:"WARNING",expected_value:"ASG has active NIC memberships",actual_value:"asg-legacy-app has 0 members",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add NICs to ASG or remove unused ASG references",ticket_reference:null},{validation_id:"VAL-0083",rule_reference:"gcp-firewall-insights",rule_name:"Firewall-Insights-Check",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"FIREWALL_INSIGHTS_ENABLED",check_description:"Validates Firewall Insights is enabled",severity:"INFO",status:"PASS",expected_value:"Firewall Insights enabled",actual_value:"Insights: ENABLED",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0084",rule_reference:"pa-rule-disable",rule_name:"Disabled-Rule-Check",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"DISABLED_RULE_AUDIT",check_description:"Identifies disabled rules that should be removed",severity:"INFO",status:"WARNING",expected_value:"Disabled rules removed after 30 days",actual_value:"5 rules disabled for > 90 days",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review and remove disabled rules no longer needed",ticket_reference:null},{validation_id:"VAL-0085",rule_reference:"sgr-ipv6-support",rule_name:"IPv6-Dual-Stack",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"IPV6_COVERAGE",check_description:"Validates IPv6 rules exist for dual-stack",severity:"INFO",status:"PASS",expected_value:"IPv6 rules mirror IPv4",actual_value:"IPv6 rules present for all public services",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012457"},{validation_id:"VAL-0086",rule_reference:"nsg-cross-subscription",rule_name:"Allow-Cross-Subscription",platform:"Azure",validation_category:"SECURITY",validation_check:"CROSS_SUBSCRIPTION_ACCESS",check_description:"Validates cross-subscription access is authorized",severity:"MEDIUM",status:"EXCEPTION",expected_value:"Cross-subscription access documented and approved",actual_value:"Traffic to subscription: sub-shared-services",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Approved for shared services architecture - documented in ADR-0023",remediation:null,ticket_reference:"EXC-0015"},{validation_id:"VAL-0087",rule_reference:"gcp-shared-vpc",rule_name:"allow-shared-vpc-access",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"SHARED_VPC_RULES",check_description:"Validates Shared VPC firewall rules",severity:"LOW",status:"PASS",expected_value:"Shared VPC rules in host project",actual_value:"Rules managed in host project vpc-host-prod",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012458"},{validation_id:"VAL-0088",rule_reference:"pa-ha-sync",rule_name:"HA-Sync-Validation",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"HA_RULE_SYNC",check_description:"Validates rules are synced across HA pair",severity:"LOW",status:"PASS",expected_value:"Rules identical on both HA members",actual_value:"Primary and Secondary in sync",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0089",rule_reference:"sgr-cidr-specific",rule_name:"Allow-Partner-CIDR",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"CIDR_SPECIFICITY",check_description:"Validates CIDRs are as specific as possible",severity:"LOW",status:"WARNING",expected_value:"Most specific CIDR for partner",actual_value:"198.51.100.0/24 could be 198.51.100.0/28",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Narrow CIDR to actual partner IP range",ticket_reference:null},{validation_id:"VAL-0090",rule_reference:"nsg-ddos-protection",rule_name:"DDoS-Protection-Check",platform:"Azure",validation_category:"SECURITY",validation_check:"DDOS_PROTECTION_ENABLED",check_description:"Validates DDoS protection is enabled",severity:"LOW",status:"PASS",expected_value:"DDoS Protection Standard enabled",actual_value:"DDoS Protection: ENABLED (Standard tier)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0091",rule_reference:"gcp-armor-policy",rule_name:"Cloud-Armor-Check",platform:"GCP",validation_category:"SECURITY",validation_check:"CLOUD_ARMOR_ENABLED",check_description:"Validates Cloud Armor is enabled for public endpoints",severity:"LOW",status:"PASS",expected_value:"Cloud Armor policy attached to LB",actual_value:"Policy: web-protection-policy attached",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0092",rule_reference:"pa-dos-protection",rule_name:"DoS-Protection-Profile",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"DOS_PROTECTION_ENABLED",check_description:"Validates DoS protection profiles are configured",severity:"LOW",status:"PASS",expected_value:"DoS protection on untrust zone",actual_value:"Profile: DoS-Protection-Aggregate applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0093",rule_reference:"sgr-lambda-access",rule_name:"Lambda-VPC-Access",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"SERVERLESS_VPC_ACCESS",check_description:"Validates Lambda VPC access is properly configured",severity:"LOW",status:"PASS",expected_value:"Lambda SG allows required egress",actual_value:"Egress to RDS, ElastiCache, S3 endpoint",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012459"},{validation_id:"VAL-0094",rule_reference:"nsg-function-app",rule_name:"Function-App-VNet-Integration",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"FUNCTION_VNET_INTEGRATION",check_description:"Validates Function App VNet integration rules",severity:"LOW",status:"PASS",expected_value:"Function App subnet allowed to backend",actual_value:"snet-functions-prod can access database and cache",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012460"},{validation_id:"VAL-0095",rule_reference:"gcp-cloud-run",rule_name:"allow-cloud-run-egress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"SERVERLESS_CONNECTOR",check_description:"Validates Serverless VPC Access connector rules",severity:"LOW",status:"PASS",expected_value:"VPC connector subnet has proper access",actual_value:"Connector subnet can reach Cloud SQL, Memorystore",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012461"},{validation_id:"VAL-0096",rule_reference:"pa-globalprotect",rule_name:"GlobalProtect-VPN-Access",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"VPN_ZONE_RULES",check_description:"Validates VPN zone rules are properly configured",severity:"LOW",status:"PASS",expected_value:"VPN zone has appropriate access",actual_value:"Zone VPN to Trust, Database restricted to DBA group",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012349"},{validation_id:"VAL-0097",rule_reference:"sgr-sso-integration",rule_name:"Allow-SSO-Provider",platform:"AWS",validation_category:"SECURITY",validation_check:"SSO_PROVIDER_ACCESS",check_description:"Validates SSO provider access is properly scoped",severity:"LOW",status:"PASS",expected_value:"SSO limited to HTTPS only",actual_value:"Okta access on 443 only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012395"},{validation_id:"VAL-0098",rule_reference:"nsg-pending-review",rule_name:"New-Partner-Access-Request",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting security review - submitted 3 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Complete security review before implementation",ticket_reference:"CHG0012470"},{validation_id:"VAL-0099",rule_reference:"gcp-pending-firewall",rule_name:"New-API-Access-Rule",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting compliance review - HIPAA assessment needed",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Complete HIPAA compliance assessment before approval",ticket_reference:"CHG0012471"},{validation_id:"VAL-0100",rule_reference:"pa-pending-rule",rule_name:"New-Vendor-Integration",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting vendor security questionnaire completion",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Obtain completed vendor security questionnaire before approval",ticket_reference:"CHG0012472"},{validation_id:"VAL-0101",rule_reference:"sgr-exception-approved",rule_name:"Legacy-Protocol-Exception",platform:"AWS",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"EXCEPTION",expected_value:"No unencrypted protocols",actual_value:"FTP (21) allowed for legacy integration",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Legacy system cannot support SFTP - migration planned Q2 2026. Compensating controls: IP whitelist, network segmentation, enhanced logging",remediation:"Migration to SFTP scheduled for CHG0013000",ticket_reference:"EXC-0020"},{validation_id:"VAL-0102",rule_reference:"nsg-wide-open-dev",rule_name:"Dev-Environment-Open",platform:"Azure",validation_category:"SECURITY",validation_check:"DEV_ENVIRONMENT_ISOLATION",check_description:"Validates development environments are properly isolated",severity:"HIGH",status:"FAIL",expected_value:"Dev environment isolated from production",actual_value:"Dev NSG allows traffic to production subnet",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove production access from dev environment. Create separate connectivity path if needed.",ticket_reference:null},{validation_id:"VAL-0103",rule_reference:"gcp-prod-dev-mix",rule_name:"allow-dev-to-prod-db",platform:"GCP",validation_category:"SECURITY",validation_check:"ENVIRONMENT_SEPARATION",check_description:"Validates production and non-production are separated",severity:"CRITICAL",status:"FAIL",expected_value:"No cross-environment database access",actual_value:"Development VPC can access production database",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Remove development to production database access. Use data masking for dev data needs.",ticket_reference:null},{validation_id:"VAL-0104",rule_reference:"pa-backup-traffic",rule_name:"Allow-Backup-Egress",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"BACKUP_ENCRYPTION",check_description:"Validates backup traffic is encrypted",severity:"LOW",status:"PASS",expected_value:"Backup traffic uses encrypted protocols",actual_value:"Application: ssl; Destination: Backup zone",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012415"},{validation_id:"VAL-0105",rule_reference:"sgr-waf-integration",rule_name:"WAF-to-Origin",platform:"AWS",validation_category:"SECURITY",validation_check:"WAF_INTEGRATION",check_description:"Validates WAF is in path for web traffic",severity:"LOW",status:"PASS",expected_value:"Web traffic routes through WAF",actual_value:"ALB has WAF ACL attached, origin only accepts ALB traffic",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0106",rule_reference:"nsg-missing-waf",rule_name:"Direct-Internet-to-Web",platform:"Azure",validation_category:"SECURITY",validation_check:"WAF_INTEGRATION",check_description:"Validates WAF is in path for web traffic",severity:"HIGH",status:"FAIL",expected_value:"Web traffic routes through WAF",actual_value:"Direct internet to VM without WAF",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Route traffic through Azure Application Gateway with WAF policy",ticket_reference:null},{validation_id:"VAL-0107",rule_reference:"gcp-cloud-nat",rule_name:"allow-cloud-nat-egress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"NAT_CONFIGURATION",check_description:"Validates Cloud NAT configuration for egress",severity:"LOW",status:"PASS",expected_value:"Cloud NAT configured for private instances",actual_value:"Cloud NAT enabled for needs-nat tagged instances",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012475"},{validation_id:"VAL-0108",rule_reference:"pa-qos-policy",rule_name:"QoS-Business-Critical",platform:"Palo Alto",validation_category:"PERFORMANCE",validation_check:"QOS_POLICY_ATTACHED",check_description:"Validates QoS policies for critical traffic",severity:"INFO",status:"PASS",expected_value:"QoS for business critical applications",actual_value:"QoS: Business-Critical class applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0109",rule_reference:"sgr-maintenance-window",rule_name:"Maintenance-Access-Rule",platform:"AWS",validation_category:"EXPIRATION",validation_check:"TIME_BASED_RULE",check_description:"Validates time-based rules have proper scheduling",severity:"LOW",status:"EXCEPTION",expected_value:"Time-based access with auto-disable",actual_value:"Rule active outside maintenance window",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Extended maintenance window approved - ticket EXT-0005",remediation:"Rule will auto-disable at end of extended window",ticket_reference:"EXT-0005"},{validation_id:"VAL-0110",rule_reference:"nsg-soc2-audit",rule_name:"SOC2-Audit-Access",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"SOC2_AUDIT_TRAIL",check_description:"Validates audit trail requirements for SOC2",severity:"LOW",status:"PASS",expected_value:"All access logged and auditable",actual_value:"NSG flow logs, Activity logs, Diagnostic settings enabled",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012480"}],Oo={validation_summary:tf,validations:nf},on=e=>new Promise(t=>setTimeout(t,e)),De={openSSH:/0\.0\.0\.0\/0.*(?:22|ssh)/i,openRDP:/0\.0\.0\.0\/0.*(?:3389|rdp)/i,openDatabase:/0\.0\.0\.0\/0.*(?:3306|5432|1433|27017)/i,anySource:/(?:source|src|cidr).*(?:0\.0\.0\.0\/0|any|\*)/i,insecureProtocol:/(?:telnet|ftp|http[^s])/i,widePortRange:/(?:0-65535|all|any)/i},rf=e=>{const t=[];return e.split(`
`).forEach((a,s)=>{const o=s+1,i=a.trim();i.startsWith("aws ec2")&&(!i.includes("--group-id")&&!i.includes("\\")&&t.push({id:`aws-${o}-1`,line:o,severity:"error",category:"syntax",message:"Missing --group-id parameter",suggestion:"Add --group-id sg-xxxxxxxx to specify the security group"}),i.includes("--cidr 0.0.0.0/0")&&i.includes("--port 22")&&t.push({id:`aws-${o}-2`,line:o,severity:"error",category:"security",message:"SSH port 22 is open to the internet (0.0.0.0/0)",suggestion:"Restrict SSH access to specific IP ranges",ruleId:"SEC-001"})),i.includes("--protocol")&&!i.match(/--protocol\s+(tcp|udp|icmp|-1)/i)&&t.push({id:`aws-${o}-3`,line:o,severity:"warning",category:"syntax",message:"Invalid protocol specified",suggestion:"Use tcp, udp, icmp, or -1 (all)"})}),t},af=e=>{const t=[];return e.split(`
`).forEach((a,s)=>{const o=s+1,i=a.trim();i.includes("az network nsg rule")&&(!i.includes("--priority")&&!i.includes("\\")&&t.push({id:`azure-${o}-1`,line:o,severity:"warning",category:"syntax",message:"Missing --priority parameter",suggestion:"Add --priority 100-4096 for rule ordering"}),!i.includes("--direction")&&!i.includes("\\")&&t.push({id:`azure-${o}-2`,line:o,severity:"error",category:"syntax",message:"Missing --direction parameter",suggestion:"Add --direction Inbound or Outbound"})),(i.includes('--source-address-prefixes "*"')||i.includes("--source-address-prefixes '*'"))&&t.push({id:`azure-${o}-3`,line:o,severity:"warning",category:"security",message:"Source address is open to all (*)",suggestion:"Restrict to specific IP ranges when possible"})}),t},sf=e=>{const t=[];return e.split(`
`).forEach((a,s)=>{const o=s+1,i=a.trim();i.includes("gcloud compute firewall-rules")&&(!i.includes("--network")&&!i.includes("\\")&&t.push({id:`gcp-${o}-1`,line:o,severity:"error",category:"syntax",message:"Missing --network parameter",suggestion:"Specify the VPC network with --network=<network-name>"}),!i.includes("--direction")&&!i.includes("\\")&&t.push({id:`gcp-${o}-2`,line:o,severity:"warning",category:"syntax",message:"Missing --direction parameter",suggestion:"Add --direction=INGRESS or EGRESS"})),i.includes("--source-ranges=0.0.0.0/0")&&t.push({id:`gcp-${o}-3`,line:o,severity:"warning",category:"security",message:"Source ranges open to all (0.0.0.0/0)",suggestion:"Restrict to specific IP ranges"})}),t},of=e=>{const t=[];return e.split(`
`).forEach((a,s)=>{const o=s+1,i=a.trim();(i.startsWith("iptables")||i.startsWith("-A"))&&(!i.includes("-j")&&i.length>10&&t.push({id:`ipt-${o}-1`,line:o,severity:"error",category:"syntax",message:"Missing jump target (-j)",suggestion:"Add -j ACCEPT, DROP, or REJECT"}),!i.includes("-A")&&!i.includes("-I")&&!i.includes("-D")&&t.push({id:`ipt-${o}-2`,line:o,severity:"warning",category:"syntax",message:"Missing chain operation",suggestion:"Use -A (append), -I (insert), or -D (delete)"})),i.includes("--dport 22")&&!i.includes("-s ")&&t.push({id:`ipt-${o}-3`,line:o,severity:"error",category:"security",message:"SSH rule without source restriction",suggestion:"Add -s <source-ip> to restrict SSH access"})}),t},lf=e=>{const t=[];return e.split(`
`).forEach((a,s)=>{const o=s+1,i=a.trim();i.startsWith("access-list")&&(!i.includes("extended")&&!i.includes("standard")&&t.push({id:`asa-${o}-1`,line:o,severity:"warning",category:"syntax",message:"Access list type not specified",suggestion:'Use "extended" for IP-based ACLs'}),i.match(/permit|deny/)||t.push({id:`asa-${o}-2`,line:o,severity:"error",category:"syntax",message:"Missing action (permit/deny)",suggestion:"Specify permit or deny action"})),i.includes("permit")&&i.includes("any any")&&t.push({id:`asa-${o}-3`,line:o,severity:"error",category:"security",message:"Rule permits any to any traffic",suggestion:"Restrict source and destination addresses"})}),t},ec=e=>{const t=[];return t.push({id:"sec-ssh-001",name:"SSH Access Restriction",description:"SSH should not be open to 0.0.0.0/0",category:"exposure",status:De.openSSH.test(e)?"fail":"pass",severity:"error",details:De.openSSH.test(e)?"SSH (port 22) is exposed to the internet":void 0}),t.push({id:"sec-rdp-001",name:"RDP Access Restriction",description:"RDP should not be open to 0.0.0.0/0",category:"exposure",status:De.openRDP.test(e)?"fail":"pass",severity:"error",details:De.openRDP.test(e)?"RDP (port 3389) is exposed to the internet":void 0}),t.push({id:"sec-db-001",name:"Database Port Restriction",description:"Database ports should not be publicly accessible",category:"exposure",status:De.openDatabase.test(e)?"fail":"pass",severity:"error",details:De.openDatabase.test(e)?"Database ports exposed to the internet":void 0}),t.push({id:"sec-src-001",name:"Source Address Scope",description:"Avoid using any/0.0.0.0/0 as source when possible",category:"access",status:De.anySource.test(e)?"warning":"pass",severity:"warning",details:De.anySource.test(e)?"Rules with overly permissive source addresses found":void 0}),t.push({id:"sec-proto-001",name:"Secure Protocol Usage",description:"Avoid using insecure protocols like Telnet, FTP",category:"compliance",status:De.insecureProtocol.test(e)?"warning":"pass",severity:"warning",details:De.insecureProtocol.test(e)?"Insecure protocols detected":void 0}),t.push({id:"sec-port-001",name:"Port Range Restriction",description:"Avoid opening all ports (0-65535)",category:"access",status:De.widePortRange.test(e)?"warning":"pass",severity:"warning",details:De.widePortRange.test(e)?"Wide port ranges detected":void 0}),t},cf=(e,t)=>{const n=e.filter(m=>m.category==="syntax"),a=n.filter(m=>m.severity==="error").length,s=n.filter(m=>m.severity==="warning").length,o=Math.max(0,100-a*20-s*5),i=t.filter(m=>m.status==="fail").length,l=t.filter(m=>m.status==="warning").length,c=Math.max(0,100-i*25-l*10),d=e.filter(m=>m.category==="compliance").length,u=Math.max(0,100-d*15);return{syntaxScore:o,securityScore:c,complianceScore:u}},Tu=()=>{const e=new Map;Oo.validations.forEach(a=>{const s=a.platform.toLowerCase();e.has(s)||e.set(s,[]),e.get(s).push(a)});const t=[];let n=0;return e.forEach((a,s)=>{const o=a.filter(l=>l.status==="FAIL").length,i=a.filter(l=>l.status==="WARNING").length;t.push({id:`vh-real-${n++}`,timestamp:a[0].validation_timestamp,platform:s,ruleCount:a.length,issueCount:o+i,isValid:o===0,snippet:`${a.length} rules validated for ${s.toUpperCase()}`})}),t};let Gs=Tu();const ln={async validateRules(e,t){if(await on(800),!t.trim())return{isValid:!1,platform:e,issues:[{id:"empty-1",line:1,severity:"error",category:"syntax",message:"No rule content provided",suggestion:"Enter firewall rules to validate"}],syntaxScore:0,securityScore:0,complianceScore:0};let n=[];switch(e){case"aws":n=rf(t);break;case"azure":n=af(t);break;case"gcp":n=sf(t);break;case"iptables":n=of(t);break;case"cisco_asa":n=lf(t);break;default:t.length<10&&n.push({id:"gen-1",line:1,severity:"warning",category:"syntax",message:"Rule content appears incomplete"})}const a=ec(t);a.filter(c=>c.status==="fail"||c.status==="warning").forEach((c,d)=>{n.push({id:`sec-${d}`,line:0,severity:c.severity,category:"security",message:c.details||c.description,ruleId:c.id})});const{syntaxScore:s,securityScore:o,complianceScore:i}=cf(n,a),l=n.some(c=>c.severity==="error");return Gs.unshift({id:`vh-${Date.now()}`,timestamp:new Date().toISOString(),platform:e,ruleCount:t.split(`
`).filter(c=>c.trim()&&!c.trim().startsWith("#")&&!c.trim().startsWith("!")).length,issueCount:n.length,isValid:!l,snippet:t.substring(0,50)+"..."}),{isValid:!l,platform:e,issues:n,syntaxScore:s,securityScore:o,complianceScore:i}},async runSecurityAnalysis(e){return await on(500),ec(e)},async getValidationHistory(){return await on(300),Gs.slice(0,10)},async clearHistory(){await on(200),Gs=Tu()},async getPreValidatedRules(){return await on(300),Oo.validations},async getValidationSummary(){return await on(200),Oo.validation_summary}},df=[{analysis_id:"PATH-0001",analysis_timestamp:"2026-01-13T10:30:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-002 allows TCP/5432 to sg-database-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic to 10.0.0.0/8",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC routing",latency_ms:.2},{hop_number:4,component:"acl-prod-database",component_id:"acl-0a1b2c3d4e5f00003",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/5432 from 10.30.0.0/16",latency_ms:.1},{hop_number:5,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-101 allows TCP/5432 from sg-webapp-prod",latency_ms:.1},{hop_number:6,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Destination reached - PostgreSQL listening on port 5432",latency_ms:.2}]},{analysis_id:"PATH-0002",analysis_timestamp:"2026-01-13T10:31:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Internet",source_ip:"0.0.0.0/0",source_type:"External",source_vpc:null,destination:"webapp-prod-1",destination_ip:"10.30.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:8,path_latency_ms:15.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"cloudflare-edge",component_id:"cf-edge-iad-01",type:"CDN",direction:"Inbound",decision:"FORWARD",details:"Cloudflare edge node - WAF rules passed",latency_ms:5},{hop_number:2,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC via Internet Gateway",latency_ms:2},{hop_number:3,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/443 from 0.0.0.0/0",latency_ms:.1},{hop_number:4,component:"sg-alb-public",component_id:"sg-0a1b2c3d4e5f00005",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows HTTPS from Cloudflare IPs",latency_ms:.1},{hop_number:5,component:"prod-alb",component_id:"arn:aws:elasticloadbalancing:...",type:"Load Balancer",direction:"Forward",decision:"FORWARD",details:"ALB routes to target group tg-webapp-prod",latency_ms:3},{hop_number:6,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:7,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows TCP/8080 from sg-alb-public",latency_ms:.1},{hop_number:8,component:"webapp-prod-1",component_id:"i-0abc123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Destination reached - Application listening on port 8080",latency_ms:5.1}]},{analysis_id:"PATH-0003",analysis_timestamp:"2026-01-13T10:32:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"198.51.100.50",source_type:"External",source_vpc:null,destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"acl-prod-database",blocking_reason:"No route from internet to private database subnet"},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:null},{hop_number:2,component:"rtb-public",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"No direct route to 10.40.0.0/16 from public subnet",latency_ms:null},{hop_number:3,component:"acl-prod-database",component_id:"acl-0a1b2c3d4e5f00003",type:"Network ACL",direction:"Inbound",decision:"BLOCKED",details:"Rule 200 denies all traffic from 0.0.0.0/0 - Database isolated from internet",latency_ms:null}]},{analysis_id:"PATH-0004",analysis_timestamp:"2026-01-13T10:33:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"api-prod-1",source_ip:"10.31.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"api.stripe.com",destination_ip:"52.4.128.0",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:25.3,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-api-gateway",component_id:"sg-0a1b2c3d4e5f00006",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 110 allows TCP/443 outbound",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via nat-0a1b2c3d4e5f00001",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP 54.123.45.67",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"api.stripe.com",component_id:"52.4.128.0",type:"Destination",direction:"N/A",decision:"REACHED",details:"External destination reached via internet",latency_ms:21.8}]},{analysis_id:"PATH-0005",analysis_timestamp:"2026-01-13T10:34:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"dr-postgres-primary",destination_ip:"10.120.1.10",destination_type:"EC2",destination_vpc:"vpc-dr-east-1",protocol:"TCP",port:5432},summary:{total_hops:9,path_latency_ms:12.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows TCP/5432 to 10.120.0.0/16",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.120.0.0/16 via tgw-0a1b2c3d4e5f00001",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-prod",component_id:"tgw-attach-vpc-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic enters Transit Gateway from Production VPC",latency_ms:1},{hop_number:5,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.120.0.0/16 to tgw-attach-vpc-dr",latency_ms:.5},{hop_number:6,component:"tgw-attach-vpc-dr",component_id:"tgw-attach-vpc-dr",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to DR VPC",latency_ms:1},{hop_number:7,component:"acl-dr-database",component_id:"acl-dr-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/5432 from 10.0.0.0/8",latency_ms:.1},{hop_number:8,component:"sg-dr-database",component_id:"sg-dr-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows replication from production",latency_ms:.1},{hop_number:9,component:"dr-postgres-primary",component_id:"i-dr-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"DR database reached for replication",latency_ms:9.4}]},{analysis_id:"PATH-0006",analysis_timestamp:"2026-01-13T10:35:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vpn-user-laptop",source_ip:"10.100.50.25",source_type:"VPN Client",source_vpc:null,destination:"grafana-1",destination_ip:"10.50.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:3e3},summary:{total_hops:8,path_latency_ms:35.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"vpn-endpoint",component_id:"vpn-0abc123def456789",type:"VPN Gateway",direction:"Inbound",decision:"ALLOW",details:"VPN authenticated user - MFA verified",latency_ms:15},{hop_number:2,component:"tgw-attach-vpn-dc",component_id:"tgw-attach-vpn-dc",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"VPN traffic enters via Transit Gateway",latency_ms:2},{hop_number:3,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.50.0.0/24 to tgw-attach-vpc-prod",latency_ms:.5},{hop_number:4,component:"tgw-attach-vpc-prod",component_id:"tgw-attach-vpc-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to Production VPC",latency_ms:1},{hop_number:5,component:"rtb-tgw-subnet",component_id:"rtb-0a1b2c3d4e5f00005",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.50.0.0/24 via local",latency_ms:.2},{hop_number:6,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/3000 from 10.100.0.0/16",latency_ms:.1},{hop_number:7,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows Grafana from VPN",latency_ms:.1},{hop_number:8,component:"grafana-1",component_id:"i-0mon123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Grafana dashboard accessible",latency_ms:16.3}]},{analysis_id:"PATH-0007",analysis_timestamp:"2026-01-13T10:36:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"dev-server-1",source_ip:"10.100.5.10",source_type:"EC2",source_vpc:"vpc-dev-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"tgw-rtb-dev",blocking_reason:"Blackhole route prevents dev-to-prod database access"},hops:[{hop_number:1,component:"sg-dev-server",component_id:"sg-dev-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows all traffic",latency_ms:null},{hop_number:2,component:"rtb-dev-private",component_id:"rtb-dev-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via Transit Gateway",latency_ms:null},{hop_number:3,component:"tgw-attach-vpc-dev",component_id:"tgw-attach-vpc-dev",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic enters Transit Gateway",latency_ms:null},{hop_number:4,component:"tgw-rtb-dev",component_id:"tgw-rtb-dev",type:"Transit Gateway Route Table",direction:"Forward",decision:"BLOCKED",details:"Blackhole route for 10.0.0.0/8 - Dev isolated from production",latency_ms:null},{hop_number:5,component:"N/A",component_id:null,type:"Blackhole",direction:"N/A",decision:"DROPPED",details:"Traffic dropped by blackhole route - Environment isolation enforced",latency_ms:null}]},{analysis_id:"PATH-0008",analysis_timestamp:"2026-01-13T10:37:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"eks-node-1",source_ip:"10.60.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"ECR",destination_ip:"vpce-ecr",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.1,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-eks-nodes",component_id:"sg-0a1b2c3d4e5f00009",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to VPC endpoints",latency_ms:.1},{hop_number:2,component:"acl-eks-nodes",component_id:"acl-0a1b2c3d4e5f00007",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-eks-private",component_id:"rtb-0a1b2c3d4e5f00003",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to ECR endpoint via pl-ecr prefix list",latency_ms:.2},{hop_number:4,component:"vpce-ecr-api",component_id:"vpce-0a1b2c3d4e5f00001",type:"VPC Endpoint",direction:"Forward",decision:"FORWARD",details:"PrivateLink endpoint for ECR API",latency_ms:1.5},{hop_number:5,component:"ECR",component_id:"ecr.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"ECR service reached via PrivateLink",latency_ms:.2}]},{analysis_id:"PATH-0009",analysis_timestamp:"2026-01-13T10:38:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"redis-prod-cluster",destination_ip:"10.35.1.10",destination_type:"ElastiCache",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:6379},summary:{total_hops:5,path_latency_ms:.6,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-003 allows TCP/6379 to sg-redis-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.35.0.0/24 via local",latency_ms:.1},{hop_number:4,component:"sg-redis-prod",component_id:"sg-0a1b2c3d4e5f00003",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-201 allows TCP/6379 from sg-webapp-prod",latency_ms:.1},{hop_number:5,component:"redis-prod-cluster",component_id:"elasticache-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Redis cluster endpoint reached",latency_ms:.2}]},{analysis_id:"PATH-0010",analysis_timestamp:"2026-01-13T10:39:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"on-prem-dc-server",source_ip:"172.16.10.50",source_type:"On-Premises",source_vpc:null,destination:"shared-services-dns",destination_ip:"10.200.1.10",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"UDP",port:53},summary:{total_hops:7,path_latency_ms:18.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"dc-router",component_id:"router-dc-01",type:"On-Premises Router",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via VPN tunnel",latency_ms:1},{hop_number:2,component:"vpn-tunnel-1",component_id:"vpn-tun-0abc123",type:"VPN Tunnel",direction:"Forward",decision:"FORWARD",details:"IPSec tunnel to AWS - encrypted",latency_ms:8},{hop_number:3,component:"vgw-prod",component_id:"vgw-0a1b2c3d4e5f00001",type:"Virtual Private Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters AWS via VPN Gateway",latency_ms:1},{hop_number:4,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 to tgw-attach-vpc-shared",latency_ms:.5},{hop_number:5,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to Shared Services VPC",latency_ms:1},{hop_number:6,component:"sg-shared-dns",component_id:"sg-shared-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound allows UDP/53 from 172.16.0.0/12",latency_ms:.1},{hop_number:7,component:"shared-services-dns",component_id:"i-shared-dns-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"DNS server reached",latency_ms:6.9}]},{analysis_id:"PATH-0011",analysis_timestamp:"2026-01-13T10:40:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vm-webapp-prod-1",source_ip:"10.30.1.20",source_type:"Azure VM",source_vpc:"vnet-prod-eastus",destination:"postgres-flex-server",destination_ip:"10.40.1.20",destination_type:"Azure PostgreSQL",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:5432},summary:{total_hops:6,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"nsg-webapp-prod",component_id:"/subscriptions/.../nsg-webapp-prod",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Rule Allow-SQL-to-Database (priority 110) allows TCP/5432",latency_ms:.1},{hop_number:2,component:"udr-webapp-subnet",component_id:"/subscriptions/.../udr-webapp",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/24 via VNet local routing",latency_ms:.2},{hop_number:3,component:"snet-webapp-prod",component_id:"/subscriptions/.../snet-webapp-prod",type:"Subnet",direction:"Forward",decision:"ROUTE",details:"Subnet routing to database subnet",latency_ms:.1},{hop_number:4,component:"snet-database-prod",component_id:"/subscriptions/.../snet-database-prod",type:"Subnet",direction:"Inbound",decision:"ROUTE",details:"Traffic enters database subnet",latency_ms:.1},{hop_number:5,component:"nsg-database-prod",component_id:"/subscriptions/.../nsg-database-prod",type:"Network Security Group",direction:"Inbound",decision:"ALLOW",details:"Rule Allow-WebApp-to-SQL (priority 100) with ASG reference",latency_ms:.1},{hop_number:6,component:"postgres-flex-server",component_id:"/subscriptions/.../postgres-flex",type:"Destination",direction:"N/A",decision:"REACHED",details:"Azure PostgreSQL Flexible Server reached via private endpoint",latency_ms:.6}]},{analysis_id:"PATH-0012",analysis_timestamp:"2026-01-13T10:41:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vm-webapp-prod-1",source_ip:"10.30.1.20",source_type:"Azure VM",source_vpc:"vnet-prod-eastus",destination:"storage-account-prod",destination_ip:"Storage Service Tag",destination_type:"Azure Storage",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"nsg-webapp-prod",component_id:"/subscriptions/.../nsg-webapp-prod",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Rule Allow-Storage-Outbound (priority 130) allows to Storage service tag",latency_ms:.1},{hop_number:2,component:"udr-webapp-subnet",component_id:"/subscriptions/.../udr-webapp",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to Microsoft.Storage service endpoint",latency_ms:.2},{hop_number:3,component:"snet-webapp-prod-service-endpoint",component_id:"Microsoft.Storage",type:"Service Endpoint",direction:"Forward",decision:"FORWARD",details:"Service endpoint for Azure Storage - traffic stays on Azure backbone",latency_ms:.5},{hop_number:4,component:"storage-firewall",component_id:"storage-acl-prod",type:"Storage Firewall",direction:"Inbound",decision:"ALLOW",details:"Storage firewall allows access from snet-webapp-prod",latency_ms:.2},{hop_number:5,component:"storage-account-prod",component_id:"/subscriptions/.../storageAccounts/prodsa001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Azure Storage account reached via service endpoint",latency_ms:1.5}]},{analysis_id:"PATH-0013",analysis_timestamp:"2026-01-13T10:42:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"aks-pod-webapp",source_ip:"10.60.5.25",source_type:"AKS Pod",source_vpc:"vnet-prod-eastus",destination:"key-vault-prod",destination_ip:"10.50.1.5",destination_type:"Azure Key Vault",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:443},summary:{total_hops:6,path_latency_ms:3.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"aks-network-policy",component_id:"netpol-webapp-egress",type:"Network Policy",direction:"Outbound",decision:"ALLOW",details:"Kubernetes NetworkPolicy allows egress to Key Vault CIDR",latency_ms:.1},{hop_number:2,component:"nsg-aks-nodes",component_id:"/subscriptions/.../nsg-aks-nodes",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound to AzureKeyVault service tag allowed",latency_ms:.1},{hop_number:3,component:"udr-aks-subnet",component_id:"/subscriptions/.../udr-aks",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to Key Vault private endpoint",latency_ms:.2},{hop_number:4,component:"pep-keyvault-prod",component_id:"/subscriptions/.../privateEndpoints/pep-kv",type:"Private Endpoint",direction:"Forward",decision:"FORWARD",details:"Traffic routed via Private Endpoint",latency_ms:1},{hop_number:5,component:"kv-firewall",component_id:"key-vault-firewall",type:"Key Vault Firewall",direction:"Inbound",decision:"ALLOW",details:"Key Vault allows access from private endpoint",latency_ms:.3},{hop_number:6,component:"key-vault-prod",component_id:"/subscriptions/.../vaults/kv-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Key Vault reached via private endpoint",latency_ms:1.5}]},{analysis_id:"PATH-0014",analysis_timestamp:"2026-01-13T10:43:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"vm-dev-server",source_ip:"10.100.5.20",source_type:"Azure VM",source_vpc:"vnet-dev-eastus",destination:"vm-webapp-prod-1",destination_ip:"10.30.1.20",destination_type:"Azure VM",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:22},summary:{total_hops:4,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"azfw-prod-hub",blocking_reason:"Azure Firewall blocks dev-to-prod SSH access"},hops:[{hop_number:1,component:"nsg-dev-server",component_id:"/subscriptions/.../nsg-dev",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Default outbound allow",latency_ms:null},{hop_number:2,component:"udr-dev-subnet",component_id:"/subscriptions/.../udr-dev",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via Azure Firewall",latency_ms:null},{hop_number:3,component:"azfw-prod-hub",component_id:"/subscriptions/.../azfw-prod-hub",type:"Azure Firewall",direction:"Forward",decision:"BLOCKED",details:"Network rule collection rc-deny-dev-prod blocks dev-to-prod access",latency_ms:null},{hop_number:4,component:"N/A",component_id:null,type:"Firewall Block",direction:"N/A",decision:"DROPPED",details:"Traffic dropped by Azure Firewall - Environment isolation",latency_ms:null}]},{analysis_id:"PATH-0015",analysis_timestamp:"2026-01-13T10:44:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gce-webapp-1",source_ip:"10.30.1.30",source_type:"GCE Instance",source_vpc:"vpc-production",destination:"cloudsql-postgres",destination_ip:"10.40.1.30",destination_type:"Cloud SQL",destination_vpc:"vpc-production",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-db-from-app-postgres",component_id:"projects/.../firewalls/allow-db-from-app-postgres",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress allowed - no explicit deny rule",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/default-route",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to Cloud SQL private IP via VPC peering",latency_ms:.2},{hop_number:3,component:"servicenetworking-peering",component_id:"servicenetworking-googleapis-com",type:"VPC Peering",direction:"Forward",decision:"FORWARD",details:"Traffic enters Google-managed VPC for Cloud SQL",latency_ms:.5},{hop_number:4,component:"allow-db-from-app-postgres",component_id:"projects/.../firewalls/allow-db-from-app-postgres",type:"GCP Firewall Rule",direction:"Ingress",decision:"ALLOW",details:"Source tag app-server matches, TCP/5432 allowed",latency_ms:.1},{hop_number:5,component:"cloudsql-postgres",component_id:"projects/.../instances/cloudsql-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Cloud SQL instance reached via private IP",latency_ms:.6}]},{analysis_id:"PATH-0016",analysis_timestamp:"2026-01-13T10:45:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gke-node-1",source_ip:"10.60.1.30",source_type:"GKE Node",source_vpc:"vpc-production",destination:"gcr.io",destination_ip:"199.36.153.4",destination_type:"Google Container Registry",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:5.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-gke-egress",component_id:"projects/.../firewalls/allow-gke-egress",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress to Google APIs allowed",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/default-internet-gateway",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to private.googleapis.com via Private Google Access",latency_ms:.2},{hop_number:3,component:"private-google-access",component_id:"private.googleapis.com",type:"Private Google Access",direction:"Forward",decision:"FORWARD",details:"Traffic routed to Google APIs without public IP",latency_ms:2},{hop_number:4,component:"cloud-nat",component_id:"projects/.../routers/cloud-nat-prod",type:"Cloud NAT",direction:"Forward",decision:"NAT",details:"Cloud NAT not needed - using Private Google Access",latency_ms:0},{hop_number:5,component:"gcr.io",component_id:"gcr.io",type:"Destination",direction:"N/A",decision:"REACHED",details:"Google Container Registry reached via Private Google Access",latency_ms:2.9}]},{analysis_id:"PATH-0017",analysis_timestamp:"2026-01-13T10:46:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gce-webapp-1",source_ip:"10.30.1.30",source_type:"GCE Instance",source_vpc:"vpc-production",destination:"memorystore-redis",destination_ip:"10.35.1.30",destination_type:"Memorystore",destination_vpc:"vpc-production",protocol:"TCP",port:6379},summary:{total_hops:4,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-redis-from-app",component_id:"projects/.../firewalls/allow-redis-from-app",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress allowed - implicit allow",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/peering-memorystore",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to Memorystore via VPC peering",latency_ms:.2},{hop_number:3,component:"allow-redis-from-app",component_id:"projects/.../firewalls/allow-redis-from-app",type:"GCP Firewall Rule",direction:"Ingress",decision:"ALLOW",details:"Source tags app-server,web-server match, TCP/6379 allowed",latency_ms:.1},{hop_number:4,component:"memorystore-redis",component_id:"projects/.../instances/redis-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Memorystore Redis instance reached",latency_ms:.4}]},{analysis_id:"PATH-0018",analysis_timestamp:"2026-01-13T10:47:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"198.51.100.100",source_type:"External",source_vpc:null,destination:"gce-webapp-1",destination_ip:"10.30.1.30",destination_type:"GCE Instance",destination_vpc:"vpc-production",protocol:"TCP",port:22},summary:{total_hops:2,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"deny-ssh-public",blocking_reason:"SSH from internet blocked - use IAP instead"},hops:[{hop_number:1,component:"cloud-armor",component_id:"projects/.../securityPolicies/web-protection",type:"Cloud Armor",direction:"Inbound",decision:"ALLOW",details:"Cloud Armor not blocking this IP",latency_ms:null},{hop_number:2,component:"deny-ssh-public",component_id:"projects/.../firewalls/deny-ssh-public",type:"GCP Firewall Rule",direction:"Ingress",decision:"BLOCKED",details:"Priority 2000 deny rule blocks TCP/22 from 0.0.0.0/0",latency_ms:null}]},{analysis_id:"PATH-0019",analysis_timestamp:"2026-01-13T10:48:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Untrust-Zone",source_ip:"203.0.113.50",source_type:"External",source_vpc:null,destination:"webapp-prod-1-pa",destination_ip:"10.30.1.40",destination_type:"Server",destination_vpc:"DMZ",protocol:"TCP",port:443},summary:{total_hops:6,path_latency_ms:8.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"pa-external-interface",component_id:"ethernet1/1",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters Untrust zone",latency_ms:.5},{hop_number:2,component:"Block-Malicious-IPs-Inbound",component_id:"rule-50",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Source IP not in EDL-Malicious-IPs",latency_ms:.2},{hop_number:3,component:"Allow-API-Gateway-Inbound",component_id:"rule-1",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: Untrust->DMZ, ssl app, AG-Web-Servers dest",latency_ms:.3},{hop_number:4,component:"Web-Protection-Profile",component_id:"profile-group-web",type:"Security Profile",direction:"Forward",decision:"ALLOW",details:"AV: Clean, AS: Clean, VP: No vulnerabilities, URL: Allowed",latency_ms:2},{hop_number:5,component:"pa-dmz-interface",component_id:"ethernet1/3",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to DMZ zone",latency_ms:.5},{hop_number:6,component:"webapp-prod-1-pa",component_id:"10.30.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"Web server in DMZ reached",latency_ms:5}]},{analysis_id:"PATH-0020",analysis_timestamp:"2026-01-13T10:49:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"app-server-1-pa",source_ip:"10.31.1.40",source_type:"Server",source_vpc:"Application",destination:"db-server-1-pa",destination_ip:"10.40.1.40",destination_type:"Server",destination_vpc:"Database",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"pa-app-interface",component_id:"ethernet1/8",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters from Application zone",latency_ms:.1},{hop_number:2,component:"Allow-App-to-DB-Postgres",component_id:"rule-3",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: Application->Database, postgres app, AG-Database-Servers dest",latency_ms:.2},{hop_number:3,component:"Database-Protection-Profile",component_id:"profile-group-db",type:"Security Profile",direction:"Forward",decision:"ALLOW",details:"AV: Clean, AS: Clean, VP: No SQL injection detected",latency_ms:.3},{hop_number:4,component:"pa-db-interface",component_id:"ethernet1/10",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to Database zone",latency_ms:.1},{hop_number:5,component:"db-server-1-pa",component_id:"10.40.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"PostgreSQL server reached",latency_ms:.5}]},{analysis_id:"PATH-0021",analysis_timestamp:"2026-01-13T10:50:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Untrust-Zone",source_ip:"185.220.101.50",source_type:"Tor Exit Node",source_vpc:null,destination:"webapp-prod-1-pa",destination_ip:"10.30.1.40",destination_type:"Server",destination_vpc:"DMZ",protocol:"TCP",port:443},summary:{total_hops:2,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"Block-Tor-Exit-Nodes",blocking_reason:"Source IP in Tor Exit Node EDL - blocked by security policy"},hops:[{hop_number:1,component:"pa-external-interface",component_id:"ethernet1/1",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters Untrust zone",latency_ms:null},{hop_number:2,component:"Block-Tor-Exit-Nodes",component_id:"rule-51",type:"Palo Alto Security Rule",direction:"Forward",decision:"BLOCKED",details:"Source 185.220.101.50 matches EDL-Tor-Exit-Nodes - DENY action",latency_ms:null}]},{analysis_id:"PATH-0022",analysis_timestamp:"2026-01-13T10:51:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vpn-user-pa",source_ip:"10.100.50.60",source_type:"VPN User",source_vpc:"VPN",destination:"grafana-pa",destination_ip:"10.50.1.40",destination_type:"Server",destination_vpc:"Trust",protocol:"TCP",port:3e3},summary:{total_hops:5,path_latency_ms:2.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"globalprotect-gateway",component_id:"gp-gateway-1",type:"GlobalProtect Gateway",direction:"Inbound",decision:"ALLOW",details:"VPN user authenticated - MFA verified",latency_ms:.5},{hop_number:2,component:"pa-vpn-interface",component_id:"tunnel.1",type:"Palo Alto Tunnel Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPN zone",latency_ms:.2},{hop_number:3,component:"Allow-Grafana-VPN",component_id:"rule-10",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: VPN->Trust, web-browsing app, AG-Monitoring-Servers dest",latency_ms:.3},{hop_number:4,component:"pa-trust-interface",component_id:"ethernet1/5",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to Trust zone",latency_ms:.2},{hop_number:5,component:"grafana-pa",component_id:"10.50.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"Grafana server reached via VPN",latency_ms:1.3}]},{analysis_id:"PATH-0023",analysis_timestamp:"2026-01-13T10:52:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"kafka-broker-1",destination_ip:"10.36.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9092},summary:{total_hops:5,path_latency_ms:.9,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-004 allows TCP/9092 to sg-kafka-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.36.0.0/24 via local VPC routing",latency_ms:.2},{hop_number:4,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-301 allows TCP/9092 from sg-webapp-prod",latency_ms:.1},{hop_number:5,component:"kafka-broker-1",component_id:"i-0kf123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Kafka broker reached - topic access granted",latency_ms:.4}]},{analysis_id:"PATH-0024",analysis_timestamp:"2026-01-13T10:53:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"prometheus-1",source_ip:"10.50.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"webapp-prod-1",destination_ip:"10.30.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9100},summary:{total_hops:5,path_latency_ms:.7,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-701 allows TCP/9100 to 10.0.0.0/8",latency_ms:.1},{hop_number:2,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic to VirtualNetwork",latency_ms:.1},{hop_number:3,component:"rtb-monitoring",component_id:"rtb-0a1b2c3d4e5f00006",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.30.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-005 allows TCP/9100 from sg-monitoring",latency_ms:.1},{hop_number:5,component:"webapp-prod-1",component_id:"i-0abc123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Node exporter metrics endpoint accessible",latency_ms:.2}]},{analysis_id:"PATH-0025",analysis_timestamp:"2026-01-13T10:54:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"jenkins-master",source_ip:"10.70.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"github.com",destination_ip:"140.82.112.4",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:45.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-jenkins",component_id:"sg-0a1b2c3d4e5f00011",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1001 allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-cicd",component_id:"acl-0a1b2c3d4e5f00008",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:3,component:"rtb-cicd",component_id:"rtb-0a1b2c3d4e5f00008",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via nat-0a1b2c3d4e5f00002",latency_ms:.2},{hop_number:4,component:"nat-prod-1b",component_id:"nat-0a1b2c3d4e5f00002",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP 54.123.45.68",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"github.com",component_id:"140.82.112.4",type:"Destination",direction:"N/A",decision:"REACHED",details:"GitHub API accessible",latency_ms:41.7}]},{analysis_id:"PATH-0026",analysis_timestamp:"2026-01-13T10:55:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vault-1",source_ip:"10.90.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"DynamoDB",destination_ip:"vpce-dynamodb",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1202 allows HTTPS to pl-dynamodb",latency_ms:.1},{hop_number:2,component:"acl-vault",component_id:"acl-0a1b2c3d4e5f00009",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-vault",component_id:"rtb-0a1b2c3d4e5f00009",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to DynamoDB endpoint via pl-dynamodb prefix list",latency_ms:.2},{hop_number:4,component:"vpce-dynamodb",component_id:"vpce-0a1b2c3d4e5f00002",type:"VPC Gateway Endpoint",direction:"Forward",decision:"FORWARD",details:"Gateway endpoint for DynamoDB",latency_ms:1.5},{hop_number:5,component:"DynamoDB",component_id:"dynamodb.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"DynamoDB service reached via gateway endpoint",latency_ms:.9}]},{analysis_id:"PATH-0027",analysis_timestamp:"2026-01-13T10:56:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"splunk-indexer-1",source_ip:"10.80.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"S3",destination_ip:"vpce-s3",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:3.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1101 allows HTTPS to pl-63a5400a (S3)",latency_ms:.1},{hop_number:2,component:"acl-splunk",component_id:"acl-0a1b2c3d4e5f00010",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic",latency_ms:.1},{hop_number:3,component:"rtb-splunk",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to S3 endpoint via pl-63a5400a prefix list",latency_ms:.2},{hop_number:4,component:"vpce-s3",component_id:"vpce-0a1b2c3d4e5f00003",type:"VPC Gateway Endpoint",direction:"Forward",decision:"FORWARD",details:"Gateway endpoint for S3",latency_ms:2},{hop_number:5,component:"S3",component_id:"s3.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"S3 service reached for log archival",latency_ms:1.1}]},{analysis_id:"PATH-0028",analysis_timestamp:"2026-01-13T10:57:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"prod-west-webapp",source_ip:"10.130.1.10",source_type:"EC2",source_vpc:"vpc-prod-west-2",destination:"shared-services-dns",destination_ip:"10.200.1.10",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"UDP",port:53},summary:{total_hops:10,path_latency_ms:65.5,path_status:"REACHABLE",bottlenecks:["Cross-region latency: 55ms"]},hops:[{hop_number:1,component:"sg-webapp-west",component_id:"sg-west-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows UDP/53",latency_ms:.1},{hop_number:2,component:"acl-prod-west",component_id:"acl-west-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal",latency_ms:.1},{hop_number:3,component:"rtb-prod-west",component_id:"rtb-west-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via tgw-west",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-prod-west",component_id:"tgw-attach-west-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Enters West region TGW",latency_ms:1},{hop_number:5,component:"tgw-rtb-west",component_id:"tgw-rtb-west",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via cross-region peering",latency_ms:.5},{hop_number:6,component:"tgw-peer-west-east",component_id:"tgw-peer-east-west",type:"Transit Gateway Peering",direction:"Forward",decision:"FORWARD",details:"Cross-region peering us-west-2 to us-east-1",latency_ms:55},{hop_number:7,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 to shared services",latency_ms:.5},{hop_number:8,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Exits to Shared Services VPC",latency_ms:1},{hop_number:9,component:"sg-shared-dns",component_id:"sg-shared-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows UDP/53 from 10.0.0.0/8",latency_ms:.1},{hop_number:10,component:"shared-services-dns",component_id:"i-shared-dns-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"DNS server reached via cross-region path",latency_ms:7}]},{analysis_id:"PATH-0029",analysis_timestamp:"2026-01-13T10:58:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"analytics-1",source_ip:"10.95.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"es-data-1",destination_ip:"10.85.1.20",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9200},summary:{total_hops:5,path_latency_ms:1.1,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-analytics-prod",component_id:"sg-0a1b2c3d4e5f00015",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1404 allows TCP/9200 to sg-elasticsearch",latency_ms:.1},{hop_number:2,component:"acl-analytics",component_id:"acl-0a1b2c3d4e5f00011",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-analytics",component_id:"rtb-0a1b2c3d4e5f00011",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.85.0.0/24 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows TCP/9200 from analytics SG",latency_ms:.1},{hop_number:5,component:"es-data-1",component_id:"i-0es123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Elasticsearch data node reached",latency_ms:.6}]},{analysis_id:"PATH-0030",analysis_timestamp:"2026-01-13T10:59:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"cryptomining-pool.io",destination_ip:"203.0.113.200",destination_type:"External",destination_vpc:null,protocol:"TCP",port:3333},summary:{total_hops:4,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"Block-Crypto-Mining-PA",blocking_reason:"Destination in crypto mining EDL - blocked by Palo Alto"},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"No specific deny for this port",latency_ms:null},{hop_number:2,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to internet via Palo Alto firewall",latency_ms:null},{hop_number:3,component:"pa-fw-prod-01",component_id:"pa-fw-prod-01",type:"Palo Alto Firewall",direction:"Forward",decision:"INSPECT",details:"Traffic enters firewall for inspection",latency_ms:null},{hop_number:4,component:"Block-Crypto-Mining",component_id:"rule-52",type:"Palo Alto Security Rule",direction:"Forward",decision:"BLOCKED",details:"Destination 203.0.113.200 matches EDL-Crypto-Mining-Pools - DENY action with alert",latency_ms:null}]},{analysis_id:"PATH-0031",analysis_timestamp:"2026-01-13T11:00:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"pci-webapp-1",source_ip:"10.150.1.10",source_type:"EC2",source_vpc:"vpc-pci-east-1",destination:"shared-services-vault",destination_ip:"10.200.1.50",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"TCP",port:8200},summary:{total_hops:8,path_latency_ms:4.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-pci-webapp",component_id:"sg-pci-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows TCP/8200 to shared services",latency_ms:.1},{hop_number:2,component:"acl-pci-app",component_id:"acl-pci-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows traffic to 10.200.0.0/16",latency_ms:.1},{hop_number:3,component:"rtb-pci-private",component_id:"rtb-pci-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via Transit Gateway",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-pci",component_id:"tgw-attach-vpc-pci",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Enters TGW from PCI VPC",latency_ms:1},{hop_number:5,component:"tgw-rtb-isolated",component_id:"tgw-rtb-isolated",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Isolated route table - only shared services allowed",latency_ms:.5},{hop_number:6,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Exits to Shared Services VPC",latency_ms:1},{hop_number:7,component:"sg-shared-vault",component_id:"sg-shared-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows TCP/8200 from PCI VPC CIDR",latency_ms:.1},{hop_number:8,component:"shared-services-vault",component_id:"i-shared-vault-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Vault server reached for secrets retrieval",latency_ms:1.5}]},{analysis_id:"PATH-0032",analysis_timestamp:"2026-01-13T11:01:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"api-prod-1",source_ip:"10.31.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"okta.com",destination_ip:"54.201.45.67",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:35.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-api-gateway",component_id:"sg-0a1b2c3d4e5f00006",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 110 allows TCP/443 outbound",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via NAT Gateway",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"okta.com",component_id:"54.201.45.67",type:"Destination",direction:"N/A",decision:"REACHED",details:"Okta SSO endpoint reached for authentication",latency_ms:32.3}]},{analysis_id:"PATH-0033",analysis_timestamp:"2026-01-13T11:02:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"bastion-prod",source_ip:"10.20.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:22},summary:{total_hops:5,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-bastion",component_id:"sg-0a1b2c3d4e5f00007",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-601 allows SSH to 10.0.0.0/8",latency_ms:.1},{hop_number:2,component:"acl-bastion",component_id:"acl-0a1b2c3d4e5f00012",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-bastion",component_id:"rtb-0a1b2c3d4e5f00012",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-104 allows SSH from sg-bastion",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Database server SSH accessible from bastion",latency_ms:.3}]},{analysis_id:"PATH-0034",analysis_timestamp:"2026-01-13T11:03:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"eks-node-1",source_ip:"10.60.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"eks-control-plane",destination_ip:"10.60.0.5",destination_type:"EKS API",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:4,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-eks-nodes",component_id:"sg-0a1b2c3d4e5f00009",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-804 allows TCP/443 to sg-eks-control",latency_ms:.1},{hop_number:2,component:"rtb-eks-private",component_id:"rtb-0a1b2c3d4e5f00003",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to EKS control plane ENI",latency_ms:.2},{hop_number:3,component:"sg-eks-control",component_id:"sg-0a1b2c3d4e5f00010",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-902 allows TCP/443 from sg-eks-nodes",latency_ms:.1},{hop_number:4,component:"eks-control-plane",component_id:"arn:aws:eks:...",type:"Destination",direction:"N/A",decision:"REACHED",details:"EKS API server reached for kubelet communication",latency_ms:.8}]},{analysis_id:"PATH-0035",analysis_timestamp:"2026-01-13T11:04:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"kafka-broker-1",source_ip:"10.36.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"kafka-broker-2",destination_ip:"10.36.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9093},summary:{total_hops:4,path_latency_ms:.4,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-303 allows TCP/9093 to sg-kafka-prod (self)",latency_ms:.1},{hop_number:2,component:"rtb-kafka",component_id:"rtb-0a1b2c3d4e5f00004",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Kafka subnet",latency_ms:.1},{hop_number:3,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-306 allows TCP/9093 from sg-kafka-prod (self)",latency_ms:.1},{hop_number:4,component:"kafka-broker-2",component_id:"i-0kf123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Kafka inter-broker replication successful",latency_ms:.1}]},{analysis_id:"PATH-0036",analysis_timestamp:"2026-01-13T11:05:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Internet-GitHub",source_ip:"140.82.112.10",source_type:"GitHub Webhook",source_vpc:null,destination:"jenkins-master",destination_ip:"10.70.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:18.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:2},{hop_number:2,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/443",latency_ms:.1},{hop_number:3,component:"sg-alb-jenkins",component_id:"sg-0a1b2c3d4e5f00016",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows HTTPS from GitHub IP range 140.82.112.0/20",latency_ms:.1},{hop_number:4,component:"alb-jenkins",component_id:"arn:aws:elasticloadbalancing:...",type:"Load Balancer",direction:"Forward",decision:"FORWARD",details:"ALB routes to Jenkins target group",latency_ms:3},{hop_number:5,component:"acl-cicd",component_id:"acl-0a1b2c3d4e5f00008",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows from ALB subnet",latency_ms:.1},{hop_number:6,component:"sg-jenkins",component_id:"sg-0a1b2c3d4e5f00011",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1003 allows HTTPS from GitHub",latency_ms:.1},{hop_number:7,component:"jenkins-master",component_id:"i-0jen123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Jenkins webhook endpoint accessible",latency_ms:13.1}]},{analysis_id:"PATH-0037",analysis_timestamp:"2026-01-13T11:06:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vault-1",source_ip:"10.90.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"vault-2",destination_ip:"10.90.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:8201},summary:{total_hops:4,path_latency_ms:.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1201 allows TCP/8201 to sg-vault (self)",latency_ms:.1},{hop_number:2,component:"rtb-vault",component_id:"rtb-0a1b2c3d4e5f00009",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Vault subnet",latency_ms:.1},{hop_number:3,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1202 allows TCP/8201 from sg-vault (self)",latency_ms:.1},{hop_number:4,component:"vault-2",component_id:"i-0vlt123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Vault HA cluster communication successful",latency_ms:.2}]},{analysis_id:"PATH-0038",analysis_timestamp:"2026-01-13T11:07:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"unknown-server",destination_ip:"192.168.1.100",destination_type:"Unknown",destination_vpc:null,protocol:"TCP",port:22},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"rtb-private-app",blocking_reason:"No route to RFC1918 address - destination unreachable"},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Default outbound allows this traffic",latency_ms:null},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal",latency_ms:null},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"BLOCKED",details:"No route to 192.168.0.0/16 - destination not in VPC CIDR or TGW routes",latency_ms:null}]},{analysis_id:"PATH-0039",analysis_timestamp:"2026-01-13T11:08:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"es-data-1",source_ip:"10.85.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"es-data-2",destination_ip:"10.85.1.21",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9300},summary:{total_hops:4,path_latency_ms:.4,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1301 allows TCP/9300 to sg-elasticsearch (self)",latency_ms:.1},{hop_number:2,component:"rtb-elasticsearch",component_id:"rtb-0a1b2c3d4e5f00013",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within ES subnet",latency_ms:.1},{hop_number:3,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1303 allows TCP/9300 from sg-elasticsearch (self)",latency_ms:.1},{hop_number:4,component:"es-data-2",component_id:"i-0es123def456789c",type:"Destination",direction:"N/A",decision:"REACHED",details:"Elasticsearch transport layer communication successful",latency_ms:.1}]},{analysis_id:"PATH-0040",analysis_timestamp:"2026-01-13T11:09:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"alertmanager-1",source_ip:"10.50.1.12",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"api.pagerduty.com",destination_ip:"52.206.43.0",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:28.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-702 allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:3,component:"rtb-monitoring",component_id:"rtb-0a1b2c3d4e5f00006",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via NAT Gateway",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"api.pagerduty.com",component_id:"52.206.43.0",type:"Destination",direction:"N/A",decision:"REACHED",details:"PagerDuty API accessible for alert notifications",latency_ms:25}]},{analysis_id:"PATH-0041",analysis_timestamp:"2026-01-13T11:10:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"jupyter-hub",source_ip:"10.95.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:.9,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-analytics-prod",component_id:"sg-0a1b2c3d4e5f00015",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1401 allows TCP/5432 to sg-database-prod",latency_ms:.1},{hop_number:2,component:"acl-analytics",component_id:"acl-0a1b2c3d4e5f00011",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-analytics",component_id:"rtb-0a1b2c3d4e5f00011",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-103 allows TCP/5432 from sg-analytics-prod",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Database accessible for analytics queries",latency_ms:.4}]},{analysis_id:"PATH-0042",analysis_timestamp:"2026-01-13T11:11:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"203.0.113.100",source_type:"External",source_vpc:null,destination:"bastion-prod",destination_ip:"10.20.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:22},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"sg-bastion",blocking_reason:"Source IP not in allowed VPN or emergency IP list"},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:null},{hop_number:2,component:"acl-bastion",component_id:"acl-0a1b2c3d4e5f00012",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"NACL allows for evaluation",latency_ms:null},{hop_number:3,component:"sg-bastion",component_id:"sg-0a1b2c3d4e5f00007",type:"Security Group",direction:"Inbound",decision:"BLOCKED",details:"No rule allows SSH from 203.0.113.100 - only VPN (10.100.0.0/16) and emergency IP (203.0.113.50/32) allowed",latency_ms:null}]},{analysis_id:"PATH-0043",analysis_timestamp:"2026-01-13T11:12:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"splunk-search-1",source_ip:"10.80.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"splunk-indexer-1",destination_ip:"10.80.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9997},summary:{total_hops:4,path_latency_ms:.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1102 allows TCP/9997 to sg-splunk (self)",latency_ms:.1},{hop_number:2,component:"rtb-splunk",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Splunk subnet",latency_ms:.1},{hop_number:3,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1103 allows TCP/9997 from sg-splunk (self)",latency_ms:.1},{hop_number:4,component:"splunk-indexer-1",component_id:"i-0spl123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Splunk search head to indexer communication successful",latency_ms:.2}]},{analysis_id:"PATH-0044",analysis_timestamp:"2026-01-13T11:13:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"sqs-orders-queue",destination_ip:"vpce-sqs",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows HTTPS to VPC endpoints",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to SQS endpoint via local ENI",latency_ms:.2},{hop_number:4,component:"vpce-sqs",component_id:"vpce-0a1b2c3d4e5f00004",type:"VPC Interface Endpoint",direction:"Forward",decision:"FORWARD",details:"PrivateLink endpoint for SQS",latency_ms:1.5},{hop_number:5,component:"SQS",component_id:"sqs.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"SQS service reached via PrivateLink",latency_ms:.3}]},{analysis_id:"PATH-0045",analysis_timestamp:"2026-01-13T11:14:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"lambda-order-processor",source_ip:"10.65.1.50",source_type:"Lambda",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-lambda-vpc",component_id:"sg-0a1b2c3d4e5f00017",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Lambda SG allows outbound to database",latency_ms:.1},{hop_number:2,component:"acl-lambda",component_id:"acl-0a1b2c3d4e5f00014",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-lambda",component_id:"rtb-0a1b2c3d4e5f00014",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.3},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound allows PostgreSQL from Lambda SG",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Lambda function can access database",latency_ms:.9}]}],Eu={path_analyses:df},Vt=e=>new Promise(t=>setTimeout(t,e)),uf=(e,t=10)=>Array.from({length:3},()=>Math.max(1,e+(Math.random()-.5)*t*2)),pf=e=>{const t=Math.floor(Math.random()*8)+8,n=[],a=[{ip:"192.168.1.1",hostname:"gateway.local",location:"Local Network",deviceType:"router"},{ip:"10.0.0.1",hostname:"core-rtr-01.example.com",location:"Data Center",asn:"AS12345",asnOrg:"Example Corp",deviceType:"router"},{ip:"72.14.194.1",hostname:"edge-rtr-02.isp.net",location:"Chicago, IL",asn:"AS15169",asnOrg:"ISP Networks",deviceType:"router"},{ip:"142.250.80.1",hostname:"core-bb-01.transit.net",location:"Denver, CO",asn:"AS174",asnOrg:"Cogent",deviceType:"router"},{ip:"209.85.248.1",hostname:"ae-12.cr1.sjc.transit.net",location:"San Jose, CA",asn:"AS3356",asnOrg:"Level 3",deviceType:"router"},{ip:"72.14.232.1",hostname:"be-102.pr1.lax.cloud.net",location:"Los Angeles, CA",asn:"AS15169",asnOrg:"Google Cloud",deviceType:"router",cloudProvider:"gcp"},{ip:"52.93.127.1",hostname:"aws-edge-01.us-east-1",location:"Virginia, US",asn:"AS16509",asnOrg:"Amazon",deviceType:"firewall",cloudProvider:"aws"},{ip:"13.107.4.1",hostname:"azure-gw-01.eastus",location:"Virginia, US",asn:"AS8075",asnOrg:"Microsoft",deviceType:"router",cloudProvider:"azure"}];let s=1;for(let o=0;o<t;o++){const i=o===t-1,l=Math.min(o,a.length-1),c=a[l];s+=Math.random()*15+5;const d=Math.random()<.1,u=d&&Math.random()<.3,m=d?Math.random()*20:Math.random()*2,g=u?[]:uf(s,s*.2),v=g.length>0?g.reduce((b,y)=>b+y,0)/g.length:0;n.push({hopNumber:o+1,ipAddress:i?e:c.ip.replace(/\d+$/,String(o+1)),hostname:i?`target-${e.replace(/\./g,"-")}`:c.hostname,location:c.location,asn:c.asn||null,asnOrg:c.asnOrg||null,latency:g,avgLatency:parseFloat(v.toFixed(2)),minLatency:g.length>0?parseFloat(Math.min(...g).toFixed(2)):0,maxLatency:g.length>0?parseFloat(Math.max(...g).toFixed(2)):0,jitter:g.length>0?parseFloat((Math.max(...g)-Math.min(...g)).toFixed(2)):0,packetLoss:parseFloat(m.toFixed(1)),status:u?"timeout":m>10?"unreachable":"reachable",deviceType:c.deviceType,cloudProvider:c.cloudProvider||null,region:c.cloudProvider?"us-east-1":void 0})}return n},mf=e=>{const t=e.reduce((s,o)=>s+o.packetLoss,0)/e.length,n=e.filter(s=>s.status==="timeout").length,a=e.filter(s=>s.status==="unreachable").length;return n>2||a>1||t>10?"critical":n>0||t>5?"degraded":"healthy"},gf=()=>Eu.path_analyses.slice(0,20).map(e=>{let t="healthy";return e.result==="BLOCKED"||e.result==="FAILED"?t="critical":e.summary.bottlenecks&&e.summary.bottlenecks.length>0&&(t="degraded"),{id:e.analysis_id,source:e.input.source,destination:e.input.destination,timestamp:e.analysis_timestamp,totalHops:e.summary.total_hops,avgLatency:e.summary.path_latency_ms??0,health:t,status:"completed"}});let cn=gf();const ff=()=>{const e=new Map;return Eu.path_analyses.forEach(t=>{const n=`${t.input.source}-${t.input.destination}`;e.has(n)||e.set(n,t)}),Array.from(e.values()).slice(0,10).map((t,n)=>({id:`sp-${n+1}`,name:`${t.input.source} to ${t.input.destination}`,source:t.input.source_ip||t.input.source,destination:t.input.destination_ip||t.input.destination,protocol:t.input.protocol.toLowerCase(),port:t.input.port||void 0,createdAt:t.analysis_timestamp,lastRun:t.analysis_timestamp,runCount:Math.floor(Math.random()*50)+1}))};let Kn=ff();const ze={async runAnalysis(e){await Vt(2e3+Math.random()*2e3);const t=new Date().toISOString(),n=pf(e.destination),a=new Date().toISOString(),s=n.reduce((c,d)=>c+d.avgLatency,0),o=s/n.length,i=n.reduce((c,d)=>c+d.packetLoss,0)/n.length,l={id:`pa-${Date.now()}`,source:e.source,destination:e.destination,protocol:e.protocol,port:e.port,hops:n,totalHops:n.length,totalLatency:parseFloat(s.toFixed(2)),avgLatency:parseFloat(o.toFixed(2)),packetLoss:parseFloat(i.toFixed(1)),health:mf(n),status:"completed",startTime:t,endTime:a,duration:2e3+Math.random()*2e3,mtu:1500,ttl:e.maxHops||30};return cn.unshift({id:l.id,source:l.source,destination:l.destination,timestamp:l.startTime,totalHops:l.totalHops,avgLatency:l.avgLatency,health:l.health,status:l.status}),cn.length>20&&(cn=cn.slice(0,20)),l},async getHistory(){return await Vt(300),cn},async clearHistory(){await Vt(200),cn=[]},async getSavedPaths(){return await Vt(300),Kn},async savePath(e){await Vt(300);const t={...e,id:`sp-${Date.now()}`,createdAt:new Date().toISOString(),lastRun:null,runCount:0};return Kn.unshift(t),t},async deleteSavedPath(e){await Vt(200),Kn=Kn.filter(t=>t.id!==e)},async updateSavedPathRun(e){await Vt(100);const t=Kn.find(n=>n.id===e);t&&(t.lastRun=new Date().toISOString(),t.runCount+=1)}},hf=[{ticket_number:"CHG0012345",short_description:"Database access for recommendation-engine-v2 to user_profiles DB",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"recommendation-engine-v2",source_ip:"10.50.10.0/24",destination_system:"user_profiles PostgreSQL",destination_ip:"10.20.5.100",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"ML service requires read-write access to update user preference scores for personalized recommendations",requested_by:{name:"John Developer",email:"john.developer@company.com",department:"Engineering"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["GDPR","SOC2"],violations:[]},assigned_to:{name:"Sarah Security",email:"sarah.security@company.com",role:"Security Manager"},state:"Implementing",created_at:"2026-01-10T09:00:00Z",updated_at:"2026-01-12T14:30:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Risk acceptable"}],additional_controls:["Audit Logging"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove security group rule sgr-xxx",change_window:"2026-01-12T22:00:00Z to 2026-01-13T02:00:00Z"},{ticket_number:"CHG0012346",short_description:"Allow external API access to payment-gateway service",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"Partner API - Stripe Payment Provider",source_ip:"203.0.113.0/24",destination_system:"payment-gateway-prod",destination_ip:"api.payments.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Stripe webhook callbacks for payment confirmation notifications per PCI-DSS requirements",requested_by:{name:"Mike Finance",email:"mike.finance@company.com",department:"Finance"},atlas_risk_score:72,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["PCI-DSS 1.2.1","PCI-DSS 1.3.4"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-11T11:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Security Manager","CISO"],approval_history:[],additional_controls:["WAF Protection","Rate Limiting","IP Whitelist"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Disable WAF rule and remove IP whitelist entry",change_window:"2026-01-15T06:00:00Z to 2026-01-15T10:00:00Z"},{ticket_number:"CHG0012347",short_description:"VPN access for DevOps team to production Kubernetes cluster",category:"Network / VPN Access",priority:3,priority_label:"Moderate",source_system:"VPN Pool - DevOps Team",source_ip:"10.100.50.0/24",destination_system:"prod-eks-cluster API Server",destination_ip:"10.30.0.100",destination_port:6443,protocol:"TCP",action:"ALLOW",business_justification:"DevOps team requires kubectl access for deployment and troubleshooting of production workloads",requested_by:{name:"Lisa DevOps",email:"lisa.devops@company.com",department:"DevOps"},atlas_risk_score:58,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Tom Network",email:"tom.network@company.com",role:"Network Engineer"},state:"Approved",created_at:"2026-01-09T14:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"MFA enforcement verified"}],additional_controls:["MFA Required","Session Timeout 4hrs","Audit Logging"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove VPN group from Kubernetes RBAC",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012348",short_description:"Enable Transit Gateway routing between Analytics VPC and Data Lake VPC",category:"Network / Transit Gateway",priority:3,priority_label:"Moderate",source_system:"Analytics VPC",source_ip:"10.60.0.0/16",destination_system:"Data Lake VPC",destination_ip:"10.70.0.0/16",destination_port:null,protocol:"TCP",ports:[443,9092,3306],action:"ALLOW",business_justification:"Analytics platform requires access to data lake for ML model training and real-time analytics pipeline",requested_by:{name:"Data Team",email:"data.team@company.com",department:"Data Science"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Network Team",email:"network@company.com",role:"Operator"},state:"Implemented",created_at:"2026-01-08T10:00:00Z",updated_at:"2026-01-12T09:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-08T10:05:00Z",comments:"Risk score 35 below threshold 40"}],additional_controls:[],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove TGW route table association",change_window:null},{ticket_number:"CHG0012349",short_description:"Emergency block of malicious IP range - Active threat detected",category:"Security / Emergency Block",priority:1,priority_label:"Critical",source_system:"Malicious IP Range - Known Tor Exit Nodes",source_ip:"185.220.101.0/24",destination_system:"All public-facing services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Emergency security response to active threat - automated brute force attacks detected",requested_by:{name:"SOC Team",email:"soc@company.com",department:"Security Operations"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Incident Response"],violations:[]},assigned_to:{name:"SOC Team",email:"soc@company.com",role:"Security Analyst"},state:"Monitoring",created_at:"2026-01-12T14:00:00Z",updated_at:"2026-01-12T14:00:47Z",threat_intelligence_source:"Recorded Future Alert RF-2026-0112-001, AlienVault OTX Pulse",implementation_time_seconds:47,auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-12T14:00:05Z",comments:"Emergency protocol activated"}],additional_controls:["Active Monitoring","SIEM Alert","Threat Feed Integration"],estimated_implementation_time:"Immediate",actual_implementation_time:"47 seconds",rollback_plan:"Remove deny rules from all platforms",change_window:null},{ticket_number:"CHG0012350",short_description:"Temporary vendor access for SAP integration maintenance",category:"Network / Vendor Access",priority:3,priority_label:"Moderate",source_system:"SAP Consulting Jump Host",source_ip:"198.51.100.50/32",destination_system:"SAP HANA Production",destination_ip:"10.40.20.100",destination_port:30015,protocol:"TCP",action:"ALLOW",business_justification:"Scheduled SAP S/4HANA upgrade requiring vendor specialist support per contract SOW-SAP-2025-089",requested_by:{name:"IT Procurement",email:"procurement@company.com",department:"IT"},atlas_risk_score:65,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","Vendor Management"],violations:[]},assigned_to:{name:"Vendor Management",email:"vendor.mgmt@company.com",role:"Manager"},state:"Scheduled",created_at:"2026-01-10T16:00:00Z",updated_at:"2026-01-12T08:00:00Z",access_duration_hours:72,access_start:"2026-01-15T08:00:00Z",access_end:"2026-01-18T08:00:00Z",auto_expire:!0,required_approvers:["Security Manager","Vendor Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T09:00:00Z",comments:"Session recording required"},{approver:"James Vendor",action:"Approved",timestamp:"2026-01-11T14:00:00Z",comments:"Contract verified"}],additional_controls:["Session Recording","Real-time Monitoring","DLP Enabled","Auto-expire 72h"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Revoke vendor credentials and remove firewall rule",change_window:"2026-01-15T08:00:00Z to 2026-01-18T08:00:00Z"},{ticket_number:"CHG0012351",short_description:"Allow microservices communication for order-processing to inventory-service",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"order-processing-svc",source_ip:"10.30.20.0/24",destination_system:"inventory-service",destination_ip:"10.30.25.0/24",destination_port:8080,protocol:"TCP",action:"ALLOW",business_justification:"New microservice architecture requires inter-service communication for order fulfillment workflow",requested_by:{name:"Platform Team",email:"platform@company.com",department:"Platform Engineering"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Security",email:"platform.sec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-07T13:00:00Z",updated_at:"2026-01-11T16:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-07T13:02:00Z",comments:"Low risk - internal service mesh"}],additional_controls:["Service Mesh mTLS"],estimated_implementation_time:"15 minutes",actual_implementation_time:"12 minutes",rollback_plan:"Remove service mesh policy",change_window:null},{ticket_number:"CHG0012352",short_description:"Block deprecated API endpoint access from legacy systems",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Legacy Application Servers",source_ip:"10.5.0.0/16",destination_system:"Deprecated API Gateway",destination_ip:"10.10.100.50",destination_port:8443,protocol:"TCP",action:"DENY",business_justification:"Deprecating old API version as part of modernization initiative - redirect to new endpoints",requested_by:{name:"Architecture Team",email:"architecture@company.com",department:"Architecture"},atlas_risk_score:42,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["Change Management"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T09:00:00Z",updated_at:"2026-01-12T15:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T10:00:00Z",comments:"Grace period communication sent"}],additional_controls:["Logging Enabled","Grace Period 7 days"],estimated_implementation_time:"30 minutes",actual_implementation_time:null,rollback_plan:"Remove deny rule and restore API access",change_window:"2026-01-20T00:00:00Z to 2026-01-20T04:00:00Z"},{ticket_number:"CHG0012353",short_description:"Enable CloudWatch log streaming to Splunk SIEM",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS CloudWatch",source_ip:"AWS Internal",destination_system:"Splunk SIEM",destination_ip:"10.90.10.100",destination_port:9997,protocol:"TCP",action:"ALLOW",business_justification:"Centralized log aggregation for security monitoring and compliance requirements",requested_by:{name:"Security Operations",email:"secops@company.com",department:"Security"},atlas_risk_score:22,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"SIEM Team",email:"siem@company.com",role:"Administrator"},state:"Implementing",created_at:"2026-01-09T11:00:00Z",updated_at:"2026-01-12T13:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T11:01:00Z",comments:"Logging infrastructure - low risk"}],additional_controls:["TLS Encryption","Log Integrity Verification"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Disable CloudWatch subscription filter",change_window:null},{ticket_number:"CHG0012354",short_description:"Allow Redis cluster access from application caching layer",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Caching Layer",source_ip:"10.30.30.0/24",destination_system:"Redis Cluster",destination_ip:"10.20.50.0/24",destination_port:6379,protocol:"TCP",action:"ALLOW",business_justification:"Application requires distributed caching for session management and performance optimization",requested_by:{name:"Backend Team",email:"backend@company.com",department:"Engineering"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"DBA"},state:"Implemented",created_at:"2026-01-06T10:00:00Z",updated_at:"2026-01-10T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T10:01:00Z",comments:"Internal caching - low risk"}],additional_controls:["Redis AUTH Enabled","TLS in Transit"],estimated_implementation_time:"20 minutes",actual_implementation_time:"18 minutes",rollback_plan:"Remove security group rule",change_window:null},{ticket_number:"CHG0012355",short_description:"External partner API integration for FedEx shipping provider",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"FedEx API Gateway",source_ip:"199.16.156.0/24",destination_system:"Shipping Service API",destination_ip:"api.shipping.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Integration with FedEx shipping API for real-time tracking and label generation",requested_by:{name:"Logistics Team",email:"logistics@company.com",department:"Logistics"},atlas_risk_score:68,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-12T08:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager","Integration Manager"],approval_history:[],additional_controls:["WAF Rules","Rate Limiting","IP Whitelist"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Remove WAF exception and IP whitelist",change_window:"2026-01-16T06:00:00Z to 2026-01-16T12:00:00Z"},{ticket_number:"CHG0012356",short_description:"Database replication between primary and DR site",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Primary Database Cluster",source_ip:"10.20.10.0/24",destination_system:"DR Database Cluster",destination_ip:"10.120.10.0/24",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Enable database replication for disaster recovery compliance - RPO 15 minutes",requested_by:{name:"DR Team",email:"dr.team@company.com",department:"Infrastructure"},atlas_risk_score:55,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","Business Continuity"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"Senior DBA"},state:"Implementing",created_at:"2026-01-08T15:00:00Z",updated_at:"2026-01-12T12:00:00Z",required_approvers:["Security Manager","Database Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T10:00:00Z",comments:"Encryption verified"},{approver:"DBA Manager",action:"Approved",timestamp:"2026-01-09T14:00:00Z",comments:"Replication config reviewed"}],additional_controls:["Encryption in Transit","Replication Monitoring"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Disable replication and remove firewall rules",change_window:"2026-01-13T02:00:00Z to 2026-01-13T06:00:00Z"},{ticket_number:"CHG0012357",short_description:"Allow monitoring agent communication to Datadog",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"All Application Servers",source_ip:"10.0.0.0/8",destination_system:"Datadog Agent Endpoint",destination_ip:"agent.datadoghq.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable APM and infrastructure monitoring across all environments",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Network Team",email:"network@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T09:00:00Z",updated_at:"2026-01-09T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T09:01:00Z",comments:"Monitoring egress - low risk"}],additional_controls:["Egress Only","No Inbound"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012358",short_description:"Block suspicious IP range from Eastern Europe - Threat Response",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"Suspicious IP Range",source_ip:"91.134.0.0/16",destination_system:"All Internet-Facing Services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Threat intelligence indicates active scanning and brute force attempts from this range",requested_by:{name:"Threat Intelligence",email:"threat.intel@company.com",department:"Security"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Incident Response"],violations:[]},assigned_to:{name:"SOC Team",email:"soc@company.com",role:"Analyst"},state:"Monitoring",created_at:"2026-01-12T10:00:00Z",updated_at:"2026-01-12T10:01:23Z",threat_intelligence_source:"Internal Threat Detection, VirusTotal",implementation_time_seconds:83,auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-12T10:00:10Z",comments:"Threat response protocol"}],additional_controls:["Geo-blocking","Rate Limiting Backup"],estimated_implementation_time:"Immediate",actual_implementation_time:"83 seconds",rollback_plan:"Remove deny rules when threat cleared",change_window:null},{ticket_number:"CHG0012359",short_description:"Allow CI/CD pipeline access to Artifactory repository",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Jenkins Build Agents",source_ip:"10.80.0.0/16",destination_system:"Artifactory Repository",destination_ip:"10.85.10.50",destination_port:8081,protocol:"TCP",action:"ALLOW",business_justification:"CI/CD pipeline requires access to push and pull build artifacts",requested_by:{name:"DevOps Team",email:"devops@company.com",department:"DevOps"},atlas_risk_score:41,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"DevOps Security",email:"devsec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-10T14:00:00Z",updated_at:"2026-01-12T09:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T08:00:00Z",comments:"Service account verified"}],additional_controls:["Service Account Auth","Artifact Signing"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove firewall rule and revoke service account",change_window:null},{ticket_number:"CHG0012360",short_description:"Enable cross-region VPC peering for global load balancing",category:"Network / VPC Peering",priority:2,priority_label:"High",source_system:"US-East Production VPC",source_ip:"10.10.0.0/16",destination_system:"EU-West Production VPC",destination_ip:"10.110.0.0/16",destination_port:null,protocol:"ALL",action:"ALLOW",business_justification:"Global load balancing architecture for improved latency and disaster recovery",requested_by:{name:"Infrastructure Team",email:"infrastructure@company.com",department:"Infrastructure"},atlas_risk_score:48,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","GDPR"],violations:[]},assigned_to:{name:"Cloud Architecture",email:"cloud.arch@company.com",role:"Senior Engineer"},state:"Approved",created_at:"2026-01-09T08:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager","Network Architect"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"GDPR data flow verified"},{approver:"Network Architect",action:"Approved",timestamp:"2026-01-10T14:00:00Z",comments:"Architecture reviewed"}],additional_controls:["Transit Encryption","Route Verification"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Delete VPC peering connection",change_window:"2026-01-14T02:00:00Z to 2026-01-14T08:00:00Z"},{ticket_number:"CHG0012361",short_description:"Allow Kafka cluster access for event streaming",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Event Producers",source_ip:"10.30.0.0/16",destination_system:"Kafka Cluster",destination_ip:"10.25.10.0/24",destination_port:9092,protocol:"TCP",action:"ALLOW",business_justification:"Enable event-driven architecture for real-time data processing",requested_by:{name:"Data Engineering",email:"data.eng@company.com",department:"Data"},atlas_risk_score:36,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Team",email:"platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T11:00:00Z",updated_at:"2026-01-08T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T11:01:00Z",comments:"Internal messaging - low risk"}],additional_controls:["SASL Authentication","TLS Encryption"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove Kafka ACLs and security group rules",change_window:null},{ticket_number:"CHG0012362",short_description:"External webhook integration for GitHub Actions",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"GitHub Actions",source_ip:"140.82.112.0/20",destination_system:"Deployment Webhook Service",destination_ip:"hooks.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"GitHub Actions requires webhook callback for deployment status updates",requested_by:{name:"DevOps",email:"devops@company.com",department:"DevOps"},atlas_risk_score:52,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"Security Engineering",email:"sec.eng@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T10:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T09:00:00Z",comments:"Webhook signature validation required"}],additional_controls:["Webhook Signature Validation","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rule and IP whitelist",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012363",short_description:"Block crypto mining pool connections",category:"Security / Threat Response",priority:2,priority_label:"High",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"Known Mining Pools",destination_ip:"Multiple IPs",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Prevent unauthorized cryptocurrency mining on company resources",requested_by:{name:"Security Team",email:"security@company.com",department:"Security"},atlas_risk_score:null,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["Security Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T08:00:00Z",updated_at:"2026-01-07T12:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-03T10:00:00Z",comments:"Policy enforcement"}],additional_controls:["DNS Sinkhole","Threat Feed Integration"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove deny rules and DNS sinkhole entries",change_window:null},{ticket_number:"CHG0012364",short_description:"Allow Elasticsearch cluster access for log analytics",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Log Aggregation Services",source_ip:"10.90.0.0/16",destination_system:"Elasticsearch Cluster",destination_ip:"10.25.20.0/24",destination_port:9200,protocol:"TCP",action:"ALLOW",business_justification:"Enable centralized log search and analytics capabilities",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:34,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Data Platform",email:"data.platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T09:00:00Z",updated_at:"2026-01-06T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-02T09:01:00Z",comments:"Logging infrastructure"}],additional_controls:["TLS Encryption","Role-Based Access"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove security group rules",change_window:null},{ticket_number:"CHG0012365",short_description:"Enable S3 VPC Endpoint for secure data transfer",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"AWS S3 Service",destination_ip:"S3 Prefix List",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Route S3 traffic through VPC endpoint for security and cost optimization",requested_by:{name:"Cloud Team",email:"cloud@company.com",department:"Cloud Infrastructure"},atlas_risk_score:25,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-01T10:00:00Z",updated_at:"2026-01-05T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-01T10:01:00Z",comments:"AWS managed endpoint - low risk"}],additional_controls:["VPC Endpoint Policy","S3 Bucket Policy"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove VPC endpoint and route table entries",change_window:null},{ticket_number:"CHG0012366",short_description:"Allow Azure AD authentication traffic",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"All Corporate Applications",source_ip:"10.0.0.0/8",destination_system:"Azure AD Endpoints",destination_ip:"login.microsoftonline.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Azure AD SSO authentication for corporate applications",requested_by:{name:"Identity Team",email:"identity@company.com",department:"IT Security"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Identity Security",email:"idsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2025-12-28T14:00:00Z",updated_at:"2026-01-02T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2025-12-28T14:01:00Z",comments:"Identity provider - low risk"}],additional_controls:["TLS 1.2+","Certificate Pinning"],estimated_implementation_time:"1 hour",actual_implementation_time:"45 minutes",rollback_plan:"Remove egress rules for Azure AD endpoints",change_window:null},{ticket_number:"CHG0012367",short_description:"Block outbound DNS to non-corporate resolvers",category:"Security / Access Revocation",priority:2,priority_label:"High",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"External DNS Servers",destination_ip:"0.0.0.0/0",destination_port:53,protocol:"UDP",action:"DENY",business_justification:"Enforce use of corporate DNS for security monitoring and DNS tunneling prevention",requested_by:{name:"Security Architecture",email:"sec.arch@company.com",department:"Security"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","Security Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Senior Engineer"},state:"Approved",created_at:"2026-01-10T09:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager","Network Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Exception list reviewed"},{approver:"Network Manager",action:"Approved",timestamp:"2026-01-12T09:00:00Z",comments:"Impact assessment complete"}],additional_controls:["DNS Logging","Exception Whitelist for Cloud Services"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Remove deny rules",change_window:"2026-01-15T02:00:00Z to 2026-01-15T06:00:00Z"},{ticket_number:"CHG0012368",short_description:"Allow GraphQL API access for mobile applications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Mobile App Users",source_ip:"0.0.0.0/0",destination_system:"GraphQL API Gateway",destination_ip:"graphql.api.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"New mobile app requires GraphQL API access for data queries",requested_by:{name:"Mobile Team",email:"mobile@company.com",department:"Mobile Development"},atlas_risk_score:62,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","OWASP"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-12T11:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager","API Security"],approval_history:[],additional_controls:["WAF Rules","Rate Limiting","Query Depth Limiting","Authentication Required"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Disable API endpoint",change_window:"2026-01-16T10:00:00Z to 2026-01-16T14:00:00Z"},{ticket_number:"CHG0012369",short_description:"Enable MongoDB Atlas peering connection",category:"Network / VPC Peering",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"MongoDB Atlas",destination_ip:"192.168.248.0/21",destination_port:27017,protocol:"TCP",action:"ALLOW",business_justification:"Migrate to MongoDB Atlas for managed database services",requested_by:{name:"Database Team",email:"dba@company.com",department:"Database"},atlas_risk_score:44,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","HIPAA"],violations:[]},assigned_to:{name:"Cloud Database",email:"cloud.db@company.com",role:"DBA"},state:"Approved",created_at:"2026-01-08T13:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T11:00:00Z",comments:"MongoDB Atlas SOC2 verified"}],additional_controls:["TLS Encryption","IP Whitelist","Authentication"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Delete VPC peering connection",change_window:"2026-01-14T06:00:00Z to 2026-01-14T10:00:00Z"},{ticket_number:"CHG0012370",short_description:"Allow Okta SCIM provisioning traffic",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Okta Cloud",source_ip:"Multiple Okta IPs",destination_system:"Identity Provisioning API",destination_ip:"scim.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable automated user provisioning through Okta SCIM",requested_by:{name:"Identity Team",email:"identity@company.com",department:"IT Security"},atlas_risk_score:48,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Identity Engineering",email:"id.eng@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-07T10:00:00Z",updated_at:"2026-01-12T08:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-08T09:00:00Z",comments:"Okta IP ranges verified"}],additional_controls:["Bearer Token Auth","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rules and IP whitelist",change_window:null},{ticket_number:"CHG0012371",short_description:"Rejected - Overly permissive database access request",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Development Environment",source_ip:"0.0.0.0/0",destination_system:"Production Database",destination_ip:"10.20.10.100",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Developer needs quick access to debug production issue",requested_by:{name:"Dev User",email:"dev@company.com",department:"Engineering"},atlas_risk_score:95,risk_level:"CRITICAL",compliance_status:{passed:!1,frameworks:[],violations:["PCI-DSS 1.2.1","SOC2 CC6.1"]},assigned_to:null,state:"Rejected",created_at:"2026-01-11T15:00:00Z",updated_at:"2026-01-11T16:00:00Z",required_approvers:["Security Manager","CISO"],approval_history:[{approver:"Sarah Security",action:"Rejected",timestamp:"2026-01-11T16:00:00Z",comments:"0.0.0.0/0 source not allowed for production databases. Use VPN access instead."}],additional_controls:[],rejection_reason:"Overly permissive source CIDR violates security policy",estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012372",short_description:"Allow Snowflake data warehouse access",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Analytics Applications",source_ip:"10.60.0.0/16",destination_system:"Snowflake Cloud",destination_ip:"company.snowflakecomputing.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Connect analytics tools to Snowflake data warehouse",requested_by:{name:"BI Team",email:"bi@company.com",department:"Business Intelligence"},atlas_risk_score:39,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Data Platform",email:"data.platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T14:00:00Z",updated_at:"2026-01-07T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-03T14:01:00Z",comments:"SaaS analytics - low risk"}],additional_controls:["SSO Authentication","Role-Based Access"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012373",short_description:"Enable AWS PrivateLink for third-party SaaS",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"SaaS Provider PrivateLink",destination_ip:"vpce-xxx",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Secure private connectivity to SaaS provider without internet exposure",requested_by:{name:"Cloud Architecture",email:"cloud.arch@company.com",department:"Architecture"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T11:00:00Z",updated_at:"2026-01-12T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T11:01:00Z",comments:"PrivateLink - low risk"}],additional_controls:["VPC Endpoint Policy"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Delete VPC endpoint",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012374",short_description:"Block TikTok domains for corporate network",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Corporate Network",source_ip:"10.0.0.0/8",destination_system:"TikTok Domains",destination_ip:"Multiple",destination_port:443,protocol:"HTTPS",action:"DENY",business_justification:"Corporate policy prohibits TikTok access due to security concerns",requested_by:{name:"CISO Office",email:"ciso@company.com",department:"Security"},atlas_risk_score:null,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["Corporate Policy"],violations:[]},assigned_to:{name:"Web Security",email:"websec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T08:00:00Z",updated_at:"2026-01-05T12:00:00Z",required_approvers:["CISO"],approval_history:[{approver:"CISO",action:"Approved",timestamp:"2026-01-02T09:00:00Z",comments:"Corporate policy enforcement"}],additional_controls:["DNS Blocking","URL Filtering"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove DNS and URL filter entries",change_window:null},{ticket_number:"CHG0012375",short_description:"Allow Terraform Cloud API access for IaC deployments",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"CI/CD Pipeline",source_ip:"10.80.0.0/16",destination_system:"Terraform Cloud",destination_ip:"app.terraform.io",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable infrastructure as code deployments through Terraform Cloud",requested_by:{name:"Platform Engineering",email:"platform@company.com",department:"Platform"},atlas_risk_score:42,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"DevSecOps",email:"devsecops@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-10T16:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"API token rotation policy required"}],additional_controls:["API Token Authentication","Workspace Isolation"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012376",short_description:"Enable AWS Systems Manager access for EC2 management",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"EC2 Instances",source_ip:"10.30.0.0/16",destination_system:"AWS SSM Endpoints",destination_ip:"SSM Prefix List",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable secure SSH-less management of EC2 instances through Systems Manager",requested_by:{name:"Operations Team",email:"ops@company.com",department:"Operations"},atlas_risk_score:26,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"AWS Operations",email:"aws.ops@company.com",role:"Engineer"},state:"Implemented",created_at:"2025-12-30T10:00:00Z",updated_at:"2026-01-03T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2025-12-30T10:01:00Z",comments:"AWS managed service - low risk"}],additional_controls:["IAM Instance Profile","Session Logging"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove VPC endpoints",change_window:null},{ticket_number:"CHG0012377",short_description:"Cancelled - Duplicate request for Redis access",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Tier",source_ip:"10.30.30.0/24",destination_system:"Redis Cluster",destination_ip:"10.20.50.0/24",destination_port:6379,protocol:"TCP",action:"ALLOW",business_justification:"Application needs Redis access",requested_by:{name:"Developer",email:"dev@company.com",department:"Engineering"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:null,state:"Cancelled",created_at:"2026-01-11T14:00:00Z",updated_at:"2026-01-11T15:00:00Z",required_approvers:[],approval_history:[],cancellation_reason:"Duplicate of CHG0012354 - access already granted",additional_controls:[],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012378",short_description:"Allow PagerDuty webhook for incident notifications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"PagerDuty Cloud",source_ip:"Multiple PagerDuty IPs",destination_system:"Incident Webhook Handler",destination_ip:"incidents.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable PagerDuty to send incident webhooks for automation",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:46,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-08T09:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T10:00:00Z",comments:"Webhook signature validation confirmed"}],additional_controls:["Webhook Signature Validation","Rate Limiting"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012379",short_description:"Enable AWS Secrets Manager access for credential rotation",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"AWS Secrets Manager",destination_ip:"secretsmanager.us-east-1.amazonaws.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Implement automated credential rotation for security compliance",requested_by:{name:"Security Engineering",email:"sec.eng@company.com",department:"Security"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS","NIST"],violations:[]},assigned_to:{name:"AWS Security",email:"aws.sec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T11:00:00Z",updated_at:"2026-01-08T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T11:01:00Z",comments:"Security service - low risk"}],additional_controls:["VPC Endpoint","IAM Policy"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove VPC endpoint",change_window:null},{ticket_number:"CHG0012380",short_description:"Block Russia and Belarus IP ranges",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"RU/BY Country IP Ranges",source_ip:"Multiple Country CIDR Blocks",destination_system:"All Public Services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Geopolitical risk mitigation - no business operations in these regions",requested_by:{name:"CISO",email:"ciso@company.com",department:"Security"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Policy","Risk Management"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Senior Engineer"},state:"Implemented",created_at:"2026-01-05T08:00:00Z",updated_at:"2026-01-05T10:00:00Z",required_approvers:["CISO"],approval_history:[{approver:"CISO",action:"Approved",timestamp:"2026-01-05T08:30:00Z",comments:"Executive directive"}],additional_controls:["Geo-IP Blocking","Threat Feed Integration"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove geo-blocking rules",change_window:null},{ticket_number:"CHG0012381",short_description:"Allow Cloudflare WAF to origin servers",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"Cloudflare Edge",source_ip:"Cloudflare IP Ranges",destination_system:"Origin Web Servers",destination_ip:"10.10.5.0/24",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Route traffic through Cloudflare for DDoS protection and WAF",requested_by:{name:"Security Architecture",email:"sec.arch@company.com",department:"Security"},atlas_risk_score:55,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"Web Security",email:"websec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-09T14:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"Cloudflare authenticated origin pull required"}],additional_controls:["Authenticated Origin Pull","TLS 1.3"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Remove Cloudflare IP whitelist",change_window:null},{ticket_number:"CHG0012382",short_description:"On Hold - Pending vendor security assessment",category:"Network / Vendor Access",priority:3,priority_label:"Moderate",source_system:"New SaaS Vendor",source_ip:"203.0.113.100/32",destination_system:"Internal API",destination_ip:"10.10.10.50",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"New vendor integration for HR system",requested_by:{name:"HR IT",email:"hr.it@company.com",department:"HR"},atlas_risk_score:70,risk_level:"HIGH",compliance_status:{passed:!1,frameworks:[],violations:["Pending vendor SOC2 review"]},assigned_to:{name:"Vendor Security",email:"vendor.sec@company.com",role:"Analyst"},state:"On Hold",created_at:"2026-01-07T11:00:00Z",updated_at:"2026-01-12T09:00:00Z",required_approvers:["Security Manager","Vendor Manager"],approval_history:[],hold_reason:"Awaiting vendor SOC2 Type II report review",hold_until:"2026-01-20T00:00:00Z",additional_controls:["Pending security assessment"],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012383",short_description:"Allow Lambda functions to access RDS via VPC",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS Lambda",source_ip:"Lambda ENI IPs",destination_system:"RDS PostgreSQL",destination_ip:"10.20.10.0/24",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Serverless functions require database access for API backend",requested_by:{name:"Serverless Team",email:"serverless@company.com",department:"Engineering"},atlas_risk_score:40,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Cloud Team",email:"cloud@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T13:00:00Z",updated_at:"2026-01-12T15:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T10:00:00Z",comments:"Lambda security group configured correctly"}],additional_controls:["Lambda VPC Config","Security Group"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove Lambda from VPC",change_window:"2026-01-13T18:00:00Z to 2026-01-13T20:00:00Z"},{ticket_number:"CHG0012384",short_description:"Enable Azure Event Hub access for log streaming",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Azure VMs",source_ip:"10.50.0.0/16",destination_system:"Azure Event Hub",destination_ip:"eventhub.servicebus.windows.net",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Stream Azure logs to central logging platform",requested_by:{name:"Azure Team",email:"azure@company.com",department:"Cloud"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Azure Operations",email:"azure.ops@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-06T15:00:00Z",updated_at:"2026-01-10T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T15:01:00Z",comments:"Azure managed service"}],additional_controls:["Service Endpoint","NSG Rules"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove NSG rules",change_window:null},{ticket_number:"CHG0012385",short_description:"Block known malware C2 domains",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"Malware C2 Domains",destination_ip:"Multiple",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Block communication with known malware command and control infrastructure",requested_by:{name:"Threat Intelligence",email:"threat.intel@company.com",department:"Security"},atlas_risk_score:null,risk_level:"CRITICAL",compliance_status:{passed:!0,frameworks:["Security Policy"],violations:[]},assigned_to:{name:"SOC",email:"soc@company.com",role:"Analyst"},state:"Implemented",created_at:"2026-01-08T06:00:00Z",updated_at:"2026-01-08T07:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-08T06:01:00Z",comments:"Threat intelligence auto-block"}],additional_controls:["DNS Sinkhole","Threat Feed Integration","SIEM Alert"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove DNS sinkhole entries",change_window:null},{ticket_number:"CHG0012386",short_description:"Allow GCP Cloud Functions to access Cloud SQL",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"GCP Cloud Functions",source_ip:"Serverless VPC Connector",destination_system:"Cloud SQL PostgreSQL",destination_ip:"10.128.0.0/20",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Serverless functions need database connectivity",requested_by:{name:"GCP Team",email:"gcp@company.com",department:"Cloud"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"GCP Operations",email:"gcp.ops@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-10T10:00:00Z",updated_at:"2026-01-12T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-10T10:01:00Z",comments:"Internal GCP traffic"}],additional_controls:["VPC Connector","Firewall Rules"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove VPC connector",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012387",short_description:"Enable Twilio webhook for SMS notifications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Twilio Cloud",source_ip:"Twilio IP Ranges",destination_system:"SMS Webhook Handler",destination_ip:"sms.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Twilio webhooks for SMS status callbacks",requested_by:{name:"Communications Team",email:"comms@company.com",department:"Communications"},atlas_risk_score:50,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-11T09:00:00Z",updated_at:"2026-01-12T13:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T08:00:00Z",comments:"Request signature validation required"}],additional_controls:["Request Signature Validation","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:null},{ticket_number:"CHG0012388",short_description:"Allow Prometheus to scrape metrics from all namespaces",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Prometheus Server",source_ip:"10.90.5.0/24",destination_system:"All Kubernetes Pods",destination_ip:"10.30.0.0/16",destination_port:9090,protocol:"TCP",action:"ALLOW",business_justification:"Enable comprehensive metrics collection for observability",requested_by:{name:"Observability Team",email:"observability@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Team",email:"platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T14:00:00Z",updated_at:"2026-01-09T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T14:01:00Z",comments:"Monitoring traffic"}],additional_controls:["Network Policy","Service Account"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove network policy",change_window:null},{ticket_number:"CHG0012389",short_description:"Enable AWS KMS access for encryption key management",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"AWS KMS",destination_ip:"kms.us-east-1.amazonaws.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable encryption key management for data protection compliance",requested_by:{name:"Security Engineering",email:"sec.eng@company.com",department:"Security"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS","HIPAA"],violations:[]},assigned_to:{name:"Security Operations",email:"secops@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T09:00:00Z",updated_at:"2026-01-07T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-03T09:01:00Z",comments:"Security service - critical"}],additional_controls:["VPC Endpoint","Key Policy"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove VPC endpoint",change_window:null},{ticket_number:"CHG0012390",short_description:"Allow SendGrid for transactional email",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Email Service",source_ip:"10.30.40.0/24",destination_system:"SendGrid API",destination_ip:"api.sendgrid.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable transactional email delivery through SendGrid",requested_by:{name:"Communications",email:"comms@company.com",department:"Marketing"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","CAN-SPAM"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T16:00:00Z",updated_at:"2026-01-08T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T16:01:00Z",comments:"SaaS email service"}],additional_controls:["API Key Authentication","Rate Limiting"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012391",short_description:"Block BitTorrent traffic on corporate network",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Corporate Network",source_ip:"10.0.0.0/8",destination_system:"BitTorrent Peers",destination_ip:"0.0.0.0/0",destination_port:"6881-6889",protocol:"TCP/UDP",action:"DENY",business_justification:"Block P2P file sharing to prevent copyright infringement and data exfiltration",requested_by:{name:"IT Security",email:"it.security@company.com",department:"IT"},atlas_risk_score:null,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["Corporate Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T11:00:00Z",updated_at:"2026-01-06T09:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-02T14:00:00Z",comments:"Policy enforcement"}],additional_controls:["Application Control","Protocol Detection"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove application control rules",change_window:null},{ticket_number:"CHG0012392",short_description:"Enable HashiCorp Vault access for secrets management",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"HashiCorp Vault Cluster",destination_ip:"10.90.20.0/24",destination_port:8200,protocol:"TCP",action:"ALLOW",business_justification:"Enable centralized secrets management for applications",requested_by:{name:"Platform Security",email:"platform.sec@company.com",department:"Security"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"Security Engineering",email:"sec.eng@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T15:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T10:00:00Z",comments:"AppRole authentication configured"}],additional_controls:["TLS Encryption","AppRole Auth","Audit Logging"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove security group rules",change_window:"2026-01-14T10:00:00Z to 2026-01-14T14:00:00Z"},{ticket_number:"CHG0012393",short_description:"Allow Grafana access to Prometheus for dashboards",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Grafana Server",source_ip:"10.90.10.50",destination_system:"Prometheus Server",destination_ip:"10.90.5.100",destination_port:9090,protocol:"TCP",action:"ALLOW",business_justification:"Enable Grafana dashboards to query Prometheus metrics",requested_by:{name:"Observability Team",email:"observability@company.com",department:"SRE"},atlas_risk_score:22,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Monitoring Team",email:"monitoring@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T10:00:00Z",updated_at:"2026-01-09T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T10:01:00Z",comments:"Monitoring infrastructure"}],additional_controls:["Internal Only"],estimated_implementation_time:"15 minutes",actual_implementation_time:"12 minutes",rollback_plan:"Remove security group rule",change_window:null},{ticket_number:"CHG0012394",short_description:"Enable AWS ALB access logs to S3",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS ALB",source_ip:"ALB Internal",destination_system:"S3 Logging Bucket",destination_ip:"S3 Endpoint",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable ALB access logging for security and compliance",requested_by:{name:"Compliance Team",email:"compliance@company.com",department:"Compliance"},atlas_risk_score:20,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T13:00:00Z",updated_at:"2026-01-08T16:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T13:01:00Z",comments:"Logging configuration"}],additional_controls:["S3 Bucket Policy","Log Retention"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Disable ALB access logging",change_window:null},{ticket_number:"CHG0012395",short_description:"Draft - New microservice API access request",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"New Checkout Service",source_ip:"10.30.50.0/24",destination_system:"Payment Service",destination_ip:"10.30.25.0/24",destination_port:8443,protocol:"HTTPS",action:"ALLOW",business_justification:"New checkout service needs to call payment service APIs",requested_by:{name:"E-commerce Team",email:"ecommerce@company.com",department:"Engineering"},atlas_risk_score:52,risk_level:"MEDIUM",compliance_status:{passed:null,frameworks:[],violations:[]},assigned_to:null,state:"Draft",created_at:"2026-01-12T16:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:[],approval_history:[],additional_controls:[],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012396",short_description:"Allow Jira webhook for issue tracking integration",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Atlassian Jira Cloud",source_ip:"Atlassian IP Ranges",destination_system:"Issue Webhook Handler",destination_ip:"issues.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Jira webhooks for automated issue tracking",requested_by:{name:"Project Management",email:"pm@company.com",department:"PMO"},atlas_risk_score:44,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-10T11:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T09:00:00Z",comments:"Webhook validation configured"}],additional_controls:["Webhook Signature Validation"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012397",short_description:"Block Zoom for regulated departments",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Regulated Department Networks",source_ip:"10.200.0.0/16",destination_system:"Zoom Cloud",destination_ip:"Zoom Domains",destination_port:443,protocol:"HTTPS",action:"DENY",business_justification:"Compliance requirement prohibits certain video conferencing for regulated departments",requested_by:{name:"Compliance",email:"compliance@company.com",department:"Compliance"},atlas_risk_score:null,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["Regulatory Compliance"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-11T08:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Compliance Manager","Security Manager"],approval_history:[{approver:"Compliance Manager",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Regulatory requirement"},{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T14:00:00Z",comments:"Implementation plan reviewed"}],additional_controls:["URL Filtering","DNS Blocking"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove URL filter and DNS block",change_window:null},{ticket_number:"CHG0012398",short_description:"Enable AWS EFS access for shared storage",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application EC2 Instances",source_ip:"10.30.0.0/16",destination_system:"AWS EFS",destination_ip:"10.30.100.0/24",destination_port:2049,protocol:"TCP",action:"ALLOW",business_justification:"Enable shared file storage for application cluster",requested_by:{name:"Application Team",email:"app@company.com",department:"Engineering"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Storage Team",email:"storage@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T09:00:00Z",updated_at:"2026-01-12T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T09:01:00Z",comments:"Internal storage - low risk"}],additional_controls:["NFS Security Group","IAM Authorization"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove mount targets",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012399",short_description:"Allow New Relic APM agent communication",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Servers",source_ip:"10.30.0.0/16",destination_system:"New Relic Collector",destination_ip:"collector.newrelic.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable APM monitoring through New Relic",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Monitoring Team",email:"monitoring@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-06T14:00:00Z",updated_at:"2026-01-10T09:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T14:01:00Z",comments:"Monitoring egress"}],additional_controls:["License Key Auth"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012400",short_description:"Enable inter-region database replication for DR",category:"Network / Transit Gateway",priority:1,priority_label:"Critical",source_system:"US-East Database VPC",source_ip:"10.20.0.0/16",destination_system:"US-West Database VPC",destination_ip:"10.120.0.0/16",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Critical DR requirement - cross-region database replication for business continuity",requested_by:{name:"DR Team",email:"dr@company.com",department:"Infrastructure"},atlas_risk_score:60,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","Business Continuity","HIPAA"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"Senior DBA"},state:"Awaiting Approval",created_at:"2026-01-12T09:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager","CISO","Database Manager"],approval_history:[{approver:"Database Manager",action:"Approved",timestamp:"2026-01-12T11:00:00Z",comments:"Replication config verified"}],additional_controls:["TLS 1.3 Encryption","Inter-Region TGW Peering","Replication Monitoring"],estimated_implementation_time:"6 hours",actual_implementation_time:null,rollback_plan:"Remove TGW peering and replication configuration",change_window:"2026-01-18T02:00:00Z to 2026-01-18T10:00:00Z"}],_f={tickets:hf},yf=e=>({Draft:"awaiting","Awaiting Approval":"awaiting",Approved:"approved",Implementing:"implementing",Implemented:"completed",Monitoring:"completed",Scheduled:"approved",Rejected:"rejected",Cancelled:"rejected","On Hold":"awaiting"})[e]||"awaiting",vf=e=>e===1?"critical":e===2?"high":e===3?"medium":"low",xf=e=>({"Network / Firewall Change":"firewall_rule","Network / WAF Change":"firewall_rule","Network / VPN Access":"vpn","Network / Transit Gateway":"routing","Network / VPC Peering":"routing","Network / Vendor Access":"firewall_rule","Network / Load Balancer":"load_balancer","Security / Emergency Block":"firewall_rule","Security / Threat Response":"firewall_rule","Security / Access Revocation":"security_group","Compliance / Audit Remediation":"security_group","Compliance / Policy Update":"other"})[e]||"other",bf=e=>({LOW:"low",MEDIUM:"medium",HIGH:"high",CRITICAL:"critical",EMERGENCY:"critical"})[e]||"medium",wf=(e,t)=>{var s,o,i,l,c,d,u;const n=e.atlas_risk_score??50,a=bf(e.risk_level);return{id:`TKT-${String(t+1).padStart(3,"0")}`,serviceNowId:e.ticket_number,title:e.short_description,description:e.business_justification,status:yf(e.state),priority:vf(e.priority),category:xf(e.category),changeType:e.action==="DENY"?"delete":"add",assignee:((s=e.assigned_to)==null?void 0:s.name)||"Unassigned",requester:((o=e.requested_by)==null?void 0:o.email)||"unknown@company.com",createdAt:e.created_at,updatedAt:e.updated_at,scheduledAt:(i=e.change_window)==null?void 0:i.split(" to ")[0],completedAt:e.state==="Implemented"?e.updated_at:void 0,affectedResources:[{id:`res-${t}-src`,type:"Source System",name:e.source_system,platform:"aws"},{id:`res-${t}-dst`,type:"Destination System",name:e.destination_system,platform:"aws"}],riskAssessment:{score:n,level:a,factors:[{name:"Risk Score",impact:n>60?"negative":n>40?"neutral":"positive",weight:n,description:`Atlas risk score: ${n}`},...((c=(l=e.compliance_status)==null?void 0:l.violations)==null?void 0:c.length)>0?[{name:"Compliance Violations",impact:"negative",weight:20,description:`${e.compliance_status.violations.length} compliance violations`}]:[],...((d=e.additional_controls)==null?void 0:d.length)>0?[{name:"Additional Controls",impact:"positive",weight:-10,description:`Controls: ${e.additional_controls.join(", ")}`}]:[]],recommendation:a==="critical"?"Requires CISO approval and detailed review.":a==="high"?"Proceed with caution. Implement during maintenance window.":a==="medium"?"Standard approval process. Monitor after implementation.":"Low risk. Can proceed with minimal oversight."},approvalSteps:((u=e.approval_history)==null?void 0:u.map((m,g)=>({id:`step-${g+1}`,name:m.approver==="SYSTEM"?"Auto Approval":"Manual Review",approver:m.approver,status:m.action.toLowerCase().includes("approved")?"approved":m.action.toLowerCase().includes("rejected")?"rejected":"pending",timestamp:m.timestamp,comments:m.comments})))||[],rollbackPlan:e.rollback_plan??void 0}},st=_f.tickets.map(wf),_t=e=>new Promise(t=>setTimeout(t,e)),Ht={async getTickets(e){var n,a,s;await _t(500);let t=[...st];if((n=e==null?void 0:e.status)!=null&&n.length&&(t=t.filter(o=>e.status.includes(o.status))),(a=e==null?void 0:e.priority)!=null&&a.length&&(t=t.filter(o=>e.priority.includes(o.priority))),(s=e==null?void 0:e.category)!=null&&s.length&&(t=t.filter(o=>e.category.includes(o.category))),e!=null&&e.search){const o=e.search.toLowerCase();t=t.filter(i=>i.title.toLowerCase().includes(o)||i.description.toLowerCase().includes(o)||i.serviceNowId.toLowerCase().includes(o))}return t.sort((o,i)=>new Date(i.createdAt).getTime()-new Date(o.createdAt).getTime())},async getTicketById(e){return await _t(300),st.find(t=>t.id===e)||null},async getTicketsByStatus(e){return await _t(300),st.filter(t=>t.status===e)},async createTicket(e){await _t(1e3);const t=tc(e),n={id:`TKT-${String(st.length+1).padStart(3,"0")}`,serviceNowId:`CHG00${12350+st.length}`,title:e.title,description:e.description,status:"awaiting",priority:e.priority,category:e.category,changeType:e.changeType,assignee:"Unassigned",requester:"current.user@company.com",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),scheduledAt:e.scheduledAt,affectedResources:[],riskAssessment:t,approvalSteps:[{id:"step-1",name:"Security Review",approver:"Security Team",status:"pending"},{id:"step-2",name:"Manager Approval",approver:"Network Manager",status:"pending"}],rollbackPlan:e.rollbackPlan};return st.push(n),n},async updateTicketStatus(e,t){await _t(500);const n=st.find(a=>a.id===e);return n&&(n.status=t,n.updatedAt=new Date().toISOString(),t==="completed"&&(n.completedAt=new Date().toISOString())),n||null},async approveTicketStep(e,t,n){await _t(500);const a=st.find(s=>s.id===e);if(a){const s=a.approvalSteps.find(i=>i.id===t);s&&(s.status="approved",s.timestamp=new Date().toISOString(),s.comments=n),a.updatedAt=new Date().toISOString(),a.approvalSteps.every(i=>i.status==="approved")&&(a.status="approved")}return a||null},async rejectTicketStep(e,t,n){await _t(500);const a=st.find(s=>s.id===e);if(a){const s=a.approvalSteps.find(o=>o.id===t);s&&(s.status="rejected",s.timestamp=new Date().toISOString(),s.comments=n),a.status="rejected",a.updatedAt=new Date().toISOString()}return a||null},async calculateRisk(e){return await _t(800),tc(e)}};function tc(e){const t=[];let n=50;e.changeType==="delete"?(t.push({name:"Rule Removal",impact:"positive",weight:-20,description:"Removing rules generally reduces attack surface"}),n-=20):e.changeType==="add"&&(t.push({name:"New Rule",impact:"negative",weight:15,description:"New rules may increase exposure"}),n+=15),e.action==="deny"&&(t.push({name:"Deny Action",impact:"positive",weight:-15,description:"Deny rules improve security posture"}),n-=15),e.priority==="critical"&&(t.push({name:"Critical Priority",impact:"negative",weight:20,description:"Expedited changes may miss thorough review"}),n+=20),(e.sourceIp==="0.0.0.0/0"||e.sourceIp==="any")&&(t.push({name:"Any Source",impact:"negative",weight:30,description:"Allows traffic from any source IP"}),n+=30);const a=["80","443","22","3389"];e.port&&a.includes(e.port)&&(t.push({name:"Standard Port",impact:"positive",weight:-10,description:"Uses well-known standard port"}),n-=10);const s=Math.max(0,Math.min(100,n));let o,i;return s<30?(o="low",i="Low risk change. Can proceed with standard approval process."):s<50?(o="medium",i="Moderate risk. Recommend implementing during maintenance window."):s<75?(o="high",i="High risk change. Requires CAB approval and detailed rollback plan."):(o="critical",i="Critical risk. Requires CISO approval and must include monitoring plan."),{score:s,level:o,factors:t,recommendation:i}}function Sf(){const[e,t]=_.useState([]),[n,a]=_.useState([]),[s,o]=_.useState([]),[i,l]=_.useState({compliance:"0%",uptime:"0%",avgLatency:"0ms"}),[c,d]=_.useState(null),[u,m]=_.useState(!0),[g,v]=_.useState(null);return _.useEffect(()=>{(async()=>{try{m(!0);const[y,O,h,p,f]=await Promise.all([_g(),yg(),vg(),Sg(),kg()]);t(y),a(O),o(h),l(p),d(f),v(null)}catch(y){v(y instanceof Error?y:new Error("Failed to fetch dashboard data"))}finally{m(!1)}})()},[]),{metrics:e,recentActivity:n,platformDistribution:s,summaryStats:i,networkStats:c,isLoading:u,error:g}}const kf=({currentTime:e,userName:t="Admin"})=>r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-2xl font-bold text-white",children:["Welcome back, ",t]}),r.jsx("p",{className:"text-slate-400",children:"Here's what's happening across your infrastructure"})]}),r.jsx(qm,{time:e})]}),Cf=({metrics:e})=>r.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:e.map((t,n)=>r.jsx(Qm,{label:t.label,value:t.value,change:t.change,trend:t.trend,icon:t.icon,color:t.color},n))}),Af=({platforms:e,summaryStats:t})=>r.jsxs(R,{padding:"none",className:"overflow-hidden",children:[r.jsx("div",{className:"p-4 border-b border-slate-700",children:r.jsx(J,{title:"Platform Distribution"})}),r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"space-y-4",children:e.map((n,a)=>r.jsx(xm,{label:n.name,value:n.value,color:n.color},a))}),r.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700 grid grid-cols-3 gap-4",children:[r.jsx(Ts,{label:"Compliance",value:t.compliance,valueColor:"text-emerald-400"}),r.jsx(Ts,{label:"Uptime",value:t.uptime,valueColor:"text-cyan-400"}),r.jsx(Ts,{label:"Avg Latency",value:t.avgLatency,valueColor:"text-purple-400"})]})]})]}),Nf=({activities:e})=>r.jsxs(R,{padding:"none",className:"overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[r.jsx("h3",{className:"font-bold text-white",children:"Recent Activity"}),r.jsx("span",{className:"text-xs text-slate-400",children:"Last 24 hours"})]}),r.jsx("div",{className:"divide-y divide-slate-700",children:e.map(t=>r.jsx(jf,{activity:t},t.id))})]}),jf=({activity:e})=>r.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Ii,{status:e.status,size:"sm"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-white text-sm font-medium",children:e.action}),r.jsxs("div",{className:"text-xs text-slate-400",children:[r.jsx("span",{className:"font-mono text-cyan-400",children:e.target}),r.jsx("span",{className:"mx-2",children:""}),r.jsx("span",{children:e.user})]})]})]}),r.jsx("span",{className:"text-xs text-slate-500",children:e.time})]})}),Tf=({onNavigate:e})=>{const t=[{id:"create-rule",label:"Create Rule",description:"Generate new firewall rules",icon:"",color:"bg-blue-500",onClick:()=>e("rule-generator")},{id:"validate-rules",label:"Validate Rules",description:"Check rule syntax and security",icon:"",color:"bg-green-500",onClick:()=>e("validation")},{id:"run-path-analysis",label:"Path Analysis",description:"Trace network paths",icon:"",color:"bg-purple-500",onClick:()=>e("path-analysis")},{id:"view-tickets",label:"View Tickets",description:"Check ServiceNow tickets",icon:"",color:"bg-amber-500",onClick:()=>e("tickets")},{id:"compliance-scan",label:"Run Compliance",description:"Execute compliance scan",icon:"",color:"bg-red-500",onClick:()=>e("compliance")},{id:"cloud-resources",label:"Cloud Resources",description:"Manage VPCs and security groups",icon:"",color:"bg-cyan-500",onClick:()=>e("cloud-management")}];return r.jsx(R,{className:"bg-white shadow-lg h-full",children:r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(n=>r.jsxs(G,{variant:"secondary",className:"flex flex-col items-start p-3 h-auto text-left hover:bg-gray-50",onClick:n.onClick,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`w-8 h-8 ${n.color} rounded-lg flex items-center justify-center text-white text-sm`,children:n.icon}),r.jsx("span",{className:"font-medium text-gray-900",children:n.label})]}),r.jsx("span",{className:"text-xs text-gray-500 ml-10",children:n.description})]},n.id))})]})})},Ef=e=>e<.1?"success":e<1?"warning":"error",dn=e=>e<60?"success":e<80?"warning":"error",Pf=({stats:e})=>{const t=Ef(e.packetDropRate);return r.jsx(R,{className:"bg-white shadow-lg h-full",children:r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Statistics"}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Packet Drop Rate"}),r.jsxs(ae,{variant:t,children:[e.packetDropRate.toFixed(2),"%"]})]}),r.jsx(er,{value:Math.min(e.packetDropRate*10,100),max:100,color:t==="success"?"green":t==="warning"?"yellow":"red"}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t==="success"&&"Excellent - Network is performing well",t==="warning"&&"Elevated - Monitor for potential issues",t==="error"&&"Critical - Investigate immediately"]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Throughput"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[r.jsxs("div",{className:"text-lg font-bold text-green-600",children:[e.throughput.ingress.toFixed(1)," Gbps"]}),r.jsx("div",{className:"text-xs text-gray-500",children:"Ingress"})]}),r.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[r.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[e.throughput.egress.toFixed(1)," Gbps"]}),r.jsx("div",{className:"text-xs text-gray-500",children:"Egress"})]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Connections"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-xl font-bold text-gray-900",children:e.connections.active.toLocaleString()}),r.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"active"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("span",{className:"text-xl font-bold text-red-600",children:e.connections.blocked.toLocaleString()}),r.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"blocked/hr"})]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Latency"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[r.jsxs("div",{className:"font-medium text-gray-900",children:[e.latency.avg,"ms"]}),r.jsx("div",{className:"text-xs text-gray-500",children:"Avg"})]}),r.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[r.jsxs("div",{className:"font-medium text-gray-900",children:[e.latency.p95,"ms"]}),r.jsx("div",{className:"text-xs text-gray-500",children:"P95"})]}),r.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[r.jsxs("div",{className:"font-medium text-gray-900",children:[e.latency.p99,"ms"]}),r.jsx("div",{className:"text-xs text-gray-500",children:"P99"})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Firewall Health"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[r.jsx("span",{children:"CPU"}),r.jsxs("span",{className:dn(e.firewallHealth.cpu)==="error"?"text-red-600":"",children:[e.firewallHealth.cpu,"%"]})]}),r.jsx(er,{value:e.firewallHealth.cpu,max:100,color:dn(e.firewallHealth.cpu)==="success"?"blue":dn(e.firewallHealth.cpu)==="warning"?"yellow":"red"})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[r.jsx("span",{children:"Memory"}),r.jsxs("span",{className:dn(e.firewallHealth.memory)==="error"?"text-red-600":"",children:[e.firewallHealth.memory,"%"]})]}),r.jsx(er,{value:e.firewallHealth.memory,max:100,color:dn(e.firewallHealth.memory)==="success"?"blue":dn(e.firewallHealth.memory)==="warning"?"yellow":"red"})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[r.jsx("span",{children:"Sessions"}),r.jsxs("span",{children:[e.firewallHealth.sessions,"%"]})]}),r.jsx(er,{value:e.firewallHealth.sessions,max:100,color:"purple"})]})]})]})]})})},If=({onNavigate:e})=>{const t=Au(),{metrics:n,recentActivity:a,platformDistribution:s,summaryStats:o,networkStats:i,isLoading:l}=Sf(),c=d=>{e&&e(d)};return l?r.jsx(re,{children:r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-slate-400",children:"Loading dashboard..."})})}):r.jsxs(re,{children:[r.jsx(kf,{currentTime:t}),r.jsx(Cf,{metrics:n}),r.jsx("div",{className:"mb-6",children:r.jsx(Tf,{onNavigate:c})}),r.jsxs(Li,{cols:3,children:[r.jsx(Af,{platforms:s,summaryStats:o}),i&&r.jsx(Pf,{stats:i}),r.jsx(Nf,{activities:a})]})]})};function Lf(){const[e,t]=_.useState([]),[n,a]=_.useState(null),[s,o]=_.useState(!0),[i,l]=_.useState(null);_.useEffect(()=>{(async()=>{try{o(!0);const g=await Eg();t(g),l(null)}catch(g){l(g instanceof Error?g:new Error("Failed to fetch compliance data"))}finally{o(!1)}})()},[]);const c=_.useMemo(()=>ju(e),[e]),d=_.useMemo(()=>{if(e.length===0)return 0;const m=e.reduce((g,v)=>g+v.score,0);return Number((m/e.length).toFixed(1))},[e]);return{frameworks:e,selectedFramework:n,stats:c,overallScore:d,isLoading:s,error:i,selectFramework:m=>{a((n==null?void 0:n.id)===(m==null?void 0:m.id)?null:m)}}}const Rf=({score:e})=>r.jsxs(R,{className:"flex flex-col items-center justify-center",children:[r.jsx("div",{className:"mb-4",children:r.jsx(Cm,{score:e,size:"lg"})}),r.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Overall Compliance"}),r.jsx(ae,{variant:"success",children:r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{children:""}),r.jsx("span",{children:"Compliant"})]})})]}),Of=({totalControls:e,passedControls:t,failedControls:n,totalFrameworks:a,compliantFrameworks:s,totalViolations:o,mediumViolations:i,lowViolations:l})=>r.jsxs("div",{className:"col-span-3 grid grid-cols-3 gap-6",children:[r.jsx(nc,{label:"Total Controls",icon:"",value:e.toLocaleString(),details:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-emerald-400 text-sm",children:[" ",t.toLocaleString()," passed"]}),r.jsx("span",{className:"text-slate-600",children:"|"}),r.jsxs("span",{className:"text-red-400 text-sm",children:[" ",n," failed"]})]})}),r.jsx(nc,{label:"Frameworks Tracked",icon:"",value:a.toString(),details:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-emerald-400 text-sm",children:[s," compliant"]}),r.jsx("span",{className:"text-slate-600",children:"|"}),r.jsx("span",{className:"text-slate-400 text-sm",children:"0 at risk"})]})}),r.jsx(Df,{totalViolations:o,mediumViolations:i,lowViolations:l})]}),nc=({label:e,icon:t,value:n,details:a})=>r.jsxs(R,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("span",{className:"text-slate-400",children:e}),r.jsx("span",{className:"text-2xl",children:t})]}),r.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:n}),a]}),Df=({totalViolations:e,mediumViolations:t,lowViolations:n})=>r.jsxs("div",{className:"bg-gradient-to-br from-red-900/50 to-red-800/30 rounded-xl border border-red-500/30 p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("span",{className:"text-red-400",children:"Open Violations"}),r.jsx("span",{className:"text-2xl",children:""})]}),r.jsx("div",{className:"text-4xl font-bold text-red-400 mb-2",children:e}),r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsxs("span",{className:"text-amber-400",children:[t," medium"]}),r.jsx("span",{className:"text-slate-600",children:"|"}),r.jsxs("span",{className:"text-blue-400",children:[n," low"]})]})]}),Mf=({framework:e,isSelected:t,onClick:n})=>{const a=Ri(e.color);return r.jsxs("div",{onClick:n,className:`bg-slate-800 rounded-xl border-2 overflow-hidden cursor-pointer transition-all hover:scale-[1.02] ${t?`${a.border} shadow-lg`:"border-slate-700 hover:border-slate-600"}`,children:[r.jsx(Gf,{name:e.name,fullName:e.fullName,icon:e.icon,gradient:a.gradient}),r.jsx(Vf,{score:e.score,passedControls:e.passedControls,totalControls:e.totalControls,failedControls:e.failedControls,violationsCount:e.violations.length})]})},Gf=({name:e,fullName:t,icon:n,gradient:a})=>r.jsx("div",{className:`p-4 bg-gradient-to-r ${a}`,children:r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-3xl",children:n}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:e}),r.jsx("p",{className:"text-xs text-white/70 truncate max-w-[150px]",children:t})]})]})})}),Vf=({score:e,passedControls:t,totalControls:n,failedControls:a,violationsCount:s})=>{const o=e>=98?"#10b981":e>=95?"#06b6d4":"#f59e0b";return r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"relative w-20 h-20",children:[r.jsxs("svg",{className:"w-20 h-20 -rotate-90",children:[r.jsx("circle",{cx:"40",cy:"40",r:"35",fill:"none",stroke:"rgba(255,255,255,0.1)",strokeWidth:"6"}),r.jsx("circle",{cx:"40",cy:"40",r:"35",fill:"none",stroke:o,strokeWidth:"6",strokeDasharray:`${e/100*220} 220`,strokeLinecap:"round"})]}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsxs("span",{className:"text-2xl font-bold text-white",children:[e,"%"]})})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Controls"}),r.jsxs("div",{className:"text-lg font-bold text-white",children:[t,"/",n]}),r.jsx("div",{className:`text-xs ${a>0?"text-red-400":"text-emerald-400"}`,children:a>0?`${a} failed`:"All passed"})]})]}),r.jsx(Hf,{count:s})]})},Hf=({count:e})=>r.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${e>0?"bg-red-500/10":"bg-emerald-500/10"}`,children:[r.jsx("span",{className:`text-sm font-medium ${e>0?"text-red-400":"text-emerald-400"}`,children:e>0?" Violations":" No Violations"}),r.jsx("span",{className:`text-lg font-bold ${e>0?"text-red-400":"text-emerald-400"}`,children:e})]}),Ff=({frameworks:e,selectedFramework:t,onSelectFramework:n})=>r.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:e.map(a=>r.jsx(Mf,{framework:a,isSelected:(t==null?void 0:t.id)===a.id,onClick:()=>n(a)},a.id))}),Wf=({framework:e,onClose:t})=>{const n=Ri(e.color);return r.jsxs(R,{padding:"none",className:"overflow-hidden",children:[r.jsx(Uf,{icon:e.icon,name:e.name,violationsCount:e.violations.length,gradient:n.gradient,onClose:t}),r.jsx("div",{className:"divide-y divide-slate-700",children:e.violations.map(a=>r.jsx(zf,{violation:a},a.id))})]})},Uf=({icon:e,name:t,violationsCount:n,gradient:a,onClose:s})=>r.jsxs("div",{className:`p-4 bg-gradient-to-r ${a} flex items-center justify-between`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:e}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-bold text-white",children:[t," Violations"]}),r.jsxs("p",{className:"text-sm text-white/70",children:[n," open violations requiring attention"]})]})]}),r.jsx("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Close violation details",children:r.jsx(Cu,{className:"w-5 h-5 text-white"})})]}),zf=({violation:e})=>r.jsxs("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("span",{className:"font-mono text-sm font-bold text-cyan-400",children:e.id}),r.jsx(ae,{variant:e.severity==="medium"?"warning":"info",size:"sm",children:e.severity.toUpperCase()}),r.jsx("span",{className:"text-xs text-slate-500 font-mono",children:e.control})]}),r.jsx("p",{className:"text-white font-medium mb-1",children:e.description}),r.jsx("div",{className:"flex items-center gap-4 text-sm",children:r.jsxs("span",{className:"text-slate-400",children:["Resource:"," ",r.jsx("span",{className:"font-mono text-slate-300",children:e.resource})]})})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(G,{variant:"ghost",size:"sm",children:"View Remediation"})})]}),r.jsxs("div",{className:"mt-3 p-3 bg-slate-900/50 rounded-lg",children:[r.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Recommended Remediation"}),r.jsx("p",{className:"text-sm text-slate-300",children:e.remediation})]})]}),$f=({framework:e,onClose:t})=>{const n=Ri(e.color);return r.jsxs(R,{padding:"none",className:"overflow-hidden",children:[r.jsxs("div",{className:`p-4 bg-gradient-to-r ${n.gradient} flex items-center justify-between`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:e.icon}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-bold text-white",children:[e.name," - Fully Compliant"]}),r.jsxs("p",{className:"text-sm text-white/70",children:["All ",e.totalControls," controls are passing"]})]})]}),r.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Close framework details",children:r.jsx(Cu,{className:"w-5 h-5 text-white"})})]}),r.jsxs("div",{className:"p-6",children:[r.jsx("h4",{className:"text-sm font-bold text-slate-400 uppercase mb-4",children:"Category Breakdown"}),r.jsx("div",{className:"grid grid-cols-5 gap-4",children:e.categories.map((a,s)=>r.jsx(Bf,{category:a},s))})]})]})},Bf=({category:e})=>r.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-4 text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-emerald-400 mb-1",children:[e.score,"%"]}),r.jsx("div",{className:"text-xs text-slate-400 mb-2",children:e.name}),r.jsxs("div",{className:"text-xs text-slate-500",children:[e.controls," controls"]})]}),Zf=({frameworks:e})=>{const[t,n]=_.useState(!1),[a,s]=_.useState(null),o=async l=>{n(!0);try{const{filename:c,content:d,mimeType:u}=await Ig(e,l),m=new Blob([d],{type:u}),g=URL.createObjectURL(m),v=document.createElement("a");v.href=g,v.download=c,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(g),s({format:l,timestamp:new Date().toISOString()})}catch(c){console.error("Export failed:",c)}finally{n(!1)}},i=[{format:"json",label:"JSON",description:"Full report with all data",icon:"{}"},{format:"csv",label:"CSV",description:"Violations spreadsheet",icon:"CSV"},{format:"pdf",label:"PDF",description:"Executive summary",icon:"PDF"}];return r.jsx(R,{className:"bg-white shadow-lg",children:r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Reports"}),a&&r.jsxs(ae,{variant:"success",className:"text-xs",children:["Last: ",a.format.toUpperCase()," at"," ",new Date(a.timestamp).toLocaleTimeString()]})]}),r.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Export compliance data for ",e.length," frameworks with"," ",e.reduce((l,c)=>l+c.violations.length,0)," total violations."]}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:i.map(l=>r.jsxs("button",{onClick:()=>o(l.format),disabled:t,className:`flex flex-col items-center p-4 border rounded-lg hover:bg-gray-50
                         disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:[r.jsx("span",{className:`w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center
                              text-lg font-bold text-gray-600 mb-2`,children:l.icon}),r.jsx("span",{className:"font-medium text-gray-900",children:l.label}),r.jsx("span",{className:"text-xs text-gray-500 text-center",children:l.description})]},l.format))}),t&&r.jsxs("div",{className:"mt-4 flex items-center justify-center text-sm text-gray-500",children:[r.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Generating report..."]}),r.jsxs("div",{className:"mt-4 pt-4 border-t",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Schedule Reports"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G,{variant:"secondary",className:"text-sm",children:"Weekly Summary"}),r.jsx(G,{variant:"secondary",className:"text-sm",children:"Monthly Audit"})]})]})]})})},qf=()=>{const{frameworks:e,selectedFramework:t,stats:n,overallScore:a,isLoading:s,selectFramework:o}=Lf();return s?r.jsx(re,{children:r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-slate-400",children:"Loading compliance data..."})})}):r.jsxs(re,{children:[r.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[r.jsx(Rf,{score:a}),r.jsx(Of,{totalControls:n.totalControls,passedControls:n.passedControls,failedControls:n.failedControls,totalFrameworks:e.length,compliantFrameworks:n.compliantFrameworks,totalViolations:n.totalViolations,mediumViolations:n.mediumViolations,lowViolations:n.lowViolations})]}),r.jsx(Ff,{frameworks:e,selectedFramework:t,onSelectFramework:o}),t&&t.violations.length>0&&r.jsx(Wf,{framework:t,onClose:()=>o(null)}),t&&t.violations.length===0&&r.jsx($f,{framework:t,onClose:()=>o(null)}),r.jsx("div",{className:"mt-6",children:r.jsx(Zf,{frameworks:e})})]})},Kf=(e,t,n)=>Math.max(t,Math.min(n,e)),ta=(e,t,n)=>{const a=(Math.random()-.5)*n;return Kf(e+a,t.min,t.max)};function Qf(){const[e,t]=_.useState({activeConnections:49,ingress:24,egress:18,firewallCpu:67}),[n,a]=_.useState(!0);_.useEffect(()=>{(async()=>{try{const i=await xg();t(i)}finally{a(!1)}})()},[]),_.useEffect(()=>{const o=setInterval(()=>{t(i=>({activeConnections:ta(i.activeConnections,Xr.activeConnections,4),ingress:ta(i.ingress,Xr.ingress,3),egress:ta(i.egress,Xr.egress,2),firewallCpu:ta(i.firewallCpu,Xr.firewallCpu,5)}))},Pi.REAL_TIME);return()=>clearInterval(o)},[]);const s=_.useCallback(()=>e.firewallCpu>Kl.CRITICAL?"critical":e.firewallCpu>Kl.WARNING?"warning":"normal",[e.firewallCpu]);return{metrics:e,isLoading:n,getFirewallCpuStatus:s}}function Yf(){const[e,t]=_.useState(()=>Cg());_.useEffect(()=>{const s=setInterval(()=>{if(Math.random()>.7){const o=Ag(),i=Ng(o);t(l=>[i,...l].slice(0,xu.MAX_ALERTS))}},Pi.ALERTS);return()=>clearInterval(s)},[]);const n=_.useCallback(s=>{t(o=>o.map(i=>i.id===s?{...i,acknowledged:!0}:i))},[]),a=Nu(e);return{alerts:e,alertCounts:a,acknowledgeAlert:n}}const Xf=({currentTime:e,refreshInterval:t=2})=>r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Nm,{}),r.jsxs("span",{className:"text-slate-400",children:["Auto-refresh: ",t,"s"]})]}),r.jsx(Km,{time:e})]}),Jf=({metrics:e,firewallCpuStatus:t})=>r.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[r.jsx(Jr,{value:Math.round(e.activeConnections),label:"Active Connections",sublabel:"24,567 / 50,000",status:"normal",icon:""}),r.jsx(Jr,{value:Math.round(e.ingress),label:"Ingress Traffic",sublabel:"2.4 Gbps",status:"good",icon:""}),r.jsx(Jr,{value:Math.round(e.egress),label:"Egress Traffic",sublabel:"1.8 Gbps",status:"good",icon:""}),r.jsx(Jr,{value:Math.round(e.firewallCpu),label:"Firewall CPU",sublabel:"pa-fw-prod-east",status:t,icon:""})]}),e1=()=>{const[e,t]=_.useState([]),[n,a]=_.useState([]);return _.useEffect(()=>{(async()=>{const[o,i]=await Promise.all([bg(),wg()]);t(o),a(i)})()},[]),r.jsxs("div",{className:"col-span-1 space-y-4",children:[r.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[r.jsx(Su,{className:"w-5 h-5 text-cyan-400"}),"System Metrics"]}),r.jsx(t1,{stats:e}),r.jsx(n1,{platforms:n})]})},t1=({stats:e})=>{const t=n=>{const a={red:"from-red-500/20 to-red-600/10",amber:"from-amber-500/20 to-amber-600/10",emerald:"from-emerald-500/20 to-emerald-600/10",cyan:"from-cyan-500/20 to-cyan-600/10",purple:"from-purple-500/20 to-purple-600/10"};return a[n]||a.cyan};return r.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.map((n,a)=>r.jsx(Ym,{label:n.label,value:n.value,unit:n.unit,icon:n.icon,trend:n.trend,colorClass:t(n.color)},a))})},n1=({platforms:e})=>r.jsxs(R,{variant:"bordered",className:"mt-4",children:[r.jsx("h4",{className:"text-white font-semibold mb-4",children:"Platform Status"}),r.jsx("div",{className:"space-y-3",children:e.map(t=>r.jsx(jm,{name:t.name,status:t.status,latency:t.latency,icon:t.icon},t.name))})]}),r1=({alerts:e,onAcknowledge:t})=>{const n=Nu(e);return r.jsxs(R,{variant:"bordered",padding:"none",className:"col-span-2 rounded-2xl overflow-hidden",children:[r.jsx(a1,{alertCounts:n}),r.jsx(s1,{alerts:e,onAcknowledge:t}),r.jsx(i1,{alertCount:e.length})]})},a1=({alertCounts:e})=>r.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[r.jsx(ku,{className:"w-5 h-5 text-red-400"}),"Live Alerts Feed"]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),r.jsxs("span",{className:"text-xs text-slate-400",children:[e.unacknowledged," unacknowledged"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(ae,{variant:"error",size:"sm",children:[e.critical," Critical"]}),r.jsxs(ae,{variant:"warning",size:"sm",children:[e.warning," Warning"]})]})]}),s1=({alerts:e,onAcknowledge:t})=>r.jsx("div",{className:"h-[400px] overflow-y-auto",children:r.jsx("div",{className:"divide-y divide-slate-700/50",children:e.map(n=>r.jsx(o1,{alert:n,onAcknowledge:t},n.id))})}),o1=({alert:e,onAcknowledge:t})=>{const n=Zt.alert[e.type];return r.jsx("div",{className:`p-4 ${n.bg} ${n.hover} border-l-2 ${n.borderLeft} transition-all ${e.acknowledged?"opacity-50":""}`,children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("span",{className:"text-lg mt-0.5",children:Tg(e.type)}),r.jsxs("div",{children:[r.jsx("p",{className:"text-white text-sm font-medium",children:e.message}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-xs text-slate-400 font-mono bg-slate-700/50 px-2 py-0.5 rounded",children:e.source}),r.jsx("span",{className:"text-xs text-slate-500",children:""}),r.jsx("span",{className:"text-xs text-slate-500",children:jg(e.time)})]})]})]}),e.acknowledged?r.jsx(ae,{variant:"success",size:"sm",children:" Ack"}):r.jsx(G,{variant:"secondary",size:"sm",onClick:()=>t(e.id),children:"Acknowledge"})]})})},i1=({alertCount:e})=>r.jsxs("div",{className:"p-3 border-t border-slate-700 bg-slate-900/50 flex items-center justify-between",children:[r.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",e," alerts"]}),r.jsx("button",{className:"text-xs text-cyan-400 hover:text-cyan-300 font-medium",children:"View All Alerts "})]}),l1=()=>{const e=_.useMemo(()=>Array.from({length:xu.TRAFFIC_GRAPH_POINTS}).map((t,n)=>({ingressHeight:20+Math.sin(n*.3)*15+Math.random()*20,egressHeight:15+Math.cos(n*.25)*10+Math.random()*15})),[]);return r.jsxs(R,{variant:"bordered",className:"mt-6 rounded-2xl",children:[r.jsx(c1,{}),r.jsx(d1,{data:e}),r.jsx(u1,{})]})},c1=()=>r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[r.jsx(Um,{className:"w-5 h-5 text-cyan-400"}),"Network Traffic (Last 60 Minutes)"]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Vs,{color:"bg-cyan-500",label:"Ingress"}),r.jsx(Vs,{color:"bg-purple-500",label:"Egress"}),r.jsx(Vs,{color:"bg-red-500",label:"Blocked"})]})]}),Vs=({color:e,label:t})=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-3 h-3 ${e} rounded-full`}),r.jsx("span",{className:"text-xs text-slate-400",children:t})]}),d1=({data:e})=>r.jsx("div",{className:"flex items-end gap-1 h-32",children:e.map((t,n)=>r.jsxs("div",{className:"flex-1 flex flex-col gap-0.5",children:[r.jsx("div",{className:"bg-gradient-to-t from-cyan-600 to-cyan-400 rounded-t transition-all duration-300",style:{height:`${t.ingressHeight}%`}}),r.jsx("div",{className:"bg-gradient-to-t from-purple-600 to-purple-400 rounded-t transition-all duration-300",style:{height:`${t.egressHeight}%`}})]},n))}),u1=()=>r.jsxs("div",{className:"flex justify-between mt-2 text-xs text-slate-500",children:[r.jsx("span",{children:"-60m"}),r.jsx("span",{children:"-45m"}),r.jsx("span",{children:"-30m"}),r.jsx("span",{children:"-15m"}),r.jsx("span",{children:"Now"})]}),p1=()=>{const e=Au(),{metrics:t,getFirewallCpuStatus:n}=Qf(),{alerts:a,acknowledgeAlert:s}=Yf();return r.jsxs(re,{children:[r.jsx(Xf,{currentTime:e}),r.jsx(Jf,{metrics:t,firewallCpuStatus:n()}),r.jsxs(Li,{cols:3,children:[r.jsx(e1,{}),r.jsx(r1,{alerts:a,onAcknowledge:s})]}),r.jsx(l1,{})]})},m1=[{label:"Overall Health",value:"87%",color:"emerald"},{label:"Total Services",value:"17",color:"cyan"},{label:"Healthy",value:"13",color:"emerald"},{label:"Degraded",value:"2",color:"amber"},{label:"Critical",value:"2",color:"red"}],g1=()=>r.jsxs(re,{children:[r.jsx(Li,{cols:5,className:"mb-6",children:m1.map((e,t)=>r.jsx(f1,{stat:e},t))}),r.jsxs(R,{children:[r.jsx("h3",{className:"text-white font-bold mb-4",children:"Service Topology"}),r.jsx("div",{className:"text-center py-16 text-slate-500",children:"Topology visualization displayed here"})]})]}),f1=({stat:e})=>{const t={emerald:"text-emerald-400",cyan:"text-cyan-400",amber:"text-amber-400",red:"text-red-400"};return r.jsxs(R,{children:[r.jsx("p",{className:"text-sm text-slate-400",children:e.label}),r.jsx("p",{className:`text-3xl font-bold ${t[e.color]}`,children:e.value})]})},h1=()=>r.jsxs(re,{children:[r.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-rose-600 rounded-xl p-6 text-white mb-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(ae,{variant:"default",className:"bg-white/20 text-white",children:"CRITICAL"}),r.jsx("span",{className:"font-mono text-sm opacity-80",children:"INC-2026-0113-001"})]}),r.jsx("h2",{className:"text-2xl font-bold",children:"Payment Gateway Service Degradation"})]}),r.jsx("div",{className:"text-center py-16 text-slate-500",children:"Incident correlation and root cause analysis view"})]}),_1=()=>{const[e,t]=_.useState("aws"),[n,a]=_.useState("vpcs"),[s,o]=_.useState(null),[i,l]=_.useState([]),[c,d]=_.useState(null),[u,m]=_.useState([]),[g,v]=_.useState([]),[b,y]=_.useState(null),[O,h]=_.useState([]),[p,f]=_.useState([]),[w,S]=_.useState(!0),[k,A]=_.useState(!1),[I,T]=_.useState(null);_.useEffect(()=>{(async()=>{try{const M=await ve.getOverview(e);o(M)}catch(M){T(M instanceof Error?M.message:"Failed to load overview")}})()},[e]),_.useEffect(()=>{(async()=>{S(!0),T(null),d(null),y(null),m([]);try{switch(n){case"vpcs":const M=await ve.getVPCs(e);l(M);break;case"security-groups":const de=await ve.getSecurityGroups(e);v(de);break;case"load-balancers":const P=await ve.getLoadBalancers(e);h(P);break;case"transit-gateways":const D=await ve.getTransitGateways(e);f(D);break}}catch(M){T(M instanceof Error?M.message:"Failed to load resources")}finally{S(!1)}})()},[e,n]);const E=_.useCallback(async j=>{if(!j){d(null),m([]);return}try{const[M,de]=await Promise.all([ve.getVPCDetails(e,j),ve.getSubnets(e,j)]);d(M),m(de)}catch(M){T(M instanceof Error?M.message:"Failed to load VPC details")}},[e]),H=_.useCallback(async j=>{if(!j){y(null);return}try{const M=await ve.getSecurityGroupDetails(e,j);y(M)}catch(M){T(M instanceof Error?M.message:"Failed to load security group details")}},[e]),U=_.useCallback(async()=>{A(!0),T(null);try{if((await ve.syncResources(e)).success){const M=await ve.getOverview(e);o(M)}}catch(j){T(j instanceof Error?j.message:"Failed to sync resources")}finally{A(!1)}},[e]),N=_.useCallback(async()=>{S(!0),T(null);try{const[j,M,de,P,D]=await Promise.all([ve.getOverview(e),ve.getVPCs(e),ve.getSecurityGroups(e),ve.getLoadBalancers(e),ve.getTransitGateways(e)]);o(j),l(M),v(de),h(P),f(D)}catch(j){T(j instanceof Error?j.message:"Failed to refresh data")}finally{S(!1)}},[e]),x=_.useCallback(()=>{T(null)},[]);return{activeProvider:e,activeResource:n,overview:s,vpcs:i,selectedVpc:c,subnets:u,securityGroups:g,selectedSecurityGroup:b,loadBalancers:O,transitGateways:p,isLoading:w,isSyncing:k,error:I,setActiveProvider:t,setActiveResource:a,selectVpc:E,selectSecurityGroup:H,syncResources:U,refreshData:N,clearError:x}},y1=[{id:"aws",name:"AWS",color:"from-orange-500 to-orange-600"},{id:"azure",name:"Azure",color:"from-blue-500 to-blue-600"},{id:"gcp",name:"GCP",color:"from-red-500 to-green-500"}],v1=[{id:"vpcs",name:"VPCs / VNets",icon:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"},{id:"security-groups",name:"Security Groups",icon:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},{id:"load-balancers",name:"Load Balancers",icon:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},{id:"transit-gateways",name:"Transit Gateways",icon:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"}],x1=()=>{const{activeProvider:e,activeResource:t,overview:n,vpcs:a,selectedVpc:s,subnets:o,securityGroups:i,selectedSecurityGroup:l,loadBalancers:c,transitGateways:d,isLoading:u,isSyncing:m,error:g,setActiveProvider:v,setActiveResource:b,selectVpc:y,selectSecurityGroup:O,syncResources:h}=_1();return r.jsxs(re,{children:[r.jsx("div",{className:"bg-white rounded-xl shadow-lg mb-6 overflow-hidden flex",children:y1.map(p=>r.jsx("button",{onClick:()=>v(p.id),className:`flex-1 px-6 py-4 font-bold transition-all ${e===p.id?`bg-gradient-to-r ${p.color} text-white`:"text-slate-600 hover:bg-slate-50"}`,children:p.name},p.id))}),n&&r.jsx(b1,{overview:n,isSyncing:m,onSync:h}),g&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:r.jsx("span",{className:"text-red-700",children:g})}),r.jsx("div",{className:"flex gap-2 mb-6",children:v1.map(p=>r.jsxs("button",{onClick:()=>b(p.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${t===p.id?"bg-cyan-500 text-white":"bg-white text-slate-600 hover:bg-slate-50 shadow"}`,children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:p.icon})}),p.name]},p.id))}),u?r.jsxs("div",{className:"flex items-center justify-center h-64",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),r.jsx("span",{className:"ml-3 text-slate-600",children:"Loading resources..."})]}):r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t==="vpcs"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsx(w1,{vpcs:a,selectedId:s==null?void 0:s.id,onSelect:y})}),r.jsx("div",{className:"lg:col-span-2",children:s?r.jsx(S1,{vpc:s,subnets:o}):r.jsx(rc,{message:"Select a VPC to view details"})})]}),t==="security-groups"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsx(k1,{groups:i,selectedId:l==null?void 0:l.id,onSelect:O})}),r.jsx("div",{className:"lg:col-span-2",children:l?r.jsx(C1,{group:l}):r.jsx(rc,{message:"Select a security group to view rules"})})]}),t==="load-balancers"&&r.jsx("div",{className:"lg:col-span-3",children:r.jsx(A1,{loadBalancers:c})}),t==="transit-gateways"&&r.jsx("div",{className:"lg:col-span-3",children:r.jsx(N1,{gateways:d})})]})]})},b1=({overview:e,isSyncing:t,onSync:n})=>{const a=[{label:"VPCs",value:e.vpcCount,color:"text-blue-600"},{label:"Subnets",value:e.subnetCount,color:"text-green-600"},{label:"Security Groups",value:e.securityGroupCount,color:"text-purple-600"},{label:"Load Balancers",value:e.loadBalancerCount,color:"text-orange-600"},{label:"Instances",value:e.totalInstances,color:"text-cyan-600"}];return r.jsxs(R,{className:"bg-white shadow-lg mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-3 h-3 rounded-full ${e.healthScore>=90?"bg-green-500":e.healthScore>=70?"bg-amber-500":"bg-red-500"}`}),r.jsxs("span",{className:"text-sm text-slate-600",children:["Health: ",r.jsxs("span",{className:"font-semibold",children:[e.healthScore,"%"]})]})]}),e.issueCount>0&&r.jsxs("span",{className:"text-sm text-red-600 bg-red-50 px-2 py-1 rounded",children:[e.issueCount," issues"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"text-xs text-slate-500",children:["Last sync: ",new Date(e.lastSync).toLocaleTimeString()]}),r.jsxs("button",{onClick:n,disabled:t,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-cyan-500 text-white rounded hover:bg-cyan-600 disabled:bg-slate-300 transition-colors",children:[r.jsx("svg",{className:`w-4 h-4 ${t?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t?"Syncing...":"Sync"]})]})]}),r.jsx("div",{className:"grid grid-cols-5 gap-4",children:a.map(s=>r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:`text-2xl font-bold ${s.color}`,children:s.value}),r.jsx("p",{className:"text-xs text-slate-500",children:s.label})]},s.label))})]})},w1=({vpcs:e,selectedId:t,onSelect:n})=>r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["VPCs / VNets (",e.length,")"]}),r.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:e.map(a=>r.jsxs("button",{onClick:()=>n(a.id),className:`w-full text-left p-3 rounded-lg transition-colors ${t===a.id?"bg-cyan-50 border-2 border-cyan-500":"bg-slate-50 hover:bg-slate-100 border-2 border-transparent"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"font-medium text-slate-800",children:a.name}),r.jsx(Oi,{status:a.status})]}),r.jsx("p",{className:"text-xs text-slate-500 font-mono",children:a.cidrBlock}),r.jsxs("div",{className:"flex gap-3 mt-2 text-xs text-slate-500",children:[r.jsxs("span",{children:[a.subnetCount," subnets"]}),r.jsxs("span",{children:[a.instanceCount," instances"]})]})]},a.id))})]}),S1=({vpc:e,subnets:t})=>r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:e.name}),r.jsx("p",{className:"text-sm text-slate-500 font-mono",children:e.id})]}),r.jsx(Oi,{status:e.status})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[r.jsx("p",{className:"text-xs text-slate-500",children:"CIDR Block"}),r.jsx("p",{className:"font-mono font-medium text-slate-800",children:e.cidrBlock})]}),r.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[r.jsx("p",{className:"text-xs text-slate-500",children:"Region"}),r.jsx("p",{className:"font-medium text-slate-800",children:e.region})]}),r.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[r.jsx("p",{className:"text-xs text-slate-500",children:"Instances"}),r.jsx("p",{className:"font-medium text-slate-800",children:e.instanceCount})]})]}),r.jsxs("h4",{className:"font-semibold text-slate-700 mb-3",children:["Subnets (",t.length,")"]}),r.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:t.map(n=>r.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"font-medium text-slate-800",children:n.name}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${n.isPublic?"bg-green-100 text-green-700":"bg-slate-200 text-slate-700"}`,children:n.isPublic?"Public":"Private"})]}),r.jsxs("div",{className:"flex gap-4 text-xs text-slate-500",children:[r.jsx("span",{className:"font-mono",children:n.cidrBlock}),r.jsx("span",{children:n.availabilityZone}),r.jsxs("span",{children:[n.availableIps," IPs available"]})]})]},n.id))})]}),k1=({groups:e,selectedId:t,onSelect:n})=>r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Security Groups (",e.length,")"]}),r.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:e.map(a=>r.jsxs("button",{onClick:()=>n(a.id),className:`w-full text-left p-3 rounded-lg transition-colors ${t===a.id?"bg-cyan-50 border-2 border-cyan-500":"bg-slate-50 hover:bg-slate-100 border-2 border-transparent"}`,children:[r.jsx("div",{className:"flex items-center justify-between mb-1",children:r.jsx("span",{className:"font-medium text-slate-800",children:a.name})}),r.jsx("p",{className:"text-xs text-slate-500 truncate",children:a.description}),r.jsxs("div",{className:"flex gap-3 mt-2 text-xs",children:[r.jsxs("span",{className:"text-green-600",children:[a.inboundRules.length," inbound"]}),r.jsxs("span",{className:"text-blue-600",children:[a.outboundRules.length," outbound"]})]})]},a.id))})]}),C1=({group:e})=>r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:e.name}),r.jsx("p",{className:"text-sm text-slate-500",children:e.description}),r.jsx("p",{className:"text-xs text-slate-400 font-mono mt-1",children:e.id})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("p",{className:"text-xs text-slate-500",children:["VPC: ",r.jsx("span",{className:"text-slate-700",children:e.vpcName})]})}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),"Inbound Rules (",e.inboundRules.length,")"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-slate-500 border-b",children:[r.jsx("th",{className:"pb-2",children:"Protocol"}),r.jsx("th",{className:"pb-2",children:"Port Range"}),r.jsx("th",{className:"pb-2",children:"Source"}),r.jsx("th",{className:"pb-2",children:"Description"})]})}),r.jsx("tbody",{children:e.inboundRules.map(t=>r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"py-2 font-mono",children:t.protocol}),r.jsx("td",{className:"py-2",children:t.portRange}),r.jsx("td",{className:"py-2 font-mono text-xs",children:t.source}),r.jsx("td",{className:"py-2 text-slate-500",children:t.description})]},t.id))})]})})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Outbound Rules (",e.outboundRules.length,")"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-xs text-slate-500 border-b",children:[r.jsx("th",{className:"pb-2",children:"Protocol"}),r.jsx("th",{className:"pb-2",children:"Port Range"}),r.jsx("th",{className:"pb-2",children:"Destination"}),r.jsx("th",{className:"pb-2",children:"Description"})]})}),r.jsx("tbody",{children:e.outboundRules.map(t=>r.jsxs("tr",{className:"border-b border-slate-100",children:[r.jsx("td",{className:"py-2 font-mono",children:t.protocol}),r.jsx("td",{className:"py-2",children:t.portRange}),r.jsx("td",{className:"py-2 font-mono text-xs",children:t.source}),r.jsx("td",{className:"py-2 text-slate-500",children:t.description})]},t.id))})]})})]})]}),A1=({loadBalancers:e})=>r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Load Balancers (",e.length,")"]}),r.jsx("div",{className:"space-y-4",children:e.length===0?r.jsx("p",{className:"text-center text-slate-500 py-8",children:"No load balancers found"}):e.map(t=>r.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-slate-800",children:t.name}),r.jsx("p",{className:"text-xs text-slate-500 font-mono",children:t.id})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.type==="application"?"bg-blue-100 text-blue-700":t.type==="network"?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"}`,children:t.type.toUpperCase()}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.scheme==="internet-facing"?"bg-green-100 text-green-700":"bg-slate-200 text-slate-700"}`,children:t.scheme})]})]}),r.jsx("p",{className:"text-xs text-slate-500 font-mono mb-3 truncate",children:t.dnsName}),r.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-slate-500",children:"Listeners:"})," ",r.jsx("span",{className:"font-medium",children:t.listenerCount})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-slate-500",children:"Target Groups:"})," ",r.jsx("span",{className:"font-medium",children:t.targetGroupCount})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-slate-500",children:"Health:"}),r.jsxs("span",{className:`font-medium ${t.healthyTargets===t.totalTargets?"text-green-600":"text-amber-600"}`,children:[t.healthyTargets,"/",t.totalTargets]}),r.jsx("span",{className:"text-slate-400",children:"targets"})]})]})]},t.id))})]}),N1=({gateways:e})=>r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Transit Gateways (",e.length,")"]}),e.length===0?r.jsx("p",{className:"text-center text-slate-500 py-8",children:"No transit gateways found"}):r.jsx("div",{className:"space-y-6",children:e.map(t=>r.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-slate-800",children:t.name}),r.jsx("p",{className:"text-xs text-slate-500 font-mono",children:t.id})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-slate-500",children:t.region}),r.jsx(Oi,{status:t.state==="available"?"active":t.state==="pending"?"pending":"error"})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("span",{className:"text-sm text-slate-600",children:[t.routeTables," route tables"]})}),r.jsxs("div",{children:[r.jsxs("h5",{className:"text-sm font-medium text-slate-700 mb-2",children:["Attachments (",t.attachments.length,")"]}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.attachments.map(n=>r.jsxs("div",{className:"bg-white rounded p-2 text-sm",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"font-medium text-slate-800",children:n.resourceName}),r.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${n.resourceType==="vpc"?"bg-blue-100 text-blue-700":n.resourceType==="vpn"?"bg-orange-100 text-orange-700":n.resourceType==="peering"?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"}`,children:n.resourceType})]}),r.jsx("p",{className:"text-xs text-slate-500 font-mono",children:n.resourceId})]},n.id))})]})]},t.id))})]}),Oi=({status:e})=>{const t={active:{bg:"bg-green-100",text:"text-green-700",label:"Active"},available:{bg:"bg-green-100",text:"text-green-700",label:"Available"},inactive:{bg:"bg-slate-100",text:"text-slate-700",label:"Inactive"},pending:{bg:"bg-amber-100",text:"text-amber-700",label:"Pending"},error:{bg:"bg-red-100",text:"text-red-700",label:"Error"},deleting:{bg:"bg-red-100",text:"text-red-700",label:"Deleting"}},n=t[e]||t.inactive;return r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${n.bg} ${n.text}`,children:n.label})},rc=({message:e})=>r.jsx(R,{className:"bg-slate-50 border-2 border-dashed border-slate-200",children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),r.jsx("p",{className:"text-slate-500",children:e})]})}),j1=()=>{const[e,t]=_.useState("192.168.1.100"),[n,a]=_.useState(""),[s,o]=_.useState("icmp"),[i,l]=_.useState(""),[c,d]=_.useState(null),[u,m]=_.useState([]),[g,v]=_.useState([]),[b,y]=_.useState(!1),[O,h]=_.useState(!0),[p,f]=_.useState(!0),[w,S]=_.useState(null);_.useEffect(()=>{(async()=>{try{const[x,j]=await Promise.all([ze.getHistory(),ze.getSavedPaths()]);m(x),v(j)}catch(x){S(x instanceof Error?x.message:"Failed to load data")}finally{h(!1),f(!1)}})()},[]);const k=_.useCallback(async()=>{if(!n.trim()){S("Please enter a destination IP address or hostname");return}if((s==="tcp"||s==="udp")&&!i){S("Please enter a port number for TCP/UDP");return}y(!0),S(null),d(null);try{const N={source:e,destination:n,protocol:s,port:i?parseInt(i,10):void 0,maxHops:30,timeout:5e3,probesPerHop:3,resolveHostnames:!0},x=await ze.runAnalysis(N);d(x);const j=await ze.getHistory();m(j)}catch(N){S(N instanceof Error?N.message:"Path analysis failed")}finally{y(!1)}},[e,n,s,i]),A=_.useCallback(async N=>{var x;t(N.source),a(N.destination),o(N.protocol),l(((x=N.port)==null?void 0:x.toString())||""),y(!0),S(null),d(null);try{const j={source:N.source,destination:N.destination,protocol:N.protocol,port:N.port,maxHops:30,timeout:5e3,probesPerHop:3,resolveHostnames:!0},M=await ze.runAnalysis(j);d(M),await ze.updateSavedPathRun(N.id);const de=await ze.getSavedPaths();v(de);const P=await ze.getHistory();m(P)}catch(j){S(j instanceof Error?j.message:"Path analysis failed")}finally{y(!1)}},[]),I=_.useCallback(async N=>{if(!N.trim()){S("Please enter a name for the saved path");return}if(!n.trim()){S("Please enter a destination before saving");return}try{const x=await ze.savePath({name:N,source:e,destination:n,protocol:s,port:i?parseInt(i,10):void 0});v(j=>[x,...j])}catch(x){S(x instanceof Error?x.message:"Failed to save path")}},[e,n,s,i]),T=_.useCallback(async N=>{try{await ze.deleteSavedPath(N),v(x=>x.filter(j=>j.id!==N))}catch(x){S(x instanceof Error?x.message:"Failed to delete path")}},[]),E=_.useCallback(async()=>{try{await ze.clearHistory(),m([])}catch(N){S(N instanceof Error?N.message:"Failed to clear history")}},[]),H=_.useCallback(()=>{d(null)},[]),U=_.useCallback(()=>{S(null)},[]);return{source:e,destination:n,protocol:s,port:i,result:c,history:u,savedPaths:g,isRunning:b,isLoadingHistory:O,isLoadingSaved:p,error:w,setSource:t,setDestination:a,setProtocol:o,setPort:l,runAnalysis:k,runSavedPath:A,savePath:I,deleteSavedPath:T,clearHistory:E,clearResult:H,clearError:U}},T1=[{name:"Google DNS",ip:"8.8.8.8"},{name:"Cloudflare DNS",ip:"1.1.1.1"},{name:"AWS us-east-1",ip:"52.94.76.1"},{name:"Azure East US",ip:"13.82.0.1"},{name:"GCP us-central1",ip:"35.192.0.1"}],ac=({health:e})=>{const t={healthy:"success",degraded:"warning",critical:"error",unknown:"default"};return r.jsx(ae,{variant:t[e],children:e})},E1=({status:e,latency:t})=>{const n=()=>e==="timeout"?"bg-gray-400":e==="unreachable"?"bg-red-500":t>100?"bg-yellow-500":"bg-green-500";return r.jsx("div",{className:`w-3 h-3 rounded-full ${n()}`,title:e})},P1=({hop:e,isLast:t})=>{const[n,a]=_.useState(!1);return r.jsxs("div",{className:"relative",children:[!t&&r.jsx("div",{className:"absolute left-[18px] top-10 w-0.5 h-8 bg-gray-300"}),r.jsxs("div",{className:`border rounded-lg p-3 mb-2 cursor-pointer transition-all ${n?"bg-gray-50 border-blue-300":"bg-white hover:bg-gray-50"}`,onClick:()=>a(!n),children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2 w-16",children:[r.jsx(E1,{status:e.status,latency:e.avgLatency}),r.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",e.hopNumber]})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-mono text-sm text-gray-900",children:e.ipAddress}),e.hostname&&r.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.hostname})]}),r.jsx("div",{className:"hidden md:block w-32 text-sm text-gray-600",children:e.location||"-"}),r.jsx("div",{className:"w-24 text-right",children:e.status==="timeout"?r.jsx("span",{className:"text-gray-400",children:"* * *"}):r.jsxs("span",{className:`font-medium ${e.avgLatency>100?"text-yellow-600":e.avgLatency>50?"text-blue-600":"text-green-600"}`,children:[e.avgLatency.toFixed(1)," ms"]})}),r.jsx("div",{className:"w-20 text-right",children:r.jsxs("span",{className:`text-sm ${e.packetLoss>5?"text-red-600":"text-gray-500"}`,children:[e.packetLoss.toFixed(1),"% loss"]})}),r.jsx("div",{className:"w-20",children:e.cloudProvider&&r.jsx(ae,{variant:"default",className:"text-xs",children:e.cloudProvider.toUpperCase()})}),r.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&r.jsxs("div",{className:"mt-3 pt-3 border-t grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"Min Latency"}),r.jsxs("div",{className:"font-medium",children:[e.minLatency.toFixed(2)," ms"]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"Max Latency"}),r.jsxs("div",{className:"font-medium",children:[e.maxLatency.toFixed(2)," ms"]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"Jitter"}),r.jsxs("div",{className:"font-medium",children:[e.jitter.toFixed(2)," ms"]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"Device Type"}),r.jsx("div",{className:"font-medium capitalize",children:e.deviceType||"Unknown"})]}),e.asn&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"ASN"}),r.jsx("div",{className:"font-medium",children:e.asn})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"Organization"}),r.jsx("div",{className:"font-medium",children:e.asnOrg||"-"})]})]}),e.region&&r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"Region"}),r.jsx("div",{className:"font-medium",children:e.region})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-gray-500",children:"RTT Samples"}),r.jsx("div",{className:"font-mono text-xs",children:e.latency.length>0?e.latency.map(s=>s.toFixed(1)).join(" / "):"* / * / *"})]})]})]})]})},I1=()=>{const{source:e,destination:t,protocol:n,port:a,result:s,history:o,savedPaths:i,isRunning:l,isLoadingHistory:c,isLoadingSaved:d,error:u,setSource:m,setDestination:g,setProtocol:v,setPort:b,runAnalysis:y,runSavedPath:O,savePath:h,deleteSavedPath:p,clearHistory:f,clearResult:w,clearError:S}=j1(),[k,A]=_.useState(!1),[I,T]=_.useState(""),[E,H]=_.useState("results"),U=async()=>{await h(I),A(!1),T("")},N=x=>new Date(x).toLocaleString();return r.jsxs(re,{children:[u&&r.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",children:[r.jsx("span",{className:"text-red-700",children:u}),r.jsx("button",{onClick:S,className:"text-red-500 hover:text-red-700",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx(R,{className:"bg-white shadow-lg mb-6",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Path Analysis"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source IP"}),r.jsx(ea,{value:e,onChange:x=>m(x.target.value),placeholder:"e.g., 192.168.1.100"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),r.jsx(ea,{value:t,onChange:x=>g(x.target.value),placeholder:"e.g., 8.8.8.8"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Protocol"}),r.jsxs(Xm,{value:n,onChange:x=>v(x.target.value),children:[r.jsx("option",{value:"icmp",children:"ICMP"}),r.jsx("option",{value:"tcp",children:"TCP"}),r.jsx("option",{value:"udp",children:"UDP"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),r.jsx(ea,{type:"number",value:a,onChange:x=>b(x.target.value),placeholder:"e.g., 443",disabled:n==="icmp"})]}),r.jsx("div",{className:"flex items-end",children:r.jsx(G,{onClick:y,disabled:l,className:"w-full",children:l?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Tracing..."]}):"Run Traceroute"})})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("span",{className:"text-sm text-gray-500 mr-2",children:"Quick targets:"}),T1.map(x=>r.jsx("button",{onClick:()=>g(x.ip),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded text-gray-700",children:x.name},x.ip))]})]})}),r.jsx("div",{className:"flex gap-2 mb-4",children:["results","saved","history"].map(x=>r.jsxs("button",{onClick:()=>H(x),className:`px-4 py-2 rounded-lg font-medium transition-colors ${E===x?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[x==="results"&&"Results",x==="saved"&&`Saved Paths (${i.length})`,x==="history"&&`History (${o.length})`]},x))}),E==="results"&&r.jsx(r.Fragment,{children:s?r.jsx(R,{className:"bg-white shadow-lg",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Path: ",s.source,"  ",s.destination]}),r.jsxs("p",{className:"text-sm text-gray-500",children:[s.protocol.toUpperCase(),s.port?`:${s.port}`:""," | Completed at ",N(s.endTime||s.startTime)]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(ac,{health:s.health}),r.jsx(G,{variant:"secondary",onClick:()=>A(!0),children:"Save Path"}),r.jsx(G,{variant:"secondary",onClick:w,children:"Clear"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.totalHops}),r.jsx("div",{className:"text-sm text-gray-500",children:"Total Hops"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.avgLatency.toFixed(1)," ms"]}),r.jsx("div",{className:"text-sm text-gray-500",children:"Avg Latency"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[s.totalLatency.toFixed(1)," ms"]}),r.jsx("div",{className:"text-sm text-gray-500",children:"Total RTT"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:`text-2xl font-bold ${s.packetLoss>5?"text-red-600":"text-green-600"}`,children:[s.packetLoss.toFixed(1),"%"]}),r.jsx("div",{className:"text-sm text-gray-500",children:"Packet Loss"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.mtu}),r.jsx("div",{className:"text-sm text-gray-500",children:"MTU"})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Hop-by-Hop Path"}),r.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-gray-600",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),r.jsx("span",{children:"Healthy (<50ms)"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),r.jsx("span",{children:"Normal (50-100ms)"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),r.jsx("span",{children:"High Latency (>100ms)"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),r.jsx("span",{children:"Unreachable"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-400"}),r.jsx("span",{children:"Timeout"})]})]}),r.jsx("div",{className:"space-y-0",children:s.hops.map((x,j)=>r.jsx(P1,{hop:x,isLast:j===s.hops.length-1},x.hopNumber))})]})]})}):r.jsx(R,{className:"bg-white shadow-lg",children:r.jsx("div",{className:"text-center py-16 text-gray-400",children:l?r.jsxs("div",{children:[r.jsxs("svg",{className:"animate-spin mx-auto h-12 w-12 text-blue-500 mb-4",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),r.jsx("p",{className:"text-gray-600",children:"Running path analysis..."}),r.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Discovering network hops to ",t]})]}):r.jsxs("div",{children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),r.jsx("p",{children:'Enter a destination and click "Run Traceroute" to analyze the network path'})]})})})}),E==="saved"&&r.jsx(R,{className:"bg-white shadow-lg",children:r.jsxs("div",{className:"p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Saved Paths"}),d?r.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading saved paths..."}):i.length===0?r.jsx("div",{className:"text-center py-8 text-gray-400",children:"No saved paths. Run an analysis and save it for quick access."}):r.jsx("div",{className:"space-y-3",children:i.map(x=>r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium text-gray-900",children:x.name}),r.jsxs("div",{className:"text-sm text-gray-500",children:[x.source,"  ",x.destination,r.jsx("span",{className:"mx-2",children:"|"}),x.protocol.toUpperCase(),x.port?`:${x.port}`:""]}),r.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[x.runCount," runs | Last: ",x.lastRun?N(x.lastRun):"Never"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(G,{variant:"primary",onClick:()=>O(x),disabled:l,children:"Run"}),r.jsx(G,{variant:"secondary",onClick:()=>p(x.id),children:"Delete"})]})]},x.id))})]})}),E==="history"&&r.jsx(R,{className:"bg-white shadow-lg",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analysis History"}),o.length>0&&r.jsx(G,{variant:"secondary",onClick:f,children:"Clear History"})]}),c?r.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading history..."}):o.length===0?r.jsx("div",{className:"text-center py-8 text-gray-400",children:"No analysis history yet."}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Time"}),r.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Source"}),r.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Destination"}),r.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Hops"}),r.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Avg Latency"}),r.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Health"}),r.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Status"})]})}),r.jsx("tbody",{children:o.map(x=>r.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[r.jsx("td",{className:"py-3 px-3 text-sm text-gray-600",children:N(x.timestamp)}),r.jsx("td",{className:"py-3 px-3 text-sm font-mono text-gray-900",children:x.source}),r.jsx("td",{className:"py-3 px-3 text-sm font-mono text-gray-900",children:x.destination}),r.jsx("td",{className:"py-3 px-3 text-sm text-center text-gray-600",children:x.totalHops}),r.jsxs("td",{className:"py-3 px-3 text-sm text-center text-gray-600",children:[x.avgLatency.toFixed(1)," ms"]}),r.jsx("td",{className:"py-3 px-3 text-center",children:r.jsx(ac,{health:x.health})}),r.jsx("td",{className:"py-3 px-3 text-center",children:r.jsx(ae,{variant:x.status==="completed"?"success":"error",children:x.status})})]},x.id))})]})})]})}),k&&r.jsx(Jm,{isOpen:k,onClose:()=>A(!1),title:"Save Path",children:r.jsxs("div",{className:"p-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Path Name"}),r.jsx(ea,{value:I,onChange:x=>T(x.target.value),placeholder:"e.g., Production to AWS",className:"mb-4"}),r.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[e,"  ",t," (",n.toUpperCase(),a?`:${a}`:"",")"]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(G,{variant:"secondary",onClick:()=>A(!1),children:"Cancel"}),r.jsx(G,{onClick:U,children:"Save"})]})]})})]})},L1=()=>r.jsx(re,{children:r.jsx(R,{className:"bg-white shadow-lg",children:r.jsx("div",{className:"text-center py-16 text-gray-400",children:"Route Intelligence View - AI-powered routing analysis"})})}),Pu=()=>{const[e,t]=_.useState([]),[n,a]=_.useState(null),[s,o]=_.useState(!0),[i,l]=_.useState(!1),[c,d]=_.useState(null),[u,m]=_.useState({}),[g,v]=_.useState(null),[b,y]=_.useState(!1),O=_.useCallback(async T=>{try{o(!0),d(null);const E=T??u,H=await Ht.getTickets(E);t(H)}catch(E){d(E instanceof Error?E.message:"Failed to load tickets")}finally{o(!1)}},[u]);_.useEffect(()=>{O()},[]);const h={awaiting:e.filter(T=>T.status==="awaiting"),approved:e.filter(T=>T.status==="approved"),implementing:e.filter(T=>T.status==="implementing"),completed:e.filter(T=>T.status==="completed"),rejected:e.filter(T=>T.status==="rejected")},p=_.useCallback(async T=>{if(!T){a(null);return}try{const E=await Ht.getTicketById(T);a(E)}catch(E){d(E instanceof Error?E.message:"Failed to load ticket details")}},[]),f=_.useCallback(async T=>{l(!0),d(null);try{const E=await Ht.createTicket(T);return t(H=>[E,...H]),E}catch(E){const H=E instanceof Error?E.message:"Failed to create ticket";throw d(H),new Error(H)}finally{l(!1)}},[]),w=_.useCallback(async(T,E)=>{try{const H=await Ht.updateTicketStatus(T,E);H&&(t(U=>U.map(N=>N.id===T?H:N)),(n==null?void 0:n.id)===T&&a(H))}catch(H){d(H instanceof Error?H.message:"Failed to update ticket status")}},[n]),S=_.useCallback(async(T,E,H)=>{try{const U=await Ht.approveTicketStep(T,E,H);U&&(t(N=>N.map(x=>x.id===T?U:x)),(n==null?void 0:n.id)===T&&a(U))}catch(U){d(U instanceof Error?U.message:"Failed to approve ticket step")}},[n]),k=_.useCallback(async(T,E,H)=>{try{const U=await Ht.rejectTicketStep(T,E,H);U&&(t(N=>N.map(x=>x.id===T?U:x)),(n==null?void 0:n.id)===T&&a(U))}catch(U){d(U instanceof Error?U.message:"Failed to reject ticket step")}},[n]),A=_.useCallback(async T=>{y(!0);try{const E=await Ht.calculateRisk(T);v(E)}catch(E){d(E instanceof Error?E.message:"Failed to calculate risk")}finally{y(!1)}},[]),I=_.useCallback(()=>{d(null)},[]);return{tickets:e,ticketsByStatus:h,selectedTicket:n,isLoading:s,isSubmitting:i,error:c,filter:u,riskAssessment:g,isCalculatingRisk:b,loadTickets:O,selectTicket:p,createTicket:f,updateStatus:w,approveStep:S,rejectStep:k,setFilter:T=>{m(T),O(T)},calculateRisk:A,clearError:I}},sc={title:"",description:"",priority:"medium",category:"firewall_rule",changeType:"add",sourceIp:"",destinationIp:"",port:"",protocol:"tcp",action:"allow",platform:"aws",justification:"",scheduledAt:"",rollbackPlan:""},R1=[{value:"firewall_rule",label:"Firewall Rule"},{value:"security_group",label:"Security Group"},{value:"network_acl",label:"Network ACL"},{value:"routing",label:"Routing"},{value:"load_balancer",label:"Load Balancer"},{value:"vpn",label:"VPN"},{value:"dns",label:"DNS"},{value:"other",label:"Other"}],O1=[{value:"low",label:"Low",color:"bg-slate-500"},{value:"medium",label:"Medium",color:"bg-amber-500"},{value:"high",label:"High",color:"bg-orange-500"},{value:"critical",label:"Critical",color:"bg-red-500"}],D1=[{value:"add",label:"Add Rule",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})},{value:"modify",label:"Modify Rule",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{value:"delete",label:"Delete Rule",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}],M1=({assessment:e,isLoading:t})=>{if(t)return r.jsxs("div",{className:"flex items-center justify-center py-8",children:[r.jsxs("svg",{className:"animate-spin h-6 w-6 text-cyan-500",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{className:"ml-2 text-slate-400",children:"Calculating risk..."})]});if(!e)return r.jsx("div",{className:"text-center py-8 text-slate-500",children:"Fill in the rule details to see risk assessment"});const n={low:"text-emerald-400 bg-emerald-500/20",medium:"text-amber-400 bg-amber-500/20",high:"text-orange-400 bg-orange-500/20",critical:"text-red-400 bg-red-500/20"},a={low:"bg-emerald-500",medium:"bg-amber-500",high:"bg-orange-500",critical:"bg-red-500"};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-slate-400",children:"Risk Score"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-3xl font-bold text-white",children:e.score}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${n[e.level]}`,children:e.level.toUpperCase()})]})]})}),r.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full ${a[e.level]} transition-all duration-500`,style:{width:`${e.score}%`}})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Risk Factors"}),e.factors.map((s,o)=>r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[s.impact==="negative"?r.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):r.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{className:"text-slate-300",children:s.name})]}),r.jsxs("span",{className:s.weight>0?"text-red-400":"text-emerald-400",children:[s.weight>0?"+":"",s.weight]})]},o))]}),r.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-slate-400",children:"Recommendation"}),r.jsx("p",{className:"text-white",children:e.recommendation})]})]})},G1=()=>{const{createTicket:e,isSubmitting:t,riskAssessment:n,isCalculatingRisk:a,calculateRisk:s,error:o,clearError:i}=Pu(),[l,c]=_.useState(sc),[d,u]=_.useState(!1),[m,g]=_.useState(null);_.useEffect(()=>{const y=setTimeout(()=>{(l.sourceIp||l.destinationIp||l.port)&&s(l)},500);return()=>clearTimeout(y)},[l.sourceIp,l.destinationIp,l.port,l.action,l.changeType,l.priority,s]);const v=async y=>{y.preventDefault();try{const O=await e(l);g(O.serviceNowId),u(!0)}catch{}},b=()=>{c(sc),u(!1),g(null),i()};return d&&m?r.jsx(re,{children:r.jsx("div",{className:"max-w-2xl mx-auto",children:r.jsx(R,{className:"text-center",children:r.jsxs("div",{className:"py-8",children:[r.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Change Request Submitted"}),r.jsx("p",{className:"text-slate-400 mb-4",children:"Your request has been submitted to ServiceNow for review."}),r.jsxs("div",{className:"inline-block px-4 py-2 bg-slate-700 rounded-lg mb-6",children:[r.jsx("p",{className:"text-sm text-slate-400",children:"ServiceNow Ticket ID"}),r.jsx("p",{className:"text-xl font-mono font-bold text-cyan-400",children:m})]}),r.jsxs("div",{className:"flex justify-center gap-3",children:[r.jsx(G,{variant:"primary",onClick:b,children:"Create Another Request"}),r.jsx(G,{variant:"secondary",children:"View in ServiceNow"})]})]})})})}):r.jsx(re,{children:r.jsx("form",{onSubmit:v,children:r.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[r.jsxs("div",{className:"col-span-2 space-y-6",children:[o&&r.jsxs("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg flex items-center justify-between",children:[r.jsx("span",{className:"text-red-400",children:o}),r.jsx("button",{type:"button",onClick:i,className:"text-red-400 hover:text-red-300",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Request Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Request Title *"}),r.jsx("input",{type:"text",required:!0,value:l.title,onChange:y=>c({...l,title:y.target.value}),placeholder:"e.g., Allow HTTPS traffic from DMZ to Production",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Description *"}),r.jsx("textarea",{required:!0,rows:3,value:l.description,onChange:y=>c({...l,description:y.target.value}),placeholder:"Describe the change and business justification...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Category *"}),r.jsx("select",{value:l.category,onChange:y=>c({...l,category:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:R1.map(y=>r.jsx("option",{value:y.value,children:y.label},y.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Target Platform *"}),r.jsxs("select",{value:l.platform,onChange:y=>c({...l,platform:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"aws",children:"AWS"}),r.jsx("option",{value:"azure",children:"Azure"}),r.jsx("option",{value:"gcp",children:"GCP"}),r.jsx("option",{value:"onprem",children:"On-Premises"})]})]})]})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Change Type"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:D1.map(y=>r.jsxs("button",{type:"button",onClick:()=>c({...l,changeType:y.value}),className:`p-4 rounded-lg border-2 transition-all flex flex-col items-center gap-2 ${l.changeType===y.value?"border-cyan-500 bg-cyan-500/10 text-cyan-400":"border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600"}`,children:[y.icon,r.jsx("span",{className:"font-medium",children:y.label})]},y.value))})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Rule Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Source IP/CIDR *"}),r.jsx("input",{type:"text",required:!0,value:l.sourceIp,onChange:y=>c({...l,sourceIp:y.target.value}),placeholder:"e.g., 10.0.1.0/24",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Destination IP/CIDR *"}),r.jsx("input",{type:"text",required:!0,value:l.destinationIp,onChange:y=>c({...l,destinationIp:y.target.value}),placeholder:"e.g., 10.0.2.0/24",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Port *"}),r.jsx("input",{type:"text",required:!0,value:l.port,onChange:y=>c({...l,port:y.target.value}),placeholder:"e.g., 443",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Protocol *"}),r.jsxs("select",{value:l.protocol,onChange:y=>c({...l,protocol:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"tcp",children:"TCP"}),r.jsx("option",{value:"udp",children:"UDP"}),r.jsx("option",{value:"icmp",children:"ICMP"}),r.jsx("option",{value:"any",children:"Any"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Action *"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{type:"button",onClick:()=>c({...l,action:"allow"}),className:`px-4 py-2 rounded-lg font-medium transition-all ${l.action==="allow"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:"Allow"}),r.jsx("button",{type:"button",onClick:()=>c({...l,action:"deny"}),className:`px-4 py-2 rounded-lg font-medium transition-all ${l.action==="deny"?"bg-red-500 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:"Deny"})]})]})]})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Implementation Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Business Justification *"}),r.jsx("textarea",{required:!0,rows:2,value:l.justification,onChange:y=>c({...l,justification:y.target.value}),placeholder:"Why is this change necessary?",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Scheduled Date/Time"}),r.jsx("input",{type:"datetime-local",value:l.scheduledAt,onChange:y=>c({...l,scheduledAt:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Priority *"}),r.jsx("div",{className:"flex gap-2",children:O1.map(y=>r.jsx("button",{type:"button",onClick:()=>c({...l,priority:y.value}),className:`flex-1 px-3 py-2 rounded-lg font-medium text-sm transition-all ${l.priority===y.value?`${y.color} text-white`:"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:y.label},y.value))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Rollback Plan"}),r.jsx("textarea",{rows:2,value:l.rollbackPlan,onChange:y=>c({...l,rollbackPlan:y.target.value}),placeholder:"How will you revert this change if needed?",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(G,{type:"button",variant:"ghost",onClick:b,children:"Clear Form"}),r.jsx(G,{type:"submit",variant:"primary",isLoading:t,children:"Submit Change Request"})]})]}),r.jsx("div",{className:"col-span-1",children:r.jsx("div",{className:"sticky top-6",children:r.jsxs(R,{children:[r.jsx(J,{title:"Risk Assessment"}),r.jsx(M1,{assessment:n,isLoading:a})]})})})]})})})},Do={awaiting:{label:"Awaiting Approval",color:"bg-amber-500",bgColor:"bg-amber-50"},approved:{label:"Approved",color:"bg-blue-500",bgColor:"bg-blue-50"},implementing:{label:"Implementing",color:"bg-purple-500",bgColor:"bg-purple-50"},completed:{label:"Completed",color:"bg-green-500",bgColor:"bg-green-50"},rejected:{label:"Rejected",color:"bg-red-500",bgColor:"bg-red-50"}},Iu={low:{label:"Low",color:"text-slate-600",dotColor:"bg-slate-400"},medium:{label:"Medium",color:"text-blue-600",dotColor:"bg-blue-500"},high:{label:"High",color:"text-amber-600",dotColor:"bg-amber-500"},critical:{label:"Critical",color:"text-red-600",dotColor:"bg-red-500"}},Lu={low:{color:"text-green-700",bgColor:"bg-green-100"},medium:{color:"text-amber-700",bgColor:"bg-amber-100"},high:{color:"text-orange-700",bgColor:"bg-orange-100"},critical:{color:"text-red-700",bgColor:"bg-red-100"}},Ru={firewall_rule:"Firewall Rule",security_group:"Security Group",network_acl:"Network ACL",routing:"Routing",load_balancer:"Load Balancer",vpn:"VPN",dns:"DNS",other:"Other"},V1=()=>{const{ticketsByStatus:e,isLoading:t,error:n,selectedTicket:a,selectTicket:s,updateStatus:o,approveStep:i,rejectStep:l}=Pu(),[c,d]=_.useState(!1),[u,m]=_.useState(""),[g,v]=_.useState(""),[b,y]=_.useState(null),O=async k=>{await s(k.id),d(!0),m(""),v(""),y(null)},h=()=>{d(!1),s(null)},p=async k=>{a&&(await i(a.id,k,u),m(""),y(null))},f=async k=>{a&&g.trim()&&(await l(a.id,k,g),v(""),y(null))},w=async(k,A)=>{await o(k,A)},S=["awaiting","approved","implementing","completed","rejected"];return t?r.jsx(re,{children:r.jsxs("div",{className:"flex items-center justify-center h-64",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),r.jsx("span",{className:"ml-3 text-slate-600",children:"Loading tickets..."})]})}):n?r.jsx(re,{children:r.jsxs("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg",children:["Error loading tickets: ",n]})}):r.jsx(re,{children:r.jsxs("div",{className:"flex gap-6 h-[calc(100vh-200px)]",children:[r.jsx("div",{className:`flex-1 grid grid-cols-5 gap-4 transition-all ${c?"w-2/3":"w-full"}`,children:S.map(k=>r.jsx(H1,{status:k,config:Do[k],tickets:e[k],onTicketClick:O,onStatusChange:w,selectedTicketId:a==null?void 0:a.id},k))}),c&&a&&r.jsx(W1,{ticket:a,onClose:h,approvalComment:u,setApprovalComment:m,rejectComment:g,setRejectComment:v,activeApprovalStep:b,setActiveApprovalStep:y,onApprove:p,onReject:f})]})})},H1=({config:e,tickets:t,onTicketClick:n,selectedTicketId:a})=>r.jsxs("div",{className:`${e.bgColor} rounded-xl overflow-hidden flex flex-col`,children:[r.jsxs("div",{className:`${e.color} px-4 py-3 text-white font-semibold flex items-center justify-between`,children:[r.jsx("span",{children:e.label}),r.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-sm",children:t.length})]}),r.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-3",children:t.length===0?r.jsx("div",{className:"text-center text-slate-400 py-8 text-sm",children:"No tickets"}):t.map(s=>r.jsx(F1,{ticket:s,onClick:()=>n(s),isSelected:s.id===a},s.id))})]}),F1=({ticket:e,onClick:t,isSelected:n})=>{const a=Iu[e.priority],s=Lu[e.riskAssessment.level],o=e.approvalSteps.filter(l=>l.status==="pending").length,i=e.approvalSteps.length;return r.jsxs("div",{onClick:t,className:`bg-white rounded-lg p-3 shadow-sm cursor-pointer transition-all hover:shadow-md ${n?"ring-2 ring-cyan-500 shadow-md":""}`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsx("span",{className:"text-xs font-mono text-slate-500",children:e.serviceNowId}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:`w-2 h-2 rounded-full ${a.dotColor}`}),r.jsx("span",{className:`text-xs ${a.color}`,children:a.label})]})]}),r.jsx("h4",{className:"font-medium text-slate-800 text-sm mb-2 line-clamp-2",children:e.title}),r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded",children:Ru[e.category]||e.category}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.changeType==="add"?"bg-green-100 text-green-700":e.changeType==="delete"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:e.changeType.charAt(0).toUpperCase()+e.changeType.slice(1)})]}),r.jsxs("div",{className:`text-xs px-2 py-1 rounded ${s.bgColor} ${s.color} mb-2 inline-block`,children:["Risk: ",e.riskAssessment.level.charAt(0).toUpperCase()+e.riskAssessment.level.slice(1)," (",e.riskAssessment.score,"/100)"]}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 pt-2 border-t border-slate-100",children:[r.jsx("span",{children:e.assignee}),i>0&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),i-o,"/",i]})]})]})},W1=({ticket:e,onClose:t,approvalComment:n,setApprovalComment:a,rejectComment:s,setRejectComment:o,activeApprovalStep:i,setActiveApprovalStep:l,onApprove:c,onReject:d})=>{const u=Iu[e.priority],m=Lu[e.riskAssessment.level];return r.jsxs("div",{className:"w-1/3 min-w-[400px] bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"bg-slate-800 text-white p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-mono text-sm text-slate-300",children:e.serviceNowId}),r.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("h3",{className:"font-semibold text-lg",children:e.title}),r.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[r.jsx("span",{className:`${Do[e.status].color} text-white text-xs px-2 py-1 rounded`,children:Do[e.status].label}),r.jsxs("span",{className:`flex items-center gap-1 text-xs ${u.color}`,children:[r.jsx("span",{className:`w-2 h-2 rounded-full ${u.dotColor}`}),u.label," Priority"]})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.jsxs("section",{children:[r.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Description"}),r.jsx("p",{className:"text-sm text-slate-600",children:e.description})]}),r.jsxs("section",{className:"grid grid-cols-2 gap-3",children:[r.jsx(un,{label:"Category",value:Ru[e.category]||e.category}),r.jsx(un,{label:"Change Type",value:e.changeType.charAt(0).toUpperCase()+e.changeType.slice(1)}),r.jsx(un,{label:"Requester",value:e.requester}),r.jsx(un,{label:"Assignee",value:e.assignee}),r.jsx(un,{label:"Created",value:new Date(e.createdAt).toLocaleDateString()}),e.scheduledAt&&r.jsx(un,{label:"Scheduled",value:new Date(e.scheduledAt).toLocaleDateString()})]}),r.jsxs("section",{children:[r.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Risk Assessment"}),r.jsxs("div",{className:`${m.bgColor} ${m.color} rounded-lg p-3`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("span",{className:"font-semibold",children:[e.riskAssessment.level.charAt(0).toUpperCase()+e.riskAssessment.level.slice(1)," Risk"]}),r.jsxs("span",{className:"text-lg font-bold",children:[e.riskAssessment.score,"/100"]})]}),r.jsx("p",{className:"text-sm",children:e.riskAssessment.recommendation}),e.riskAssessment.factors.length>0&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-current/20",children:[r.jsx("p",{className:"text-xs font-medium mb-1",children:"Risk Factors:"}),r.jsx("ul",{className:"text-xs space-y-1",children:e.riskAssessment.factors.slice(0,3).map((g,v)=>r.jsxs("li",{className:"flex items-start gap-1",children:[r.jsx("span",{children:g.impact==="negative"?"":g.impact==="positive"?"":""}),r.jsx("span",{children:g.description})]},v))})]})]})]}),e.affectedResources.length>0&&r.jsxs("section",{children:[r.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Affected Resources"}),r.jsx("div",{className:"space-y-2",children:e.affectedResources.map(g=>r.jsxs("div",{className:"bg-slate-50 rounded p-2 text-sm",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"font-medium",children:g.name}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${g.platform==="aws"?"bg-orange-100 text-orange-700":g.platform==="azure"?"bg-blue-100 text-blue-700":g.platform==="gcp"?"bg-red-100 text-red-700":"bg-slate-200 text-slate-700"}`,children:g.platform.toUpperCase()})]}),r.jsxs("p",{className:"text-xs text-slate-500",children:[g.type," ",g.region&&` ${g.region}`]})]},g.id))})]}),r.jsxs("section",{children:[r.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Approval Workflow"}),r.jsx("div",{className:"space-y-2",children:e.approvalSteps.map(g=>r.jsx(U1,{step:g,isActive:i===g.id,onToggle:()=>l(i===g.id?null:g.id),approvalComment:n,setApprovalComment:a,rejectComment:s,setRejectComment:o,onApprove:()=>c(g.id),onReject:()=>d(g.id)},g.id))})]}),e.rollbackPlan&&r.jsxs("section",{children:[r.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Rollback Plan"}),r.jsx("p",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3",children:e.rollbackPlan})]}),e.implementationNotes&&r.jsxs("section",{children:[r.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Implementation Notes"}),r.jsx("p",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3",children:e.implementationNotes})]})]})]})},un=({label:e,value:t})=>r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-500",children:e}),r.jsx("p",{className:"text-sm font-medium text-slate-700",children:t})]}),U1=({step:e,isActive:t,onToggle:n,approvalComment:a,setApprovalComment:s,rejectComment:o,setRejectComment:i,onApprove:l,onReject:c})=>{const u={pending:{icon:"",color:"text-amber-600",bg:"bg-amber-50"},approved:{icon:"",color:"text-green-600",bg:"bg-green-50"},rejected:{icon:"",color:"text-red-600",bg:"bg-red-50"}}[e.status];return r.jsxs("div",{className:`${u.bg} rounded-lg overflow-hidden`,children:[r.jsxs("div",{className:`p-3 flex items-center justify-between cursor-pointer ${e.status==="pending"?"hover:bg-amber-100":""}`,onClick:e.status==="pending"?n:void 0,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${u.bg} ${u.color}`,children:u.icon}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-slate-700",children:e.name}),r.jsx("p",{className:"text-xs text-slate-500",children:e.approver})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:`text-xs font-medium ${u.color}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.timestamp&&r.jsx("p",{className:"text-xs text-slate-400",children:new Date(e.timestamp).toLocaleDateString()})]})]}),e.status==="pending"&&t&&r.jsxs("div",{className:"p-3 border-t border-amber-200 space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Approval Comment (optional)"}),r.jsx("textarea",{value:a,onChange:m=>s(m.target.value),className:"w-full px-3 py-2 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-cyan-500 focus:border-transparent",rows:2,placeholder:"Add a comment..."})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:l,className:"flex-1 bg-green-500 text-white py-2 px-3 rounded text-sm font-medium hover:bg-green-600 transition-colors",children:"Approve"}),r.jsx("button",{onClick:()=>{o.trim()||i("")},className:"flex-1 bg-white text-slate-700 py-2 px-3 rounded text-sm font-medium border border-slate-300 hover:bg-slate-50 transition-colors",children:"Reject"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Rejection Reason (required to reject)"}),r.jsx("textarea",{value:o,onChange:m=>i(m.target.value),className:"w-full px-3 py-2 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-red-500 focus:border-transparent",rows:2,placeholder:"Explain why this is being rejected..."}),o.trim()&&r.jsx("button",{onClick:c,className:"mt-2 w-full bg-red-500 text-white py-2 px-3 rounded text-sm font-medium hover:bg-red-600 transition-colors",children:"Confirm Rejection"})]})]}),e.comments&&r.jsx("div",{className:"px-3 pb-3",children:r.jsxs("p",{className:"text-xs text-slate-500 italic",children:['"',e.comments,'"']})})]})},z1={name:"",description:"",sourceIp:"",destinationIp:"",port:"",protocol:"tcp",action:"allow",direction:"inbound"},Di={aws:{id:"aws",name:"AWS Security Group",category:"cloud",icon:"aws",description:"Amazon Web Services Security Groups",syntaxExample:"aws ec2 authorize-security-group-ingress ..."},azure:{id:"azure",name:"Azure NSG",category:"cloud",icon:"azure",description:"Azure Network Security Groups",syntaxExample:"az network nsg rule create ..."},gcp:{id:"gcp",name:"GCP Firewall",category:"cloud",icon:"gcp",description:"Google Cloud Platform Firewall Rules",syntaxExample:"gcloud compute firewall-rules create ..."},palo_alto:{id:"palo_alto",name:"Palo Alto",category:"firewall",icon:"firewall",description:"Palo Alto Networks PAN-OS",syntaxExample:"set rulebase security rules ..."},cisco_asa:{id:"cisco_asa",name:"Cisco ASA",category:"firewall",icon:"firewall",description:"Cisco Adaptive Security Appliance",syntaxExample:"access-list outside_access_in extended ..."},fortinet:{id:"fortinet",name:"Fortinet FortiGate",category:"firewall",icon:"firewall",description:"Fortinet FortiGate Firewall",syntaxExample:"config firewall policy ..."},iptables:{id:"iptables",name:"Linux iptables",category:"linux",icon:"linux",description:"Linux iptables/nftables",syntaxExample:"iptables -A INPUT -p tcp ..."}},$1=["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"],B1=()=>{const[e,t]=_.useState(z1),[n,a]=_.useState(["aws","azure","gcp"]),[s,o]=_.useState([]),[i,l]=_.useState([]),[c,d]=_.useState(!1),[u,m]=_.useState(!0),[g,v]=_.useState(null);_.useEffect(()=>{(async()=>{try{const A=await Xl.getTemplates();l(A)}catch(A){v(A instanceof Error?A.message:"Failed to load templates")}finally{m(!1)}})()},[]);const b=_.useCallback(k=>{t(A=>({...A,...k}))},[]),y=_.useCallback(k=>{a(A=>A.includes(k)?A.filter(I=>I!==k):[...A,k])},[]),O=_.useCallback(()=>{a($1)},[]),h=_.useCallback(()=>{a([])},[]),p=_.useCallback(async()=>{if(n.length===0){v("Please select at least one platform");return}d(!0),v(null);try{const k=await Xl.generateRules(e,n);o(k)}catch(k){v(k instanceof Error?k.message:"Failed to generate rules")}finally{d(!1)}},[e,n]),f=_.useCallback(k=>{t(k.input),a(k.platforms),o([])},[]),w=_.useCallback(()=>{o([])},[]),S=_.useCallback(()=>{v(null)},[]);return{input:e,selectedPlatforms:n,generatedRules:s,templates:i,isGenerating:c,isLoadingTemplates:u,error:g,setInput:t,updateInput:b,togglePlatform:y,selectAllPlatforms:O,clearPlatforms:h,generateRules:p,applyTemplate:f,clearOutput:w,clearError:S}},oc={web:{bg:"bg-blue-100",text:"text-blue-700"},database:{bg:"bg-purple-100",text:"text-purple-700"},application:{bg:"bg-green-100",text:"text-green-700"},management:{bg:"bg-amber-100",text:"text-amber-700"},security:{bg:"bg-red-100",text:"text-red-700"},custom:{bg:"bg-slate-100",text:"text-slate-700"}},Z1=()=>{const{input:e,selectedPlatforms:t,generatedRules:n,templates:a,isGenerating:s,error:o,updateInput:i,togglePlatform:l,selectAllPlatforms:c,clearPlatforms:d,generateRules:u,applyTemplate:m,clearOutput:g,clearError:v}=B1(),[b,y]=_.useState("input"),[O,h]=_.useState(null),p=async f=>{try{await navigator.clipboard.writeText(f.syntax),h(f.platform),setTimeout(()=>h(null),2e3)}catch{}};return r.jsx(re,{children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>y("input"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${b==="input"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Custom Rule"}),r.jsx("button",{onClick:()=>y("templates"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${b==="templates"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Templates"})]}),o&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{className:"text-red-700",children:o})]}),r.jsx("button",{onClick:v,className:"text-red-500 hover:text-red-700",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),b==="input"?r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Rule Configuration"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Rule Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:e.name,onChange:f=>i({name:f.target.value}),placeholder:"e.g., Allow-HTTPS-Inbound",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),r.jsx("input",{type:"text",value:e.description,onChange:f=>i({description:f.target.value}),placeholder:"Brief description of the rule",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source IP/CIDR"}),r.jsx("input",{type:"text",value:e.sourceIp,onChange:f=>i({sourceIp:f.target.value}),placeholder:"10.0.0.0/8 or * for any",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Destination IP/CIDR"}),r.jsx("input",{type:"text",value:e.destinationIp,onChange:f=>i({destinationIp:f.target.value}),placeholder:"192.168.1.0/24 or * for any",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Port"}),r.jsx("input",{type:"text",value:e.port,onChange:f=>i({port:f.target.value}),placeholder:"443 or 80-443",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Protocol"}),r.jsxs("select",{value:e.protocol,onChange:f=>i({protocol:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[r.jsx("option",{value:"tcp",children:"TCP"}),r.jsx("option",{value:"udp",children:"UDP"}),r.jsx("option",{value:"icmp",children:"ICMP"}),r.jsx("option",{value:"any",children:"Any"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Action"}),r.jsxs("select",{value:e.action,onChange:f=>i({action:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[r.jsx("option",{value:"allow",children:"Allow"}),r.jsx("option",{value:"deny",children:"Deny"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Direction"}),r.jsxs("select",{value:e.direction,onChange:f=>i({direction:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[r.jsx("option",{value:"inbound",children:"Inbound"}),r.jsx("option",{value:"outbound",children:"Outbound"}),r.jsx("option",{value:"both",children:"Both"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Priority (optional)"}),r.jsx("input",{type:"number",value:e.priority||"",onChange:f=>i({priority:f.target.value?parseInt(f.target.value):void 0}),placeholder:"100",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]})]}):r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Rule Templates"}),r.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:a.map(f=>r.jsx(q1,{template:f,onApply:()=>{m(f),y("input")}},f.id))})]}),r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Target Platforms"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:c,className:"text-sm text-cyan-600 hover:text-cyan-700",children:"Select All"}),r.jsx("span",{className:"text-slate-300",children:"|"}),r.jsx("button",{onClick:d,className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear"})]})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.values(Di).map(f=>r.jsx(K1,{platform:f,isSelected:t.includes(f.id),onToggle:()=>l(f.id)},f.id))})]}),r.jsx("button",{onClick:u,disabled:s||t.length===0,className:"w-full bg-cyan-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:s?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Generate Rules (",t.length," platforms)"]})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Generated Rules"}),n.length>0&&r.jsx("button",{onClick:g,className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear Output"})]}),n.length===0?r.jsx(R,{className:"bg-slate-50 border-2 border-dashed border-slate-200",children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),r.jsx("p",{className:"text-slate-500",children:"Configure a rule and select platforms to generate firewall rules"})]})}):r.jsx("div",{className:"space-y-4 max-h-[calc(100vh-250px)] overflow-y-auto",children:n.map(f=>r.jsx(Q1,{rule:f,onCopy:()=>p(f),isCopied:O===f.platform},f.platform))})]})]})})},q1=({template:e,onApply:t})=>{const n=oc[e.category]||oc.custom;return r.jsx("div",{className:"border border-slate-200 rounded-lg p-3 hover:border-cyan-300 hover:bg-cyan-50/30 transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h4",{className:"font-medium text-slate-800",children:e.name}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${n.bg} ${n.text}`,children:e.category})]}),r.jsx("p",{className:"text-sm text-slate-500 mb-2",children:e.description}),r.jsxs("div",{className:"flex gap-1",children:[e.platforms.slice(0,4).map(a=>{var s;return r.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded",children:((s=Di[a])==null?void 0:s.name.split(" ")[0])||a},a)}),e.platforms.length>4&&r.jsxs("span",{className:"text-xs text-slate-400",children:["+",e.platforms.length-4]})]})]}),r.jsx("button",{onClick:t,className:"text-cyan-600 hover:text-cyan-700 hover:bg-cyan-100 p-2 rounded-lg transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},K1=({platform:e,isSelected:t,onToggle:n})=>{const a={cloud:"border-blue-200 bg-blue-50",firewall:"border-orange-200 bg-orange-50",linux:"border-slate-200 bg-slate-50"};return r.jsx("button",{onClick:n,className:`p-3 rounded-lg border-2 text-left transition-all ${t?"border-cyan-500 bg-cyan-50 ring-2 ring-cyan-200":a[e.category]||"border-slate-200 bg-white"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center ${t?"border-cyan-500 bg-cyan-500":"border-slate-300"}`,children:t&&r.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),r.jsx("span",{className:`text-sm font-medium ${t?"text-cyan-700":"text-slate-700"}`,children:e.name})]})})},Q1=({rule:e,onCopy:t,isCopied:n})=>{const a=Di[e.platform];return r.jsxs(R,{className:"bg-white shadow-lg overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`w-8 h-8 rounded flex items-center justify-center text-white ${a.category==="cloud"?"bg-blue-500":a.category==="firewall"?"bg-orange-500":"bg-slate-500"}`,children:a.name.charAt(0)}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-slate-800",children:a.name}),r.jsx("p",{className:"text-xs text-slate-500",children:a.description})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[e.isValid?r.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:"Valid"}):r.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded",children:"Invalid"}),r.jsx("button",{onClick:t,disabled:!e.isValid,className:"p-2 text-slate-500 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors disabled:opacity-50",title:"Copy to clipboard",children:n?r.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e.warnings&&e.warnings.length>0&&r.jsx("div",{className:"mb-3",children:e.warnings.map((s,o)=>r.jsxs("div",{className:"flex items-start gap-2 text-amber-700 bg-amber-50 p-2 rounded text-sm mb-1",children:[r.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsx("span",{children:s})]},o))}),e.validationErrors&&e.validationErrors.length>0&&r.jsx("div",{className:"mb-3",children:e.validationErrors.map((s,o)=>r.jsxs("div",{className:"flex items-start gap-2 text-red-700 bg-red-50 p-2 rounded text-sm mb-1",children:[r.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{children:s})]},o))}),e.syntax&&r.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-sm font-mono whitespace-pre-wrap",children:e.syntax})]})},Y1=()=>{const[e,t]=_.useState("aws"),[n,a]=_.useState(""),[s,o]=_.useState(null),[i,l]=_.useState([]),[c,d]=_.useState([]),[u,m]=_.useState(!1),[g,v]=_.useState(!0),[b,y]=_.useState(null);_.useEffect(()=>{(async()=>{try{const k=await ln.getValidationHistory();d(k)}catch(k){y(k instanceof Error?k.message:"Failed to load history")}finally{v(!1)}})()},[]);const O=_.useCallback(async()=>{if(!n.trim()){y("Please enter rule content to validate");return}m(!0),y(null);try{const[S,k]=await Promise.all([ln.validateRules(e,n),ln.runSecurityAnalysis(n)]);o(S),l(k);const A=await ln.getValidationHistory();d(A)}catch(S){y(S instanceof Error?S.message:"Validation failed")}finally{m(!1)}},[e,n]),h=_.useCallback(async()=>{if(!n.trim()){y("Please enter rule content to analyze");return}m(!0),y(null);try{const S=await ln.runSecurityAnalysis(n);l(S)}catch(S){y(S instanceof Error?S.message:"Security analysis failed")}finally{m(!1)}},[n]),p=_.useCallback(()=>{o(null),l([])},[]),f=_.useCallback(async()=>{try{await ln.clearHistory(),d([])}catch(S){y(S instanceof Error?S.message:"Failed to clear history")}},[]),w=_.useCallback(()=>{y(null)},[]);return{platform:e,content:n,result:s,securityChecks:i,history:c,isValidating:u,isLoadingHistory:g,error:b,setPlatform:t,setContent:a,validate:O,runSecurityAnalysis:h,clearResult:p,clearHistory:f,clearError:w}},ic={aws:`# AWS Security Group Rules (CLI format)
aws ec2 authorize-security-group-ingress \\
  --group-id sg-12345678 \\
  --protocol tcp \\
  --port 443 \\
  --cidr 10.0.0.0/8

aws ec2 authorize-security-group-ingress \\
  --group-id sg-12345678 \\
  --protocol tcp \\
  --port 22 \\
  --cidr 10.0.0.0/8`,azure:`# Azure NSG Rules (CLI format)
az network nsg rule create \\
  --resource-group myRG \\
  --nsg-name myNSG \\
  --name Allow-HTTPS \\
  --priority 100 \\
  --direction Inbound \\
  --access Allow \\
  --protocol Tcp \\
  --source-address-prefixes 10.0.0.0/8 \\
  --destination-port-ranges 443`,gcp:`# GCP Firewall Rules (gcloud format)
gcloud compute firewall-rules create allow-https \\
  --network=my-vpc \\
  --direction=INGRESS \\
  --action=ALLOW \\
  --rules=tcp:443 \\
  --source-ranges=10.0.0.0/8`,palo_alto:`# Palo Alto PAN-OS Rules
set rulebase security rules "Allow-HTTPS" from untrust to trust
set rulebase security rules "Allow-HTTPS" source any
set rulebase security rules "Allow-HTTPS" destination 10.0.0.0/8
set rulebase security rules "Allow-HTTPS" application ssl
set rulebase security rules "Allow-HTTPS" service application-default
set rulebase security rules "Allow-HTTPS" action allow`,cisco_asa:`! Cisco ASA Access List
access-list outside_access_in extended permit tcp any host 10.0.0.50 eq 443
access-list outside_access_in extended permit tcp 10.0.0.0 255.0.0.0 any eq 22
access-list outside_access_in extended deny ip any any log`,fortinet:`# FortiGate Firewall Policy
config firewall policy
    edit 1
        set name "Allow-HTTPS"
        set srcintf "wan1"
        set dstintf "lan"
        set srcaddr "all"
        set dstaddr "webservers"
        set action accept
        set schedule "always"
        set service "HTTPS"
        set logtraffic all
    next
end`,iptables:`# Linux iptables Rules
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp --dport 22 -s 10.0.0.0/8 -j ACCEPT
iptables -A INPUT -p tcp --dport 3306 -s 10.1.0.0/16 -j ACCEPT
iptables -A INPUT -j DROP`},ga=[{id:"aws",name:"AWS Security Group",category:"cloud"},{id:"azure",name:"Azure NSG",category:"cloud"},{id:"gcp",name:"GCP Firewall",category:"cloud"},{id:"palo_alto",name:"Palo Alto",category:"firewall"},{id:"cisco_asa",name:"Cisco ASA",category:"firewall"},{id:"fortinet",name:"Fortinet",category:"firewall"},{id:"iptables",name:"iptables",category:"linux"}],X1=()=>{var y,O;const{platform:e,content:t,result:n,securityChecks:a,history:s,isValidating:o,error:i,setPlatform:l,setContent:c,validate:d,clearResult:u,clearError:m}=Y1(),[g,v]=_.useState(!1),b=()=>{c(ic[e]),v(!1),u()};return r.jsx(re,{children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Select Platform"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:ga.map(h=>r.jsx("button",{onClick:()=>{l(h.id),u()},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${e===h.id?"bg-cyan-500 text-white":h.category==="cloud"?"bg-blue-50 text-blue-700 hover:bg-blue-100":h.category==="firewall"?"bg-orange-50 text-orange-700 hover:bg-orange-100":"bg-slate-50 text-slate-700 hover:bg-slate-100"}`,children:h.name},h.id))})]}),i&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("span",{className:"text-red-700",children:i})]}),r.jsx("button",{onClick:m,className:"text-red-500 hover:text-red-700",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Rule Content"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>v(!g),className:"text-sm text-cyan-600 hover:text-cyan-700",children:g?"Hide Example":"Show Example"}),r.jsx("span",{className:"text-slate-300",children:"|"}),r.jsx("button",{onClick:()=>{c(""),u()},className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear"})]})]}),g&&r.jsxs("div",{className:"mb-4 p-3 bg-slate-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("span",{className:"text-sm text-slate-600",children:["Example for ",(y=ga.find(h=>h.id===e))==null?void 0:y.name]}),r.jsx("button",{onClick:b,className:"text-sm text-cyan-600 hover:text-cyan-700 font-medium",children:"Load Example"})]}),r.jsxs("pre",{className:"text-xs text-slate-500 overflow-x-auto whitespace-pre-wrap",children:[ic[e].substring(0,200),"..."]})]}),r.jsx("textarea",{value:t,onChange:h=>c(h.target.value),placeholder:`Enter ${(O=ga.find(h=>h.id===e))==null?void 0:O.name} rules to validate...`,className:"w-full h-64 px-4 py-3 font-mono text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent resize-none",spellCheck:!1}),r.jsx("div",{className:"flex gap-4 mt-4",children:r.jsx("button",{onClick:d,disabled:o||!t.trim(),className:"flex-1 bg-cyan-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:o?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Validating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Validate Rules"]})})})]}),n&&r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Validation Results"}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${n.isValid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:n.isValid?"Valid":"Invalid"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[r.jsx(Hs,{label:"Syntax",score:n.syntaxScore}),r.jsx(Hs,{label:"Security",score:n.securityScore}),r.jsx(Hs,{label:"Compliance",score:n.complianceScore})]}),n.issues.length>0?r.jsxs("div",{children:[r.jsxs("h4",{className:"font-medium text-slate-700 mb-3",children:["Issues Found (",n.issues.length,")"]}),r.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:n.issues.map(h=>r.jsx(J1,{issue:h},h.id))})]}):r.jsxs("div",{className:"text-center py-8 text-green-600",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"font-medium",children:"No issues found!"}),r.jsx("p",{className:"text-sm text-slate-500",children:"Your rules passed all validation checks."})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[a.length>0&&r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Security Analysis"}),r.jsx("div",{className:"space-y-2",children:a.map(h=>r.jsx(eh,{check:h},h.id))})]}),r.jsxs(R,{className:"bg-white shadow-lg",children:[r.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Recent Validations"}),s.length===0?r.jsx("p",{className:"text-center text-slate-500 py-4",children:"No validation history"}):r.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:s.map(h=>r.jsx(th,{item:h},h.id))})]}),r.jsxs(R,{className:"bg-gradient-to-br from-cyan-500 to-blue-600 text-white shadow-lg",children:[r.jsx("h3",{className:"font-semibold mb-3",children:"Validation Tips"}),r.jsxs("ul",{className:"space-y-2 text-sm text-cyan-100",children:[r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-cyan-200 mt-0.5",children:"1."}),r.jsx("span",{children:"Never open SSH (22) or RDP (3389) to 0.0.0.0/0"})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-cyan-200 mt-0.5",children:"2."}),r.jsx("span",{children:'Use specific IP ranges instead of "any" when possible'})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-cyan-200 mt-0.5",children:"3."}),r.jsx("span",{children:"Keep database ports restricted to internal networks"})]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-cyan-200 mt-0.5",children:"4."}),r.jsx("span",{children:"Use HTTPS instead of HTTP for web traffic"})]})]})]})]})]})})},Hs=({label:e,score:t})=>{const n=s=>s>=90?"text-green-600":s>=70?"text-amber-600":"text-red-600",a=s=>s>=90?"bg-green-500":s>=70?"bg-amber-500":"bg-red-500";return r.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[r.jsx("p",{className:"text-sm text-slate-500 mb-1",children:e}),r.jsxs("p",{className:`text-2xl font-bold ${n(t)}`,children:[t,"%"]}),r.jsx("div",{className:"w-full h-2 bg-slate-200 rounded-full mt-2",children:r.jsx("div",{className:`h-full rounded-full transition-all ${a(t)}`,style:{width:`${t}%`}})})]})},J1=({issue:e})=>{const n={error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",icon:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},warning:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700",icon:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}[e.severity];return r.jsx("div",{className:`${n.bg} ${n.border} border rounded-lg p-3`,children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("svg",{className:`w-5 h-5 ${n.text} flex-shrink-0 mt-0.5`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n.icon})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.line>0&&r.jsxs("span",{className:"text-xs bg-slate-200 text-slate-600 px-1.5 py-0.5 rounded",children:["Line ",e.line]}),r.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${e.category==="syntax"?"bg-purple-100 text-purple-700":e.category==="security"?"bg-red-100 text-red-700":e.category==="compliance"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:e.category})]}),r.jsx("p",{className:`text-sm ${n.text}`,children:e.message}),e.suggestion&&r.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Suggestion:"})," ",e.suggestion]})]})]})})},eh=({check:e})=>{const n={pass:{bg:"bg-green-50",text:"text-green-700",icon:"M5 13l4 4L19 7"},fail:{bg:"bg-red-50",text:"text-red-700",icon:"M6 18L18 6M6 6l12 12"},warning:{bg:"bg-amber-50",text:"text-amber-700",icon:"M12 9v2m0 4h.01"},skipped:{bg:"bg-slate-50",text:"text-slate-500",icon:"M20 12H4"}}[e.status];return r.jsx("div",{className:`${n.bg} rounded-lg p-3`,children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${n.text}`,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:n.icon})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:`text-sm font-medium ${n.text}`,children:e.name}),r.jsx("p",{className:"text-xs text-slate-500",children:e.description}),e.details&&r.jsx("p",{className:"text-xs text-slate-600 mt-1",children:e.details})]})]})})},th=({item:e})=>{var n;const t=((n=ga.find(a=>a.id===e.platform))==null?void 0:n.name)||e.platform;return r.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"text-sm font-medium text-slate-800",children:t}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.isValid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.isValid?"Valid":"Invalid"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[r.jsxs("span",{children:[e.ruleCount," rules"]}),r.jsxs("span",{children:[e.issueCount," issues"]})]}),r.jsx("p",{className:"text-xs text-slate-400 mt-1 truncate font-mono",children:e.snippet}),r.jsx("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]})},nh=()=>r.jsx(re,{children:r.jsx(R,{className:"bg-white shadow-lg",children:r.jsx("div",{className:"text-center py-16 text-gray-400",children:"Conflict Detection View - Allow/Deny conflicts and shadowing detection"})})}),rh=()=>{const[e,t]=_.useState(null),[n,a]=_.useState([]),[s,o]=_.useState("cloud"),[i,l]=_.useState(!0),[c,d]=_.useState(null),[u,m]=_.useState(null),[g,v]=_.useState(null),b=_.useCallback(async()=>{try{l(!0),d(null);const N=await ke.getSettings();t(N)}catch(N){d(N instanceof Error?N.message:"Failed to load settings")}finally{l(!1)}},[]);_.useEffect(()=>{b()},[b]);const y=_.useCallback(async N=>{m(N),v(null);try{const x=await ke.testCloudConnection(N);v(x)}catch(x){v({success:!1,message:x instanceof Error?x.message:"Test failed"})}finally{m(null)}},[]),O=_.useCallback(async(N,x)=>{try{const j=await ke.updateCloudConnection(N,x);t(M=>M&&{...M,cloudConnections:M.cloudConnections.map(de=>de.id===N?j:de)})}catch(j){d(j instanceof Error?j.message:"Failed to update connection")}},[]),h=_.useCallback(async N=>{try{const x=await ke.addCloudConnection(N);t(j=>j&&{...j,cloudConnections:[...j.cloudConnections,x]})}catch(x){d(x instanceof Error?x.message:"Failed to add connection")}},[]),p=_.useCallback(async N=>{try{await ke.deleteCloudConnection(N),t(x=>x&&{...x,cloudConnections:x.cloudConnections.filter(j=>j.id!==N)})}catch(x){d(x instanceof Error?x.message:"Failed to delete connection")}},[]),f=_.useCallback(async N=>{try{const x=await ke.updateServiceNowConfig(N);t(j=>j&&{...j,serviceNow:x})}catch(x){d(x instanceof Error?x.message:"Failed to update ServiceNow config")}},[]),w=_.useCallback(async()=>{m("servicenow"),v(null);try{const N=await ke.testServiceNowConnection();v(N)}catch(N){v({success:!1,message:N instanceof Error?N.message:"Test failed"})}finally{m(null)}},[]),S=_.useCallback(async N=>{try{const x=await ke.updateSIEMConfig(N);t(j=>j&&{...j,siem:x})}catch(x){d(x instanceof Error?x.message:"Failed to update SIEM config")}},[]),k=_.useCallback(async N=>{try{const x=await ke.updateAPMConfig(N);t(j=>j&&{...j,apm:x})}catch(x){d(x instanceof Error?x.message:"Failed to update APM config")}},[]),A=_.useCallback(async N=>{try{const x=await ke.addUser(N);t(j=>j&&{...j,users:[...j.users,x]})}catch(x){d(x instanceof Error?x.message:"Failed to add user")}},[]),I=_.useCallback(async(N,x)=>{try{const j=await ke.updateUser(N,x);t(M=>M&&{...M,users:M.users.map(de=>de.id===N?j:de)})}catch(j){d(j instanceof Error?j.message:"Failed to update user")}},[]),T=_.useCallback(async N=>{try{await ke.deleteUser(N),t(x=>x&&{...x,users:x.users.filter(j=>j.id!==N)})}catch(x){d(x instanceof Error?x.message:"Failed to delete user")}},[]),E=_.useCallback(async N=>{try{const x=await ke.updateNotificationPreferences(N);t(j=>j&&{...j,notifications:x})}catch(x){d(x instanceof Error?x.message:"Failed to update notification preferences")}},[]),H=_.useCallback(async N=>{try{const x=await ke.getAuditLogs(N);a(x)}catch(x){d(x instanceof Error?x.message:"Failed to load audit logs")}},[]),U=_.useCallback(()=>{v(null)},[]);return{settings:e,auditLogs:n,activeTab:s,isLoading:i,error:c,testingConnection:u,testResult:g,setActiveTab:o,testCloudConnection:y,updateCloudConnection:O,addCloudConnection:h,deleteCloudConnection:p,updateServiceNowConfig:f,testServiceNowConnection:w,updateSIEMConfig:S,updateAPMConfig:k,addUser:A,updateUser:I,deleteUser:T,updateNotificationPreferences:E,loadAuditLogs:H,clearTestResult:U,refreshSettings:b}},ah=[{id:"cloud",label:"Cloud Connections",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})},{id:"servicenow",label:"ServiceNow",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})},{id:"siem",label:"SIEM",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},{id:"apm",label:"APM",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"users",label:"Users",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{id:"notifications",label:"Notifications",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})},{id:"audit",label:"Audit Logs",icon:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}],sh=({activeTab:e,onTabChange:t})=>r.jsx("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-2",children:r.jsx("nav",{className:"flex flex-col gap-1",children:ah.map(n=>{const a=e===n.id;return r.jsxs("button",{onClick:()=>t(n.id),className:`flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-all ${a?"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 text-cyan-400 border border-cyan-500/30":"text-slate-400 hover:bg-slate-700/50 hover:text-white"}`,children:[n.icon,r.jsx("span",{className:"font-medium",children:n.label})]},n.id)})})}),oh={aws:{name:"AWS",color:"from-orange-500 to-orange-600",icon:r.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 01-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 01-.287-.375 6.18 6.18 0 01-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 01-.28.104.488.488 0 01-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 01.224-.167c.279-.144.614-.264 1.005-.36a4.84 4.84 0 011.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 00-.735-.136 6.02 6.02 0 00-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 01-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 01.32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 01.311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 01-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 01-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 01-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 00.415-.758.777.777 0 00-.215-.559c-.144-.151-.415-.287-.806-.407l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 01-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 01.24.2.43.43 0 01.071.263v.375c0 .168-.064.256-.184.256a.83.83 0 01-.303-.096 3.652 3.652 0 00-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167z"})})},azure:{name:"Azure",color:"from-blue-500 to-blue-600",icon:r.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M5.483 21.3H24L14.025 4.013l-3.038 8.347 5.836 6.938L5.483 21.3zM13.23 2.7L6.105 8.677 0 19.253h5.505l7.725-16.553z"})})},gcp:{name:"GCP",color:"from-red-500 to-yellow-500",icon:r.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12.19 2.38a9.344 9.344 0 00-9.234 6.893c.053-.02-.055.013 0 0-3.875 2.551-3.922 8.11-.247 10.941l.006-.007-.007.03a6.717 6.717 0 006.212 3.76h10.39c2.51-.034 4.659-1.9 5.42-4.287a5.91 5.91 0 00-.49-4.643 5.906 5.906 0 00-3.83-2.799l-.006-.004-.001-.009A9.34 9.34 0 0012.19 2.38zm-.358 4.146c1.244-.04 2.518.368 3.486 1.15a5.186 5.186 0 011.862 4.078v.518c3.53-.07 3.53 5.262 0 5.193h-5.193v-.518c-1.243.04-2.517-.368-3.485-1.15a5.186 5.186 0 01-1.863-4.078v-.518c-3.53.07-3.53-5.262 0-5.193h5.193v.518z"})})},onprem:{name:"On-Premises",color:"from-slate-500 to-slate-600",icon:r.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})})}},ih={connected:{label:"Connected",variant:"success"},disconnected:{label:"Disconnected",variant:"default"},error:{label:"Error",variant:"error"},pending:{label:"Pending",variant:"warning"}},lh=({connections:e,testingConnection:t,testResult:n,onTestConnection:a,onAddConnection:s,onDeleteConnection:o,onClearTestResult:i})=>{const[l,c]=_.useState(null),d=u=>u?new Date(u).toLocaleString():"Never";return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"Cloud Connections"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Manage connections to AWS, Azure, GCP, and On-Premises infrastructure"})]}),r.jsxs(G,{variant:"primary",size:"md",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Connection"]})]}),n&&r.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between ${n.success?"bg-emerald-500/20 border border-emerald-500/30":"bg-red-500/20 border border-red-500/30"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[n.success?r.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),r.jsx("span",{className:n.success?"text-emerald-400":"text-red-400",children:n.message})]}),r.jsx("button",{onClick:i,className:"text-slate-400 hover:text-white",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"grid gap-4",children:e.map(u=>{const m=oh[u.provider],g=ih[u.status],v=l===u.id,b=t===u.id;return r.jsxs(R,{padding:"none",className:"overflow-hidden",children:[r.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>c(v?null:u.id),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${m.color} flex items-center justify-center text-white`,children:m.icon}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"font-bold text-white",children:u.name}),r.jsx(ae,{variant:g.variant,size:"sm",children:g.label})]}),r.jsxs("p",{className:"text-sm text-slate-400",children:[m.name," ",u.region&&`- ${u.region}`]})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(G,{variant:"secondary",size:"sm",isLoading:b,onClick:y=>{y.stopPropagation(),a(u.id)},children:"Test Connection"}),r.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${v?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),v&&r.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-slate-700",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Account/Project ID"}),r.jsx("p",{className:"text-sm text-slate-300 font-mono",children:u.accountId||u.subscriptionId||u.projectId||u.datacenterName||"-"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Last Sync"}),r.jsx("p",{className:"text-sm text-slate-300",children:d(u.lastSync)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Credentials Type"}),r.jsx("p",{className:"text-sm text-slate-300 capitalize",children:u.credentials.type.replace("_"," ")})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Credentials Status"}),r.jsx(ae,{variant:u.credentials.configured?"success":"warning",size:"sm",children:u.credentials.configured?"Configured":"Not Configured"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(G,{variant:"ghost",size:"sm",children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),r.jsxs(G,{variant:"ghost",size:"sm",children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sync Now"]}),r.jsxs(G,{variant:"danger",size:"sm",onClick:y=>{y.stopPropagation(),o(u.id)},children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})]},u.id)})})]})},ch=({config:e,testingConnection:t,testResult:n,onUpdate:a,onTestConnection:s,onClearTestResult:o})=>{const[i,l]=_.useState(!1),[c,d]=_.useState(e),u=()=>{a(c),l(!1)},m=()=>{d(e),l(!1)},g=t==="servicenow";return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"ServiceNow Integration"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Configure ServiceNow ITSM integration for ticket management"})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(ae,{variant:e.isConfigured?"success":"warning",size:"lg",children:e.isConfigured?"Configured":"Not Configured"})})]}),n&&r.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between ${n.success?"bg-emerald-500/20 border border-emerald-500/30":"bg-red-500/20 border border-red-500/30"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[n.success?r.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),r.jsx("span",{className:n.success?"text-emerald-400":"text-red-400",children:n.message})]}),r.jsx("button",{onClick:o,className:"text-slate-400 hover:text-white",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Connection Settings",action:!i&&r.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>l(!0),children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Instance URL"}),i?r.jsx("input",{type:"url",value:c.instanceUrl,onChange:v=>d({...c,instanceUrl:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://your-instance.service-now.com"}):r.jsx("p",{className:"text-white font-mono",children:e.instanceUrl})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Username"}),i?r.jsx("input",{type:"text",value:c.username,onChange:v=>d({...c,username:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"}):r.jsx("p",{className:"text-white font-mono",children:e.username})]})]}),i&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Password"}),r.jsx("input",{type:"password",placeholder:"Enter new password to change",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),i&&r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(G,{variant:"primary",size:"sm",onClick:u,children:"Save Changes"}),r.jsx(G,{variant:"ghost",size:"sm",onClick:m,children:"Cancel"})]}),!i&&r.jsx(G,{variant:"secondary",size:"sm",isLoading:g,onClick:s,children:"Test Connection"})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Ticket Settings"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Auto-Create Tickets"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Automatically create tickets for critical alerts"})]}),r.jsx("button",{onClick:()=>a({autoCreateTickets:!e.autoCreateTickets}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.autoCreateTickets?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.autoCreateTickets?"translate-x-6":"translate-x-1"}`})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Default Assignment Group"}),r.jsxs("select",{value:e.defaultAssignmentGroup,onChange:v=>a({defaultAssignmentGroup:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"Network Operations",children:"Network Operations"}),r.jsx("option",{value:"Security Operations",children:"Security Operations"}),r.jsx("option",{value:"Cloud Infrastructure",children:"Cloud Infrastructure"}),r.jsx("option",{value:"Application Support",children:"Application Support"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Default Priority"}),r.jsxs("select",{value:e.defaultPriority,onChange:v=>a({defaultPriority:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"low",children:"Low"}),r.jsx("option",{value:"medium",children:"Medium"}),r.jsx("option",{value:"high",children:"High"}),r.jsx("option",{value:"critical",children:"Critical"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Sync Interval (minutes)"}),r.jsx("input",{type:"number",min:"1",max:"60",value:e.syncInterval,onChange:v=>a({syncInterval:parseInt(v.target.value,10)}),className:"w-32 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]})]})]})},dh=[{value:"splunk",label:"Splunk",icon:"S"},{value:"qradar",label:"IBM QRadar",icon:"Q"},{value:"sentinel",label:"Microsoft Sentinel",icon:"M"},{value:"elastic",label:"Elastic Security",icon:"E"},{value:"none",label:"None",icon:"-"}],uh=({config:e,onUpdate:t})=>r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"SIEM Integration"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Configure Security Information and Event Management integration"})]}),r.jsx(ae,{variant:e.isConfigured?"success":"warning",size:"lg",children:e.isConfigured?"Configured":"Not Configured"})]}),r.jsxs(R,{children:[r.jsx(J,{title:"SIEM Platform"}),r.jsx("div",{className:"grid grid-cols-5 gap-3",children:dh.map(n=>r.jsxs("button",{onClick:()=>t({type:n.value}),className:`p-4 rounded-lg border-2 transition-all ${e.type===n.value?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[r.jsx("div",{className:`w-10 h-10 mx-auto mb-2 rounded-lg flex items-center justify-center text-lg font-bold ${e.type===n.value?"bg-cyan-500 text-white":"bg-slate-700 text-slate-400"}`,children:n.icon}),r.jsx("p",{className:`text-sm font-medium text-center ${e.type===n.value?"text-cyan-400":"text-slate-400"}`,children:n.label})]},n.value))})]}),e.type!=="none"&&r.jsxs(r.Fragment,{children:[r.jsxs(R,{children:[r.jsx(J,{title:"Connection Settings"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Endpoint"}),r.jsx("input",{type:"url",value:e.endpoint,onChange:n=>t({endpoint:n.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://your-siem.example.com:8089"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Key / Token"}),r.jsx("input",{type:"password",placeholder:"Enter API key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Index / Data Source"}),r.jsx("input",{type:"text",placeholder:"main",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),r.jsx(G,{variant:"secondary",size:"sm",children:"Test Connection"})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Data Forwarding"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Forward Alerts"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Send security alerts to SIEM platform"})]}),r.jsx("button",{onClick:()=>t({forwardAlerts:!e.forwardAlerts}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.forwardAlerts?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.forwardAlerts?"translate-x-6":"translate-x-1"}`})})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Forward Logs"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Send audit and system logs to SIEM"})]}),r.jsx("button",{onClick:()=>t({forwardLogs:!e.forwardLogs}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.forwardLogs?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.forwardLogs?"translate-x-6":"translate-x-1"}`})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Alert Severity Threshold"}),r.jsxs("select",{value:e.alertSeverityThreshold,onChange:n=>t({alertSeverityThreshold:n.target.value}),className:"w-48 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"low",children:"Low and above"}),r.jsx("option",{value:"medium",children:"Medium and above"}),r.jsx("option",{value:"high",children:"High and above"}),r.jsx("option",{value:"critical",children:"Critical only"})]}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Only forward alerts at or above this severity"})]})]})]})]})]}),ph=[{value:"datadog",label:"Datadog",color:"from-purple-500 to-purple-600"},{value:"newrelic",label:"New Relic",color:"from-teal-500 to-teal-600"},{value:"dynatrace",label:"Dynatrace",color:"from-blue-500 to-blue-600"},{value:"appdynamics",label:"AppDynamics",color:"from-cyan-500 to-cyan-600"},{value:"none",label:"None",color:"from-slate-500 to-slate-600"}],mh=({config:e,onUpdate:t})=>r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"APM Integration"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Configure Application Performance Monitoring integration"})]}),r.jsx(ae,{variant:e.isConfigured?"success":"warning",size:"lg",children:e.isConfigured?"Configured":"Not Configured"})]}),r.jsxs(R,{children:[r.jsx(J,{title:"APM Platform"}),r.jsx("div",{className:"grid grid-cols-5 gap-3",children:ph.map(n=>r.jsxs("button",{onClick:()=>t({type:n.value}),className:`p-4 rounded-lg border-2 transition-all ${e.type===n.value?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[r.jsx("div",{className:`w-10 h-10 mx-auto mb-2 rounded-lg bg-gradient-to-br ${n.color} flex items-center justify-center text-white font-bold`,children:n.label.charAt(0)}),r.jsx("p",{className:`text-sm font-medium text-center ${e.type===n.value?"text-cyan-400":"text-slate-400"}`,children:n.label})]},n.value))})]}),e.type!=="none"&&r.jsxs(r.Fragment,{children:[r.jsxs(R,{children:[r.jsx(J,{title:"Connection Settings"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Endpoint"}),r.jsx("input",{type:"url",value:e.apiEndpoint,onChange:n=>t({apiEndpoint:n.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://api.datadoghq.com"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Key"}),r.jsx("input",{type:"password",placeholder:"Enter API key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Application Key"}),r.jsx("input",{type:"password",placeholder:"Enter application key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),r.jsx(G,{variant:"secondary",size:"sm",children:"Test Connection"})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Data Collection"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Collect Metrics"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Import application metrics from APM platform"})]}),r.jsx("button",{onClick:()=>t({collectMetrics:!e.collectMetrics}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.collectMetrics?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.collectMetrics?"translate-x-6":"translate-x-1"}`})})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Collect Traces"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Import distributed traces for path analysis"})]}),r.jsx("button",{onClick:()=>t({collectTraces:!e.collectTraces}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.collectTraces?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.collectTraces?"translate-x-6":"translate-x-1"}`})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Sample Rate"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:e.sampleRate,onChange:n=>t({sampleRate:parseFloat(n.target.value)}),className:"flex-1 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),r.jsxs("span",{className:"text-white font-mono w-16 text-right",children:[(e.sampleRate*100).toFixed(0),"%"]})]}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Percentage of traces to collect. Lower values reduce overhead."})]})]})]})]})]}),Ut={admin:{label:"Administrator",color:"bg-purple-500/20 text-purple-400",description:"Full access to all features and settings"},operator:{label:"Operator",color:"bg-blue-500/20 text-blue-400",description:"Can manage rules and view all dashboards"},viewer:{label:"Viewer",color:"bg-slate-500/20 text-slate-400",description:"Read-only access to dashboards"},auditor:{label:"Auditor",color:"bg-amber-500/20 text-amber-400",description:"Can view audit logs and export reports"}},Ou={admin:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!0,canModifySettings:!0,canViewAuditLogs:!0,canManageUsers:!0,canExportData:!0},operator:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!0},viewer:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!1},auditor:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!0,canManageUsers:!1,canExportData:!0}},gh=({onClose:e,onAdd:t})=>{const[n,a]=_.useState({email:"",name:"",role:"viewer"}),s=o=>{o.preventDefault(),t({...n,status:"pending",permissions:Ou[n.role]}),e()};return r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-6 w-full max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Add New User"}),r.jsxs("form",{onSubmit:s,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Email"}),r.jsx("input",{type:"email",required:!0,value:n.email,onChange:o=>a({...n,email:o.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"user@company.com"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Full Name"}),r.jsx("input",{type:"text",required:!0,value:n.name,onChange:o=>a({...n,name:o.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"John Doe"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Role"}),r.jsx("select",{value:n.role,onChange:o=>a({...n,role:o.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:Object.entries(Ut).map(([o,{label:i}])=>r.jsx("option",{value:o,children:i},o))}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:Ut[n.role].description})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(G,{type:"submit",variant:"primary",children:"Add User"}),r.jsx(G,{type:"button",variant:"ghost",onClick:e,children:"Cancel"})]})]})]})})},fh=({users:e,onAddUser:t,onUpdateUser:n,onDeleteUser:a})=>{const[s,o]=_.useState(!1),[i,l]=_.useState(null),c=u=>u?new Date(u).toLocaleString():"Never",d=i?e.find(u=>u.id===i):null;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"User Management"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Manage user accounts and permissions"})]}),r.jsxs(G,{variant:"primary",onClick:()=>o(!0),children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Role Permissions Matrix"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-slate-700",children:[r.jsx("th",{className:"text-left py-2 px-3 text-slate-400 font-medium",children:"Permission"}),Object.entries(Ut).map(([u,{label:m}])=>r.jsx("th",{className:"text-center py-2 px-3 text-slate-400 font-medium",children:m},u))]})}),r.jsx("tbody",{children:[{key:"canViewDashboard",label:"View Dashboards"},{key:"canManageRules",label:"Manage Rules"},{key:"canApproveTickets",label:"Approve Tickets"},{key:"canModifySettings",label:"Modify Settings"},{key:"canViewAuditLogs",label:"View Audit Logs"},{key:"canManageUsers",label:"Manage Users"},{key:"canExportData",label:"Export Data"}].map(u=>r.jsxs("tr",{className:"border-b border-slate-700/50",children:[r.jsx("td",{className:"py-2 px-3 text-slate-300",children:u.label}),Object.keys(Ut).map(m=>r.jsx("td",{className:"text-center py-2 px-3",children:Ou[m][u.key]?r.jsx("svg",{className:"w-5 h-5 text-emerald-400 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-5 h-5 text-slate-600 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})},m))]},u.key))})]})})]}),r.jsxs(R,{children:[r.jsx(J,{title:`Users (${e.length})`}),r.jsx("div",{className:"divide-y divide-slate-700",children:e.map(u=>r.jsxs("div",{className:"py-3 flex items-center justify-between hover:bg-slate-700/30 -mx-6 px-6 cursor-pointer",onClick:()=>l(u.id===i?null:u.id),children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white font-bold",children:u.name.charAt(0).toUpperCase()}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("p",{className:"text-white font-medium",children:u.name}),r.jsx(ae,{variant:u.status==="active"?"success":u.status==="pending"?"warning":"default",size:"sm",children:u.status})]}),r.jsx("p",{className:"text-sm text-slate-400",children:u.email})]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Ut[u.role].color}`,children:Ut[u.role].label}),r.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${i===u.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]},u.id))})]}),d&&r.jsxs(R,{children:[r.jsx(J,{title:`User Details: ${d.name}`,action:r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>{const u=d.status==="active"?"inactive":"active";n(d.id,{status:u})},children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),d.status==="active"?"Deactivate":"Activate"]}),r.jsxs(G,{variant:"danger",size:"sm",onClick:()=>{a(d.id),l(null)},children:[r.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Email"}),r.jsx("p",{className:"text-slate-300",children:d.email})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Role"}),r.jsx("p",{className:"text-slate-300",children:Ut[d.role].label})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Created"}),r.jsx("p",{className:"text-slate-300",children:c(d.createdAt)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Last Login"}),r.jsx("p",{className:"text-slate-300",children:c(d.lastLogin)})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-slate-500 mb-2",children:"Permissions"}),r.jsx("div",{className:"space-y-2",children:Object.entries(d.permissions).map(([u,m])=>r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-slate-400",children:u.replace(/^can/,"").replace(/([A-Z])/g," $1").trim()}),m?r.jsx("span",{className:"text-emerald-400",children:"Allowed"}):r.jsx("span",{className:"text-slate-600",children:"Denied"})]},u))})]})]})]}),s&&r.jsx(gh,{onClose:()=>o(!1),onAdd:t})]})},hh={email:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),slack:r.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"})}),pagerduty:r.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M16.965 1.18C15.085.164 13.769 0 10.683 0H3.73v14.55h6.926c2.743 0 4.8-.164 6.61-1.37 1.975-1.303 3.004-3.453 3.004-6.14 0-2.605-.933-4.673-3.305-5.86zM10.437 10.2H7.744V4.177h2.952c2.99 0 4.618.886 4.618 2.991 0 2.36-1.628 3.031-4.877 3.031zM3.73 24h4.015V17.29H3.73V24z"})}),webhook:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),teams:r.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.625 8.073h-5.27V5.138c0-.666.535-1.21 1.193-1.21h3.885c.656 0 1.192.544 1.192 1.21v1.925c0 .555-.448 1.01-1 1.01zm.25 1.49v5.22c0 .84-.68 1.52-1.52 1.52h-4.27v-6.74h5.79zm-7.74-5.1v11.84c0 .84-.68 1.52-1.52 1.52H4.94c-.84 0-1.52-.68-1.52-1.52V4.463c0-.84.68-1.52 1.52-1.52h6.675c.84 0 1.52.68 1.52 1.52z"})})},_h={email:"bg-blue-500/20 text-blue-400",slack:"bg-purple-500/20 text-purple-400",pagerduty:"bg-emerald-500/20 text-emerald-400",webhook:"bg-slate-500/20 text-slate-400",teams:"bg-indigo-500/20 text-indigo-400"},yh=({preferences:e,onUpdate:t})=>{const n=a=>{const s=e.channels.map(o=>o.id===a?{...o,isEnabled:!o.isEnabled}:o);t({channels:s})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"Notification Preferences"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Configure how and when you receive alerts"})]}),r.jsxs(G,{variant:"primary",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Channel"]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Alert Channels"}),r.jsx("div",{className:"space-y-3",children:e.channels.map(a=>r.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${_h[a.type]}`,children:hh[a.type]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("p",{className:"text-white font-medium",children:a.name}),r.jsx(ae,{variant:"info",size:"sm",children:a.type.charAt(0).toUpperCase()+a.type.slice(1)})]}),r.jsxs("p",{className:"text-sm text-slate-400",children:[a.type==="email"&&a.config.recipients,a.type==="slack"&&a.config.channel,a.type==="pagerduty"&&`Service: ${a.config.severity}`,a.type==="webhook"&&"Custom webhook",a.type==="teams"&&"Microsoft Teams"]})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>n(a.id),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a.isEnabled?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.isEnabled?"translate-x-6":"translate-x-1"}`})}),r.jsx(G,{variant:"ghost",size:"sm",children:r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]},a.id))})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Alert Threshold"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-slate-400",children:"Receive notifications for alerts at or above the selected severity level"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:["all","warning","critical"].map(a=>r.jsxs("button",{onClick:()=>t({alertThreshold:a}),className:`p-4 rounded-lg border-2 transition-all ${e.alertThreshold===a?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[r.jsx("p",{className:`font-medium capitalize ${e.alertThreshold===a?"text-cyan-400":"text-slate-400"}`,children:a==="all"?"All Alerts":`${a} & Above`}),r.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[a==="all"&&"Info, Warning, Critical",a==="warning"&&"Warning, Critical",a==="critical"&&"Critical only"]})]},a))})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Quiet Hours"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Enable Quiet Hours"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Suppress non-critical notifications during specified hours"})]}),r.jsx("button",{onClick:()=>t({quietHours:{...e.quietHours,enabled:!e.quietHours.enabled}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.quietHours.enabled?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.quietHours.enabled?"translate-x-6":"translate-x-1"}`})})]}),e.quietHours.enabled&&r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Start Time"}),r.jsx("input",{type:"time",value:e.quietHours.start,onChange:a=>t({quietHours:{...e.quietHours,start:a.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"End Time"}),r.jsx("input",{type:"time",value:e.quietHours.end,onChange:a=>t({quietHours:{...e.quietHours,end:a.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Timezone"}),r.jsxs("select",{value:e.quietHours.timezone,onChange:a=>t({quietHours:{...e.quietHours,timezone:a.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"America/New_York",children:"Eastern Time"}),r.jsx("option",{value:"America/Chicago",children:"Central Time"}),r.jsx("option",{value:"America/Denver",children:"Mountain Time"}),r.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),r.jsx("option",{value:"UTC",children:"UTC"})]})]})]})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Email Digest"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-medium",children:"Enable Digest Emails"}),r.jsx("p",{className:"text-sm text-slate-400",children:"Receive a summary of alerts and activities"})]}),r.jsx("button",{onClick:()=>t({digest:{...e.digest,enabled:!e.digest.enabled}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.digest.enabled?"bg-cyan-500":"bg-slate-600"}`,children:r.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.digest.enabled?"translate-x-6":"translate-x-1"}`})})]}),e.digest.enabled&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Frequency"}),r.jsxs("select",{value:e.digest.frequency,onChange:a=>t({digest:{...e.digest,frequency:a.target.value}}),className:"w-48 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[r.jsx("option",{value:"hourly",children:"Hourly"}),r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"})]})]})]})]})]})},vh={UPDATE_SETTINGS:"bg-blue-500/20 text-blue-400",CREATE_RULE:"bg-emerald-500/20 text-emerald-400",TEST_CONNECTION:"bg-amber-500/20 text-amber-400",ADD_USER:"bg-purple-500/20 text-purple-400",UPDATE_PERMISSIONS:"bg-indigo-500/20 text-indigo-400",APPROVE_TICKET:"bg-cyan-500/20 text-cyan-400",EXPORT_REPORT:"bg-slate-500/20 text-slate-400",SYNC_CLOUD:"bg-teal-500/20 text-teal-400",DELETE_RULE:"bg-red-500/20 text-red-400"},xh=[{value:"",label:"All Actions"},{value:"UPDATE_SETTINGS",label:"Update Settings"},{value:"CREATE_RULE",label:"Create Rule"},{value:"DELETE_RULE",label:"Delete Rule"},{value:"TEST_CONNECTION",label:"Test Connection"},{value:"ADD_USER",label:"Add User"},{value:"UPDATE_PERMISSIONS",label:"Update Permissions"},{value:"APPROVE_TICKET",label:"Approve Ticket"},{value:"EXPORT_REPORT",label:"Export Report"},{value:"SYNC_CLOUD",label:"Sync Cloud"}],bh=({logs:e,onLoadLogs:t})=>{const[n,a]=_.useState(""),[s,o]=_.useState("");_.useEffect(()=>{t()},[t]);const i=()=>{t({user:n||void 0,action:s||void 0})},l=()=>{a(""),o(""),t()},c=u=>{const m=new Date(u),v=new Date().getTime()-m.getTime(),b=Math.floor(v/6e4),y=Math.floor(v/36e5),O=Math.floor(v/864e5);return b<60?`${b} min ago`:y<24?`${y} hours ago`:O<7?`${O} days ago`:m.toLocaleDateString()},d=u=>u.replace(/_/g," ").toLowerCase().replace(/\b\w/g,m=>m.toUpperCase());return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Logs"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Track all system activities and changes"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(G,{variant:"secondary",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export CSV"]}),r.jsxs(G,{variant:"secondary",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export JSON"]})]})]}),r.jsxs(R,{children:[r.jsx(J,{title:"Filters"}),r.jsxs("div",{className:"flex gap-4 items-end",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"User"}),r.jsx("input",{type:"text",value:n,onChange:u=>a(u.target.value),placeholder:"Search by email or username",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),r.jsxs("div",{className:"w-48",children:[r.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Action"}),r.jsx("select",{value:s,onChange:u=>o(u.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:xh.map(u=>r.jsx("option",{value:u.value,children:u.label},u.value))})]}),r.jsx(G,{variant:"primary",onClick:i,children:"Apply Filters"}),r.jsx(G,{variant:"ghost",onClick:l,children:"Clear"})]})]}),r.jsxs(R,{padding:"none",children:[r.jsx("div",{className:"p-4 border-b border-slate-700",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"font-bold text-white",children:"Activity Log"}),r.jsxs("span",{className:"text-sm text-slate-400",children:[e.length," entries"]})]})}),r.jsx("div",{className:"divide-y divide-slate-700",children:e.length===0?r.jsx("div",{className:"p-8 text-center text-slate-400",children:"No audit logs found matching your criteria"}):e.map(u=>r.jsx("div",{className:"p-4 hover:bg-slate-700/30 transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:`mt-1 w-2 h-2 rounded-full ${u.status==="success"?"bg-emerald-400":"bg-red-400"}`}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[r.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${vh[u.action]||"bg-slate-500/20 text-slate-400"}`,children:d(u.action)}),r.jsx("span",{className:"text-white font-medium",children:u.resource})]}),r.jsx("p",{className:"text-sm text-slate-400 mb-2",children:u.details}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),u.user]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),u.ipAddress]})]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-slate-400",children:c(u.timestamp)}),r.jsx(ae,{variant:u.status==="success"?"success":"error",size:"sm",children:u.status})]})]})},u.id))})]})]})},wh=()=>{const{settings:e,auditLogs:t,activeTab:n,isLoading:a,testingConnection:s,testResult:o,setActiveTab:i,testCloudConnection:l,updateCloudConnection:c,addCloudConnection:d,deleteCloudConnection:u,updateServiceNowConfig:m,testServiceNowConnection:g,updateSIEMConfig:v,updateAPMConfig:b,addUser:y,updateUser:O,deleteUser:h,updateNotificationPreferences:p,loadAuditLogs:f,clearTestResult:w}=rh();if(a||!e)return r.jsx(re,{children:r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[r.jsxs("svg",{className:"animate-spin h-6 w-6",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading settings..."]})})});const S=()=>{switch(n){case"cloud":return r.jsx(lh,{connections:e.cloudConnections,testingConnection:s,testResult:o,onTestConnection:l,onUpdateConnection:c,onAddConnection:d,onDeleteConnection:u,onClearTestResult:w});case"servicenow":return r.jsx(ch,{config:e.serviceNow,testingConnection:s,testResult:o,onUpdate:m,onTestConnection:g,onClearTestResult:w});case"siem":return r.jsx(uh,{config:e.siem,onUpdate:v});case"apm":return r.jsx(mh,{config:e.apm,onUpdate:b});case"users":return r.jsx(fh,{users:e.users,onAddUser:y,onUpdateUser:O,onDeleteUser:h});case"notifications":return r.jsx(yh,{preferences:e.notifications,onUpdate:p});case"audit":return r.jsx(bh,{logs:t,onLoadLogs:f});default:return null}};return r.jsx(re,{children:r.jsxs("div",{className:"flex gap-6",children:[r.jsx("div",{className:"w-64 flex-shrink-0",children:r.jsx(sh,{activeTab:n,onTabChange:i})}),r.jsx("div",{className:"flex-1 min-w-0",children:S()})]})})},Sh={dashboard:If,compliance:qf,monitoring:p1,dependencymap:g1,incidents:h1,cloudmanagement:x1,pathanalysis:I1,routeintelligence:L1,tickets:G1,statusboard:V1,rulegenerator:Z1,validation:X1,conflicts:nh,settings:wh},kh=({activeView:e})=>{const t=Sh[e];return t?r.jsx(t,{}):r.jsx(Ch,{})},Ch=()=>r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsx("p",{className:"text-slate-400",children:"View not found"})}),Ah=()=>{const{activeView:e,viewInfo:t,setActiveView:n}=gg(),[a,s]=mg(!1),[o]=_.useState(3);return r.jsx(dg,{menuItems:bm,activeView:e,viewInfo:t,sidebarCollapsed:a,notifications:o,onViewChange:n,onToggleSidebar:s,children:r.jsx(kh,{activeView:e})})},Nh=Fs.createRoot(document.getElementById("root"));Nh.render(r.jsx(ep.StrictMode,{children:r.jsx(Ah,{})}));

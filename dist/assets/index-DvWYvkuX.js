var X0=Object.defineProperty;var J0=(t,s,a)=>s in t?X0(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var xn=(t,s,a)=>J0(t,typeof s!="symbol"?s+"":s,a);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();function eu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nc={exports:{}},Yr={},Sc={exports:{}},z={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fa=Symbol.for("react.element"),tu=Symbol.for("react.portal"),su=Symbol.for("react.fragment"),au=Symbol.for("react.strict_mode"),ru=Symbol.for("react.profiler"),nu=Symbol.for("react.provider"),iu=Symbol.for("react.context"),ou=Symbol.for("react.forward_ref"),lu=Symbol.for("react.suspense"),cu=Symbol.for("react.memo"),du=Symbol.for("react.lazy"),Qo=Symbol.iterator;function uu(t){return t===null||typeof t!="object"?null:(t=Qo&&t[Qo]||t["@@iterator"],typeof t=="function"?t:null)}var kc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cc=Object.assign,Ac={};function zs(t,s,a){this.props=t,this.context=s,this.refs=Ac,this.updater=a||kc}zs.prototype.isReactComponent={};zs.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};zs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Tc(){}Tc.prototype=zs.prototype;function Yi(t,s,a){this.props=t,this.context=s,this.refs=Ac,this.updater=a||kc}var Xi=Yi.prototype=new Tc;Xi.constructor=Yi;Cc(Xi,zs.prototype);Xi.isPureReactComponent=!0;var Yo=Array.isArray,Pc=Object.prototype.hasOwnProperty,Ji={current:null},Ic={key:!0,ref:!0,__self:!0,__source:!0};function Rc(t,s,a){var r,n={},i=null,o=null;if(s!=null)for(r in s.ref!==void 0&&(o=s.ref),s.key!==void 0&&(i=""+s.key),s)Pc.call(s,r)&&!Ic.hasOwnProperty(r)&&(n[r]=s[r]);var l=arguments.length-2;if(l===1)n.children=a;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)n[r]===void 0&&(n[r]=l[r]);return{$$typeof:Fa,type:t,key:i,ref:o,props:n,_owner:Ji.current}}function pu(t,s){return{$$typeof:Fa,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function eo(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fa}function mu(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return s[a]})}var Xo=/\/+/g;function gn(t,s){return typeof t=="object"&&t!==null&&t.key!=null?mu(""+t.key):s.toString(36)}function hr(t,s,a,r,n){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Fa:case tu:o=!0}}if(o)return o=t,n=n(o),t=r===""?"."+gn(o,0):r,Yo(n)?(a="",t!=null&&(a=t.replace(Xo,"$&/")+"/"),hr(n,s,a,"",function(d){return d})):n!=null&&(eo(n)&&(n=pu(n,a+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(Xo,"$&/")+"/")+t)),s.push(n)),1;if(o=0,r=r===""?".":r+":",Yo(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+gn(i,l);o+=hr(i,s,a,c,n)}else if(c=uu(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+gn(i,l++),o+=hr(i,s,a,c,n);else if(i==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return o}function $a(t,s,a){if(t==null)return t;var r=[],n=0;return hr(t,r,"","",function(i){return s.call(a,i,n++)}),r}function hu(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var ke={current:null},xr={transition:null},xu={ReactCurrentDispatcher:ke,ReactCurrentBatchConfig:xr,ReactCurrentOwner:Ji};function Ec(){throw Error("act(...) is not supported in production builds of React.")}z.Children={map:$a,forEach:function(t,s,a){$a(t,function(){s.apply(this,arguments)},a)},count:function(t){var s=0;return $a(t,function(){s++}),s},toArray:function(t){return $a(t,function(s){return s})||[]},only:function(t){if(!eo(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};z.Component=zs;z.Fragment=su;z.Profiler=ru;z.PureComponent=Yi;z.StrictMode=au;z.Suspense=lu;z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xu;z.act=Ec;z.cloneElement=function(t,s,a){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Cc({},t.props),n=t.key,i=t.ref,o=t._owner;if(s!=null){if(s.ref!==void 0&&(i=s.ref,o=Ji.current),s.key!==void 0&&(n=""+s.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in s)Pc.call(s,c)&&!Ic.hasOwnProperty(c)&&(r[c]=s[c]===void 0&&l!==void 0?l[c]:s[c])}var c=arguments.length-2;if(c===1)r.children=a;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Fa,type:t.type,key:n,ref:i,props:r,_owner:o}};z.createContext=function(t){return t={$$typeof:iu,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:nu,_context:t},t.Consumer=t};z.createElement=Rc;z.createFactory=function(t){var s=Rc.bind(null,t);return s.type=t,s};z.createRef=function(){return{current:null}};z.forwardRef=function(t){return{$$typeof:ou,render:t}};z.isValidElement=eo;z.lazy=function(t){return{$$typeof:du,_payload:{_status:-1,_result:t},_init:hu}};z.memo=function(t,s){return{$$typeof:cu,type:t,compare:s===void 0?null:s}};z.startTransition=function(t){var s=xr.transition;xr.transition={};try{t()}finally{xr.transition=s}};z.unstable_act=Ec;z.useCallback=function(t,s){return ke.current.useCallback(t,s)};z.useContext=function(t){return ke.current.useContext(t)};z.useDebugValue=function(){};z.useDeferredValue=function(t){return ke.current.useDeferredValue(t)};z.useEffect=function(t,s){return ke.current.useEffect(t,s)};z.useId=function(){return ke.current.useId()};z.useImperativeHandle=function(t,s,a){return ke.current.useImperativeHandle(t,s,a)};z.useInsertionEffect=function(t,s){return ke.current.useInsertionEffect(t,s)};z.useLayoutEffect=function(t,s){return ke.current.useLayoutEffect(t,s)};z.useMemo=function(t,s){return ke.current.useMemo(t,s)};z.useReducer=function(t,s,a){return ke.current.useReducer(t,s,a)};z.useRef=function(t){return ke.current.useRef(t)};z.useState=function(t){return ke.current.useState(t)};z.useSyncExternalStore=function(t,s,a){return ke.current.useSyncExternalStore(t,s,a)};z.useTransition=function(){return ke.current.useTransition()};z.version="18.3.1";Sc.exports=z;var v=Sc.exports;const Lc=eu(v);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gu=v,fu=Symbol.for("react.element"),vu=Symbol.for("react.fragment"),yu=Object.prototype.hasOwnProperty,bu=gu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_u={key:!0,ref:!0,__self:!0,__source:!0};function Oc(t,s,a){var r,n={},i=null,o=null;a!==void 0&&(i=""+a),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(r in s)yu.call(s,r)&&!_u.hasOwnProperty(r)&&(n[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:fu,type:t,key:i,ref:o,props:n,_owner:bu.current}}Yr.Fragment=vu;Yr.jsx=Oc;Yr.jsxs=Oc;Nc.exports=Yr;var e=Nc.exports,ti={},Dc={exports:{}},Fe={},Mc={exports:{}},Fc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(L,G){var U=L.length;L.push(G);e:for(;0<U;){var ie=U-1>>>1,ue=L[ie];if(0<n(ue,G))L[ie]=G,L[U]=ue,U=ie;else break e}}function a(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var G=L[0],U=L.pop();if(U!==G){L[0]=U;e:for(var ie=0,ue=L.length,Wa=ue>>>1;ie<Wa;){var Wt=2*(ie+1)-1,hn=L[Wt],zt=Wt+1,za=L[zt];if(0>n(hn,U))zt<ue&&0>n(za,hn)?(L[ie]=za,L[zt]=U,ie=zt):(L[ie]=hn,L[Wt]=U,ie=Wt);else if(zt<ue&&0>n(za,U))L[ie]=za,L[zt]=U,ie=zt;else break e}}return G}function n(L,G){var U=L.sortIndex-G.sortIndex;return U!==0?U:L.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,u=null,x=3,_=!1,b=!1,m=!1,T=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(L){for(var G=a(d);G!==null;){if(G.callback===null)r(d);else if(G.startTime<=L)r(d),G.sortIndex=G.expirationTime,s(c,G);else break;G=a(d)}}function j(L){if(m=!1,f(L),!b)if(a(c)!==null)b=!0,V(N);else{var G=a(d);G!==null&&he(j,G.startTime-L)}}function N(L,G){b=!1,m&&(m=!1,p(k),k=-1),_=!0;var U=x;try{for(f(G),u=a(c);u!==null&&(!(u.expirationTime>G)||L&&!W());){var ie=u.callback;if(typeof ie=="function"){u.callback=null,x=u.priorityLevel;var ue=ie(u.expirationTime<=G);G=t.unstable_now(),typeof ue=="function"?u.callback=ue:u===a(c)&&r(c),f(G)}else r(c);u=a(c)}if(u!==null)var Wa=!0;else{var Wt=a(d);Wt!==null&&he(j,Wt.startTime-G),Wa=!1}return Wa}finally{u=null,x=U,_=!1}}var S=!1,A=null,k=-1,I=5,E=-1;function W(){return!(t.unstable_now()-E<I)}function Z(){if(A!==null){var L=t.unstable_now();E=L;var G=!0;try{G=A(!0,L)}finally{G?P():(S=!1,A=null)}}else S=!1}var P;if(typeof g=="function")P=function(){g(Z)};else if(typeof MessageChannel<"u"){var w=new MessageChannel,R=w.port2;w.port1.onmessage=Z,P=function(){R.postMessage(null)}}else P=function(){T(Z,0)};function V(L){A=L,S||(S=!0,P())}function he(L,G){k=T(function(){L(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){b||_||(b=!0,V(N))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(L){switch(x){case 1:case 2:case 3:var G=3;break;default:G=x}var U=x;x=G;try{return L()}finally{x=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,G){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var U=x;x=L;try{return G()}finally{x=U}},t.unstable_scheduleCallback=function(L,G,U){var ie=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?ie+U:ie):U=ie,L){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=U+ue,L={id:h++,callback:G,priorityLevel:L,startTime:U,expirationTime:ue,sortIndex:-1},U>ie?(L.sortIndex=U,s(d,L),a(c)===null&&L===a(d)&&(m?(p(k),k=-1):m=!0,he(j,U-ie))):(L.sortIndex=ue,s(c,L),b||_||(b=!0,V(N))),L},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(L){var G=x;return function(){var U=x;x=G;try{return L.apply(this,arguments)}finally{x=U}}}})(Fc);Mc.exports=Fc;var wu=Mc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju=v,Me=wu;function C(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gc=new Set,_a={};function ls(t,s){Ds(t,s),Ds(t+"Capture",s)}function Ds(t,s){for(_a[t]=s,t=0;t<s.length;t++)Gc.add(s[t])}var ft=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),si=Object.prototype.hasOwnProperty,Nu=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jo={},el={};function Su(t){return si.call(el,t)?!0:si.call(Jo,t)?!1:Nu.test(t)?el[t]=!0:(Jo[t]=!0,!1)}function ku(t,s,a,r){if(a!==null&&a.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return r?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Cu(t,s,a,r){if(s===null||typeof s>"u"||ku(t,s,a,r))return!0;if(r)return!1;if(a!==null)switch(a.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Ce(t,s,a,r,n,i,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=a,this.propertyName=t,this.type=s,this.sanitizeURL=i,this.removeEmptyString=o}var ve={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ve[t]=new Ce(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];ve[s]=new Ce(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ve[t]=new Ce(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ve[t]=new Ce(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ve[t]=new Ce(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ve[t]=new Ce(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ve[t]=new Ce(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ve[t]=new Ce(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ve[t]=new Ce(t,5,!1,t.toLowerCase(),null,!1,!1)});var to=/[\-:]([a-z])/g;function so(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(to,so);ve[s]=new Ce(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(to,so);ve[s]=new Ce(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(to,so);ve[s]=new Ce(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ve[t]=new Ce(t,1,!1,t.toLowerCase(),null,!1,!1)});ve.xlinkHref=new Ce("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ve[t]=new Ce(t,1,!1,t.toLowerCase(),null,!0,!0)});function ao(t,s,a,r){var n=ve.hasOwnProperty(s)?ve[s]:null;(n!==null?n.type!==0:r||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(Cu(s,a,n,r)&&(a=null),r||n===null?Su(s)&&(a===null?t.removeAttribute(s):t.setAttribute(s,""+a)):n.mustUseProperty?t[n.propertyName]=a===null?n.type===3?!1:"":a:(s=n.attributeName,r=n.attributeNamespace,a===null?t.removeAttribute(s):(n=n.type,a=n===3||n===4&&a===!0?"":""+a,r?t.setAttributeNS(r,s,a):t.setAttribute(s,a))))}var _t=ju.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ba=Symbol.for("react.element"),fs=Symbol.for("react.portal"),vs=Symbol.for("react.fragment"),ro=Symbol.for("react.strict_mode"),ai=Symbol.for("react.profiler"),Vc=Symbol.for("react.provider"),Uc=Symbol.for("react.context"),no=Symbol.for("react.forward_ref"),ri=Symbol.for("react.suspense"),ni=Symbol.for("react.suspense_list"),io=Symbol.for("react.memo"),Nt=Symbol.for("react.lazy"),Hc=Symbol.for("react.offscreen"),tl=Symbol.iterator;function Zs(t){return t===null||typeof t!="object"?null:(t=tl&&t[tl]||t["@@iterator"],typeof t=="function"?t:null)}var re=Object.assign,fn;function na(t){if(fn===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);fn=s&&s[1]||""}return`
`+fn+t}var vn=!1;function yn(t,s){if(!t||vn)return"";vn=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(d){var r=d}Reflect.construct(t,[],s)}else{try{s.call()}catch(d){r=d}t.call(s.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),i=r.stack.split(`
`),o=n.length-1,l=i.length-1;1<=o&&0<=l&&n[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(n[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||n[o]!==i[l]){var c=`
`+n[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{vn=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?na(t):""}function Au(t){switch(t.tag){case 5:return na(t.type);case 16:return na("Lazy");case 13:return na("Suspense");case 19:return na("SuspenseList");case 0:case 2:case 15:return t=yn(t.type,!1),t;case 11:return t=yn(t.type.render,!1),t;case 1:return t=yn(t.type,!0),t;default:return""}}function ii(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vs:return"Fragment";case fs:return"Portal";case ai:return"Profiler";case ro:return"StrictMode";case ri:return"Suspense";case ni:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Uc:return(t.displayName||"Context")+".Consumer";case Vc:return(t._context.displayName||"Context")+".Provider";case no:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case io:return s=t.displayName||null,s!==null?s:ii(t.type)||"Memo";case Nt:s=t._payload,t=t._init;try{return ii(t(s))}catch{}}return null}function Tu(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ii(s);case 8:return s===ro?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Ft(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Wc(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Pu(t){var s=Wc(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),r=""+t[s];if(!t.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var n=a.get,i=a.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return n.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,s,{enumerable:a.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function Za(t){t._valueTracker||(t._valueTracker=Pu(t))}function zc(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var a=s.getValue(),r="";return t&&(r=Wc(t)?t.checked?"true":"false":t.value),t=r,t!==a?(s.setValue(t),!0):!1}function Cr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function oi(t,s){var a=s.checked;return re({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function sl(t,s){var a=s.defaultValue==null?"":s.defaultValue,r=s.checked!=null?s.checked:s.defaultChecked;a=Ft(s.value!=null?s.value:a),t._wrapperState={initialChecked:r,initialValue:a,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function $c(t,s){s=s.checked,s!=null&&ao(t,"checked",s,!1)}function li(t,s){$c(t,s);var a=Ft(s.value),r=s.type;if(a!=null)r==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?ci(t,s.type,a):s.hasOwnProperty("defaultValue")&&ci(t,s.type,Ft(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function al(t,s,a){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var r=s.type;if(!(r!=="submit"&&r!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,a||s===t.value||(t.value=s),t.defaultValue=s}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function ci(t,s,a){(s!=="number"||Cr(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var ia=Array.isArray;function Ps(t,s,a,r){if(t=t.options,s){s={};for(var n=0;n<a.length;n++)s["$"+a[n]]=!0;for(a=0;a<t.length;a++)n=s.hasOwnProperty("$"+t[a].value),t[a].selected!==n&&(t[a].selected=n),n&&r&&(t[a].defaultSelected=!0)}else{for(a=""+Ft(a),s=null,n=0;n<t.length;n++){if(t[n].value===a){t[n].selected=!0,r&&(t[n].defaultSelected=!0);return}s!==null||t[n].disabled||(s=t[n])}s!==null&&(s.selected=!0)}}function di(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(C(91));return re({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rl(t,s){var a=s.value;if(a==null){if(a=s.children,s=s.defaultValue,a!=null){if(s!=null)throw Error(C(92));if(ia(a)){if(1<a.length)throw Error(C(93));a=a[0]}s=a}s==null&&(s=""),a=s}t._wrapperState={initialValue:Ft(a)}}function Bc(t,s){var a=Ft(s.value),r=Ft(s.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),s.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),r!=null&&(t.defaultValue=""+r)}function nl(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function Zc(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ui(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?Zc(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var qa,qc=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,a,r,n){MSApp.execUnsafeLocalFunction(function(){return t(s,a,r,n)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(qa=qa||document.createElement("div"),qa.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=qa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function wa(t,s){if(s){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=s;return}}t.textContent=s}var ua={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Iu=["Webkit","ms","Moz","O"];Object.keys(ua).forEach(function(t){Iu.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),ua[s]=ua[t]})});function Kc(t,s,a){return s==null||typeof s=="boolean"||s===""?"":a||typeof s!="number"||s===0||ua.hasOwnProperty(t)&&ua[t]?(""+s).trim():s+"px"}function Qc(t,s){t=t.style;for(var a in s)if(s.hasOwnProperty(a)){var r=a.indexOf("--")===0,n=Kc(a,s[a],r);a==="float"&&(a="cssFloat"),r?t.setProperty(a,n):t[a]=n}}var Ru=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pi(t,s){if(s){if(Ru[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(C(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(C(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(C(61))}if(s.style!=null&&typeof s.style!="object")throw Error(C(62))}}function mi(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hi=null;function oo(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var xi=null,Is=null,Rs=null;function il(t){if(t=Ua(t)){if(typeof xi!="function")throw Error(C(280));var s=t.stateNode;s&&(s=sn(s),xi(t.stateNode,t.type,s))}}function Yc(t){Is?Rs?Rs.push(t):Rs=[t]:Is=t}function Xc(){if(Is){var t=Is,s=Rs;if(Rs=Is=null,il(t),s)for(t=0;t<s.length;t++)il(s[t])}}function Jc(t,s){return t(s)}function ed(){}var bn=!1;function td(t,s,a){if(bn)return t(s,a);bn=!0;try{return Jc(t,s,a)}finally{bn=!1,(Is!==null||Rs!==null)&&(ed(),Xc())}}function ja(t,s){var a=t.stateNode;if(a===null)return null;var r=sn(a);if(r===null)return null;a=r[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(C(231,s,typeof a));return a}var gi=!1;if(ft)try{var qs={};Object.defineProperty(qs,"passive",{get:function(){gi=!0}}),window.addEventListener("test",qs,qs),window.removeEventListener("test",qs,qs)}catch{gi=!1}function Eu(t,s,a,r,n,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{s.apply(a,d)}catch(h){this.onError(h)}}var pa=!1,Ar=null,Tr=!1,fi=null,Lu={onError:function(t){pa=!0,Ar=t}};function Ou(t,s,a,r,n,i,o,l,c){pa=!1,Ar=null,Eu.apply(Lu,arguments)}function Du(t,s,a,r,n,i,o,l,c){if(Ou.apply(this,arguments),pa){if(pa){var d=Ar;pa=!1,Ar=null}else throw Error(C(198));Tr||(Tr=!0,fi=d)}}function cs(t){var s=t,a=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(a=s.return),t=s.return;while(t)}return s.tag===3?a:null}function sd(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function ol(t){if(cs(t)!==t)throw Error(C(188))}function Mu(t){var s=t.alternate;if(!s){if(s=cs(t),s===null)throw Error(C(188));return s!==t?null:t}for(var a=t,r=s;;){var n=a.return;if(n===null)break;var i=n.alternate;if(i===null){if(r=n.return,r!==null){a=r;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===a)return ol(n),t;if(i===r)return ol(n),s;i=i.sibling}throw Error(C(188))}if(a.return!==r.return)a=n,r=i;else{for(var o=!1,l=n.child;l;){if(l===a){o=!0,a=n,r=i;break}if(l===r){o=!0,r=n,a=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===a){o=!0,a=i,r=n;break}if(l===r){o=!0,r=i,a=n;break}l=l.sibling}if(!o)throw Error(C(189))}}if(a.alternate!==r)throw Error(C(190))}if(a.tag!==3)throw Error(C(188));return a.stateNode.current===a?t:s}function ad(t){return t=Mu(t),t!==null?rd(t):null}function rd(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=rd(t);if(s!==null)return s;t=t.sibling}return null}var nd=Me.unstable_scheduleCallback,ll=Me.unstable_cancelCallback,Fu=Me.unstable_shouldYield,Gu=Me.unstable_requestPaint,oe=Me.unstable_now,Vu=Me.unstable_getCurrentPriorityLevel,lo=Me.unstable_ImmediatePriority,id=Me.unstable_UserBlockingPriority,Pr=Me.unstable_NormalPriority,Uu=Me.unstable_LowPriority,od=Me.unstable_IdlePriority,Xr=null,ot=null;function Hu(t){if(ot&&typeof ot.onCommitFiberRoot=="function")try{ot.onCommitFiberRoot(Xr,t,void 0,(t.current.flags&128)===128)}catch{}}var Je=Math.clz32?Math.clz32:$u,Wu=Math.log,zu=Math.LN2;function $u(t){return t>>>=0,t===0?32:31-(Wu(t)/zu|0)|0}var Ka=64,Qa=4194304;function oa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ir(t,s){var a=t.pendingLanes;if(a===0)return 0;var r=0,n=t.suspendedLanes,i=t.pingedLanes,o=a&268435455;if(o!==0){var l=o&~n;l!==0?r=oa(l):(i&=o,i!==0&&(r=oa(i)))}else o=a&~n,o!==0?r=oa(o):i!==0&&(r=oa(i));if(r===0)return 0;if(s!==0&&s!==r&&!(s&n)&&(n=r&-r,i=s&-s,n>=i||n===16&&(i&4194240)!==0))return s;if(r&4&&(r|=a&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=r;0<s;)a=31-Je(s),n=1<<a,r|=t[a],s&=~n;return r}function Bu(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zu(t,s){for(var a=t.suspendedLanes,r=t.pingedLanes,n=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Je(i),l=1<<o,c=n[o];c===-1?(!(l&a)||l&r)&&(n[o]=Bu(l,s)):c<=s&&(t.expiredLanes|=l),i&=~l}}function vi(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ld(){var t=Ka;return Ka<<=1,!(Ka&4194240)&&(Ka=64),t}function _n(t){for(var s=[],a=0;31>a;a++)s.push(t);return s}function Ga(t,s,a){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-Je(s),t[s]=a}function qu(t,s){var a=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<a;){var n=31-Je(a),i=1<<n;s[n]=0,r[n]=-1,t[n]=-1,a&=~i}}function co(t,s){var a=t.entangledLanes|=s;for(t=t.entanglements;a;){var r=31-Je(a),n=1<<r;n&s|t[r]&s&&(t[r]|=s),a&=~n}}var q=0;function cd(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var dd,uo,ud,pd,md,yi=!1,Ya=[],Pt=null,It=null,Rt=null,Na=new Map,Sa=new Map,kt=[],Ku="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cl(t,s){switch(t){case"focusin":case"focusout":Pt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Na.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sa.delete(s.pointerId)}}function Ks(t,s,a,r,n,i){return t===null||t.nativeEvent!==i?(t={blockedOn:s,domEventName:a,eventSystemFlags:r,nativeEvent:i,targetContainers:[n]},s!==null&&(s=Ua(s),s!==null&&uo(s)),t):(t.eventSystemFlags|=r,s=t.targetContainers,n!==null&&s.indexOf(n)===-1&&s.push(n),t)}function Qu(t,s,a,r,n){switch(s){case"focusin":return Pt=Ks(Pt,t,s,a,r,n),!0;case"dragenter":return It=Ks(It,t,s,a,r,n),!0;case"mouseover":return Rt=Ks(Rt,t,s,a,r,n),!0;case"pointerover":var i=n.pointerId;return Na.set(i,Ks(Na.get(i)||null,t,s,a,r,n)),!0;case"gotpointercapture":return i=n.pointerId,Sa.set(i,Ks(Sa.get(i)||null,t,s,a,r,n)),!0}return!1}function hd(t){var s=Qt(t.target);if(s!==null){var a=cs(s);if(a!==null){if(s=a.tag,s===13){if(s=sd(a),s!==null){t.blockedOn=s,md(t.priority,function(){ud(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gr(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var a=bi(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var r=new a.constructor(a.type,a);hi=r,a.target.dispatchEvent(r),hi=null}else return s=Ua(a),s!==null&&uo(s),t.blockedOn=a,!1;s.shift()}return!0}function dl(t,s,a){gr(t)&&a.delete(s)}function Yu(){yi=!1,Pt!==null&&gr(Pt)&&(Pt=null),It!==null&&gr(It)&&(It=null),Rt!==null&&gr(Rt)&&(Rt=null),Na.forEach(dl),Sa.forEach(dl)}function Qs(t,s){t.blockedOn===s&&(t.blockedOn=null,yi||(yi=!0,Me.unstable_scheduleCallback(Me.unstable_NormalPriority,Yu)))}function ka(t){function s(n){return Qs(n,t)}if(0<Ya.length){Qs(Ya[0],t);for(var a=1;a<Ya.length;a++){var r=Ya[a];r.blockedOn===t&&(r.blockedOn=null)}}for(Pt!==null&&Qs(Pt,t),It!==null&&Qs(It,t),Rt!==null&&Qs(Rt,t),Na.forEach(s),Sa.forEach(s),a=0;a<kt.length;a++)r=kt[a],r.blockedOn===t&&(r.blockedOn=null);for(;0<kt.length&&(a=kt[0],a.blockedOn===null);)hd(a),a.blockedOn===null&&kt.shift()}var Es=_t.ReactCurrentBatchConfig,Rr=!0;function Xu(t,s,a,r){var n=q,i=Es.transition;Es.transition=null;try{q=1,po(t,s,a,r)}finally{q=n,Es.transition=i}}function Ju(t,s,a,r){var n=q,i=Es.transition;Es.transition=null;try{q=4,po(t,s,a,r)}finally{q=n,Es.transition=i}}function po(t,s,a,r){if(Rr){var n=bi(t,s,a,r);if(n===null)In(t,s,r,Er,a),cl(t,r);else if(Qu(n,t,s,a,r))r.stopPropagation();else if(cl(t,r),s&4&&-1<Ku.indexOf(t)){for(;n!==null;){var i=Ua(n);if(i!==null&&dd(i),i=bi(t,s,a,r),i===null&&In(t,s,r,Er,a),i===n)break;n=i}n!==null&&r.stopPropagation()}else In(t,s,r,null,a)}}var Er=null;function bi(t,s,a,r){if(Er=null,t=oo(r),t=Qt(t),t!==null)if(s=cs(t),s===null)t=null;else if(a=s.tag,a===13){if(t=sd(s),t!==null)return t;t=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return Er=t,null}function xd(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vu()){case lo:return 1;case id:return 4;case Pr:case Uu:return 16;case od:return 536870912;default:return 16}default:return 16}}var At=null,mo=null,fr=null;function gd(){if(fr)return fr;var t,s=mo,a=s.length,r,n="value"in At?At.value:At.textContent,i=n.length;for(t=0;t<a&&s[t]===n[t];t++);var o=a-t;for(r=1;r<=o&&s[a-r]===n[i-r];r++);return fr=n.slice(t,1<r?1-r:void 0)}function vr(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function Xa(){return!0}function ul(){return!1}function Ge(t){function s(a,r,n,i,o){this._reactName=a,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(a=t[l],this[l]=a?a(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xa:ul,this.isPropagationStopped=ul,this}return re(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),s}var $s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ho=Ge($s),Va=re({},$s,{view:0,detail:0}),ep=Ge(Va),wn,jn,Ys,Jr=re({},Va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xo,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ys&&(Ys&&t.type==="mousemove"?(wn=t.screenX-Ys.screenX,jn=t.screenY-Ys.screenY):jn=wn=0,Ys=t),wn)},movementY:function(t){return"movementY"in t?t.movementY:jn}}),pl=Ge(Jr),tp=re({},Jr,{dataTransfer:0}),sp=Ge(tp),ap=re({},Va,{relatedTarget:0}),Nn=Ge(ap),rp=re({},$s,{animationName:0,elapsedTime:0,pseudoElement:0}),np=Ge(rp),ip=re({},$s,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),op=Ge(ip),lp=re({},$s,{data:0}),ml=Ge(lp),cp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},up={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pp(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=up[t])?!!s[t]:!1}function xo(){return pp}var mp=re({},Va,{key:function(t){if(t.key){var s=cp[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=vr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dp[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xo,charCode:function(t){return t.type==="keypress"?vr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),hp=Ge(mp),xp=re({},Jr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hl=Ge(xp),gp=re({},Va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xo}),fp=Ge(gp),vp=re({},$s,{propertyName:0,elapsedTime:0,pseudoElement:0}),yp=Ge(vp),bp=re({},Jr,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),_p=Ge(bp),wp=[9,13,27,32],go=ft&&"CompositionEvent"in window,ma=null;ft&&"documentMode"in document&&(ma=document.documentMode);var jp=ft&&"TextEvent"in window&&!ma,fd=ft&&(!go||ma&&8<ma&&11>=ma),xl=" ",gl=!1;function vd(t,s){switch(t){case"keyup":return wp.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yd(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ys=!1;function Np(t,s){switch(t){case"compositionend":return yd(s);case"keypress":return s.which!==32?null:(gl=!0,xl);case"textInput":return t=s.data,t===xl&&gl?null:t;default:return null}}function Sp(t,s){if(ys)return t==="compositionend"||!go&&vd(t,s)?(t=gd(),fr=mo=At=null,ys=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return fd&&s.locale!=="ko"?null:s.data;default:return null}}var kp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fl(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!kp[t.type]:s==="textarea"}function bd(t,s,a,r){Yc(r),s=Lr(s,"onChange"),0<s.length&&(a=new ho("onChange","change",null,a,r),t.push({event:a,listeners:s}))}var ha=null,Ca=null;function Cp(t){Id(t,0)}function en(t){var s=ws(t);if(zc(s))return t}function Ap(t,s){if(t==="change")return s}var _d=!1;if(ft){var Sn;if(ft){var kn="oninput"in document;if(!kn){var vl=document.createElement("div");vl.setAttribute("oninput","return;"),kn=typeof vl.oninput=="function"}Sn=kn}else Sn=!1;_d=Sn&&(!document.documentMode||9<document.documentMode)}function yl(){ha&&(ha.detachEvent("onpropertychange",wd),Ca=ha=null)}function wd(t){if(t.propertyName==="value"&&en(Ca)){var s=[];bd(s,Ca,t,oo(t)),td(Cp,s)}}function Tp(t,s,a){t==="focusin"?(yl(),ha=s,Ca=a,ha.attachEvent("onpropertychange",wd)):t==="focusout"&&yl()}function Pp(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return en(Ca)}function Ip(t,s){if(t==="click")return en(s)}function Rp(t,s){if(t==="input"||t==="change")return en(s)}function Ep(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var tt=typeof Object.is=="function"?Object.is:Ep;function Aa(t,s){if(tt(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var a=Object.keys(t),r=Object.keys(s);if(a.length!==r.length)return!1;for(r=0;r<a.length;r++){var n=a[r];if(!si.call(s,n)||!tt(t[n],s[n]))return!1}return!0}function bl(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _l(t,s){var a=bl(t);t=0;for(var r;a;){if(a.nodeType===3){if(r=t+a.textContent.length,t<=s&&r>=s)return{node:a,offset:s-t};t=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=bl(a)}}function jd(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?jd(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function Nd(){for(var t=window,s=Cr();s instanceof t.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)t=s.contentWindow;else break;s=Cr(t.document)}return s}function fo(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function Lp(t){var s=Nd(),a=t.focusedElem,r=t.selectionRange;if(s!==a&&a&&a.ownerDocument&&jd(a.ownerDocument.documentElement,a)){if(r!==null&&fo(a)){if(s=r.start,t=r.end,t===void 0&&(t=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(t,a.value.length);else if(t=(s=a.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var n=a.textContent.length,i=Math.min(r.start,n);r=r.end===void 0?i:Math.min(r.end,n),!t.extend&&i>r&&(n=r,r=i,i=n),n=_l(a,i);var o=_l(a,r);n&&o&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(s=s.createRange(),s.setStart(n.node,n.offset),t.removeAllRanges(),i>r?(t.addRange(s),t.extend(o.node,o.offset)):(s.setEnd(o.node,o.offset),t.addRange(s)))}}for(s=[],t=a;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)t=s[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Op=ft&&"documentMode"in document&&11>=document.documentMode,bs=null,_i=null,xa=null,wi=!1;function wl(t,s,a){var r=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;wi||bs==null||bs!==Cr(r)||(r=bs,"selectionStart"in r&&fo(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xa&&Aa(xa,r)||(xa=r,r=Lr(_i,"onSelect"),0<r.length&&(s=new ho("onSelect","select",null,s,a),t.push({event:s,listeners:r}),s.target=bs)))}function Ja(t,s){var a={};return a[t.toLowerCase()]=s.toLowerCase(),a["Webkit"+t]="webkit"+s,a["Moz"+t]="moz"+s,a}var _s={animationend:Ja("Animation","AnimationEnd"),animationiteration:Ja("Animation","AnimationIteration"),animationstart:Ja("Animation","AnimationStart"),transitionend:Ja("Transition","TransitionEnd")},Cn={},Sd={};ft&&(Sd=document.createElement("div").style,"AnimationEvent"in window||(delete _s.animationend.animation,delete _s.animationiteration.animation,delete _s.animationstart.animation),"TransitionEvent"in window||delete _s.transitionend.transition);function tn(t){if(Cn[t])return Cn[t];if(!_s[t])return t;var s=_s[t],a;for(a in s)if(s.hasOwnProperty(a)&&a in Sd)return Cn[t]=s[a];return t}var kd=tn("animationend"),Cd=tn("animationiteration"),Ad=tn("animationstart"),Td=tn("transitionend"),Pd=new Map,jl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vt(t,s){Pd.set(t,s),ls(s,[t])}for(var An=0;An<jl.length;An++){var Tn=jl[An],Dp=Tn.toLowerCase(),Mp=Tn[0].toUpperCase()+Tn.slice(1);Vt(Dp,"on"+Mp)}Vt(kd,"onAnimationEnd");Vt(Cd,"onAnimationIteration");Vt(Ad,"onAnimationStart");Vt("dblclick","onDoubleClick");Vt("focusin","onFocus");Vt("focusout","onBlur");Vt(Td,"onTransitionEnd");Ds("onMouseEnter",["mouseout","mouseover"]);Ds("onMouseLeave",["mouseout","mouseover"]);Ds("onPointerEnter",["pointerout","pointerover"]);Ds("onPointerLeave",["pointerout","pointerover"]);ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var la="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fp=new Set("cancel close invalid load scroll toggle".split(" ").concat(la));function Nl(t,s,a){var r=t.type||"unknown-event";t.currentTarget=a,Du(r,s,void 0,t),t.currentTarget=null}function Id(t,s){s=(s&4)!==0;for(var a=0;a<t.length;a++){var r=t[a],n=r.event;r=r.listeners;e:{var i=void 0;if(s)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&n.isPropagationStopped())break e;Nl(n,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&n.isPropagationStopped())break e;Nl(n,l,d),i=c}}}if(Tr)throw t=fi,Tr=!1,fi=null,t}function Y(t,s){var a=s[Ci];a===void 0&&(a=s[Ci]=new Set);var r=t+"__bubble";a.has(r)||(Rd(s,t,2,!1),a.add(r))}function Pn(t,s,a){var r=0;s&&(r|=4),Rd(a,t,r,s)}var er="_reactListening"+Math.random().toString(36).slice(2);function Ta(t){if(!t[er]){t[er]=!0,Gc.forEach(function(a){a!=="selectionchange"&&(Fp.has(a)||Pn(a,!1,t),Pn(a,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[er]||(s[er]=!0,Pn("selectionchange",!1,s))}}function Rd(t,s,a,r){switch(xd(s)){case 1:var n=Xu;break;case 4:n=Ju;break;default:n=po}a=n.bind(null,s,a,t),n=void 0,!gi||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(n=!0),r?n!==void 0?t.addEventListener(s,a,{capture:!0,passive:n}):t.addEventListener(s,a,!0):n!==void 0?t.addEventListener(s,a,{passive:n}):t.addEventListener(s,a,!1)}function In(t,s,a,r,n){var i=r;if(!(s&1)&&!(s&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;o=o.return}for(;l!==null;){if(o=Qt(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}td(function(){var d=i,h=oo(a),u=[];e:{var x=Pd.get(t);if(x!==void 0){var _=ho,b=t;switch(t){case"keypress":if(vr(a)===0)break e;case"keydown":case"keyup":_=hp;break;case"focusin":b="focus",_=Nn;break;case"focusout":b="blur",_=Nn;break;case"beforeblur":case"afterblur":_=Nn;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=pl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=sp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=fp;break;case kd:case Cd:case Ad:_=np;break;case Td:_=yp;break;case"scroll":_=ep;break;case"wheel":_=_p;break;case"copy":case"cut":case"paste":_=op;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=hl}var m=(s&4)!==0,T=!m&&t==="scroll",p=m?x!==null?x+"Capture":null:x;m=[];for(var g=d,f;g!==null;){f=g;var j=f.stateNode;if(f.tag===5&&j!==null&&(f=j,p!==null&&(j=ja(g,p),j!=null&&m.push(Pa(g,j,f)))),T)break;g=g.return}0<m.length&&(x=new _(x,b,null,a,h),u.push({event:x,listeners:m}))}}if(!(s&7)){e:{if(x=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",x&&a!==hi&&(b=a.relatedTarget||a.fromElement)&&(Qt(b)||b[vt]))break e;if((_||x)&&(x=h.window===h?h:(x=h.ownerDocument)?x.defaultView||x.parentWindow:window,_?(b=a.relatedTarget||a.toElement,_=d,b=b?Qt(b):null,b!==null&&(T=cs(b),b!==T||b.tag!==5&&b.tag!==6)&&(b=null)):(_=null,b=d),_!==b)){if(m=pl,j="onMouseLeave",p="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(m=hl,j="onPointerLeave",p="onPointerEnter",g="pointer"),T=_==null?x:ws(_),f=b==null?x:ws(b),x=new m(j,g+"leave",_,a,h),x.target=T,x.relatedTarget=f,j=null,Qt(h)===d&&(m=new m(p,g+"enter",b,a,h),m.target=f,m.relatedTarget=T,j=m),T=j,_&&b)t:{for(m=_,p=b,g=0,f=m;f;f=ds(f))g++;for(f=0,j=p;j;j=ds(j))f++;for(;0<g-f;)m=ds(m),g--;for(;0<f-g;)p=ds(p),f--;for(;g--;){if(m===p||p!==null&&m===p.alternate)break t;m=ds(m),p=ds(p)}m=null}else m=null;_!==null&&Sl(u,x,_,m,!1),b!==null&&T!==null&&Sl(u,T,b,m,!0)}}e:{if(x=d?ws(d):window,_=x.nodeName&&x.nodeName.toLowerCase(),_==="select"||_==="input"&&x.type==="file")var N=Ap;else if(fl(x))if(_d)N=Rp;else{N=Pp;var S=Tp}else(_=x.nodeName)&&_.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(N=Ip);if(N&&(N=N(t,d))){bd(u,N,a,h);break e}S&&S(t,x,d),t==="focusout"&&(S=x._wrapperState)&&S.controlled&&x.type==="number"&&ci(x,"number",x.value)}switch(S=d?ws(d):window,t){case"focusin":(fl(S)||S.contentEditable==="true")&&(bs=S,_i=d,xa=null);break;case"focusout":xa=_i=bs=null;break;case"mousedown":wi=!0;break;case"contextmenu":case"mouseup":case"dragend":wi=!1,wl(u,a,h);break;case"selectionchange":if(Op)break;case"keydown":case"keyup":wl(u,a,h)}var A;if(go)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else ys?vd(t,a)&&(k="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(k="onCompositionStart");k&&(fd&&a.locale!=="ko"&&(ys||k!=="onCompositionStart"?k==="onCompositionEnd"&&ys&&(A=gd()):(At=h,mo="value"in At?At.value:At.textContent,ys=!0)),S=Lr(d,k),0<S.length&&(k=new ml(k,t,null,a,h),u.push({event:k,listeners:S}),A?k.data=A:(A=yd(a),A!==null&&(k.data=A)))),(A=jp?Np(t,a):Sp(t,a))&&(d=Lr(d,"onBeforeInput"),0<d.length&&(h=new ml("onBeforeInput","beforeinput",null,a,h),u.push({event:h,listeners:d}),h.data=A))}Id(u,s)})}function Pa(t,s,a){return{instance:t,listener:s,currentTarget:a}}function Lr(t,s){for(var a=s+"Capture",r=[];t!==null;){var n=t,i=n.stateNode;n.tag===5&&i!==null&&(n=i,i=ja(t,a),i!=null&&r.unshift(Pa(t,i,n)),i=ja(t,s),i!=null&&r.push(Pa(t,i,n))),t=t.return}return r}function ds(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Sl(t,s,a,r,n){for(var i=s._reactName,o=[];a!==null&&a!==r;){var l=a,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,n?(c=ja(a,i),c!=null&&o.unshift(Pa(a,c,l))):n||(c=ja(a,i),c!=null&&o.push(Pa(a,c,l)))),a=a.return}o.length!==0&&t.push({event:s,listeners:o})}var Gp=/\r\n?/g,Vp=/\u0000|\uFFFD/g;function kl(t){return(typeof t=="string"?t:""+t).replace(Gp,`
`).replace(Vp,"")}function tr(t,s,a){if(s=kl(s),kl(t)!==s&&a)throw Error(C(425))}function Or(){}var ji=null,Ni=null;function Si(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ki=typeof setTimeout=="function"?setTimeout:void 0,Up=typeof clearTimeout=="function"?clearTimeout:void 0,Cl=typeof Promise=="function"?Promise:void 0,Hp=typeof queueMicrotask=="function"?queueMicrotask:typeof Cl<"u"?function(t){return Cl.resolve(null).then(t).catch(Wp)}:ki;function Wp(t){setTimeout(function(){throw t})}function Rn(t,s){var a=s,r=0;do{var n=a.nextSibling;if(t.removeChild(a),n&&n.nodeType===8)if(a=n.data,a==="/$"){if(r===0){t.removeChild(n),ka(s);return}r--}else a!=="$"&&a!=="$?"&&a!=="$!"||r++;a=n}while(a);ka(s)}function Et(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function Al(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return t;s--}else a==="/$"&&s++}t=t.previousSibling}return null}var Bs=Math.random().toString(36).slice(2),it="__reactFiber$"+Bs,Ia="__reactProps$"+Bs,vt="__reactContainer$"+Bs,Ci="__reactEvents$"+Bs,zp="__reactListeners$"+Bs,$p="__reactHandles$"+Bs;function Qt(t){var s=t[it];if(s)return s;for(var a=t.parentNode;a;){if(s=a[vt]||a[it]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(t=Al(t);t!==null;){if(a=t[it])return a;t=Al(t)}return s}t=a,a=t.parentNode}return null}function Ua(t){return t=t[it]||t[vt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ws(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(C(33))}function sn(t){return t[Ia]||null}var Ai=[],js=-1;function Ut(t){return{current:t}}function X(t){0>js||(t.current=Ai[js],Ai[js]=null,js--)}function Q(t,s){js++,Ai[js]=t.current,t.current=s}var Gt={},we=Ut(Gt),Ie=Ut(!1),ss=Gt;function Ms(t,s){var a=t.type.contextTypes;if(!a)return Gt;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===s)return r.__reactInternalMemoizedMaskedChildContext;var n={},i;for(i in a)n[i]=s[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),n}function Re(t){return t=t.childContextTypes,t!=null}function Dr(){X(Ie),X(we)}function Tl(t,s,a){if(we.current!==Gt)throw Error(C(168));Q(we,s),Q(Ie,a)}function Ed(t,s,a){var r=t.stateNode;if(s=s.childContextTypes,typeof r.getChildContext!="function")return a;r=r.getChildContext();for(var n in r)if(!(n in s))throw Error(C(108,Tu(t)||"Unknown",n));return re({},a,r)}function Mr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gt,ss=we.current,Q(we,t),Q(Ie,Ie.current),!0}function Pl(t,s,a){var r=t.stateNode;if(!r)throw Error(C(169));a?(t=Ed(t,s,ss),r.__reactInternalMemoizedMergedChildContext=t,X(Ie),X(we),Q(we,t)):X(Ie),Q(Ie,a)}var mt=null,an=!1,En=!1;function Ld(t){mt===null?mt=[t]:mt.push(t)}function Bp(t){an=!0,Ld(t)}function Ht(){if(!En&&mt!==null){En=!0;var t=0,s=q;try{var a=mt;for(q=1;t<a.length;t++){var r=a[t];do r=r(!0);while(r!==null)}mt=null,an=!1}catch(n){throw mt!==null&&(mt=mt.slice(t+1)),nd(lo,Ht),n}finally{q=s,En=!1}}return null}var Ns=[],Ss=0,Fr=null,Gr=0,He=[],We=0,as=null,ht=1,xt="";function Zt(t,s){Ns[Ss++]=Gr,Ns[Ss++]=Fr,Fr=t,Gr=s}function Od(t,s,a){He[We++]=ht,He[We++]=xt,He[We++]=as,as=t;var r=ht;t=xt;var n=32-Je(r)-1;r&=~(1<<n),a+=1;var i=32-Je(s)+n;if(30<i){var o=n-n%5;i=(r&(1<<o)-1).toString(32),r>>=o,n-=o,ht=1<<32-Je(s)+n|a<<n|r,xt=i+t}else ht=1<<i|a<<n|r,xt=t}function vo(t){t.return!==null&&(Zt(t,1),Od(t,1,0))}function yo(t){for(;t===Fr;)Fr=Ns[--Ss],Ns[Ss]=null,Gr=Ns[--Ss],Ns[Ss]=null;for(;t===as;)as=He[--We],He[We]=null,xt=He[--We],He[We]=null,ht=He[--We],He[We]=null}var De=null,Oe=null,J=!1,Xe=null;function Dd(t,s){var a=ze(5,null,null,0);a.elementType="DELETED",a.stateNode=s,a.return=t,s=t.deletions,s===null?(t.deletions=[a],t.flags|=16):s.push(a)}function Il(t,s){switch(t.tag){case 5:var a=t.type;return s=s.nodeType!==1||a.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,De=t,Oe=Et(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,De=t,Oe=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(a=as!==null?{id:ht,overflow:xt}:null,t.memoizedState={dehydrated:s,treeContext:a,retryLane:1073741824},a=ze(18,null,null,0),a.stateNode=s,a.return=t,t.child=a,De=t,Oe=null,!0):!1;default:return!1}}function Ti(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Pi(t){if(J){var s=Oe;if(s){var a=s;if(!Il(t,s)){if(Ti(t))throw Error(C(418));s=Et(a.nextSibling);var r=De;s&&Il(t,s)?Dd(r,a):(t.flags=t.flags&-4097|2,J=!1,De=t)}}else{if(Ti(t))throw Error(C(418));t.flags=t.flags&-4097|2,J=!1,De=t}}}function Rl(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;De=t}function sr(t){if(t!==De)return!1;if(!J)return Rl(t),J=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!Si(t.type,t.memoizedProps)),s&&(s=Oe)){if(Ti(t))throw Md(),Error(C(418));for(;s;)Dd(t,s),s=Et(s.nextSibling)}if(Rl(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(C(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(s===0){Oe=Et(t.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++}t=t.nextSibling}Oe=null}}else Oe=De?Et(t.stateNode.nextSibling):null;return!0}function Md(){for(var t=Oe;t;)t=Et(t.nextSibling)}function Fs(){Oe=De=null,J=!1}function bo(t){Xe===null?Xe=[t]:Xe.push(t)}var Zp=_t.ReactCurrentBatchConfig;function Xs(t,s,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(C(309));var r=a.stateNode}if(!r)throw Error(C(147,t));var n=r,i=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===i?s.ref:(s=function(o){var l=n.refs;o===null?delete l[i]:l[i]=o},s._stringRef=i,s)}if(typeof t!="string")throw Error(C(284));if(!a._owner)throw Error(C(290,t))}return t}function ar(t,s){throw t=Object.prototype.toString.call(s),Error(C(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function El(t){var s=t._init;return s(t._payload)}function Fd(t){function s(p,g){if(t){var f=p.deletions;f===null?(p.deletions=[g],p.flags|=16):f.push(g)}}function a(p,g){if(!t)return null;for(;g!==null;)s(p,g),g=g.sibling;return null}function r(p,g){for(p=new Map;g!==null;)g.key!==null?p.set(g.key,g):p.set(g.index,g),g=g.sibling;return p}function n(p,g){return p=Mt(p,g),p.index=0,p.sibling=null,p}function i(p,g,f){return p.index=f,t?(f=p.alternate,f!==null?(f=f.index,f<g?(p.flags|=2,g):f):(p.flags|=2,g)):(p.flags|=1048576,g)}function o(p){return t&&p.alternate===null&&(p.flags|=2),p}function l(p,g,f,j){return g===null||g.tag!==6?(g=Vn(f,p.mode,j),g.return=p,g):(g=n(g,f),g.return=p,g)}function c(p,g,f,j){var N=f.type;return N===vs?h(p,g,f.props.children,j,f.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Nt&&El(N)===g.type)?(j=n(g,f.props),j.ref=Xs(p,g,f),j.return=p,j):(j=Sr(f.type,f.key,f.props,null,p.mode,j),j.ref=Xs(p,g,f),j.return=p,j)}function d(p,g,f,j){return g===null||g.tag!==4||g.stateNode.containerInfo!==f.containerInfo||g.stateNode.implementation!==f.implementation?(g=Un(f,p.mode,j),g.return=p,g):(g=n(g,f.children||[]),g.return=p,g)}function h(p,g,f,j,N){return g===null||g.tag!==7?(g=ts(f,p.mode,j,N),g.return=p,g):(g=n(g,f),g.return=p,g)}function u(p,g,f){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Vn(""+g,p.mode,f),g.return=p,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ba:return f=Sr(g.type,g.key,g.props,null,p.mode,f),f.ref=Xs(p,null,g),f.return=p,f;case fs:return g=Un(g,p.mode,f),g.return=p,g;case Nt:var j=g._init;return u(p,j(g._payload),f)}if(ia(g)||Zs(g))return g=ts(g,p.mode,f,null),g.return=p,g;ar(p,g)}return null}function x(p,g,f,j){var N=g!==null?g.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return N!==null?null:l(p,g,""+f,j);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ba:return f.key===N?c(p,g,f,j):null;case fs:return f.key===N?d(p,g,f,j):null;case Nt:return N=f._init,x(p,g,N(f._payload),j)}if(ia(f)||Zs(f))return N!==null?null:h(p,g,f,j,null);ar(p,f)}return null}function _(p,g,f,j,N){if(typeof j=="string"&&j!==""||typeof j=="number")return p=p.get(f)||null,l(g,p,""+j,N);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ba:return p=p.get(j.key===null?f:j.key)||null,c(g,p,j,N);case fs:return p=p.get(j.key===null?f:j.key)||null,d(g,p,j,N);case Nt:var S=j._init;return _(p,g,f,S(j._payload),N)}if(ia(j)||Zs(j))return p=p.get(f)||null,h(g,p,j,N,null);ar(g,j)}return null}function b(p,g,f,j){for(var N=null,S=null,A=g,k=g=0,I=null;A!==null&&k<f.length;k++){A.index>k?(I=A,A=null):I=A.sibling;var E=x(p,A,f[k],j);if(E===null){A===null&&(A=I);break}t&&A&&E.alternate===null&&s(p,A),g=i(E,g,k),S===null?N=E:S.sibling=E,S=E,A=I}if(k===f.length)return a(p,A),J&&Zt(p,k),N;if(A===null){for(;k<f.length;k++)A=u(p,f[k],j),A!==null&&(g=i(A,g,k),S===null?N=A:S.sibling=A,S=A);return J&&Zt(p,k),N}for(A=r(p,A);k<f.length;k++)I=_(A,p,k,f[k],j),I!==null&&(t&&I.alternate!==null&&A.delete(I.key===null?k:I.key),g=i(I,g,k),S===null?N=I:S.sibling=I,S=I);return t&&A.forEach(function(W){return s(p,W)}),J&&Zt(p,k),N}function m(p,g,f,j){var N=Zs(f);if(typeof N!="function")throw Error(C(150));if(f=N.call(f),f==null)throw Error(C(151));for(var S=N=null,A=g,k=g=0,I=null,E=f.next();A!==null&&!E.done;k++,E=f.next()){A.index>k?(I=A,A=null):I=A.sibling;var W=x(p,A,E.value,j);if(W===null){A===null&&(A=I);break}t&&A&&W.alternate===null&&s(p,A),g=i(W,g,k),S===null?N=W:S.sibling=W,S=W,A=I}if(E.done)return a(p,A),J&&Zt(p,k),N;if(A===null){for(;!E.done;k++,E=f.next())E=u(p,E.value,j),E!==null&&(g=i(E,g,k),S===null?N=E:S.sibling=E,S=E);return J&&Zt(p,k),N}for(A=r(p,A);!E.done;k++,E=f.next())E=_(A,p,k,E.value,j),E!==null&&(t&&E.alternate!==null&&A.delete(E.key===null?k:E.key),g=i(E,g,k),S===null?N=E:S.sibling=E,S=E);return t&&A.forEach(function(Z){return s(p,Z)}),J&&Zt(p,k),N}function T(p,g,f,j){if(typeof f=="object"&&f!==null&&f.type===vs&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case Ba:e:{for(var N=f.key,S=g;S!==null;){if(S.key===N){if(N=f.type,N===vs){if(S.tag===7){a(p,S.sibling),g=n(S,f.props.children),g.return=p,p=g;break e}}else if(S.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Nt&&El(N)===S.type){a(p,S.sibling),g=n(S,f.props),g.ref=Xs(p,S,f),g.return=p,p=g;break e}a(p,S);break}else s(p,S);S=S.sibling}f.type===vs?(g=ts(f.props.children,p.mode,j,f.key),g.return=p,p=g):(j=Sr(f.type,f.key,f.props,null,p.mode,j),j.ref=Xs(p,g,f),j.return=p,p=j)}return o(p);case fs:e:{for(S=f.key;g!==null;){if(g.key===S)if(g.tag===4&&g.stateNode.containerInfo===f.containerInfo&&g.stateNode.implementation===f.implementation){a(p,g.sibling),g=n(g,f.children||[]),g.return=p,p=g;break e}else{a(p,g);break}else s(p,g);g=g.sibling}g=Un(f,p.mode,j),g.return=p,p=g}return o(p);case Nt:return S=f._init,T(p,g,S(f._payload),j)}if(ia(f))return b(p,g,f,j);if(Zs(f))return m(p,g,f,j);ar(p,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,g!==null&&g.tag===6?(a(p,g.sibling),g=n(g,f),g.return=p,p=g):(a(p,g),g=Vn(f,p.mode,j),g.return=p,p=g),o(p)):a(p,g)}return T}var Gs=Fd(!0),Gd=Fd(!1),Vr=Ut(null),Ur=null,ks=null,_o=null;function wo(){_o=ks=Ur=null}function jo(t){var s=Vr.current;X(Vr),t._currentValue=s}function Ii(t,s,a){for(;t!==null;){var r=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,r!==null&&(r.childLanes|=s)):r!==null&&(r.childLanes&s)!==s&&(r.childLanes|=s),t===a)break;t=t.return}}function Ls(t,s){Ur=t,_o=ks=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(Pe=!0),t.firstContext=null)}function Be(t){var s=t._currentValue;if(_o!==t)if(t={context:t,memoizedValue:s,next:null},ks===null){if(Ur===null)throw Error(C(308));ks=t,Ur.dependencies={lanes:0,firstContext:t}}else ks=ks.next=t;return s}var Yt=null;function No(t){Yt===null?Yt=[t]:Yt.push(t)}function Vd(t,s,a,r){var n=s.interleaved;return n===null?(a.next=a,No(s)):(a.next=n.next,n.next=a),s.interleaved=a,yt(t,r)}function yt(t,s){t.lanes|=s;var a=t.alternate;for(a!==null&&(a.lanes|=s),a=t,t=t.return;t!==null;)t.childLanes|=s,a=t.alternate,a!==null&&(a.childLanes|=s),a=t,t=t.return;return a.tag===3?a.stateNode:null}var St=!1;function So(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ud(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gt(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Lt(t,s,a){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,$&2){var n=r.pending;return n===null?s.next=s:(s.next=n.next,n.next=s),r.pending=s,yt(t,a)}return n=r.interleaved,n===null?(s.next=s,No(r)):(s.next=n.next,n.next=s),r.interleaved=s,yt(t,a)}function yr(t,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194240)!==0)){var r=s.lanes;r&=t.pendingLanes,a|=r,s.lanes=a,co(t,a)}}function Ll(t,s){var a=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,a===r)){var n=null,i=null;if(a=a.firstBaseUpdate,a!==null){do{var o={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};i===null?n=i=o:i=i.next=o,a=a.next}while(a!==null);i===null?n=i=s:i=i.next=s}else n=i=s;a={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=s:t.next=s,a.lastBaseUpdate=s}function Hr(t,s,a,r){var n=t.updateQueue;St=!1;var i=n.firstBaseUpdate,o=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(i!==null){var u=n.baseState;o=0,h=d=c=null,l=i;do{var x=l.lane,_=l.eventTime;if((r&x)===x){h!==null&&(h=h.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,m=l;switch(x=s,_=a,m.tag){case 1:if(b=m.payload,typeof b=="function"){u=b.call(_,u,x);break e}u=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=m.payload,x=typeof b=="function"?b.call(_,u,x):b,x==null)break e;u=re({},u,x);break e;case 2:St=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,x=n.effects,x===null?n.effects=[l]:x.push(l))}else _={eventTime:_,lane:x,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=_,c=u):h=h.next=_,o|=x;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;x=l,l=x.next,x.next=null,n.lastBaseUpdate=x,n.shared.pending=null}}while(!0);if(h===null&&(c=u),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=h,s=n.shared.interleaved,s!==null){n=s;do o|=n.lane,n=n.next;while(n!==s)}else i===null&&(n.shared.lanes=0);ns|=o,t.lanes=o,t.memoizedState=u}}function Ol(t,s,a){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var r=t[s],n=r.callback;if(n!==null){if(r.callback=null,r=a,typeof n!="function")throw Error(C(191,n));n.call(r)}}}var Ha={},lt=Ut(Ha),Ra=Ut(Ha),Ea=Ut(Ha);function Xt(t){if(t===Ha)throw Error(C(174));return t}function ko(t,s){switch(Q(Ea,s),Q(Ra,t),Q(lt,Ha),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:ui(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=ui(s,t)}X(lt),Q(lt,s)}function Vs(){X(lt),X(Ra),X(Ea)}function Hd(t){Xt(Ea.current);var s=Xt(lt.current),a=ui(s,t.type);s!==a&&(Q(Ra,t),Q(lt,a))}function Co(t){Ra.current===t&&(X(lt),X(Ra))}var se=Ut(0);function Wr(t){for(var s=t;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ln=[];function Ao(){for(var t=0;t<Ln.length;t++)Ln[t]._workInProgressVersionPrimary=null;Ln.length=0}var br=_t.ReactCurrentDispatcher,On=_t.ReactCurrentBatchConfig,rs=0,ae=null,ce=null,pe=null,zr=!1,ga=!1,La=0,qp=0;function ye(){throw Error(C(321))}function To(t,s){if(s===null)return!1;for(var a=0;a<s.length&&a<t.length;a++)if(!tt(t[a],s[a]))return!1;return!0}function Po(t,s,a,r,n,i){if(rs=i,ae=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,br.current=t===null||t.memoizedState===null?Xp:Jp,t=a(r,n),ga){i=0;do{if(ga=!1,La=0,25<=i)throw Error(C(301));i+=1,pe=ce=null,s.updateQueue=null,br.current=em,t=a(r,n)}while(ga)}if(br.current=$r,s=ce!==null&&ce.next!==null,rs=0,pe=ce=ae=null,zr=!1,s)throw Error(C(300));return t}function Io(){var t=La!==0;return La=0,t}function nt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pe===null?ae.memoizedState=pe=t:pe=pe.next=t,pe}function Ze(){if(ce===null){var t=ae.alternate;t=t!==null?t.memoizedState:null}else t=ce.next;var s=pe===null?ae.memoizedState:pe.next;if(s!==null)pe=s,ce=t;else{if(t===null)throw Error(C(310));ce=t,t={memoizedState:ce.memoizedState,baseState:ce.baseState,baseQueue:ce.baseQueue,queue:ce.queue,next:null},pe===null?ae.memoizedState=pe=t:pe=pe.next=t}return pe}function Oa(t,s){return typeof s=="function"?s(t):s}function Dn(t){var s=Ze(),a=s.queue;if(a===null)throw Error(C(311));a.lastRenderedReducer=t;var r=ce,n=r.baseQueue,i=a.pending;if(i!==null){if(n!==null){var o=n.next;n.next=i.next,i.next=o}r.baseQueue=n=i,a.pending=null}if(n!==null){i=n.next,r=r.baseState;var l=o=null,c=null,d=i;do{var h=d.lane;if((rs&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=u,o=r):c=c.next=u,ae.lanes|=h,ns|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,tt(r,s.memoizedState)||(Pe=!0),s.memoizedState=r,s.baseState=o,s.baseQueue=c,a.lastRenderedState=r}if(t=a.interleaved,t!==null){n=t;do i=n.lane,ae.lanes|=i,ns|=i,n=n.next;while(n!==t)}else n===null&&(a.lanes=0);return[s.memoizedState,a.dispatch]}function Mn(t){var s=Ze(),a=s.queue;if(a===null)throw Error(C(311));a.lastRenderedReducer=t;var r=a.dispatch,n=a.pending,i=s.memoizedState;if(n!==null){a.pending=null;var o=n=n.next;do i=t(i,o.action),o=o.next;while(o!==n);tt(i,s.memoizedState)||(Pe=!0),s.memoizedState=i,s.baseQueue===null&&(s.baseState=i),a.lastRenderedState=i}return[i,r]}function Wd(){}function zd(t,s){var a=ae,r=Ze(),n=s(),i=!tt(r.memoizedState,n);if(i&&(r.memoizedState=n,Pe=!0),r=r.queue,Ro(Zd.bind(null,a,r,t),[t]),r.getSnapshot!==s||i||pe!==null&&pe.memoizedState.tag&1){if(a.flags|=2048,Da(9,Bd.bind(null,a,r,n,s),void 0,null),me===null)throw Error(C(349));rs&30||$d(a,s,n)}return n}function $d(t,s,a){t.flags|=16384,t={getSnapshot:s,value:a},s=ae.updateQueue,s===null?(s={lastEffect:null,stores:null},ae.updateQueue=s,s.stores=[t]):(a=s.stores,a===null?s.stores=[t]:a.push(t))}function Bd(t,s,a,r){s.value=a,s.getSnapshot=r,qd(s)&&Kd(t)}function Zd(t,s,a){return a(function(){qd(s)&&Kd(t)})}function qd(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!tt(t,a)}catch{return!0}}function Kd(t){var s=yt(t,1);s!==null&&et(s,t,1,-1)}function Dl(t){var s=nt();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:t},s.queue=t,t=t.dispatch=Yp.bind(null,ae,t),[s.memoizedState,t]}function Da(t,s,a,r){return t={tag:t,create:s,destroy:a,deps:r,next:null},s=ae.updateQueue,s===null?(s={lastEffect:null,stores:null},ae.updateQueue=s,s.lastEffect=t.next=t):(a=s.lastEffect,a===null?s.lastEffect=t.next=t:(r=a.next,a.next=t,t.next=r,s.lastEffect=t)),t}function Qd(){return Ze().memoizedState}function _r(t,s,a,r){var n=nt();ae.flags|=t,n.memoizedState=Da(1|s,a,void 0,r===void 0?null:r)}function rn(t,s,a,r){var n=Ze();r=r===void 0?null:r;var i=void 0;if(ce!==null){var o=ce.memoizedState;if(i=o.destroy,r!==null&&To(r,o.deps)){n.memoizedState=Da(s,a,i,r);return}}ae.flags|=t,n.memoizedState=Da(1|s,a,i,r)}function Ml(t,s){return _r(8390656,8,t,s)}function Ro(t,s){return rn(2048,8,t,s)}function Yd(t,s){return rn(4,2,t,s)}function Xd(t,s){return rn(4,4,t,s)}function Jd(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function e0(t,s,a){return a=a!=null?a.concat([t]):null,rn(4,4,Jd.bind(null,s,t),a)}function Eo(){}function t0(t,s){var a=Ze();s=s===void 0?null:s;var r=a.memoizedState;return r!==null&&s!==null&&To(s,r[1])?r[0]:(a.memoizedState=[t,s],t)}function s0(t,s){var a=Ze();s=s===void 0?null:s;var r=a.memoizedState;return r!==null&&s!==null&&To(s,r[1])?r[0]:(t=t(),a.memoizedState=[t,s],t)}function a0(t,s,a){return rs&21?(tt(a,s)||(a=ld(),ae.lanes|=a,ns|=a,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,Pe=!0),t.memoizedState=a)}function Kp(t,s){var a=q;q=a!==0&&4>a?a:4,t(!0);var r=On.transition;On.transition={};try{t(!1),s()}finally{q=a,On.transition=r}}function r0(){return Ze().memoizedState}function Qp(t,s,a){var r=Dt(t);if(a={lane:r,action:a,hasEagerState:!1,eagerState:null,next:null},n0(t))i0(s,a);else if(a=Vd(t,s,a,r),a!==null){var n=Se();et(a,t,r,n),o0(a,s,r)}}function Yp(t,s,a){var r=Dt(t),n={lane:r,action:a,hasEagerState:!1,eagerState:null,next:null};if(n0(t))i0(s,n);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=s.lastRenderedReducer,i!==null))try{var o=s.lastRenderedState,l=i(o,a);if(n.hasEagerState=!0,n.eagerState=l,tt(l,o)){var c=s.interleaved;c===null?(n.next=n,No(s)):(n.next=c.next,c.next=n),s.interleaved=n;return}}catch{}finally{}a=Vd(t,s,n,r),a!==null&&(n=Se(),et(a,t,r,n),o0(a,s,r))}}function n0(t){var s=t.alternate;return t===ae||s!==null&&s===ae}function i0(t,s){ga=zr=!0;var a=t.pending;a===null?s.next=s:(s.next=a.next,a.next=s),t.pending=s}function o0(t,s,a){if(a&4194240){var r=s.lanes;r&=t.pendingLanes,a|=r,s.lanes=a,co(t,a)}}var $r={readContext:Be,useCallback:ye,useContext:ye,useEffect:ye,useImperativeHandle:ye,useInsertionEffect:ye,useLayoutEffect:ye,useMemo:ye,useReducer:ye,useRef:ye,useState:ye,useDebugValue:ye,useDeferredValue:ye,useTransition:ye,useMutableSource:ye,useSyncExternalStore:ye,useId:ye,unstable_isNewReconciler:!1},Xp={readContext:Be,useCallback:function(t,s){return nt().memoizedState=[t,s===void 0?null:s],t},useContext:Be,useEffect:Ml,useImperativeHandle:function(t,s,a){return a=a!=null?a.concat([t]):null,_r(4194308,4,Jd.bind(null,s,t),a)},useLayoutEffect:function(t,s){return _r(4194308,4,t,s)},useInsertionEffect:function(t,s){return _r(4,2,t,s)},useMemo:function(t,s){var a=nt();return s=s===void 0?null:s,t=t(),a.memoizedState=[t,s],t},useReducer:function(t,s,a){var r=nt();return s=a!==void 0?a(s):s,r.memoizedState=r.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},r.queue=t,t=t.dispatch=Qp.bind(null,ae,t),[r.memoizedState,t]},useRef:function(t){var s=nt();return t={current:t},s.memoizedState=t},useState:Dl,useDebugValue:Eo,useDeferredValue:function(t){return nt().memoizedState=t},useTransition:function(){var t=Dl(!1),s=t[0];return t=Kp.bind(null,t[1]),nt().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,a){var r=ae,n=nt();if(J){if(a===void 0)throw Error(C(407));a=a()}else{if(a=s(),me===null)throw Error(C(349));rs&30||$d(r,s,a)}n.memoizedState=a;var i={value:a,getSnapshot:s};return n.queue=i,Ml(Zd.bind(null,r,i,t),[t]),r.flags|=2048,Da(9,Bd.bind(null,r,i,a,s),void 0,null),a},useId:function(){var t=nt(),s=me.identifierPrefix;if(J){var a=xt,r=ht;a=(r&~(1<<32-Je(r)-1)).toString(32)+a,s=":"+s+"R"+a,a=La++,0<a&&(s+="H"+a.toString(32)),s+=":"}else a=qp++,s=":"+s+"r"+a.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},Jp={readContext:Be,useCallback:t0,useContext:Be,useEffect:Ro,useImperativeHandle:e0,useInsertionEffect:Yd,useLayoutEffect:Xd,useMemo:s0,useReducer:Dn,useRef:Qd,useState:function(){return Dn(Oa)},useDebugValue:Eo,useDeferredValue:function(t){var s=Ze();return a0(s,ce.memoizedState,t)},useTransition:function(){var t=Dn(Oa)[0],s=Ze().memoizedState;return[t,s]},useMutableSource:Wd,useSyncExternalStore:zd,useId:r0,unstable_isNewReconciler:!1},em={readContext:Be,useCallback:t0,useContext:Be,useEffect:Ro,useImperativeHandle:e0,useInsertionEffect:Yd,useLayoutEffect:Xd,useMemo:s0,useReducer:Mn,useRef:Qd,useState:function(){return Mn(Oa)},useDebugValue:Eo,useDeferredValue:function(t){var s=Ze();return ce===null?s.memoizedState=t:a0(s,ce.memoizedState,t)},useTransition:function(){var t=Mn(Oa)[0],s=Ze().memoizedState;return[t,s]},useMutableSource:Wd,useSyncExternalStore:zd,useId:r0,unstable_isNewReconciler:!1};function Qe(t,s){if(t&&t.defaultProps){s=re({},s),t=t.defaultProps;for(var a in t)s[a]===void 0&&(s[a]=t[a]);return s}return s}function Ri(t,s,a,r){s=t.memoizedState,a=a(r,s),a=a==null?s:re({},s,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var nn={isMounted:function(t){return(t=t._reactInternals)?cs(t)===t:!1},enqueueSetState:function(t,s,a){t=t._reactInternals;var r=Se(),n=Dt(t),i=gt(r,n);i.payload=s,a!=null&&(i.callback=a),s=Lt(t,i,n),s!==null&&(et(s,t,n,r),yr(s,t,n))},enqueueReplaceState:function(t,s,a){t=t._reactInternals;var r=Se(),n=Dt(t),i=gt(r,n);i.tag=1,i.payload=s,a!=null&&(i.callback=a),s=Lt(t,i,n),s!==null&&(et(s,t,n,r),yr(s,t,n))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var a=Se(),r=Dt(t),n=gt(a,r);n.tag=2,s!=null&&(n.callback=s),s=Lt(t,n,r),s!==null&&(et(s,t,r,a),yr(s,t,r))}};function Fl(t,s,a,r,n,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):s.prototype&&s.prototype.isPureReactComponent?!Aa(a,r)||!Aa(n,i):!0}function l0(t,s,a){var r=!1,n=Gt,i=s.contextType;return typeof i=="object"&&i!==null?i=Be(i):(n=Re(s)?ss:we.current,r=s.contextTypes,i=(r=r!=null)?Ms(t,n):Gt),s=new s(a,i),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=nn,t.stateNode=s,s._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=i),s}function Gl(t,s,a,r){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,r),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,r),s.state!==t&&nn.enqueueReplaceState(s,s.state,null)}function Ei(t,s,a,r){var n=t.stateNode;n.props=a,n.state=t.memoizedState,n.refs={},So(t);var i=s.contextType;typeof i=="object"&&i!==null?n.context=Be(i):(i=Re(s)?ss:we.current,n.context=Ms(t,i)),n.state=t.memoizedState,i=s.getDerivedStateFromProps,typeof i=="function"&&(Ri(t,s,i,a),n.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(s=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),s!==n.state&&nn.enqueueReplaceState(n,n.state,null),Hr(t,a,n,r),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function Us(t,s){try{var a="",r=s;do a+=Au(r),r=r.return;while(r);var n=a}catch(i){n=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:s,stack:n,digest:null}}function Fn(t,s,a){return{value:t,source:null,stack:a??null,digest:s??null}}function Li(t,s){try{console.error(s.value)}catch(a){setTimeout(function(){throw a})}}var tm=typeof WeakMap=="function"?WeakMap:Map;function c0(t,s,a){a=gt(-1,a),a.tag=3,a.payload={element:null};var r=s.value;return a.callback=function(){Zr||(Zr=!0,zi=r),Li(t,s)},a}function d0(t,s,a){a=gt(-1,a),a.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var n=s.value;a.payload=function(){return r(n)},a.callback=function(){Li(t,s)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(a.callback=function(){Li(t,s),typeof r!="function"&&(Ot===null?Ot=new Set([this]):Ot.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})}),a}function Vl(t,s,a){var r=t.pingCache;if(r===null){r=t.pingCache=new tm;var n=new Set;r.set(s,n)}else n=r.get(s),n===void 0&&(n=new Set,r.set(s,n));n.has(a)||(n.add(a),t=xm.bind(null,t,s,a),s.then(t,t))}function Ul(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function Hl(t,s,a,r,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===s?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(s=gt(-1,1),s.tag=2,Lt(a,s,1))),a.lanes|=1),t)}var sm=_t.ReactCurrentOwner,Pe=!1;function Ne(t,s,a,r){s.child=t===null?Gd(s,null,a,r):Gs(s,t.child,a,r)}function Wl(t,s,a,r,n){a=a.render;var i=s.ref;return Ls(s,n),r=Po(t,s,a,r,i,n),a=Io(),t!==null&&!Pe?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,bt(t,s,n)):(J&&a&&vo(s),s.flags|=1,Ne(t,s,r,n),s.child)}function zl(t,s,a,r,n){if(t===null){var i=a.type;return typeof i=="function"&&!Uo(i)&&i.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(s.tag=15,s.type=i,u0(t,s,i,r,n)):(t=Sr(a.type,null,r,s,s.mode,n),t.ref=s.ref,t.return=s,s.child=t)}if(i=t.child,!(t.lanes&n)){var o=i.memoizedProps;if(a=a.compare,a=a!==null?a:Aa,a(o,r)&&t.ref===s.ref)return bt(t,s,n)}return s.flags|=1,t=Mt(i,r),t.ref=s.ref,t.return=s,s.child=t}function u0(t,s,a,r,n){if(t!==null){var i=t.memoizedProps;if(Aa(i,r)&&t.ref===s.ref)if(Pe=!1,s.pendingProps=r=i,(t.lanes&n)!==0)t.flags&131072&&(Pe=!0);else return s.lanes=t.lanes,bt(t,s,n)}return Oi(t,s,a,r,n)}function p0(t,s,a){var r=s.pendingProps,n=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Q(As,Le),Le|=a;else{if(!(a&1073741824))return t=i!==null?i.baseLanes|a:a,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Q(As,Le),Le|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:a,Q(As,Le),Le|=r}else i!==null?(r=i.baseLanes|a,s.memoizedState=null):r=a,Q(As,Le),Le|=r;return Ne(t,s,n,a),s.child}function m0(t,s){var a=s.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(s.flags|=512,s.flags|=2097152)}function Oi(t,s,a,r,n){var i=Re(a)?ss:we.current;return i=Ms(s,i),Ls(s,n),a=Po(t,s,a,r,i,n),r=Io(),t!==null&&!Pe?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~n,bt(t,s,n)):(J&&r&&vo(s),s.flags|=1,Ne(t,s,a,n),s.child)}function $l(t,s,a,r,n){if(Re(a)){var i=!0;Mr(s)}else i=!1;if(Ls(s,n),s.stateNode===null)wr(t,s),l0(s,a,r),Ei(s,a,r,n),r=!0;else if(t===null){var o=s.stateNode,l=s.memoizedProps;o.props=l;var c=o.context,d=a.contextType;typeof d=="object"&&d!==null?d=Be(d):(d=Re(a)?ss:we.current,d=Ms(s,d));var h=a.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Gl(s,o,r,d),St=!1;var x=s.memoizedState;o.state=x,Hr(s,r,o,n),c=s.memoizedState,l!==r||x!==c||Ie.current||St?(typeof h=="function"&&(Ri(s,a,h,r),c=s.memoizedState),(l=St||Fl(s,a,l,r,x,c,d))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(s.flags|=4194308)):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=r,s.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),r=!1)}else{o=s.stateNode,Ud(t,s),l=s.memoizedProps,d=s.type===s.elementType?l:Qe(s.type,l),o.props=d,u=s.pendingProps,x=o.context,c=a.contextType,typeof c=="object"&&c!==null?c=Be(c):(c=Re(a)?ss:we.current,c=Ms(s,c));var _=a.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==u||x!==c)&&Gl(s,o,r,c),St=!1,x=s.memoizedState,o.state=x,Hr(s,r,o,n);var b=s.memoizedState;l!==u||x!==b||Ie.current||St?(typeof _=="function"&&(Ri(s,a,_,r),b=s.memoizedState),(d=St||Fl(s,a,d,r,x,b,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,c)),typeof o.componentDidUpdate=="function"&&(s.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(s.flags|=1024),s.memoizedProps=r,s.memoizedState=b),o.props=r,o.state=b,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(s.flags|=1024),r=!1)}return Di(t,s,a,r,i,n)}function Di(t,s,a,r,n,i){m0(t,s);var o=(s.flags&128)!==0;if(!r&&!o)return n&&Pl(s,a,!1),bt(t,s,i);r=s.stateNode,sm.current=s;var l=o&&typeof a.getDerivedStateFromError!="function"?null:r.render();return s.flags|=1,t!==null&&o?(s.child=Gs(s,t.child,null,i),s.child=Gs(s,null,l,i)):Ne(t,s,l,i),s.memoizedState=r.state,n&&Pl(s,a,!0),s.child}function h0(t){var s=t.stateNode;s.pendingContext?Tl(t,s.pendingContext,s.pendingContext!==s.context):s.context&&Tl(t,s.context,!1),ko(t,s.containerInfo)}function Bl(t,s,a,r,n){return Fs(),bo(n),s.flags|=256,Ne(t,s,a,r),s.child}var Mi={dehydrated:null,treeContext:null,retryLane:0};function Fi(t){return{baseLanes:t,cachePool:null,transitions:null}}function x0(t,s,a){var r=s.pendingProps,n=se.current,i=!1,o=(s.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(n&2)!==0),l?(i=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),Q(se,n&1),t===null)return Pi(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(o=r.children,t=r.fallback,i?(r=s.mode,i=s.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=cn(o,r,0,null),t=ts(t,r,a,null),i.return=s,t.return=s,i.sibling=t,s.child=i,s.child.memoizedState=Fi(a),s.memoizedState=Mi,t):Lo(s,o));if(n=t.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return am(t,s,o,r,l,n,a);if(i){i=r.fallback,o=s.mode,n=t.child,l=n.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&s.child!==n?(r=s.child,r.childLanes=0,r.pendingProps=c,s.deletions=null):(r=Mt(n,c),r.subtreeFlags=n.subtreeFlags&14680064),l!==null?i=Mt(l,i):(i=ts(i,o,a,null),i.flags|=2),i.return=s,r.return=s,r.sibling=i,s.child=r,r=i,i=s.child,o=t.child.memoizedState,o=o===null?Fi(a):{baseLanes:o.baseLanes|a,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~a,s.memoizedState=Mi,r}return i=t.child,t=i.sibling,r=Mt(i,{mode:"visible",children:r.children}),!(s.mode&1)&&(r.lanes=a),r.return=s,r.sibling=null,t!==null&&(a=s.deletions,a===null?(s.deletions=[t],s.flags|=16):a.push(t)),s.child=r,s.memoizedState=null,r}function Lo(t,s){return s=cn({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function rr(t,s,a,r){return r!==null&&bo(r),Gs(s,t.child,null,a),t=Lo(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function am(t,s,a,r,n,i,o){if(a)return s.flags&256?(s.flags&=-257,r=Fn(Error(C(422))),rr(t,s,o,r)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(i=r.fallback,n=s.mode,r=cn({mode:"visible",children:r.children},n,0,null),i=ts(i,n,o,null),i.flags|=2,r.return=s,i.return=s,r.sibling=i,s.child=r,s.mode&1&&Gs(s,t.child,null,o),s.child.memoizedState=Fi(o),s.memoizedState=Mi,i);if(!(s.mode&1))return rr(t,s,o,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(C(419)),r=Fn(i,r,void 0),rr(t,s,o,r)}if(l=(o&t.childLanes)!==0,Pe||l){if(r=me,r!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|o)?0:n,n!==0&&n!==i.retryLane&&(i.retryLane=n,yt(t,n),et(r,t,n,-1))}return Vo(),r=Fn(Error(C(421))),rr(t,s,o,r)}return n.data==="$?"?(s.flags|=128,s.child=t.child,s=gm.bind(null,t),n._reactRetry=s,null):(t=i.treeContext,Oe=Et(n.nextSibling),De=s,J=!0,Xe=null,t!==null&&(He[We++]=ht,He[We++]=xt,He[We++]=as,ht=t.id,xt=t.overflow,as=s),s=Lo(s,r.children),s.flags|=4096,s)}function Zl(t,s,a){t.lanes|=s;var r=t.alternate;r!==null&&(r.lanes|=s),Ii(t.return,s,a)}function Gn(t,s,a,r,n){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:r,tail:a,tailMode:n}:(i.isBackwards=s,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=a,i.tailMode=n)}function g0(t,s,a){var r=s.pendingProps,n=r.revealOrder,i=r.tail;if(Ne(t,s,r.children,a),r=se.current,r&2)r=r&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Zl(t,a,s);else if(t.tag===19)Zl(t,a,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Q(se,r),!(s.mode&1))s.memoizedState=null;else switch(n){case"forwards":for(a=s.child,n=null;a!==null;)t=a.alternate,t!==null&&Wr(t)===null&&(n=a),a=a.sibling;a=n,a===null?(n=s.child,s.child=null):(n=a.sibling,a.sibling=null),Gn(s,!1,n,a,i);break;case"backwards":for(a=null,n=s.child,s.child=null;n!==null;){if(t=n.alternate,t!==null&&Wr(t)===null){s.child=n;break}t=n.sibling,n.sibling=a,a=n,n=t}Gn(s,!0,a,null,i);break;case"together":Gn(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function wr(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function bt(t,s,a){if(t!==null&&(s.dependencies=t.dependencies),ns|=s.lanes,!(a&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(C(153));if(s.child!==null){for(t=s.child,a=Mt(t,t.pendingProps),s.child=a,a.return=s;t.sibling!==null;)t=t.sibling,a=a.sibling=Mt(t,t.pendingProps),a.return=s;a.sibling=null}return s.child}function rm(t,s,a){switch(s.tag){case 3:h0(s),Fs();break;case 5:Hd(s);break;case 1:Re(s.type)&&Mr(s);break;case 4:ko(s,s.stateNode.containerInfo);break;case 10:var r=s.type._context,n=s.memoizedProps.value;Q(Vr,r._currentValue),r._currentValue=n;break;case 13:if(r=s.memoizedState,r!==null)return r.dehydrated!==null?(Q(se,se.current&1),s.flags|=128,null):a&s.child.childLanes?x0(t,s,a):(Q(se,se.current&1),t=bt(t,s,a),t!==null?t.sibling:null);Q(se,se.current&1);break;case 19:if(r=(a&s.childLanes)!==0,t.flags&128){if(r)return g0(t,s,a);s.flags|=128}if(n=s.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Q(se,se.current),r)break;return null;case 22:case 23:return s.lanes=0,p0(t,s,a)}return bt(t,s,a)}var f0,Gi,v0,y0;f0=function(t,s){for(var a=s.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Gi=function(){};v0=function(t,s,a,r){var n=t.memoizedProps;if(n!==r){t=s.stateNode,Xt(lt.current);var i=null;switch(a){case"input":n=oi(t,n),r=oi(t,r),i=[];break;case"select":n=re({},n,{value:void 0}),r=re({},r,{value:void 0}),i=[];break;case"textarea":n=di(t,n),r=di(t,r),i=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Or)}pi(a,r);var o;a=null;for(d in n)if(!r.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var l=n[d];for(o in l)l.hasOwnProperty(o)&&(a||(a={}),a[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(_a.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=n!=null?n[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(a||(a={}),a[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(a||(a={}),a[o]=c[o])}else a||(i||(i=[]),i.push(d,a)),a=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(_a.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Y("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}a&&(i=i||[]).push("style",a);var d=i;(s.updateQueue=d)&&(s.flags|=4)}};y0=function(t,s,a,r){a!==r&&(s.flags|=4)};function Js(t,s){if(!J)switch(t.tailMode){case"hidden":s=t.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var r=null;a!==null;)a.alternate!==null&&(r=a),a=a.sibling;r===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function be(t){var s=t.alternate!==null&&t.alternate.child===t.child,a=0,r=0;if(s)for(var n=t.child;n!==null;)a|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)a|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=r,t.childLanes=a,s}function nm(t,s,a){var r=s.pendingProps;switch(yo(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return be(s),null;case 1:return Re(s.type)&&Dr(),be(s),null;case 3:return r=s.stateNode,Vs(),X(Ie),X(we),Ao(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(sr(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Xe!==null&&(Zi(Xe),Xe=null))),Gi(t,s),be(s),null;case 5:Co(s);var n=Xt(Ea.current);if(a=s.type,t!==null&&s.stateNode!=null)v0(t,s,a,r,n),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!r){if(s.stateNode===null)throw Error(C(166));return be(s),null}if(t=Xt(lt.current),sr(s)){r=s.stateNode,a=s.type;var i=s.memoizedProps;switch(r[it]=s,r[Ia]=i,t=(s.mode&1)!==0,a){case"dialog":Y("cancel",r),Y("close",r);break;case"iframe":case"object":case"embed":Y("load",r);break;case"video":case"audio":for(n=0;n<la.length;n++)Y(la[n],r);break;case"source":Y("error",r);break;case"img":case"image":case"link":Y("error",r),Y("load",r);break;case"details":Y("toggle",r);break;case"input":sl(r,i),Y("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Y("invalid",r);break;case"textarea":rl(r,i),Y("invalid",r)}pi(a,i),n=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&tr(r.textContent,l,t),n=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&tr(r.textContent,l,t),n=["children",""+l]):_a.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Y("scroll",r)}switch(a){case"input":Za(r),al(r,i,!0);break;case"textarea":Za(r),nl(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Or)}r=n,s.updateQueue=r,r!==null&&(s.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Zc(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(a,{is:r.is}):(t=o.createElement(a),a==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,a),t[it]=s,t[Ia]=r,f0(t,s,!1,!1),s.stateNode=t;e:{switch(o=mi(a,r),a){case"dialog":Y("cancel",t),Y("close",t),n=r;break;case"iframe":case"object":case"embed":Y("load",t),n=r;break;case"video":case"audio":for(n=0;n<la.length;n++)Y(la[n],t);n=r;break;case"source":Y("error",t),n=r;break;case"img":case"image":case"link":Y("error",t),Y("load",t),n=r;break;case"details":Y("toggle",t),n=r;break;case"input":sl(t,r),n=oi(t,r),Y("invalid",t);break;case"option":n=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},n=re({},r,{value:void 0}),Y("invalid",t);break;case"textarea":rl(t,r),n=di(t,r),Y("invalid",t);break;default:n=r}pi(a,n),l=n;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Qc(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&qc(t,c)):i==="children"?typeof c=="string"?(a!=="textarea"||c!=="")&&wa(t,c):typeof c=="number"&&wa(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(_a.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Y("scroll",t):c!=null&&ao(t,i,c,o))}switch(a){case"input":Za(t),al(t,r,!1);break;case"textarea":Za(t),nl(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ft(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ps(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ps(t,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=Or)}switch(a){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return be(s),null;case 6:if(t&&s.stateNode!=null)y0(t,s,t.memoizedProps,r);else{if(typeof r!="string"&&s.stateNode===null)throw Error(C(166));if(a=Xt(Ea.current),Xt(lt.current),sr(s)){if(r=s.stateNode,a=s.memoizedProps,r[it]=s,(i=r.nodeValue!==a)&&(t=De,t!==null))switch(t.tag){case 3:tr(r.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&tr(r.nodeValue,a,(t.mode&1)!==0)}i&&(s.flags|=4)}else r=(a.nodeType===9?a:a.ownerDocument).createTextNode(r),r[it]=s,s.stateNode=r}return be(s),null;case 13:if(X(se),r=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(J&&Oe!==null&&s.mode&1&&!(s.flags&128))Md(),Fs(),s.flags|=98560,i=!1;else if(i=sr(s),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(C(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(C(317));i[it]=s}else Fs(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;be(s),i=!1}else Xe!==null&&(Zi(Xe),Xe=null),i=!0;if(!i)return s.flags&65536?s:null}return s.flags&128?(s.lanes=a,s):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(s.child.flags|=8192,s.mode&1&&(t===null||se.current&1?de===0&&(de=3):Vo())),s.updateQueue!==null&&(s.flags|=4),be(s),null);case 4:return Vs(),Gi(t,s),t===null&&Ta(s.stateNode.containerInfo),be(s),null;case 10:return jo(s.type._context),be(s),null;case 17:return Re(s.type)&&Dr(),be(s),null;case 19:if(X(se),i=s.memoizedState,i===null)return be(s),null;if(r=(s.flags&128)!==0,o=i.rendering,o===null)if(r)Js(i,!1);else{if(de!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(o=Wr(t),o!==null){for(s.flags|=128,Js(i,!1),r=o.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),s.subtreeFlags=0,r=a,a=s.child;a!==null;)i=a,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return Q(se,se.current&1|2),s.child}t=t.sibling}i.tail!==null&&oe()>Hs&&(s.flags|=128,r=!0,Js(i,!1),s.lanes=4194304)}else{if(!r)if(t=Wr(o),t!==null){if(s.flags|=128,r=!0,a=t.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),Js(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!J)return be(s),null}else 2*oe()-i.renderingStartTime>Hs&&a!==1073741824&&(s.flags|=128,r=!0,Js(i,!1),s.lanes=4194304);i.isBackwards?(o.sibling=s.child,s.child=o):(a=i.last,a!==null?a.sibling=o:s.child=o,i.last=o)}return i.tail!==null?(s=i.tail,i.rendering=s,i.tail=s.sibling,i.renderingStartTime=oe(),s.sibling=null,a=se.current,Q(se,r?a&1|2:a&1),s):(be(s),null);case 22:case 23:return Go(),r=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(s.flags|=8192),r&&s.mode&1?Le&1073741824&&(be(s),s.subtreeFlags&6&&(s.flags|=8192)):be(s),null;case 24:return null;case 25:return null}throw Error(C(156,s.tag))}function im(t,s){switch(yo(s),s.tag){case 1:return Re(s.type)&&Dr(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return Vs(),X(Ie),X(we),Ao(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return Co(s),null;case 13:if(X(se),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(C(340));Fs()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return X(se),null;case 4:return Vs(),null;case 10:return jo(s.type._context),null;case 22:case 23:return Go(),null;case 24:return null;default:return null}}var nr=!1,_e=!1,om=typeof WeakSet=="function"?WeakSet:Set,M=null;function Cs(t,s){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(r){ne(t,s,r)}else a.current=null}function Vi(t,s,a){try{a()}catch(r){ne(t,s,r)}}var ql=!1;function lm(t,s){if(ji=Rr,t=Nd(),fo(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var r=a.getSelection&&a.getSelection();if(r&&r.rangeCount!==0){a=r.anchorNode;var n=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{a.nodeType,i.nodeType}catch{a=null;break e}var o=0,l=-1,c=-1,d=0,h=0,u=t,x=null;t:for(;;){for(var _;u!==a||n!==0&&u.nodeType!==3||(l=o+n),u!==i||r!==0&&u.nodeType!==3||(c=o+r),u.nodeType===3&&(o+=u.nodeValue.length),(_=u.firstChild)!==null;)x=u,u=_;for(;;){if(u===t)break t;if(x===a&&++d===n&&(l=o),x===i&&++h===r&&(c=o),(_=u.nextSibling)!==null)break;u=x,x=u.parentNode}u=_}a=l===-1||c===-1?null:{start:l,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(Ni={focusedElem:t,selectionRange:a},Rr=!1,M=s;M!==null;)if(s=M,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,M=t;else for(;M!==null;){s=M;try{var b=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var m=b.memoizedProps,T=b.memoizedState,p=s.stateNode,g=p.getSnapshotBeforeUpdate(s.elementType===s.type?m:Qe(s.type,m),T);p.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var f=s.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(C(163))}}catch(j){ne(s,s.return,j)}if(t=s.sibling,t!==null){t.return=s.return,M=t;break}M=s.return}return b=ql,ql=!1,b}function fa(t,s,a){var r=s.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&t)===t){var i=n.destroy;n.destroy=void 0,i!==void 0&&Vi(s,a,i)}n=n.next}while(n!==r)}}function on(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var r=a.create;a.destroy=r()}a=a.next}while(a!==s)}}function Ui(t){var s=t.ref;if(s!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof s=="function"?s(t):s.current=t}}function b0(t){var s=t.alternate;s!==null&&(t.alternate=null,b0(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[it],delete s[Ia],delete s[Ci],delete s[zp],delete s[$p])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function _0(t){return t.tag===5||t.tag===3||t.tag===4}function Kl(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||_0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hi(t,s,a){var r=t.tag;if(r===5||r===6)t=t.stateNode,s?a.nodeType===8?a.parentNode.insertBefore(t,s):a.insertBefore(t,s):(a.nodeType===8?(s=a.parentNode,s.insertBefore(t,a)):(s=a,s.appendChild(t)),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Or));else if(r!==4&&(t=t.child,t!==null))for(Hi(t,s,a),t=t.sibling;t!==null;)Hi(t,s,a),t=t.sibling}function Wi(t,s,a){var r=t.tag;if(r===5||r===6)t=t.stateNode,s?a.insertBefore(t,s):a.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wi(t,s,a),t=t.sibling;t!==null;)Wi(t,s,a),t=t.sibling}var ge=null,Ye=!1;function wt(t,s,a){for(a=a.child;a!==null;)w0(t,s,a),a=a.sibling}function w0(t,s,a){if(ot&&typeof ot.onCommitFiberUnmount=="function")try{ot.onCommitFiberUnmount(Xr,a)}catch{}switch(a.tag){case 5:_e||Cs(a,s);case 6:var r=ge,n=Ye;ge=null,wt(t,s,a),ge=r,Ye=n,ge!==null&&(Ye?(t=ge,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):ge.removeChild(a.stateNode));break;case 18:ge!==null&&(Ye?(t=ge,a=a.stateNode,t.nodeType===8?Rn(t.parentNode,a):t.nodeType===1&&Rn(t,a),ka(t)):Rn(ge,a.stateNode));break;case 4:r=ge,n=Ye,ge=a.stateNode.containerInfo,Ye=!0,wt(t,s,a),ge=r,Ye=n;break;case 0:case 11:case 14:case 15:if(!_e&&(r=a.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var i=n,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Vi(a,s,o),n=n.next}while(n!==r)}wt(t,s,a);break;case 1:if(!_e&&(Cs(a,s),r=a.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=a.memoizedProps,r.state=a.memoizedState,r.componentWillUnmount()}catch(l){ne(a,s,l)}wt(t,s,a);break;case 21:wt(t,s,a);break;case 22:a.mode&1?(_e=(r=_e)||a.memoizedState!==null,wt(t,s,a),_e=r):wt(t,s,a);break;default:wt(t,s,a)}}function Ql(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new om),s.forEach(function(r){var n=fm.bind(null,t,r);a.has(r)||(a.add(r),r.then(n,n))})}}function qe(t,s){var a=s.deletions;if(a!==null)for(var r=0;r<a.length;r++){var n=a[r];try{var i=t,o=s,l=o;e:for(;l!==null;){switch(l.tag){case 5:ge=l.stateNode,Ye=!1;break e;case 3:ge=l.stateNode.containerInfo,Ye=!0;break e;case 4:ge=l.stateNode.containerInfo,Ye=!0;break e}l=l.return}if(ge===null)throw Error(C(160));w0(i,o,n),ge=null,Ye=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(d){ne(n,s,d)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)j0(s,t),s=s.sibling}function j0(t,s){var a=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qe(s,t),st(t),r&4){try{fa(3,t,t.return),on(3,t)}catch(m){ne(t,t.return,m)}try{fa(5,t,t.return)}catch(m){ne(t,t.return,m)}}break;case 1:qe(s,t),st(t),r&512&&a!==null&&Cs(a,a.return);break;case 5:if(qe(s,t),st(t),r&512&&a!==null&&Cs(a,a.return),t.flags&32){var n=t.stateNode;try{wa(n,"")}catch(m){ne(t,t.return,m)}}if(r&4&&(n=t.stateNode,n!=null)){var i=t.memoizedProps,o=a!==null?a.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&$c(n,i),mi(l,o);var d=mi(l,i);for(o=0;o<c.length;o+=2){var h=c[o],u=c[o+1];h==="style"?Qc(n,u):h==="dangerouslySetInnerHTML"?qc(n,u):h==="children"?wa(n,u):ao(n,h,u,d)}switch(l){case"input":li(n,i);break;case"textarea":Bc(n,i);break;case"select":var x=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Ps(n,!!i.multiple,_,!1):x!==!!i.multiple&&(i.defaultValue!=null?Ps(n,!!i.multiple,i.defaultValue,!0):Ps(n,!!i.multiple,i.multiple?[]:"",!1))}n[Ia]=i}catch(m){ne(t,t.return,m)}}break;case 6:if(qe(s,t),st(t),r&4){if(t.stateNode===null)throw Error(C(162));n=t.stateNode,i=t.memoizedProps;try{n.nodeValue=i}catch(m){ne(t,t.return,m)}}break;case 3:if(qe(s,t),st(t),r&4&&a!==null&&a.memoizedState.isDehydrated)try{ka(s.containerInfo)}catch(m){ne(t,t.return,m)}break;case 4:qe(s,t),st(t);break;case 13:qe(s,t),st(t),n=t.child,n.flags&8192&&(i=n.memoizedState!==null,n.stateNode.isHidden=i,!i||n.alternate!==null&&n.alternate.memoizedState!==null||(Mo=oe())),r&4&&Ql(t);break;case 22:if(h=a!==null&&a.memoizedState!==null,t.mode&1?(_e=(d=_e)||h,qe(s,t),_e=d):qe(s,t),st(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(M=t,h=t.child;h!==null;){for(u=M=h;M!==null;){switch(x=M,_=x.child,x.tag){case 0:case 11:case 14:case 15:fa(4,x,x.return);break;case 1:Cs(x,x.return);var b=x.stateNode;if(typeof b.componentWillUnmount=="function"){r=x,a=x.return;try{s=r,b.props=s.memoizedProps,b.state=s.memoizedState,b.componentWillUnmount()}catch(m){ne(r,a,m)}}break;case 5:Cs(x,x.return);break;case 22:if(x.memoizedState!==null){Xl(u);continue}}_!==null?(_.return=x,M=_):Xl(u)}h=h.sibling}e:for(h=null,u=t;;){if(u.tag===5){if(h===null){h=u;try{n=u.stateNode,d?(i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=u.stateNode,c=u.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Kc("display",o))}catch(m){ne(t,t.return,m)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(m){ne(t,t.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:qe(s,t),st(t),r&4&&Ql(t);break;case 21:break;default:qe(s,t),st(t)}}function st(t){var s=t.flags;if(s&2){try{e:{for(var a=t.return;a!==null;){if(_0(a)){var r=a;break e}a=a.return}throw Error(C(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(wa(n,""),r.flags&=-33);var i=Kl(t);Wi(t,i,n);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Kl(t);Hi(t,l,o);break;default:throw Error(C(161))}}catch(c){ne(t,t.return,c)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function cm(t,s,a){M=t,N0(t)}function N0(t,s,a){for(var r=(t.mode&1)!==0;M!==null;){var n=M,i=n.child;if(n.tag===22&&r){var o=n.memoizedState!==null||nr;if(!o){var l=n.alternate,c=l!==null&&l.memoizedState!==null||_e;l=nr;var d=_e;if(nr=o,(_e=c)&&!d)for(M=n;M!==null;)o=M,c=o.child,o.tag===22&&o.memoizedState!==null?Jl(n):c!==null?(c.return=o,M=c):Jl(n);for(;i!==null;)M=i,N0(i),i=i.sibling;M=n,nr=l,_e=d}Yl(t)}else n.subtreeFlags&8772&&i!==null?(i.return=n,M=i):Yl(t)}}function Yl(t){for(;M!==null;){var s=M;if(s.flags&8772){var a=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:_e||on(5,s);break;case 1:var r=s.stateNode;if(s.flags&4&&!_e)if(a===null)r.componentDidMount();else{var n=s.elementType===s.type?a.memoizedProps:Qe(s.type,a.memoizedProps);r.componentDidUpdate(n,a.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=s.updateQueue;i!==null&&Ol(s,i,r);break;case 3:var o=s.updateQueue;if(o!==null){if(a=null,s.child!==null)switch(s.child.tag){case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}Ol(s,o,a)}break;case 5:var l=s.stateNode;if(a===null&&s.flags&4){a=l;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var d=s.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&ka(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(C(163))}_e||s.flags&512&&Ui(s)}catch(x){ne(s,s.return,x)}}if(s===t){M=null;break}if(a=s.sibling,a!==null){a.return=s.return,M=a;break}M=s.return}}function Xl(t){for(;M!==null;){var s=M;if(s===t){M=null;break}var a=s.sibling;if(a!==null){a.return=s.return,M=a;break}M=s.return}}function Jl(t){for(;M!==null;){var s=M;try{switch(s.tag){case 0:case 11:case 15:var a=s.return;try{on(4,s)}catch(c){ne(s,a,c)}break;case 1:var r=s.stateNode;if(typeof r.componentDidMount=="function"){var n=s.return;try{r.componentDidMount()}catch(c){ne(s,n,c)}}var i=s.return;try{Ui(s)}catch(c){ne(s,i,c)}break;case 5:var o=s.return;try{Ui(s)}catch(c){ne(s,o,c)}}}catch(c){ne(s,s.return,c)}if(s===t){M=null;break}var l=s.sibling;if(l!==null){l.return=s.return,M=l;break}M=s.return}}var dm=Math.ceil,Br=_t.ReactCurrentDispatcher,Oo=_t.ReactCurrentOwner,$e=_t.ReactCurrentBatchConfig,$=0,me=null,le=null,fe=0,Le=0,As=Ut(0),de=0,Ma=null,ns=0,ln=0,Do=0,va=null,Te=null,Mo=0,Hs=1/0,pt=null,Zr=!1,zi=null,Ot=null,ir=!1,Tt=null,qr=0,ya=0,$i=null,jr=-1,Nr=0;function Se(){return $&6?oe():jr!==-1?jr:jr=oe()}function Dt(t){return t.mode&1?$&2&&fe!==0?fe&-fe:Zp.transition!==null?(Nr===0&&(Nr=ld()),Nr):(t=q,t!==0||(t=window.event,t=t===void 0?16:xd(t.type)),t):1}function et(t,s,a,r){if(50<ya)throw ya=0,$i=null,Error(C(185));Ga(t,a,r),(!($&2)||t!==me)&&(t===me&&(!($&2)&&(ln|=a),de===4&&Ct(t,fe)),Ee(t,r),a===1&&$===0&&!(s.mode&1)&&(Hs=oe()+500,an&&Ht()))}function Ee(t,s){var a=t.callbackNode;Zu(t,s);var r=Ir(t,t===me?fe:0);if(r===0)a!==null&&ll(a),t.callbackNode=null,t.callbackPriority=0;else if(s=r&-r,t.callbackPriority!==s){if(a!=null&&ll(a),s===1)t.tag===0?Bp(ec.bind(null,t)):Ld(ec.bind(null,t)),Hp(function(){!($&6)&&Ht()}),a=null;else{switch(cd(r)){case 1:a=lo;break;case 4:a=id;break;case 16:a=Pr;break;case 536870912:a=od;break;default:a=Pr}a=R0(a,S0.bind(null,t))}t.callbackPriority=s,t.callbackNode=a}}function S0(t,s){if(jr=-1,Nr=0,$&6)throw Error(C(327));var a=t.callbackNode;if(Os()&&t.callbackNode!==a)return null;var r=Ir(t,t===me?fe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||s)s=Kr(t,r);else{s=r;var n=$;$|=2;var i=C0();(me!==t||fe!==s)&&(pt=null,Hs=oe()+500,es(t,s));do try{mm();break}catch(l){k0(t,l)}while(!0);wo(),Br.current=i,$=n,le!==null?s=0:(me=null,fe=0,s=de)}if(s!==0){if(s===2&&(n=vi(t),n!==0&&(r=n,s=Bi(t,n))),s===1)throw a=Ma,es(t,0),Ct(t,r),Ee(t,oe()),a;if(s===6)Ct(t,r);else{if(n=t.current.alternate,!(r&30)&&!um(n)&&(s=Kr(t,r),s===2&&(i=vi(t),i!==0&&(r=i,s=Bi(t,i))),s===1))throw a=Ma,es(t,0),Ct(t,r),Ee(t,oe()),a;switch(t.finishedWork=n,t.finishedLanes=r,s){case 0:case 1:throw Error(C(345));case 2:qt(t,Te,pt);break;case 3:if(Ct(t,r),(r&130023424)===r&&(s=Mo+500-oe(),10<s)){if(Ir(t,0)!==0)break;if(n=t.suspendedLanes,(n&r)!==r){Se(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=ki(qt.bind(null,t,Te,pt),s);break}qt(t,Te,pt);break;case 4:if(Ct(t,r),(r&4194240)===r)break;for(s=t.eventTimes,n=-1;0<r;){var o=31-Je(r);i=1<<o,o=s[o],o>n&&(n=o),r&=~i}if(r=n,r=oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*dm(r/1960))-r,10<r){t.timeoutHandle=ki(qt.bind(null,t,Te,pt),r);break}qt(t,Te,pt);break;case 5:qt(t,Te,pt);break;default:throw Error(C(329))}}}return Ee(t,oe()),t.callbackNode===a?S0.bind(null,t):null}function Bi(t,s){var a=va;return t.current.memoizedState.isDehydrated&&(es(t,s).flags|=256),t=Kr(t,s),t!==2&&(s=Te,Te=a,s!==null&&Zi(s)),t}function Zi(t){Te===null?Te=t:Te.push.apply(Te,t)}function um(t){for(var s=t;;){if(s.flags&16384){var a=s.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var r=0;r<a.length;r++){var n=a[r],i=n.getSnapshot;n=n.value;try{if(!tt(i(),n))return!1}catch{return!1}}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ct(t,s){for(s&=~Do,s&=~ln,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var a=31-Je(s),r=1<<a;t[a]=-1,s&=~r}}function ec(t){if($&6)throw Error(C(327));Os();var s=Ir(t,0);if(!(s&1))return Ee(t,oe()),null;var a=Kr(t,s);if(t.tag!==0&&a===2){var r=vi(t);r!==0&&(s=r,a=Bi(t,r))}if(a===1)throw a=Ma,es(t,0),Ct(t,s),Ee(t,oe()),a;if(a===6)throw Error(C(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,qt(t,Te,pt),Ee(t,oe()),null}function Fo(t,s){var a=$;$|=1;try{return t(s)}finally{$=a,$===0&&(Hs=oe()+500,an&&Ht())}}function is(t){Tt!==null&&Tt.tag===0&&!($&6)&&Os();var s=$;$|=1;var a=$e.transition,r=q;try{if($e.transition=null,q=1,t)return t()}finally{q=r,$e.transition=a,$=s,!($&6)&&Ht()}}function Go(){Le=As.current,X(As)}function es(t,s){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,Up(a)),le!==null)for(a=le.return;a!==null;){var r=a;switch(yo(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dr();break;case 3:Vs(),X(Ie),X(we),Ao();break;case 5:Co(r);break;case 4:Vs();break;case 13:X(se);break;case 19:X(se);break;case 10:jo(r.type._context);break;case 22:case 23:Go()}a=a.return}if(me=t,le=t=Mt(t.current,null),fe=Le=s,de=0,Ma=null,Do=ln=ns=0,Te=va=null,Yt!==null){for(s=0;s<Yt.length;s++)if(a=Yt[s],r=a.interleaved,r!==null){a.interleaved=null;var n=r.next,i=a.pending;if(i!==null){var o=i.next;i.next=n,r.next=o}a.pending=r}Yt=null}return t}function k0(t,s){do{var a=le;try{if(wo(),br.current=$r,zr){for(var r=ae.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}zr=!1}if(rs=0,pe=ce=ae=null,ga=!1,La=0,Oo.current=null,a===null||a.return===null){de=1,Ma=s,le=null;break}e:{var i=t,o=a.return,l=a,c=s;if(s=fe,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var x=h.alternate;x?(h.updateQueue=x.updateQueue,h.memoizedState=x.memoizedState,h.lanes=x.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=Ul(o);if(_!==null){_.flags&=-257,Hl(_,o,l,i,s),_.mode&1&&Vl(i,d,s),s=_,c=d;var b=s.updateQueue;if(b===null){var m=new Set;m.add(c),s.updateQueue=m}else b.add(c);break e}else{if(!(s&1)){Vl(i,d,s),Vo();break e}c=Error(C(426))}}else if(J&&l.mode&1){var T=Ul(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Hl(T,o,l,i,s),bo(Us(c,l));break e}}i=c=Us(c,l),de!==4&&(de=2),va===null?va=[i]:va.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,s&=-s,i.lanes|=s;var p=c0(i,c,s);Ll(i,p);break e;case 1:l=c;var g=i.type,f=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Ot===null||!Ot.has(f)))){i.flags|=65536,s&=-s,i.lanes|=s;var j=d0(i,l,s);Ll(i,j);break e}}i=i.return}while(i!==null)}T0(a)}catch(N){s=N,le===a&&a!==null&&(le=a=a.return);continue}break}while(!0)}function C0(){var t=Br.current;return Br.current=$r,t===null?$r:t}function Vo(){(de===0||de===3||de===2)&&(de=4),me===null||!(ns&268435455)&&!(ln&268435455)||Ct(me,fe)}function Kr(t,s){var a=$;$|=2;var r=C0();(me!==t||fe!==s)&&(pt=null,es(t,s));do try{pm();break}catch(n){k0(t,n)}while(!0);if(wo(),$=a,Br.current=r,le!==null)throw Error(C(261));return me=null,fe=0,de}function pm(){for(;le!==null;)A0(le)}function mm(){for(;le!==null&&!Fu();)A0(le)}function A0(t){var s=I0(t.alternate,t,Le);t.memoizedProps=t.pendingProps,s===null?T0(t):le=s,Oo.current=null}function T0(t){var s=t;do{var a=s.alternate;if(t=s.return,s.flags&32768){if(a=im(a,s),a!==null){a.flags&=32767,le=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{de=6,le=null;return}}else if(a=nm(a,s,Le),a!==null){le=a;return}if(s=s.sibling,s!==null){le=s;return}le=s=t}while(s!==null);de===0&&(de=5)}function qt(t,s,a){var r=q,n=$e.transition;try{$e.transition=null,q=1,hm(t,s,a,r)}finally{$e.transition=n,q=r}return null}function hm(t,s,a,r){do Os();while(Tt!==null);if($&6)throw Error(C(327));a=t.finishedWork;var n=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(C(177));t.callbackNode=null,t.callbackPriority=0;var i=a.lanes|a.childLanes;if(qu(t,i),t===me&&(le=me=null,fe=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||ir||(ir=!0,R0(Pr,function(){return Os(),null})),i=(a.flags&15990)!==0,a.subtreeFlags&15990||i){i=$e.transition,$e.transition=null;var o=q;q=1;var l=$;$|=4,Oo.current=null,lm(t,a),j0(a,t),Lp(Ni),Rr=!!ji,Ni=ji=null,t.current=a,cm(a),Gu(),$=l,q=o,$e.transition=i}else t.current=a;if(ir&&(ir=!1,Tt=t,qr=n),i=t.pendingLanes,i===0&&(Ot=null),Hu(a.stateNode),Ee(t,oe()),s!==null)for(r=t.onRecoverableError,a=0;a<s.length;a++)n=s[a],r(n.value,{componentStack:n.stack,digest:n.digest});if(Zr)throw Zr=!1,t=zi,zi=null,t;return qr&1&&t.tag!==0&&Os(),i=t.pendingLanes,i&1?t===$i?ya++:(ya=0,$i=t):ya=0,Ht(),null}function Os(){if(Tt!==null){var t=cd(qr),s=$e.transition,a=q;try{if($e.transition=null,q=16>t?16:t,Tt===null)var r=!1;else{if(t=Tt,Tt=null,qr=0,$&6)throw Error(C(331));var n=$;for($|=4,M=t.current;M!==null;){var i=M,o=i.child;if(M.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(M=d;M!==null;){var h=M;switch(h.tag){case 0:case 11:case 15:fa(8,h,i)}var u=h.child;if(u!==null)u.return=h,M=u;else for(;M!==null;){h=M;var x=h.sibling,_=h.return;if(b0(h),h===d){M=null;break}if(x!==null){x.return=_,M=x;break}M=_}}}var b=i.alternate;if(b!==null){var m=b.child;if(m!==null){b.child=null;do{var T=m.sibling;m.sibling=null,m=T}while(m!==null)}}M=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,M=o;else e:for(;M!==null;){if(i=M,i.flags&2048)switch(i.tag){case 0:case 11:case 15:fa(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,M=p;break e}M=i.return}}var g=t.current;for(M=g;M!==null;){o=M;var f=o.child;if(o.subtreeFlags&2064&&f!==null)f.return=o,M=f;else e:for(o=g;M!==null;){if(l=M,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:on(9,l)}}catch(N){ne(l,l.return,N)}if(l===o){M=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,M=j;break e}M=l.return}}if($=n,Ht(),ot&&typeof ot.onPostCommitFiberRoot=="function")try{ot.onPostCommitFiberRoot(Xr,t)}catch{}r=!0}return r}finally{q=a,$e.transition=s}}return!1}function tc(t,s,a){s=Us(a,s),s=c0(t,s,1),t=Lt(t,s,1),s=Se(),t!==null&&(Ga(t,1,s),Ee(t,s))}function ne(t,s,a){if(t.tag===3)tc(t,t,a);else for(;s!==null;){if(s.tag===3){tc(s,t,a);break}else if(s.tag===1){var r=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ot===null||!Ot.has(r))){t=Us(a,t),t=d0(s,t,1),s=Lt(s,t,1),t=Se(),s!==null&&(Ga(s,1,t),Ee(s,t));break}}s=s.return}}function xm(t,s,a){var r=t.pingCache;r!==null&&r.delete(s),s=Se(),t.pingedLanes|=t.suspendedLanes&a,me===t&&(fe&a)===a&&(de===4||de===3&&(fe&130023424)===fe&&500>oe()-Mo?es(t,0):Do|=a),Ee(t,s)}function P0(t,s){s===0&&(t.mode&1?(s=Qa,Qa<<=1,!(Qa&130023424)&&(Qa=4194304)):s=1);var a=Se();t=yt(t,s),t!==null&&(Ga(t,s,a),Ee(t,a))}function gm(t){var s=t.memoizedState,a=0;s!==null&&(a=s.retryLane),P0(t,a)}function fm(t,s){var a=0;switch(t.tag){case 13:var r=t.stateNode,n=t.memoizedState;n!==null&&(a=n.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(C(314))}r!==null&&r.delete(s),P0(t,a)}var I0;I0=function(t,s,a){if(t!==null)if(t.memoizedProps!==s.pendingProps||Ie.current)Pe=!0;else{if(!(t.lanes&a)&&!(s.flags&128))return Pe=!1,rm(t,s,a);Pe=!!(t.flags&131072)}else Pe=!1,J&&s.flags&1048576&&Od(s,Gr,s.index);switch(s.lanes=0,s.tag){case 2:var r=s.type;wr(t,s),t=s.pendingProps;var n=Ms(s,we.current);Ls(s,a),n=Po(null,s,r,t,n,a);var i=Io();return s.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Re(r)?(i=!0,Mr(s)):i=!1,s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,So(s),n.updater=nn,s.stateNode=n,n._reactInternals=s,Ei(s,r,t,a),s=Di(null,s,r,!0,i,a)):(s.tag=0,J&&i&&vo(s),Ne(null,s,n,a),s=s.child),s;case 16:r=s.elementType;e:{switch(wr(t,s),t=s.pendingProps,n=r._init,r=n(r._payload),s.type=r,n=s.tag=ym(r),t=Qe(r,t),n){case 0:s=Oi(null,s,r,t,a);break e;case 1:s=$l(null,s,r,t,a);break e;case 11:s=Wl(null,s,r,t,a);break e;case 14:s=zl(null,s,r,Qe(r.type,t),a);break e}throw Error(C(306,r,""))}return s;case 0:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Qe(r,n),Oi(t,s,r,n,a);case 1:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Qe(r,n),$l(t,s,r,n,a);case 3:e:{if(h0(s),t===null)throw Error(C(387));r=s.pendingProps,i=s.memoizedState,n=i.element,Ud(t,s),Hr(s,r,null,a);var o=s.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},s.updateQueue.baseState=i,s.memoizedState=i,s.flags&256){n=Us(Error(C(423)),s),s=Bl(t,s,r,a,n);break e}else if(r!==n){n=Us(Error(C(424)),s),s=Bl(t,s,r,a,n);break e}else for(Oe=Et(s.stateNode.containerInfo.firstChild),De=s,J=!0,Xe=null,a=Gd(s,null,r,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Fs(),r===n){s=bt(t,s,a);break e}Ne(t,s,r,a)}s=s.child}return s;case 5:return Hd(s),t===null&&Pi(s),r=s.type,n=s.pendingProps,i=t!==null?t.memoizedProps:null,o=n.children,Si(r,n)?o=null:i!==null&&Si(r,i)&&(s.flags|=32),m0(t,s),Ne(t,s,o,a),s.child;case 6:return t===null&&Pi(s),null;case 13:return x0(t,s,a);case 4:return ko(s,s.stateNode.containerInfo),r=s.pendingProps,t===null?s.child=Gs(s,null,r,a):Ne(t,s,r,a),s.child;case 11:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Qe(r,n),Wl(t,s,r,n,a);case 7:return Ne(t,s,s.pendingProps,a),s.child;case 8:return Ne(t,s,s.pendingProps.children,a),s.child;case 12:return Ne(t,s,s.pendingProps.children,a),s.child;case 10:e:{if(r=s.type._context,n=s.pendingProps,i=s.memoizedProps,o=n.value,Q(Vr,r._currentValue),r._currentValue=o,i!==null)if(tt(i.value,o)){if(i.children===n.children&&!Ie.current){s=bt(t,s,a);break e}}else for(i=s.child,i!==null&&(i.return=s);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=gt(-1,a&-a),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=a,c=i.alternate,c!==null&&(c.lanes|=a),Ii(i.return,a,s),l.lanes|=a;break}c=c.next}}else if(i.tag===10)o=i.type===s.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(C(341));o.lanes|=a,l=o.alternate,l!==null&&(l.lanes|=a),Ii(o,a,s),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===s){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ne(t,s,n.children,a),s=s.child}return s;case 9:return n=s.type,r=s.pendingProps.children,Ls(s,a),n=Be(n),r=r(n),s.flags|=1,Ne(t,s,r,a),s.child;case 14:return r=s.type,n=Qe(r,s.pendingProps),n=Qe(r.type,n),zl(t,s,r,n,a);case 15:return u0(t,s,s.type,s.pendingProps,a);case 17:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Qe(r,n),wr(t,s),s.tag=1,Re(r)?(t=!0,Mr(s)):t=!1,Ls(s,a),l0(s,r,n),Ei(s,r,n,a),Di(null,s,r,!0,t,a);case 19:return g0(t,s,a);case 22:return p0(t,s,a)}throw Error(C(156,s.tag))};function R0(t,s){return nd(t,s)}function vm(t,s,a,r){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ze(t,s,a,r){return new vm(t,s,a,r)}function Uo(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ym(t){if(typeof t=="function")return Uo(t)?1:0;if(t!=null){if(t=t.$$typeof,t===no)return 11;if(t===io)return 14}return 2}function Mt(t,s){var a=t.alternate;return a===null?(a=ze(t.tag,s,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=s,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function Sr(t,s,a,r,n,i){var o=2;if(r=t,typeof t=="function")Uo(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case vs:return ts(a.children,n,i,s);case ro:o=8,n|=8;break;case ai:return t=ze(12,a,s,n|2),t.elementType=ai,t.lanes=i,t;case ri:return t=ze(13,a,s,n),t.elementType=ri,t.lanes=i,t;case ni:return t=ze(19,a,s,n),t.elementType=ni,t.lanes=i,t;case Hc:return cn(a,n,i,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Vc:o=10;break e;case Uc:o=9;break e;case no:o=11;break e;case io:o=14;break e;case Nt:o=16,r=null;break e}throw Error(C(130,t==null?t:typeof t,""))}return s=ze(o,a,s,n),s.elementType=t,s.type=r,s.lanes=i,s}function ts(t,s,a,r){return t=ze(7,t,r,s),t.lanes=a,t}function cn(t,s,a,r){return t=ze(22,t,r,s),t.elementType=Hc,t.lanes=a,t.stateNode={isHidden:!1},t}function Vn(t,s,a){return t=ze(6,t,null,s),t.lanes=a,t}function Un(t,s,a){return s=ze(4,t.children!==null?t.children:[],t.key,s),s.lanes=a,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function bm(t,s,a,r,n){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_n(0),this.expirationTimes=_n(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_n(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Ho(t,s,a,r,n,i,o,l,c){return t=new bm(t,s,a,l,c),s===1?(s=1,i===!0&&(s|=8)):s=0,i=ze(3,null,null,s),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},So(i),t}function _m(t,s,a){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fs,key:r==null?null:""+r,children:t,containerInfo:s,implementation:a}}function E0(t){if(!t)return Gt;t=t._reactInternals;e:{if(cs(t)!==t||t.tag!==1)throw Error(C(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Re(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(C(171))}if(t.tag===1){var a=t.type;if(Re(a))return Ed(t,a,s)}return s}function L0(t,s,a,r,n,i,o,l,c){return t=Ho(a,r,!0,t,n,i,o,l,c),t.context=E0(null),a=t.current,r=Se(),n=Dt(a),i=gt(r,n),i.callback=s??null,Lt(a,i,n),t.current.lanes=n,Ga(t,n,r),Ee(t,r),t}function dn(t,s,a,r){var n=s.current,i=Se(),o=Dt(n);return a=E0(a),s.context===null?s.context=a:s.pendingContext=a,s=gt(i,o),s.payload={element:t},r=r===void 0?null:r,r!==null&&(s.callback=r),t=Lt(n,s,o),t!==null&&(et(t,n,o,i),yr(t,n,o)),o}function Qr(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sc(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<s?a:s}}function Wo(t,s){sc(t,s),(t=t.alternate)&&sc(t,s)}function wm(){return null}var O0=typeof reportError=="function"?reportError:function(t){console.error(t)};function zo(t){this._internalRoot=t}un.prototype.render=zo.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(C(409));dn(t,s,null,null)};un.prototype.unmount=zo.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;is(function(){dn(null,t,null,null)}),s[vt]=null}};function un(t){this._internalRoot=t}un.prototype.unstable_scheduleHydration=function(t){if(t){var s=pd();t={blockedOn:null,target:t,priority:s};for(var a=0;a<kt.length&&s!==0&&s<kt[a].priority;a++);kt.splice(a,0,t),a===0&&hd(t)}};function $o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pn(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ac(){}function jm(t,s,a,r,n){if(n){if(typeof r=="function"){var i=r;r=function(){var d=Qr(o);i.call(d)}}var o=L0(s,r,t,0,null,!1,!1,"",ac);return t._reactRootContainer=o,t[vt]=o.current,Ta(t.nodeType===8?t.parentNode:t),is(),o}for(;n=t.lastChild;)t.removeChild(n);if(typeof r=="function"){var l=r;r=function(){var d=Qr(c);l.call(d)}}var c=Ho(t,0,!1,null,null,!1,!1,"",ac);return t._reactRootContainer=c,t[vt]=c.current,Ta(t.nodeType===8?t.parentNode:t),is(function(){dn(s,c,a,r)}),c}function mn(t,s,a,r,n){var i=a._reactRootContainer;if(i){var o=i;if(typeof n=="function"){var l=n;n=function(){var c=Qr(o);l.call(c)}}dn(s,o,t,n)}else o=jm(a,s,t,n,r);return Qr(o)}dd=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var a=oa(s.pendingLanes);a!==0&&(co(s,a|1),Ee(s,oe()),!($&6)&&(Hs=oe()+500,Ht()))}break;case 13:is(function(){var r=yt(t,1);if(r!==null){var n=Se();et(r,t,1,n)}}),Wo(t,1)}};uo=function(t){if(t.tag===13){var s=yt(t,134217728);if(s!==null){var a=Se();et(s,t,134217728,a)}Wo(t,134217728)}};ud=function(t){if(t.tag===13){var s=Dt(t),a=yt(t,s);if(a!==null){var r=Se();et(a,t,s,r)}Wo(t,s)}};pd=function(){return q};md=function(t,s){var a=q;try{return q=t,s()}finally{q=a}};xi=function(t,s,a){switch(s){case"input":if(li(t,a),s=a.name,a.type==="radio"&&s!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<a.length;s++){var r=a[s];if(r!==t&&r.form===t.form){var n=sn(r);if(!n)throw Error(C(90));zc(r),li(r,n)}}}break;case"textarea":Bc(t,a);break;case"select":s=a.value,s!=null&&Ps(t,!!a.multiple,s,!1)}};Jc=Fo;ed=is;var Nm={usingClientEntryPoint:!1,Events:[Ua,ws,sn,Yc,Xc,Fo]},ea={findFiberByHostInstance:Qt,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sm={bundleType:ea.bundleType,version:ea.version,rendererPackageName:ea.rendererPackageName,rendererConfig:ea.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_t.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ad(t),t===null?null:t.stateNode},findFiberByHostInstance:ea.findFiberByHostInstance||wm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var or=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!or.isDisabled&&or.supportsFiber)try{Xr=or.inject(Sm),ot=or}catch{}}Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nm;Fe.createPortal=function(t,s){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$o(s))throw Error(C(200));return _m(t,s,null,a)};Fe.createRoot=function(t,s){if(!$o(t))throw Error(C(299));var a=!1,r="",n=O0;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(r=s.identifierPrefix),s.onRecoverableError!==void 0&&(n=s.onRecoverableError)),s=Ho(t,1,!1,null,null,a,!1,r,n),t[vt]=s.current,Ta(t.nodeType===8?t.parentNode:t),new zo(s)};Fe.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(C(188)):(t=Object.keys(t).join(","),Error(C(268,t)));return t=ad(s),t=t===null?null:t.stateNode,t};Fe.flushSync=function(t){return is(t)};Fe.hydrate=function(t,s,a){if(!pn(s))throw Error(C(200));return mn(null,t,s,!0,a)};Fe.hydrateRoot=function(t,s,a){if(!$o(t))throw Error(C(405));var r=a!=null&&a.hydratedSources||null,n=!1,i="",o=O0;if(a!=null&&(a.unstable_strictMode===!0&&(n=!0),a.identifierPrefix!==void 0&&(i=a.identifierPrefix),a.onRecoverableError!==void 0&&(o=a.onRecoverableError)),s=L0(s,null,t,1,a??null,n,!1,i,o),t[vt]=s.current,Ta(t),r)for(t=0;t<r.length;t++)a=r[t],n=a._getVersion,n=n(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,n]:s.mutableSourceEagerHydrationData.push(a,n);return new un(s)};Fe.render=function(t,s,a){if(!pn(s))throw Error(C(200));return mn(null,t,s,!1,a)};Fe.unmountComponentAtNode=function(t){if(!pn(t))throw Error(C(40));return t._reactRootContainer?(is(function(){mn(null,null,t,!1,function(){t._reactRootContainer=null,t[vt]=null})}),!0):!1};Fe.unstable_batchedUpdates=Fo;Fe.unstable_renderSubtreeIntoContainer=function(t,s,a,r){if(!pn(a))throw Error(C(200));if(t==null||t._reactInternals===void 0)throw Error(C(38));return mn(t,s,a,!1,r)};Fe.version="18.3.1-next-f1338f8080-20240426";function D0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(D0)}catch(t){console.error(t)}}D0(),Dc.exports=Fe;var km=Dc.exports,rc=km;ti.createRoot=rc.createRoot,ti.hydrateRoot=rc.hydrateRoot;const Cm={none:"",sm:"p-3",md:"p-4",lg:"p-6"},Am={default:"bg-slate-800 border border-slate-700",gradient:"bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700",bordered:"bg-slate-800/50 backdrop-blur-sm border border-slate-700"},y=({children:t,className:s="",variant:a="default",padding:r="lg",hover:n=!1,onClick:i})=>{const o="rounded-xl transition-all",l=n?"hover:border-slate-600 hover:scale-[1.02]":"",c=i?"cursor-pointer":"";return e.jsx("div",{className:`${o} ${Am[a]} ${Cm[r]} ${l} ${c} ${s}`,onClick:i,children:t})},B=({title:t,subtitle:s,action:a})=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white",children:t}),s&&e.jsx("p",{className:"text-sm text-slate-400",children:s})]}),a]}),Tm={success:"bg-emerald-500/20 text-emerald-400",error:"bg-red-500/20 text-red-400",warning:"bg-amber-500/20 text-amber-400",info:"bg-blue-500/20 text-blue-400",default:"bg-slate-500/20 text-slate-400"},Pm={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"},F=({children:t,variant:s="default",size:a="md",className:r="",pill:n=!0})=>{const i=n?"rounded-full":"rounded";return e.jsx("span",{className:`inline-flex items-center font-medium ${i} ${Tm[s]} ${Pm[a]} ${r}`,children:t})},Im=({change:t,trend:s})=>{const a=s==="up"?"success":s==="down"?"error":"default";return e.jsx(F,{variant:a,size:"sm",children:t})},Rm={primary:"bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:from-cyan-600 hover:to-blue-700 shadow-lg shadow-cyan-500/25",secondary:"bg-slate-700 text-white hover:bg-slate-600 border border-slate-600",ghost:"text-slate-400 hover:text-white hover:bg-slate-700",danger:"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30"},Em={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},D=({children:t,variant:s="primary",size:a="md",fullWidth:r=!1,isLoading:n=!1,leftIcon:i,rightIcon:o,className:l="",disabled:c,...d})=>{const h="inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-slate-900",u=r?"w-full":"",x=c||n?"opacity-50 cursor-not-allowed":"";return e.jsxs("button",{className:`${h} ${Rm[s]} ${Em[a]} ${u} ${x} ${l}`,disabled:c||n,...d,children:[n?e.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):i,t,o]})},Lm={sm:"h-1",md:"h-2",lg:"h-3"},ca=({value:t,max:s=100,color:a="bg-cyan-500",label:r,showValue:n=!1,size:i="md",className:o=""})=>{const l=Math.min(100,Math.max(0,t/s*100));return e.jsxs("div",{className:o,children:[(r||n)&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r&&e.jsx("span",{className:"text-white font-medium",children:r}),n&&e.jsxs("span",{className:"text-slate-400",children:[l.toFixed(0),"%"]})]}),e.jsx("div",{className:`${Lm[i]} bg-slate-700 rounded-full overflow-hidden`,children:e.jsx("div",{className:`h-full ${a} rounded-full transition-all duration-500`,style:{width:`${l}%`}})})]})},Om=({label:t,value:s,color:a})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white font-medium",children:t}),e.jsxs("span",{className:"text-slate-400",children:[s,"%"]})]}),e.jsx(ca,{value:s,color:a,size:"md"})]}),Dm=[{id:"dashboard",label:"Dashboard",icon:"dashboard"},{id:"opsvalue",label:"Ops Value Dashboard",icon:"opsvalue"},{id:"compliance",label:"Compliance",icon:"compliance"},{id:"monitoring",label:"Real-Time Monitoring",icon:"monitoring"},{id:"dependencymap",label:"Dependency Map",icon:"topology"},{id:"incidents",label:"Incident Correlation",icon:"incidents"},{id:"cloudmanagement",label:"Cloud Management",icon:"cloud"},{id:"multicloudvisibility",label:"Multi-Cloud Visibility",icon:"multicloud"},{id:"pathanalysis",label:"Path Analysis (Classic)",icon:"path"},{id:"pathanalysisenhanced",label:"Path Analysis (Graph)",icon:"path"},{id:"routeintelligence",label:"Route Intelligence",icon:"route"},{id:"l1whitelisting",label:"L1 Whitelisting",icon:"whitelist"},{id:"tickets",label:"Create Ticket",icon:"ticket"},{id:"statusboard",label:"Ticket Status",icon:"kanban"},{id:"rulegenerator",label:"Rule Generator",icon:"code"},{id:"validation",label:"Validation",icon:"validation"},{id:"conflicts",label:"Conflict Detection",icon:"conflicts"},{id:"settings",label:"Settings",icon:"settings"}],nc={dashboard:{title:"Executive Dashboard",subtitle:"High-level overview of security posture and operations"},compliance:{title:"Compliance Dashboard",subtitle:"Framework compliance scores and violation tracking"},monitoring:{title:"Real-Time Monitoring",subtitle:"Live metrics across AWS, Azure, GCP & On-Premises infrastructure"},dependencymap:{title:"Application Dependency Map",subtitle:"Real-time service topology with health scores and latency monitoring"},incidents:{title:"Incident Correlation",subtitle:"AI-powered root cause analysis across multi-cloud infrastructure"},cloudmanagement:{title:"Multi-Cloud Management",subtitle:"Unified view of AWS, Azure & GCP security controls"},pathanalysis:{title:"Network Path Analysis",subtitle:"Trace traffic flow through security controls and routing components"},pathanalysisenhanced:{title:"Traffic Path Analysis (Graph View)",subtitle:"Graph-based visualization with blocked hop, asymmetric routing, and missing rule detection"},routeintelligence:{title:"Route Intelligence",subtitle:"AI-powered anomaly detection for network routing issues"},tickets:{title:"Create Policy Change Request",subtitle:"ServiceNow Integration - Automated Risk Assessment"},statusboard:{title:"Ticket Status Board",subtitle:"Track policy change requests through approval workflow"},rulegenerator:{title:"Multi-Cloud Rule Generator",subtitle:"Generate platform-specific firewall rules from unified policy"},validation:{title:"Rule Validation Dashboard",subtitle:"Syntax, Conflict Detection & Compliance Validation"},conflicts:{title:"Conflict Detection Engine",subtitle:"Identify Allow/Deny conflicts, Shadowing & Redundancy issues"},l1whitelisting:{title:"L1 Firewall Whitelisting",subtitle:"AI-powered ServiceNow ticket processing with automatic implementation"},multicloudvisibility:{title:"Multi-Cloud Visibility",subtitle:"Unified view of network infrastructure across AWS, Azure, GCP, OCI, and On-Premises"},opsvalue:{title:"Ops Value Dashboard",subtitle:"Metrics for management: Ticket TAT, Automation Rate, Change Success, Compliance & ROI"},settings:{title:"Settings & Configuration",subtitle:"Manage cloud connections, integrations, users, and system preferences"}},ic="dashboard",da={score:{excellent:{stroke:"#10b981"},good:{stroke:"#06b6d4"},warning:{stroke:"#f59e0b"},critical:{stroke:"#ef4444"}},alert:{critical:{bg:"bg-red-500/10",border:"border-red-500/30",borderLeft:"border-l-red-500",hover:"hover:bg-red-500/20"},warning:{bg:"bg-amber-500/10",border:"border-amber-500/30",borderLeft:"border-l-amber-500",hover:"hover:bg-amber-500/20"},info:{bg:"bg-blue-500/10",border:"border-blue-500/30",borderLeft:"border-l-blue-500",hover:"hover:bg-blue-500/20"}}},Mm={arcRatio:.75},oc={name:"Atlas AIOps",tagline:"Multi-Cloud Manager"},Bo={REAL_TIME:2e3,ALERTS:5e3,METRICS:1e3},M0={MAX_ALERTS:15,TRAFFIC_GRAPH_POINTS:60},lr={activeConnections:{min:30,max:70},ingress:{min:10,max:40},egress:{min:8,max:35},firewallCpu:{min:50,max:85}},lc={WARNING:60,CRITICAL:75},Fm={sm:{width:80,radius:30,strokeWidth:6},md:{width:128,radius:45,strokeWidth:10},lg:{width:160,radius:55,strokeWidth:12}},Gm=t=>{switch(t){case"critical":return{stroke:da.score.critical.stroke,bg:"from-red-500/20 to-red-600/10",text:"text-red-400",dot:"bg-red-500 animate-pulse"};case"warning":return{stroke:da.score.warning.stroke,bg:"from-amber-500/20 to-amber-600/10",text:"text-amber-400",dot:"bg-amber-500 animate-pulse"};case"good":return{stroke:da.score.excellent.stroke,bg:"from-emerald-500/20 to-emerald-600/10",text:"text-emerald-400",dot:"bg-emerald-500"};default:return{stroke:da.score.good.stroke,bg:"from-cyan-500/20 to-cyan-600/10",text:"text-cyan-400",dot:"bg-cyan-500"}}},Vm=t=>{switch(t){case"critical":return"Critical";case"warning":return"Warning";case"good":case"normal":return"Normal";default:return"Unknown"}},cr=({value:t,label:s,sublabel:a,status:r,icon:n,size:i="md",animated:o=!0})=>{const[l,c]=v.useState(0);v.useEffect(()=>{if(o){const b=setTimeout(()=>c(t),100);return()=>clearTimeout(b)}else c(t)},[t,o]);const d=Fm[i],h=2*Math.PI*d.radius,u=Mm.arcRatio,x=h-l/100*h*u,_=Gm(r);return e.jsxs("div",{className:`bg-gradient-to-br ${_.bg} backdrop-blur-sm rounded-2xl p-6 border border-white/10 hover:border-white/20 transition-all`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold text-lg",children:s}),a&&e.jsx("p",{className:"text-slate-400 text-sm",children:a})]}),n&&e.jsx("div",{className:"text-2xl",children:n})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"transform -rotate-135",width:d.width,height:d.width,children:[e.jsx("circle",{cx:d.width/2,cy:d.width/2,r:d.radius,fill:"none",stroke:"rgba(255,255,255,0.1)",strokeWidth:d.strokeWidth,strokeDasharray:h,strokeDashoffset:h*(1-u),strokeLinecap:"round"}),e.jsx("circle",{cx:d.width/2,cy:d.width/2,r:d.radius,fill:"none",stroke:_.stroke,strokeWidth:d.strokeWidth,strokeDasharray:h,strokeDashoffset:x,strokeLinecap:"round",className:"transition-all duration-1000 ease-out",style:{filter:`drop-shadow(0 0 8px ${_.stroke})`}})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-3xl font-bold text-white",children:Math.round(l)}),e.jsx("span",{className:"text-lg text-slate-400",children:"%"})]})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${_.dot}`}),e.jsx("span",{className:`text-sm font-medium ${_.text}`,children:Vm(r)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Current"}),e.jsxs("span",{className:"text-white font-mono",children:[Math.round(l),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Max"}),e.jsx("span",{className:"text-white font-mono",children:"100%"})]})]})]})]})]})},Um={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},cc={success:"bg-emerald-500",error:"bg-red-500",warning:"bg-amber-500",info:"bg-blue-500",default:"bg-slate-500",operational:"bg-emerald-500",degraded:"bg-amber-500",down:"bg-red-500",critical:"bg-red-500"},Zo=({status:t,size:s="md",pulse:a=!1,className:r=""})=>{const n=cc[t]||cc.default,i=a||t==="critical"||t==="degraded"?"animate-pulse":"";return e.jsx("div",{className:`rounded-full ${Um[s]} ${n} ${i} ${r}`})},Hm=({label:t="LIVE",className:s=""})=>e.jsxs("div",{className:`flex items-center gap-2 ${s}`,children:[e.jsx(Zo,{status:"success",size:"md",pulse:!0}),e.jsx("span",{className:"text-emerald-400 font-medium",children:t})]}),Wm=({name:t,status:s,latency:a,icon:r})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:r}),e.jsx("span",{className:"text-white text-sm",children:t})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-slate-400 text-xs font-mono",children:a}),e.jsx(Zo,{status:s,pulse:s!=="operational"})]})]}),F0=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),zm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),G0=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),$m=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Bm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Zm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),qm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),Km=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),Qm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),Ym=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),Xm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Jm=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),eh=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),th=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),sh=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),ah=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),rh=({className:t="w-5 h-5"})=>e.jsxs("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),nh=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),V0=({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),ih=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),oh=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),lh=({className:t="w-6 h-6"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),ch={dashboard:F0,compliance:zm,monitoring:G0,topology:$m,incidents:Bm,cloud:Zm,multicloud:sh,path:qm,route:Km,ticket:Qm,kanban:Ym,whitelist:Xm,code:Jm,validation:eh,conflicts:th,opsvalue:ah,settings:rh},dh=({name:t,className:s})=>{const a=ch[t]||F0;return e.jsx(a,{className:s})},uh=({value:t,onChange:s,placeholder:a="Search...",className:r=""})=>e.jsxs("div",{className:`relative ${r}`,children:[e.jsx("input",{type:"text",value:t,onChange:n=>s==null?void 0:s(n.target.value),placeholder:a,className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),e.jsx(nh,{className:"w-5 h-5 text-slate-400 absolute left-3 top-2.5"})]}),ph=({time:t,label:s="Current Time (UTC)",format:a="24h",className:r=""})=>{const n=t.toLocaleTimeString("en-US",{hour12:a==="12h"});return e.jsxs("div",{className:`bg-slate-800 rounded-xl px-6 py-3 border border-slate-700 ${r}`,children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:s}),e.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:n})]})},mh=({time:t,label:s="Current Time (UTC)",format:a="24h",className:r=""})=>{const n=t.toLocaleTimeString("en-US",{hour12:a==="12h"});return e.jsxs("div",{className:`bg-slate-800/50 backdrop-blur-sm rounded-xl px-6 py-3 border border-slate-700 ${r}`,children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:s}),e.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:n})]})},hh=({label:t,value:s,change:a,trend:r="stable",icon:n,className:i=""})=>e.jsxs(y,{hover:!0,className:i,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n&&e.jsx("span",{className:"text-3xl",children:n}),a&&e.jsx(Im,{change:a,trend:r})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s}),e.jsx("div",{className:"text-sm text-slate-400",children:t})]}),xh=({label:t,value:s,unit:a="",icon:r,trend:n,colorClass:i="from-cyan-500/20 to-cyan-600/10"})=>{const o=l=>l.includes("")?"text-emerald-400":l.includes("")?"text-red-400":"text-slate-400";return e.jsxs("div",{className:`bg-gradient-to-br ${i} backdrop-blur-sm rounded-xl p-3 border border-white/10`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-slate-400 text-xs",children:t}),e.jsx("span",{className:"text-lg",children:r})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-xl font-bold text-white",children:s}),e.jsx("span",{className:"text-slate-400 text-xs",children:a})]}),n&&e.jsx("div",{className:`text-xs mt-1 ${o(n)}`,children:n})]})},Hn=({label:t,value:s,valueColor:a="text-white"})=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${a}`,children:s}),e.jsx("div",{className:"text-xs text-slate-400",children:t})]}),dr=({label:t,error:s,className:a="",...r})=>e.jsxs("div",{children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),e.jsx("input",{className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
          focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed
          ${s?"border-red-500":""} ${a}`,...r}),s&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s})]}),gh=({label:t,error:s,className:a="",children:r,...n})=>e.jsxs("div",{children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),e.jsx("select",{className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
          focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed
          ${s?"border-red-500":""} ${a}`,...n,children:r}),s&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s})]}),fh=({isOpen:t,onClose:s,title:a,children:r,size:n="md"})=>{if(!t)return null;const i={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:s}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl w-full ${i[n]}`,onClick:o=>o.stopPropagation(),children:[a&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r]})})]})},vh=({menuItems:t,activeView:s,collapsed:a,onViewChange:r,onToggleCollapse:n})=>e.jsxs("aside",{className:`${a?"w-20":"w-64"} bg-slate-800 border-r border-slate-700 flex flex-col transition-all duration-300`,children:[e.jsx(yh,{collapsed:a}),e.jsx(bh,{menuItems:t,activeView:s,collapsed:a,onViewChange:r}),e.jsx(wh,{collapsed:a,onToggleCollapse:n})]}),yh=({collapsed:t})=>e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(lh,{className:"w-6 h-6 text-white"})}),!t&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-white",children:oc.name}),e.jsx("p",{className:"text-xs text-slate-400",children:oc.tagline})]})]})}),bh=({menuItems:t,activeView:s,collapsed:a,onViewChange:r})=>e.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:e.jsx("ul",{className:"space-y-2",children:t.map(n=>e.jsx(_h,{item:n,isActive:s===n.id,collapsed:a,onClick:()=>r(n.id)},n.id))})}),_h=({item:t,isActive:s,collapsed:a,onClick:r})=>e.jsx("li",{children:e.jsxs("button",{onClick:r,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${s?"bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-lg shadow-cyan-500/25":"text-slate-400 hover:bg-slate-700 hover:text-white"}`,title:a?t.label:void 0,"aria-current":s?"page":void 0,children:[e.jsx(dh,{name:t.icon}),!a&&e.jsx("span",{className:"font-medium",children:t.label})]})}),wh=({collapsed:t,onToggleCollapse:s})=>e.jsx("div",{className:"p-4 border-t border-slate-700",children:e.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":t?"Expand sidebar":"Collapse sidebar",children:[e.jsx(ih,{className:`w-5 h-5 transition-transform ${t?"rotate-180":""}`}),!t&&e.jsx("span",{className:"text-sm",children:"Collapse"})]})}),jh=({viewInfo:t,notifications:s,onNotificationClick:a})=>e.jsx("header",{className:"bg-slate-800 border-b border-slate-700 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Nh,{title:t.title,subtitle:t.subtitle}),e.jsx(Sh,{notifications:s,onNotificationClick:a})]})}),Nh=({title:t,subtitle:s})=>e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t}),e.jsx("p",{className:"text-sm text-slate-400",children:s})]}),Sh=({notifications:t,onNotificationClick:s})=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(uh,{className:"w-64"}),e.jsx(kh,{count:t,onClick:s}),e.jsx(Ch,{})]}),kh=({count:t,onClick:s})=>e.jsxs("button",{onClick:s,className:"relative p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":`Notifications (${t} unread)`,children:[e.jsx(V0,{className:"w-6 h-6"}),t>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:t})]}),Ch=()=>e.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-slate-700",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"Admin User"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Security Team"})]}),e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:"AU"})]}),Ah=({children:t,menuItems:s,activeView:a,viewInfo:r,sidebarCollapsed:n,notifications:i,onViewChange:o,onToggleSidebar:l,onNotificationClick:c})=>e.jsxs("div",{className:"min-h-screen bg-slate-900 flex",children:[e.jsx(vh,{menuItems:s,activeView:a,collapsed:n,onViewChange:o,onToggleCollapse:l}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[e.jsx(jh,{viewInfo:r,notifications:i,onNotificationClick:c}),e.jsx("div",{className:"flex-1 overflow-auto bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:t})]})]}),ee=({children:t,className:s=""})=>e.jsx("div",{className:`p-6 ${s}`,children:t}),Th={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6"},Ph={sm:"gap-3",md:"gap-4",lg:"gap-6"},U0=({children:t,cols:s=4,gap:a="lg",className:r=""})=>e.jsx("div",{className:`grid ${Th[s]} ${Ph[a]} ${r}`,children:t});function H0(t={}){const{refreshInterval:s=Bo.METRICS}=t,[a,r]=v.useState(new Date);return v.useEffect(()=>{const n=setInterval(()=>{r(new Date)},s);return()=>clearInterval(n)},[s]),a}function Ih(t=!1){const[s,a]=v.useState(t),r=v.useCallback(()=>{a(i=>!i)},[]),n=v.useCallback(i=>{a(i)},[]);return[s,r,n]}function Rh(t=ic){const[s,a]=v.useState(t),r=v.useMemo(()=>nc[s]||nc[ic],[s]),n=v.useCallback(i=>{a(i)},[]);return{activeView:s,viewInfo:r,setActiveView:n}}const Eh={headers:{"Content-Type":"application/json"},timeout:3e4};class Lh{constructor(s="",a={}){xn(this,"baseUrl");xn(this,"defaultConfig");this.baseUrl=s,this.defaultConfig={...Eh,...a}}async request(s,a={}){const r=`${this.baseUrl}${s}`,n={...a,headers:{...this.defaultConfig.headers,...a.headers}};try{const i=new AbortController,o=a.timeout||this.defaultConfig.timeout,l=setTimeout(()=>i.abort(),o),c=await fetch(r,{...n,signal:i.signal});if(clearTimeout(l),!c.ok){const h=await c.json().catch(()=>({}));throw{status:c.status,message:h.message||c.statusText,code:h.code}}return{data:await c.json(),status:c.status}}catch(i){throw i.name==="AbortError"?{status:408,message:"Request timeout",code:"TIMEOUT"}:i}}async get(s,a){return this.request(s,{method:"GET",...a})}async post(s,a,r){return this.request(s,{method:"POST",body:a?JSON.stringify(a):void 0,...r})}async put(s,a,r){return this.request(s,{method:"PUT",body:a?JSON.stringify(a):void 0,...r})}async patch(s,a,r){return this.request(s,{method:"PATCH",body:a?JSON.stringify(a):void 0,...r})}async delete(s,a){return this.request(s,{method:"DELETE",...a})}}new Lh("/api");const Oh=async()=>[{label:"Active Rules",value:"4,892",change:"+12",trend:"up",icon:"",color:"cyan"},{label:"Security Groups",value:"247",change:"+3",trend:"up",icon:"",color:"purple"},{label:"Transit Gateways",value:"18",change:"0",trend:"stable",icon:"",color:"emerald"},{label:"Open Tickets",value:"23",change:"-5",trend:"down",icon:"",color:"amber"}],Dh=async()=>[{id:1,action:"Rule deployed",target:"sg-web-prod",user:"automation",time:"2 min ago",status:"success"},{id:2,action:"Policy change approved",target:"CHG0012347",user:"j.smith",time:"15 min ago",status:"success"},{id:3,action:"Validation failed",target:"Allow-External-SSH",user:"system",time:"32 min ago",status:"error"},{id:4,action:"Compliance scan completed",target:"PCI-DSS",user:"scanner",time:"1 hour ago",status:"success"},{id:5,action:"Anomaly detected",target:"tgw-prod-east",user:"ai-engine",time:"2 hours ago",status:"warning"}],Mh=async()=>[{name:"AWS",value:65,color:"bg-orange-500"},{name:"Azure",value:25,color:"bg-blue-500"},{name:"GCP",value:10,color:"bg-red-500"}],Fh=async()=>({activeConnections:49,ingress:24,egress:18,firewallCpu:67}),Gh=async()=>[{label:"Blocked Attacks",value:"1,247",unit:"/hr",icon:"",color:"red",trend:" -12%"},{label:"Policy Changes",value:"23",unit:"pending",icon:"",color:"amber",trend:" +5"},{label:"Compliance",value:"98.5",unit:"%",icon:"",color:"emerald",trend:" +0.2%"},{label:"Avg Latency",value:"12",unit:"ms",icon:"",color:"cyan",trend:" -2ms"},{label:"Active Rules",value:"4,892",unit:"",icon:"",color:"purple"},{label:"TGW Attachments",value:"18",unit:"active",icon:"",color:"cyan"}],Vh=async()=>[{name:"AWS",status:"operational",latency:"12ms",icon:""},{name:"Azure",status:"operational",latency:"18ms",icon:""},{name:"GCP",status:"degraded",latency:"45ms",icon:""},{name:"Palo Alto",status:"operational",latency:"3ms",icon:""}],Uh=async()=>({compliance:"98.5%",uptime:"99.9%",avgLatency:"12ms"}),Hh=async()=>({packetDropRate:.05+Math.random()*.1,throughput:{ingress:24.5+Math.random()*5,egress:18.2+Math.random()*3},connections:{active:Math.floor(45e3+Math.random()*1e4),blocked:Math.floor(1200+Math.random()*300)},latency:{avg:12,p95:28,p99:45},firewallHealth:{cpu:Math.floor(55+Math.random()*20),memory:Math.floor(45+Math.random()*15),sessions:Math.floor(30+Math.random()*25)}}),Wh=()=>[{id:1,type:"critical",message:"Firewall CPU exceeded 65% threshold",source:"pa-fw-prod-east",time:new Date(Date.now()-3e4),acknowledged:!1},{id:2,type:"warning",message:"Asymmetric routing detected on db-cluster path",source:"tgw-prod",time:new Date(Date.now()-12e4),acknowledged:!1},{id:3,type:"info",message:"New security group rule deployed successfully",source:"sg-web-prod",time:new Date(Date.now()-3e5),acknowledged:!0},{id:4,type:"warning",message:"High connection rate from 203.0.113.0/24",source:"alb-prod",time:new Date(Date.now()-45e4),acknowledged:!1},{id:5,type:"critical",message:"Black hole route detected for 10.60.0.0/16",source:"rtb-prod-main",time:new Date(Date.now()-6e5),acknowledged:!1},{id:6,type:"info",message:"Compliance scan completed - 98.5% score",source:"atlas-scanner",time:new Date(Date.now()-9e5),acknowledged:!0},{id:7,type:"warning",message:"SSL certificate expires in 14 days",source:"cert-manager",time:new Date(Date.now()-12e5),acknowledged:!1},{id:8,type:"info",message:"Transit Gateway attachment created",source:"tgw-attach-analytics",time:new Date(Date.now()-15e5),acknowledged:!0}],zh=()=>{const t=[{type:"info",message:"Health check passed for web-servers",source:"alb-prod"},{type:"warning",message:"Elevated latency on cross-region traffic",source:"cloud-router-us"},{type:"info",message:"Auto-scaling triggered for app-tier",source:"asg-app-prod"},{type:"warning",message:"Connection pool nearing capacity",source:"rds-primary"}];return t[Math.floor(Math.random()*t.length)]},$h=t=>({id:Date.now(),...t,time:new Date,acknowledged:!1}),Bh=t=>{const s=Math.floor((Date.now()-t.getTime())/1e3);return s<60?`${s}s ago`:s<3600?`${Math.floor(s/60)}m ago`:`${Math.floor(s/3600)}h ago`},Zh=t=>({critical:"",warning:"",info:""})[t]||"",W0=t=>({critical:t.filter(s=>s.type==="critical"&&!s.acknowledged).length,warning:t.filter(s=>s.type==="warning"&&!s.acknowledged).length,info:t.filter(s=>s.type==="info"&&!s.acknowledged).length,unacknowledged:t.filter(s=>!s.acknowledged).length}),at=[{id:"aws-1",provider:"aws",name:"Production AWS",status:"connected",region:"us-east-1",accountId:"123456789012",lastSync:new Date(Date.now()-5*60*1e3).toISOString(),credentials:{type:"access_key",configured:!0}},{id:"azure-1",provider:"azure",name:"Azure Enterprise",status:"connected",region:"eastus",subscriptionId:"sub-abc123-def456",lastSync:new Date(Date.now()-10*60*1e3).toISOString(),credentials:{type:"service_principal",configured:!0}},{id:"gcp-1",provider:"gcp",name:"GCP Analytics",status:"error",region:"us-central1",projectId:"analytics-prod-12345",lastSync:new Date(Date.now()-60*60*1e3).toISOString(),credentials:{type:"service_account",configured:!0}},{id:"onprem-1",provider:"onprem",name:"DC-East Datacenter",status:"connected",datacenterName:"DC-EAST-01",lastSync:new Date(Date.now()-2*60*1e3).toISOString(),credentials:{type:"api_key",configured:!0}}],Wn={instanceUrl:"https://company.service-now.com",username:"api_integration",isConfigured:!0,autoCreateTickets:!0,defaultAssignmentGroup:"Network Operations",defaultPriority:"medium",syncInterval:5},zn={type:"splunk",endpoint:"https://splunk.company.com:8089",isConfigured:!0,forwardAlerts:!0,forwardLogs:!1,alertSeverityThreshold:"medium"},$n={type:"datadog",apiEndpoint:"https://api.datadoghq.com",isConfigured:!0,collectMetrics:!0,collectTraces:!0,sampleRate:.1},ct=[{id:"user-1",email:"admin@company.com",name:"System Administrator",role:"admin",status:"active",lastLogin:new Date(Date.now()-30*60*1e3).toISOString(),createdAt:"2024-01-15T10:00:00Z",permissions:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!0,canModifySettings:!0,canViewAuditLogs:!0,canManageUsers:!0,canExportData:!0}},{id:"user-2",email:"operator@company.com",name:"Network Operator",role:"operator",status:"active",lastLogin:new Date(Date.now()-2*60*60*1e3).toISOString(),createdAt:"2024-02-20T14:30:00Z",permissions:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!0}},{id:"user-3",email:"viewer@company.com",name:"Security Viewer",role:"viewer",status:"active",lastLogin:new Date(Date.now()-24*60*60*1e3).toISOString(),createdAt:"2024-03-10T09:15:00Z",permissions:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!1}},{id:"user-4",email:"auditor@company.com",name:"Compliance Auditor",role:"auditor",status:"active",lastLogin:new Date(Date.now()-48*60*60*1e3).toISOString(),createdAt:"2024-03-25T11:00:00Z",permissions:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!0,canManageUsers:!1,canExportData:!0}}],Bn={channels:[{id:"email-1",type:"email",name:"Operations Team",isEnabled:!0,config:{recipients:"ops@company.com"}},{id:"slack-1",type:"slack",name:"#network-alerts",isEnabled:!0,config:{channel:"#network-alerts",webhook:"https://hooks.slack.com/..."}},{id:"pagerduty-1",type:"pagerduty",name:"Critical Alerts",isEnabled:!0,config:{serviceKey:"pd-service-key",severity:"critical"}},{id:"teams-1",type:"teams",name:"Security Team",isEnabled:!1,config:{webhook:"https://outlook.office.com/webhook/..."}}],alertThreshold:"warning",quietHours:{enabled:!0,start:"22:00",end:"07:00",timezone:"America/New_York"},digest:{enabled:!0,frequency:"daily"}},Zn=[{id:"log-1",timestamp:new Date(Date.now()-5*60*1e3).toISOString(),user:"admin@company.com",action:"UPDATE_SETTINGS",resource:"ServiceNow Configuration",details:"Updated sync interval from 10 to 5 minutes",ipAddress:"10.0.1.50",status:"success"},{id:"log-2",timestamp:new Date(Date.now()-30*60*1e3).toISOString(),user:"operator@company.com",action:"CREATE_RULE",resource:"Firewall Rule",details:"Created rule: Allow HTTPS from DMZ to Production",ipAddress:"10.0.1.51",status:"success"},{id:"log-3",timestamp:new Date(Date.now()-60*60*1e3).toISOString(),user:"admin@company.com",action:"TEST_CONNECTION",resource:"GCP Analytics",details:"Connection test failed: Invalid credentials",ipAddress:"10.0.1.50",status:"failure"},{id:"log-4",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),user:"admin@company.com",action:"ADD_USER",resource:"User Management",details:"Added new user: viewer@company.com with role: viewer",ipAddress:"10.0.1.50",status:"success"},{id:"log-5",timestamp:new Date(Date.now()-3*60*60*1e3).toISOString(),user:"operator@company.com",action:"APPROVE_TICKET",resource:"Ticket CHG0012345",details:"Approved policy change request for web server access",ipAddress:"10.0.1.51",status:"success"},{id:"log-6",timestamp:new Date(Date.now()-4*60*60*1e3).toISOString(),user:"auditor@company.com",action:"EXPORT_REPORT",resource:"Compliance Report",details:"Exported PCI-DSS compliance report for Q4 2024",ipAddress:"10.0.1.55",status:"success"},{id:"log-7",timestamp:new Date(Date.now()-5*60*60*1e3).toISOString(),user:"admin@company.com",action:"UPDATE_PERMISSIONS",resource:"User Management",details:"Updated permissions for operator@company.com",ipAddress:"10.0.1.50",status:"success"},{id:"log-8",timestamp:new Date(Date.now()-24*60*60*1e3).toISOString(),user:"system",action:"SYNC_CLOUD",resource:"AWS Production",details:"Automatic sync completed: 847 resources discovered",ipAddress:"127.0.0.1",status:"success"}],xe=t=>new Promise(s=>setTimeout(s,t)),Ae={async getSettings(){return await xe(500),{cloudConnections:at,serviceNow:Wn,siem:zn,apm:$n,users:ct,notifications:Bn}},async getCloudConnections(){return await xe(300),at},async testCloudConnection(t){await xe(2e3);const s=at.find(a=>a.id===t);return s?s.status==="error"?{success:!1,message:"Authentication failed. Please verify credentials."}:{success:!0,message:"Connection successful. All services accessible."}:{success:!1,message:"Connection not found"}},async updateCloudConnection(t,s){await xe(500);const a=at.findIndex(r=>r.id===t);if(a===-1)throw new Error("Connection not found");return at[a]={...at[a],...s},at[a]},async addCloudConnection(t){await xe(500);const s={...t,id:`${t.provider}-${Date.now()}`};return at.push(s),s},async deleteCloudConnection(t){await xe(300);const s=at.findIndex(a=>a.id===t);s!==-1&&at.splice(s,1)},async updateServiceNowConfig(t){return await xe(500),Object.assign(Wn,t),Wn},async testServiceNowConnection(){return await xe(1500),{success:!0,message:"ServiceNow connection verified successfully."}},async updateSIEMConfig(t){return await xe(500),Object.assign(zn,t),zn},async updateAPMConfig(t){return await xe(500),Object.assign($n,t),$n},async getUsers(){return await xe(300),ct},async addUser(t){await xe(500);const s={...t,id:`user-${Date.now()}`,createdAt:new Date().toISOString()};return ct.push(s),s},async updateUser(t,s){await xe(500);const a=ct.findIndex(r=>r.id===t);if(a===-1)throw new Error("User not found");return ct[a]={...ct[a],...s},ct[a]},async deleteUser(t){await xe(300);const s=ct.findIndex(a=>a.id===t);s!==-1&&ct.splice(s,1)},async updateNotificationPreferences(t){return await xe(500),Object.assign(Bn,t),Bn},async getAuditLogs(t){await xe(400);let s=[...Zn];return t!=null&&t.user&&(s=s.filter(a=>a.user.toLowerCase().includes(t.user.toLowerCase()))),t!=null&&t.action&&(s=s.filter(a=>a.action===t.action)),t!=null&&t.startDate&&(s=s.filter(a=>new Date(a.timestamp)>=new Date(t.startDate))),t!=null&&t.endDate&&(s=s.filter(a=>new Date(a.timestamp)<=new Date(t.endDate))),s.sort((a,r)=>new Date(r.timestamp).getTime()-new Date(a.timestamp).getTime())},async exportAuditLogs(t){if(await xe(1e3),t==="json")return JSON.stringify(Zn,null,2);const s=["Timestamp","User","Action","Resource","Details","IP Address","Status"],a=Zn.map(r=>[r.timestamp,r.user,r.action,r.resource,r.details,r.ipAddress,r.status]);return[s.join(","),...a.map(r=>r.join(","))].join(`
`)}},os=t=>!t||t==="*"||t==="any"||t==="0.0.0.0/0"?"0.0.0.0/0":!t.includes("/")&&!t.includes("-")?`${t}/32`:t,qh=t=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:i,action:o,direction:l,description:c}=t,d=os(a),h=os(r);if(o==="deny")return`# AWS Security Groups do not support explicit deny rules
# Consider using Network ACLs for deny rules
# aws ec2 create-network-acl-entry --network-acl-id <acl-id> \\
#   --rule-number 100 --protocol ${i==="any"?"-1":i} \\
#   --port-range From=${n},To=${n} --cidr-block ${d} \\
#   --rule-action deny --${l==="inbound"?"ingress":"egress"}`;const u=i==="icmp"?"":`--port ${n}`,x=l==="inbound"||l==="both",_=[];return x&&_.push(`# ${s} - ${c||"Inbound rule"}
aws ec2 authorize-security-group-ingress \\
  --group-id <security-group-id> \\
  --protocol ${i==="any"?"-1":i} ${u} \\
  --cidr ${d} \\
  --tag-specifications 'ResourceType=security-group-rule,Tags=[{Key=Name,Value=${s}}]'`),(l==="outbound"||l==="both")&&_.push(`# ${s} - ${c||"Outbound rule"}
aws ec2 authorize-security-group-egress \\
  --group-id <security-group-id> \\
  --protocol ${i==="any"?"-1":i} ${u} \\
  --cidr ${h}`),_.join(`

`)},Kh=t=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:i,action:o,direction:l,priority:c=100,description:d}=t,h=a==="*"||!a?"*":os(a),u=r==="*"||!r?"*":os(r);return`# ${s} - ${d||"Azure NSG Rule"}
az network nsg rule create \\
  --resource-group <resource-group-name> \\
  --nsg-name <nsg-name> \\
  --name "${s.replace(/\s+/g,"-")}" \\
  --priority ${c} \\
  --direction ${l==="inbound"?"Inbound":"Outbound"} \\
  --access ${o==="allow"?"Allow":"Deny"} \\
  --protocol ${i==="any"?"*":i.charAt(0).toUpperCase()+i.slice(1)} \\
  --source-address-prefixes "${h}" \\
  --source-port-ranges "*" \\
  --destination-address-prefixes "${u}" \\
  --destination-port-ranges "${n||"*"}"`},Qh=t=>{const{name:s,sourceIp:a,port:r,protocol:n,action:i,direction:o,priority:l=1e3,description:c}=t,d=s.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),h=os(a),u=n==="icmp"?"":r?` --rules ${n}:${r}`:` --rules ${n}`;return i==="deny"?`# ${s} - ${c||"GCP Deny Rule"}
gcloud compute firewall-rules create ${d} \\
  --project=<project-id> \\
  --network=<vpc-network> \\
  --priority=${l} \\
  --direction=${o==="inbound"?"INGRESS":"EGRESS"} \\
  --action=DENY \\
  --source-ranges="${h}"${u} \\
  --description="${c||s}"`:`# ${s} - ${c||"GCP Allow Rule"}
gcloud compute firewall-rules create ${d} \\
  --project=<project-id> \\
  --network=<vpc-network> \\
  --priority=${l} \\
  --direction=${o==="inbound"?"INGRESS":"EGRESS"} \\
  --action=ALLOW \\
  --source-ranges="${h}"${u} \\
  --target-tags=<target-tags> \\
  --description="${c||s}"`},Yh=t=>{const{name:s,sourceIp:a,destinationIp:r,port:n,action:i,description:o}=t,l="untrust",c="trust",d="any",h=n?`tcp-${n}`:"any";return`# ${s} - ${o||"Palo Alto Security Rule"}
set rulebase security rules "${s}" from ${l}
set rulebase security rules "${s}" to ${c}
set rulebase security rules "${s}" source ${a||"any"}
set rulebase security rules "${s}" destination ${r||"any"}
set rulebase security rules "${s}" application ${d}
set rulebase security rules "${s}" service ${h}
set rulebase security rules "${s}" action ${i}
set rulebase security rules "${s}" log-start yes
set rulebase security rules "${s}" log-end yes
set rulebase security rules "${s}" description "${o||s}"`},Xh=t=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:i,action:o,direction:l,description:c}=t,d=l==="inbound"?"outside_access_in":"inside_access_out",h=a!=null&&a.includes("/")?`${a.split("/")[0]} ${dc(a)}`:`host ${a||"any"}`,u=r!=null&&r.includes("/")?`${r.split("/")[0]} ${dc(r)}`:`host ${r||"any"}`,x=n?`eq ${n}`:"";return`! ${s} - ${c||"Cisco ASA Rule"}
access-list ${d} extended ${o==="allow"?"permit":"deny"} ${i} ${h} ${u} ${x}
! Apply to interface (if not already applied)
! access-group ${d} in interface outside`},Jh=t=>{const{name:s,sourceIp:a,destinationIp:r,port:n,action:i,description:o}=t,l=n?`TCP/${n}`:"ALL";return`# ${s} - ${o||"FortiGate Policy"}
config firewall policy
    edit 0
        set name "${s}"
        set srcintf "wan1"
        set dstintf "lan"
        set srcaddr "${a||"all"}"
        set dstaddr "${r||"all"}"
        set action ${i}
        set schedule "always"
        set service "${l}"
        set logtraffic all
        set comments "${o||s}"
    next
end`},ex=t=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:i,action:o,direction:l,description:c}=t,d=l==="inbound"?"INPUT":"OUTPUT",h=o==="allow"?"ACCEPT":"DROP",u=a&&a!=="*"?`-s ${os(a)}`:"",x=r&&r!=="*"?`-d ${os(r)}`:"",_=i!=="any"?`-p ${i}`:"",b=n&&i!=="icmp"&&i!=="any"?`--dport ${n}`:"";return`# ${s} - ${c||"iptables rule"}
iptables -A ${d} ${_} ${u} ${x} ${b} -j ${h} -m comment --comment "${s}"

# For persistent rules, save with:
# iptables-save > /etc/iptables/rules.v4

# Or using nftables equivalent:
# nft add rule inet filter ${d.toLowerCase()} ${i!=="any"?`${i} `:""}${b?`dport ${n} `:""}${u?`ip saddr ${a} `:""}${x?`ip daddr ${r} `:""}${h.toLowerCase()}`};function dc(t){const a=~(2**(32-parseInt(t.split("/")[1]||"32",10))-1);return[a>>>24&255,a>>>16&255,a>>>8&255,a&255].join(".")}const tx=t=>{var a;const s=[];return(a=t.name)!=null&&a.trim()||s.push("Rule name is required"),t.sourceIp&&!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$|^\*$|^any$/.test(t.sourceIp)&&s.push("Invalid source IP format"),t.destinationIp&&!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$|^\*$|^any$/.test(t.destinationIp)&&s.push("Invalid destination IP format"),t.port&&!/^\d+(-\d+)?$/.test(t.port)&&s.push("Invalid port format (use single port or range like 80-443)"),t.port&&t.port.split("-").map(Number).some(n=>n<1||n>65535)&&s.push("Port must be between 1 and 65535"),s},sx=(t,s)=>{const a=[];return s==="aws"&&t.action==="deny"&&a.push("AWS Security Groups do not support deny rules. Consider using Network ACLs."),(!t.sourceIp||t.sourceIp==="*"||t.sourceIp==="0.0.0.0/0")&&a.push("Source IP is open to all (0.0.0.0/0). This may pose security risks."),t.port==="22"&&t.action==="allow"&&(!t.sourceIp||t.sourceIp==="0.0.0.0/0")&&a.push("SSH (port 22) is open to the internet. Restrict source IPs for security."),t.port==="3389"&&t.action==="allow"&&(!t.sourceIp||t.sourceIp==="0.0.0.0/0")&&a.push("RDP (port 3389) is open to the internet. Restrict source IPs for security."),a},ax={aws:qh,azure:Kh,gcp:Qh,palo_alto:Yh,cisco_asa:Xh,fortinet:Jh,iptables:ex},qn=t=>new Promise(s=>setTimeout(s,t)),uc={async generateRules(t,s){await qn(500);const a=tx(t);return s.map(r=>{const n=sx(t,r),i=ax[r];if(a.length>0)return{platform:r,syntax:"",isValid:!1,validationErrors:a,warnings:n};try{const o=i(t);return{platform:r,syntax:o,isValid:!0,warnings:n}}catch(o){return{platform:r,syntax:"",isValid:!1,validationErrors:[`Failed to generate rule: ${o instanceof Error?o.message:"Unknown error"}`],warnings:n}}})},async getTemplates(){return await qn(300),rx},async validateSyntax(t,s){return await qn(200),s.trim()?{isValid:!0,errors:[]}:{isValid:!1,errors:["Empty rule syntax"]}}},rx=[{id:"web-server-http",name:"Web Server HTTP",description:"Allow HTTP traffic (port 80) to web servers",category:"web",input:{name:"Allow-HTTP-Inbound",description:"Allow HTTP traffic from any source",sourceIp:"0.0.0.0/0",destinationIp:"",port:"80",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"web-server-https",name:"Web Server HTTPS",description:"Allow HTTPS traffic (port 443) to web servers",category:"web",input:{name:"Allow-HTTPS-Inbound",description:"Allow HTTPS traffic from any source",sourceIp:"0.0.0.0/0",destinationIp:"",port:"443",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"ssh-management",name:"SSH Management",description:"Allow SSH access from management network",category:"management",input:{name:"Allow-SSH-Management",description:"Allow SSH from management subnet",sourceIp:"10.0.0.0/8",destinationIp:"",port:"22",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"database-mysql",name:"MySQL Database",description:"Allow MySQL connections from application tier",category:"database",input:{name:"Allow-MySQL-AppTier",description:"Allow MySQL from application servers",sourceIp:"10.1.0.0/16",destinationIp:"",port:"3306",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"database-postgres",name:"PostgreSQL Database",description:"Allow PostgreSQL connections from application tier",category:"database",input:{name:"Allow-PostgreSQL-AppTier",description:"Allow PostgreSQL from application servers",sourceIp:"10.1.0.0/16",destinationIp:"",port:"5432",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"rdp-management",name:"RDP Management",description:"Allow RDP access from management network",category:"management",input:{name:"Allow-RDP-Management",description:"Allow RDP from management subnet",sourceIp:"10.0.0.0/8",destinationIp:"",port:"3389",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"deny-all-inbound",name:"Deny All Inbound",description:"Default deny rule for all inbound traffic",category:"security",input:{name:"Deny-All-Inbound",description:"Block all inbound traffic by default",sourceIp:"0.0.0.0/0",destinationIp:"",port:"",protocol:"any",action:"deny",direction:"inbound"},platforms:["azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"icmp-ping",name:"Allow ICMP Ping",description:"Allow ICMP echo requests for ping",category:"management",input:{name:"Allow-ICMP-Ping",description:"Allow ICMP for network diagnostics",sourceIp:"10.0.0.0/8",destinationIp:"",port:"",protocol:"icmp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]}],nx=[{sg_id:"sg-0f1e2d3c4b5a6001",name:"sg-webapp-prod",vpc:"vpc-prod-us-east-1",description:"Production web application tier"},{sg_id:"sg-0f1e2d3c4b5a6002",name:"sg-database-prod",vpc:"vpc-prod-us-east-1",description:"Production database tier"},{sg_id:"sg-0f1e2d3c4b5a6003",name:"sg-redis-prod",vpc:"vpc-prod-us-east-1",description:"Production Redis cache cluster"},{sg_id:"sg-0f1e2d3c4b5a6004",name:"sg-api-gateway",vpc:"vpc-prod-us-east-1",description:"API Gateway services"},{sg_id:"sg-0f1e2d3c4b5a6005",name:"sg-microservices",vpc:"vpc-prod-us-east-1",description:"Microservices tier"},{sg_id:"sg-0f1e2d3c4b5a6006",name:"sg-kafka-prod",vpc:"vpc-prod-us-east-1",description:"Kafka message broker cluster"},{sg_id:"sg-0f1e2d3c4b5a6007",name:"sg-analytics-prod",vpc:"vpc-prod-us-east-1",description:"Analytics and data science workloads"},{sg_id:"sg-0f1e2d3c4b5a6008",name:"sg-bastion",vpc:"vpc-prod-us-east-1",description:"Bastion host for SSH access"},{sg_id:"sg-0f1e2d3c4b5a6009",name:"sg-alb-public",vpc:"vpc-prod-us-east-1",description:"Public Application Load Balancer"},{sg_id:"sg-0f1e2d3c4b5a6010",name:"sg-alb-internal",vpc:"vpc-prod-us-east-1",description:"Internal Application Load Balancer"},{sg_id:"sg-0f1e2d3c4b5a6011",name:"sg-monitoring",vpc:"vpc-prod-us-east-1",description:"Monitoring stack (Prometheus/Grafana)"},{sg_id:"sg-0f1e2d3c4b5a6012",name:"sg-eks-nodes",vpc:"vpc-prod-us-east-1",description:"EKS worker nodes"},{sg_id:"sg-0f1e2d3c4b5a6013",name:"sg-eks-control",vpc:"vpc-prod-us-east-1",description:"EKS control plane"},{sg_id:"sg-0f1e2d3c4b5a6014",name:"sg-jenkins",vpc:"vpc-devops-us-east-1",description:"Jenkins CI/CD server"},{sg_id:"sg-0f1e2d3c4b5a6015",name:"sg-splunk",vpc:"vpc-prod-us-east-1",description:"Splunk SIEM cluster"},{sg_id:"sg-0f1e2d3c4b5a6016",name:"sg-vault",vpc:"vpc-prod-us-east-1",description:"HashiCorp Vault cluster"},{sg_id:"sg-0f1e2d3c4b5a6017",name:"sg-elasticsearch",vpc:"vpc-prod-us-east-1",description:"Elasticsearch cluster"},{sg_id:"sg-0f1e2d3c4b5a6018",name:"sg-payment",vpc:"vpc-pci-us-east-1",description:"Payment processing (PCI-DSS)"},{sg_id:"sg-0f1e2d3c4b5a6019",name:"sg-recommendation",vpc:"vpc-prod-us-east-1",description:"ML recommendation engine"},{sg_id:"sg-0f1e2d3c4b5a6020",name:"sg-nat-gateway",vpc:"vpc-prod-us-east-1",description:"NAT Gateway security group"}],ix=[{rule_id:"sgr-0a1b2c3d4e5f0001",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS from Internet via ALB"},{rule_id:"sgr-0a1b2c3d4e5f0002",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"80",source:"0.0.0.0/0",description:"HTTP redirect to HTTPS"},{rule_id:"sgr-0a1b2c3d4e5f0003",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"10.100.0.0/16",description:"SSH from VPN CIDR"},{rule_id:"sgr-0a1b2c3d4e5f0004",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-alb-public",description:"Application port from ALB"},{rule_id:"sgr-0a1b2c3d4e5f0005",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"PostgreSQL to database tier"},{rule_id:"sgr-0a1b2c3d4e5f0006",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache access"},{rule_id:"sgr-0a1b2c3d4e5f0007",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS to external APIs"},{rule_id:"sgr-0a1b2c3d4e5f0008",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka message publishing"},{rule_id:"sgr-0a1b2c3d4e5f0009",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Node exporter metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0010",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Microservices API calls"},{rule_id:"sgr-0a1b2c3d4e5f0011",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-webapp-prod",description:"PostgreSQL from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0012",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-api-gateway",description:"PostgreSQL from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0013",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-microservices",description:"PostgreSQL from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0014",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-analytics-prod",description:"PostgreSQL from analytics"},{rule_id:"sgr-0a1b2c3d4e5f0015",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"10.100.0.0/16",description:"PostgreSQL from VPN for DBA access"},{rule_id:"sgr-0a1b2c3d4e5f0016",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"sg-bastion",description:"SSH from bastion host"},{rule_id:"sgr-0a1b2c3d4e5f0017",security_group:"sg-database-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for backups via prefix list"},{rule_id:"sgr-0a1b2c3d4e5f0018",security_group:"sg-database-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"10.120.0.0/16",description:"Replication to DR region"},{rule_id:"sgr-0a1b2c3d4e5f0019",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Node exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0020",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"9187",source:"sg-monitoring",description:"PostgreSQL exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0021",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-webapp-prod",description:"Redis from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0022",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-api-gateway",description:"Redis from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0023",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-microservices",description:"Redis from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0024",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-recommendation",description:"Redis from recommendation engine"},{rule_id:"sgr-0a1b2c3d4e5f0025",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"16379",source:"sg-redis-prod",description:"Redis cluster bus port"},{rule_id:"sgr-0a1b2c3d4e5f0026",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"26379",source:"sg-redis-prod",description:"Redis Sentinel port"},{rule_id:"sgr-0a1b2c3d4e5f0027",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"9121",source:"sg-monitoring",description:"Redis exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0028",security_group:"sg-redis-prod",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cluster replication"},{rule_id:"sgr-0a1b2c3d4e5f0029",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-alb-public",description:"HTTPS from public ALB"},{rule_id:"sgr-0a1b2c3d4e5f0030",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-alb-internal",description:"HTTPS from internal ALB"},{rule_id:"sgr-0a1b2c3d4e5f0031",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"8443",source:"10.100.0.0/16",description:"API access from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0032",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Route to microservices"},{rule_id:"sgr-0a1b2c3d4e5f0033",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database queries"},{rule_id:"sgr-0a1b2c3d4e5f0034",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache"},{rule_id:"sgr-0a1b2c3d4e5f0035",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka event publishing"},{rule_id:"sgr-0a1b2c3d4e5f0036",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Prometheus metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0037",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-api-gateway",description:"API gateway requests"},{rule_id:"sgr-0a1b2c3d4e5f0038",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Inter-service communication"},{rule_id:"sgr-0a1b2c3d4e5f0039",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"Web tier service calls"},{rule_id:"sgr-0a1b2c3d4e5f0040",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database access"},{rule_id:"sgr-0a1b2c3d4e5f0041",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache access"},{rule_id:"sgr-0a1b2c3d4e5f0042",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka messaging"},{rule_id:"sgr-0a1b2c3d4e5f0043",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"External HTTPS APIs"},{rule_id:"sgr-0a1b2c3d4e5f0044",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"9200",source:"sg-elasticsearch",description:"Elasticsearch logging"},{rule_id:"sgr-0a1b2c3d4e5f0045",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"8200",source:"sg-vault",description:"Vault secrets retrieval"},{rule_id:"sgr-0a1b2c3d4e5f0046",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Prometheus metrics"},{rule_id:"sgr-0a1b2c3d4e5f0047",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-webapp-prod",description:"Kafka from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0048",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-api-gateway",description:"Kafka from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0049",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-microservices",description:"Kafka from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0050",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-analytics-prod",description:"Kafka from analytics"},{rule_id:"sgr-0a1b2c3d4e5f0051",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9093",source:"sg-kafka-prod",description:"Kafka inter-broker SSL"},{rule_id:"sgr-0a1b2c3d4e5f0052",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"2181",source:"sg-kafka-prod",description:"Zookeeper client port"},{rule_id:"sgr-0a1b2c3d4e5f0053",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"2888",source:"sg-kafka-prod",description:"Zookeeper peer port"},{rule_id:"sgr-0a1b2c3d4e5f0054",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"3888",source:"sg-kafka-prod",description:"Zookeeper leader election"},{rule_id:"sgr-0a1b2c3d4e5f0055",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9999",source:"sg-monitoring",description:"JMX metrics for Kafka"},{rule_id:"sgr-0a1b2c3d4e5f0056",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"8888",source:"10.100.0.0/16",description:"Jupyter notebook from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0057",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"4040",source:"10.100.0.0/16",description:"Spark UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0058",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"sg-bastion",description:"SSH from bastion"},{rule_id:"sgr-0a1b2c3d4e5f0059",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database queries"},{rule_id:"sgr-0a1b2c3d4e5f0060",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka streaming"},{rule_id:"sgr-0a1b2c3d4e5f0061",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 data lake access"},{rule_id:"sgr-0a1b2c3d4e5f0062",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"External ML APIs"},{rule_id:"sgr-0a1b2c3d4e5f0063",security_group:"sg-bastion",type:"Inbound",protocol:"TCP",port_range:"22",source:"10.100.0.0/16",description:"SSH from VPN only"},{rule_id:"sgr-0a1b2c3d4e5f0064",security_group:"sg-bastion",type:"Outbound",protocol:"TCP",port_range:"22",source:"10.0.0.0/8",description:"SSH to all internal hosts"},{rule_id:"sgr-0a1b2c3d4e5f0065",security_group:"sg-bastion",type:"Outbound",protocol:"TCP",port_range:"3389",source:"10.0.0.0/8",description:"RDP to Windows hosts"},{rule_id:"sgr-0a1b2c3d4e5f0066",security_group:"sg-alb-public",type:"Inbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS from Internet"},{rule_id:"sgr-0a1b2c3d4e5f0067",security_group:"sg-alb-public",type:"Inbound",protocol:"TCP",port_range:"80",source:"0.0.0.0/0",description:"HTTP redirect"},{rule_id:"sgr-0a1b2c3d4e5f0068",security_group:"sg-alb-public",type:"Outbound",protocol:"TCP",port_range:"443",source:"sg-api-gateway",description:"To API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0069",security_group:"sg-alb-public",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"To web application"},{rule_id:"sgr-0a1b2c3d4e5f0070",security_group:"sg-alb-internal",type:"Inbound",protocol:"TCP",port_range:"443",source:"10.0.0.0/8",description:"HTTPS from internal"},{rule_id:"sgr-0a1b2c3d4e5f0071",security_group:"sg-alb-internal",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"To microservices"},{rule_id:"sgr-0a1b2c3d4e5f0072",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"9090",source:"10.100.0.0/16",description:"Prometheus UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0073",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"3000",source:"10.100.0.0/16",description:"Grafana from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0074",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"9093",source:"10.100.0.0/16",description:"Alertmanager from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0075",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"9100",source:"10.0.0.0/8",description:"Node exporter scrape all"},{rule_id:"sgr-0a1b2c3d4e5f0076",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"9090",source:"10.0.0.0/8",description:"Application metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0077",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"PagerDuty/Slack alerts"},{rule_id:"sgr-0a1b2c3d4e5f0078",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-eks-control",description:"Kubelet API from control plane"},{rule_id:"sgr-0a1b2c3d4e5f0079",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"10250",source:"sg-eks-control",description:"Kubelet from control plane"},{rule_id:"sgr-0a1b2c3d4e5f0080",security_group:"sg-eks-nodes",type:"Inbound",protocol:"ALL",port_range:"ALL",source:"sg-eks-nodes",description:"Node to node all traffic"},{rule_id:"sgr-0a1b2c3d4e5f0081",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"30000-32767",source:"sg-alb-internal",description:"NodePort services from ALB"},{rule_id:"sgr-0a1b2c3d4e5f0082",security_group:"sg-eks-nodes",type:"Outbound",protocol:"ALL",port_range:"ALL",source:"0.0.0.0/0",description:"All outbound for pods"},{rule_id:"sgr-0a1b2c3d4e5f0083",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"10.100.0.0/16",description:"Kubernetes API from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0084",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-eks-nodes",description:"Kubernetes API from nodes"},{rule_id:"sgr-0a1b2c3d4e5f0085",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-jenkins",description:"Kubernetes API from CI/CD"},{rule_id:"sgr-0a1b2c3d4e5f0086",security_group:"sg-jenkins",type:"Inbound",protocol:"TCP",port_range:"8080",source:"10.100.0.0/16",description:"Jenkins UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0087",security_group:"sg-jenkins",type:"Inbound",protocol:"TCP",port_range:"50000",source:"10.80.0.0/16",description:"Jenkins agent connection"},{rule_id:"sgr-0a1b2c3d4e5f0088",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"22",source:"10.0.0.0/8",description:"SSH to build agents"},{rule_id:"sgr-0a1b2c3d4e5f0089",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"Git and registry access"},{rule_id:"sgr-0a1b2c3d4e5f0090",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"443",source:"sg-eks-control",description:"Kubernetes deployment"},{rule_id:"sgr-0a1b2c3d4e5f0091",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"9997",source:"10.0.0.0/8",description:"Log forwarding from all"},{rule_id:"sgr-0a1b2c3d4e5f0092",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"8000",source:"10.100.0.0/16",description:"Splunk Web from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0093",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"8089",source:"10.90.0.0/16",description:"Splunk API from monitoring"},{rule_id:"sgr-0a1b2c3d4e5f0094",security_group:"sg-splunk",type:"Inbound",protocol:"UDP",port_range:"514",source:"10.0.0.0/8",description:"Syslog UDP from all"},{rule_id:"sgr-0a1b2c3d4e5f0095",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"514",source:"10.0.0.0/8",description:"Syslog TCP from all"},{rule_id:"sgr-0a1b2c3d4e5f0096",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.30.0.0/16",description:"Vault API from applications"},{rule_id:"sgr-0a1b2c3d4e5f0097",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.80.0.0/16",description:"Vault API from CI/CD"},{rule_id:"sgr-0a1b2c3d4e5f0098",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.100.0.0/16",description:"Vault UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0099",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8201",source:"sg-vault",description:"Vault cluster port"},{rule_id:"sgr-0a1b2c3d4e5f0100",security_group:"sg-vault",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-68a54001",description:"DynamoDB for storage backend"},{rule_id:"sgr-0a1b2c3d4e5f0101",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"sg-microservices",description:"ES API from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0102",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"sg-splunk",description:"ES API from Splunk"},{rule_id:"sgr-0a1b2c3d4e5f0103",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"10.100.0.0/16",description:"Kibana from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0104",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9300",source:"sg-elasticsearch",description:"ES cluster transport"},{rule_id:"sgr-0a1b2c3d4e5f0105",security_group:"sg-elasticsearch",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for snapshots"},{rule_id:"sgr-0a1b2c3d4e5f0106",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"8443",source:"sg-api-gateway",description:"Payment API from gateway"},{rule_id:"sgr-0a1b2c3d4e5f0107",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"443",source:"203.0.113.0/24",description:"Stripe webhooks"},{rule_id:"sgr-0a1b2c3d4e5f0108",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"443",source:"199.16.156.0/24",description:"PayPal webhooks"},{rule_id:"sgr-0a1b2c3d4e5f0109",security_group:"sg-payment",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"Payment provider APIs"},{rule_id:"sgr-0a1b2c3d4e5f0110",security_group:"sg-payment",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Transaction database"},{rule_id:"sgr-0a1b2c3d4e5f0111",security_group:"sg-recommendation",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-api-gateway",description:"ML API from gateway"},{rule_id:"sgr-0a1b2c3d4e5f0112",security_group:"sg-recommendation",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"ML API from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0113",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"User profiles database"},{rule_id:"sgr-0a1b2c3d4e5f0114",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Feature caching"},{rule_id:"sgr-0a1b2c3d4e5f0115",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for model artifacts"},{rule_id:"sgr-0a1b2c3d4e5f0116",security_group:"sg-nat-gateway",type:"Inbound",protocol:"ALL",port_range:"ALL",source:"10.0.0.0/8",description:"NAT from private subnets"},{rule_id:"sgr-0a1b2c3d4e5f0117",security_group:"sg-nat-gateway",type:"Outbound",protocol:"ALL",port_range:"ALL",source:"0.0.0.0/0",description:"NAT to Internet"},{rule_id:"sgr-0a1b2c3d4e5f0118",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"9997",source:"sg-splunk",description:"Log forwarding to Splunk"},{rule_id:"sgr-0a1b2c3d4e5f0119",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-recommendation",description:"PostgreSQL from recommendation"},{rule_id:"sgr-0a1b2c3d4e5f0120",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-payment",description:"PostgreSQL from payment service"}],ba={security_groups:nx,rules:ix},ox=[{nsg_id:"nsg-webapp-prod",name:"nsg-webapp-prod",resource_group:"rg-production-eastus",location:"eastus",description:"Production web application NSG"},{nsg_id:"nsg-database-prod",name:"nsg-database-prod",resource_group:"rg-production-eastus",location:"eastus",description:"Production database NSG"},{nsg_id:"nsg-api-prod",name:"nsg-api-prod",resource_group:"rg-production-eastus",location:"eastus",description:"API tier NSG"},{nsg_id:"nsg-aks-nodes",name:"nsg-aks-nodes",resource_group:"rg-aks-eastus",location:"eastus",description:"AKS worker nodes NSG"},{nsg_id:"nsg-management",name:"nsg-management",resource_group:"rg-management",location:"eastus",description:"Management subnet NSG"},{nsg_id:"nsg-dmz",name:"nsg-dmz",resource_group:"rg-production-eastus",location:"eastus",description:"DMZ subnet NSG"}],lx=[{rule_name:"Allow-HTTPS-Internet-Inbound",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"443"},{rule_name:"Allow-HTTP-Redirect-Inbound",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"80"},{rule_name:"Allow-AppGW-to-WebApp",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"GatewaySubnet",destination_asg:"asg-webapp",port:"8080"},{rule_name:"Allow-WebApp-to-API",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-api",port:"8080"},{rule_name:"Allow-API-Internal-Comm",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-api",port:"8080"},{rule_name:"Allow-WebApp-to-SQL",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-API-to-SQL",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-Analytics-to-SQL",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-Jenkins-to-SQL",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-jenkins",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-VPN-to-SQL",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-WebApp-to-Redis",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-redis",port:"6379"},{rule_name:"Allow-API-to-Redis",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-redis",port:"6379"},{rule_name:"Allow-Redis-Cluster-Internal",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"16379"},{rule_name:"Allow-Redis-Sentinel",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"26379"},{rule_name:"Allow-WebApp-to-Kafka",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-API-to-Kafka",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-Analytics-to-Kafka",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-Kafka-Inter-Broker",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"9093"},{rule_name:"Allow-Kafka-Zookeeper",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"2181"},{rule_name:"Allow-Kafka-ZK-Peer",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"2888"},{rule_name:"Allow-Prometheus-Scrape-All",priority:200,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"*",port:"9090"},{rule_name:"Allow-NodeExporter-Scrape",priority:210,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"*",port:"9100"},{rule_name:"Allow-Grafana-VPN",priority:220,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"3000"},{rule_name:"Allow-Prometheus-VPN",priority:230,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"9090"},{rule_name:"Allow-Alertmanager-VPN",priority:240,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"9093"},{rule_name:"Allow-AKS-NodePort-Range",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-appgw",destination_asg:"asg-aks-nodes",port:"30000-32767"},{rule_name:"Allow-AKS-Kubelet",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureKubernetes",destination_asg:"asg-aks-nodes",port:"10250"},{rule_name:"Allow-AKS-DNS",priority:120,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"asg-aks-nodes",destination_asg:"asg-aks-nodes",port:"53"},{rule_name:"Allow-AKS-Node-Internal",priority:130,direction:"Inbound",access:"Allow",protocol:"*",source_asg:"asg-aks-nodes",destination_asg:"asg-aks-nodes",port:"*"},{rule_name:"Allow-AKS-Metrics",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"asg-aks-nodes",port:"10255"},{rule_name:"Allow-Bastion-SSH-All",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureBastionSubnet",destination_asg:"*",port:"22"},{rule_name:"Allow-Bastion-RDP-All",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureBastionSubnet",destination_asg:"*",port:"3389"},{rule_name:"Allow-VPN-SSH",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"*",port:"22"},{rule_name:"Allow-Jenkins-VPN",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-jenkins",port:"8080"},{rule_name:"Allow-Jenkins-Agent",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.80.0.0/16",destination_asg:"asg-jenkins",port:"50000"},{rule_name:"Allow-ES-from-API",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-elasticsearch",port:"9200"},{rule_name:"Allow-ES-from-WebApp",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-elasticsearch",port:"9200"},{rule_name:"Allow-ES-Cluster-Transport",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-elasticsearch",destination_asg:"asg-elasticsearch",port:"9300"},{rule_name:"Allow-Kibana-VPN",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-elasticsearch",port:"5601"},{rule_name:"Allow-CosmosDB-Access",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"AzureCosmosDB",port:"443"},{rule_name:"Allow-Storage-Access",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"Storage",port:"443"},{rule_name:"Allow-KeyVault-Access",priority:120,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureKeyVault",port:"443"},{rule_name:"Allow-EventHub-Access",priority:130,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"EventHub",port:"5671"},{rule_name:"Allow-ServiceBus-Access",priority:140,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"ServiceBus",port:"5671"},{rule_name:"Allow-AzureMonitor-Outbound",priority:150,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureMonitor",port:"443"},{rule_name:"Allow-AzureAD-Outbound",priority:160,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureActiveDirectory",port:"443"},{rule_name:"Allow-ACR-Outbound",priority:170,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-aks-nodes",destination_asg:"AzureContainerRegistry",port:"443"},{rule_name:"Deny-Internet-DB-Outbound",priority:4e3,direction:"Outbound",access:"Deny",protocol:"*",source_asg:"asg-database",destination_asg:"Internet",port:"*"},{rule_name:"Allow-LB-Health-Probe",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureLoadBalancer",destination_asg:"*",port:"*"},{rule_name:"Allow-FrontDoor-to-AppGW",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureFrontDoor.Backend",destination_asg:"asg-appgw",port:"443"},{rule_name:"Allow-VNet-Internal",priority:65e3,direction:"Inbound",access:"Allow",protocol:"*",source_asg:"VirtualNetwork",destination_asg:"VirtualNetwork",port:"*"},{rule_name:"Allow-PostgreSQL-Flexible",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"5432"},{rule_name:"Allow-MySQL-Flexible",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"3306"},{rule_name:"Allow-Synapse-Analytics",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"Sql",port:"1433"},{rule_name:"Allow-DataFactory-Integration",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"DataFactory",port:"443"},{rule_name:"Deny-All-Inbound-Default",priority:65500,direction:"Inbound",access:"Deny",protocol:"*",source_asg:"*",destination_asg:"*",port:"*"},{rule_name:"Allow-Analytics-Jupyter",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-analytics",port:"8888"},{rule_name:"Allow-Analytics-Spark-UI",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-analytics",port:"4040"},{rule_name:"Allow-Analytics-to-Storage",priority:120,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"Storage.EastUS",port:"443"},{rule_name:"Allow-WebApp-HTTPS-Out",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"Internet",port:"443"},{rule_name:"Allow-API-HTTPS-Out",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"Internet",port:"443"},{rule_name:"Allow-NTP-Outbound",priority:200,direction:"Outbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"*",port:"123"},{rule_name:"Allow-DNS-Outbound",priority:210,direction:"Outbound",access:"Allow",protocol:"*",source_asg:"*",destination_asg:"*",port:"53"},{rule_name:"Allow-SMTP-Outbound",priority:300,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"*",port:"587"},{rule_name:"Allow-SignalR-WebSocket",priority:160,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"443"},{rule_name:"Allow-AppInsights-Outbound",priority:180,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"ApplicationInsightsAvailability",port:"443"},{rule_name:"Allow-Redis-Enterprise-Sync",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"8443"},{rule_name:"Allow-SQL-Managed-Instance",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"11000-11999"},{rule_name:"Allow-SFTP-Partner-Access",priority:170,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"198.51.100.0/24",destination_asg:"asg-webapp",port:"22"},{rule_name:"Allow-VPN-Gateway-IKE",priority:100,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"GatewaySubnet",port:"500"},{rule_name:"Allow-VPN-Gateway-NAT-T",priority:110,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"GatewaySubnet",port:"4500"},{rule_name:"Allow-ExpressRoute-BGP",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"GatewaySubnet",destination_asg:"GatewaySubnet",port:"179"},{rule_name:"Allow-APIM-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"ApiManagement",destination_asg:"asg-api",port:"3443"},{rule_name:"Allow-APIM-Gateway",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-api",port:"443"},{rule_name:"Allow-ServiceFabric-Cluster",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-webapp",port:"19000-19080"},{rule_name:"Allow-AKS-Tunnel-Front",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"9000"},{rule_name:"Allow-AKS-Tunnel-TCP",priority:160,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"1194"},{rule_name:"Allow-AKS-Tunnel-UDP",priority:170,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"1194"},{rule_name:"Allow-HDInsight-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"HDInsight",destination_asg:"asg-analytics",port:"443"},{rule_name:"Allow-Databricks-Control",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureDatabricks",destination_asg:"asg-analytics",port:"443"},{rule_name:"Allow-ML-Studio-Compute",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureMachineLearning",destination_asg:"asg-analytics",port:"44224"},{rule_name:"Allow-Batch-NodeMgmt",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"BatchNodeManagement",destination_asg:"asg-analytics",port:"29876-29877"},{rule_name:"Allow-LogAnalytics-Agent",priority:200,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureMonitor",port:"443"},{rule_name:"Allow-ASE-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AppServiceManagement",destination_asg:"asg-webapp",port:"454-455"},{rule_name:"Allow-ASE-Internal-LB",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-webapp",port:"16001"},{rule_name:"Deny-SQL-Internet-Inbound",priority:4090,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"asg-database",port:"1433"},{rule_name:"Deny-SSH-Internet-Inbound",priority:4091,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"*",port:"22"},{rule_name:"Deny-RDP-Internet-Inbound",priority:4092,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"*",port:"3389"},{rule_name:"Allow-Private-Endpoint-SQL",priority:200,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"PrivateEndpoints",port:"1433"},{rule_name:"Allow-Private-Endpoint-Storage",priority:210,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"PrivateEndpoints",port:"443"},{rule_name:"Allow-Private-Endpoint-KV",priority:220,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"PrivateEndpoints",port:"443"},{rule_name:"Allow-Defender-Communication",priority:190,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureSecurityCenter",port:"443"},{rule_name:"Allow-Update-Management",priority:195,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureUpdateDelivery",port:"443"},{rule_name:"Allow-Guest-Config",priority:196,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"GuestAndHybridManagement",port:"443"},{rule_name:"Allow-ServiceTags-AzureCloud",priority:3900,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureCloud",port:"443"},{rule_name:"Allow-Backup-to-RSV",priority:180,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureBackup",port:"443"},{rule_name:"Allow-ASR-Replication",priority:185,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureSiteRecovery",port:"443"},{rule_name:"Deny-All-Outbound-Default",priority:65500,direction:"Outbound",access:"Deny",protocol:"*",source_asg:"*",destination_asg:"*",port:"*"}],Jt={network_security_groups:ox,rules:lx},cx=[{network_id:"vpc-production",name:"vpc-production",project:"company-prod-12345",description:"Production VPC network"},{network_id:"vpc-staging",name:"vpc-staging",project:"company-staging-12345",description:"Staging VPC network"},{network_id:"vpc-development",name:"vpc-development",project:"company-dev-12345",description:"Development VPC network"},{network_id:"vpc-shared-services",name:"vpc-shared-services",project:"company-shared-12345",description:"Shared services VPC"},{network_id:"vpc-data-analytics",name:"vpc-data-analytics",project:"company-analytics-12345",description:"Data analytics VPC"}],dx=[{rule_name:"allow-https-ingress",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["web-server"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-http-ingress",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["web-server"],protocols:"tcp:80",logging:"Enabled"},{rule_name:"allow-ssh-iap",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:["allow-ssh"],protocols:"tcp:22",logging:"Enabled"},{rule_name:"allow-ssh-vpn",network:"vpc-production",priority:1010,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["allow-ssh"],protocols:"tcp:22",logging:"Enabled"},{rule_name:"allow-rdp-iap",network:"vpc-production",priority:1020,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:["allow-ssh"],protocols:"tcp:3389",logging:"Enabled"},{rule_name:"allow-db-from-app-postgres",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432",logging:"Enabled"},{rule_name:"allow-db-from-app-mysql",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-web",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-analytics",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-vpn",network:"vpc-production",priority:1004,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-redis-from-app",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-redis-from-web",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-redis-cluster-bus",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["redis-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:16379",logging:"Disabled"},{rule_name:"allow-redis-sentinel",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:["redis-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:26379",logging:"Disabled"},{rule_name:"allow-internal-all",network:"vpc-production",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"deny-all-ingress",network:"vpc-production",priority:65535,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-gke-master-to-nodes-https",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["172.16.0.0/28"],target_tags:["gke-node"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-gke-master-to-nodes-kubelet",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["172.16.0.0/28"],target_tags:["gke-node"],protocols:"tcp:10250",logging:"Enabled"},{rule_name:"allow-gke-node-to-node",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"all",logging:"Disabled"},{rule_name:"allow-gke-node-to-pods",network:"vpc-production",priority:1010,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-health-check-tcp",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.191.0.0/16","130.211.0.0/22"],target_tags:["allow-health-check"],protocols:"tcp",logging:"Enabled"},{rule_name:"allow-health-check-ssl",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.191.0.0/16","130.211.0.0/22"],target_tags:["allow-health-check"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-lb-to-backend-http",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:80",logging:"Enabled"},{rule_name:"allow-lb-to-backend-https",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-lb-to-backend-8080",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-kafka-producer",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server","web-server"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9092",logging:"Enabled"},{rule_name:"allow-kafka-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["kafka-broker"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9092,tcp:9093",logging:"Disabled"},{rule_name:"allow-kafka-jmx",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9999",logging:"Disabled"},{rule_name:"allow-zookeeper-client",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["kafka-broker"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:2181",logging:"Enabled"},{rule_name:"allow-zookeeper-peer",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["zookeeper"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:2888",logging:"Disabled"},{rule_name:"allow-zookeeper-election",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["zookeeper"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:3888",logging:"Disabled"},{rule_name:"allow-prometheus-scrape-9090",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:[],protocols:"tcp:9090",logging:"Disabled"},{rule_name:"allow-prometheus-scrape-9100",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:[],protocols:"tcp:9100",logging:"Disabled"},{rule_name:"allow-grafana-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["monitoring"],protocols:"tcp:3000",logging:"Enabled"},{rule_name:"allow-alertmanager-vpn",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["monitoring"],protocols:"tcp:9093",logging:"Enabled"},{rule_name:"allow-elasticsearch-api",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["log-shipper","app-server"],source_ranges:[],target_tags:["elasticsearch"],protocols:"tcp:9200",logging:"Enabled"},{rule_name:"allow-elasticsearch-cluster",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["elasticsearch"],source_ranges:[],target_tags:["elasticsearch"],protocols:"tcp:9300",logging:"Disabled"},{rule_name:"allow-kibana-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["elasticsearch"],protocols:"tcp:5601",logging:"Enabled"},{rule_name:"allow-vault-api",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server","web-server","jenkins"],source_ranges:[],target_tags:["vault-server"],protocols:"tcp:8200",logging:"Enabled"},{rule_name:"allow-vault-cluster",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["vault-server"],source_ranges:[],target_tags:["vault-server"],protocols:"tcp:8201",logging:"Disabled"},{rule_name:"allow-vault-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["vault-server"],protocols:"tcp:8200",logging:"Enabled"},{rule_name:"allow-jenkins-vpn",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["jenkins"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-jenkins-agent",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.80.0.0/16"],target_tags:["jenkins"],protocols:"tcp:50000",logging:"Enabled"},{rule_name:"allow-cloud-sql-proxy",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:3307",logging:"Enabled"},{rule_name:"allow-memorystore-redis",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-pubsub-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["pubsub-client"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-bigquery-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-cloud-storage",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-monitoring-agent",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-analytics-jupyter",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8888",logging:"Enabled"},{rule_name:"allow-analytics-spark",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:4040",logging:"Enabled"},{rule_name:"allow-analytics-airflow",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"deny-egress-internet",network:"vpc-production",priority:65535,direction:"EGRESS",action:"deny",source_tags:[],source_ranges:[],target_tags:["no-internet"],protocols:"all",logging:"Enabled"},{rule_name:"allow-nat-egress",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["needs-nat"],source_ranges:[],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-cloud-functions-vpc",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.8.0.0/28"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-cloud-run-vpc",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.8.0.16/28"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-gke-ingress-nginx",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["gke-node"],protocols:"tcp:80,tcp:443",logging:"Enabled"},{rule_name:"allow-ml-training-gpu",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["ml-training"],protocols:"tcp:6006,tcp:8888",logging:"Enabled"},{rule_name:"allow-ml-training-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["ml-training"],source_ranges:[],target_tags:["ml-training"],protocols:"all",logging:"Disabled"},{rule_name:"allow-dataflow-worker",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:["analytics-server"],protocols:"tcp:12345-12346",logging:"Enabled"},{rule_name:"allow-dataproc-master",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8088,tcp:9870,tcp:8080",logging:"Enabled"},{rule_name:"allow-dataproc-worker",network:"vpc-data-analytics",priority:1001,direction:"INGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:["analytics-server"],protocols:"all",logging:"Disabled"},{rule_name:"allow-composer-airflow",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8080,tcp:3306,tcp:6379",logging:"Enabled"},{rule_name:"allow-bigtable-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-spanner-api",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-firestore-api",network:"vpc-production",priority:1002,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-artifact-registry",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["gke-node","jenkins"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-gcr-io",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["gke-node","jenkins"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-web-to-app",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-app-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-grpc-internal",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:50051",logging:"Enabled"},{rule_name:"allow-envoy-admin",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:15000",logging:"Disabled"},{rule_name:"allow-istio-pilot",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"tcp:15010,tcp:15012",logging:"Enabled"},{rule_name:"allow-istio-telemetry",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"tcp:15014",logging:"Disabled"},{rule_name:"allow-kiali-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["gke-node"],protocols:"tcp:20001",logging:"Enabled"},{rule_name:"allow-jaeger-vpn",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["gke-node"],protocols:"tcp:16686",logging:"Enabled"},{rule_name:"deny-ssh-public",network:"vpc-production",priority:2e3,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:22",logging:"Enabled"},{rule_name:"deny-rdp-public",network:"vpc-production",priority:2001,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:3389",logging:"Enabled"},{rule_name:"deny-mysql-public",network:"vpc-production",priority:2002,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:3306",logging:"Enabled"},{rule_name:"deny-postgres-public",network:"vpc-production",priority:2003,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:5432",logging:"Enabled"},{rule_name:"allow-vpn-tunnel",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["198.51.100.0/24"],target_tags:[],protocols:"udp:500,udp:4500,esp",logging:"Enabled"},{rule_name:"allow-cloud-dns-forwarding",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.199.192.0/19"],target_tags:[],protocols:"tcp:53,udp:53",logging:"Enabled"},{rule_name:"allow-private-google-access",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-iap-forwarding",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:[],protocols:"tcp:22,tcp:3389",logging:"Enabled"},{rule_name:"allow-interconnect-attachment",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-stackdriver-agent",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-secret-manager",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-kms-api",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"staging-allow-https",network:"vpc-staging",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["web-server"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"staging-allow-all-internal",network:"vpc-staging",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"dev-allow-all-vpn",network:"vpc-development",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"dev-allow-all-internal",network:"vpc-development",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"shared-allow-dns",network:"vpc-shared-services",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:53,udp:53",logging:"Enabled"},{rule_name:"shared-allow-ntp",network:"vpc-shared-services",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"udp:123",logging:"Disabled"},{rule_name:"shared-allow-ldap",network:"vpc-shared-services",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:389,tcp:636",logging:"Enabled"},{rule_name:"shared-allow-smtp",network:"vpc-shared-services",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:25,tcp:587",logging:"Enabled"},{rule_name:"allow-vertex-ai-training",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:["ml-training"],protocols:"tcp:2222,tcp:6006",logging:"Enabled"},{rule_name:"allow-vertex-ai-prediction",network:"vpc-data-analytics",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["ml-training"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-notebooks-api",network:"vpc-data-analytics",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"}],Ws={networks:cx,rules:dx},ux=()=>{const t=new Map;ba.security_groups.forEach(a=>t.set(a.name,a));const s=new Map;return ba.rules.forEach(a=>{s.has(a.security_group)||s.set(a.security_group,{inbound:[],outbound:[]});const r=s.get(a.security_group);a.type==="Inbound"?r.inbound.push(a):r.outbound.push(a)}),ba.security_groups.map(a=>{var r,n;return{id:a.sg_id,name:a.name,description:a.description,vpcId:a.vpc,vpcName:a.vpc,provider:"aws",inboundRules:(((r=s.get(a.name))==null?void 0:r.inbound)||[]).map(i=>({id:i.rule_id,protocol:i.protocol.toLowerCase(),portRange:i.port_range,source:i.source,description:i.description})),outboundRules:(((n=s.get(a.name))==null?void 0:n.outbound)||[]).map(i=>({id:i.rule_id,protocol:i.protocol.toLowerCase(),portRange:i.port_range,source:i.source,description:i.description}))}})},px=()=>{const t=new Map;return Jt.rules.forEach(s=>{const a=s.destination_asg||"default";t.has(a)||t.set(a,{inbound:[],outbound:[]});const r=t.get(a);s.direction==="Inbound"?r.inbound.push(s):r.outbound.push(s)}),Jt.network_security_groups.map(s=>({id:s.nsg_id,name:s.name,description:s.description,vpcId:s.resource_group,vpcName:s.resource_group,provider:"azure",inboundRules:Jt.rules.filter(a=>a.direction==="Inbound").slice(0,10).map((a,r)=>({id:`${s.nsg_id}-in-${r}`,protocol:a.protocol.toLowerCase(),portRange:String(a.port),source:a.source_asg,description:a.rule_name})),outboundRules:Jt.rules.filter(a=>a.direction==="Outbound").slice(0,5).map((a,r)=>({id:`${s.nsg_id}-out-${r}`,protocol:a.protocol.toLowerCase(),portRange:String(a.port),source:a.destination_asg,description:a.rule_name}))}))},mx=()=>{const t=new Map;return Ws.rules.forEach(s=>{t.has(s.network)||t.set(s.network,[]),t.get(s.network).push(s)}),Ws.networks.map(s=>{const a=t.get(s.name)||[];return{id:s.network_id,name:s.name,description:s.description,vpcId:s.project,vpcName:s.project,provider:"gcp",inboundRules:a.filter(r=>r.direction==="INGRESS").slice(0,10).map((r,n)=>{var i,o;return{id:`${s.network_id}-in-${n}`,protocol:r.protocols.split(":")[0]||"tcp",portRange:r.protocols.split(":")[1]||"all",source:((i=r.source_ranges)==null?void 0:i.join(", "))||((o=r.source_tags)==null?void 0:o.join(", "))||"any",description:r.rule_name}}),outboundRules:a.filter(r=>r.direction==="EGRESS").slice(0,5).map((r,n)=>{var i;return{id:`${s.network_id}-out-${n}`,protocol:r.protocols.split(":")[0]||"tcp",portRange:r.protocols.split(":")[1]||"all",source:((i=r.target_tags)==null?void 0:i.join(", "))||"any",description:r.rule_name}})}})},Kn={aws:{provider:"aws",vpcCount:5,subnetCount:24,securityGroupCount:ba.security_groups.length,loadBalancerCount:8,transitGatewayCount:2,totalInstances:156,regions:["us-east-1","us-west-2","eu-west-1","ap-southeast-1"],healthScore:94,issueCount:3,lastSync:new Date(Date.now()-5*60*1e3).toISOString()},azure:{provider:"azure",vpcCount:Jt.network_security_groups.length,subnetCount:15,securityGroupCount:Jt.network_security_groups.length,loadBalancerCount:5,transitGatewayCount:1,totalInstances:89,regions:["eastus","westeurope","southeastasia"],healthScore:87,issueCount:5,lastSync:new Date(Date.now()-8*60*1e3).toISOString()},gcp:{provider:"gcp",vpcCount:Ws.networks.length,subnetCount:12,securityGroupCount:Ws.rules.length,loadBalancerCount:4,transitGatewayCount:0,totalInstances:67,regions:["us-central1","europe-west1"],healthScore:92,issueCount:2,lastSync:new Date(Date.now()-3*60*1e3).toISOString()}},Qn={aws:[{id:"vpc-prod-us-east-1",name:"Production VPC US-East-1",cidrBlock:"10.0.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:8,securityGroupCount:ba.security_groups.filter(t=>t.vpc==="vpc-prod-us-east-1").length||15,instanceCount:45},{id:"vpc-devops-us-east-1",name:"DevOps VPC",cidrBlock:"10.80.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:4,securityGroupCount:8,instanceCount:23},{id:"vpc-pci-us-east-1",name:"PCI-DSS VPC",cidrBlock:"10.90.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:4,securityGroupCount:6,instanceCount:12},{id:"vpc-dmz-01",name:"DMZ VPC",cidrBlock:"172.16.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:2,securityGroupCount:10,instanceCount:8},{id:"vpc-default",name:"Default VPC",cidrBlock:"172.31.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!0,subnetCount:6,securityGroupCount:8,instanceCount:68}],azure:Jt.network_security_groups.map((t,s)=>({id:`vnet-${t.location}-${s}`,name:`${t.resource_group} VNet`,cidrBlock:`10.${10+s}.0.0/16`,region:t.location,provider:"azure",status:"active",isDefault:!1,subnetCount:6,securityGroupCount:12,instanceCount:34})),gcp:Ws.networks.map(t=>({id:t.network_id,name:t.name,cidrBlock:"auto",region:"us-central1",provider:"gcp",status:"active",isDefault:!1,subnetCount:8,securityGroupCount:Ws.rules.filter(s=>s.network===t.name).length,instanceCount:45}))},pc={aws:ux(),azure:px(),gcp:mx()},hx={aws:[{id:"alb-prod-web",name:"prod-web-alb",type:"application",scheme:"internet-facing",state:"active",dnsName:"prod-web-alb-123456.us-east-1.elb.amazonaws.com",vpcId:"vpc-prod-us-east-1",listenerCount:2,targetGroupCount:3,healthyTargets:6,totalTargets:6},{id:"nlb-prod-api",name:"prod-api-nlb",type:"network",scheme:"internal",state:"active",dnsName:"prod-api-nlb-789012.us-east-1.elb.amazonaws.com",vpcId:"vpc-prod-us-east-1",listenerCount:1,targetGroupCount:1,healthyTargets:4,totalTargets:4},{id:"alb-staging",name:"staging-alb",type:"application",scheme:"internet-facing",state:"active",dnsName:"staging-alb-345678.us-west-2.elb.amazonaws.com",vpcId:"vpc-staging-01",listenerCount:1,targetGroupCount:2,healthyTargets:2,totalTargets:2}],azure:[{id:"lb-prod-web",name:"prod-web-lb",type:"application",scheme:"internet-facing",state:"active",dnsName:"prod-web-lb.eastus.cloudapp.azure.com",vpcId:"vnet-prod-01",listenerCount:2,targetGroupCount:2,healthyTargets:4,totalTargets:5},{id:"lb-prod-internal",name:"prod-internal-lb",type:"network",scheme:"internal",state:"active",dnsName:"prod-internal-lb.internal",vpcId:"vnet-prod-01",listenerCount:1,targetGroupCount:1,healthyTargets:3,totalTargets:3}],gcp:[{id:"lb-prod",name:"production-lb",type:"application",scheme:"internet-facing",state:"active",dnsName:"34.120.123.45",vpcId:"vpc-production",listenerCount:1,targetGroupCount:2,healthyTargets:5,totalTargets:5}]},xx={aws:[{id:"tgw-prod",name:"production-tgw",state:"available",routeTables:3,region:"us-east-1",attachments:[{id:"tgw-attach-1",resourceType:"vpc",resourceId:"vpc-prod-us-east-1",resourceName:"Production VPC",state:"available"},{id:"tgw-attach-2",resourceType:"vpc",resourceId:"vpc-devops-us-east-1",resourceName:"DevOps VPC",state:"available"},{id:"tgw-attach-3",resourceType:"vpc",resourceId:"vpc-pci-us-east-1",resourceName:"PCI-DSS VPC",state:"available"},{id:"tgw-attach-4",resourceType:"vpn",resourceId:"vpn-onprem",resourceName:"On-Premises VPN",state:"available"}]},{id:"tgw-dr",name:"disaster-recovery-tgw",state:"available",routeTables:1,region:"us-west-2",attachments:[{id:"tgw-attach-5",resourceType:"vpc",resourceId:"vpc-staging-01",resourceName:"Staging VPC",state:"available"},{id:"tgw-attach-6",resourceType:"peering",resourceId:"tgw-prod",resourceName:"Production TGW Peering",state:"available"}]}],azure:[{id:"vhub-prod",name:"production-virtual-hub",state:"available",routeTables:2,region:"eastus",attachments:[{id:"conn-1",resourceType:"vpc",resourceId:"vnet-eastus-0",resourceName:"Production VNet",state:"available"},{id:"conn-2",resourceType:"vpc",resourceId:"vnet-eastus-1",resourceName:"Development VNet",state:"available"}]}],gcp:[]},rt=t=>new Promise(s=>setTimeout(s,t)),je={async getOverview(t){return await rt(300),Kn[t]},async getAllOverviews(){return await rt(500),Object.values(Kn)},async getVPCs(t){return await rt(400),Qn[t]||[]},async getVPCDetails(t,s){return await rt(200),(Qn[t]||[]).find(r=>r.id===s)||null},async getSubnets(t,s){var i;await rt(300);const a=(i=Qn[t])==null?void 0:i.find(o=>o.id===s);if(!a)return[];const r=[],n=t==="aws"?["a","b","c"]:t==="azure"?["1","2","3"]:["a","b"];for(let o=0;o<a.subnetCount;o++){const l=o<a.subnetCount/2;r.push({id:`${s}-subnet-${o+1}`,name:`${l?"public":"private"}-subnet-${o%3+1}`,vpcId:s,cidrBlock:`10.${o}.0.0/24`,availabilityZone:`${a.region}${n[o%n.length]}`,isPublic:l,availableIps:250-Math.floor(Math.random()*100),instanceCount:Math.floor(a.instanceCount/a.subnetCount)})}return r},async getSecurityGroups(t,s){await rt(400);let a=pc[t]||[];return s&&(a=a.filter(r=>r.vpcId===s)),a},async getSecurityGroupDetails(t,s){return await rt(200),(pc[t]||[]).find(r=>r.id===s)||null},async getLoadBalancers(t){return await rt(400),hx[t]||[]},async getTransitGateways(t){return await rt(400),xx[t]||[]},async syncResources(t){return await rt(2e3),Kn[t].lastSync=new Date().toISOString(),{success:!0,message:`Successfully synced ${t.toUpperCase()} resources`}}},gx={total_validations:110,pass:45,fail:32,warning:23,exception:7,pending_review:3,by_severity:{critical:8,high:18,medium:35,low:29,info:20}},fx=[{validation_id:"VAL-0001",rule_reference:"sgr-0a1b2c3d4e5f0001",rule_name:"Web-HTTPS-Inbound",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"INFO",status:"PASS",expected_value:"Restricted source CIDR or security group",actual_value:"0.0.0.0/0 (Acceptable for public HTTPS)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Public web server - 0.0.0.0/0 is expected for port 443",remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0002",rule_reference:"sgr-legacy-ssh-001",rule_name:"Legacy-SSH-Any-Source",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"CRITICAL",status:"FAIL",expected_value:"Restricted source CIDR (VPN or bastion only)",actual_value:"0.0.0.0/0 to port 22",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict SSH access to VPN CIDR 10.100.0.0/16 or bastion security group sg-bastion",ticket_reference:null},{validation_id:"VAL-0003",rule_reference:"sgr-rdp-any-001",rule_name:"Legacy-RDP-Any-Source",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"CRITICAL",status:"FAIL",expected_value:"Restricted source CIDR (VPN only)",actual_value:"0.0.0.0/0 to port 3389",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict RDP access to VPN CIDR 10.100.0.0/16 or use Azure Bastion/AWS SSM",ticket_reference:null},{validation_id:"VAL-0004",rule_reference:"sgr-0a1b2c3d4e5f0011",rule_name:"Database-PostgreSQL-Access",platform:"AWS",validation_category:"SECURITY",validation_check:"DATABASE_ACCESS_RESTRICTION",check_description:"Validates that database ports are only accessible from application tiers",severity:"LOW",status:"PASS",expected_value:"Source restricted to application security groups",actual_value:"sg-webapp-prod",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012346"},{validation_id:"VAL-0005",rule_reference:"nsg-rule-db-any",rule_name:"Database-Any-Access",platform:"Azure",validation_category:"SECURITY",validation_check:"DATABASE_ACCESS_RESTRICTION",check_description:"Validates that database ports are only accessible from application tiers",severity:"HIGH",status:"FAIL",expected_value:"Source restricted to application ASGs",actual_value:"Source: * (Any)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Change source from '*' to 'asg-webapp' or 'asg-api' application security groups",ticket_reference:null},{validation_id:"VAL-0006",rule_reference:"pa-rule-any-any",rule_name:"Allow-Any-Any-Trust",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_RULE",check_description:"Validates that rules do not allow any-to-any traffic without restrictions",severity:"CRITICAL",status:"FAIL",expected_value:"Specific source, destination, application, and service",actual_value:"Source: any, Dest: any, App: any, Service: any",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace with specific rules for required traffic flows. Remove this overly permissive rule.",ticket_reference:null},{validation_id:"VAL-0007",rule_reference:"sgr-0a1b2c3d4e5f0021",rule_name:"Redis-Cache-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DESCRIPTION_REQUIRED",check_description:"Validates that all rules have meaningful descriptions",severity:"LOW",status:"PASS",expected_value:"Non-empty description explaining rule purpose",actual_value:"Allow Redis access from web tier for session caching",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012347"},{validation_id:"VAL-0008",rule_reference:"sgr-nodesc-001",rule_name:"Unnamed-Rule-8080",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DESCRIPTION_REQUIRED",check_description:"Validates that all rules have meaningful descriptions",severity:"MEDIUM",status:"FAIL",expected_value:"Non-empty description explaining rule purpose",actual_value:"(empty)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add description: 'Allow application traffic from [source] for [purpose]'",ticket_reference:null},{validation_id:"VAL-0009",rule_reference:"gcp-allow-all-egress",rule_name:"default-allow-all-egress",platform:"GCP",validation_category:"SECURITY",validation_check:"UNRESTRICTED_EGRESS",check_description:"Validates that egress rules are restricted to required destinations",severity:"HIGH",status:"WARNING",expected_value:"Egress restricted to specific destinations or services",actual_value:"0.0.0.0/0 for all protocols",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Consider restricting egress to specific destinations. Implement egress filtering for sensitive workloads.",ticket_reference:null},{validation_id:"VAL-0010",rule_reference:"nsg-webapp-prod-100",rule_name:"Allow-HTTPS-Internet-Inbound",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.3",check_description:"Validates DMZ architecture with restricted database access",severity:"LOW",status:"PASS",expected_value:"Web tier in DMZ, databases in private subnet",actual_value:"NSG properly segments web and database tiers",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0011",rule_reference:"pa-rule-pci-violation",rule_name:"Direct-Internet-to-DB",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.3",check_description:"Validates DMZ architecture with restricted database access",severity:"CRITICAL",status:"FAIL",expected_value:"No direct internet access to cardholder data environment",actual_value:"Rule allows Untrust zone to Database zone on port 5432",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove direct internet to database rule. Route through application tier in DMZ.",ticket_reference:null},{validation_id:"VAL-0012",rule_reference:"sgr-0a1b2c3d4e5f0047",rule_name:"Kafka-Producer-Access",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"PORT_RANGE_VALIDATION",check_description:"Validates that port ranges are correctly specified",severity:"LOW",status:"PASS",expected_value:"Valid port number or range (1-65535)",actual_value:"9092",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012348"},{validation_id:"VAL-0013",rule_reference:"nsg-invalid-port",rule_name:"Invalid-Port-Range",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"PORT_RANGE_VALIDATION",check_description:"Validates that port ranges are correctly specified",severity:"HIGH",status:"FAIL",expected_value:"Valid port number or range (1-65535)",actual_value:"Port range: 0-70000 (invalid)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Correct port range to valid values (1-65535). Split into multiple rules if needed.",ticket_reference:null},{validation_id:"VAL-0014",rule_reference:"sgr-dup-rule-001",rule_name:"Duplicate-HTTPS-Rule-1",platform:"AWS",validation_category:"REDUNDANCY",validation_check:"DUPLICATE_RULE_DETECTION",check_description:"Identifies duplicate or overlapping rules",severity:"MEDIUM",status:"WARNING",expected_value:"Unique rule without duplicates",actual_value:"Duplicate of sgr-dup-rule-002 (same source, port, protocol)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove duplicate rule sgr-dup-rule-002 or consolidate into single rule",ticket_reference:null},{validation_id:"VAL-0015",rule_reference:"gcp-conflict-001",rule_name:"Allow-SSH-Specific",platform:"GCP",validation_category:"CONFLICT",validation_check:"CONFLICTING_RULE_DETECTION",check_description:"Identifies rules that conflict with each other",severity:"HIGH",status:"FAIL",expected_value:"No conflicting allow/deny rules for same traffic",actual_value:"Conflicts with deny-ssh-all (priority 100 vs 1000)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review priority ordering. Higher priority deny rule (100) will block this allow rule (1000).",ticket_reference:null},{validation_id:"VAL-0016",rule_reference:"pa-expired-rule-001",rule_name:"Temp-Vendor-Access-Expired",platform:"Palo Alto",validation_category:"EXPIRATION",validation_check:"RULE_EXPIRATION_CHECK",check_description:"Validates that temporary rules are removed after expiration",severity:"MEDIUM",status:"FAIL",expected_value:"Rule should be disabled or removed after 2025-12-31",actual_value:"Rule still active, expired 13 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Disable or remove expired rule. If still needed, create new change request for extension.",ticket_reference:"CHG0011234"},{validation_id:"VAL-0017",rule_reference:"sgr-0a1b2c3d4e5f0086",rule_name:"Jenkins-CI-CD-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"TICKET_REFERENCE_REQUIRED",check_description:"Validates that all rules have associated change tickets",severity:"LOW",status:"PASS",expected_value:"Valid change ticket reference",actual_value:"CHG0012359",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012359"},{validation_id:"VAL-0018",rule_reference:"nsg-no-ticket-001",rule_name:"Unknown-Rule-No-Ticket",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"TICKET_REFERENCE_REQUIRED",check_description:"Validates that all rules have associated change tickets",severity:"MEDIUM",status:"FAIL",expected_value:"Valid change ticket reference",actual_value:"(no ticket reference)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Create change ticket documenting rule purpose and approval. Tag rule with ticket number.",ticket_reference:null},{validation_id:"VAL-0019",rule_reference:"sgr-0a1b2c3d4e5f0096",rule_name:"Vault-Secrets-Access",platform:"AWS",validation_category:"SECURITY",validation_check:"SENSITIVE_SERVICE_PROTECTION",check_description:"Validates that sensitive services have restricted access",severity:"LOW",status:"PASS",expected_value:"Vault access restricted to specific application groups",actual_value:"Source: 10.30.0.0/16 (Application CIDR only)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012360"},{validation_id:"VAL-0020",rule_reference:"gcp-vault-any",rule_name:"Vault-Any-Access",platform:"GCP",validation_category:"SECURITY",validation_check:"SENSITIVE_SERVICE_PROTECTION",check_description:"Validates that sensitive services have restricted access",severity:"HIGH",status:"FAIL",expected_value:"Vault access restricted to specific application groups",actual_value:"Source: 0.0.0.0/0 (unrestricted)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict Vault access to application network tags only. Remove public access.",ticket_reference:null},{validation_id:"VAL-0021",rule_reference:"pa-rule-payment",rule_name:"Allow-Payment-Processing",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.2",check_description:"Validates firewall rules restrict inbound and outbound traffic to CDE",severity:"LOW",status:"PASS",expected_value:"Traffic limited to payment processing requirements only",actual_value:"Source: AG-Payment-Servers, Dest: AG-Payment-Providers, App: ssl",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012352"},{validation_id:"VAL-0022",rule_reference:"sgr-wide-port-range",rule_name:"Wide-Port-Range-Rule",platform:"AWS",validation_category:"SECURITY",validation_check:"EXCESSIVE_PORT_RANGE",check_description:"Validates that port ranges are not excessively wide",severity:"HIGH",status:"FAIL",expected_value:"Specific ports or narrow ranges",actual_value:"Port range: 1-65535 (all ports)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict to specific ports required. Split into multiple rules for different services.",ticket_reference:null},{validation_id:"VAL-0023",rule_reference:"nsg-webapp-prod-100",rule_name:"Allow-HTTPS-Internet-Inbound",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"SOC2_ACCESS_CONTROL",check_description:"Validates logical access controls per SOC2 CC6.1",severity:"LOW",status:"PASS",expected_value:"Access restricted based on business requirements",actual_value:"HTTPS only, appropriate for public web application",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0024",rule_reference:"gcp-allow-https-ingress",rule_name:"allow-https-ingress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"LOGGING_ENABLED",check_description:"Validates that firewall logging is enabled for audit",severity:"MEDIUM",status:"PASS",expected_value:"Logging enabled",actual_value:"logging: true",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0025",rule_reference:"gcp-internal-no-log",rule_name:"allow-internal-traffic",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"LOGGING_ENABLED",check_description:"Validates that firewall logging is enabled for audit",severity:"MEDIUM",status:"WARNING",expected_value:"Logging enabled",actual_value:"logging: false",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Enable logging for audit trail. Consider log sampling for high-volume rules.",ticket_reference:null},{validation_id:"VAL-0026",rule_reference:"pa-security-profile",rule_name:"Allow-HTTPS-Inbound-DMZ",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SECURITY_PROFILE_ATTACHED",check_description:"Validates that security profiles are attached to allow rules",severity:"LOW",status:"PASS",expected_value:"Security profile group attached",actual_value:"Profile: Web-Protection (AV, AS, VP, URL, FP)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0027",rule_reference:"pa-no-profile",rule_name:"Allow-Internal-No-Profile",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SECURITY_PROFILE_ATTACHED",check_description:"Validates that security profiles are attached to allow rules",severity:"HIGH",status:"FAIL",expected_value:"Security profile group attached",actual_value:"Profile: (none)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Attach appropriate security profile (Internal-Protection or similar)",ticket_reference:null},{validation_id:"VAL-0028",rule_reference:"sgr-0a1b2c3d4e5f0073",rule_name:"Grafana-Dashboard-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"NAMING_CONVENTION",check_description:"Validates rule naming follows organizational standards",severity:"INFO",status:"PASS",expected_value:"Format: [Action]-[Service]-[Direction]-[Source]",actual_value:"Allow-Grafana-VPN-Inbound",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012367"},{validation_id:"VAL-0029",rule_reference:"nsg-bad-name",rule_name:"rule1",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"NAMING_CONVENTION",check_description:"Validates rule naming follows organizational standards",severity:"LOW",status:"FAIL",expected_value:"Format: [Action]-[Service]-[Direction]-[Source]",actual_value:"rule1",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Rename to follow convention, e.g., 'Allow-HTTPS-Inbound-Internet'",ticket_reference:null},{validation_id:"VAL-0030",rule_reference:"sgr-0a1b2c3d4e5f0052",rule_name:"Kafka-Zookeeper-Internal",platform:"AWS",validation_category:"PERFORMANCE",validation_check:"RULE_HIT_COUNT",check_description:"Identifies rules with zero or very low hit counts",severity:"INFO",status:"PASS",expected_value:"Hit count > 0 in last 30 days",actual_value:"Hit count: 1,245,678",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012368"},{validation_id:"VAL-0031",rule_reference:"pa-zero-hits",rule_name:"Allow-Legacy-FTP",platform:"Palo Alto",validation_category:"PERFORMANCE",validation_check:"RULE_HIT_COUNT",check_description:"Identifies rules with zero or very low hit counts",severity:"LOW",status:"WARNING",expected_value:"Hit count > 0 in last 30 days",actual_value:"Hit count: 0 (last 90 days)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review if rule is still needed. Consider disabling for 30 days before removal.",ticket_reference:null},{validation_id:"VAL-0032",rule_reference:"sgr-icmp-unrestricted",rule_name:"Allow-ICMP-All",platform:"AWS",validation_category:"SECURITY",validation_check:"ICMP_RESTRICTION",check_description:"Validates ICMP is restricted appropriately",severity:"MEDIUM",status:"FAIL",expected_value:"ICMP restricted to specific types (echo-request/reply) or internal only",actual_value:"All ICMP types from 0.0.0.0/0",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict to ICMP types 0 and 8 (echo) from internal networks only",ticket_reference:null},{validation_id:"VAL-0033",rule_reference:"nsg-telnet-allow",rule_name:"Allow-Telnet-Internal",platform:"Azure",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"FAIL",expected_value:"No Telnet (port 23), use SSH instead",actual_value:"Port 23 allowed from internal networks",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Migrate to SSH (port 22). Remove Telnet rule after migration.",ticket_reference:null},{validation_id:"VAL-0034",rule_reference:"gcp-ftp-allow",rule_name:"allow-ftp-partner",platform:"GCP",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"FAIL",expected_value:"No unencrypted FTP (port 21), use SFTP instead",actual_value:"Port 21 allowed from partner IPs",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Migrate partners to SFTP (port 22) or FTPS (port 990). Update partner documentation.",ticket_reference:null},{validation_id:"VAL-0035",rule_reference:"pa-http-internal",rule_name:"Allow-HTTP-Internal",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"UNENCRYPTED_WEB_TRAFFIC",check_description:"Validates that HTTP is redirected to HTTPS",severity:"MEDIUM",status:"WARNING",expected_value:"HTTP redirected to HTTPS or blocked",actual_value:"HTTP (port 80) allowed internally",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Internal applications not yet migrated to HTTPS",remediation:"Plan migration of internal applications to HTTPS. Block HTTP after migration.",ticket_reference:"CHG0012500"},{validation_id:"VAL-0036",rule_reference:"sgr-0a1b2c3d4e5f0107",rule_name:"Payment-Webhook-Stripe",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.4",check_description:"Validates personal firewall on mobile/employee-owned devices",severity:"INFO",status:"PASS",expected_value:"N/A for server rules",actual_value:"Server-side rule, requirement not applicable",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012352"},{validation_id:"VAL-0037",rule_reference:"nsg-storage-endpoint",rule_name:"Allow-Storage-Endpoint",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"SERVICE_TAG_USAGE",check_description:"Validates use of service tags for Azure services",severity:"LOW",status:"PASS",expected_value:"Service tag used instead of IP ranges",actual_value:"Destination: Storage",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012384"},{validation_id:"VAL-0038",rule_reference:"nsg-hardcoded-ips",rule_name:"Allow-Azure-Services-IPs",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"SERVICE_TAG_USAGE",check_description:"Validates use of service tags for Azure services",severity:"MEDIUM",status:"FAIL",expected_value:"Service tag used instead of IP ranges",actual_value:"Hardcoded IPs: 20.38.147.0/24, 20.150.0.0/24",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace hardcoded IPs with appropriate Azure service tags (e.g., AzureCloud, Storage)",ticket_reference:null},{validation_id:"VAL-0039",rule_reference:"sgr-s3-prefix-list",rule_name:"Allow-S3-VPC-Endpoint",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"PREFIX_LIST_USAGE",check_description:"Validates use of prefix lists for AWS services",severity:"LOW",status:"PASS",expected_value:"Prefix list used for AWS service endpoints",actual_value:"Destination: pl-63a5400a (S3)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012384"},{validation_id:"VAL-0040",rule_reference:"gcp-network-tags",rule_name:"allow-web-to-app",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"NETWORK_TAG_USAGE",check_description:"Validates use of network tags instead of IP ranges",severity:"LOW",status:"PASS",expected_value:"Network tags used for source/target",actual_value:"Source: web-server, Target: app-server",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012371"},{validation_id:"VAL-0041",rule_reference:"pa-address-group",rule_name:"Allow-App-to-DB",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"ADDRESS_GROUP_USAGE",check_description:"Validates use of address groups instead of individual IPs",severity:"LOW",status:"PASS",expected_value:"Address groups used for source/destination",actual_value:"Source: AG-App-Servers, Dest: AG-DB-Servers",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012346"},{validation_id:"VAL-0042",rule_reference:"pa-individual-ips",rule_name:"Allow-Specific-Hosts",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"ADDRESS_GROUP_USAGE",check_description:"Validates use of address groups instead of individual IPs",severity:"LOW",status:"WARNING",expected_value:"Address groups used for source/destination",actual_value:"Source: 10.30.1.15, 10.30.1.16, 10.30.1.17, 10.30.1.18",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Create address group for these hosts and reference group in rule",ticket_reference:null},{validation_id:"VAL-0043",rule_reference:"sgr-0a1b2c3d4e5f0080",rule_name:"EKS-Node-Communication",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"SELF_REFERENCING_GROUP",check_description:"Validates self-referencing security group for cluster communication",severity:"INFO",status:"PASS",expected_value:"Self-reference for internal cluster traffic",actual_value:"Source: sg-eks-nodes (self-reference)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0044",rule_reference:"nsg-mgmt-ports",rule_name:"Allow-Management-Ports",platform:"Azure",validation_category:"SECURITY",validation_check:"MANAGEMENT_PORT_PROTECTION",check_description:"Validates management ports have additional restrictions",severity:"MEDIUM",status:"PASS",expected_value:"SSH/RDP restricted to bastion or VPN only",actual_value:"Source: AzureBastionSubnet, Ports: 22, 3389",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012372"},{validation_id:"VAL-0045",rule_reference:"gcp-iap-ssh",rule_name:"allow-ssh-iap",platform:"GCP",validation_category:"SECURITY",validation_check:"IAP_TUNNEL_USAGE",check_description:"Validates SSH access uses Identity-Aware Proxy",severity:"LOW",status:"PASS",expected_value:"SSH from IAP range 35.235.240.0/20",actual_value:"Source: 35.235.240.0/20 (IAP range)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012430"},{validation_id:"VAL-0046",rule_reference:"sgr-expired-temp",rule_name:"Temp-Debug-Access",platform:"AWS",validation_category:"EXPIRATION",validation_check:"TEMPORARY_RULE_AUDIT",check_description:"Validates temporary rules have expiration dates",severity:"MEDIUM",status:"FAIL",expected_value:"Expiration date set for temporary rules",actual_value:"No expiration date, created 180 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add expiration date or convert to permanent rule with proper documentation",ticket_reference:"CHG0011000"},{validation_id:"VAL-0047",rule_reference:"pa-app-default",rule_name:"Allow-Web-Apps",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"APPLICATION_IDENTIFICATION",check_description:"Validates application identification is used instead of port-based",severity:"LOW",status:"PASS",expected_value:"Application-ID used instead of service ports",actual_value:"Application: web-browsing, ssl; Service: application-default",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0048",rule_reference:"pa-port-based",rule_name:"Allow-Port-8080",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"APPLICATION_IDENTIFICATION",check_description:"Validates application identification is used instead of port-based",severity:"MEDIUM",status:"WARNING",expected_value:"Application-ID used instead of service ports",actual_value:"Application: any; Service: tcp/8080",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace 'any' application with specific App-ID (e.g., web-browsing, ssl)",ticket_reference:null},{validation_id:"VAL-0049",rule_reference:"sgr-0a1b2c3d4e5f0091",rule_name:"Splunk-Log-Ingestion",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"AUDIT_LOG_PROTECTION",check_description:"Validates audit/log systems have proper access controls",severity:"LOW",status:"PASS",expected_value:"Log ingestion restricted to internal sources",actual_value:"Source: 10.0.0.0/8 (internal only)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012373"},{validation_id:"VAL-0050",rule_reference:"nsg-subnet-overlap",rule_name:"Allow-Subnet-Overlap",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"CIDR_OVERLAP_DETECTION",check_description:"Validates no overlapping CIDR ranges in rules",severity:"MEDIUM",status:"WARNING",expected_value:"No overlapping source/destination CIDRs",actual_value:"10.0.0.0/8 overlaps with 10.30.0.0/16 in other rule",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Use more specific CIDR ranges to avoid overlap confusion",ticket_reference:null},{validation_id:"VAL-0051",rule_reference:"gcp-deny-all-ingress",rule_name:"deny-all-ingress",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"DEFAULT_DENY_EXISTS",check_description:"Validates default deny rule exists at lowest priority",severity:"LOW",status:"PASS",expected_value:"Default deny rule at priority 65535",actual_value:"Priority: 65535, Action: deny, Direction: INGRESS",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0052",rule_reference:"pa-default-deny",rule_name:"Default-Deny-All",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"DEFAULT_DENY_EXISTS",check_description:"Validates default deny rule exists at end of policy",severity:"LOW",status:"PASS",expected_value:"Default deny rule at bottom of rulebase",actual_value:"Rule at position 105, Action: Deny, any-any",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0053",rule_reference:"sgr-dns-udp-only",rule_name:"Allow-DNS-Outbound",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"DNS_TCP_UDP_REQUIRED",check_description:"Validates DNS rules allow both TCP and UDP",severity:"LOW",status:"WARNING",expected_value:"DNS on both TCP/53 and UDP/53",actual_value:"UDP/53 only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add TCP/53 rule for DNS over TCP (large responses, zone transfers)",ticket_reference:null},{validation_id:"VAL-0054",rule_reference:"nsg-sql-internet",rule_name:"Deny-SQL-Internet",platform:"Azure",validation_category:"SECURITY",validation_check:"DATABASE_INTERNET_BLOCK",check_description:"Validates database ports are blocked from internet",severity:"LOW",status:"PASS",expected_value:"Database ports blocked from internet",actual_value:"Deny rule for 1433, 3306, 5432 from Internet",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012363"},{validation_id:"VAL-0055",rule_reference:"gcp-smb-exposed",rule_name:"allow-smb-external",platform:"GCP",validation_category:"SECURITY",validation_check:"DANGEROUS_PORT_EXPOSURE",check_description:"Validates dangerous ports are not exposed to internet",severity:"CRITICAL",status:"FAIL",expected_value:"SMB (445) not exposed to internet",actual_value:"Port 445 exposed to 0.0.0.0/0",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Remove SMB exposure to internet. High risk of exploitation.",ticket_reference:null},{validation_id:"VAL-0056",rule_reference:"pa-zone-protection",rule_name:"Untrust-Zone-Protection",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"ZONE_PROTECTION_PROFILE",check_description:"Validates zone protection profiles are applied",severity:"LOW",status:"PASS",expected_value:"Zone protection profile on untrust zone",actual_value:"Profile: External-Zone-Protection applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0057",rule_reference:"sgr-0a1b2c3d4e5f0018",rule_name:"Database-Replication-DR",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"DR_CONNECTIVITY",check_description:"Validates DR site connectivity is properly configured",severity:"LOW",status:"PASS",expected_value:"Replication traffic to DR site allowed",actual_value:"PostgreSQL (5432) to DR CIDR 10.120.0.0/16",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012380"},{validation_id:"VAL-0058",rule_reference:"nsg-priority-gap",rule_name:"Rule-Priority-100",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"PRIORITY_SPACING",check_description:"Validates adequate priority spacing for future rules",severity:"INFO",status:"WARNING",expected_value:"Priority spacing of at least 10",actual_value:"Rules at 100, 101, 102 (gap of 1)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Consider renumbering priorities with larger gaps (100, 110, 120)",ticket_reference:null},{validation_id:"VAL-0059",rule_reference:"gcp-priority-order",rule_name:"allow-specific-after-deny",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"PRIORITY_ORDER_VALIDATION",check_description:"Validates rule priority order is logical",severity:"HIGH",status:"FAIL",expected_value:"Allow rules have higher priority (lower number) than deny",actual_value:"Allow at 2000, Deny at 1000 (deny processed first)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Adjust priority: Allow rule should be < 1000 to be processed before deny",ticket_reference:null},{validation_id:"VAL-0060",rule_reference:"pa-rule-shadowed",rule_name:"Allow-HTTP-Specific",platform:"Palo Alto",validation_category:"REDUNDANCY",validation_check:"SHADOWED_RULE_DETECTION",check_description:"Identifies rules shadowed by more general rules above",severity:"MEDIUM",status:"WARNING",expected_value:"Rule not shadowed by broader rule",actual_value:"Shadowed by 'Allow-Any-HTTP' at position 5",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Reorder rules or remove shadowed rule if redundant",ticket_reference:null},{validation_id:"VAL-0061",rule_reference:"sgr-nat-gateway",rule_name:"NAT-Gateway-Outbound",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"NAT_GATEWAY_RULES",check_description:"Validates NAT gateway security group configuration",severity:"LOW",status:"PASS",expected_value:"NAT gateway allows outbound to internet",actual_value:"Outbound: 0.0.0.0/0, Protocol: ALL",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012400"},{validation_id:"VAL-0062",rule_reference:"nsg-keyvault-private",rule_name:"Allow-KeyVault-Private-Endpoint",platform:"Azure",validation_category:"SECURITY",validation_check:"PRIVATE_ENDPOINT_USAGE",check_description:"Validates private endpoints for sensitive services",severity:"LOW",status:"PASS",expected_value:"Key Vault accessed via private endpoint",actual_value:"Destination: Private endpoint 10.50.1.5",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012390"},{validation_id:"VAL-0063",rule_reference:"gcp-vpc-peering",rule_name:"allow-peered-vpc-traffic",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"VPC_PEERING_RULES",check_description:"Validates firewall rules for VPC peering",severity:"LOW",status:"PASS",expected_value:"Peered VPC traffic properly allowed",actual_value:"Source: 10.200.0.0/16 (peered VPC)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012450"},{validation_id:"VAL-0064",rule_reference:"pa-edl-malicious",rule_name:"Block-Malicious-IPs-EDL",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"THREAT_FEED_INTEGRATION",check_description:"Validates threat intelligence feeds are integrated",severity:"LOW",status:"PASS",expected_value:"External dynamic list for threat IPs",actual_value:"Source: EDL-Malicious-IPs (updated hourly)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012350"},{validation_id:"VAL-0065",rule_reference:"sgr-container-registry",rule_name:"ECR-Pull-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"CONTAINER_REGISTRY_ACCESS",check_description:"Validates container registry access is properly configured",severity:"LOW",status:"PASS",expected_value:"ECR access via VPC endpoint",actual_value:"Destination: vpce-ecr, Port: 443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012374"},{validation_id:"VAL-0066",rule_reference:"nsg-aks-nodeport",rule_name:"Allow-AKS-NodePort-Range",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"KUBERNETES_NODEPORT_RANGE",check_description:"Validates Kubernetes NodePort range is properly configured",severity:"LOW",status:"PASS",expected_value:"NodePort range 30000-32767",actual_value:"Port range: 30000-32767",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0067",rule_reference:"gcp-gke-master-node",rule_name:"allow-gke-master-to-nodes",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"GKE_MASTER_ACCESS",check_description:"Validates GKE master to node communication",severity:"LOW",status:"PASS",expected_value:"Master can reach nodes on 443, 10250",actual_value:"Source: gke-master tag, Ports: 443, 10250",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0068",rule_reference:"pa-hipaa-encryption",rule_name:"Allow-Healthcare-Data",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"HIPAA_ENCRYPTION_REQUIREMENT",check_description:"Validates healthcare data is transmitted encrypted",severity:"LOW",status:"PASS",expected_value:"Only encrypted protocols for PHI",actual_value:"Application: ssl; Service: tcp/443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012455"},{validation_id:"VAL-0069",rule_reference:"sgr-unencrypted-phi",rule_name:"Allow-HTTP-Healthcare",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"HIPAA_ENCRYPTION_REQUIREMENT",check_description:"Validates healthcare data is transmitted encrypted",severity:"CRITICAL",status:"FAIL",expected_value:"Only encrypted protocols for PHI",actual_value:"HTTP (80) allowed for healthcare application",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Migrate to HTTPS. Unencrypted PHI transmission violates HIPAA.",ticket_reference:null},{validation_id:"VAL-0070",rule_reference:"nsg-monitoring-access",rule_name:"Allow-Monitoring-Agents",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"MONITORING_EGRESS",check_description:"Validates monitoring agent egress is allowed",severity:"LOW",status:"PASS",expected_value:"Monitoring agents can reach collectors",actual_value:"Destination: AzureMonitor, Port: 443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012387"},{validation_id:"VAL-0071",rule_reference:"gcp-healthcheck-ranges",rule_name:"allow-health-check",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"HEALTH_CHECK_RANGES",check_description:"Validates GCP health check ranges are allowed",severity:"LOW",status:"PASS",expected_value:"Source: 35.191.0.0/16, 130.211.0.0/22",actual_value:"Source: 35.191.0.0/16, 130.211.0.0/22",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012370"},{validation_id:"VAL-0072",rule_reference:"pa-decryption-policy",rule_name:"SSL-Decryption-Web",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SSL_DECRYPTION_ENABLED",check_description:"Validates SSL decryption is enabled for inspection",severity:"LOW",status:"PASS",expected_value:"SSL decryption enabled for outbound web",actual_value:"Decryption: Forward Proxy, Profile: SSL-Decrypt-Standard",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0073",rule_reference:"sgr-vpc-flow-logs",rule_name:"VPC-Flow-Logs-Config",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"FLOW_LOGS_ENABLED",check_description:"Validates VPC flow logs are enabled for audit",severity:"INFO",status:"PASS",expected_value:"Flow logs enabled on VPC",actual_value:"Flow logs: ENABLED, Destination: S3",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0074",rule_reference:"nsg-flow-logs-disabled",rule_name:"NSG-No-Flow-Logs",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"NSG_FLOW_LOGS_ENABLED",check_description:"Validates NSG flow logs are enabled for audit",severity:"MEDIUM",status:"FAIL",expected_value:"NSG flow logs enabled",actual_value:"Flow logs: DISABLED",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Enable NSG flow logs for compliance and troubleshooting",ticket_reference:null},{validation_id:"VAL-0075",rule_reference:"gcp-org-policy",rule_name:"Org-Policy-Compliance",platform:"GCP",validation_category:"COMPLIANCE",validation_check:"ORG_POLICY_COMPLIANCE",check_description:"Validates firewall rules comply with organization policies",severity:"LOW",status:"PASS",expected_value:"Rules comply with org constraints",actual_value:"All rules comply with compute.restrictVpcPeering",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0076",rule_reference:"pa-commit-validation",rule_name:"Pending-Commit-Rules",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"UNCOMMITTED_CHANGES",check_description:"Validates no uncommitted changes pending",severity:"INFO",status:"WARNING",expected_value:"No uncommitted changes",actual_value:"3 uncommitted rule changes",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Commit pending changes or revert if not needed",ticket_reference:null},{validation_id:"VAL-0077",rule_reference:"sgr-deprecated-ami",rule_name:"Allow-Deprecated-AMI-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DEPRECATED_RESOURCE_REFERENCE",check_description:"Validates rules don't reference deprecated resources",severity:"LOW",status:"WARNING",expected_value:"No deprecated resource references",actual_value:"References deprecated security group sg-legacy-app",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Update rule to reference current security group",ticket_reference:null},{validation_id:"VAL-0078",rule_reference:"nsg-gdpr-data",rule_name:"Allow-EU-Data-Processing",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"GDPR_DATA_RESIDENCY",check_description:"Validates EU data stays within approved regions",severity:"LOW",status:"PASS",expected_value:"EU data within EU regions only",actual_value:"Destination: EU West, EU North only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012456"},{validation_id:"VAL-0079",rule_reference:"gcp-cross-region",rule_name:"allow-cross-region-db",platform:"GCP",validation_category:"COMPLIANCE",validation_check:"GDPR_DATA_RESIDENCY",check_description:"Validates EU data stays within approved regions",severity:"HIGH",status:"EXCEPTION",expected_value:"EU data within EU regions only",actual_value:"Cross-region replication to US for DR",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Approved exception for DR - Standard Contractual Clauses in place",remediation:null,ticket_reference:"EXC-0012"},{validation_id:"VAL-0080",rule_reference:"pa-url-filtering",rule_name:"Block-Malicious-URLs",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"URL_FILTERING_ENABLED",check_description:"Validates URL filtering is enabled for web traffic",severity:"LOW",status:"PASS",expected_value:"URL filtering profile attached",actual_value:"Profile: URL-Block-Profile (malware, phishing blocked)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0081",rule_reference:"sgr-stale-rule",rule_name:"Allow-Old-Partner-Access",platform:"AWS",validation_category:"EXPIRATION",validation_check:"STALE_RULE_DETECTION",check_description:"Identifies rules not modified in over 1 year",severity:"LOW",status:"WARNING",expected_value:"Rule reviewed within last year",actual_value:"Last modified: 2024-06-15 (577 days ago)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review rule validity. Update or remove if no longer needed.",ticket_reference:null},{validation_id:"VAL-0082",rule_reference:"nsg-asg-membership",rule_name:"Allow-ASG-WebApp",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"ASG_MEMBERSHIP_VALIDATION",check_description:"Validates ASG has active members",severity:"MEDIUM",status:"WARNING",expected_value:"ASG has active NIC memberships",actual_value:"asg-legacy-app has 0 members",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add NICs to ASG or remove unused ASG references",ticket_reference:null},{validation_id:"VAL-0083",rule_reference:"gcp-firewall-insights",rule_name:"Firewall-Insights-Check",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"FIREWALL_INSIGHTS_ENABLED",check_description:"Validates Firewall Insights is enabled",severity:"INFO",status:"PASS",expected_value:"Firewall Insights enabled",actual_value:"Insights: ENABLED",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0084",rule_reference:"pa-rule-disable",rule_name:"Disabled-Rule-Check",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"DISABLED_RULE_AUDIT",check_description:"Identifies disabled rules that should be removed",severity:"INFO",status:"WARNING",expected_value:"Disabled rules removed after 30 days",actual_value:"5 rules disabled for > 90 days",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review and remove disabled rules no longer needed",ticket_reference:null},{validation_id:"VAL-0085",rule_reference:"sgr-ipv6-support",rule_name:"IPv6-Dual-Stack",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"IPV6_COVERAGE",check_description:"Validates IPv6 rules exist for dual-stack",severity:"INFO",status:"PASS",expected_value:"IPv6 rules mirror IPv4",actual_value:"IPv6 rules present for all public services",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012457"},{validation_id:"VAL-0086",rule_reference:"nsg-cross-subscription",rule_name:"Allow-Cross-Subscription",platform:"Azure",validation_category:"SECURITY",validation_check:"CROSS_SUBSCRIPTION_ACCESS",check_description:"Validates cross-subscription access is authorized",severity:"MEDIUM",status:"EXCEPTION",expected_value:"Cross-subscription access documented and approved",actual_value:"Traffic to subscription: sub-shared-services",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Approved for shared services architecture - documented in ADR-0023",remediation:null,ticket_reference:"EXC-0015"},{validation_id:"VAL-0087",rule_reference:"gcp-shared-vpc",rule_name:"allow-shared-vpc-access",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"SHARED_VPC_RULES",check_description:"Validates Shared VPC firewall rules",severity:"LOW",status:"PASS",expected_value:"Shared VPC rules in host project",actual_value:"Rules managed in host project vpc-host-prod",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012458"},{validation_id:"VAL-0088",rule_reference:"pa-ha-sync",rule_name:"HA-Sync-Validation",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"HA_RULE_SYNC",check_description:"Validates rules are synced across HA pair",severity:"LOW",status:"PASS",expected_value:"Rules identical on both HA members",actual_value:"Primary and Secondary in sync",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0089",rule_reference:"sgr-cidr-specific",rule_name:"Allow-Partner-CIDR",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"CIDR_SPECIFICITY",check_description:"Validates CIDRs are as specific as possible",severity:"LOW",status:"WARNING",expected_value:"Most specific CIDR for partner",actual_value:"198.51.100.0/24 could be 198.51.100.0/28",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Narrow CIDR to actual partner IP range",ticket_reference:null},{validation_id:"VAL-0090",rule_reference:"nsg-ddos-protection",rule_name:"DDoS-Protection-Check",platform:"Azure",validation_category:"SECURITY",validation_check:"DDOS_PROTECTION_ENABLED",check_description:"Validates DDoS protection is enabled",severity:"LOW",status:"PASS",expected_value:"DDoS Protection Standard enabled",actual_value:"DDoS Protection: ENABLED (Standard tier)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0091",rule_reference:"gcp-armor-policy",rule_name:"Cloud-Armor-Check",platform:"GCP",validation_category:"SECURITY",validation_check:"CLOUD_ARMOR_ENABLED",check_description:"Validates Cloud Armor is enabled for public endpoints",severity:"LOW",status:"PASS",expected_value:"Cloud Armor policy attached to LB",actual_value:"Policy: web-protection-policy attached",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0092",rule_reference:"pa-dos-protection",rule_name:"DoS-Protection-Profile",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"DOS_PROTECTION_ENABLED",check_description:"Validates DoS protection profiles are configured",severity:"LOW",status:"PASS",expected_value:"DoS protection on untrust zone",actual_value:"Profile: DoS-Protection-Aggregate applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0093",rule_reference:"sgr-lambda-access",rule_name:"Lambda-VPC-Access",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"SERVERLESS_VPC_ACCESS",check_description:"Validates Lambda VPC access is properly configured",severity:"LOW",status:"PASS",expected_value:"Lambda SG allows required egress",actual_value:"Egress to RDS, ElastiCache, S3 endpoint",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012459"},{validation_id:"VAL-0094",rule_reference:"nsg-function-app",rule_name:"Function-App-VNet-Integration",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"FUNCTION_VNET_INTEGRATION",check_description:"Validates Function App VNet integration rules",severity:"LOW",status:"PASS",expected_value:"Function App subnet allowed to backend",actual_value:"snet-functions-prod can access database and cache",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012460"},{validation_id:"VAL-0095",rule_reference:"gcp-cloud-run",rule_name:"allow-cloud-run-egress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"SERVERLESS_CONNECTOR",check_description:"Validates Serverless VPC Access connector rules",severity:"LOW",status:"PASS",expected_value:"VPC connector subnet has proper access",actual_value:"Connector subnet can reach Cloud SQL, Memorystore",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012461"},{validation_id:"VAL-0096",rule_reference:"pa-globalprotect",rule_name:"GlobalProtect-VPN-Access",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"VPN_ZONE_RULES",check_description:"Validates VPN zone rules are properly configured",severity:"LOW",status:"PASS",expected_value:"VPN zone has appropriate access",actual_value:"Zone VPN to Trust, Database restricted to DBA group",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012349"},{validation_id:"VAL-0097",rule_reference:"sgr-sso-integration",rule_name:"Allow-SSO-Provider",platform:"AWS",validation_category:"SECURITY",validation_check:"SSO_PROVIDER_ACCESS",check_description:"Validates SSO provider access is properly scoped",severity:"LOW",status:"PASS",expected_value:"SSO limited to HTTPS only",actual_value:"Okta access on 443 only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012395"},{validation_id:"VAL-0098",rule_reference:"nsg-pending-review",rule_name:"New-Partner-Access-Request",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting security review - submitted 3 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Complete security review before implementation",ticket_reference:"CHG0012470"},{validation_id:"VAL-0099",rule_reference:"gcp-pending-firewall",rule_name:"New-API-Access-Rule",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting compliance review - HIPAA assessment needed",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Complete HIPAA compliance assessment before approval",ticket_reference:"CHG0012471"},{validation_id:"VAL-0100",rule_reference:"pa-pending-rule",rule_name:"New-Vendor-Integration",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting vendor security questionnaire completion",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Obtain completed vendor security questionnaire before approval",ticket_reference:"CHG0012472"},{validation_id:"VAL-0101",rule_reference:"sgr-exception-approved",rule_name:"Legacy-Protocol-Exception",platform:"AWS",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"EXCEPTION",expected_value:"No unencrypted protocols",actual_value:"FTP (21) allowed for legacy integration",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Legacy system cannot support SFTP - migration planned Q2 2026. Compensating controls: IP whitelist, network segmentation, enhanced logging",remediation:"Migration to SFTP scheduled for CHG0013000",ticket_reference:"EXC-0020"},{validation_id:"VAL-0102",rule_reference:"nsg-wide-open-dev",rule_name:"Dev-Environment-Open",platform:"Azure",validation_category:"SECURITY",validation_check:"DEV_ENVIRONMENT_ISOLATION",check_description:"Validates development environments are properly isolated",severity:"HIGH",status:"FAIL",expected_value:"Dev environment isolated from production",actual_value:"Dev NSG allows traffic to production subnet",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove production access from dev environment. Create separate connectivity path if needed.",ticket_reference:null},{validation_id:"VAL-0103",rule_reference:"gcp-prod-dev-mix",rule_name:"allow-dev-to-prod-db",platform:"GCP",validation_category:"SECURITY",validation_check:"ENVIRONMENT_SEPARATION",check_description:"Validates production and non-production are separated",severity:"CRITICAL",status:"FAIL",expected_value:"No cross-environment database access",actual_value:"Development VPC can access production database",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Remove development to production database access. Use data masking for dev data needs.",ticket_reference:null},{validation_id:"VAL-0104",rule_reference:"pa-backup-traffic",rule_name:"Allow-Backup-Egress",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"BACKUP_ENCRYPTION",check_description:"Validates backup traffic is encrypted",severity:"LOW",status:"PASS",expected_value:"Backup traffic uses encrypted protocols",actual_value:"Application: ssl; Destination: Backup zone",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012415"},{validation_id:"VAL-0105",rule_reference:"sgr-waf-integration",rule_name:"WAF-to-Origin",platform:"AWS",validation_category:"SECURITY",validation_check:"WAF_INTEGRATION",check_description:"Validates WAF is in path for web traffic",severity:"LOW",status:"PASS",expected_value:"Web traffic routes through WAF",actual_value:"ALB has WAF ACL attached, origin only accepts ALB traffic",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0106",rule_reference:"nsg-missing-waf",rule_name:"Direct-Internet-to-Web",platform:"Azure",validation_category:"SECURITY",validation_check:"WAF_INTEGRATION",check_description:"Validates WAF is in path for web traffic",severity:"HIGH",status:"FAIL",expected_value:"Web traffic routes through WAF",actual_value:"Direct internet to VM without WAF",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Route traffic through Azure Application Gateway with WAF policy",ticket_reference:null},{validation_id:"VAL-0107",rule_reference:"gcp-cloud-nat",rule_name:"allow-cloud-nat-egress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"NAT_CONFIGURATION",check_description:"Validates Cloud NAT configuration for egress",severity:"LOW",status:"PASS",expected_value:"Cloud NAT configured for private instances",actual_value:"Cloud NAT enabled for needs-nat tagged instances",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012475"},{validation_id:"VAL-0108",rule_reference:"pa-qos-policy",rule_name:"QoS-Business-Critical",platform:"Palo Alto",validation_category:"PERFORMANCE",validation_check:"QOS_POLICY_ATTACHED",check_description:"Validates QoS policies for critical traffic",severity:"INFO",status:"PASS",expected_value:"QoS for business critical applications",actual_value:"QoS: Business-Critical class applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0109",rule_reference:"sgr-maintenance-window",rule_name:"Maintenance-Access-Rule",platform:"AWS",validation_category:"EXPIRATION",validation_check:"TIME_BASED_RULE",check_description:"Validates time-based rules have proper scheduling",severity:"LOW",status:"EXCEPTION",expected_value:"Time-based access with auto-disable",actual_value:"Rule active outside maintenance window",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Extended maintenance window approved - ticket EXT-0005",remediation:"Rule will auto-disable at end of extended window",ticket_reference:"EXT-0005"},{validation_id:"VAL-0110",rule_reference:"nsg-soc2-audit",rule_name:"SOC2-Audit-Access",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"SOC2_AUDIT_TRAIL",check_description:"Validates audit trail requirements for SOC2",severity:"LOW",status:"PASS",expected_value:"All access logged and auditable",actual_value:"NSG flow logs, Activity logs, Diagnostic settings enabled",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012480"}],qi={validation_summary:gx,validations:fx},us=t=>new Promise(s=>setTimeout(s,t)),Ve={openSSH:/0\.0\.0\.0\/0.*(?:22|ssh)/i,openRDP:/0\.0\.0\.0\/0.*(?:3389|rdp)/i,openDatabase:/0\.0\.0\.0\/0.*(?:3306|5432|1433|27017)/i,anySource:/(?:source|src|cidr).*(?:0\.0\.0\.0\/0|any|\*)/i,insecureProtocol:/(?:telnet|ftp|http[^s])/i,widePortRange:/(?:0-65535|all|any)/i},vx=t=>{const s=[];return t.split(`
`).forEach((r,n)=>{const i=n+1,o=r.trim();o.startsWith("aws ec2")&&(!o.includes("--group-id")&&!o.includes("\\")&&s.push({id:`aws-${i}-1`,line:i,severity:"error",category:"syntax",message:"Missing --group-id parameter",suggestion:"Add --group-id sg-xxxxxxxx to specify the security group"}),o.includes("--cidr 0.0.0.0/0")&&o.includes("--port 22")&&s.push({id:`aws-${i}-2`,line:i,severity:"error",category:"security",message:"SSH port 22 is open to the internet (0.0.0.0/0)",suggestion:"Restrict SSH access to specific IP ranges",ruleId:"SEC-001"})),o.includes("--protocol")&&!o.match(/--protocol\s+(tcp|udp|icmp|-1)/i)&&s.push({id:`aws-${i}-3`,line:i,severity:"warning",category:"syntax",message:"Invalid protocol specified",suggestion:"Use tcp, udp, icmp, or -1 (all)"})}),s},yx=t=>{const s=[];return t.split(`
`).forEach((r,n)=>{const i=n+1,o=r.trim();o.includes("az network nsg rule")&&(!o.includes("--priority")&&!o.includes("\\")&&s.push({id:`azure-${i}-1`,line:i,severity:"warning",category:"syntax",message:"Missing --priority parameter",suggestion:"Add --priority 100-4096 for rule ordering"}),!o.includes("--direction")&&!o.includes("\\")&&s.push({id:`azure-${i}-2`,line:i,severity:"error",category:"syntax",message:"Missing --direction parameter",suggestion:"Add --direction Inbound or Outbound"})),(o.includes('--source-address-prefixes "*"')||o.includes("--source-address-prefixes '*'"))&&s.push({id:`azure-${i}-3`,line:i,severity:"warning",category:"security",message:"Source address is open to all (*)",suggestion:"Restrict to specific IP ranges when possible"})}),s},bx=t=>{const s=[];return t.split(`
`).forEach((r,n)=>{const i=n+1,o=r.trim();o.includes("gcloud compute firewall-rules")&&(!o.includes("--network")&&!o.includes("\\")&&s.push({id:`gcp-${i}-1`,line:i,severity:"error",category:"syntax",message:"Missing --network parameter",suggestion:"Specify the VPC network with --network=<network-name>"}),!o.includes("--direction")&&!o.includes("\\")&&s.push({id:`gcp-${i}-2`,line:i,severity:"warning",category:"syntax",message:"Missing --direction parameter",suggestion:"Add --direction=INGRESS or EGRESS"})),o.includes("--source-ranges=0.0.0.0/0")&&s.push({id:`gcp-${i}-3`,line:i,severity:"warning",category:"security",message:"Source ranges open to all (0.0.0.0/0)",suggestion:"Restrict to specific IP ranges"})}),s},_x=t=>{const s=[];return t.split(`
`).forEach((r,n)=>{const i=n+1,o=r.trim();(o.startsWith("iptables")||o.startsWith("-A"))&&(!o.includes("-j")&&o.length>10&&s.push({id:`ipt-${i}-1`,line:i,severity:"error",category:"syntax",message:"Missing jump target (-j)",suggestion:"Add -j ACCEPT, DROP, or REJECT"}),!o.includes("-A")&&!o.includes("-I")&&!o.includes("-D")&&s.push({id:`ipt-${i}-2`,line:i,severity:"warning",category:"syntax",message:"Missing chain operation",suggestion:"Use -A (append), -I (insert), or -D (delete)"})),o.includes("--dport 22")&&!o.includes("-s ")&&s.push({id:`ipt-${i}-3`,line:i,severity:"error",category:"security",message:"SSH rule without source restriction",suggestion:"Add -s <source-ip> to restrict SSH access"})}),s},wx=t=>{const s=[];return t.split(`
`).forEach((r,n)=>{const i=n+1,o=r.trim();o.startsWith("access-list")&&(!o.includes("extended")&&!o.includes("standard")&&s.push({id:`asa-${i}-1`,line:i,severity:"warning",category:"syntax",message:"Access list type not specified",suggestion:'Use "extended" for IP-based ACLs'}),o.match(/permit|deny/)||s.push({id:`asa-${i}-2`,line:i,severity:"error",category:"syntax",message:"Missing action (permit/deny)",suggestion:"Specify permit or deny action"})),o.includes("permit")&&o.includes("any any")&&s.push({id:`asa-${i}-3`,line:i,severity:"error",category:"security",message:"Rule permits any to any traffic",suggestion:"Restrict source and destination addresses"})}),s},mc=t=>{const s=[];return s.push({id:"sec-ssh-001",name:"SSH Access Restriction",description:"SSH should not be open to 0.0.0.0/0",category:"exposure",status:Ve.openSSH.test(t)?"fail":"pass",severity:"error",details:Ve.openSSH.test(t)?"SSH (port 22) is exposed to the internet":void 0}),s.push({id:"sec-rdp-001",name:"RDP Access Restriction",description:"RDP should not be open to 0.0.0.0/0",category:"exposure",status:Ve.openRDP.test(t)?"fail":"pass",severity:"error",details:Ve.openRDP.test(t)?"RDP (port 3389) is exposed to the internet":void 0}),s.push({id:"sec-db-001",name:"Database Port Restriction",description:"Database ports should not be publicly accessible",category:"exposure",status:Ve.openDatabase.test(t)?"fail":"pass",severity:"error",details:Ve.openDatabase.test(t)?"Database ports exposed to the internet":void 0}),s.push({id:"sec-src-001",name:"Source Address Scope",description:"Avoid using any/0.0.0.0/0 as source when possible",category:"access",status:Ve.anySource.test(t)?"warning":"pass",severity:"warning",details:Ve.anySource.test(t)?"Rules with overly permissive source addresses found":void 0}),s.push({id:"sec-proto-001",name:"Secure Protocol Usage",description:"Avoid using insecure protocols like Telnet, FTP",category:"compliance",status:Ve.insecureProtocol.test(t)?"warning":"pass",severity:"warning",details:Ve.insecureProtocol.test(t)?"Insecure protocols detected":void 0}),s.push({id:"sec-port-001",name:"Port Range Restriction",description:"Avoid opening all ports (0-65535)",category:"access",status:Ve.widePortRange.test(t)?"warning":"pass",severity:"warning",details:Ve.widePortRange.test(t)?"Wide port ranges detected":void 0}),s},jx=(t,s)=>{const a=t.filter(u=>u.category==="syntax"),r=a.filter(u=>u.severity==="error").length,n=a.filter(u=>u.severity==="warning").length,i=Math.max(0,100-r*20-n*5),o=s.filter(u=>u.status==="fail").length,l=s.filter(u=>u.status==="warning").length,c=Math.max(0,100-o*25-l*10),d=t.filter(u=>u.category==="compliance").length,h=Math.max(0,100-d*15);return{syntaxScore:i,securityScore:c,complianceScore:h}},z0=()=>{const t=new Map;qi.validations.forEach(r=>{const n=r.platform.toLowerCase();t.has(n)||t.set(n,[]),t.get(n).push(r)});const s=[];let a=0;return t.forEach((r,n)=>{const i=r.filter(l=>l.status==="FAIL").length,o=r.filter(l=>l.status==="WARNING").length;s.push({id:`vh-real-${a++}`,timestamp:r[0].validation_timestamp,platform:n,ruleCount:r.length,issueCount:i+o,isValid:i===0,snippet:`${r.length} rules validated for ${n.toUpperCase()}`})}),s};let Yn=z0();const ps={async validateRules(t,s){if(await us(800),!s.trim())return{isValid:!1,platform:t,issues:[{id:"empty-1",line:1,severity:"error",category:"syntax",message:"No rule content provided",suggestion:"Enter firewall rules to validate"}],syntaxScore:0,securityScore:0,complianceScore:0};let a=[];switch(t){case"aws":a=vx(s);break;case"azure":a=yx(s);break;case"gcp":a=bx(s);break;case"iptables":a=_x(s);break;case"cisco_asa":a=wx(s);break;default:s.length<10&&a.push({id:"gen-1",line:1,severity:"warning",category:"syntax",message:"Rule content appears incomplete"})}const r=mc(s);r.filter(c=>c.status==="fail"||c.status==="warning").forEach((c,d)=>{a.push({id:`sec-${d}`,line:0,severity:c.severity,category:"security",message:c.details||c.description,ruleId:c.id})});const{syntaxScore:n,securityScore:i,complianceScore:o}=jx(a,r),l=a.some(c=>c.severity==="error");return Yn.unshift({id:`vh-${Date.now()}`,timestamp:new Date().toISOString(),platform:t,ruleCount:s.split(`
`).filter(c=>c.trim()&&!c.trim().startsWith("#")&&!c.trim().startsWith("!")).length,issueCount:a.length,isValid:!l,snippet:s.substring(0,50)+"..."}),{isValid:!l,platform:t,issues:a,syntaxScore:n,securityScore:i,complianceScore:o}},async runSecurityAnalysis(t){return await us(500),mc(t)},async getValidationHistory(){return await us(300),Yn.slice(0,10)},async clearHistory(){await us(200),Yn=z0()},async getPreValidatedRules(){return await us(300),qi.validations},async getValidationSummary(){return await us(200),qi.validation_summary}},Nx=[{analysis_id:"PATH-0001",analysis_timestamp:"2026-01-13T10:30:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-002 allows TCP/5432 to sg-database-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic to 10.0.0.0/8",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC routing",latency_ms:.2},{hop_number:4,component:"acl-prod-database",component_id:"acl-0a1b2c3d4e5f00003",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/5432 from 10.30.0.0/16",latency_ms:.1},{hop_number:5,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-101 allows TCP/5432 from sg-webapp-prod",latency_ms:.1},{hop_number:6,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Destination reached - PostgreSQL listening on port 5432",latency_ms:.2}]},{analysis_id:"PATH-0002",analysis_timestamp:"2026-01-13T10:31:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Internet",source_ip:"0.0.0.0/0",source_type:"External",source_vpc:null,destination:"webapp-prod-1",destination_ip:"10.30.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:8,path_latency_ms:15.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"cloudflare-edge",component_id:"cf-edge-iad-01",type:"CDN",direction:"Inbound",decision:"FORWARD",details:"Cloudflare edge node - WAF rules passed",latency_ms:5},{hop_number:2,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC via Internet Gateway",latency_ms:2},{hop_number:3,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/443 from 0.0.0.0/0",latency_ms:.1},{hop_number:4,component:"sg-alb-public",component_id:"sg-0a1b2c3d4e5f00005",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows HTTPS from Cloudflare IPs",latency_ms:.1},{hop_number:5,component:"prod-alb",component_id:"arn:aws:elasticloadbalancing:...",type:"Load Balancer",direction:"Forward",decision:"FORWARD",details:"ALB routes to target group tg-webapp-prod",latency_ms:3},{hop_number:6,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:7,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows TCP/8080 from sg-alb-public",latency_ms:.1},{hop_number:8,component:"webapp-prod-1",component_id:"i-0abc123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Destination reached - Application listening on port 8080",latency_ms:5.1}]},{analysis_id:"PATH-0003",analysis_timestamp:"2026-01-13T10:32:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"198.51.100.50",source_type:"External",source_vpc:null,destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"acl-prod-database",blocking_reason:"No route from internet to private database subnet"},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:null},{hop_number:2,component:"rtb-public",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"No direct route to 10.40.0.0/16 from public subnet",latency_ms:null},{hop_number:3,component:"acl-prod-database",component_id:"acl-0a1b2c3d4e5f00003",type:"Network ACL",direction:"Inbound",decision:"BLOCKED",details:"Rule 200 denies all traffic from 0.0.0.0/0 - Database isolated from internet",latency_ms:null}]},{analysis_id:"PATH-0004",analysis_timestamp:"2026-01-13T10:33:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"api-prod-1",source_ip:"10.31.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"api.stripe.com",destination_ip:"52.4.128.0",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:25.3,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-api-gateway",component_id:"sg-0a1b2c3d4e5f00006",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 110 allows TCP/443 outbound",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via nat-0a1b2c3d4e5f00001",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP 54.123.45.67",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"api.stripe.com",component_id:"52.4.128.0",type:"Destination",direction:"N/A",decision:"REACHED",details:"External destination reached via internet",latency_ms:21.8}]},{analysis_id:"PATH-0005",analysis_timestamp:"2026-01-13T10:34:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"dr-postgres-primary",destination_ip:"10.120.1.10",destination_type:"EC2",destination_vpc:"vpc-dr-east-1",protocol:"TCP",port:5432},summary:{total_hops:9,path_latency_ms:12.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows TCP/5432 to 10.120.0.0/16",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.120.0.0/16 via tgw-0a1b2c3d4e5f00001",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-prod",component_id:"tgw-attach-vpc-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic enters Transit Gateway from Production VPC",latency_ms:1},{hop_number:5,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.120.0.0/16 to tgw-attach-vpc-dr",latency_ms:.5},{hop_number:6,component:"tgw-attach-vpc-dr",component_id:"tgw-attach-vpc-dr",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to DR VPC",latency_ms:1},{hop_number:7,component:"acl-dr-database",component_id:"acl-dr-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/5432 from 10.0.0.0/8",latency_ms:.1},{hop_number:8,component:"sg-dr-database",component_id:"sg-dr-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows replication from production",latency_ms:.1},{hop_number:9,component:"dr-postgres-primary",component_id:"i-dr-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"DR database reached for replication",latency_ms:9.4}]},{analysis_id:"PATH-0006",analysis_timestamp:"2026-01-13T10:35:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vpn-user-laptop",source_ip:"10.100.50.25",source_type:"VPN Client",source_vpc:null,destination:"grafana-1",destination_ip:"10.50.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:3e3},summary:{total_hops:8,path_latency_ms:35.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"vpn-endpoint",component_id:"vpn-0abc123def456789",type:"VPN Gateway",direction:"Inbound",decision:"ALLOW",details:"VPN authenticated user - MFA verified",latency_ms:15},{hop_number:2,component:"tgw-attach-vpn-dc",component_id:"tgw-attach-vpn-dc",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"VPN traffic enters via Transit Gateway",latency_ms:2},{hop_number:3,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.50.0.0/24 to tgw-attach-vpc-prod",latency_ms:.5},{hop_number:4,component:"tgw-attach-vpc-prod",component_id:"tgw-attach-vpc-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to Production VPC",latency_ms:1},{hop_number:5,component:"rtb-tgw-subnet",component_id:"rtb-0a1b2c3d4e5f00005",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.50.0.0/24 via local",latency_ms:.2},{hop_number:6,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/3000 from 10.100.0.0/16",latency_ms:.1},{hop_number:7,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows Grafana from VPN",latency_ms:.1},{hop_number:8,component:"grafana-1",component_id:"i-0mon123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Grafana dashboard accessible",latency_ms:16.3}]},{analysis_id:"PATH-0007",analysis_timestamp:"2026-01-13T10:36:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"dev-server-1",source_ip:"10.100.5.10",source_type:"EC2",source_vpc:"vpc-dev-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"tgw-rtb-dev",blocking_reason:"Blackhole route prevents dev-to-prod database access"},hops:[{hop_number:1,component:"sg-dev-server",component_id:"sg-dev-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows all traffic",latency_ms:null},{hop_number:2,component:"rtb-dev-private",component_id:"rtb-dev-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via Transit Gateway",latency_ms:null},{hop_number:3,component:"tgw-attach-vpc-dev",component_id:"tgw-attach-vpc-dev",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic enters Transit Gateway",latency_ms:null},{hop_number:4,component:"tgw-rtb-dev",component_id:"tgw-rtb-dev",type:"Transit Gateway Route Table",direction:"Forward",decision:"BLOCKED",details:"Blackhole route for 10.0.0.0/8 - Dev isolated from production",latency_ms:null},{hop_number:5,component:"N/A",component_id:null,type:"Blackhole",direction:"N/A",decision:"DROPPED",details:"Traffic dropped by blackhole route - Environment isolation enforced",latency_ms:null}]},{analysis_id:"PATH-0008",analysis_timestamp:"2026-01-13T10:37:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"eks-node-1",source_ip:"10.60.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"ECR",destination_ip:"vpce-ecr",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.1,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-eks-nodes",component_id:"sg-0a1b2c3d4e5f00009",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to VPC endpoints",latency_ms:.1},{hop_number:2,component:"acl-eks-nodes",component_id:"acl-0a1b2c3d4e5f00007",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-eks-private",component_id:"rtb-0a1b2c3d4e5f00003",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to ECR endpoint via pl-ecr prefix list",latency_ms:.2},{hop_number:4,component:"vpce-ecr-api",component_id:"vpce-0a1b2c3d4e5f00001",type:"VPC Endpoint",direction:"Forward",decision:"FORWARD",details:"PrivateLink endpoint for ECR API",latency_ms:1.5},{hop_number:5,component:"ECR",component_id:"ecr.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"ECR service reached via PrivateLink",latency_ms:.2}]},{analysis_id:"PATH-0009",analysis_timestamp:"2026-01-13T10:38:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"redis-prod-cluster",destination_ip:"10.35.1.10",destination_type:"ElastiCache",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:6379},summary:{total_hops:5,path_latency_ms:.6,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-003 allows TCP/6379 to sg-redis-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.35.0.0/24 via local",latency_ms:.1},{hop_number:4,component:"sg-redis-prod",component_id:"sg-0a1b2c3d4e5f00003",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-201 allows TCP/6379 from sg-webapp-prod",latency_ms:.1},{hop_number:5,component:"redis-prod-cluster",component_id:"elasticache-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Redis cluster endpoint reached",latency_ms:.2}]},{analysis_id:"PATH-0010",analysis_timestamp:"2026-01-13T10:39:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"on-prem-dc-server",source_ip:"172.16.10.50",source_type:"On-Premises",source_vpc:null,destination:"shared-services-dns",destination_ip:"10.200.1.10",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"UDP",port:53},summary:{total_hops:7,path_latency_ms:18.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"dc-router",component_id:"router-dc-01",type:"On-Premises Router",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via VPN tunnel",latency_ms:1},{hop_number:2,component:"vpn-tunnel-1",component_id:"vpn-tun-0abc123",type:"VPN Tunnel",direction:"Forward",decision:"FORWARD",details:"IPSec tunnel to AWS - encrypted",latency_ms:8},{hop_number:3,component:"vgw-prod",component_id:"vgw-0a1b2c3d4e5f00001",type:"Virtual Private Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters AWS via VPN Gateway",latency_ms:1},{hop_number:4,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 to tgw-attach-vpc-shared",latency_ms:.5},{hop_number:5,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to Shared Services VPC",latency_ms:1},{hop_number:6,component:"sg-shared-dns",component_id:"sg-shared-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound allows UDP/53 from 172.16.0.0/12",latency_ms:.1},{hop_number:7,component:"shared-services-dns",component_id:"i-shared-dns-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"DNS server reached",latency_ms:6.9}]},{analysis_id:"PATH-0011",analysis_timestamp:"2026-01-13T10:40:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vm-webapp-prod-1",source_ip:"10.30.1.20",source_type:"Azure VM",source_vpc:"vnet-prod-eastus",destination:"postgres-flex-server",destination_ip:"10.40.1.20",destination_type:"Azure PostgreSQL",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:5432},summary:{total_hops:6,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"nsg-webapp-prod",component_id:"/subscriptions/.../nsg-webapp-prod",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Rule Allow-SQL-to-Database (priority 110) allows TCP/5432",latency_ms:.1},{hop_number:2,component:"udr-webapp-subnet",component_id:"/subscriptions/.../udr-webapp",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/24 via VNet local routing",latency_ms:.2},{hop_number:3,component:"snet-webapp-prod",component_id:"/subscriptions/.../snet-webapp-prod",type:"Subnet",direction:"Forward",decision:"ROUTE",details:"Subnet routing to database subnet",latency_ms:.1},{hop_number:4,component:"snet-database-prod",component_id:"/subscriptions/.../snet-database-prod",type:"Subnet",direction:"Inbound",decision:"ROUTE",details:"Traffic enters database subnet",latency_ms:.1},{hop_number:5,component:"nsg-database-prod",component_id:"/subscriptions/.../nsg-database-prod",type:"Network Security Group",direction:"Inbound",decision:"ALLOW",details:"Rule Allow-WebApp-to-SQL (priority 100) with ASG reference",latency_ms:.1},{hop_number:6,component:"postgres-flex-server",component_id:"/subscriptions/.../postgres-flex",type:"Destination",direction:"N/A",decision:"REACHED",details:"Azure PostgreSQL Flexible Server reached via private endpoint",latency_ms:.6}]},{analysis_id:"PATH-0012",analysis_timestamp:"2026-01-13T10:41:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vm-webapp-prod-1",source_ip:"10.30.1.20",source_type:"Azure VM",source_vpc:"vnet-prod-eastus",destination:"storage-account-prod",destination_ip:"Storage Service Tag",destination_type:"Azure Storage",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"nsg-webapp-prod",component_id:"/subscriptions/.../nsg-webapp-prod",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Rule Allow-Storage-Outbound (priority 130) allows to Storage service tag",latency_ms:.1},{hop_number:2,component:"udr-webapp-subnet",component_id:"/subscriptions/.../udr-webapp",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to Microsoft.Storage service endpoint",latency_ms:.2},{hop_number:3,component:"snet-webapp-prod-service-endpoint",component_id:"Microsoft.Storage",type:"Service Endpoint",direction:"Forward",decision:"FORWARD",details:"Service endpoint for Azure Storage - traffic stays on Azure backbone",latency_ms:.5},{hop_number:4,component:"storage-firewall",component_id:"storage-acl-prod",type:"Storage Firewall",direction:"Inbound",decision:"ALLOW",details:"Storage firewall allows access from snet-webapp-prod",latency_ms:.2},{hop_number:5,component:"storage-account-prod",component_id:"/subscriptions/.../storageAccounts/prodsa001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Azure Storage account reached via service endpoint",latency_ms:1.5}]},{analysis_id:"PATH-0013",analysis_timestamp:"2026-01-13T10:42:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"aks-pod-webapp",source_ip:"10.60.5.25",source_type:"AKS Pod",source_vpc:"vnet-prod-eastus",destination:"key-vault-prod",destination_ip:"10.50.1.5",destination_type:"Azure Key Vault",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:443},summary:{total_hops:6,path_latency_ms:3.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"aks-network-policy",component_id:"netpol-webapp-egress",type:"Network Policy",direction:"Outbound",decision:"ALLOW",details:"Kubernetes NetworkPolicy allows egress to Key Vault CIDR",latency_ms:.1},{hop_number:2,component:"nsg-aks-nodes",component_id:"/subscriptions/.../nsg-aks-nodes",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound to AzureKeyVault service tag allowed",latency_ms:.1},{hop_number:3,component:"udr-aks-subnet",component_id:"/subscriptions/.../udr-aks",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to Key Vault private endpoint",latency_ms:.2},{hop_number:4,component:"pep-keyvault-prod",component_id:"/subscriptions/.../privateEndpoints/pep-kv",type:"Private Endpoint",direction:"Forward",decision:"FORWARD",details:"Traffic routed via Private Endpoint",latency_ms:1},{hop_number:5,component:"kv-firewall",component_id:"key-vault-firewall",type:"Key Vault Firewall",direction:"Inbound",decision:"ALLOW",details:"Key Vault allows access from private endpoint",latency_ms:.3},{hop_number:6,component:"key-vault-prod",component_id:"/subscriptions/.../vaults/kv-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Key Vault reached via private endpoint",latency_ms:1.5}]},{analysis_id:"PATH-0014",analysis_timestamp:"2026-01-13T10:43:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"vm-dev-server",source_ip:"10.100.5.20",source_type:"Azure VM",source_vpc:"vnet-dev-eastus",destination:"vm-webapp-prod-1",destination_ip:"10.30.1.20",destination_type:"Azure VM",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:22},summary:{total_hops:4,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"azfw-prod-hub",blocking_reason:"Azure Firewall blocks dev-to-prod SSH access"},hops:[{hop_number:1,component:"nsg-dev-server",component_id:"/subscriptions/.../nsg-dev",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Default outbound allow",latency_ms:null},{hop_number:2,component:"udr-dev-subnet",component_id:"/subscriptions/.../udr-dev",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via Azure Firewall",latency_ms:null},{hop_number:3,component:"azfw-prod-hub",component_id:"/subscriptions/.../azfw-prod-hub",type:"Azure Firewall",direction:"Forward",decision:"BLOCKED",details:"Network rule collection rc-deny-dev-prod blocks dev-to-prod access",latency_ms:null},{hop_number:4,component:"N/A",component_id:null,type:"Firewall Block",direction:"N/A",decision:"DROPPED",details:"Traffic dropped by Azure Firewall - Environment isolation",latency_ms:null}]},{analysis_id:"PATH-0015",analysis_timestamp:"2026-01-13T10:44:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gce-webapp-1",source_ip:"10.30.1.30",source_type:"GCE Instance",source_vpc:"vpc-production",destination:"cloudsql-postgres",destination_ip:"10.40.1.30",destination_type:"Cloud SQL",destination_vpc:"vpc-production",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-db-from-app-postgres",component_id:"projects/.../firewalls/allow-db-from-app-postgres",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress allowed - no explicit deny rule",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/default-route",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to Cloud SQL private IP via VPC peering",latency_ms:.2},{hop_number:3,component:"servicenetworking-peering",component_id:"servicenetworking-googleapis-com",type:"VPC Peering",direction:"Forward",decision:"FORWARD",details:"Traffic enters Google-managed VPC for Cloud SQL",latency_ms:.5},{hop_number:4,component:"allow-db-from-app-postgres",component_id:"projects/.../firewalls/allow-db-from-app-postgres",type:"GCP Firewall Rule",direction:"Ingress",decision:"ALLOW",details:"Source tag app-server matches, TCP/5432 allowed",latency_ms:.1},{hop_number:5,component:"cloudsql-postgres",component_id:"projects/.../instances/cloudsql-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Cloud SQL instance reached via private IP",latency_ms:.6}]},{analysis_id:"PATH-0016",analysis_timestamp:"2026-01-13T10:45:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gke-node-1",source_ip:"10.60.1.30",source_type:"GKE Node",source_vpc:"vpc-production",destination:"gcr.io",destination_ip:"199.36.153.4",destination_type:"Google Container Registry",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:5.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-gke-egress",component_id:"projects/.../firewalls/allow-gke-egress",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress to Google APIs allowed",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/default-internet-gateway",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to private.googleapis.com via Private Google Access",latency_ms:.2},{hop_number:3,component:"private-google-access",component_id:"private.googleapis.com",type:"Private Google Access",direction:"Forward",decision:"FORWARD",details:"Traffic routed to Google APIs without public IP",latency_ms:2},{hop_number:4,component:"cloud-nat",component_id:"projects/.../routers/cloud-nat-prod",type:"Cloud NAT",direction:"Forward",decision:"NAT",details:"Cloud NAT not needed - using Private Google Access",latency_ms:0},{hop_number:5,component:"gcr.io",component_id:"gcr.io",type:"Destination",direction:"N/A",decision:"REACHED",details:"Google Container Registry reached via Private Google Access",latency_ms:2.9}]},{analysis_id:"PATH-0017",analysis_timestamp:"2026-01-13T10:46:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gce-webapp-1",source_ip:"10.30.1.30",source_type:"GCE Instance",source_vpc:"vpc-production",destination:"memorystore-redis",destination_ip:"10.35.1.30",destination_type:"Memorystore",destination_vpc:"vpc-production",protocol:"TCP",port:6379},summary:{total_hops:4,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-redis-from-app",component_id:"projects/.../firewalls/allow-redis-from-app",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress allowed - implicit allow",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/peering-memorystore",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to Memorystore via VPC peering",latency_ms:.2},{hop_number:3,component:"allow-redis-from-app",component_id:"projects/.../firewalls/allow-redis-from-app",type:"GCP Firewall Rule",direction:"Ingress",decision:"ALLOW",details:"Source tags app-server,web-server match, TCP/6379 allowed",latency_ms:.1},{hop_number:4,component:"memorystore-redis",component_id:"projects/.../instances/redis-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Memorystore Redis instance reached",latency_ms:.4}]},{analysis_id:"PATH-0018",analysis_timestamp:"2026-01-13T10:47:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"198.51.100.100",source_type:"External",source_vpc:null,destination:"gce-webapp-1",destination_ip:"10.30.1.30",destination_type:"GCE Instance",destination_vpc:"vpc-production",protocol:"TCP",port:22},summary:{total_hops:2,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"deny-ssh-public",blocking_reason:"SSH from internet blocked - use IAP instead"},hops:[{hop_number:1,component:"cloud-armor",component_id:"projects/.../securityPolicies/web-protection",type:"Cloud Armor",direction:"Inbound",decision:"ALLOW",details:"Cloud Armor not blocking this IP",latency_ms:null},{hop_number:2,component:"deny-ssh-public",component_id:"projects/.../firewalls/deny-ssh-public",type:"GCP Firewall Rule",direction:"Ingress",decision:"BLOCKED",details:"Priority 2000 deny rule blocks TCP/22 from 0.0.0.0/0",latency_ms:null}]},{analysis_id:"PATH-0019",analysis_timestamp:"2026-01-13T10:48:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Untrust-Zone",source_ip:"203.0.113.50",source_type:"External",source_vpc:null,destination:"webapp-prod-1-pa",destination_ip:"10.30.1.40",destination_type:"Server",destination_vpc:"DMZ",protocol:"TCP",port:443},summary:{total_hops:6,path_latency_ms:8.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"pa-external-interface",component_id:"ethernet1/1",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters Untrust zone",latency_ms:.5},{hop_number:2,component:"Block-Malicious-IPs-Inbound",component_id:"rule-50",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Source IP not in EDL-Malicious-IPs",latency_ms:.2},{hop_number:3,component:"Allow-API-Gateway-Inbound",component_id:"rule-1",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: Untrust->DMZ, ssl app, AG-Web-Servers dest",latency_ms:.3},{hop_number:4,component:"Web-Protection-Profile",component_id:"profile-group-web",type:"Security Profile",direction:"Forward",decision:"ALLOW",details:"AV: Clean, AS: Clean, VP: No vulnerabilities, URL: Allowed",latency_ms:2},{hop_number:5,component:"pa-dmz-interface",component_id:"ethernet1/3",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to DMZ zone",latency_ms:.5},{hop_number:6,component:"webapp-prod-1-pa",component_id:"10.30.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"Web server in DMZ reached",latency_ms:5}]},{analysis_id:"PATH-0020",analysis_timestamp:"2026-01-13T10:49:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"app-server-1-pa",source_ip:"10.31.1.40",source_type:"Server",source_vpc:"Application",destination:"db-server-1-pa",destination_ip:"10.40.1.40",destination_type:"Server",destination_vpc:"Database",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"pa-app-interface",component_id:"ethernet1/8",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters from Application zone",latency_ms:.1},{hop_number:2,component:"Allow-App-to-DB-Postgres",component_id:"rule-3",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: Application->Database, postgres app, AG-Database-Servers dest",latency_ms:.2},{hop_number:3,component:"Database-Protection-Profile",component_id:"profile-group-db",type:"Security Profile",direction:"Forward",decision:"ALLOW",details:"AV: Clean, AS: Clean, VP: No SQL injection detected",latency_ms:.3},{hop_number:4,component:"pa-db-interface",component_id:"ethernet1/10",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to Database zone",latency_ms:.1},{hop_number:5,component:"db-server-1-pa",component_id:"10.40.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"PostgreSQL server reached",latency_ms:.5}]},{analysis_id:"PATH-0021",analysis_timestamp:"2026-01-13T10:50:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Untrust-Zone",source_ip:"185.220.101.50",source_type:"Tor Exit Node",source_vpc:null,destination:"webapp-prod-1-pa",destination_ip:"10.30.1.40",destination_type:"Server",destination_vpc:"DMZ",protocol:"TCP",port:443},summary:{total_hops:2,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"Block-Tor-Exit-Nodes",blocking_reason:"Source IP in Tor Exit Node EDL - blocked by security policy"},hops:[{hop_number:1,component:"pa-external-interface",component_id:"ethernet1/1",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters Untrust zone",latency_ms:null},{hop_number:2,component:"Block-Tor-Exit-Nodes",component_id:"rule-51",type:"Palo Alto Security Rule",direction:"Forward",decision:"BLOCKED",details:"Source 185.220.101.50 matches EDL-Tor-Exit-Nodes - DENY action",latency_ms:null}]},{analysis_id:"PATH-0022",analysis_timestamp:"2026-01-13T10:51:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vpn-user-pa",source_ip:"10.100.50.60",source_type:"VPN User",source_vpc:"VPN",destination:"grafana-pa",destination_ip:"10.50.1.40",destination_type:"Server",destination_vpc:"Trust",protocol:"TCP",port:3e3},summary:{total_hops:5,path_latency_ms:2.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"globalprotect-gateway",component_id:"gp-gateway-1",type:"GlobalProtect Gateway",direction:"Inbound",decision:"ALLOW",details:"VPN user authenticated - MFA verified",latency_ms:.5},{hop_number:2,component:"pa-vpn-interface",component_id:"tunnel.1",type:"Palo Alto Tunnel Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPN zone",latency_ms:.2},{hop_number:3,component:"Allow-Grafana-VPN",component_id:"rule-10",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: VPN->Trust, web-browsing app, AG-Monitoring-Servers dest",latency_ms:.3},{hop_number:4,component:"pa-trust-interface",component_id:"ethernet1/5",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to Trust zone",latency_ms:.2},{hop_number:5,component:"grafana-pa",component_id:"10.50.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"Grafana server reached via VPN",latency_ms:1.3}]},{analysis_id:"PATH-0023",analysis_timestamp:"2026-01-13T10:52:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"kafka-broker-1",destination_ip:"10.36.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9092},summary:{total_hops:5,path_latency_ms:.9,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-004 allows TCP/9092 to sg-kafka-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.36.0.0/24 via local VPC routing",latency_ms:.2},{hop_number:4,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-301 allows TCP/9092 from sg-webapp-prod",latency_ms:.1},{hop_number:5,component:"kafka-broker-1",component_id:"i-0kf123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Kafka broker reached - topic access granted",latency_ms:.4}]},{analysis_id:"PATH-0024",analysis_timestamp:"2026-01-13T10:53:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"prometheus-1",source_ip:"10.50.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"webapp-prod-1",destination_ip:"10.30.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9100},summary:{total_hops:5,path_latency_ms:.7,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-701 allows TCP/9100 to 10.0.0.0/8",latency_ms:.1},{hop_number:2,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic to VirtualNetwork",latency_ms:.1},{hop_number:3,component:"rtb-monitoring",component_id:"rtb-0a1b2c3d4e5f00006",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.30.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-005 allows TCP/9100 from sg-monitoring",latency_ms:.1},{hop_number:5,component:"webapp-prod-1",component_id:"i-0abc123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Node exporter metrics endpoint accessible",latency_ms:.2}]},{analysis_id:"PATH-0025",analysis_timestamp:"2026-01-13T10:54:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"jenkins-master",source_ip:"10.70.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"github.com",destination_ip:"140.82.112.4",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:45.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-jenkins",component_id:"sg-0a1b2c3d4e5f00011",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1001 allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-cicd",component_id:"acl-0a1b2c3d4e5f00008",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:3,component:"rtb-cicd",component_id:"rtb-0a1b2c3d4e5f00008",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via nat-0a1b2c3d4e5f00002",latency_ms:.2},{hop_number:4,component:"nat-prod-1b",component_id:"nat-0a1b2c3d4e5f00002",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP 54.123.45.68",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"github.com",component_id:"140.82.112.4",type:"Destination",direction:"N/A",decision:"REACHED",details:"GitHub API accessible",latency_ms:41.7}]},{analysis_id:"PATH-0026",analysis_timestamp:"2026-01-13T10:55:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vault-1",source_ip:"10.90.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"DynamoDB",destination_ip:"vpce-dynamodb",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1202 allows HTTPS to pl-dynamodb",latency_ms:.1},{hop_number:2,component:"acl-vault",component_id:"acl-0a1b2c3d4e5f00009",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-vault",component_id:"rtb-0a1b2c3d4e5f00009",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to DynamoDB endpoint via pl-dynamodb prefix list",latency_ms:.2},{hop_number:4,component:"vpce-dynamodb",component_id:"vpce-0a1b2c3d4e5f00002",type:"VPC Gateway Endpoint",direction:"Forward",decision:"FORWARD",details:"Gateway endpoint for DynamoDB",latency_ms:1.5},{hop_number:5,component:"DynamoDB",component_id:"dynamodb.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"DynamoDB service reached via gateway endpoint",latency_ms:.9}]},{analysis_id:"PATH-0027",analysis_timestamp:"2026-01-13T10:56:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"splunk-indexer-1",source_ip:"10.80.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"S3",destination_ip:"vpce-s3",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:3.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1101 allows HTTPS to pl-63a5400a (S3)",latency_ms:.1},{hop_number:2,component:"acl-splunk",component_id:"acl-0a1b2c3d4e5f00010",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic",latency_ms:.1},{hop_number:3,component:"rtb-splunk",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to S3 endpoint via pl-63a5400a prefix list",latency_ms:.2},{hop_number:4,component:"vpce-s3",component_id:"vpce-0a1b2c3d4e5f00003",type:"VPC Gateway Endpoint",direction:"Forward",decision:"FORWARD",details:"Gateway endpoint for S3",latency_ms:2},{hop_number:5,component:"S3",component_id:"s3.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"S3 service reached for log archival",latency_ms:1.1}]},{analysis_id:"PATH-0028",analysis_timestamp:"2026-01-13T10:57:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"prod-west-webapp",source_ip:"10.130.1.10",source_type:"EC2",source_vpc:"vpc-prod-west-2",destination:"shared-services-dns",destination_ip:"10.200.1.10",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"UDP",port:53},summary:{total_hops:10,path_latency_ms:65.5,path_status:"REACHABLE",bottlenecks:["Cross-region latency: 55ms"]},hops:[{hop_number:1,component:"sg-webapp-west",component_id:"sg-west-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows UDP/53",latency_ms:.1},{hop_number:2,component:"acl-prod-west",component_id:"acl-west-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal",latency_ms:.1},{hop_number:3,component:"rtb-prod-west",component_id:"rtb-west-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via tgw-west",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-prod-west",component_id:"tgw-attach-west-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Enters West region TGW",latency_ms:1},{hop_number:5,component:"tgw-rtb-west",component_id:"tgw-rtb-west",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via cross-region peering",latency_ms:.5},{hop_number:6,component:"tgw-peer-west-east",component_id:"tgw-peer-east-west",type:"Transit Gateway Peering",direction:"Forward",decision:"FORWARD",details:"Cross-region peering us-west-2 to us-east-1",latency_ms:55},{hop_number:7,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 to shared services",latency_ms:.5},{hop_number:8,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Exits to Shared Services VPC",latency_ms:1},{hop_number:9,component:"sg-shared-dns",component_id:"sg-shared-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows UDP/53 from 10.0.0.0/8",latency_ms:.1},{hop_number:10,component:"shared-services-dns",component_id:"i-shared-dns-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"DNS server reached via cross-region path",latency_ms:7}]},{analysis_id:"PATH-0029",analysis_timestamp:"2026-01-13T10:58:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"analytics-1",source_ip:"10.95.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"es-data-1",destination_ip:"10.85.1.20",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9200},summary:{total_hops:5,path_latency_ms:1.1,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-analytics-prod",component_id:"sg-0a1b2c3d4e5f00015",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1404 allows TCP/9200 to sg-elasticsearch",latency_ms:.1},{hop_number:2,component:"acl-analytics",component_id:"acl-0a1b2c3d4e5f00011",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-analytics",component_id:"rtb-0a1b2c3d4e5f00011",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.85.0.0/24 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows TCP/9200 from analytics SG",latency_ms:.1},{hop_number:5,component:"es-data-1",component_id:"i-0es123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Elasticsearch data node reached",latency_ms:.6}]},{analysis_id:"PATH-0030",analysis_timestamp:"2026-01-13T10:59:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"cryptomining-pool.io",destination_ip:"203.0.113.200",destination_type:"External",destination_vpc:null,protocol:"TCP",port:3333},summary:{total_hops:4,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"Block-Crypto-Mining-PA",blocking_reason:"Destination in crypto mining EDL - blocked by Palo Alto"},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"No specific deny for this port",latency_ms:null},{hop_number:2,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to internet via Palo Alto firewall",latency_ms:null},{hop_number:3,component:"pa-fw-prod-01",component_id:"pa-fw-prod-01",type:"Palo Alto Firewall",direction:"Forward",decision:"INSPECT",details:"Traffic enters firewall for inspection",latency_ms:null},{hop_number:4,component:"Block-Crypto-Mining",component_id:"rule-52",type:"Palo Alto Security Rule",direction:"Forward",decision:"BLOCKED",details:"Destination 203.0.113.200 matches EDL-Crypto-Mining-Pools - DENY action with alert",latency_ms:null}]},{analysis_id:"PATH-0031",analysis_timestamp:"2026-01-13T11:00:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"pci-webapp-1",source_ip:"10.150.1.10",source_type:"EC2",source_vpc:"vpc-pci-east-1",destination:"shared-services-vault",destination_ip:"10.200.1.50",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"TCP",port:8200},summary:{total_hops:8,path_latency_ms:4.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-pci-webapp",component_id:"sg-pci-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows TCP/8200 to shared services",latency_ms:.1},{hop_number:2,component:"acl-pci-app",component_id:"acl-pci-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows traffic to 10.200.0.0/16",latency_ms:.1},{hop_number:3,component:"rtb-pci-private",component_id:"rtb-pci-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via Transit Gateway",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-pci",component_id:"tgw-attach-vpc-pci",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Enters TGW from PCI VPC",latency_ms:1},{hop_number:5,component:"tgw-rtb-isolated",component_id:"tgw-rtb-isolated",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Isolated route table - only shared services allowed",latency_ms:.5},{hop_number:6,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Exits to Shared Services VPC",latency_ms:1},{hop_number:7,component:"sg-shared-vault",component_id:"sg-shared-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows TCP/8200 from PCI VPC CIDR",latency_ms:.1},{hop_number:8,component:"shared-services-vault",component_id:"i-shared-vault-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Vault server reached for secrets retrieval",latency_ms:1.5}]},{analysis_id:"PATH-0032",analysis_timestamp:"2026-01-13T11:01:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"api-prod-1",source_ip:"10.31.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"okta.com",destination_ip:"54.201.45.67",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:35.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-api-gateway",component_id:"sg-0a1b2c3d4e5f00006",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 110 allows TCP/443 outbound",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via NAT Gateway",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"okta.com",component_id:"54.201.45.67",type:"Destination",direction:"N/A",decision:"REACHED",details:"Okta SSO endpoint reached for authentication",latency_ms:32.3}]},{analysis_id:"PATH-0033",analysis_timestamp:"2026-01-13T11:02:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"bastion-prod",source_ip:"10.20.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:22},summary:{total_hops:5,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-bastion",component_id:"sg-0a1b2c3d4e5f00007",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-601 allows SSH to 10.0.0.0/8",latency_ms:.1},{hop_number:2,component:"acl-bastion",component_id:"acl-0a1b2c3d4e5f00012",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-bastion",component_id:"rtb-0a1b2c3d4e5f00012",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-104 allows SSH from sg-bastion",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Database server SSH accessible from bastion",latency_ms:.3}]},{analysis_id:"PATH-0034",analysis_timestamp:"2026-01-13T11:03:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"eks-node-1",source_ip:"10.60.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"eks-control-plane",destination_ip:"10.60.0.5",destination_type:"EKS API",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:4,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-eks-nodes",component_id:"sg-0a1b2c3d4e5f00009",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-804 allows TCP/443 to sg-eks-control",latency_ms:.1},{hop_number:2,component:"rtb-eks-private",component_id:"rtb-0a1b2c3d4e5f00003",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to EKS control plane ENI",latency_ms:.2},{hop_number:3,component:"sg-eks-control",component_id:"sg-0a1b2c3d4e5f00010",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-902 allows TCP/443 from sg-eks-nodes",latency_ms:.1},{hop_number:4,component:"eks-control-plane",component_id:"arn:aws:eks:...",type:"Destination",direction:"N/A",decision:"REACHED",details:"EKS API server reached for kubelet communication",latency_ms:.8}]},{analysis_id:"PATH-0035",analysis_timestamp:"2026-01-13T11:04:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"kafka-broker-1",source_ip:"10.36.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"kafka-broker-2",destination_ip:"10.36.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9093},summary:{total_hops:4,path_latency_ms:.4,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-303 allows TCP/9093 to sg-kafka-prod (self)",latency_ms:.1},{hop_number:2,component:"rtb-kafka",component_id:"rtb-0a1b2c3d4e5f00004",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Kafka subnet",latency_ms:.1},{hop_number:3,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-306 allows TCP/9093 from sg-kafka-prod (self)",latency_ms:.1},{hop_number:4,component:"kafka-broker-2",component_id:"i-0kf123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Kafka inter-broker replication successful",latency_ms:.1}]},{analysis_id:"PATH-0036",analysis_timestamp:"2026-01-13T11:05:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Internet-GitHub",source_ip:"140.82.112.10",source_type:"GitHub Webhook",source_vpc:null,destination:"jenkins-master",destination_ip:"10.70.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:18.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:2},{hop_number:2,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/443",latency_ms:.1},{hop_number:3,component:"sg-alb-jenkins",component_id:"sg-0a1b2c3d4e5f00016",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows HTTPS from GitHub IP range 140.82.112.0/20",latency_ms:.1},{hop_number:4,component:"alb-jenkins",component_id:"arn:aws:elasticloadbalancing:...",type:"Load Balancer",direction:"Forward",decision:"FORWARD",details:"ALB routes to Jenkins target group",latency_ms:3},{hop_number:5,component:"acl-cicd",component_id:"acl-0a1b2c3d4e5f00008",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows from ALB subnet",latency_ms:.1},{hop_number:6,component:"sg-jenkins",component_id:"sg-0a1b2c3d4e5f00011",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1003 allows HTTPS from GitHub",latency_ms:.1},{hop_number:7,component:"jenkins-master",component_id:"i-0jen123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Jenkins webhook endpoint accessible",latency_ms:13.1}]},{analysis_id:"PATH-0037",analysis_timestamp:"2026-01-13T11:06:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vault-1",source_ip:"10.90.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"vault-2",destination_ip:"10.90.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:8201},summary:{total_hops:4,path_latency_ms:.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1201 allows TCP/8201 to sg-vault (self)",latency_ms:.1},{hop_number:2,component:"rtb-vault",component_id:"rtb-0a1b2c3d4e5f00009",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Vault subnet",latency_ms:.1},{hop_number:3,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1202 allows TCP/8201 from sg-vault (self)",latency_ms:.1},{hop_number:4,component:"vault-2",component_id:"i-0vlt123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Vault HA cluster communication successful",latency_ms:.2}]},{analysis_id:"PATH-0038",analysis_timestamp:"2026-01-13T11:07:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"unknown-server",destination_ip:"192.168.1.100",destination_type:"Unknown",destination_vpc:null,protocol:"TCP",port:22},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"rtb-private-app",blocking_reason:"No route to RFC1918 address - destination unreachable"},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Default outbound allows this traffic",latency_ms:null},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal",latency_ms:null},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"BLOCKED",details:"No route to 192.168.0.0/16 - destination not in VPC CIDR or TGW routes",latency_ms:null}]},{analysis_id:"PATH-0039",analysis_timestamp:"2026-01-13T11:08:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"es-data-1",source_ip:"10.85.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"es-data-2",destination_ip:"10.85.1.21",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9300},summary:{total_hops:4,path_latency_ms:.4,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1301 allows TCP/9300 to sg-elasticsearch (self)",latency_ms:.1},{hop_number:2,component:"rtb-elasticsearch",component_id:"rtb-0a1b2c3d4e5f00013",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within ES subnet",latency_ms:.1},{hop_number:3,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1303 allows TCP/9300 from sg-elasticsearch (self)",latency_ms:.1},{hop_number:4,component:"es-data-2",component_id:"i-0es123def456789c",type:"Destination",direction:"N/A",decision:"REACHED",details:"Elasticsearch transport layer communication successful",latency_ms:.1}]},{analysis_id:"PATH-0040",analysis_timestamp:"2026-01-13T11:09:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"alertmanager-1",source_ip:"10.50.1.12",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"api.pagerduty.com",destination_ip:"52.206.43.0",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:28.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-702 allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:3,component:"rtb-monitoring",component_id:"rtb-0a1b2c3d4e5f00006",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via NAT Gateway",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"api.pagerduty.com",component_id:"52.206.43.0",type:"Destination",direction:"N/A",decision:"REACHED",details:"PagerDuty API accessible for alert notifications",latency_ms:25}]},{analysis_id:"PATH-0041",analysis_timestamp:"2026-01-13T11:10:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"jupyter-hub",source_ip:"10.95.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:.9,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-analytics-prod",component_id:"sg-0a1b2c3d4e5f00015",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1401 allows TCP/5432 to sg-database-prod",latency_ms:.1},{hop_number:2,component:"acl-analytics",component_id:"acl-0a1b2c3d4e5f00011",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-analytics",component_id:"rtb-0a1b2c3d4e5f00011",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-103 allows TCP/5432 from sg-analytics-prod",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Database accessible for analytics queries",latency_ms:.4}]},{analysis_id:"PATH-0042",analysis_timestamp:"2026-01-13T11:11:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"203.0.113.100",source_type:"External",source_vpc:null,destination:"bastion-prod",destination_ip:"10.20.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:22},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"sg-bastion",blocking_reason:"Source IP not in allowed VPN or emergency IP list"},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:null},{hop_number:2,component:"acl-bastion",component_id:"acl-0a1b2c3d4e5f00012",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"NACL allows for evaluation",latency_ms:null},{hop_number:3,component:"sg-bastion",component_id:"sg-0a1b2c3d4e5f00007",type:"Security Group",direction:"Inbound",decision:"BLOCKED",details:"No rule allows SSH from 203.0.113.100 - only VPN (10.100.0.0/16) and emergency IP (203.0.113.50/32) allowed",latency_ms:null}]},{analysis_id:"PATH-0043",analysis_timestamp:"2026-01-13T11:12:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"splunk-search-1",source_ip:"10.80.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"splunk-indexer-1",destination_ip:"10.80.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9997},summary:{total_hops:4,path_latency_ms:.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1102 allows TCP/9997 to sg-splunk (self)",latency_ms:.1},{hop_number:2,component:"rtb-splunk",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Splunk subnet",latency_ms:.1},{hop_number:3,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1103 allows TCP/9997 from sg-splunk (self)",latency_ms:.1},{hop_number:4,component:"splunk-indexer-1",component_id:"i-0spl123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Splunk search head to indexer communication successful",latency_ms:.2}]},{analysis_id:"PATH-0044",analysis_timestamp:"2026-01-13T11:13:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"sqs-orders-queue",destination_ip:"vpce-sqs",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows HTTPS to VPC endpoints",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to SQS endpoint via local ENI",latency_ms:.2},{hop_number:4,component:"vpce-sqs",component_id:"vpce-0a1b2c3d4e5f00004",type:"VPC Interface Endpoint",direction:"Forward",decision:"FORWARD",details:"PrivateLink endpoint for SQS",latency_ms:1.5},{hop_number:5,component:"SQS",component_id:"sqs.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"SQS service reached via PrivateLink",latency_ms:.3}]},{analysis_id:"PATH-0045",analysis_timestamp:"2026-01-13T11:14:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"lambda-order-processor",source_ip:"10.65.1.50",source_type:"Lambda",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-lambda-vpc",component_id:"sg-0a1b2c3d4e5f00017",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Lambda SG allows outbound to database",latency_ms:.1},{hop_number:2,component:"acl-lambda",component_id:"acl-0a1b2c3d4e5f00014",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-lambda",component_id:"rtb-0a1b2c3d4e5f00014",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.3},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound allows PostgreSQL from Lambda SG",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Lambda function can access database",latency_ms:.9}]}],$0={path_analyses:Nx},$t=t=>new Promise(s=>setTimeout(s,t)),Sx=(t,s=10)=>Array.from({length:3},()=>Math.max(1,t+(Math.random()-.5)*s*2)),kx=t=>{const s=Math.floor(Math.random()*8)+8,a=[],r=[{ip:"192.168.1.1",hostname:"gateway.local",location:"Local Network",deviceType:"router"},{ip:"10.0.0.1",hostname:"core-rtr-01.example.com",location:"Data Center",asn:"AS12345",asnOrg:"Example Corp",deviceType:"router"},{ip:"72.14.194.1",hostname:"edge-rtr-02.isp.net",location:"Chicago, IL",asn:"AS15169",asnOrg:"ISP Networks",deviceType:"router"},{ip:"142.250.80.1",hostname:"core-bb-01.transit.net",location:"Denver, CO",asn:"AS174",asnOrg:"Cogent",deviceType:"router"},{ip:"209.85.248.1",hostname:"ae-12.cr1.sjc.transit.net",location:"San Jose, CA",asn:"AS3356",asnOrg:"Level 3",deviceType:"router"},{ip:"72.14.232.1",hostname:"be-102.pr1.lax.cloud.net",location:"Los Angeles, CA",asn:"AS15169",asnOrg:"Google Cloud",deviceType:"router",cloudProvider:"gcp"},{ip:"52.93.127.1",hostname:"aws-edge-01.us-east-1",location:"Virginia, US",asn:"AS16509",asnOrg:"Amazon",deviceType:"firewall",cloudProvider:"aws"},{ip:"13.107.4.1",hostname:"azure-gw-01.eastus",location:"Virginia, US",asn:"AS8075",asnOrg:"Microsoft",deviceType:"router",cloudProvider:"azure"}];let n=1;for(let i=0;i<s;i++){const o=i===s-1,l=Math.min(i,r.length-1),c=r[l];n+=Math.random()*15+5;const d=Math.random()<.1,h=d&&Math.random()<.3,u=d?Math.random()*20:Math.random()*2,x=h?[]:Sx(n,n*.2),_=x.length>0?x.reduce((b,m)=>b+m,0)/x.length:0;a.push({hopNumber:i+1,ipAddress:o?t:c.ip.replace(/\d+$/,String(i+1)),hostname:o?`target-${t.replace(/\./g,"-")}`:c.hostname,location:c.location,asn:c.asn||null,asnOrg:c.asnOrg||null,latency:x,avgLatency:parseFloat(_.toFixed(2)),minLatency:x.length>0?parseFloat(Math.min(...x).toFixed(2)):0,maxLatency:x.length>0?parseFloat(Math.max(...x).toFixed(2)):0,jitter:x.length>0?parseFloat((Math.max(...x)-Math.min(...x)).toFixed(2)):0,packetLoss:parseFloat(u.toFixed(1)),status:h?"timeout":u>10?"unreachable":"reachable",deviceType:c.deviceType,cloudProvider:c.cloudProvider||null,region:c.cloudProvider?"us-east-1":void 0})}return a},Cx=t=>{const s=t.reduce((n,i)=>n+i.packetLoss,0)/t.length,a=t.filter(n=>n.status==="timeout").length,r=t.filter(n=>n.status==="unreachable").length;return a>2||r>1||s>10?"critical":a>0||s>5?"degraded":"healthy"},Ax=()=>$0.path_analyses.slice(0,20).map(t=>{let s="healthy";return t.result==="BLOCKED"||t.result==="FAILED"?s="critical":t.summary.bottlenecks&&t.summary.bottlenecks.length>0&&(s="degraded"),{id:t.analysis_id,source:t.input.source,destination:t.input.destination,timestamp:t.analysis_timestamp,totalHops:t.summary.total_hops,avgLatency:t.summary.path_latency_ms??0,health:s,status:"completed"}});let ms=Ax();const Tx=()=>{const t=new Map;return $0.path_analyses.forEach(s=>{const a=`${s.input.source}-${s.input.destination}`;t.has(a)||t.set(a,s)}),Array.from(t.values()).slice(0,10).map((s,a)=>({id:`sp-${a+1}`,name:`${s.input.source} to ${s.input.destination}`,source:s.input.source_ip||s.input.source,destination:s.input.destination_ip||s.input.destination,protocol:s.input.protocol.toLowerCase(),port:s.input.port||void 0,createdAt:s.analysis_timestamp,lastRun:s.analysis_timestamp,runCount:Math.floor(Math.random()*50)+1}))};let ta=Tx();const Ke={async runAnalysis(t){await $t(2e3+Math.random()*2e3);const s=new Date().toISOString(),a=kx(t.destination),r=new Date().toISOString(),n=a.reduce((c,d)=>c+d.avgLatency,0),i=n/a.length,o=a.reduce((c,d)=>c+d.packetLoss,0)/a.length,l={id:`pa-${Date.now()}`,source:t.source,destination:t.destination,protocol:t.protocol,port:t.port,hops:a,totalHops:a.length,totalLatency:parseFloat(n.toFixed(2)),avgLatency:parseFloat(i.toFixed(2)),packetLoss:parseFloat(o.toFixed(1)),health:Cx(a),status:"completed",startTime:s,endTime:r,duration:2e3+Math.random()*2e3,mtu:1500,ttl:t.maxHops||30};return ms.unshift({id:l.id,source:l.source,destination:l.destination,timestamp:l.startTime,totalHops:l.totalHops,avgLatency:l.avgLatency,health:l.health,status:l.status}),ms.length>20&&(ms=ms.slice(0,20)),l},async getHistory(){return await $t(300),ms},async clearHistory(){await $t(200),ms=[]},async getSavedPaths(){return await $t(300),ta},async savePath(t){await $t(300);const s={...t,id:`sp-${Date.now()}`,createdAt:new Date().toISOString(),lastRun:null,runCount:0};return ta.unshift(s),s},async deleteSavedPath(t){await $t(200),ta=ta.filter(s=>s.id!==t)},async updateSavedPathRun(t){await $t(100);const s=ta.find(a=>a.id===t);s&&(s.lastRun=new Date().toISOString(),s.runCount+=1)}},Px=[{ticket_number:"CHG0012345",short_description:"Database access for recommendation-engine-v2 to user_profiles DB",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"recommendation-engine-v2",source_ip:"10.50.10.0/24",destination_system:"user_profiles PostgreSQL",destination_ip:"10.20.5.100",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"ML service requires read-write access to update user preference scores for personalized recommendations",requested_by:{name:"John Developer",email:"john.developer@company.com",department:"Engineering"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["GDPR","SOC2"],violations:[]},assigned_to:{name:"Sarah Security",email:"sarah.security@company.com",role:"Security Manager"},state:"Implementing",created_at:"2026-01-10T09:00:00Z",updated_at:"2026-01-12T14:30:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Risk acceptable"}],additional_controls:["Audit Logging"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove security group rule sgr-xxx",change_window:"2026-01-12T22:00:00Z to 2026-01-13T02:00:00Z"},{ticket_number:"CHG0012346",short_description:"Allow external API access to payment-gateway service",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"Partner API - Stripe Payment Provider",source_ip:"203.0.113.0/24",destination_system:"payment-gateway-prod",destination_ip:"api.payments.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Stripe webhook callbacks for payment confirmation notifications per PCI-DSS requirements",requested_by:{name:"Mike Finance",email:"mike.finance@company.com",department:"Finance"},atlas_risk_score:72,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["PCI-DSS 1.2.1","PCI-DSS 1.3.4"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-11T11:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Security Manager","CISO"],approval_history:[],additional_controls:["WAF Protection","Rate Limiting","IP Whitelist"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Disable WAF rule and remove IP whitelist entry",change_window:"2026-01-15T06:00:00Z to 2026-01-15T10:00:00Z"},{ticket_number:"CHG0012347",short_description:"VPN access for DevOps team to production Kubernetes cluster",category:"Network / VPN Access",priority:3,priority_label:"Moderate",source_system:"VPN Pool - DevOps Team",source_ip:"10.100.50.0/24",destination_system:"prod-eks-cluster API Server",destination_ip:"10.30.0.100",destination_port:6443,protocol:"TCP",action:"ALLOW",business_justification:"DevOps team requires kubectl access for deployment and troubleshooting of production workloads",requested_by:{name:"Lisa DevOps",email:"lisa.devops@company.com",department:"DevOps"},atlas_risk_score:58,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Tom Network",email:"tom.network@company.com",role:"Network Engineer"},state:"Approved",created_at:"2026-01-09T14:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"MFA enforcement verified"}],additional_controls:["MFA Required","Session Timeout 4hrs","Audit Logging"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove VPN group from Kubernetes RBAC",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012348",short_description:"Enable Transit Gateway routing between Analytics VPC and Data Lake VPC",category:"Network / Transit Gateway",priority:3,priority_label:"Moderate",source_system:"Analytics VPC",source_ip:"10.60.0.0/16",destination_system:"Data Lake VPC",destination_ip:"10.70.0.0/16",destination_port:null,protocol:"TCP",ports:[443,9092,3306],action:"ALLOW",business_justification:"Analytics platform requires access to data lake for ML model training and real-time analytics pipeline",requested_by:{name:"Data Team",email:"data.team@company.com",department:"Data Science"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Network Team",email:"network@company.com",role:"Operator"},state:"Implemented",created_at:"2026-01-08T10:00:00Z",updated_at:"2026-01-12T09:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-08T10:05:00Z",comments:"Risk score 35 below threshold 40"}],additional_controls:[],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove TGW route table association",change_window:null},{ticket_number:"CHG0012349",short_description:"Emergency block of malicious IP range - Active threat detected",category:"Security / Emergency Block",priority:1,priority_label:"Critical",source_system:"Malicious IP Range - Known Tor Exit Nodes",source_ip:"185.220.101.0/24",destination_system:"All public-facing services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Emergency security response to active threat - automated brute force attacks detected",requested_by:{name:"SOC Team",email:"soc@company.com",department:"Security Operations"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Incident Response"],violations:[]},assigned_to:{name:"SOC Team",email:"soc@company.com",role:"Security Analyst"},state:"Monitoring",created_at:"2026-01-12T14:00:00Z",updated_at:"2026-01-12T14:00:47Z",threat_intelligence_source:"Recorded Future Alert RF-2026-0112-001, AlienVault OTX Pulse",implementation_time_seconds:47,auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-12T14:00:05Z",comments:"Emergency protocol activated"}],additional_controls:["Active Monitoring","SIEM Alert","Threat Feed Integration"],estimated_implementation_time:"Immediate",actual_implementation_time:"47 seconds",rollback_plan:"Remove deny rules from all platforms",change_window:null},{ticket_number:"CHG0012350",short_description:"Temporary vendor access for SAP integration maintenance",category:"Network / Vendor Access",priority:3,priority_label:"Moderate",source_system:"SAP Consulting Jump Host",source_ip:"198.51.100.50/32",destination_system:"SAP HANA Production",destination_ip:"10.40.20.100",destination_port:30015,protocol:"TCP",action:"ALLOW",business_justification:"Scheduled SAP S/4HANA upgrade requiring vendor specialist support per contract SOW-SAP-2025-089",requested_by:{name:"IT Procurement",email:"procurement@company.com",department:"IT"},atlas_risk_score:65,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","Vendor Management"],violations:[]},assigned_to:{name:"Vendor Management",email:"vendor.mgmt@company.com",role:"Manager"},state:"Scheduled",created_at:"2026-01-10T16:00:00Z",updated_at:"2026-01-12T08:00:00Z",access_duration_hours:72,access_start:"2026-01-15T08:00:00Z",access_end:"2026-01-18T08:00:00Z",auto_expire:!0,required_approvers:["Security Manager","Vendor Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T09:00:00Z",comments:"Session recording required"},{approver:"James Vendor",action:"Approved",timestamp:"2026-01-11T14:00:00Z",comments:"Contract verified"}],additional_controls:["Session Recording","Real-time Monitoring","DLP Enabled","Auto-expire 72h"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Revoke vendor credentials and remove firewall rule",change_window:"2026-01-15T08:00:00Z to 2026-01-18T08:00:00Z"},{ticket_number:"CHG0012351",short_description:"Allow microservices communication for order-processing to inventory-service",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"order-processing-svc",source_ip:"10.30.20.0/24",destination_system:"inventory-service",destination_ip:"10.30.25.0/24",destination_port:8080,protocol:"TCP",action:"ALLOW",business_justification:"New microservice architecture requires inter-service communication for order fulfillment workflow",requested_by:{name:"Platform Team",email:"platform@company.com",department:"Platform Engineering"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Security",email:"platform.sec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-07T13:00:00Z",updated_at:"2026-01-11T16:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-07T13:02:00Z",comments:"Low risk - internal service mesh"}],additional_controls:["Service Mesh mTLS"],estimated_implementation_time:"15 minutes",actual_implementation_time:"12 minutes",rollback_plan:"Remove service mesh policy",change_window:null},{ticket_number:"CHG0012352",short_description:"Block deprecated API endpoint access from legacy systems",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Legacy Application Servers",source_ip:"10.5.0.0/16",destination_system:"Deprecated API Gateway",destination_ip:"10.10.100.50",destination_port:8443,protocol:"TCP",action:"DENY",business_justification:"Deprecating old API version as part of modernization initiative - redirect to new endpoints",requested_by:{name:"Architecture Team",email:"architecture@company.com",department:"Architecture"},atlas_risk_score:42,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["Change Management"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T09:00:00Z",updated_at:"2026-01-12T15:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T10:00:00Z",comments:"Grace period communication sent"}],additional_controls:["Logging Enabled","Grace Period 7 days"],estimated_implementation_time:"30 minutes",actual_implementation_time:null,rollback_plan:"Remove deny rule and restore API access",change_window:"2026-01-20T00:00:00Z to 2026-01-20T04:00:00Z"},{ticket_number:"CHG0012353",short_description:"Enable CloudWatch log streaming to Splunk SIEM",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS CloudWatch",source_ip:"AWS Internal",destination_system:"Splunk SIEM",destination_ip:"10.90.10.100",destination_port:9997,protocol:"TCP",action:"ALLOW",business_justification:"Centralized log aggregation for security monitoring and compliance requirements",requested_by:{name:"Security Operations",email:"secops@company.com",department:"Security"},atlas_risk_score:22,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"SIEM Team",email:"siem@company.com",role:"Administrator"},state:"Implementing",created_at:"2026-01-09T11:00:00Z",updated_at:"2026-01-12T13:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T11:01:00Z",comments:"Logging infrastructure - low risk"}],additional_controls:["TLS Encryption","Log Integrity Verification"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Disable CloudWatch subscription filter",change_window:null},{ticket_number:"CHG0012354",short_description:"Allow Redis cluster access from application caching layer",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Caching Layer",source_ip:"10.30.30.0/24",destination_system:"Redis Cluster",destination_ip:"10.20.50.0/24",destination_port:6379,protocol:"TCP",action:"ALLOW",business_justification:"Application requires distributed caching for session management and performance optimization",requested_by:{name:"Backend Team",email:"backend@company.com",department:"Engineering"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"DBA"},state:"Implemented",created_at:"2026-01-06T10:00:00Z",updated_at:"2026-01-10T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T10:01:00Z",comments:"Internal caching - low risk"}],additional_controls:["Redis AUTH Enabled","TLS in Transit"],estimated_implementation_time:"20 minutes",actual_implementation_time:"18 minutes",rollback_plan:"Remove security group rule",change_window:null},{ticket_number:"CHG0012355",short_description:"External partner API integration for FedEx shipping provider",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"FedEx API Gateway",source_ip:"199.16.156.0/24",destination_system:"Shipping Service API",destination_ip:"api.shipping.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Integration with FedEx shipping API for real-time tracking and label generation",requested_by:{name:"Logistics Team",email:"logistics@company.com",department:"Logistics"},atlas_risk_score:68,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-12T08:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager","Integration Manager"],approval_history:[],additional_controls:["WAF Rules","Rate Limiting","IP Whitelist"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Remove WAF exception and IP whitelist",change_window:"2026-01-16T06:00:00Z to 2026-01-16T12:00:00Z"},{ticket_number:"CHG0012356",short_description:"Database replication between primary and DR site",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Primary Database Cluster",source_ip:"10.20.10.0/24",destination_system:"DR Database Cluster",destination_ip:"10.120.10.0/24",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Enable database replication for disaster recovery compliance - RPO 15 minutes",requested_by:{name:"DR Team",email:"dr.team@company.com",department:"Infrastructure"},atlas_risk_score:55,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","Business Continuity"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"Senior DBA"},state:"Implementing",created_at:"2026-01-08T15:00:00Z",updated_at:"2026-01-12T12:00:00Z",required_approvers:["Security Manager","Database Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T10:00:00Z",comments:"Encryption verified"},{approver:"DBA Manager",action:"Approved",timestamp:"2026-01-09T14:00:00Z",comments:"Replication config reviewed"}],additional_controls:["Encryption in Transit","Replication Monitoring"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Disable replication and remove firewall rules",change_window:"2026-01-13T02:00:00Z to 2026-01-13T06:00:00Z"},{ticket_number:"CHG0012357",short_description:"Allow monitoring agent communication to Datadog",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"All Application Servers",source_ip:"10.0.0.0/8",destination_system:"Datadog Agent Endpoint",destination_ip:"agent.datadoghq.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable APM and infrastructure monitoring across all environments",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Network Team",email:"network@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T09:00:00Z",updated_at:"2026-01-09T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T09:01:00Z",comments:"Monitoring egress - low risk"}],additional_controls:["Egress Only","No Inbound"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012358",short_description:"Block suspicious IP range from Eastern Europe - Threat Response",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"Suspicious IP Range",source_ip:"91.134.0.0/16",destination_system:"All Internet-Facing Services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Threat intelligence indicates active scanning and brute force attempts from this range",requested_by:{name:"Threat Intelligence",email:"threat.intel@company.com",department:"Security"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Incident Response"],violations:[]},assigned_to:{name:"SOC Team",email:"soc@company.com",role:"Analyst"},state:"Monitoring",created_at:"2026-01-12T10:00:00Z",updated_at:"2026-01-12T10:01:23Z",threat_intelligence_source:"Internal Threat Detection, VirusTotal",implementation_time_seconds:83,auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-12T10:00:10Z",comments:"Threat response protocol"}],additional_controls:["Geo-blocking","Rate Limiting Backup"],estimated_implementation_time:"Immediate",actual_implementation_time:"83 seconds",rollback_plan:"Remove deny rules when threat cleared",change_window:null},{ticket_number:"CHG0012359",short_description:"Allow CI/CD pipeline access to Artifactory repository",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Jenkins Build Agents",source_ip:"10.80.0.0/16",destination_system:"Artifactory Repository",destination_ip:"10.85.10.50",destination_port:8081,protocol:"TCP",action:"ALLOW",business_justification:"CI/CD pipeline requires access to push and pull build artifacts",requested_by:{name:"DevOps Team",email:"devops@company.com",department:"DevOps"},atlas_risk_score:41,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"DevOps Security",email:"devsec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-10T14:00:00Z",updated_at:"2026-01-12T09:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T08:00:00Z",comments:"Service account verified"}],additional_controls:["Service Account Auth","Artifact Signing"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove firewall rule and revoke service account",change_window:null},{ticket_number:"CHG0012360",short_description:"Enable cross-region VPC peering for global load balancing",category:"Network / VPC Peering",priority:2,priority_label:"High",source_system:"US-East Production VPC",source_ip:"10.10.0.0/16",destination_system:"EU-West Production VPC",destination_ip:"10.110.0.0/16",destination_port:null,protocol:"ALL",action:"ALLOW",business_justification:"Global load balancing architecture for improved latency and disaster recovery",requested_by:{name:"Infrastructure Team",email:"infrastructure@company.com",department:"Infrastructure"},atlas_risk_score:48,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","GDPR"],violations:[]},assigned_to:{name:"Cloud Architecture",email:"cloud.arch@company.com",role:"Senior Engineer"},state:"Approved",created_at:"2026-01-09T08:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager","Network Architect"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"GDPR data flow verified"},{approver:"Network Architect",action:"Approved",timestamp:"2026-01-10T14:00:00Z",comments:"Architecture reviewed"}],additional_controls:["Transit Encryption","Route Verification"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Delete VPC peering connection",change_window:"2026-01-14T02:00:00Z to 2026-01-14T08:00:00Z"},{ticket_number:"CHG0012361",short_description:"Allow Kafka cluster access for event streaming",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Event Producers",source_ip:"10.30.0.0/16",destination_system:"Kafka Cluster",destination_ip:"10.25.10.0/24",destination_port:9092,protocol:"TCP",action:"ALLOW",business_justification:"Enable event-driven architecture for real-time data processing",requested_by:{name:"Data Engineering",email:"data.eng@company.com",department:"Data"},atlas_risk_score:36,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Team",email:"platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T11:00:00Z",updated_at:"2026-01-08T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T11:01:00Z",comments:"Internal messaging - low risk"}],additional_controls:["SASL Authentication","TLS Encryption"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove Kafka ACLs and security group rules",change_window:null},{ticket_number:"CHG0012362",short_description:"External webhook integration for GitHub Actions",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"GitHub Actions",source_ip:"140.82.112.0/20",destination_system:"Deployment Webhook Service",destination_ip:"hooks.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"GitHub Actions requires webhook callback for deployment status updates",requested_by:{name:"DevOps",email:"devops@company.com",department:"DevOps"},atlas_risk_score:52,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"Security Engineering",email:"sec.eng@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T10:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T09:00:00Z",comments:"Webhook signature validation required"}],additional_controls:["Webhook Signature Validation","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rule and IP whitelist",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012363",short_description:"Block crypto mining pool connections",category:"Security / Threat Response",priority:2,priority_label:"High",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"Known Mining Pools",destination_ip:"Multiple IPs",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Prevent unauthorized cryptocurrency mining on company resources",requested_by:{name:"Security Team",email:"security@company.com",department:"Security"},atlas_risk_score:null,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["Security Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T08:00:00Z",updated_at:"2026-01-07T12:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-03T10:00:00Z",comments:"Policy enforcement"}],additional_controls:["DNS Sinkhole","Threat Feed Integration"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove deny rules and DNS sinkhole entries",change_window:null},{ticket_number:"CHG0012364",short_description:"Allow Elasticsearch cluster access for log analytics",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Log Aggregation Services",source_ip:"10.90.0.0/16",destination_system:"Elasticsearch Cluster",destination_ip:"10.25.20.0/24",destination_port:9200,protocol:"TCP",action:"ALLOW",business_justification:"Enable centralized log search and analytics capabilities",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:34,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Data Platform",email:"data.platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T09:00:00Z",updated_at:"2026-01-06T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-02T09:01:00Z",comments:"Logging infrastructure"}],additional_controls:["TLS Encryption","Role-Based Access"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove security group rules",change_window:null},{ticket_number:"CHG0012365",short_description:"Enable S3 VPC Endpoint for secure data transfer",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"AWS S3 Service",destination_ip:"S3 Prefix List",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Route S3 traffic through VPC endpoint for security and cost optimization",requested_by:{name:"Cloud Team",email:"cloud@company.com",department:"Cloud Infrastructure"},atlas_risk_score:25,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-01T10:00:00Z",updated_at:"2026-01-05T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-01T10:01:00Z",comments:"AWS managed endpoint - low risk"}],additional_controls:["VPC Endpoint Policy","S3 Bucket Policy"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove VPC endpoint and route table entries",change_window:null},{ticket_number:"CHG0012366",short_description:"Allow Azure AD authentication traffic",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"All Corporate Applications",source_ip:"10.0.0.0/8",destination_system:"Azure AD Endpoints",destination_ip:"login.microsoftonline.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Azure AD SSO authentication for corporate applications",requested_by:{name:"Identity Team",email:"identity@company.com",department:"IT Security"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Identity Security",email:"idsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2025-12-28T14:00:00Z",updated_at:"2026-01-02T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2025-12-28T14:01:00Z",comments:"Identity provider - low risk"}],additional_controls:["TLS 1.2+","Certificate Pinning"],estimated_implementation_time:"1 hour",actual_implementation_time:"45 minutes",rollback_plan:"Remove egress rules for Azure AD endpoints",change_window:null},{ticket_number:"CHG0012367",short_description:"Block outbound DNS to non-corporate resolvers",category:"Security / Access Revocation",priority:2,priority_label:"High",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"External DNS Servers",destination_ip:"0.0.0.0/0",destination_port:53,protocol:"UDP",action:"DENY",business_justification:"Enforce use of corporate DNS for security monitoring and DNS tunneling prevention",requested_by:{name:"Security Architecture",email:"sec.arch@company.com",department:"Security"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","Security Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Senior Engineer"},state:"Approved",created_at:"2026-01-10T09:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager","Network Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Exception list reviewed"},{approver:"Network Manager",action:"Approved",timestamp:"2026-01-12T09:00:00Z",comments:"Impact assessment complete"}],additional_controls:["DNS Logging","Exception Whitelist for Cloud Services"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Remove deny rules",change_window:"2026-01-15T02:00:00Z to 2026-01-15T06:00:00Z"},{ticket_number:"CHG0012368",short_description:"Allow GraphQL API access for mobile applications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Mobile App Users",source_ip:"0.0.0.0/0",destination_system:"GraphQL API Gateway",destination_ip:"graphql.api.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"New mobile app requires GraphQL API access for data queries",requested_by:{name:"Mobile Team",email:"mobile@company.com",department:"Mobile Development"},atlas_risk_score:62,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","OWASP"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-12T11:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager","API Security"],approval_history:[],additional_controls:["WAF Rules","Rate Limiting","Query Depth Limiting","Authentication Required"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Disable API endpoint",change_window:"2026-01-16T10:00:00Z to 2026-01-16T14:00:00Z"},{ticket_number:"CHG0012369",short_description:"Enable MongoDB Atlas peering connection",category:"Network / VPC Peering",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"MongoDB Atlas",destination_ip:"192.168.248.0/21",destination_port:27017,protocol:"TCP",action:"ALLOW",business_justification:"Migrate to MongoDB Atlas for managed database services",requested_by:{name:"Database Team",email:"dba@company.com",department:"Database"},atlas_risk_score:44,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","HIPAA"],violations:[]},assigned_to:{name:"Cloud Database",email:"cloud.db@company.com",role:"DBA"},state:"Approved",created_at:"2026-01-08T13:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T11:00:00Z",comments:"MongoDB Atlas SOC2 verified"}],additional_controls:["TLS Encryption","IP Whitelist","Authentication"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Delete VPC peering connection",change_window:"2026-01-14T06:00:00Z to 2026-01-14T10:00:00Z"},{ticket_number:"CHG0012370",short_description:"Allow Okta SCIM provisioning traffic",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Okta Cloud",source_ip:"Multiple Okta IPs",destination_system:"Identity Provisioning API",destination_ip:"scim.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable automated user provisioning through Okta SCIM",requested_by:{name:"Identity Team",email:"identity@company.com",department:"IT Security"},atlas_risk_score:48,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Identity Engineering",email:"id.eng@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-07T10:00:00Z",updated_at:"2026-01-12T08:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-08T09:00:00Z",comments:"Okta IP ranges verified"}],additional_controls:["Bearer Token Auth","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rules and IP whitelist",change_window:null},{ticket_number:"CHG0012371",short_description:"Rejected - Overly permissive database access request",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Development Environment",source_ip:"0.0.0.0/0",destination_system:"Production Database",destination_ip:"10.20.10.100",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Developer needs quick access to debug production issue",requested_by:{name:"Dev User",email:"dev@company.com",department:"Engineering"},atlas_risk_score:95,risk_level:"CRITICAL",compliance_status:{passed:!1,frameworks:[],violations:["PCI-DSS 1.2.1","SOC2 CC6.1"]},assigned_to:null,state:"Rejected",created_at:"2026-01-11T15:00:00Z",updated_at:"2026-01-11T16:00:00Z",required_approvers:["Security Manager","CISO"],approval_history:[{approver:"Sarah Security",action:"Rejected",timestamp:"2026-01-11T16:00:00Z",comments:"0.0.0.0/0 source not allowed for production databases. Use VPN access instead."}],additional_controls:[],rejection_reason:"Overly permissive source CIDR violates security policy",estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012372",short_description:"Allow Snowflake data warehouse access",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Analytics Applications",source_ip:"10.60.0.0/16",destination_system:"Snowflake Cloud",destination_ip:"company.snowflakecomputing.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Connect analytics tools to Snowflake data warehouse",requested_by:{name:"BI Team",email:"bi@company.com",department:"Business Intelligence"},atlas_risk_score:39,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Data Platform",email:"data.platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T14:00:00Z",updated_at:"2026-01-07T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-03T14:01:00Z",comments:"SaaS analytics - low risk"}],additional_controls:["SSO Authentication","Role-Based Access"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012373",short_description:"Enable AWS PrivateLink for third-party SaaS",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"SaaS Provider PrivateLink",destination_ip:"vpce-xxx",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Secure private connectivity to SaaS provider without internet exposure",requested_by:{name:"Cloud Architecture",email:"cloud.arch@company.com",department:"Architecture"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T11:00:00Z",updated_at:"2026-01-12T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T11:01:00Z",comments:"PrivateLink - low risk"}],additional_controls:["VPC Endpoint Policy"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Delete VPC endpoint",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012374",short_description:"Block TikTok domains for corporate network",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Corporate Network",source_ip:"10.0.0.0/8",destination_system:"TikTok Domains",destination_ip:"Multiple",destination_port:443,protocol:"HTTPS",action:"DENY",business_justification:"Corporate policy prohibits TikTok access due to security concerns",requested_by:{name:"CISO Office",email:"ciso@company.com",department:"Security"},atlas_risk_score:null,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["Corporate Policy"],violations:[]},assigned_to:{name:"Web Security",email:"websec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T08:00:00Z",updated_at:"2026-01-05T12:00:00Z",required_approvers:["CISO"],approval_history:[{approver:"CISO",action:"Approved",timestamp:"2026-01-02T09:00:00Z",comments:"Corporate policy enforcement"}],additional_controls:["DNS Blocking","URL Filtering"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove DNS and URL filter entries",change_window:null},{ticket_number:"CHG0012375",short_description:"Allow Terraform Cloud API access for IaC deployments",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"CI/CD Pipeline",source_ip:"10.80.0.0/16",destination_system:"Terraform Cloud",destination_ip:"app.terraform.io",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable infrastructure as code deployments through Terraform Cloud",requested_by:{name:"Platform Engineering",email:"platform@company.com",department:"Platform"},atlas_risk_score:42,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"DevSecOps",email:"devsecops@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-10T16:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"API token rotation policy required"}],additional_controls:["API Token Authentication","Workspace Isolation"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012376",short_description:"Enable AWS Systems Manager access for EC2 management",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"EC2 Instances",source_ip:"10.30.0.0/16",destination_system:"AWS SSM Endpoints",destination_ip:"SSM Prefix List",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable secure SSH-less management of EC2 instances through Systems Manager",requested_by:{name:"Operations Team",email:"ops@company.com",department:"Operations"},atlas_risk_score:26,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"AWS Operations",email:"aws.ops@company.com",role:"Engineer"},state:"Implemented",created_at:"2025-12-30T10:00:00Z",updated_at:"2026-01-03T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2025-12-30T10:01:00Z",comments:"AWS managed service - low risk"}],additional_controls:["IAM Instance Profile","Session Logging"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove VPC endpoints",change_window:null},{ticket_number:"CHG0012377",short_description:"Cancelled - Duplicate request for Redis access",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Tier",source_ip:"10.30.30.0/24",destination_system:"Redis Cluster",destination_ip:"10.20.50.0/24",destination_port:6379,protocol:"TCP",action:"ALLOW",business_justification:"Application needs Redis access",requested_by:{name:"Developer",email:"dev@company.com",department:"Engineering"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:null,state:"Cancelled",created_at:"2026-01-11T14:00:00Z",updated_at:"2026-01-11T15:00:00Z",required_approvers:[],approval_history:[],cancellation_reason:"Duplicate of CHG0012354 - access already granted",additional_controls:[],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012378",short_description:"Allow PagerDuty webhook for incident notifications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"PagerDuty Cloud",source_ip:"Multiple PagerDuty IPs",destination_system:"Incident Webhook Handler",destination_ip:"incidents.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable PagerDuty to send incident webhooks for automation",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:46,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-08T09:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T10:00:00Z",comments:"Webhook signature validation confirmed"}],additional_controls:["Webhook Signature Validation","Rate Limiting"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012379",short_description:"Enable AWS Secrets Manager access for credential rotation",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"AWS Secrets Manager",destination_ip:"secretsmanager.us-east-1.amazonaws.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Implement automated credential rotation for security compliance",requested_by:{name:"Security Engineering",email:"sec.eng@company.com",department:"Security"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS","NIST"],violations:[]},assigned_to:{name:"AWS Security",email:"aws.sec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T11:00:00Z",updated_at:"2026-01-08T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T11:01:00Z",comments:"Security service - low risk"}],additional_controls:["VPC Endpoint","IAM Policy"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove VPC endpoint",change_window:null},{ticket_number:"CHG0012380",short_description:"Block Russia and Belarus IP ranges",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"RU/BY Country IP Ranges",source_ip:"Multiple Country CIDR Blocks",destination_system:"All Public Services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Geopolitical risk mitigation - no business operations in these regions",requested_by:{name:"CISO",email:"ciso@company.com",department:"Security"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Policy","Risk Management"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Senior Engineer"},state:"Implemented",created_at:"2026-01-05T08:00:00Z",updated_at:"2026-01-05T10:00:00Z",required_approvers:["CISO"],approval_history:[{approver:"CISO",action:"Approved",timestamp:"2026-01-05T08:30:00Z",comments:"Executive directive"}],additional_controls:["Geo-IP Blocking","Threat Feed Integration"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove geo-blocking rules",change_window:null},{ticket_number:"CHG0012381",short_description:"Allow Cloudflare WAF to origin servers",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"Cloudflare Edge",source_ip:"Cloudflare IP Ranges",destination_system:"Origin Web Servers",destination_ip:"10.10.5.0/24",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Route traffic through Cloudflare for DDoS protection and WAF",requested_by:{name:"Security Architecture",email:"sec.arch@company.com",department:"Security"},atlas_risk_score:55,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"Web Security",email:"websec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-09T14:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"Cloudflare authenticated origin pull required"}],additional_controls:["Authenticated Origin Pull","TLS 1.3"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Remove Cloudflare IP whitelist",change_window:null},{ticket_number:"CHG0012382",short_description:"On Hold - Pending vendor security assessment",category:"Network / Vendor Access",priority:3,priority_label:"Moderate",source_system:"New SaaS Vendor",source_ip:"203.0.113.100/32",destination_system:"Internal API",destination_ip:"10.10.10.50",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"New vendor integration for HR system",requested_by:{name:"HR IT",email:"hr.it@company.com",department:"HR"},atlas_risk_score:70,risk_level:"HIGH",compliance_status:{passed:!1,frameworks:[],violations:["Pending vendor SOC2 review"]},assigned_to:{name:"Vendor Security",email:"vendor.sec@company.com",role:"Analyst"},state:"On Hold",created_at:"2026-01-07T11:00:00Z",updated_at:"2026-01-12T09:00:00Z",required_approvers:["Security Manager","Vendor Manager"],approval_history:[],hold_reason:"Awaiting vendor SOC2 Type II report review",hold_until:"2026-01-20T00:00:00Z",additional_controls:["Pending security assessment"],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012383",short_description:"Allow Lambda functions to access RDS via VPC",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS Lambda",source_ip:"Lambda ENI IPs",destination_system:"RDS PostgreSQL",destination_ip:"10.20.10.0/24",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Serverless functions require database access for API backend",requested_by:{name:"Serverless Team",email:"serverless@company.com",department:"Engineering"},atlas_risk_score:40,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Cloud Team",email:"cloud@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T13:00:00Z",updated_at:"2026-01-12T15:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T10:00:00Z",comments:"Lambda security group configured correctly"}],additional_controls:["Lambda VPC Config","Security Group"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove Lambda from VPC",change_window:"2026-01-13T18:00:00Z to 2026-01-13T20:00:00Z"},{ticket_number:"CHG0012384",short_description:"Enable Azure Event Hub access for log streaming",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Azure VMs",source_ip:"10.50.0.0/16",destination_system:"Azure Event Hub",destination_ip:"eventhub.servicebus.windows.net",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Stream Azure logs to central logging platform",requested_by:{name:"Azure Team",email:"azure@company.com",department:"Cloud"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Azure Operations",email:"azure.ops@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-06T15:00:00Z",updated_at:"2026-01-10T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T15:01:00Z",comments:"Azure managed service"}],additional_controls:["Service Endpoint","NSG Rules"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove NSG rules",change_window:null},{ticket_number:"CHG0012385",short_description:"Block known malware C2 domains",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"Malware C2 Domains",destination_ip:"Multiple",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Block communication with known malware command and control infrastructure",requested_by:{name:"Threat Intelligence",email:"threat.intel@company.com",department:"Security"},atlas_risk_score:null,risk_level:"CRITICAL",compliance_status:{passed:!0,frameworks:["Security Policy"],violations:[]},assigned_to:{name:"SOC",email:"soc@company.com",role:"Analyst"},state:"Implemented",created_at:"2026-01-08T06:00:00Z",updated_at:"2026-01-08T07:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-08T06:01:00Z",comments:"Threat intelligence auto-block"}],additional_controls:["DNS Sinkhole","Threat Feed Integration","SIEM Alert"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove DNS sinkhole entries",change_window:null},{ticket_number:"CHG0012386",short_description:"Allow GCP Cloud Functions to access Cloud SQL",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"GCP Cloud Functions",source_ip:"Serverless VPC Connector",destination_system:"Cloud SQL PostgreSQL",destination_ip:"10.128.0.0/20",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Serverless functions need database connectivity",requested_by:{name:"GCP Team",email:"gcp@company.com",department:"Cloud"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"GCP Operations",email:"gcp.ops@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-10T10:00:00Z",updated_at:"2026-01-12T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-10T10:01:00Z",comments:"Internal GCP traffic"}],additional_controls:["VPC Connector","Firewall Rules"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove VPC connector",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012387",short_description:"Enable Twilio webhook for SMS notifications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Twilio Cloud",source_ip:"Twilio IP Ranges",destination_system:"SMS Webhook Handler",destination_ip:"sms.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Twilio webhooks for SMS status callbacks",requested_by:{name:"Communications Team",email:"comms@company.com",department:"Communications"},atlas_risk_score:50,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-11T09:00:00Z",updated_at:"2026-01-12T13:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T08:00:00Z",comments:"Request signature validation required"}],additional_controls:["Request Signature Validation","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:null},{ticket_number:"CHG0012388",short_description:"Allow Prometheus to scrape metrics from all namespaces",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Prometheus Server",source_ip:"10.90.5.0/24",destination_system:"All Kubernetes Pods",destination_ip:"10.30.0.0/16",destination_port:9090,protocol:"TCP",action:"ALLOW",business_justification:"Enable comprehensive metrics collection for observability",requested_by:{name:"Observability Team",email:"observability@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Team",email:"platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T14:00:00Z",updated_at:"2026-01-09T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T14:01:00Z",comments:"Monitoring traffic"}],additional_controls:["Network Policy","Service Account"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove network policy",change_window:null},{ticket_number:"CHG0012389",short_description:"Enable AWS KMS access for encryption key management",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"AWS KMS",destination_ip:"kms.us-east-1.amazonaws.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable encryption key management for data protection compliance",requested_by:{name:"Security Engineering",email:"sec.eng@company.com",department:"Security"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS","HIPAA"],violations:[]},assigned_to:{name:"Security Operations",email:"secops@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T09:00:00Z",updated_at:"2026-01-07T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-03T09:01:00Z",comments:"Security service - critical"}],additional_controls:["VPC Endpoint","Key Policy"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove VPC endpoint",change_window:null},{ticket_number:"CHG0012390",short_description:"Allow SendGrid for transactional email",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Email Service",source_ip:"10.30.40.0/24",destination_system:"SendGrid API",destination_ip:"api.sendgrid.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable transactional email delivery through SendGrid",requested_by:{name:"Communications",email:"comms@company.com",department:"Marketing"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","CAN-SPAM"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T16:00:00Z",updated_at:"2026-01-08T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T16:01:00Z",comments:"SaaS email service"}],additional_controls:["API Key Authentication","Rate Limiting"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012391",short_description:"Block BitTorrent traffic on corporate network",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Corporate Network",source_ip:"10.0.0.0/8",destination_system:"BitTorrent Peers",destination_ip:"0.0.0.0/0",destination_port:"6881-6889",protocol:"TCP/UDP",action:"DENY",business_justification:"Block P2P file sharing to prevent copyright infringement and data exfiltration",requested_by:{name:"IT Security",email:"it.security@company.com",department:"IT"},atlas_risk_score:null,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["Corporate Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T11:00:00Z",updated_at:"2026-01-06T09:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-02T14:00:00Z",comments:"Policy enforcement"}],additional_controls:["Application Control","Protocol Detection"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove application control rules",change_window:null},{ticket_number:"CHG0012392",short_description:"Enable HashiCorp Vault access for secrets management",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"HashiCorp Vault Cluster",destination_ip:"10.90.20.0/24",destination_port:8200,protocol:"TCP",action:"ALLOW",business_justification:"Enable centralized secrets management for applications",requested_by:{name:"Platform Security",email:"platform.sec@company.com",department:"Security"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"Security Engineering",email:"sec.eng@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T15:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T10:00:00Z",comments:"AppRole authentication configured"}],additional_controls:["TLS Encryption","AppRole Auth","Audit Logging"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove security group rules",change_window:"2026-01-14T10:00:00Z to 2026-01-14T14:00:00Z"},{ticket_number:"CHG0012393",short_description:"Allow Grafana access to Prometheus for dashboards",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Grafana Server",source_ip:"10.90.10.50",destination_system:"Prometheus Server",destination_ip:"10.90.5.100",destination_port:9090,protocol:"TCP",action:"ALLOW",business_justification:"Enable Grafana dashboards to query Prometheus metrics",requested_by:{name:"Observability Team",email:"observability@company.com",department:"SRE"},atlas_risk_score:22,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Monitoring Team",email:"monitoring@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T10:00:00Z",updated_at:"2026-01-09T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T10:01:00Z",comments:"Monitoring infrastructure"}],additional_controls:["Internal Only"],estimated_implementation_time:"15 minutes",actual_implementation_time:"12 minutes",rollback_plan:"Remove security group rule",change_window:null},{ticket_number:"CHG0012394",short_description:"Enable AWS ALB access logs to S3",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS ALB",source_ip:"ALB Internal",destination_system:"S3 Logging Bucket",destination_ip:"S3 Endpoint",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable ALB access logging for security and compliance",requested_by:{name:"Compliance Team",email:"compliance@company.com",department:"Compliance"},atlas_risk_score:20,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T13:00:00Z",updated_at:"2026-01-08T16:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T13:01:00Z",comments:"Logging configuration"}],additional_controls:["S3 Bucket Policy","Log Retention"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Disable ALB access logging",change_window:null},{ticket_number:"CHG0012395",short_description:"Draft - New microservice API access request",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"New Checkout Service",source_ip:"10.30.50.0/24",destination_system:"Payment Service",destination_ip:"10.30.25.0/24",destination_port:8443,protocol:"HTTPS",action:"ALLOW",business_justification:"New checkout service needs to call payment service APIs",requested_by:{name:"E-commerce Team",email:"ecommerce@company.com",department:"Engineering"},atlas_risk_score:52,risk_level:"MEDIUM",compliance_status:{passed:null,frameworks:[],violations:[]},assigned_to:null,state:"Draft",created_at:"2026-01-12T16:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:[],approval_history:[],additional_controls:[],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012396",short_description:"Allow Jira webhook for issue tracking integration",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Atlassian Jira Cloud",source_ip:"Atlassian IP Ranges",destination_system:"Issue Webhook Handler",destination_ip:"issues.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Jira webhooks for automated issue tracking",requested_by:{name:"Project Management",email:"pm@company.com",department:"PMO"},atlas_risk_score:44,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-10T11:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T09:00:00Z",comments:"Webhook validation configured"}],additional_controls:["Webhook Signature Validation"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012397",short_description:"Block Zoom for regulated departments",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Regulated Department Networks",source_ip:"10.200.0.0/16",destination_system:"Zoom Cloud",destination_ip:"Zoom Domains",destination_port:443,protocol:"HTTPS",action:"DENY",business_justification:"Compliance requirement prohibits certain video conferencing for regulated departments",requested_by:{name:"Compliance",email:"compliance@company.com",department:"Compliance"},atlas_risk_score:null,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["Regulatory Compliance"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-11T08:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Compliance Manager","Security Manager"],approval_history:[{approver:"Compliance Manager",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Regulatory requirement"},{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T14:00:00Z",comments:"Implementation plan reviewed"}],additional_controls:["URL Filtering","DNS Blocking"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove URL filter and DNS block",change_window:null},{ticket_number:"CHG0012398",short_description:"Enable AWS EFS access for shared storage",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application EC2 Instances",source_ip:"10.30.0.0/16",destination_system:"AWS EFS",destination_ip:"10.30.100.0/24",destination_port:2049,protocol:"TCP",action:"ALLOW",business_justification:"Enable shared file storage for application cluster",requested_by:{name:"Application Team",email:"app@company.com",department:"Engineering"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Storage Team",email:"storage@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T09:00:00Z",updated_at:"2026-01-12T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T09:01:00Z",comments:"Internal storage - low risk"}],additional_controls:["NFS Security Group","IAM Authorization"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove mount targets",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012399",short_description:"Allow New Relic APM agent communication",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Servers",source_ip:"10.30.0.0/16",destination_system:"New Relic Collector",destination_ip:"collector.newrelic.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable APM monitoring through New Relic",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Monitoring Team",email:"monitoring@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-06T14:00:00Z",updated_at:"2026-01-10T09:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T14:01:00Z",comments:"Monitoring egress"}],additional_controls:["License Key Auth"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012400",short_description:"Enable inter-region database replication for DR",category:"Network / Transit Gateway",priority:1,priority_label:"Critical",source_system:"US-East Database VPC",source_ip:"10.20.0.0/16",destination_system:"US-West Database VPC",destination_ip:"10.120.0.0/16",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Critical DR requirement - cross-region database replication for business continuity",requested_by:{name:"DR Team",email:"dr@company.com",department:"Infrastructure"},atlas_risk_score:60,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","Business Continuity","HIPAA"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"Senior DBA"},state:"Awaiting Approval",created_at:"2026-01-12T09:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager","CISO","Database Manager"],approval_history:[{approver:"Database Manager",action:"Approved",timestamp:"2026-01-12T11:00:00Z",comments:"Replication config verified"}],additional_controls:["TLS 1.3 Encryption","Inter-Region TGW Peering","Replication Monitoring"],estimated_implementation_time:"6 hours",actual_implementation_time:null,rollback_plan:"Remove TGW peering and replication configuration",change_window:"2026-01-18T02:00:00Z to 2026-01-18T10:00:00Z"}],Ix={tickets:Px},Rx=t=>({Draft:"awaiting","Awaiting Approval":"awaiting",Approved:"approved",Implementing:"implementing",Implemented:"completed",Monitoring:"completed",Scheduled:"approved",Rejected:"rejected",Cancelled:"rejected","On Hold":"awaiting"})[t]||"awaiting",Ex=t=>t===1?"critical":t===2?"high":t===3?"medium":"low",Lx=t=>({"Network / Firewall Change":"firewall_rule","Network / WAF Change":"firewall_rule","Network / VPN Access":"vpn","Network / Transit Gateway":"routing","Network / VPC Peering":"routing","Network / Vendor Access":"firewall_rule","Network / Load Balancer":"load_balancer","Security / Emergency Block":"firewall_rule","Security / Threat Response":"firewall_rule","Security / Access Revocation":"security_group","Compliance / Audit Remediation":"security_group","Compliance / Policy Update":"other"})[t]||"other",Ox=t=>({LOW:"low",MEDIUM:"medium",HIGH:"high",CRITICAL:"critical",EMERGENCY:"critical"})[t]||"medium",Dx=(t,s)=>{var n,i,o,l,c,d,h;const a=t.atlas_risk_score??50,r=Ox(t.risk_level);return{id:`TKT-${String(s+1).padStart(3,"0")}`,serviceNowId:t.ticket_number,title:t.short_description,description:t.business_justification,status:Rx(t.state),priority:Ex(t.priority),category:Lx(t.category),changeType:t.action==="DENY"?"delete":"add",assignee:((n=t.assigned_to)==null?void 0:n.name)||"Unassigned",requester:((i=t.requested_by)==null?void 0:i.email)||"unknown@company.com",createdAt:t.created_at,updatedAt:t.updated_at,scheduledAt:(o=t.change_window)==null?void 0:o.split(" to ")[0],completedAt:t.state==="Implemented"?t.updated_at:void 0,affectedResources:[{id:`res-${s}-src`,type:"Source System",name:t.source_system,platform:"aws"},{id:`res-${s}-dst`,type:"Destination System",name:t.destination_system,platform:"aws"}],riskAssessment:{score:a,level:r,factors:[{name:"Risk Score",impact:a>60?"negative":a>40?"neutral":"positive",weight:a,description:`Atlas risk score: ${a}`},...((c=(l=t.compliance_status)==null?void 0:l.violations)==null?void 0:c.length)>0?[{name:"Compliance Violations",impact:"negative",weight:20,description:`${t.compliance_status.violations.length} compliance violations`}]:[],...((d=t.additional_controls)==null?void 0:d.length)>0?[{name:"Additional Controls",impact:"positive",weight:-10,description:`Controls: ${t.additional_controls.join(", ")}`}]:[]],recommendation:r==="critical"?"Requires CISO approval and detailed review.":r==="high"?"Proceed with caution. Implement during maintenance window.":r==="medium"?"Standard approval process. Monitor after implementation.":"Low risk. Can proceed with minimal oversight."},approvalSteps:((h=t.approval_history)==null?void 0:h.map((u,x)=>({id:`step-${x+1}`,name:u.approver==="SYSTEM"?"Auto Approval":"Manual Review",approver:u.approver,status:u.action.toLowerCase().includes("approved")?"approved":u.action.toLowerCase().includes("rejected")?"rejected":"pending",timestamp:u.timestamp,comments:u.comments})))||[],rollbackPlan:t.rollback_plan??void 0}},dt=Ix.tickets.map(Dx),jt=t=>new Promise(s=>setTimeout(s,t)),Bt={async getTickets(t){var a,r,n;await jt(500);let s=[...dt];if((a=t==null?void 0:t.status)!=null&&a.length&&(s=s.filter(i=>t.status.includes(i.status))),(r=t==null?void 0:t.priority)!=null&&r.length&&(s=s.filter(i=>t.priority.includes(i.priority))),(n=t==null?void 0:t.category)!=null&&n.length&&(s=s.filter(i=>t.category.includes(i.category))),t!=null&&t.search){const i=t.search.toLowerCase();s=s.filter(o=>o.title.toLowerCase().includes(i)||o.description.toLowerCase().includes(i)||o.serviceNowId.toLowerCase().includes(i))}return s.sort((i,o)=>new Date(o.createdAt).getTime()-new Date(i.createdAt).getTime())},async getTicketById(t){return await jt(300),dt.find(s=>s.id===t)||null},async getTicketsByStatus(t){return await jt(300),dt.filter(s=>s.status===t)},async createTicket(t){await jt(1e3);const s=hc(t),a={id:`TKT-${String(dt.length+1).padStart(3,"0")}`,serviceNowId:`CHG00${12350+dt.length}`,title:t.title,description:t.description,status:"awaiting",priority:t.priority,category:t.category,changeType:t.changeType,assignee:"Unassigned",requester:"current.user@company.com",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),scheduledAt:t.scheduledAt,affectedResources:[],riskAssessment:s,approvalSteps:[{id:"step-1",name:"Security Review",approver:"Security Team",status:"pending"},{id:"step-2",name:"Manager Approval",approver:"Network Manager",status:"pending"}],rollbackPlan:t.rollbackPlan};return dt.push(a),a},async updateTicketStatus(t,s){await jt(500);const a=dt.find(r=>r.id===t);return a&&(a.status=s,a.updatedAt=new Date().toISOString(),s==="completed"&&(a.completedAt=new Date().toISOString())),a||null},async approveTicketStep(t,s,a){await jt(500);const r=dt.find(n=>n.id===t);if(r){const n=r.approvalSteps.find(o=>o.id===s);n&&(n.status="approved",n.timestamp=new Date().toISOString(),n.comments=a),r.updatedAt=new Date().toISOString(),r.approvalSteps.every(o=>o.status==="approved")&&(r.status="approved")}return r||null},async rejectTicketStep(t,s,a){await jt(500);const r=dt.find(n=>n.id===t);if(r){const n=r.approvalSteps.find(i=>i.id===s);n&&(n.status="rejected",n.timestamp=new Date().toISOString(),n.comments=a),r.status="rejected",r.updatedAt=new Date().toISOString()}return r||null},async calculateRisk(t){return await jt(800),hc(t)}};function hc(t){const s=[];let a=50;t.changeType==="delete"?(s.push({name:"Rule Removal",impact:"positive",weight:-20,description:"Removing rules generally reduces attack surface"}),a-=20):t.changeType==="add"&&(s.push({name:"New Rule",impact:"negative",weight:15,description:"New rules may increase exposure"}),a+=15),t.action==="deny"&&(s.push({name:"Deny Action",impact:"positive",weight:-15,description:"Deny rules improve security posture"}),a-=15),t.priority==="critical"&&(s.push({name:"Critical Priority",impact:"negative",weight:20,description:"Expedited changes may miss thorough review"}),a+=20),(t.sourceIp==="0.0.0.0/0"||t.sourceIp==="any")&&(s.push({name:"Any Source",impact:"negative",weight:30,description:"Allows traffic from any source IP"}),a+=30);const r=["80","443","22","3389"];t.port&&r.includes(t.port)&&(s.push({name:"Standard Port",impact:"positive",weight:-10,description:"Uses well-known standard port"}),a-=10);const n=Math.max(0,Math.min(100,a));let i,o;return n<30?(i="low",o="Low risk change. Can proceed with standard approval process."):n<50?(i="medium",o="Moderate risk. Recommend implementing during maintenance window."):n<75?(i="high",o="High risk change. Requires CAB approval and detailed rollback plan."):(i="critical",o="Critical risk. Requires CISO approval and must include monitoring plan."),{score:n,level:i,factors:s,recommendation:o}}function Mx(){const[t,s]=v.useState([]),[a,r]=v.useState([]),[n,i]=v.useState([]),[o,l]=v.useState({compliance:"0%",uptime:"0%",avgLatency:"0ms"}),[c,d]=v.useState(null),[h,u]=v.useState(!0),[x,_]=v.useState(null);return v.useEffect(()=>{(async()=>{try{u(!0);const[m,T,p,g,f]=await Promise.all([Oh(),Dh(),Mh(),Uh(),Hh()]);s(m),r(T),i(p),l(g),d(f),_(null)}catch(m){_(m instanceof Error?m:new Error("Failed to fetch dashboard data"))}finally{u(!1)}})()},[]),{metrics:t,recentActivity:a,platformDistribution:n,summaryStats:o,networkStats:c,isLoading:h,error:x}}const Fx=({currentTime:t,userName:s="Admin"})=>e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-white",children:["Welcome back, ",s]}),e.jsx("p",{className:"text-slate-400",children:"Here's what's happening across your infrastructure"})]}),e.jsx(ph,{time:t})]}),Gx=({metrics:t})=>e.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:t.map((s,a)=>e.jsx(hh,{label:s.label,value:s.value,change:s.change,trend:s.trend,icon:s.icon,color:s.color},a))}),Vx=({platforms:t,summaryStats:s})=>e.jsxs(y,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsx(B,{title:"Platform Distribution"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-4",children:t.map((a,r)=>e.jsx(Om,{label:a.name,value:a.value,color:a.color},r))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700 grid grid-cols-3 gap-4",children:[e.jsx(Hn,{label:"Compliance",value:s.compliance,valueColor:"text-emerald-400"}),e.jsx(Hn,{label:"Uptime",value:s.uptime,valueColor:"text-cyan-400"}),e.jsx(Hn,{label:"Avg Latency",value:s.avgLatency,valueColor:"text-purple-400"})]})]})]}),Ux=({activities:t})=>e.jsxs(y,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-white",children:"Recent Activity"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Last 24 hours"})]}),e.jsx("div",{className:"divide-y divide-slate-700",children:t.map(s=>e.jsx(Hx,{activity:s},s.id))})]}),Hx=({activity:t})=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Zo,{status:t.status,size:"sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white text-sm font-medium",children:t.action}),e.jsxs("div",{className:"text-xs text-slate-400",children:[e.jsx("span",{className:"font-mono text-cyan-400",children:t.target}),e.jsx("span",{className:"mx-2",children:""}),e.jsx("span",{children:t.user})]})]})]}),e.jsx("span",{className:"text-xs text-slate-500",children:t.time})]})}),Wx=({onNavigate:t})=>{const s=[{id:"firewall-whitelisting",title:"Firewall Whitelisting (L1 Guided)",description:"L1 guided workflow for firewall rule creation with automated validation",icon:"",gradientFrom:"from-blue-600",gradientTo:"to-blue-800",route:"l1whitelisting",badge:"L1 Guided"},{id:"traffic-path-analysis",title:"Traffic Path Analysis",description:"Visualize network traffic flow across multi-cloud infrastructure with graph view",icon:"",gradientFrom:"from-purple-600",gradientTo:"to-purple-800",route:"pathanalysisenhanced"},{id:"multi-cloud-route-validation",title:"Multi-Cloud Route Validation",description:"Unified view of network routes across AWS, Azure, GCP, OCI & On-Prem",icon:"",gradientFrom:"from-cyan-600",gradientTo:"to-cyan-800",route:"multicloudvisibility"},{id:"firewall-patch-management",title:"Firewall Patch Management",description:"Track unpatched firewalls, CVE vulnerabilities, and security updates",icon:"",gradientFrom:"from-green-600",gradientTo:"to-green-800",route:"compliance"},{id:"compliance-drift-reports",title:"Compliance & Drift Reports",description:"Monitor compliance frameworks, detect configuration drift, and view audit reports",icon:"",gradientFrom:"from-amber-600",gradientTo:"to-amber-800",route:"compliance"},{id:"incident-root-cause-analysis",title:"Incident Root Cause Analysis",description:"AI-powered correlation and root cause identification for network incidents",icon:"",gradientFrom:"from-red-600",gradientTo:"to-red-800",route:"incidents"}];return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Quick Access to Key Features"}),e.jsx("span",{className:"px-3 py-1 bg-cyan-500/20 text-cyan-400 rounded-full text-xs font-semibold border border-cyan-500/30",children:"6 Features"})]}),e.jsx("p",{className:"text-slate-400",children:"Click on any tile below to navigate directly to the feature. Each module provides specialized AI-powered capabilities for network operations."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(a=>e.jsx("div",{onClick:()=>t(a.route),onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),t(a.route))},role:"button",tabIndex:0,"aria-label":`Navigate to ${a.title}`,className:"group cursor-pointer focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-slate-900 rounded-xl",children:e.jsx(y,{variant:"gradient",padding:"none",hover:!0,className:`bg-gradient-to-br ${a.gradientFrom} ${a.gradientTo} border-0 h-full overflow-hidden shadow-lg group-hover:shadow-2xl transition-shadow`,children:e.jsxs("div",{className:"p-6 relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}})}),a.badge&&e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsx("span",{className:"px-2 py-1 bg-white/20 backdrop-blur-sm rounded-full text-xs font-semibold text-white border border-white/30",children:a.badge})}),e.jsx("div",{className:"mb-4 relative z-10",children:e.jsx("div",{className:"w-14 h-14 bg-white/10 backdrop-blur-sm rounded-xl flex items-center justify-center text-3xl group-hover:scale-110 group-hover:rotate-3 transition-all duration-300 shadow-lg",children:a.icon})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2 group-hover:translate-x-1 transition-transform",children:a.title}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:a.description})]}),e.jsxs("div",{className:"mt-4 flex items-center text-white/60 group-hover:text-white group-hover:translate-x-2 transition-all relative z-10",children:[e.jsx("span",{className:"text-sm font-medium",children:"Launch Module"}),e.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})},a.id))})]})},zx=t=>t<.1?"success":t<1?"warning":"error",hs=t=>t<60?"success":t<80?"warning":"error",$x=({stats:t})=>{const s=zx(t.packetDropRate);return e.jsx(y,{className:"bg-white shadow-lg h-full",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Statistics"}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Packet Drop Rate"}),e.jsxs(F,{variant:s,children:[t.packetDropRate.toFixed(2),"%"]})]}),e.jsx(ca,{value:Math.min(t.packetDropRate*10,100),max:100,color:s==="success"?"green":s==="warning"?"yellow":"red"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s==="success"&&"Excellent - Network is performing well",s==="warning"&&"Elevated - Monitor for potential issues",s==="error"&&"Critical - Investigate immediately"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Throughput"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[t.throughput.ingress.toFixed(1)," Gbps"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Ingress"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[t.throughput.egress.toFixed(1)," Gbps"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Egress"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Connections"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xl font-bold text-gray-900",children:t.connections.active.toLocaleString()}),e.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"active"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xl font-bold text-red-600",children:t.connections.blocked.toLocaleString()}),e.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"blocked/hr"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Latency"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[t.latency.avg,"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg"})]}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[t.latency.p95,"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"P95"})]}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[t.latency.p99,"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"P99"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Firewall Health"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"CPU"}),e.jsxs("span",{className:hs(t.firewallHealth.cpu)==="error"?"text-red-600":"",children:[t.firewallHealth.cpu,"%"]})]}),e.jsx(ca,{value:t.firewallHealth.cpu,max:100,color:hs(t.firewallHealth.cpu)==="success"?"blue":hs(t.firewallHealth.cpu)==="warning"?"yellow":"red"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Memory"}),e.jsxs("span",{className:hs(t.firewallHealth.memory)==="error"?"text-red-600":"",children:[t.firewallHealth.memory,"%"]})]}),e.jsx(ca,{value:t.firewallHealth.memory,max:100,color:hs(t.firewallHealth.memory)==="success"?"blue":hs(t.firewallHealth.memory)==="warning"?"yellow":"red"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Sessions"}),e.jsxs("span",{children:[t.firewallHealth.sessions,"%"]})]}),e.jsx(ca,{value:t.firewallHealth.sessions,max:100,color:"purple"})]})]})]})]})})},Bx=({onNavigate:t})=>{const s=H0(),{metrics:a,recentActivity:r,platformDistribution:n,summaryStats:i,networkStats:o,isLoading:l}=Mx(),c=d=>{t&&t(d)};return l?e.jsx(ee,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-400",children:"Loading dashboard..."})})}):e.jsxs(ee,{children:[e.jsx(Fx,{currentTime:s}),e.jsx(Gx,{metrics:a}),e.jsx(Wx,{onNavigate:c}),e.jsxs(U0,{cols:3,children:[e.jsx(Vx,{platforms:n,summaryStats:i}),o&&e.jsx($x,{stats:o}),e.jsx(Ux,{activities:r})]})]})},Zx={compliant:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30",label:"Compliant"},drift_detected:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30",label:"Drift Detected"},critical_drift:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30",label:"Critical Drift"},unknown:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30",label:"Unknown"}},qx={critical:{color:"text-red-400",bg:"bg-red-500/20"},high:{color:"text-orange-400",bg:"bg-orange-500/20"},medium:{color:"text-amber-400",bg:"bg-amber-500/20"},low:{color:"text-yellow-400",bg:"bg-yellow-500/20"},info:{color:"text-blue-400",bg:"bg-blue-500/20"}},Kx=({drifts:t})=>{const[s,a]=v.useState(null),r=t.filter(o=>o.status==="critical_drift").length,n=t.filter(o=>o.status==="drift_detected").length,i=t.filter(o=>o.aiAnalysis.autoRemediationPossible).length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Firewalls"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:t.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical Drift"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:r})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Drift Detected"}),e.jsx("p",{className:"text-3xl font-bold text-amber-400",children:n})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Remediation"}),e.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:i})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Policy Drift Detection"}),e.jsx("div",{className:"space-y-3",children:t.map(o=>{const l=Zx[o.status];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>a(o),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-white font-semibold",children:o.firewallName}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:o.vendor.replace("_"," ").toUpperCase()}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${l.bg} ${l.border} ${l.color}`,children:l.label})]}),e.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:["Baseline: ",o.baselineName," v",o.baselineVersion]}),e.jsxs("p",{className:"text-slate-500 text-xs",children:["Location: ",o.location]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Drift Items"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:o.driftItems.length})]})]}),o.aiAnalysis.violatesBaseline.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-600",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("span",{className:"text-red-400 text-sm",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-red-400 text-sm font-medium mb-1",children:"Baseline Violations:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:o.aiAnalysis.violatesBaseline.map((c,d)=>e.jsx("span",{className:"px-2 py-1 bg-red-500/10 text-red-400 rounded text-xs",children:c},d))})]})]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:o.aiAnalysis.autoRemediationPossible?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-emerald-400 text-sm",children:""}),e.jsx("span",{className:"text-emerald-400 text-sm font-medium",children:"Auto-remediation: Available"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-amber-400 text-sm",children:""}),e.jsx("span",{className:"text-amber-400 text-sm font-medium",children:"Auto-remediation: Manual Required"})]})})]})]},o.id)})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:s.firewallName}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Drift Details & Remediation Plan"})]}),e.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Configuration Drift Items"}),e.jsx("div",{className:"space-y-3",children:s.driftItems.map(o=>{const l=qx[o.severity];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${l.bg} ${l.color}`,children:o.severity.toUpperCase()}),e.jsx("span",{className:"px-2 py-1 bg-slate-600 text-slate-300 rounded text-xs",children:o.type.replace("_"," ").toUpperCase()})]})}),e.jsx("p",{className:"text-white font-medium mb-2",children:o.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Baseline:"}),e.jsx("p",{className:"text-slate-300 font-mono text-xs",children:o.baseline})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Current:"}),e.jsx("p",{className:"text-amber-400 font-mono text-xs",children:o.current})]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-600",children:e.jsxs("p",{className:"text-red-400 text-xs",children:["Impact: ",o.impact]})})]},o.id)})})]}),e.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsxs("h3",{className:"text-cyan-400 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"AI Analysis"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Reasoning:"}),e.jsx("p",{className:"text-white text-sm",children:s.aiAnalysis.reasoning})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Confidence Level:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-emerald-500",style:{width:`${s.aiAnalysis.confidence*100}%`}})}),e.jsxs("span",{className:"text-white text-sm font-semibold",children:[(s.aiAnalysis.confidence*100).toFixed(0),"%"]})]})]}),s.aiAnalysis.autoRemediationPossible&&s.aiAnalysis.remediationSteps&&e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-400 text-sm font-medium mb-2",children:" Auto-Remediation Steps:"}),e.jsx("ol",{className:"space-y-1 ml-4",children:s.aiAnalysis.remediationSteps.map((o,l)=>e.jsxs("li",{className:"text-slate-300 text-sm",children:[l+1,". ",o]},l))})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-between",children:[e.jsx("button",{className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Export Report"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),s.aiAnalysis.autoRemediationPossible&&e.jsx("button",{className:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-500 transition-colors",children:"Execute Auto-Remediation"})]})]})]})})]})},Qx={unused:{color:"text-red-400",bg:"bg-red-500/20",label:"Unused",icon:""},low_usage:{color:"text-amber-400",bg:"bg-amber-500/20",label:"Low Usage",icon:""},high_usage:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"High Usage",icon:""},active:{color:"text-cyan-400",bg:"bg-cyan-500/20",label:"Active",icon:""}},Yx=({hitCounts:t})=>{const s=t.filter(n=>n.status==="unused"),a=t.filter(n=>n.status==="low_usage"),r=t.filter(n=>n.autoRemediationPossible).length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Rules"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:t.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Unused Rules"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:s.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Low Usage"}),e.jsx("p",{className:"text-3xl font-bold text-amber-400",children:a.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Removable"}),e.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:r})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Firewall Rule Hit Count Analysis"}),e.jsx("div",{className:"space-y-2",children:t.map(n=>{const i=Qx[n.status];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-xl",children:i.icon}),e.jsx("h4",{className:"text-white font-semibold",children:n.ruleName}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:n.vendor.replace("_"," ").toUpperCase()}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${i.bg} ${i.color}`,children:i.label}),n.autoRemediationPossible&&e.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-xs",children:"Auto-Removable"})]}),e.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:["Firewall: ",n.firewallName]}),e.jsxs("p",{className:"text-slate-500 text-xs",children:["Rule ID: ",n.ruleId]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Hit Count"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:n.hitCount.toLocaleString()}),e.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:[n.daysActive," days active"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-600",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Last Hit:"}),e.jsx("p",{className:"text-white",children:n.lastHit?new Date(n.lastHit).toLocaleString():"Never"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Created:"}),e.jsx("p",{className:"text-white",children:new Date(n.createdAt).toLocaleDateString()})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-cyan-400 text-sm",children:[" Recommendation: ",n.recommendation]})})]})]},n.id)})})]})]})},Xx={critical:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30"},high:{color:"text-orange-400",bg:"bg-orange-500/20",border:"border-orange-500/30"},medium:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30"},low:{color:"text-yellow-400",bg:"bg-yellow-500/20",border:"border-yellow-500/30"},info:{color:"text-blue-400",bg:"bg-blue-500/20",border:"border-blue-500/30"}},Jx={aws:"bg-orange-500/20 text-orange-400",azure:"bg-blue-500/20 text-blue-400",gcp:"bg-red-500/20 text-red-400",oci:"bg-orange-600/20 text-orange-500"},eg=({violations:t})=>{var o;const[s,a]=v.useState(null),r=t.filter(l=>l.severity==="critical").length,n=t.filter(l=>l.severity==="high").length,i=t.filter(l=>l.aiRemediation.autoRemediationPossible).length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Violations"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:t.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:r})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"High Severity"}),e.jsx("p",{className:"text-3xl font-bold text-orange-400",children:n})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Fixable"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:i})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Cloud NSG/Security Group Violations"}),e.jsx("div",{className:"space-y-3",children:t.map(l=>{const c=Xx[l.severity],d=Jx[l.provider];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>a(l),children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${c.bg} ${c.border} ${c.color}`,children:l.severity.toUpperCase()}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${d}`,children:l.provider.toUpperCase()}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:l.resourceType.replace("_"," ")})]}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:l.resourceName}),e.jsx("p",{className:"text-slate-400 text-sm mb-2",children:l.description}),e.jsxs("p",{className:"text-slate-500 text-xs",children:["Region: ",l.region," | Account: ",l.accountId]})]})}),l.baselineViolation&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-400",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-red-400 text-sm font-medium mb-1",children:["Violates: ",l.baselineViolation.baselineName]}),e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:l.baselineViolation.requirement}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:l.baselineViolation.complianceFramework.map((h,u)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/10 text-red-400 rounded text-xs",children:h},u))})]})]})}),e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600",children:l.aiRemediation.autoRemediationPossible?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-emerald-400",children:""}),e.jsxs("span",{className:"text-emerald-400 text-sm font-medium",children:["Auto-remediation available (",l.aiRemediation.estimatedTime,")"]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-amber-400",children:""}),e.jsx("span",{className:"text-amber-400 text-sm font-medium",children:"Manual remediation required"})]})})]},l.id)})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:s.resourceName}),e.jsx("p",{className:"text-slate-400 text-sm",children:s.description})]}),e.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Affected Rules"}),e.jsx("div",{className:"space-y-2",children:s.affectedRules.map(l=>e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded border border-slate-600",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:l.ruleName}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Protocol:"}),e.jsx("p",{className:"text-white font-mono",children:l.protocol})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Port Range:"}),e.jsx("p",{className:"text-white font-mono",children:l.portRange})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Source:"}),e.jsx("p",{className:"text-white font-mono text-xs",children:l.sourceRange})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Destination:"}),e.jsx("p",{className:"text-white font-mono text-xs",children:l.destinationRange})]})]}),e.jsxs("p",{className:"text-red-400 text-xs mt-2",children:[" ",l.issue]})]},l.ruleId))})]}),e.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsx("h3",{className:"text-cyan-400 font-semibold mb-3",children:"AI Remediation Plan"}),e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:s.aiRemediation.reasoning}),s.aiRemediation.autoRemediationPossible&&s.aiRemediation.remediationPlan?e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-400 text-sm font-medium mb-2",children:"Automated Steps:"}),e.jsx("ol",{className:"space-y-1 ml-4",children:s.aiRemediation.remediationPlan.map((l,c)=>e.jsxs("li",{className:"text-slate-300 text-sm",children:[c+1,". ",l]},c))}),e.jsxs("p",{className:"text-slate-400 text-xs mt-3",children:["Estimated Time: ",s.aiRemediation.estimatedTime," | Risk: ",s.aiRemediation.riskLevel]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 text-sm font-medium mb-2",children:"Manual Steps Required:"}),e.jsx("ol",{className:"space-y-1 ml-4",children:(o=s.aiRemediation.manualSteps)==null?void 0:o.map((l,c)=>e.jsxs("li",{className:"text-slate-300 text-sm",children:[c+1,". ",l]},c))})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),s.aiRemediation.autoRemediationPossible&&e.jsx("button",{className:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-500 transition-colors",children:"Execute Remediation"})]})]})})]})},tg={expired:{color:"text-red-400",bg:"bg-red-500/20",label:"Expired",icon:""},expiring_soon:{color:"text-amber-400",bg:"bg-amber-500/20",label:"Expiring Soon",icon:""},active:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Active",icon:""},removed:{color:"text-slate-400",bg:"bg-slate-500/20",label:"Removed",icon:""}},sg={low:{color:"text-emerald-400",label:"Low Risk"},medium:{color:"text-amber-400",label:"Medium Risk"},high:{color:"text-red-400",label:"High Risk"}},ag=({whitelists:t})=>{const s=t.filter(n=>n.status==="expired"),a=t.filter(n=>n.status==="expiring_soon"),r=t.filter(n=>n.autoRemovalPossible&&n.status==="expired").length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Whitelists"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:t.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Expired"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:s.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Expiring Soon"}),e.jsx("p",{className:"text-3xl font-bold text-amber-400",children:a.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Removable"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:r})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Expired & Expiring Whitelist Rules"}),e.jsx("div",{className:"space-y-3",children:t.map(n=>{const i=tg[n.status],o=sg[n.removalRisk];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:i.icon}),e.jsx("h4",{className:"text-white font-semibold",children:n.ruleName}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${i.bg} ${i.color}`,children:i.label}),n.status==="expired"&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/10 text-red-400 rounded text-xs",children:[n.daysOverdue," days overdue"]}),n.autoRemovalPossible&&n.status==="expired"&&e.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-xs",children:"Auto-Removable"})]}),e.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:["Firewall: ",n.firewallName]}),e.jsxs("p",{className:"text-slate-400 text-sm",children:["Ticket: ",n.ticketId," | Requested by: ",n.requestedBy]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:`${o.color} text-sm font-medium`,children:o.label})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-3 p-3 bg-slate-800/50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Source IP"}),e.jsx("p",{className:"text-white font-mono text-sm",children:n.sourceIp})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Destination IP"}),e.jsx("p",{className:"text-white font-mono text-sm",children:n.destinationIp})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Port"}),e.jsx("p",{className:"text-white font-mono text-sm",children:n.port})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Protocol"}),e.jsx("p",{className:"text-white font-mono text-sm",children:n.protocol.toUpperCase()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Created:"}),e.jsx("p",{className:"text-white",children:new Date(n.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Expires:"}),e.jsx("p",{className:"text-white",children:new Date(n.expiresAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mb-3 p-3 bg-slate-800/50 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Business Justification:"}),e.jsx("p",{className:"text-slate-300 text-sm",children:n.businessJustification})]}),e.jsx("div",{className:"pt-3 border-t border-slate-600",children:e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("span",{className:"text-cyan-400",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-cyan-400 text-sm font-medium mb-1",children:"AI Analysis:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Still in Use:"}),e.jsx("p",{className:n.aiAnalysis.stillInUse?"text-amber-400 font-medium":"text-emerald-400 font-medium",children:n.aiAnalysis.stillInUse?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Usage Count:"}),e.jsx("p",{className:"text-white font-medium",children:n.aiAnalysis.usageCount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400",children:"Last Used:"}),e.jsx("p",{className:"text-white font-medium",children:n.aiAnalysis.lastUsed?new Date(n.aiAnalysis.lastUsed).toLocaleDateString():"Never"})]})]}),e.jsx("p",{className:"text-slate-300 text-sm mt-2",children:n.aiAnalysis.removalImpact}),e.jsxs("p",{className:"text-emerald-400 text-sm mt-1",children:[" ",n.aiAnalysis.recommendation]})]})]})})]},n.id)})})]})]})},rg={critical:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30",label:"Critical",icon:""},high_priority:{color:"text-orange-400",bg:"bg-orange-500/20",border:"border-orange-500/30",label:"High Priority",icon:""},normal:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30",label:"Normal",icon:""},up_to_date:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30",label:"Up to Date",icon:""}},xc={critical:{color:"text-red-400",bg:"bg-red-500/20"},high:{color:"text-orange-400",bg:"bg-orange-500/20"},medium:{color:"text-amber-400",bg:"bg-amber-500/20"},low:{color:"text-yellow-400",bg:"bg-yellow-500/20"},info:{color:"text-blue-400",bg:"bg-blue-500/20"}},ng=({firewalls:t})=>{const[s,a]=v.useState(null),r=t.filter(o=>o.patchStatus==="critical").length,n=t.reduce((o,l)=>o+l.vulnerabilities.length,0),i=t.filter(o=>o.autoUpdateSupported).length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Firewalls"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:t.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:r})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Vulnerabilities"}),e.jsx("p",{className:"text-3xl font-bold text-orange-400",children:n})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Update"}),e.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:i})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Firewall Patch Status"}),e.jsx("div",{className:"space-y-3",children:t.map(o=>{const l=rg[o.patchStatus];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>a(o),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:l.icon}),e.jsx("h4",{className:"text-white font-semibold",children:o.firewallName}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:o.vendor.replace("_"," ").toUpperCase()}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${l.bg} ${l.border} ${l.color}`,children:l.label}),o.autoUpdateSupported&&e.jsx("span",{className:"px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:"Auto-Update Available"})]}),e.jsxs("p",{className:"text-slate-400 text-sm",children:["Location: ",o.location]})]}),e.jsx("div",{className:"text-right",children:o.patchStatus!=="up_to_date"&&e.jsxs("p",{className:"text-red-400 text-sm font-medium",children:[o.daysOutdated," days outdated"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 p-3 bg-slate-800/50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Current Version"}),e.jsx("p",{className:"text-white font-mono text-sm",children:o.currentVersion})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Latest Version"}),e.jsx("p",{className:"text-emerald-400 font-mono text-sm",children:o.latestVersion})]})]}),o.vulnerabilities.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-red-400 text-sm font-medium mb-2",children:[" Known Vulnerabilities (",o.vulnerabilities.length,"):"]}),e.jsxs("div",{className:"space-y-2",children:[o.vulnerabilities.slice(0,2).map(c=>{const d=xc[c.severity];return e.jsxs("div",{className:"p-2 bg-slate-800/50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${d.bg} ${d.color}`,children:c.severity.toUpperCase()}),e.jsx("span",{className:"text-white font-mono text-xs",children:c.cveId}),c.exploitAvailable&&e.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs",children:"Exploit Available"})]}),e.jsx("p",{className:"text-slate-300 text-xs",children:c.description})]},c.cveId)}),o.vulnerabilities.length>2&&e.jsxs("p",{className:"text-slate-400 text-xs text-center",children:["+",o.vulnerabilities.length-2," more vulnerabilities"]})]})]}),o.complianceImpact.length>0&&e.jsxs("div",{className:"mb-3 pt-3 border-t border-slate-600",children:[e.jsx("p",{className:"text-amber-400 text-sm mb-2",children:"Compliance Impact:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:o.complianceImpact.map((c,d)=>e.jsx("span",{className:"px-2 py-1 bg-amber-500/10 text-amber-400 rounded text-xs",children:c},d))})]}),o.maintenanceWindow&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-cyan-400",children:""}),e.jsx("span",{className:"text-slate-400",children:"Maintenance Window:"}),e.jsx("span",{className:"text-white",children:new Date(o.maintenanceWindow).toLocaleString()})]})]},o.id)})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:s.firewallName}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Patch Details & Vulnerability Information"})]}),e.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"All Vulnerabilities"}),e.jsx("div",{className:"space-y-3",children:s.vulnerabilities.map(o=>{const l=xc[o.severity];return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${l.bg} ${l.color}`,children:o.severity.toUpperCase()}),e.jsx("span",{className:"text-white font-mono",children:o.cveId}),o.exploitAvailable&&e.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-semibold",children:" Exploit Available"})]}),e.jsx("p",{className:"text-white mb-2",children:o.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Published:"}),e.jsx("p",{className:"text-white",children:new Date(o.published).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Patched In:"}),e.jsx("p",{className:"text-emerald-400 font-mono",children:o.patchedInVersion})]})]})]},o.cveId)})})]}),s.affectedServices.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Affected Services"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.affectedServices.map((o,l)=>e.jsx("span",{className:"px-3 py-2 bg-amber-500/10 text-amber-400 rounded border border-amber-500/30",children:o},l))})]}),e.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsx("h3",{className:"text-cyan-400 font-semibold mb-2",children:"Update Risk Assessment"}),e.jsxs("p",{className:"text-white text-sm",children:["Update Risk: ",e.jsx("span",{className:"font-semibold",children:s.updateRisk.toUpperCase()})]}),s.autoUpdateSupported&&e.jsx("p",{className:"text-emerald-400 text-sm mt-2",children:" Automatic updates supported for this firewall"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),e.jsx("button",{className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors",children:"Schedule Update"})]})]})})]})},ig=[{id:"drift-001",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",location:"us-east-1",status:"critical_drift",baselineName:"PCI-DSS Production Baseline",baselineVersion:"2.1.0",driftDetectedAt:"2024-01-18T14:30:00Z",driftItems:[{id:"drift-item-001",type:"rule_added",description:"Unauthorized rule allowing RDP from internet",severity:"critical",baseline:"No RDP access from 0.0.0.0/0",current:"RDP allowed from 0.0.0.0/0 on port 3389",impact:"Critical security exposure - PCI-DSS violation"},{id:"drift-item-002",type:"rule_modified",description:"Management access rule expanded beyond approved IPs",severity:"high",baseline:"Management access: 10.0.0.0/24",current:"Management access: 0.0.0.0/0",impact:"Increases attack surface for management interface"},{id:"drift-item-003",type:"config_changed",description:"Logging disabled for denied traffic",severity:"medium",baseline:"Log all denied traffic",current:"Logging disabled",impact:"Audit trail incomplete - SOC2 non-compliance"}],aiAnalysis:{violatesBaseline:["PCI-DSS Requirement 1.3.2","CIS AWS 5.2","SOC2 CC6.1"],autoRemediationPossible:!0,remediationSteps:["Remove unauthorized RDP rule (id: rule-12345)","Revert management access rule to 10.0.0.0/24","Re-enable logging for denied traffic","Create change ticket for audit trail"],confidence:.95,reasoning:"Changes detected are clear violations of baseline policy. All modifications can be automatically reverted without service disruption.",estimatedImpact:"low"},remediationStatus:"possible"},{id:"drift-002",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",vendor:"cisco_asa",location:"us-west-2",status:"drift_detected",baselineName:"Branch Office Standard",baselineVersion:"1.5.2",driftDetectedAt:"2024-01-19T09:15:00Z",driftItems:[{id:"drift-item-004",type:"rule_added",description:"New HTTPS rule for third-party vendor",severity:"medium",baseline:"No third-party vendor access",current:"HTTPS access to 192.168.100.0/24",impact:"Requires approval from security team"}],aiAnalysis:{violatesBaseline:["Internal Policy Section 4.2.1"],autoRemediationPossible:!1,confidence:.88,reasoning:"Rule appears to be intentional for business need. Requires security team review before removal.",estimatedImpact:"medium"},remediationStatus:"manual_required"},{id:"drift-003",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",vendor:"fortinet",location:"eu-west-1",status:"compliant",baselineName:"DMZ Hardening Standard",baselineVersion:"3.0.1",driftDetectedAt:"2024-01-15T08:00:00Z",driftItems:[],aiAnalysis:{violatesBaseline:[],autoRemediationPossible:!1,confidence:1,reasoning:"Configuration matches baseline perfectly. No violations detected.",estimatedImpact:"low"},remediationStatus:"completed"}],Xn=[{id:"hitcount-001",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",ruleName:"Legacy-App-Access",ruleId:"rule-54321",hitCount:0,lastHit:null,createdAt:"2023-03-15T10:00:00Z",daysActive:310,status:"unused",recommendation:"Rule has not been used in 310 days. Consider removing to reduce policy complexity.",autoRemediationPossible:!0},{id:"hitcount-002",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",ruleName:"Temp-Contractor-VPN",ruleId:"rule-67890",hitCount:3,lastHit:"2023-11-20T15:30:00Z",createdAt:"2023-11-01T09:00:00Z",daysActive:79,status:"low_usage",recommendation:"Low usage detected. Last hit 60 days ago. Verify if still needed.",autoRemediationPossible:!1},{id:"hitcount-003",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",vendor:"cisco_asa",ruleName:"Production-API-Gateway",ruleId:"rule-11111",hitCount:1547892,lastHit:"2024-01-19T12:45:00Z",createdAt:"2023-01-10T08:00:00Z",daysActive:374,status:"high_usage",recommendation:"Critical production rule. Do not remove.",autoRemediationPossible:!1},{id:"hitcount-004",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",vendor:"fortinet",ruleName:"Holiday-Sales-Promo",ruleId:"rule-22222",hitCount:0,lastHit:null,createdAt:"2023-12-01T00:00:00Z",daysActive:49,status:"unused",recommendation:"Promotional rule never used. Created for Black Friday event. Safe to remove.",autoRemediationPossible:!0},{id:"hitcount-005",firewallName:"CP-HQ-FW-01",firewallId:"cp-001",vendor:"checkpoint",ruleName:"Test-Environment-Access",ruleId:"rule-33333",hitCount:1,lastHit:"2024-01-05T10:00:00Z",createdAt:"2024-01-05T09:55:00Z",daysActive:14,status:"low_usage",recommendation:"Test rule with minimal usage. Validate if still required.",autoRemediationPossible:!1}],og=[{id:"violation-001",provider:"aws",resourceType:"security_group",resourceName:"prod-web-sg",resourceId:"sg-0123456789abcdef0",region:"us-east-1",accountId:"123456789012",violationType:"open_to_internet",severity:"critical",description:"Security group allows SSH access from entire internet",detectedAt:"2024-01-19T08:00:00Z",affectedRules:[{ruleId:"sgr-001",ruleName:"Allow SSH",protocol:"tcp",sourceRange:"0.0.0.0/0",destinationRange:"sg-0123456789abcdef0",portRange:"22",action:"allow",issue:"SSH exposed to internet - brute force risk"}],baselineViolation:{baselineName:"AWS Production Security Baseline",requirement:"SSH access must be restricted to corporate VPN range",expectedValue:"10.0.0.0/8",actualValue:"0.0.0.0/0",complianceFramework:["CIS AWS 5.2","NIST 800-53 AC-4"]},aiRemediation:{autoRemediationPossible:!0,remediationPlan:["Identify legitimate SSH source IPs from VPC Flow Logs","Update security group rule to restrict to 10.0.0.0/8","Verify connectivity after change","Document change in CMDB"],estimatedTime:"5 minutes",riskLevel:"low",reasoning:"SSH restriction is standard security practice. VPC Flow Logs show all legitimate access comes from corporate VPN range."}},{id:"violation-002",provider:"azure",resourceType:"nsg",resourceName:"prod-db-nsg",resourceId:"/subscriptions/xxx/resourceGroups/prod-rg/providers/Microsoft.Network/networkSecurityGroups/prod-db-nsg",region:"eastus",accountId:"sub-12345",violationType:"unauthorized_port",severity:"high",description:"Database port exposed to wider range than approved",detectedAt:"2024-01-18T16:30:00Z",affectedRules:[{ruleId:"nsg-rule-001",ruleName:"Allow-MySQL",protocol:"tcp",sourceRange:"172.16.0.0/16",destinationRange:"10.1.2.0/24",portRange:"3306",action:"allow",issue:"Source range exceeds approved application subnets"}],baselineViolation:{baselineName:"Azure Database Security Standard",requirement:"Database access restricted to application tier only",expectedValue:"172.16.10.0/24, 172.16.11.0/24",actualValue:"172.16.0.0/16",complianceFramework:["PCI-DSS 1.3.2","Azure CIS 6.4"]},aiRemediation:{autoRemediationPossible:!0,remediationPlan:["Replace broad /16 range with specific application subnets","Update NSG rule to: 172.16.10.0/24, 172.16.11.0/24","Test application connectivity","Monitor for any connection failures"],estimatedTime:"10 minutes",riskLevel:"medium",reasoning:"Legitimate application traffic uses only specific subnets. NSG flow logs confirm no traffic from other subnets in /16 range."}},{id:"violation-003",provider:"gcp",resourceType:"firewall_policy",resourceName:"dev-allow-all",resourceId:"projects/project-123/global/firewalls/dev-allow-all",region:"us-central1",accountId:"project-123",violationType:"overly_permissive",severity:"high",description:"Development firewall rule allows all protocols from anywhere",detectedAt:"2024-01-19T10:00:00Z",affectedRules:[{ruleId:"fw-rule-001",ruleName:"dev-allow-all",protocol:"all",sourceRange:"0.0.0.0/0",destinationRange:"10.10.0.0/16",portRange:"all",action:"allow",issue:"Permits any protocol/port from internet to dev environment"}],baselineViolation:{baselineName:"GCP Network Security Baseline",requirement:"Development environments must follow principle of least privilege",expectedValue:"Specific protocols and ports only",actualValue:"all/all from 0.0.0.0/0",complianceFramework:["GCP CIS 3.7","GDPR Article 32"]},aiRemediation:{autoRemediationPossible:!1,manualSteps:["Audit actual development usage patterns","Create specific rules for SSH (22), HTTP (80), HTTPS (443)","Restrict sources to developer VPN range","Remove overly permissive rule after validation"],estimatedTime:"30 minutes",riskLevel:"high",reasoning:"Development environment may have legitimate need for various protocols. Manual review required to avoid breaking developer workflows."}}],gc=[{id:"expired-001",ticketId:"INC0012345",ruleName:"Temp-Partner-API-Access",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",location:"us-east-1",sourceIp:"203.0.113.50",destinationIp:"10.100.50.100",port:"8443",protocol:"tcp",createdAt:"2023-10-01T09:00:00Z",expiresAt:"2023-12-31T23:59:59Z",status:"expired",daysOverdue:19,requestedBy:"john.doe@company.com",businessJustification:"Temporary API access for Partner XYZ integration testing",autoRemovalPossible:!0,removalRisk:"low",aiAnalysis:{stillInUse:!1,lastUsed:"2023-11-15T14:30:00Z",usageCount:47,removalImpact:"No traffic detected in last 65 days. Safe to remove.",recommendation:"Auto-remove: No recent usage, project completed, expired 19 days ago."}},{id:"expired-002",ticketId:"CHG0034567",ruleName:"Q4-Vendor-FTP-Access",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",location:"us-west-2",sourceIp:"198.51.100.0/24",destinationIp:"172.16.20.50",port:"21",protocol:"tcp",createdAt:"2023-09-01T00:00:00Z",expiresAt:"2023-12-31T23:59:59Z",status:"expired",daysOverdue:19,requestedBy:"finance@company.com",businessJustification:"Q4 financial data transfer to external auditor",autoRemovalPossible:!1,removalRisk:"medium",aiAnalysis:{stillInUse:!0,lastUsed:"2024-01-18T08:00:00Z",usageCount:234,removalImpact:"Active usage detected. Recent connection 1 day ago. May impact ongoing operations.",recommendation:"Manual review required: Rule expired but still actively used. Contact requester to extend or find alternative."}},{id:"expired-003",ticketId:"INC0045678",ruleName:"Emergency-Support-Access",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",location:"eu-west-1",sourceIp:"192.0.2.100",destinationIp:"10.50.100.200",port:"22",protocol:"tcp",createdAt:"2024-01-10T18:00:00Z",expiresAt:"2024-01-17T18:00:00Z",status:"expired",daysOverdue:2,requestedBy:"ops-team@company.com",businessJustification:"Emergency SSH access for critical incident resolution",autoRemovalPossible:!0,removalRisk:"low",aiAnalysis:{stillInUse:!1,lastUsed:"2024-01-12T20:15:00Z",usageCount:8,removalImpact:"Incident resolved. No usage in last 7 days. Safe to remove.",recommendation:"Auto-remove: Emergency access no longer needed, incident closed."}},{id:"expiring-001",ticketId:"CHG0056789",ruleName:"Contractor-Remote-Access",firewallName:"CP-HQ-FW-01",firewallId:"cp-001",location:"us-east-2",sourceIp:"203.0.113.0/24",destinationIp:"10.200.50.0/24",port:"443",protocol:"tcp",createdAt:"2023-12-01T00:00:00Z",expiresAt:"2024-01-31T23:59:59Z",status:"expiring_soon",daysOverdue:0,requestedBy:"hr@company.com",businessJustification:"Contractor access for Q4 project work",autoRemovalPossible:!0,removalRisk:"low",aiAnalysis:{stillInUse:!0,lastUsed:"2024-01-19T11:00:00Z",usageCount:567,removalImpact:"Expires in 12 days. Currently active. Consider extension if contractor still working.",recommendation:"Notify requester: Rule expires soon. Extend if contractor engagement continues."}}],lg=[{id:"unpatched-001",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",location:"us-east-1",currentVersion:"10.1.9",latestVersion:"10.1.14",patchStatus:"critical",daysOutdated:45,vulnerabilities:[{cveId:"CVE-2023-12345",severity:"critical",description:"Remote code execution in management interface",exploitAvailable:!0,patchedInVersion:"10.1.10",published:"2023-12-01"},{cveId:"CVE-2023-54321",severity:"high",description:"Authentication bypass in web UI",exploitAvailable:!1,patchedInVersion:"10.1.12",published:"2023-12-15"}],maintenanceWindow:"2024-01-27T02:00:00Z",autoUpdateSupported:!0,updateRisk:"low",affectedServices:["Production Web Traffic","API Gateway"],complianceImpact:["PCI-DSS 6.2","SOC2 CC7.1","ISO 27001 A.12.6.1"]},{id:"unpatched-002",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",vendor:"cisco_asa",location:"us-west-2",currentVersion:"9.16.3",latestVersion:"9.16.5",patchStatus:"high_priority",daysOutdated:30,vulnerabilities:[{cveId:"CVE-2024-11111",severity:"high",description:"Denial of service in VPN subsystem",exploitAvailable:!1,patchedInVersion:"9.16.4",published:"2024-01-05"}],maintenanceWindow:null,autoUpdateSupported:!1,updateRisk:"medium",affectedServices:["Branch Office VPN","Remote Access"],complianceImpact:["CIS Cisco ASA 1.1.2"]},{id:"unpatched-003",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",vendor:"fortinet",location:"eu-west-1",currentVersion:"7.2.5",latestVersion:"7.2.6",patchStatus:"normal",daysOutdated:15,vulnerabilities:[{cveId:"CVE-2024-22222",severity:"medium",description:"Information disclosure in logging subsystem",exploitAvailable:!1,patchedInVersion:"7.2.6",published:"2024-01-10"}],maintenanceWindow:"2024-02-10T01:00:00Z",autoUpdateSupported:!0,updateRisk:"low",affectedServices:["DMZ Services","Public Web Servers"],complianceImpact:[]},{id:"uptodate-001",firewallName:"CP-HQ-FW-01",firewallId:"cp-001",vendor:"checkpoint",location:"us-east-2",currentVersion:"R81.20",latestVersion:"R81.20",patchStatus:"up_to_date",daysOutdated:0,vulnerabilities:[],maintenanceWindow:null,autoUpdateSupported:!0,updateRisk:"low",affectedServices:[],complianceImpact:[]}],K={totalFirewalls:12,firewallsWithDrift:3,totalNSGViolations:47,criticalViolations:8,expiredWhitelists:15,unpatchedFirewalls:3,autoRemediationAvailable:28,complianceScore:78,byFramework:{"PCI-DSS":{score:82,passed:47,failed:11,status:"partial"},SOC2:{score:88,passed:52,failed:7,status:"partial"},"CIS AWS":{score:75,passed:38,failed:12,status:"partial"},"NIST 800-53":{score:91,passed:64,failed:6,status:"compliant"},"ISO 27001":{score:85,passed:45,failed:8,status:"partial"}}},te={id:"audit-2024-01",generatedAt:"2024-01-19T14:00:00Z",period:{from:"2024-01-01T00:00:00Z",to:"2024-01-19T23:59:59Z"},summary:{totalFirewalls:12,autoRemediationAvailable:28,complianceScore:78,byFramework:{"PCI-DSS":{score:82,passed:47,failed:11,status:"partial"},SOC2:{score:88,passed:52,failed:7,status:"partial"},"CIS AWS":{score:75,passed:38,failed:12,status:"partial"},"NIST 800-53":{score:91,passed:64,failed:6,status:"compliant"},"ISO 27001":{score:85,passed:45,failed:8,status:"partial"}}},findings:[{id:"finding-001",category:"Firewall Policy Drift",severity:"critical",finding:"PA-DC-FW-01: Unauthorized RDP access rule from internet detected",evidence:['Rule "Allow-RDP-All" permits TCP/3389 from 0.0.0.0/0',"Added on 2024-01-18 14:30 UTC without change request","Violates PCI-DSS Requirement 1.3.2","Violates CIS AWS Benchmark 5.2"],remediation:"Remove unauthorized RDP rule and restrict management access to corporate VPN range (10.0.0.0/24). Create change ticket for audit trail.",status:"open"},{id:"finding-002",category:"Cloud NSG Violations",severity:"critical",finding:"AWS Security Group sg-0123456789abcdef0: SSH exposed to entire internet",evidence:['Security group "prod-web-sg" allows TCP/22 from 0.0.0.0/0',"Production workload exposure to brute force attacks","VPC Flow Logs show legitimate SSH only from 10.0.0.0/8","Violates AWS Security Best Practices"],remediation:"Update security group ingress rule to restrict SSH access to corporate VPN range (10.0.0.0/8). Verify connectivity post-change.",status:"in_progress"},{id:"finding-003",category:"Unpatched Firewalls",severity:"critical",finding:"PA-DC-FW-01: Running outdated version with 2 critical CVEs",evidence:["Current version: 10.1.9 (45 days outdated)","CVE-2023-12345: Remote code execution in management interface (CVSS 9.8)","CVE-2023-54321: Authentication bypass in web UI (CVSS 8.1)","Exploits publicly available for CVE-2023-12345"],remediation:"Schedule emergency maintenance to upgrade to version 10.1.14. Patch addresses all known critical vulnerabilities. Maintenance window: 2024-01-27 02:00 UTC.",status:"open"},{id:"finding-004",category:"Expired Whitelists",severity:"high",finding:"15 firewall rules expired and still active in production",evidence:["INC0012345: Temp-Partner-API-Access expired 19 days ago (no recent usage)","CHG0034567: Q4-Vendor-FTP-Access expired 19 days ago (still in active use)","13 additional expired rules identified across multiple firewalls","Average expiration overage: 14 days"],remediation:"Implement automated expiration checking. Remove unused expired rules (8 identified). Extend or replace actively-used expired rules (7 identified). Notify requesters for business validation.",status:"open"},{id:"finding-005",category:"Cloud NSG Violations",severity:"high",finding:"Azure NSG prod-db-nsg: Database access overly permissive",evidence:["MySQL port 3306 accessible from entire /16 range (172.16.0.0/16)","Baseline requires access limited to application tier subnets only","Flow logs confirm traffic only from 172.16.10.0/24 and 172.16.11.0/24","Violates PCI-DSS Requirement 1.3.2"],remediation:"Update NSG rule to restrict MySQL access to approved application subnets: 172.16.10.0/24, 172.16.11.0/24. Test application connectivity. Monitor for connection failures.",status:"open"},{id:"finding-006",category:"Firewall Rule Hit Count",severity:"medium",finding:"7 unused firewall rules identified across fleet",evidence:["PA-DC-FW-01: Legacy-App-Access (0 hits, 310 days active)","FGT-DMZ-01: Holiday-Sales-Promo (0 hits, 49 days active)","5 additional rules with zero hit count","Combined: 357 days of unused rule-base complexity"],remediation:"Remove unused rules to reduce policy complexity and improve firewall performance. Auto-removal available for rules with zero usage and no business justification.",status:"open"},{id:"finding-007",category:"Cloud NSG Violations",severity:"high",finding:"GCP Firewall dev-allow-all: Overly permissive development environment",evidence:["Firewall rule permits all protocols/ports from internet to dev environment","Development VPC (10.10.0.0/16) exposed to unnecessary risk","Violates principle of least privilege","GCP CIS Benchmark 3.7 violation"],remediation:"Audit actual development usage patterns. Create specific rules for required protocols (SSH/HTTP/HTTPS). Restrict sources to developer VPN range. Remove overly permissive rule.",status:"open"},{id:"finding-008",category:"Firewall Policy Drift",severity:"medium",finding:"ASA-BRANCH-01: Configuration drift from baseline detected",evidence:["New HTTPS rule added for third-party vendor access","Rule not present in approved Branch Office Standard baseline v1.5.2","Allows access to 192.168.100.0/24","No associated change request found"],remediation:"Security team review required. If legitimate business need, update baseline and document exception. Otherwise, remove rule and notify requester.",status:"open"},{id:"finding-009",category:"Unpatched Firewalls",severity:"high",finding:"ASA-BRANCH-01: VPN subsystem vulnerability unpatched",evidence:["Current version: 9.16.3 (30 days outdated)","CVE-2024-11111: Denial of service in VPN subsystem (CVSS 7.5)","Patch available in version 9.16.4","No maintenance window scheduled"],remediation:"Schedule maintenance window to upgrade to 9.16.5 (latest). Update risk: Medium. Coordinate with branch office for planned downtime.",status:"open"},{id:"finding-010",category:"Firewall Policy Drift",severity:"medium",finding:"PA-DC-FW-01: Logging disabled for denied traffic",evidence:["Baseline requires all denied traffic to be logged","Current configuration: Logging disabled","Creates gap in audit trail","SOC2 CC6.1 non-compliance"],remediation:"Re-enable logging for denied traffic. Verify log retention meets compliance requirements. Create change ticket for audit documentation.",status:"open"}],recommendations:["Implement automated drift detection with real-time alerting to catch unauthorized changes within minutes","Enable auto-remediation for low-risk violations (unused rules, expired whitelists with no usage)","Establish quarterly firewall patching cadence with emergency process for critical CVEs","Deploy automated expiration enforcement for temporary whitelist rules","Conduct monthly security group audits across all cloud providers","Implement infrastructure-as-code for firewall configurations to prevent drift","Enhance change management process to require approval before rule modifications","Create compliance dashboard for real-time framework adherence monitoring"],auditReadiness:"needs_attention"},cg=({onClose:t,onPrint:s})=>{const a=()=>{window.print(),s()},r=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"print:hidden p-4 border-b border-slate-200 flex items-center justify-between bg-slate-50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Print Preview"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Compliance & Audit Report"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded hover:bg-slate-300 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:a,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-8 print:p-0 bg-white text-slate-900",children:[e.jsxs("div",{className:"mb-8 print:mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-900 mb-2 print:text-3xl",children:"Compliance & Audit Report"}),e.jsx("p",{className:"text-slate-600 text-lg print:text-base",children:"Network Security & Policy Compliance Analysis"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-500 text-sm",children:"Report Date"}),e.jsx("p",{className:"text-slate-900 font-semibold",children:r})]})]}),e.jsx("div",{className:"h-1 bg-gradient-to-r from-cyan-500 to-blue-500 rounded mb-4"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 border border-slate-200 rounded print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-sm mb-1",children:"Report Period"}),e.jsxs("p",{className:"text-slate-900 font-semibold text-sm",children:[new Date(te.period.from).toLocaleDateString()," -"," ",new Date(te.period.to).toLocaleDateString()]})]}),e.jsxs("div",{className:"p-4 border border-slate-200 rounded print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-sm mb-1",children:"Overall Compliance Score"}),e.jsxs("p",{className:"text-slate-900 font-bold text-2xl print:text-xl",children:[K.complianceScore,"%"]})]}),e.jsxs("div",{className:"p-4 border border-slate-200 rounded print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-sm mb-1",children:"Audit Readiness"}),e.jsx("p",{className:"text-slate-900 font-semibold capitalize text-sm",children:te.auditReadiness.replace("_"," ")})]})]})]}),e.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Executive Summary"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-slate-50 rounded print:bg-white print:border print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Total Firewalls"}),e.jsx("p",{className:"text-slate-900 font-bold text-2xl print:text-xl",children:K.totalFirewalls})]}),e.jsxs("div",{className:"p-4 bg-red-50 rounded print:bg-white print:border print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Firewalls with Drift"}),e.jsx("p",{className:"text-red-600 font-bold text-2xl print:text-xl",children:K.firewallsWithDrift})]}),e.jsxs("div",{className:"p-4 bg-orange-50 rounded print:bg-white print:border print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Critical Violations"}),e.jsx("p",{className:"text-orange-600 font-bold text-2xl print:text-xl",children:K.criticalViolations})]}),e.jsxs("div",{className:"p-4 bg-emerald-50 rounded print:bg-white print:border print:border-slate-300",children:[e.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Auto-Remediation"}),e.jsx("p",{className:"text-emerald-600 font-bold text-2xl print:text-xl",children:K.autoRemediationAvailable})]})]})]}),e.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Compliance by Framework"}),e.jsx("div",{className:"space-y-3",children:Object.entries(K.byFramework).map(([n,i])=>e.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:n}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-slate-600 text-sm",children:[i.passed,"/",i.passed+i.failed," controls"]}),e.jsxs("span",{className:`font-bold text-lg ${i.score>=90?"text-emerald-600":i.score>=75?"text-amber-600":"text-red-600"}`,children:[i.score,"%"]})]})]}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden print:bg-slate-100",children:e.jsx("div",{className:`h-full ${i.score>=90?"bg-emerald-500 print:bg-emerald-400":i.score>=75?"bg-amber-500 print:bg-amber-400":"bg-red-500 print:bg-red-400"}`,style:{width:`${i.score}%`}})})]},n))})]}),e.jsxs("section",{className:"mb-8 print:mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Key Findings"}),e.jsx("div",{className:"space-y-4",children:te.findings.slice(0,10).map((n,i)=>e.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300 print:break-inside-avoid",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-slate-500 text-sm font-mono",children:["#",i+1]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${n.severity==="critical"?"bg-red-100 text-red-700 print:border print:border-red-300":n.severity==="high"?"bg-orange-100 text-orange-700 print:border print:border-orange-300":n.severity==="medium"?"bg-amber-100 text-amber-700 print:border print:border-amber-300":"bg-blue-100 text-blue-700 print:border print:border-blue-300"}`,children:n.severity.toUpperCase()}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-700 rounded text-xs print:border print:border-slate-300",children:n.category}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${n.status==="open"?"bg-red-50 text-red-700 print:border print:border-red-300":n.status==="in_progress"?"bg-amber-50 text-amber-700 print:border print:border-amber-300":"bg-emerald-50 text-emerald-700 print:border print:border-emerald-300"}`,children:n.status.replace("_"," ")})]}),e.jsx("h3",{className:"font-semibold text-slate-900 mb-2",children:n.finding})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-slate-600 text-sm font-semibold mb-1",children:"Evidence:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-slate-700 text-sm",children:n.evidence.map((o,l)=>e.jsx("li",{children:o},l))})]}),e.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded p-3 print:bg-white print:border-cyan-400",children:[e.jsx("p",{className:"text-slate-600 text-sm font-semibold mb-1",children:"Remediation:"}),e.jsx("p",{className:"text-slate-700 text-sm",children:n.remediation})]})]},n.id))})]}),e.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Recommendations"}),e.jsx("div",{className:"space-y-3",children:te.recommendations.map((n,i)=>e.jsxs("div",{className:"flex gap-3 p-4 bg-slate-50 rounded border border-slate-200 print:bg-white print:border-slate-300",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-cyan-500 text-white rounded-full flex items-center justify-center text-sm font-bold print:bg-cyan-400",children:i+1}),e.jsx("p",{className:"text-slate-700 text-sm flex-1",children:n})]},i))})]}),e.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Detailed Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Policy Drift"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total NSG Violations:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:K.totalNSGViolations})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Expired Whitelists:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:K.expiredWhitelists})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Unpatched Firewalls:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:K.unpatchedFirewalls})]})]})]}),e.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Findings Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Findings:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:te.findings.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Open Issues:"}),e.jsx("span",{className:"font-semibold text-red-600",children:te.findings.filter(n=>n.status==="open").length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"In Progress:"}),e.jsx("span",{className:"font-semibold text-amber-600",children:te.findings.filter(n=>n.status==="in_progress").length})]})]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200 text-center text-slate-500 text-sm print:border-slate-300 print:mt-6 print:pt-4",children:[e.jsx("p",{children:"Generated by Network AIOps Platform - Compliance & Audit Module"}),e.jsxs("p",{className:"mt-1",children:["Report ID: ",te.id," | Generated: ",r]}),e.jsx("p",{className:"mt-2 text-xs",children:"This report is confidential and intended for internal use only"})]})]})})]}),e.jsx("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 2cm;
          }

          body {
            print-color-adjust: exact;
            -webkit-print-color-adjust: exact;
          }

          .print\\:hidden {
            display: none !important;
          }

          .print\\:p-0 {
            padding: 0 !important;
          }

          .print\\:text-3xl {
            font-size: 1.875rem !important;
          }

          .print\\:text-xl {
            font-size: 1.25rem !important;
          }

          .print\\:text-base {
            font-size: 1rem !important;
          }

          .print\\:mb-6 {
            margin-bottom: 1.5rem !important;
          }

          .print\\:border {
            border-width: 1px !important;
          }

          .print\\:border-slate-300 {
            border-color: rgb(203 213 225) !important;
          }

          .print\\:border-red-300 {
            border-color: rgb(252 165 165) !important;
          }

          .print\\:border-orange-300 {
            border-color: rgb(253 186 116) !important;
          }

          .print\\:border-amber-300 {
            border-color: rgb(252 211 77) !important;
          }

          .print\\:border-blue-300 {
            border-color: rgb(147 197 253) !important;
          }

          .print\\:border-cyan-400 {
            border-color: rgb(34 211 238) !important;
          }

          .print\\:bg-white {
            background-color: white !important;
          }

          .print\\:bg-slate-100 {
            background-color: rgb(241 245 249) !important;
          }

          .print\\:bg-emerald-400 {
            background-color: rgb(52 211 153) !important;
          }

          .print\\:bg-amber-400 {
            background-color: rgb(251 191 36) !important;
          }

          .print\\:bg-red-400 {
            background-color: rgb(248 113 113) !important;
          }

          .print\\:bg-cyan-400 {
            background-color: rgb(34 211 238) !important;
          }

          .print\\:break-inside-avoid {
            break-inside: avoid !important;
          }

          .print\\:mt-6 {
            margin-top: 1.5rem !important;
          }

          .print\\:pt-4 {
            padding-top: 1rem !important;
          }
        }
      `})]})},ur={critical:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30",icon:""},high:{color:"text-orange-400",bg:"bg-orange-500/20",border:"border-orange-500/30",icon:""},medium:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30",icon:""},low:{color:"text-yellow-400",bg:"bg-yellow-500/20",border:"border-yellow-500/30",icon:""},info:{color:"text-blue-400",bg:"bg-blue-500/20",border:"border-blue-500/30",icon:""}},pr={open:{color:"text-red-400",bg:"bg-red-500/20",label:"Open"},in_progress:{color:"text-amber-400",bg:"bg-amber-500/20",label:"In Progress"},resolved:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Resolved"}},dg={ready:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Audit Ready",icon:""},needs_attention:{color:"text-amber-400",bg:"bg-amber-500/20",label:"Needs Attention",icon:""},not_ready:{color:"text-red-400",bg:"bg-red-500/20",label:"Not Ready",icon:""}},ug=()=>{const[t,s]=v.useState(null),[a,r]=v.useState("all"),[n,i]=v.useState("all"),o=te.findings.filter(u=>!(a!=="all"&&u.category!==a||n!=="all"&&u.severity!==n)),l=dg[te.auditReadiness],c=te.findings.filter(u=>u.severity==="critical").length,d=te.findings.filter(u=>u.severity==="high").length,h=te.findings.filter(u=>u.status==="open").length;return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Compliance Audit Report"}),e.jsxs("p",{className:"text-slate-400",children:["Generated: ",new Date(te.generatedAt).toLocaleString()," | Period: ",new Date(te.period.from).toLocaleDateString()," - ",new Date(te.period.to).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),e.jsxs(D,{variant:"primary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export PDF"]})]})]}),e.jsx(y,{className:`p-6 mb-6 border-2 ${l.bg.replace("/20","/30")}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-16 h-16 rounded-full ${l.bg} flex items-center justify-center text-3xl`,children:l.icon}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold ${l.color} mb-1`,children:l.label}),e.jsxs("p",{className:"text-slate-300",children:[h," open findings require attention before audit certification"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Overall Compliance Score"}),e.jsxs("p",{className:"text-5xl font-bold text-white",children:[te.summary.complianceScore,"%"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total Findings"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:te.findings.length})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Critical"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:c})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"High"}),e.jsx("p",{className:"text-3xl font-bold text-orange-400",children:d})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Open Items"}),e.jsx("p",{className:"text-3xl font-bold text-amber-400",children:h})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Auto-Fix Available"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:te.summary.autoRemediationAvailable})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total Firewalls"}),e.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:te.summary.totalFirewalls})]})]}),e.jsxs(y,{className:"p-6 mb-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Compliance Framework Status"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:Object.entries(te.summary.byFramework).map(([u,x])=>e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-white font-semibold",children:u}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${x.status==="compliant"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"}`,children:x.status==="compliant"?"":""})]}),e.jsxs("p",{className:"text-3xl font-bold text-white mb-2",children:[x.score,"%"]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden mb-2",children:e.jsx("div",{className:`h-full ${x.score>=90?"bg-emerald-500":x.score>=75?"bg-amber-500":"bg-red-500"}`,style:{width:`${x.score}%`}})}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[x.passed," passed / ",x.failed," failed"]})]},u))})]}),e.jsx(y,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-slate-400 text-sm mb-2 block",children:"Filter by Category"}),e.jsxs("select",{value:a,onChange:u=>r(u.target.value),className:"w-full px-3 py-2 bg-slate-700 text-white rounded border border-slate-600 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Firewall Policy Drift",children:"Firewall Policy Drift"}),e.jsx("option",{value:"Cloud NSG Violations",children:"Cloud NSG Violations"}),e.jsx("option",{value:"Unpatched Firewalls",children:"Unpatched Firewalls"}),e.jsx("option",{value:"Expired Whitelists",children:"Expired Whitelists"}),e.jsx("option",{value:"Firewall Rule Hit Count",children:"Firewall Rule Hit Count"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-slate-400 text-sm mb-2 block",children:"Filter by Severity"}),e.jsxs("select",{value:n,onChange:u=>i(u.target.value),className:"w-full px-3 py-2 bg-slate-700 text-white rounded border border-slate-600 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]})]})}),e.jsxs(y,{className:"p-6 mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4",children:["Audit Findings (",o.length,")"]}),e.jsx("div",{className:"space-y-3",children:o.map(u=>{const x=ur[u.severity],_=pr[u.status];return e.jsx("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>s(u),children:e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:x.icon}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${x.bg} ${x.border} ${x.color}`,children:u.severity.toUpperCase()}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:u.category}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${_.bg} ${_.color}`,children:_.label})]}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:u.finding}),e.jsxs("p",{className:"text-slate-400 text-sm mb-2",children:["Evidence: ",u.evidence.length," items documented"]}),e.jsxs("p",{className:"text-cyan-400 text-sm",children:[" Remediation: ",u.remediation.substring(0,100),"..."]})]})})},u.id)})})]}),e.jsxs(y,{className:"p-6 mb-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Audit Recommendations"}),e.jsx("div",{className:"space-y-3",children:te.recommendations.map((u,x)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-700/30 rounded",children:[e.jsx("span",{className:"text-emerald-400 text-xl mt-0.5",children:""}),e.jsx("p",{className:"text-slate-300 text-sm flex-1",children:u})]},x))})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[ur[t.severity].icon,e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${ur[t.severity].bg} ${ur[t.severity].color}`,children:t.severity.toUpperCase()}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:t.category})]}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.finding}),e.jsxs("p",{className:"text-slate-400 text-sm",children:["Finding ID: ",t.id]})]}),e.jsx("button",{onClick:()=>s(null),className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Evidence"]}),e.jsx("div",{className:"space-y-2",children:t.evidence.map((u,x)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-slate-700/30 rounded",children:[e.jsxs("span",{className:"text-amber-400 text-sm mt-0.5",children:[x+1,"."]}),e.jsx("p",{className:"text-slate-300 text-sm flex-1",children:u})]},x))})]}),e.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsxs("h3",{className:"text-cyan-400 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Recommended Remediation"]}),e.jsx("p",{className:"text-white text-sm",children:t.remediation})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-2",children:"Current Status"}),e.jsx("span",{className:`px-3 py-2 rounded text-sm font-semibold inline-block ${pr[t.status].bg} ${pr[t.status].color}`,children:pr[t.status].label})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),e.jsx("button",{className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors",children:"Mark as In Progress"})]})]})})]})},pg=()=>{const[t,s]=v.useState("overview"),[a,r]=v.useState(!1),n=[{id:"drift",title:"Firewall Policy Drift",description:"Configuration drift from baseline",icon:"",value:K.firewallsWithDrift,total:K.totalFirewalls,color:"from-red-500 to-red-600",status:"critical"},{id:"hitcount",title:"Rule Hit Count",description:"Unused and low-usage rules",icon:"",value:Xn.filter(i=>i.status==="unused"||i.status==="low_usage").length,total:Xn.length,color:"from-amber-500 to-amber-600",status:"warning"},{id:"violations",title:"Cloud NSG Violations",description:"Security group policy violations",icon:"",value:K.criticalViolations,total:K.totalNSGViolations,color:"from-orange-500 to-orange-600",status:"high"},{id:"expired",title:"Expired Whitelists",description:"Rules past expiration date",icon:"",value:K.expiredWhitelists,total:gc.length,color:"from-purple-500 to-purple-600",status:"medium"},{id:"unpatched",title:"Unpatched Firewalls",description:"Outdated firmware versions",icon:"",value:K.unpatchedFirewalls,total:K.totalFirewalls,color:"from-cyan-500 to-cyan-600",status:"info"}];return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Compliance, Drift & Audit Dashboard"}),e.jsx("p",{className:"text-slate-400",children:"Real-time compliance monitoring with AI-powered drift detection and auto-remediation"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-6",children:[e.jsxs(y,{className:"p-6 lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Overall Compliance Score"}),e.jsxs("p",{className:"text-5xl font-bold text-white",children:[K.complianceScore,"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"w-24 h-24 relative",children:e.jsxs("svg",{className:"transform -rotate-90 w-24 h-24",children:[e.jsx("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-slate-700"}),e.jsx("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:`${2*Math.PI*40}`,strokeDashoffset:`${2*Math.PI*40*(1-K.complianceScore/100)}`,className:"text-cyan-500"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"p-2 bg-emerald-500/10 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Auto-Remediation"}),e.jsxs("p",{className:"text-emerald-400 font-semibold",children:[K.autoRemediationAvailable," Available"]})]}),e.jsxs("div",{className:"p-2 bg-red-500/10 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Critical Issues"}),e.jsxs("p",{className:"text-red-400 font-semibold",children:[K.criticalViolations," Items"]})]})]})]}),e.jsxs(y,{className:"p-6 lg:col-span-3",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-3",children:"Compliance Frameworks"}),e.jsx("div",{className:"space-y-2",children:Object.entries(K.byFramework).map(([i,o])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-white",children:i}),e.jsxs("span",{className:"text-slate-400",children:[o.score,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${o.score>=90?"bg-emerald-500":o.score>=75?"bg-amber-500":"bg-red-500"}`,style:{width:`${o.score}%`}})})]},i))})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:n.map(i=>e.jsxs("button",{onClick:()=>s(i.id),className:`p-4 rounded-lg border-2 transition-all text-left ${t===i.id?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${i.color} rounded-lg flex items-center justify-center text-2xl mb-3`,children:i.icon}),e.jsx("h3",{className:"text-white font-semibold mb-1",children:i.title}),e.jsx("p",{className:"text-slate-400 text-xs mb-2",children:i.description}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[i.value,e.jsxs("span",{className:"text-sm text-slate-400 font-normal",children:[" / ",i.total]})]})]},i.id))}),t==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Compliance Overview"}),e.jsx("p",{className:"text-slate-300 mb-6",children:"Select a category above to view detailed compliance information, drift detection, and remediation options."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Key Features"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),e.jsx("span",{children:"Real-time firewall policy drift detection from baseline configurations"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),e.jsx("span",{children:"Firewall rule hit count analysis to identify unused rules"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),e.jsx("span",{children:"Cloud NSG/Security Group violation detection across AWS, Azure, GCP"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),e.jsx("span",{children:"Expired whitelist tracking with automated removal recommendations"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),e.jsx("span",{children:"Unpatched firewall detection with CVE vulnerability tracking"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"AI Capabilities"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),e.jsx("span",{children:'"This rule violates baseline X" - Automatic violation detection'})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),e.jsx("span",{children:'"Auto-remediation possible: Yes/No" - Intelligent remediation assessment'})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),e.jsx("span",{children:"Step-by-step remediation plans with confidence scores"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),e.jsx("span",{children:"Impact analysis and risk assessment for policy changes"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),e.jsx("span",{children:"Audit-ready reporting with compliance framework mapping"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Issues"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:K.firewallsWithDrift+K.totalNSGViolations+K.expiredWhitelists+K.unpatchedFirewalls})]}),e.jsx("span",{className:"text-4xl",children:""})]})}),e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Fixable"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:K.autoRemediationAvailable})]}),e.jsx("span",{className:"text-4xl",children:""})]})}),e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Audit Ready"}),e.jsxs("p",{className:"text-3xl font-bold text-cyan-400",children:[Object.values(K.byFramework).filter(i=>i.status==="compliant").length,"/",Object.keys(K.byFramework).length]})]}),e.jsx("span",{className:"text-4xl",children:""})]})})]})]}),t==="drift"&&e.jsx(Kx,{drifts:ig}),t==="hitcount"&&e.jsx(Yx,{hitCounts:Xn}),t==="violations"&&e.jsx(eg,{violations:og}),t==="expired"&&e.jsx(ag,{whitelists:gc}),t==="unpatched"&&e.jsx(ng,{firewalls:lg}),t==="audit"&&e.jsx(ug,{}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsxs(D,{variant:"ghost",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",onClick:()=>s("audit"),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"View Audit Report"]}),e.jsxs(D,{variant:"ghost",onClick:()=>r(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),e.jsxs(D,{variant:"primary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Compliance Report"]})]})]}),a&&e.jsx(cg,{onClose:()=>r(!1),onPrint:()=>r(!1)})]})},mg=(t,s,a)=>Math.max(s,Math.min(a,t)),mr=(t,s,a)=>{const r=(Math.random()-.5)*a;return mg(t+r,s.min,s.max)};function hg(){const[t,s]=v.useState({activeConnections:49,ingress:24,egress:18,firewallCpu:67}),[a,r]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const o=await Fh();s(o)}finally{r(!1)}})()},[]),v.useEffect(()=>{const i=setInterval(()=>{s(o=>({activeConnections:mr(o.activeConnections,lr.activeConnections,4),ingress:mr(o.ingress,lr.ingress,3),egress:mr(o.egress,lr.egress,2),firewallCpu:mr(o.firewallCpu,lr.firewallCpu,5)}))},Bo.REAL_TIME);return()=>clearInterval(i)},[]);const n=v.useCallback(()=>t.firewallCpu>lc.CRITICAL?"critical":t.firewallCpu>lc.WARNING?"warning":"normal",[t.firewallCpu]);return{metrics:t,isLoading:a,getFirewallCpuStatus:n}}function xg(){const[t,s]=v.useState(()=>Wh());v.useEffect(()=>{const n=setInterval(()=>{if(Math.random()>.7){const i=zh(),o=$h(i);s(l=>[o,...l].slice(0,M0.MAX_ALERTS))}},Bo.ALERTS);return()=>clearInterval(n)},[]);const a=v.useCallback(n=>{s(i=>i.map(o=>o.id===n?{...o,acknowledged:!0}:o))},[]),r=W0(t);return{alerts:t,alertCounts:r,acknowledgeAlert:a}}const gg=({currentTime:t,refreshInterval:s=2})=>e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Hm,{}),e.jsxs("span",{className:"text-slate-400",children:["Auto-refresh: ",s,"s"]})]}),e.jsx(mh,{time:t})]}),fg=({metrics:t,firewallCpuStatus:s})=>e.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[e.jsx(cr,{value:Math.round(t.activeConnections),label:"Active Connections",sublabel:"24,567 / 50,000",status:"normal",icon:""}),e.jsx(cr,{value:Math.round(t.ingress),label:"Ingress Traffic",sublabel:"2.4 Gbps",status:"good",icon:""}),e.jsx(cr,{value:Math.round(t.egress),label:"Egress Traffic",sublabel:"1.8 Gbps",status:"good",icon:""}),e.jsx(cr,{value:Math.round(t.firewallCpu),label:"Firewall CPU",sublabel:"pa-fw-prod-east",status:s,icon:""})]}),vg=()=>{const[t,s]=v.useState([]),[a,r]=v.useState([]);return v.useEffect(()=>{(async()=>{const[i,o]=await Promise.all([Gh(),Vh()]);s(i),r(o)})()},[]),e.jsxs("div",{className:"col-span-1 space-y-4",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(G0,{className:"w-5 h-5 text-cyan-400"}),"System Metrics"]}),e.jsx(yg,{stats:t}),e.jsx(bg,{platforms:a})]})},yg=({stats:t})=>{const s=a=>{const r={red:"from-red-500/20 to-red-600/10",amber:"from-amber-500/20 to-amber-600/10",emerald:"from-emerald-500/20 to-emerald-600/10",cyan:"from-cyan-500/20 to-cyan-600/10",purple:"from-purple-500/20 to-purple-600/10"};return r[a]||r.cyan};return e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map((a,r)=>e.jsx(xh,{label:a.label,value:a.value,unit:a.unit,icon:a.icon,trend:a.trend,colorClass:s(a.color)},r))})},bg=({platforms:t})=>e.jsxs(y,{variant:"bordered",className:"mt-4",children:[e.jsx("h4",{className:"text-white font-semibold mb-4",children:"Platform Status"}),e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsx(Wm,{name:s.name,status:s.status,latency:s.latency,icon:s.icon},s.name))})]}),_g=({alerts:t,onAcknowledge:s})=>{const a=W0(t);return e.jsxs(y,{variant:"bordered",padding:"none",className:"col-span-2 rounded-2xl overflow-hidden",children:[e.jsx(wg,{alertCounts:a}),e.jsx(jg,{alerts:t,onAcknowledge:s}),e.jsx(Sg,{alertCount:t.length})]})},wg=({alertCounts:t})=>e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[e.jsx(V0,{className:"w-5 h-5 text-red-400"}),"Live Alerts Feed"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-xs text-slate-400",children:[t.unacknowledged," unacknowledged"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{variant:"error",size:"sm",children:[t.critical," Critical"]}),e.jsxs(F,{variant:"warning",size:"sm",children:[t.warning," Warning"]})]})]}),jg=({alerts:t,onAcknowledge:s})=>e.jsx("div",{className:"h-[400px] overflow-y-auto",children:e.jsx("div",{className:"divide-y divide-slate-700/50",children:t.map(a=>e.jsx(Ng,{alert:a,onAcknowledge:s},a.id))})}),Ng=({alert:t,onAcknowledge:s})=>{const a=da.alert[t.type];return e.jsx("div",{className:`p-4 ${a.bg} ${a.hover} border-l-2 ${a.borderLeft} transition-all ${t.acknowledged?"opacity-50":""}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-lg mt-0.5",children:Zh(t.type)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:t.message}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-slate-400 font-mono bg-slate-700/50 px-2 py-0.5 rounded",children:t.source}),e.jsx("span",{className:"text-xs text-slate-500",children:""}),e.jsx("span",{className:"text-xs text-slate-500",children:Bh(t.time)})]})]})]}),t.acknowledged?e.jsx(F,{variant:"success",size:"sm",children:" Ack"}):e.jsx(D,{variant:"secondary",size:"sm",onClick:()=>s(t.id),children:"Acknowledge"})]})})},Sg=({alertCount:t})=>e.jsxs("div",{className:"p-3 border-t border-slate-700 bg-slate-900/50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",t," alerts"]}),e.jsx("button",{className:"text-xs text-cyan-400 hover:text-cyan-300 font-medium",children:"View All Alerts "})]}),kg=()=>{const t=v.useMemo(()=>Array.from({length:M0.TRAFFIC_GRAPH_POINTS}).map((s,a)=>({ingressHeight:20+Math.sin(a*.3)*15+Math.random()*20,egressHeight:15+Math.cos(a*.25)*10+Math.random()*15})),[]);return e.jsxs(y,{variant:"bordered",className:"mt-6 rounded-2xl",children:[e.jsx(Cg,{}),e.jsx(Ag,{data:t}),e.jsx(Tg,{})]})},Cg=()=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[e.jsx(oh,{className:"w-5 h-5 text-cyan-400"}),"Network Traffic (Last 60 Minutes)"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Jn,{color:"bg-cyan-500",label:"Ingress"}),e.jsx(Jn,{color:"bg-purple-500",label:"Egress"}),e.jsx(Jn,{color:"bg-red-500",label:"Blocked"})]})]}),Jn=({color:t,label:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 ${t} rounded-full`}),e.jsx("span",{className:"text-xs text-slate-400",children:s})]}),Ag=({data:t})=>e.jsx("div",{className:"flex items-end gap-1 h-32",children:t.map((s,a)=>e.jsxs("div",{className:"flex-1 flex flex-col gap-0.5",children:[e.jsx("div",{className:"bg-gradient-to-t from-cyan-600 to-cyan-400 rounded-t transition-all duration-300",style:{height:`${s.ingressHeight}%`}}),e.jsx("div",{className:"bg-gradient-to-t from-purple-600 to-purple-400 rounded-t transition-all duration-300",style:{height:`${s.egressHeight}%`}})]},a))}),Tg=()=>e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-slate-500",children:[e.jsx("span",{children:"-60m"}),e.jsx("span",{children:"-45m"}),e.jsx("span",{children:"-30m"}),e.jsx("span",{children:"-15m"}),e.jsx("span",{children:"Now"})]}),Pg=()=>{const t=H0(),{metrics:s,getFirewallCpuStatus:a}=hg(),{alerts:r,acknowledgeAlert:n}=xg();return e.jsxs(ee,{children:[e.jsx(gg,{currentTime:t}),e.jsx(fg,{metrics:s,firewallCpuStatus:a()}),e.jsxs(U0,{cols:3,children:[e.jsx(vg,{}),e.jsx(_g,{alerts:r,onAcknowledge:n})]}),e.jsx(kg,{})]})},Ts=[{id:"web-app",name:"web-app",displayName:"Web Application",tier:"frontend",version:"2.5.3",description:"Main customer-facing web application",owner:"frontend-team@company.com",team:"Frontend Engineering",repository:"github.com/company/web-app",endpoint:{protocol:"https",host:"app.company.com",port:443,path:"/"},health:{status:"healthy",uptime:99.95,lastCheck:"2024-01-19T14:30:00Z",healthScore:98,incidents:2},metrics:{requestsPerSecond:1250,avgLatencyMs:85,errorRate:.15,cpuUsage:45,memoryUsage:68,activeConnections:3420},dependencies:[{targetServiceId:"api-gateway",type:"api",protocol:"https",latencyMs:25,requestsPerSecond:1200,errorRate:.1,critical:!0},{targetServiceId:"cdn",type:"external",protocol:"https",latencyMs:15,requestsPerSecond:5e3,errorRate:.05,critical:!1}],tags:["react","nextjs","production","customer-facing"],environment:"production",region:"us-east-1",instances:8,containerImage:"company/web-app:2.5.3"},{id:"mobile-api",name:"mobile-api",displayName:"Mobile API Gateway",tier:"frontend",version:"1.8.2",description:"API gateway for mobile applications",owner:"mobile-team@company.com",team:"Mobile Engineering",endpoint:{protocol:"https",host:"mobile-api.company.com",port:443,path:"/api/v1"},health:{status:"healthy",uptime:99.92,lastCheck:"2024-01-19T14:30:00Z",healthScore:96,incidents:3},metrics:{requestsPerSecond:850,avgLatencyMs:95,errorRate:.2,cpuUsage:38,memoryUsage:55,activeConnections:2100},dependencies:[{targetServiceId:"api-gateway",type:"api",protocol:"https",latencyMs:30,requestsPerSecond:800,errorRate:.15,critical:!0}],tags:["kotlin","production","mobile"],environment:"production",region:"us-east-1",instances:6,containerImage:"company/mobile-api:1.8.2"},{id:"api-gateway",name:"api-gateway",displayName:"API Gateway",tier:"backend",version:"3.2.1",description:"Central API gateway for all backend services",owner:"platform-team@company.com",team:"Platform Engineering",repository:"github.com/company/api-gateway",endpoint:{protocol:"https",host:"api.company.com",port:443,path:"/api"},health:{status:"healthy",uptime:99.98,lastCheck:"2024-01-19T14:30:00Z",healthScore:99,incidents:1},metrics:{requestsPerSecond:3500,avgLatencyMs:45,errorRate:.08,cpuUsage:62,memoryUsage:75,activeConnections:8500},dependencies:[{targetServiceId:"auth-service",type:"api",protocol:"grpc",latencyMs:12,requestsPerSecond:3200,errorRate:.05,critical:!0},{targetServiceId:"user-service",type:"api",protocol:"grpc",latencyMs:18,requestsPerSecond:2800,errorRate:.06,critical:!0},{targetServiceId:"order-service",type:"api",protocol:"grpc",latencyMs:22,requestsPerSecond:1500,errorRate:.1,critical:!0},{targetServiceId:"redis-cache",type:"cache",protocol:"redis",latencyMs:3,requestsPerSecond:5e3,errorRate:.02,critical:!0}],tags:["node","express","production","critical"],environment:"production",region:"us-east-1",instances:12,containerImage:"company/api-gateway:3.2.1"},{id:"auth-service",name:"auth-service",displayName:"Authentication Service",tier:"backend",version:"2.1.0",description:"User authentication and authorization",owner:"security-team@company.com",team:"Security Engineering",endpoint:{protocol:"grpc",host:"auth.internal.company.com",port:50051},health:{status:"healthy",uptime:99.99,lastCheck:"2024-01-19T14:30:00Z",healthScore:100,incidents:0},metrics:{requestsPerSecond:3200,avgLatencyMs:15,errorRate:.03,cpuUsage:28,memoryUsage:42,activeConnections:1200},dependencies:[{targetServiceId:"postgres-users",type:"database",protocol:"sql",latencyMs:8,requestsPerSecond:2500,errorRate:.01,critical:!0},{targetServiceId:"redis-cache",type:"cache",protocol:"redis",latencyMs:2,requestsPerSecond:4e3,errorRate:.01,critical:!0}],tags:["java","spring-boot","production","security"],environment:"production",region:"us-east-1",instances:10,containerImage:"company/auth-service:2.1.0"},{id:"user-service",name:"user-service",displayName:"User Management Service",tier:"backend",version:"1.9.5",description:"User profile and account management",owner:"backend-team@company.com",team:"Backend Engineering",endpoint:{protocol:"grpc",host:"users.internal.company.com",port:50052},health:{status:"degraded",uptime:98.5,lastCheck:"2024-01-19T14:30:00Z",healthScore:82,incidents:5},metrics:{requestsPerSecond:2800,avgLatencyMs:125,errorRate:1.2,cpuUsage:78,memoryUsage:85,activeConnections:950},dependencies:[{targetServiceId:"postgres-users",type:"database",protocol:"sql",latencyMs:95,requestsPerSecond:2200,errorRate:.8,critical:!0},{targetServiceId:"s3-storage",type:"storage",protocol:"https",latencyMs:45,requestsPerSecond:500,errorRate:.1,critical:!1}],tags:["python","django","production"],environment:"production",region:"us-east-1",instances:8,containerImage:"company/user-service:1.9.5"},{id:"order-service",name:"order-service",displayName:"Order Processing Service",tier:"backend",version:"2.3.1",description:"Order creation and management",owner:"commerce-team@company.com",team:"Commerce Engineering",endpoint:{protocol:"grpc",host:"orders.internal.company.com",port:50053},health:{status:"healthy",uptime:99.8,lastCheck:"2024-01-19T14:30:00Z",healthScore:95,incidents:2},metrics:{requestsPerSecond:1500,avgLatencyMs:68,errorRate:.25,cpuUsage:52,memoryUsage:65,activeConnections:720},dependencies:[{targetServiceId:"postgres-orders",type:"database",protocol:"sql",latencyMs:35,requestsPerSecond:1200,errorRate:.15,critical:!0},{targetServiceId:"payment-service",type:"api",protocol:"grpc",latencyMs:85,requestsPerSecond:800,errorRate:.3,critical:!0},{targetServiceId:"inventory-service",type:"api",protocol:"grpc",latencyMs:42,requestsPerSecond:900,errorRate:.2,critical:!0},{targetServiceId:"kafka-events",type:"messaging",protocol:"amqp",latencyMs:8,requestsPerSecond:1500,errorRate:.05,critical:!1}],tags:["go","production","commerce"],environment:"production",region:"us-east-1",instances:10,containerImage:"company/order-service:2.3.1"},{id:"payment-service",name:"payment-service",displayName:"Payment Processing Service",tier:"backend",version:"1.5.2",description:"Payment gateway integration and processing",owner:"finance-team@company.com",team:"Finance Engineering",endpoint:{protocol:"grpc",host:"payments.internal.company.com",port:50054},health:{status:"healthy",uptime:99.95,lastCheck:"2024-01-19T14:30:00Z",healthScore:97,incidents:1},metrics:{requestsPerSecond:800,avgLatencyMs:180,errorRate:.35,cpuUsage:35,memoryUsage:48,activeConnections:420},dependencies:[{targetServiceId:"postgres-payments",type:"database",protocol:"sql",latencyMs:25,requestsPerSecond:750,errorRate:.1,critical:!0},{targetServiceId:"stripe-api",type:"external",protocol:"https",latencyMs:120,requestsPerSecond:600,errorRate:.2,critical:!0}],tags:["java","spring-boot","production","pci-compliant"],environment:"production",region:"us-east-1",instances:6,containerImage:"company/payment-service:1.5.2"},{id:"inventory-service",name:"inventory-service",displayName:"Inventory Management Service",tier:"backend",version:"1.4.0",description:"Product inventory tracking",owner:"warehouse-team@company.com",team:"Warehouse Engineering",endpoint:{protocol:"grpc",host:"inventory.internal.company.com",port:50055},health:{status:"healthy",uptime:99.7,lastCheck:"2024-01-19T14:30:00Z",healthScore:94,incidents:3},metrics:{requestsPerSecond:950,avgLatencyMs:52,errorRate:.18,cpuUsage:42,memoryUsage:58,activeConnections:580},dependencies:[{targetServiceId:"postgres-inventory",type:"database",protocol:"sql",latencyMs:28,requestsPerSecond:850,errorRate:.12,critical:!0},{targetServiceId:"redis-cache",type:"cache",protocol:"redis",latencyMs:4,requestsPerSecond:1200,errorRate:.03,critical:!1}],tags:["node","production"],environment:"production",region:"us-east-1",instances:7,containerImage:"company/inventory-service:1.4.0"},{id:"notification-service",name:"notification-service",displayName:"Notification Service",tier:"backend",version:"1.2.3",description:"Email, SMS, and push notifications",owner:"platform-team@company.com",team:"Platform Engineering",endpoint:{protocol:"grpc",host:"notifications.internal.company.com",port:50056},health:{status:"healthy",uptime:99.6,lastCheck:"2024-01-19T14:30:00Z",healthScore:93,incidents:4},metrics:{requestsPerSecond:650,avgLatencyMs:220,errorRate:.45,cpuUsage:38,memoryUsage:52,activeConnections:320},dependencies:[{targetServiceId:"kafka-events",type:"messaging",protocol:"amqp",latencyMs:12,requestsPerSecond:650,errorRate:.08,critical:!0},{targetServiceId:"sendgrid-api",type:"external",protocol:"https",latencyMs:150,requestsPerSecond:400,errorRate:.25,critical:!1},{targetServiceId:"twilio-api",type:"external",protocol:"https",latencyMs:180,requestsPerSecond:150,errorRate:.3,critical:!1}],tags:["python","celery","production"],environment:"production",region:"us-east-1",instances:5,containerImage:"company/notification-service:1.2.3"},{id:"postgres-users",name:"postgres-users",displayName:"User Database (PostgreSQL)",tier:"database",version:"14.5",description:"Primary database for user data",owner:"dba-team@company.com",team:"Database Administration",endpoint:{protocol:"sql",host:"users-db.internal.company.com",port:5432},health:{status:"degraded",uptime:99.2,lastCheck:"2024-01-19T14:30:00Z",healthScore:85,incidents:6},metrics:{requestsPerSecond:4700,avgLatencyMs:45,errorRate:.35,cpuUsage:82,memoryUsage:88,activeConnections:450},dependencies:[],tags:["postgresql","production","critical"],environment:"production",region:"us-east-1",instances:3},{id:"postgres-orders",name:"postgres-orders",displayName:"Order Database (PostgreSQL)",tier:"database",version:"14.5",description:"Primary database for order data",owner:"dba-team@company.com",team:"Database Administration",endpoint:{protocol:"sql",host:"orders-db.internal.company.com",port:5432},health:{status:"healthy",uptime:99.85,lastCheck:"2024-01-19T14:30:00Z",healthScore:96,incidents:2},metrics:{requestsPerSecond:1200,avgLatencyMs:28,errorRate:.12,cpuUsage:58,memoryUsage:72,activeConnections:280},dependencies:[],tags:["postgresql","production"],environment:"production",region:"us-east-1",instances:2},{id:"postgres-payments",name:"postgres-payments",displayName:"Payment Database (PostgreSQL)",tier:"database",version:"14.5",description:"Encrypted database for payment data",owner:"dba-team@company.com",team:"Database Administration",endpoint:{protocol:"sql",host:"payments-db.internal.company.com",port:5432},health:{status:"healthy",uptime:99.95,lastCheck:"2024-01-19T14:30:00Z",healthScore:98,incidents:1},metrics:{requestsPerSecond:750,avgLatencyMs:22,errorRate:.08,cpuUsage:42,memoryUsage:65,activeConnections:180},dependencies:[],tags:["postgresql","production","encrypted","pci-compliant"],environment:"production",region:"us-east-1",instances:2},{id:"postgres-inventory",name:"postgres-inventory",displayName:"Inventory Database (PostgreSQL)",tier:"database",version:"14.5",description:"Database for inventory tracking",owner:"dba-team@company.com",team:"Database Administration",endpoint:{protocol:"sql",host:"inventory-db.internal.company.com",port:5432},health:{status:"healthy",uptime:99.75,lastCheck:"2024-01-19T14:30:00Z",healthScore:95,incidents:2},metrics:{requestsPerSecond:850,avgLatencyMs:25,errorRate:.1,cpuUsage:48,memoryUsage:68,activeConnections:220},dependencies:[],tags:["postgresql","production"],environment:"production",region:"us-east-1",instances:2},{id:"redis-cache",name:"redis-cache",displayName:"Redis Cache Cluster",tier:"cache",version:"7.0.5",description:"Distributed cache for session and data caching",owner:"platform-team@company.com",team:"Platform Engineering",endpoint:{protocol:"redis",host:"cache.internal.company.com",port:6379},health:{status:"healthy",uptime:99.98,lastCheck:"2024-01-19T14:30:00Z",healthScore:99,incidents:0},metrics:{requestsPerSecond:10200,avgLatencyMs:2,errorRate:.01,cpuUsage:35,memoryUsage:78,activeConnections:850},dependencies:[],tags:["redis","production","cache"],environment:"production",region:"us-east-1",instances:6},{id:"kafka-events",name:"kafka-events",displayName:"Kafka Event Streaming",tier:"queue",version:"3.3.1",description:"Event streaming platform for asynchronous messaging",owner:"platform-team@company.com",team:"Platform Engineering",endpoint:{protocol:"amqp",host:"kafka.internal.company.com",port:9092},health:{status:"healthy",uptime:99.9,lastCheck:"2024-01-19T14:30:00Z",healthScore:97,incidents:1},metrics:{requestsPerSecond:2150,avgLatencyMs:8,errorRate:.04,cpuUsage:52,memoryUsage:70,activeConnections:480},dependencies:[],tags:["kafka","production","messaging"],environment:"production",region:"us-east-1",instances:5},{id:"cdn",name:"cdn",displayName:"CloudFlare CDN",tier:"external",version:"N/A",description:"Content delivery network",owner:"infrastructure-team@company.com",team:"Infrastructure",endpoint:{protocol:"https",host:"cdn.cloudflare.com",port:443},health:{status:"healthy",uptime:99.99,lastCheck:"2024-01-19T14:30:00Z",healthScore:100,incidents:0},metrics:{requestsPerSecond:5e3,avgLatencyMs:12,errorRate:.03,cpuUsage:0,memoryUsage:0,activeConnections:0},dependencies:[],tags:["external","cdn","cloudflare"],environment:"production",region:"global",instances:0},{id:"stripe-api",name:"stripe-api",displayName:"Stripe Payment API",tier:"external",version:"N/A",description:"Payment processing provider",owner:"finance-team@company.com",team:"Finance Engineering",endpoint:{protocol:"https",host:"api.stripe.com",port:443},health:{status:"healthy",uptime:99.95,lastCheck:"2024-01-19T14:30:00Z",healthScore:98,incidents:0},metrics:{requestsPerSecond:600,avgLatencyMs:120,errorRate:.2,cpuUsage:0,memoryUsage:0,activeConnections:0},dependencies:[],tags:["external","payment","stripe"],environment:"production",region:"global",instances:0},{id:"s3-storage",name:"s3-storage",displayName:"AWS S3 Storage",tier:"external",version:"N/A",description:"Object storage for user uploads",owner:"platform-team@company.com",team:"Platform Engineering",endpoint:{protocol:"https",host:"s3.amazonaws.com",port:443},health:{status:"healthy",uptime:99.99,lastCheck:"2024-01-19T14:30:00Z",healthScore:100,incidents:0},metrics:{requestsPerSecond:500,avgLatencyMs:45,errorRate:.1,cpuUsage:0,memoryUsage:0,activeConnections:0},dependencies:[],tags:["external","storage","aws"],environment:"production",region:"us-east-1",instances:0},{id:"sendgrid-api",name:"sendgrid-api",displayName:"SendGrid Email API",tier:"external",version:"N/A",description:"Email delivery service",owner:"platform-team@company.com",team:"Platform Engineering",endpoint:{protocol:"https",host:"api.sendgrid.com",port:443},health:{status:"healthy",uptime:99.9,lastCheck:"2024-01-19T14:30:00Z",healthScore:96,incidents:1},metrics:{requestsPerSecond:400,avgLatencyMs:150,errorRate:.25,cpuUsage:0,memoryUsage:0,activeConnections:0},dependencies:[],tags:["external","email","sendgrid"],environment:"production",region:"global",instances:0},{id:"twilio-api",name:"twilio-api",displayName:"Twilio SMS API",tier:"external",version:"N/A",description:"SMS delivery service",owner:"platform-team@company.com",team:"Platform Engineering",endpoint:{protocol:"https",host:"api.twilio.com",port:443},health:{status:"healthy",uptime:99.85,lastCheck:"2024-01-19T14:30:00Z",healthScore:95,incidents:2},metrics:{requestsPerSecond:150,avgLatencyMs:180,errorRate:.3,cpuUsage:0,memoryUsage:0,activeConnections:0},dependencies:[],tags:["external","sms","twilio"],environment:"production",region:"global",instances:0}],sa=Ts.flatMap(t=>t.dependencies.map(s=>({from:t.id,to:s.targetServiceId,type:s.type,protocol:s.protocol,latencyMs:s.latencyMs,requestsPerSecond:s.requestsPerSecond,errorRate:s.errorRate,bandwidth:`${(s.requestsPerSecond*.5).toFixed(1)} MB/s`,critical:s.critical}))),Ki=[{id:"issue-001",serviceId:"user-service",severity:"high",type:"latency",title:"High Database Query Latency",description:"User service experiencing elevated database query times (avg 95ms)",detectedAt:"2024-01-19T13:45:00Z",affectedServices:["user-service","api-gateway","web-app"],rootCause:"Missing database index on users.created_at column causing full table scans",recommendation:"Add composite index on (created_at, user_id) to optimize recent user queries"},{id:"issue-002",serviceId:"postgres-users",severity:"critical",type:"capacity",title:"Database Connection Pool Near Capacity",description:"User database connection pool at 90% capacity (450/500 connections)",detectedAt:"2024-01-19T14:15:00Z",affectedServices:["postgres-users","user-service","auth-service"],rootCause:"Connection leaks in user-service v1.9.5 not releasing connections properly",recommendation:"Deploy user-service v1.9.6 with connection pool management fixes"},{id:"issue-003",serviceId:"payment-service",severity:"medium",type:"error_rate",title:"Elevated Error Rate from Stripe API",description:"Payment service seeing 0.35% error rate when calling Stripe API",detectedAt:"2024-01-19T12:30:00Z",affectedServices:["payment-service","order-service"],rootCause:"Stripe API experiencing intermittent timeouts in us-east-1 region",recommendation:"Implement retry logic with exponential backoff for Stripe API calls"}],xs={services:Ts,issues:Ki},aa={totalServices:Ts.length,healthyServices:Ts.filter(t=>t.health.status==="healthy").length,degradedServices:Ts.filter(t=>t.health.status==="degraded").length,downServices:Ts.filter(t=>t.health.status==="down").length,criticalConnections:sa.filter(t=>t.critical).length,avgLatency:sa.reduce((t,s)=>t+s.latencyMs,0)/sa.length,avgErrorRate:sa.reduce((t,s)=>t+s.errorRate,0)/sa.length,totalIssues:Ki.length,criticalIssues:Ki.filter(t=>t.severity==="critical").length},Ig=()=>{const[t,s]=v.useState(null),[a,r]=v.useState("all"),[n,i]=v.useState("all"),[o,l]=v.useState(!1),c=xs.services.filter(u=>!(a!=="all"&&u.health.status!==a||n!=="all"&&u.tier!==n)),d=u=>{switch(u){case"healthy":return"emerald";case"degraded":return"amber";case"down":return"red";default:return"slate"}},h=u=>{switch(u){case"frontend":return"from-blue-600 to-blue-700";case"backend":return"from-purple-600 to-purple-700";case"database":return"from-green-600 to-green-700";case"cache":return"from-orange-600 to-orange-700";case"queue":return"from-pink-600 to-pink-700";case"external":return"from-slate-600 to-slate-700";default:return"from-gray-600 to-gray-700"}};return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Application Dependency Map"}),e.jsx("p",{className:"text-slate-400",children:"Real-time service topology with health scores and latency monitoring"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Services"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:aa.totalServices})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Healthy"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:aa.healthyServices})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Degraded"}),e.jsx("p",{className:"text-3xl font-bold text-amber-400",children:aa.degradedServices})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Avg Latency"}),e.jsxs("p",{className:"text-3xl font-bold text-cyan-400",children:[aa.avgLatency.toFixed(0),"ms"]})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Active Issues"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:aa.totalIssues})]})]}),e.jsx(y,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-400 text-sm block mb-2",children:"Status Filter"}),e.jsxs("select",{value:a,onChange:u=>r(u.target.value),className:"bg-slate-700 text-white rounded px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"healthy",children:"Healthy"}),e.jsx("option",{value:"degraded",children:"Degraded"}),e.jsx("option",{value:"down",children:"Down"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-400 text-sm block mb-2",children:"Tier Filter"}),e.jsxs("select",{value:n,onChange:u=>i(u.target.value),className:"bg-slate-700 text-white rounded px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"All Tiers"}),e.jsx("option",{value:"frontend",children:"Frontend"}),e.jsx("option",{value:"backend",children:"Backend"}),e.jsx("option",{value:"database",children:"Database"}),e.jsx("option",{value:"cache",children:"Cache"}),e.jsx("option",{value:"queue",children:"Queue"}),e.jsx("option",{value:"external",children:"External"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:o?"primary":"ghost",onClick:()=>l(!o),children:[o?" ":"","Critical Paths"]}),e.jsx(D,{variant:"secondary",children:"Export Topology"})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs(y,{className:"p-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4",children:["Service Topology (",c.length," services)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 max-h-[700px] overflow-y-auto",children:c.map(u=>{const x=d(u.health.status),_=h(u.tier),b=(t==null?void 0:t.id)===u.id,m=u.dependencies.some(T=>T.critical);return e.jsx("div",{onClick:()=>s(u),className:`p-4 rounded-lg cursor-pointer transition-all ${b?"ring-2 ring-cyan-500 scale-105":"hover:scale-102"} ${o&&!m?"opacity-40":""}`,style:{background:"linear-gradient(to br, var(--tw-gradient-stops))"},children:e.jsxs("div",{className:`bg-gradient-to-br ${_} p-4 rounded-lg`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-${x}-500 ring-2 ring-${x}-500/30`}),m&&e.jsx("span",{className:"text-xs bg-red-500/20 text-red-400 px-2 py-0.5 rounded-full",children:"Critical"})]}),e.jsx("h4",{className:"text-white font-semibold text-sm mb-1 truncate",children:u.displayName}),e.jsx("p",{className:"text-white/60 text-xs mb-3",children:u.tier}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/60",children:"Latency:"}),e.jsxs("span",{className:`font-semibold ${u.metrics.avgLatencyMs>100?"text-red-400":"text-emerald-400"}`,children:[u.metrics.avgLatencyMs,"ms"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/60",children:"RPS:"}),e.jsx("span",{className:"text-white font-semibold",children:u.metrics.requestsPerSecond})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/60",children:"Error:"}),e.jsxs("span",{className:`font-semibold ${u.metrics.errorRate>.5?"text-red-400":"text-emerald-400"}`,children:[u.metrics.errorRate.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-white/60",children:"Health:"}),e.jsxs("span",{className:"text-white font-semibold",children:[u.health.healthScore,"/100"]})]})]}),u.dependencies.length>0&&e.jsx("div",{className:"mt-2 pt-2 border-t border-white/10",children:e.jsxs("span",{className:"text-xs text-white/60",children:[u.dependencies.length," dependencies"]})})]})},u.id)})})]})}),e.jsx("div",{children:e.jsx(y,{className:"p-6 sticky top-6",children:t?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold text-lg mb-1",children:t.displayName}),e.jsx("p",{className:"text-slate-400 text-sm",children:t.description})]}),e.jsx("button",{onClick:()=>s(null),className:"text-slate-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Version"}),e.jsx("p",{className:"text-white font-mono text-sm",children:t.version})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Team"}),e.jsx("p",{className:"text-white text-sm",children:t.team})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Region"}),e.jsx("p",{className:"text-white text-sm",children:t.region})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Instances"}),e.jsx("p",{className:"text-white text-sm",children:t.instances||"N/A"})]})]}),e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg mb-6",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-2",children:"Health Status"}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-${d(t.health.status)}-500`}),e.jsx("span",{className:"text-white font-semibold capitalize",children:t.health.status})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Uptime:"}),e.jsxs("span",{className:"text-white",children:[t.health.uptime,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Health Score:"}),e.jsxs("span",{className:"text-white",children:[t.health.healthScore,"/100"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Incidents:"}),e.jsx("span",{className:t.health.incidents>0?"text-amber-400":"text-emerald-400",children:t.health.incidents})]})]})]}),e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg mb-6",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-3",children:"Performance Metrics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-400",children:"CPU Usage"}),e.jsxs("span",{className:"text-white",children:[t.metrics.cpuUsage,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${t.metrics.cpuUsage>80?"bg-red-500":"bg-cyan-500"}`,style:{width:`${t.metrics.cpuUsage}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-400",children:"Memory Usage"}),e.jsxs("span",{className:"text-white",children:[t.metrics.memoryUsage,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${t.metrics.memoryUsage>80?"bg-red-500":"bg-purple-500"}`,style:{width:`${t.metrics.memoryUsage}%`}})})]})]})]}),t.dependencies.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-slate-400 text-xs mb-3",children:["Dependencies (",t.dependencies.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.dependencies.map((u,x)=>{const _=xs.services.find(b=>b.id===u.targetServiceId);return e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded border border-slate-600 hover:border-cyan-500 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white text-sm font-semibold",children:(_==null?void 0:_.displayName)||u.targetServiceId}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[u.type," via ",u.protocol]})]}),u.critical&&e.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs",children:"Critical"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Latency:"}),e.jsxs("span",{className:`ml-1 font-semibold ${u.latencyMs>100?"text-red-400":"text-emerald-400"}`,children:[u.latencyMs,"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"RPS:"}),e.jsx("span",{className:"ml-1 text-white font-semibold",children:u.requestsPerSecond})]})]})]},x)})})]}),t.tags.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.tags.map((u,x)=>e.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:u},x))})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-slate-400 mb-2",children:"Select a service to view details"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Click on any service card to see metrics and dependencies"})]})})})]}),xs.issues.length>0&&e.jsxs(y,{className:"p-6 mt-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4",children:["Active Issues (",xs.issues.length,")"]}),e.jsx("div",{className:"space-y-3",children:xs.issues.map(u=>{const x=xs.services.find(_=>_.id===u.serviceId);return e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${u.severity==="critical"?"bg-red-500/20 text-red-400":u.severity==="high"?"bg-orange-500/20 text-orange-400":u.severity==="medium"?"bg-amber-500/20 text-amber-400":"bg-blue-500/20 text-blue-400"}`,children:u.severity.toUpperCase()}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:u.type.replace("_"," ")})]}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:u.title}),e.jsx("p",{className:"text-slate-300 text-sm mb-2",children:u.description}),e.jsxs("p",{className:"text-slate-400 text-xs",children:["Service: ",(x==null?void 0:x.displayName)||u.serviceId]})]})}),u.rootCause&&e.jsxs("div",{className:"mt-3 p-3 bg-slate-800/50 rounded",children:[e.jsx("p",{className:"text-amber-400 text-xs font-semibold mb-1",children:"Root Cause:"}),e.jsx("p",{className:"text-slate-300 text-xs",children:u.rootCause})]}),u.recommendation&&e.jsxs("div",{className:"mt-2 p-3 bg-cyan-500/10 rounded border border-cyan-500/30",children:[e.jsx("p",{className:"text-cyan-400 text-xs font-semibold mb-1",children:"Recommendation:"}),e.jsx("p",{className:"text-slate-300 text-xs",children:u.recommendation})]})]},u.id)})})]})]})},Rg={activeIncidents:3,resolvedToday:12,mttr:"1.8 hours",mttd:"3.2 minutes",automatedResolution:67,falsePositives:8,criticalIncidents:2,highSeverityIncidents:1},Eg=[{id:"INC-2024-001",title:"Database Connection Pool Exhaustion - Payment Service",description:"Payment service experiencing connection pool exhaustion leading to failed transactions and elevated error rates across payment processing pipeline",severity:"critical",status:"investigating",category:"performance",detectedAt:"2024-01-19T14:23:15Z",acknowledgedAt:"2024-01-19T14:24:30Z",detectionSource:"AI Anomaly Detection",assignedTeam:"Platform Engineering",assignedTo:"Sarah Chen",impact:{affectedUsers:15420,affectedServices:5,affectedRegions:["us-east-1","eu-west-1","ap-southeast-1"],estimatedRevenueLoss:127500,slaViolations:3,downtime:"47 minutes"},timeline:[{timestamp:"2024-01-19T14:15:00Z",event:"Payment service latency begins increasing from 45ms to 250ms",source:"APM Monitoring",severity:"medium",affectedComponents:["payment-service"]},{timestamp:"2024-01-19T14:18:30Z",event:"Database connection pool utilization reaches 95%",source:"Database Monitoring",severity:"high",affectedComponents:["payment-db-primary"]},{timestamp:"2024-01-19T14:21:00Z",event:"API Gateway reports 504 Gateway Timeout errors from payment service",source:"API Gateway Logs",severity:"high",affectedComponents:["api-gateway","payment-service"]},{timestamp:"2024-01-19T14:23:15Z",event:"AI correlation engine identifies cascading failure pattern",source:"AI Anomaly Detection",severity:"critical",affectedComponents:["payment-service","order-service","notification-service"]},{timestamp:"2024-01-19T14:24:30Z",event:"Incident acknowledged by on-call engineer",source:"Incident Management",severity:"critical",affectedComponents:[]}],correlatedEvents:[{id:"EVT-001",timestamp:"2024-01-19T14:10:00Z",source:"Load Balancer",message:"Traffic spike detected: 3.2x normal load",severity:"medium",category:"network",correlationScore:95,affectedServices:["api-gateway","payment-service"]},{id:"EVT-002",timestamp:"2024-01-19T14:12:30Z",source:"Database",message:"Slow query detected: payment_transactions table scan (1.2s avg)",severity:"high",category:"performance",correlationScore:92,affectedServices:["payment-db-primary"]},{id:"EVT-003",timestamp:"2024-01-19T14:18:45Z",source:"Application Logs",message:"Connection timeout errors increasing: 45 errors/min",severity:"high",category:"availability",correlationScore:88,affectedServices:["payment-service","order-service"]},{id:"EVT-004",timestamp:"2024-01-19T14:20:00Z",source:"User Service",message:"Retry queue depth increasing: 1,247 pending operations",severity:"medium",category:"performance",correlationScore:78,affectedServices:["user-service"]}],rootCauseAnalysis:{primaryCause:"Database connection pool misconfiguration combined with unoptimized query causing connection exhaustion under traffic spike",confidence:"high",confidenceScore:94,contributingFactors:["Connection pool max size set to 50 (insufficient for current load)","Missing index on payment_transactions.created_at column","Long-running transactions not properly timing out","Traffic spike from promotional campaign (3.2x normal load)","Connection leak in payment processing error handling path"],evidencePoints:["Database metrics show connection pool at 100% utilization","Query execution time increased 15x during incident window","No database failover or infrastructure issues detected","Connection pool monitoring shows gradual exhaustion pattern","Similar pattern observed in staging during load test last week"],affectedComponents:["payment-service","payment-db-primary","api-gateway","order-service","notification-service"],propagationPath:["payment-db-primary","payment-service","api-gateway","order-service","notification-service"],estimatedImpactRadius:5},remediationPlan:{recommendedSteps:[{order:1,action:"Immediately increase connection pool max size from 50 to 150",owner:"Platform Engineering",estimatedDuration:"5 minutes",automationAvailable:!0,riskLevel:"low",dependencies:[]},{order:2,action:"Add missing index on payment_transactions.created_at column",owner:"Database Team",estimatedDuration:"10 minutes",automationAvailable:!0,riskLevel:"low",dependencies:[1]},{order:3,action:"Implement connection timeout of 30s for payment service",owner:"Platform Engineering",estimatedDuration:"15 minutes",automationAvailable:!1,riskLevel:"medium",dependencies:[1]},{order:4,action:"Deploy connection leak fix in error handling code path",owner:"Payment Team",estimatedDuration:"20 minutes",automationAvailable:!1,riskLevel:"medium",dependencies:[1,2]},{order:5,action:"Verify metrics return to normal and monitor for 30 minutes",owner:"Platform Engineering",estimatedDuration:"30 minutes",automationAvailable:!1,riskLevel:"low",dependencies:[1,2,3,4]}],alternativeApproaches:["Scale out payment service horizontally (add 3 more instances)","Failover to secondary database with higher connection limits","Implement circuit breaker to prevent cascade failures"],preventionMeasures:["Implement dynamic connection pool sizing based on load","Add database query performance monitoring alerts","Perform load testing before promotional campaigns","Implement connection pool metrics dashboards","Add automated index analysis to CI/CD pipeline"],estimatedTotalTime:"1.5 hours",automationPotential:65},similarIncidents:[{id:"INC-2023-847",title:"Order Service Database Connection Pool Exhaustion",occurredAt:"2023-12-08T09:15:00Z",similarity:87,resolution:"Increased connection pool size and added missing indexes",resolutionTime:"2.3 hours",rootCause:"Connection pool misconfiguration with unoptimized queries"},{id:"INC-2023-623",title:"Payment Processing Degradation During Black Friday",occurredAt:"2023-11-24T18:45:00Z",similarity:78,resolution:"Scaled database connections and optimized query patterns",resolutionTime:"3.1 hours",rootCause:"Insufficient capacity planning for traffic spike"}],tags:["database","performance","connection-pool","payment-service","high-impact"],attachments:["connection-pool-metrics.png","query-analysis.pdf","incident-timeline.json"],notes:["Similar pattern detected in staging environment last week during load testing","Payment team was already working on connection management improvements","Consider implementing connection pool monitoring for all critical services"]},{id:"INC-2024-002",title:"BGP Route Leak - Network Connectivity Loss",description:"Accidental BGP route advertisement causing traffic black-holing in US-WEST region affecting multiple services",severity:"critical",status:"active",category:"network",detectedAt:"2024-01-19T13:45:22Z",acknowledgedAt:"2024-01-19T13:46:15Z",detectionSource:"Network Monitoring",assignedTeam:"Network Operations",assignedTo:"Michael Rodriguez",impact:{affectedUsers:8900,affectedServices:12,affectedRegions:["us-west-2"],estimatedRevenueLoss:95e3,slaViolations:5,downtime:"1 hour 12 minutes"},timeline:[{timestamp:"2024-01-19T13:40:00Z",event:"BGP configuration change deployed to edge router RTR-USW-01",source:"Change Management",severity:"low",affectedComponents:["RTR-USW-01"]},{timestamp:"2024-01-19T13:42:30Z",event:"Incorrect BGP route (10.0.0.0/8) advertised to upstream provider",source:"BGP Monitoring",severity:"high",affectedComponents:["RTR-USW-01","ISP-Upstream"]},{timestamp:"2024-01-19T13:45:22Z",event:"Packet loss detected across US-WEST region (78% packet loss)",source:"Network Monitoring",severity:"critical",affectedComponents:["us-west-2"]},{timestamp:"2024-01-19T13:46:15Z",event:"Network team acknowledges critical incident",source:"Incident Management",severity:"critical",affectedComponents:[]}],correlatedEvents:[{id:"EVT-101",timestamp:"2024-01-19T13:40:05Z",source:"Change Control",message:"Configuration change CHG-20240119-045 deployed",severity:"low",category:"configuration",correlationScore:98,affectedServices:["network-infrastructure"]},{id:"EVT-102",timestamp:"2024-01-19T13:43:00Z",source:"Router Telemetry",message:"Routing table size spike detected: 850K -> 1.2M routes - Unexpected routing table expansion",severity:"high",category:"network",correlationScore:96,affectedServices:["network-infrastructure"]},{id:"EVT-103",timestamp:"2024-01-19T13:45:00Z",source:"Load Balancer",message:"Health checks failing across US-WEST region",severity:"critical",category:"availability",correlationScore:91,affectedServices:["web-app","api-gateway","auth-service"]}],rootCauseAnalysis:{primaryCause:"BGP route filter misconfiguration allowed internal network prefix (10.0.0.0/8) to be advertised to upstream ISP, causing traffic black-holing",confidence:"high",confidenceScore:97,contributingFactors:["Missing route filter validation in BGP configuration","Change deployed without proper peer review","Automated validation checks did not catch route leak","No staging environment for BGP configuration testing","Route prefix list not updated for new internal subnets"],evidencePoints:["BGP routing tables show 10.0.0.0/8 advertised to AS64512","Configuration diff confirms route-map filter was removed","Upstream ISP logs show route acceptance timestamp matches incident","Traceroute shows traffic routing through ISP and not returning","Other regions unaffected, confirming localized misconfiguration"],affectedComponents:["RTR-USW-01","us-west-2","web-app","api-gateway","auth-service","payment-service"],propagationPath:["RTR-USW-01","ISP-Upstream","us-west-2-network","all-services-us-west-2"],estimatedImpactRadius:12},remediationPlan:{recommendedSteps:[{order:1,action:"Immediately withdraw incorrect BGP route advertisement",owner:"Network Operations",estimatedDuration:"2 minutes",automationAvailable:!0,riskLevel:"low",dependencies:[]},{order:2,action:"Restore previous BGP configuration from backup",owner:"Network Operations",estimatedDuration:"5 minutes",automationAvailable:!0,riskLevel:"low",dependencies:[1]},{order:3,action:"Add route filter for 10.0.0.0/8 prefix to prevent future leaks",owner:"Network Engineering",estimatedDuration:"10 minutes",automationAvailable:!1,riskLevel:"medium",dependencies:[2]},{order:4,action:"Verify routing convergence across all edge routers",owner:"Network Operations",estimatedDuration:"15 minutes",automationAvailable:!1,riskLevel:"low",dependencies:[3]}],alternativeApproaches:["Fail over traffic to US-EAST region while fixing BGP","Contact ISP to manually filter the leaked route","Temporarily disable BGP peering and use static routes"],preventionMeasures:["Implement automated BGP configuration validation","Add pre-deployment testing for route filters","Require peer review for all BGP changes","Implement route leak detection and auto-remediation","Create staging environment for network changes"],estimatedTotalTime:"45 minutes",automationPotential:75},similarIncidents:[{id:"INC-2023-512",title:"BGP Route Leak - EU Region",occurredAt:"2023-09-15T11:23:00Z",similarity:92,resolution:"Withdrew incorrect route and added prefix filters",resolutionTime:"1.2 hours",rootCause:"BGP configuration error during maintenance"}],tags:["network","bgp","routing","critical","configuration-error"],attachments:["bgp-routing-table.txt","config-diff.txt","network-topology.png"],notes:["Similar incident occurred in EU region 4 months ago","Need to implement automated BGP validation in CI/CD","Consider implementing RPKI for route origin validation"]},{id:"INC-2024-003",title:"Redis Cache Cluster Failover - Authentication Delays",description:"Redis primary node failure triggering automatic failover causing temporary authentication service degradation",severity:"high",status:"resolved",category:"availability",detectedAt:"2024-01-19T11:15:08Z",acknowledgedAt:"2024-01-19T11:16:30Z",resolvedAt:"2024-01-19T11:42:15Z",detectionSource:"Infrastructure Monitoring",assignedTeam:"Infrastructure",assignedTo:"Alex Kumar",impact:{affectedUsers:4200,affectedServices:3,affectedRegions:["us-east-1"],estimatedRevenueLoss:18e3,slaViolations:1,downtime:"27 minutes"},timeline:[{timestamp:"2024-01-19T11:12:00Z",event:"Redis primary node memory usage reaches 95%",source:"Infrastructure Monitoring",severity:"medium",affectedComponents:["redis-primary"]},{timestamp:"2024-01-19T11:15:08Z",event:"Redis primary node becomes unresponsive (OOM condition)",source:"Redis Monitoring",severity:"critical",affectedComponents:["redis-primary"]},{timestamp:"2024-01-19T11:15:45Z",event:"Automatic failover initiated to redis-replica-01",source:"Redis Sentinel",severity:"high",affectedComponents:["redis-cluster"]},{timestamp:"2024-01-19T11:17:30Z",event:"Authentication service experiencing increased latency (250ms -> 1.2s)",source:"APM",severity:"high",affectedComponents:["auth-service"]},{timestamp:"2024-01-19T11:35:00Z",event:"New redis primary fully synced and serving traffic",source:"Redis Sentinel",severity:"medium",affectedComponents:["redis-cluster"]},{timestamp:"2024-01-19T11:42:15Z",event:"All services returned to normal performance",source:"APM",severity:"low",affectedComponents:["auth-service","user-service"]}],correlatedEvents:[{id:"EVT-201",timestamp:"2024-01-19T11:10:00Z",source:"Redis",message:"Memory usage increasing rapidly: 85% -> 95% in 2 minutes",severity:"high",category:"capacity",correlationScore:93,affectedServices:["redis-primary"]},{id:"EVT-202",timestamp:"2024-01-19T11:16:00Z",source:"Auth Service",message:"Cache miss rate spiking: 5% -> 78%",severity:"high",category:"performance",correlationScore:89,affectedServices:["auth-service"]}],rootCauseAnalysis:{primaryCause:"Redis primary node ran out of memory due to session data accumulation without proper TTL expiration, triggering OOM and automatic failover",confidence:"high",confidenceScore:91,contributingFactors:["Session keys created without TTL (Time To Live) expiration","Memory eviction policy set to noeviction instead of allkeys-lru","No monitoring alerts for cache key count growth","Session cleanup job not running since 2024-01-15","Insufficient memory allocated for current load (8GB vs 12GB needed)"],evidencePoints:["Redis key count increased from 2.1M to 4.8M over 4 days","Memory analysis shows 72% used by session: keys","TTL analysis reveals 3.2M keys with no expiration set","Session cleanup job logs show last run 4 days ago","No evidence of memory leak in application code"],affectedComponents:["redis-primary","auth-service","user-service"],propagationPath:["redis-primary","auth-service","user-service","web-app"],estimatedImpactRadius:3},remediationPlan:{recommendedSteps:[{order:1,action:"Set default TTL of 24 hours for all session keys",owner:"Platform Engineering",estimatedDuration:"10 minutes",automationAvailable:!0,riskLevel:"low",dependencies:[]},{order:2,action:"Change Redis eviction policy from noeviction to allkeys-lru",owner:"Infrastructure",estimatedDuration:"5 minutes",automationAvailable:!0,riskLevel:"medium",dependencies:[]},{order:3,action:"Restart session cleanup job and verify execution",owner:"Platform Engineering",estimatedDuration:"10 minutes",automationAvailable:!1,riskLevel:"low",dependencies:[]},{order:4,action:"Increase Redis memory allocation from 8GB to 12GB",owner:"Infrastructure",estimatedDuration:"15 minutes",automationAvailable:!1,riskLevel:"medium",dependencies:[1,2,3]}],alternativeApproaches:["Implement Redis cluster sharding for better memory distribution","Move sessions to dedicated session store (separate Redis cluster)","Implement client-side session management with JWT tokens"],preventionMeasures:["Add monitoring alerts for Redis key count growth","Implement automated TTL policy enforcement","Schedule regular Redis key pattern analysis","Add memory capacity planning dashboards","Implement session cleanup job health monitoring"],estimatedTotalTime:"40 minutes",automationPotential:80},similarIncidents:[{id:"INC-2023-723",title:"Redis Memory Exhaustion - Cache Service",occurredAt:"2023-10-12T14:20:00Z",similarity:84,resolution:"Added TTL policies and increased memory allocation",resolutionTime:"1.1 hours",rootCause:"Unbounded cache key growth without expiration"}],tags:["redis","cache","availability","failover","memory"],attachments:["redis-memory-analysis.txt","key-pattern-report.csv"],notes:["Automatic failover worked as designed, minimal impact","Need to implement better cache key management practices","Consider implementing Redis monitoring dashboards for all clusters"]}],Lg=[{id:"PATTERN-001",name:"Database Connection Exhaustion Cascade",description:"Pattern of connection pool exhaustion leading to cascading failures across dependent services",occurrences:8,lastSeen:"2024-01-19T14:23:15Z",avgImpact:"High - affects 4-6 services",services:["payment-service","order-service","user-service"],confidence:87},{id:"PATTERN-002",name:"BGP Configuration Change Impact",description:"Network configuration changes causing routing issues and connectivity loss",occurrences:5,lastSeen:"2024-01-19T13:45:22Z",avgImpact:"Critical - regional outage",services:["network-infrastructure"],confidence:92},{id:"PATTERN-003",name:"Cache Failover Authentication Degradation",description:"Redis/cache failures causing authentication service slowdown during failover",occurrences:12,lastSeen:"2024-01-19T11:15:08Z",avgImpact:"Medium - temporary degradation",services:["auth-service","user-service","redis-cluster"],confidence:78},{id:"PATTERN-004",name:"Traffic Spike Capacity Threshold",description:"Unexpected traffic spikes exceeding capacity thresholds causing performance degradation",occurrences:15,lastSeen:"2024-01-19T14:10:00Z",avgImpact:"Medium-High - service degradation",services:["api-gateway","payment-service","web-app"],confidence:81},{id:"PATTERN-005",name:"Slow Query Performance Cascade",description:"Unoptimized database queries causing connection buildup and downstream failures",occurrences:18,lastSeen:"2024-01-19T14:12:30Z",avgImpact:"High - multi-service impact",services:["database-services","api-services"],confidence:85}],Og={incidents:Eg,metrics:Rg,correlationPatterns:Lg},Dg=()=>{const{incidents:t,metrics:s,correlationPatterns:a}=Og,[r,n]=v.useState(null),[i,o]=v.useState("all"),[l,c]=v.useState("all"),d=t.filter(b=>!(i!=="all"&&b.status!==i||l!=="all"&&b.severity!==l)),h=b=>{switch(b){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500"}},u=b=>{switch(b){case"critical":return"error";case"high":return"warning";case"medium":return"info";case"low":return"default"}},x=b=>{switch(b){case"active":return"text-red-400";case"investigating":return"text-yellow-400";case"resolved":return"text-green-400";case"closed":return"text-slate-400"}},_=b=>{switch(b){case"high":return"text-emerald-400";case"medium":return"text-yellow-400";case"low":return"text-orange-400";default:return"text-slate-400"}};return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Incident Correlation & Root Cause Analysis"}),e.jsx("p",{className:"text-slate-400",children:"AI-powered incident detection, correlation, and automated root cause analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s.activeIncidents}),e.jsx("div",{className:"text-xs text-slate-400",children:"Active Incidents"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-400 mb-1",children:s.resolvedToday}),e.jsx("div",{className:"text-xs text-slate-400",children:"Resolved Today"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-cyan-400 mb-1",children:s.mttr}),e.jsx("div",{className:"text-xs text-slate-400",children:"MTTR"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-400 mb-1",children:s.mttd}),e.jsx("div",{className:"text-xs text-slate-400",children:"MTTD"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-400 mb-1",children:[s.automatedResolution,"%"]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Automated"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-400 mb-1",children:s.criticalIncidents}),e.jsx("div",{className:"text-xs text-slate-400",children:"Critical"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-400 mb-1",children:s.highSeverityIncidents}),e.jsx("div",{className:"text-xs text-slate-400",children:"High Severity"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400 mb-1",children:s.falsePositives}),e.jsx("div",{className:"text-xs text-slate-400",children:"False Positives"})]})})]}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Status Filter"}),e.jsxs("select",{value:i,onChange:b=>o(b.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"investigating",children:"Investigating"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Severity Filter"}),e.jsxs("select",{value:l,onChange:b=>c(b.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Severity"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsx("div",{className:"ml-auto",children:e.jsxs("div",{className:"text-sm text-slate-400",children:["Showing ",d.length," of ",t.length," incidents"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Active Incidents"}),d.map(b=>e.jsx(y,{className:`bg-slate-800/50 border-slate-700 cursor-pointer transition-all hover:border-cyan-500 ${(r==null?void 0:r.id)===b.id?"border-cyan-500 ring-2 ring-cyan-500/50":""}`,onClick:()=>n(b),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${h(b.severity)} animate-pulse`}),e.jsx("span",{className:"text-xs font-mono text-slate-400",children:b.id})]}),e.jsx(F,{variant:u(b.severity),children:b.severity.toUpperCase()})]}),e.jsx("h3",{className:"text-white font-semibold text-sm leading-tight",children:b.title}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:`font-semibold ${x(b.status)}`,children:b.status.toUpperCase()}),e.jsx("span",{className:"text-slate-400",children:b.detectedAt})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsxs("span",{children:[" ",b.impact.affectedUsers.toLocaleString()," users"]}),e.jsx("span",{children:""}),e.jsxs("span",{children:[" ",b.impact.affectedServices," services"]})]})]})},b.id))]}),e.jsx("div",{className:"lg:col-span-2",children:r?e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{className:"bg-gradient-to-br from-red-600/20 to-rose-600/20 border-red-500/50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(F,{variant:u(r.severity),children:r.severity.toUpperCase()}),e.jsx("span",{className:"font-mono text-sm text-slate-400",children:r.id}),e.jsx("span",{className:`text-sm font-semibold ${x(r.status)}`,children:r.status.toUpperCase()})]}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:r.title}),e.jsx("p",{className:"text-slate-300",children:r.description})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-red-500/30",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Affected Users"}),e.jsx("div",{className:"text-xl font-bold text-white",children:r.impact.affectedUsers.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Affected Services"}),e.jsx("div",{className:"text-xl font-bold text-white",children:r.impact.affectedServices})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Revenue Loss"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:["$",(r.impact.estimatedRevenueLoss/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Downtime"}),e.jsx("div",{className:"text-xl font-bold text-white",children:r.impact.downtime})]})]})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Root Cause Analysis"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Confidence:"}),e.jsx(F,{variant:"success",children:e.jsxs("span",{className:_(r.rootCauseAnalysis.confidence),children:[r.rootCauseAnalysis.confidence.toUpperCase()," (",r.rootCauseAnalysis.confidenceScore,"%)"]})})]})]}),e.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-cyan-500/30",children:e.jsx("p",{className:"text-slate-200 leading-relaxed",children:r.rootCauseAnalysis.primaryCause})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Contributing Factors:"}),e.jsx("ul",{className:"space-y-2",children:r.rootCauseAnalysis.contributingFactors.map((b,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[e.jsx("span",{className:"text-yellow-400 mt-1",children:""}),e.jsx("span",{children:b})]},m))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Evidence Points:"}),e.jsx("ul",{className:"space-y-2",children:r.rootCauseAnalysis.evidencePoints.map((b,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[e.jsx("span",{className:"text-cyan-400 mt-1",children:""}),e.jsx("span",{children:b})]},m))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Propagation Path:"}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:r.rootCauseAnalysis.propagationPath.map((b,m)=>e.jsxs(Lc.Fragment,{children:[e.jsx(F,{variant:"info",className:"bg-purple-600/20 text-purple-300 border-purple-500/30",children:b}),m<r.rootCauseAnalysis.propagationPath.length-1&&e.jsx("span",{className:"text-slate-500",children:""})]},m))})]})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Remediation Plan"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:["Est. Time: ",e.jsx("span",{className:"text-white font-semibold",children:r.remediationPlan.estimatedTotalTime})]}),e.jsxs("span",{className:"text-slate-400",children:["Automation: ",e.jsxs("span",{className:"text-cyan-400 font-semibold",children:[r.remediationPlan.automationPotential,"%"]})]})]})]}),e.jsx("div",{className:"space-y-3",children:r.remediationPlan.recommendedSteps.map(b=>e.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-slate-700 hover:border-cyan-500/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:b.order}),e.jsxs("div",{className:"flex-grow space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-slate-200 font-medium",children:b.action}),b.automationAvailable&&e.jsx(F,{variant:"success",className:"ml-2 flex-shrink-0",children:"AUTO"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:["Owner: ",e.jsx("span",{className:"text-white",children:b.owner})]}),e.jsxs("span",{className:"text-slate-400",children:["Duration: ",e.jsx("span",{className:"text-white",children:b.estimatedDuration})]}),e.jsxs("span",{className:"text-slate-400",children:["Risk:"," ",e.jsx("span",{className:b.riskLevel==="high"?"text-red-400":b.riskLevel==="medium"?"text-yellow-400":"text-green-400",children:b.riskLevel.toUpperCase()})]})]})]})]})},b.order))}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Prevention Measures:"}),e.jsx("ul",{className:"space-y-2",children:r.remediationPlan.preventionMeasures.map((b,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[e.jsx("span",{className:"text-emerald-400 mt-1",children:""}),e.jsx("span",{children:b})]},m))})]})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:[" Correlated Events (",r.correlatedEvents.length,")"]}),e.jsx("div",{className:"space-y-3",children:r.correlatedEvents.map(b=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3 border border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"info",children:b.source}),e.jsx("span",{className:"text-xs text-slate-400",children:b.timestamp})]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-slate-400",children:"Correlation: "}),e.jsxs("span",{className:"text-cyan-400 font-semibold",children:[b.correlationScore,"%"]})]})]}),e.jsx("p",{className:"text-sm text-slate-300 mb-2",children:b.message}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.affectedServices.map((m,T)=>e.jsx(F,{variant:"default",className:"bg-slate-800 text-slate-300 text-xs",children:m},T))})]},b.id))})]})}),r.similarIncidents.length>0&&e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Similar Past Incidents"}),e.jsx("div",{className:"space-y-3",children:r.similarIncidents.map(b=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-xs text-slate-400",children:b.id}),e.jsxs(F,{variant:"info",className:"text-xs",children:[b.similarity,"% similar"]})]}),e.jsx("h4",{className:"text-white font-medium",children:b.title})]})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"text-slate-400",children:["Occurred: ",e.jsx("span",{className:"text-slate-300",children:b.occurredAt})]}),e.jsxs("div",{className:"text-slate-400",children:["Root Cause: ",e.jsx("span",{className:"text-slate-300",children:b.rootCause})]}),e.jsxs("div",{className:"text-slate-400",children:["Resolution: ",e.jsx("span",{className:"text-slate-300",children:b.resolution})]}),e.jsxs("div",{className:"text-slate-400",children:["Resolution Time: ",e.jsx("span",{className:"text-emerald-400 font-semibold",children:b.resolutionTime})]})]})]},b.id))})]})})]}):e.jsx(y,{className:"bg-slate-800/50 border-slate-700 h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Select an Incident"}),e.jsx("p",{className:"text-slate-400",children:"Click on an incident from the list to view detailed analysis"})]})})})]}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Detected Correlation Patterns"}),e.jsx("p",{className:"text-sm text-slate-400",children:"AI-identified patterns of recurring incidents and their common characteristics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(b=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h4",{className:"text-white font-semibold text-sm",children:b.name}),e.jsxs(F,{variant:"info",className:"text-xs",children:[b.confidence,"% confidence"]})]}),e.jsx("p",{className:"text-xs text-slate-400 mb-3",children:b.description}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Occurrences:"}),e.jsx("span",{className:"text-white font-semibold",children:b.occurrences})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Avg Impact:"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:b.avgImpact})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Last Seen:"}),e.jsx("span",{className:"text-slate-300",children:new Date(b.lastSeen).toLocaleDateString()})]})]})]},b.id))})]})})]})},Mg=()=>{const[t,s]=v.useState("aws"),[a,r]=v.useState("vpcs"),[n,i]=v.useState(null),[o,l]=v.useState([]),[c,d]=v.useState(null),[h,u]=v.useState([]),[x,_]=v.useState([]),[b,m]=v.useState(null),[T,p]=v.useState([]),[g,f]=v.useState([]),[j,N]=v.useState(!0),[S,A]=v.useState(!1),[k,I]=v.useState(null);v.useEffect(()=>{(async()=>{try{const V=await je.getOverview(t);i(V)}catch(V){I(V instanceof Error?V.message:"Failed to load overview")}})()},[t]),v.useEffect(()=>{(async()=>{N(!0),I(null),d(null),m(null),u([]);try{switch(a){case"vpcs":const V=await je.getVPCs(t);l(V);break;case"security-groups":const he=await je.getSecurityGroups(t);_(he);break;case"load-balancers":const L=await je.getLoadBalancers(t);p(L);break;case"transit-gateways":const G=await je.getTransitGateways(t);f(G);break}}catch(V){I(V instanceof Error?V.message:"Failed to load resources")}finally{N(!1)}})()},[t,a]);const E=v.useCallback(async R=>{if(!R){d(null),u([]);return}try{const[V,he]=await Promise.all([je.getVPCDetails(t,R),je.getSubnets(t,R)]);d(V),u(he)}catch(V){I(V instanceof Error?V.message:"Failed to load VPC details")}},[t]),W=v.useCallback(async R=>{if(!R){m(null);return}try{const V=await je.getSecurityGroupDetails(t,R);m(V)}catch(V){I(V instanceof Error?V.message:"Failed to load security group details")}},[t]),Z=v.useCallback(async()=>{A(!0),I(null);try{if((await je.syncResources(t)).success){const V=await je.getOverview(t);i(V)}}catch(R){I(R instanceof Error?R.message:"Failed to sync resources")}finally{A(!1)}},[t]),P=v.useCallback(async()=>{N(!0),I(null);try{const[R,V,he,L,G]=await Promise.all([je.getOverview(t),je.getVPCs(t),je.getSecurityGroups(t),je.getLoadBalancers(t),je.getTransitGateways(t)]);i(R),l(V),_(he),p(L),f(G)}catch(R){I(R instanceof Error?R.message:"Failed to refresh data")}finally{N(!1)}},[t]),w=v.useCallback(()=>{I(null)},[]);return{activeProvider:t,activeResource:a,overview:n,vpcs:o,selectedVpc:c,subnets:h,securityGroups:x,selectedSecurityGroup:b,loadBalancers:T,transitGateways:g,isLoading:j,isSyncing:S,error:k,setActiveProvider:s,setActiveResource:r,selectVpc:E,selectSecurityGroup:W,syncResources:Z,refreshData:P,clearError:w}},Fg=[{id:"aws",name:"AWS",color:"from-orange-500 to-orange-600"},{id:"azure",name:"Azure",color:"from-blue-500 to-blue-600"},{id:"gcp",name:"GCP",color:"from-red-500 to-green-500"}],Gg=[{id:"vpcs",name:"VPCs / VNets",icon:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"},{id:"security-groups",name:"Security Groups",icon:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},{id:"load-balancers",name:"Load Balancers",icon:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},{id:"transit-gateways",name:"Transit Gateways",icon:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"}],Vg=()=>{const{activeProvider:t,activeResource:s,overview:a,vpcs:r,selectedVpc:n,subnets:i,securityGroups:o,selectedSecurityGroup:l,loadBalancers:c,transitGateways:d,isLoading:h,isSyncing:u,error:x,setActiveProvider:_,setActiveResource:b,selectVpc:m,selectSecurityGroup:T,syncResources:p}=Mg();return e.jsxs(ee,{children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg mb-6 overflow-hidden flex",children:Fg.map(g=>e.jsx("button",{onClick:()=>_(g.id),className:`flex-1 px-6 py-4 font-bold transition-all ${t===g.id?`bg-gradient-to-r ${g.color} text-white`:"text-slate-600 hover:bg-slate-50"}`,children:g.name},g.id))}),a&&e.jsx(Ug,{overview:a,isSyncing:u,onSync:p}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:e.jsx("span",{className:"text-red-700",children:x})}),e.jsx("div",{className:"flex gap-2 mb-6",children:Gg.map(g=>e.jsxs("button",{onClick:()=>b(g.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s===g.id?"bg-cyan-500 text-white":"bg-white text-slate-600 hover:bg-slate-50 shadow"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:g.icon})}),g.name]},g.id))}),h?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),e.jsx("span",{className:"ml-3 text-slate-600",children:"Loading resources..."})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s==="vpcs"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Hg,{vpcs:r,selectedId:n==null?void 0:n.id,onSelect:m})}),e.jsx("div",{className:"lg:col-span-2",children:n?e.jsx(Wg,{vpc:n,subnets:i}):e.jsx(fc,{message:"Select a VPC to view details"})})]}),s==="security-groups"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(zg,{groups:o,selectedId:l==null?void 0:l.id,onSelect:T})}),e.jsx("div",{className:"lg:col-span-2",children:l?e.jsx($g,{group:l}):e.jsx(fc,{message:"Select a security group to view rules"})})]}),s==="load-balancers"&&e.jsx("div",{className:"lg:col-span-3",children:e.jsx(Bg,{loadBalancers:c})}),s==="transit-gateways"&&e.jsx("div",{className:"lg:col-span-3",children:e.jsx(Zg,{gateways:d})})]})]})},Ug=({overview:t,isSyncing:s,onSync:a})=>{const r=[{label:"VPCs",value:t.vpcCount,color:"text-blue-600"},{label:"Subnets",value:t.subnetCount,color:"text-green-600"},{label:"Security Groups",value:t.securityGroupCount,color:"text-purple-600"},{label:"Load Balancers",value:t.loadBalancerCount,color:"text-orange-600"},{label:"Instances",value:t.totalInstances,color:"text-cyan-600"}];return e.jsxs(y,{className:"bg-white shadow-lg mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${t.healthScore>=90?"bg-green-500":t.healthScore>=70?"bg-amber-500":"bg-red-500"}`}),e.jsxs("span",{className:"text-sm text-slate-600",children:["Health: ",e.jsxs("span",{className:"font-semibold",children:[t.healthScore,"%"]})]})]}),t.issueCount>0&&e.jsxs("span",{className:"text-sm text-red-600 bg-red-50 px-2 py-1 rounded",children:[t.issueCount," issues"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Last sync: ",new Date(t.lastSync).toLocaleTimeString()]}),e.jsxs("button",{onClick:a,disabled:s,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-cyan-500 text-white rounded hover:bg-cyan-600 disabled:bg-slate-300 transition-colors",children:[e.jsx("svg",{className:`w-4 h-4 ${s?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s?"Syncing...":"Sync"]})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-4",children:r.map(n=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-2xl font-bold ${n.color}`,children:n.value}),e.jsx("p",{className:"text-xs text-slate-500",children:n.label})]},n.label))})]})},Hg=({vpcs:t,selectedId:s,onSelect:a})=>e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["VPCs / VNets (",t.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:t.map(r=>e.jsxs("button",{onClick:()=>a(r.id),className:`w-full text-left p-3 rounded-lg transition-colors ${s===r.id?"bg-cyan-50 border-2 border-cyan-500":"bg-slate-50 hover:bg-slate-100 border-2 border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-slate-800",children:r.name}),e.jsx(qo,{status:r.status})]}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:r.cidrBlock}),e.jsxs("div",{className:"flex gap-3 mt-2 text-xs text-slate-500",children:[e.jsxs("span",{children:[r.subnetCount," subnets"]}),e.jsxs("span",{children:[r.instanceCount," instances"]})]})]},r.id))})]}),Wg=({vpc:t,subnets:s})=>e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 font-mono",children:t.id})]}),e.jsx(qo,{status:t.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"CIDR Block"}),e.jsx("p",{className:"font-mono font-medium text-slate-800",children:t.cidrBlock})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Region"}),e.jsx("p",{className:"font-medium text-slate-800",children:t.region})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Instances"}),e.jsx("p",{className:"font-medium text-slate-800",children:t.instanceCount})]})]}),e.jsxs("h4",{className:"font-semibold text-slate-700 mb-3",children:["Subnets (",s.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:s.map(a=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-slate-800",children:a.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.isPublic?"bg-green-100 text-green-700":"bg-slate-200 text-slate-700"}`,children:a.isPublic?"Public":"Private"})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-slate-500",children:[e.jsx("span",{className:"font-mono",children:a.cidrBlock}),e.jsx("span",{children:a.availabilityZone}),e.jsxs("span",{children:[a.availableIps," IPs available"]})]})]},a.id))})]}),zg=({groups:t,selectedId:s,onSelect:a})=>e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Security Groups (",t.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:t.map(r=>e.jsxs("button",{onClick:()=>a(r.id),className:`w-full text-left p-3 rounded-lg transition-colors ${s===r.id?"bg-cyan-50 border-2 border-cyan-500":"bg-slate-50 hover:bg-slate-100 border-2 border-transparent"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("span",{className:"font-medium text-slate-800",children:r.name})}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:r.description}),e.jsxs("div",{className:"flex gap-3 mt-2 text-xs",children:[e.jsxs("span",{className:"text-green-600",children:[r.inboundRules.length," inbound"]}),e.jsxs("span",{className:"text-blue-600",children:[r.outboundRules.length," outbound"]})]})]},r.id))})]}),$g=({group:t})=>e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500",children:t.description}),e.jsx("p",{className:"text-xs text-slate-400 font-mono mt-1",children:t.id})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-xs text-slate-500",children:["VPC: ",e.jsx("span",{className:"text-slate-700",children:t.vpcName})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),"Inbound Rules (",t.inboundRules.length,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"Protocol"}),e.jsx("th",{className:"pb-2",children:"Port Range"}),e.jsx("th",{className:"pb-2",children:"Source"}),e.jsx("th",{className:"pb-2",children:"Description"})]})}),e.jsx("tbody",{children:t.inboundRules.map(s=>e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("td",{className:"py-2 font-mono",children:s.protocol}),e.jsx("td",{className:"py-2",children:s.portRange}),e.jsx("td",{className:"py-2 font-mono text-xs",children:s.source}),e.jsx("td",{className:"py-2 text-slate-500",children:s.description})]},s.id))})]})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Outbound Rules (",t.outboundRules.length,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"Protocol"}),e.jsx("th",{className:"pb-2",children:"Port Range"}),e.jsx("th",{className:"pb-2",children:"Destination"}),e.jsx("th",{className:"pb-2",children:"Description"})]})}),e.jsx("tbody",{children:t.outboundRules.map(s=>e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("td",{className:"py-2 font-mono",children:s.protocol}),e.jsx("td",{className:"py-2",children:s.portRange}),e.jsx("td",{className:"py-2 font-mono text-xs",children:s.source}),e.jsx("td",{className:"py-2 text-slate-500",children:s.description})]},s.id))})]})})]})]}),Bg=({loadBalancers:t})=>e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Load Balancers (",t.length,")"]}),e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsx("p",{className:"text-center text-slate-500 py-8",children:"No load balancers found"}):t.map(s=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:s.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.type==="application"?"bg-blue-100 text-blue-700":s.type==="network"?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"}`,children:s.type.toUpperCase()}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.scheme==="internet-facing"?"bg-green-100 text-green-700":"bg-slate-200 text-slate-700"}`,children:s.scheme})]})]}),e.jsx("p",{className:"text-xs text-slate-500 font-mono mb-3 truncate",children:s.dnsName}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Listeners:"})," ",e.jsx("span",{className:"font-medium",children:s.listenerCount})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Target Groups:"})," ",e.jsx("span",{className:"font-medium",children:s.targetGroupCount})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-slate-500",children:"Health:"}),e.jsxs("span",{className:`font-medium ${s.healthyTargets===s.totalTargets?"text-green-600":"text-amber-600"}`,children:[s.healthyTargets,"/",s.totalTargets]}),e.jsx("span",{className:"text-slate-400",children:"targets"})]})]})]},s.id))})]}),Zg=({gateways:t})=>e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Transit Gateways (",t.length,")"]}),t.length===0?e.jsx("p",{className:"text-center text-slate-500 py-8",children:"No transit gateways found"}):e.jsx("div",{className:"space-y-6",children:t.map(s=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:s.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:s.region}),e.jsx(qo,{status:s.state==="available"?"active":s.state==="pending"?"pending":"error"})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("span",{className:"text-sm text-slate-600",children:[s.routeTables," route tables"]})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-700 mb-2",children:["Attachments (",s.attachments.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.attachments.map(a=>e.jsxs("div",{className:"bg-white rounded p-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-slate-800",children:a.resourceName}),e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${a.resourceType==="vpc"?"bg-blue-100 text-blue-700":a.resourceType==="vpn"?"bg-orange-100 text-orange-700":a.resourceType==="peering"?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"}`,children:a.resourceType})]}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:a.resourceId})]},a.id))})]})]},s.id))})]}),qo=({status:t})=>{const s={active:{bg:"bg-green-100",text:"text-green-700",label:"Active"},available:{bg:"bg-green-100",text:"text-green-700",label:"Available"},inactive:{bg:"bg-slate-100",text:"text-slate-700",label:"Inactive"},pending:{bg:"bg-amber-100",text:"text-amber-700",label:"Pending"},error:{bg:"bg-red-100",text:"text-red-700",label:"Error"},deleting:{bg:"bg-red-100",text:"text-red-700",label:"Deleting"}},a=s[t]||s.inactive;return e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.bg} ${a.text}`,children:a.label})},fc=({message:t})=>e.jsx(y,{className:"bg-slate-50 border-2 border-dashed border-slate-200",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.jsx("p",{className:"text-slate-500",children:t})]})}),qg={aws:{name:"Amazon Web Services",shortName:"AWS",icon:"",color:"from-orange-500 to-orange-600",borderColor:"border-orange-500",bgColor:"bg-orange-500/10"},azure:{name:"Microsoft Azure",shortName:"Azure",icon:"",color:"from-blue-500 to-blue-600",borderColor:"border-blue-500",bgColor:"bg-blue-500/10"},gcp:{name:"Google Cloud Platform",shortName:"GCP",icon:"",color:"from-red-500 to-red-600",borderColor:"border-red-500",bgColor:"bg-red-500/10"},oci:{name:"Oracle Cloud Infrastructure",shortName:"OCI",icon:"",color:"from-red-600 to-orange-600",borderColor:"border-red-600",bgColor:"bg-red-600/10"},onprem:{name:"On-Premises",shortName:"On-Prem",icon:"",color:"from-slate-500 to-slate-600",borderColor:"border-slate-500",bgColor:"bg-slate-500/10"}},Kg={healthy:{label:"Healthy",color:"text-emerald-400",bgColor:"bg-emerald-500/20",borderColor:"border-emerald-500/30"},degraded:{label:"Degraded",color:"text-amber-400",bgColor:"bg-amber-500/20",borderColor:"border-amber-500/30"},critical:{label:"Critical",color:"text-red-400",bgColor:"bg-red-500/20",borderColor:"border-red-500/30"}},Qg=({provider:t,summary:s,selected:a,onClick:r})=>{const n=qg[t],i=Kg[s.health];return e.jsx("div",{onClick:r,className:`cursor-pointer transition-all ${a?"scale-105":"hover:scale-102"}`,children:e.jsxs(y,{className:`border-2 ${a?n.borderColor+" shadow-lg":"border-slate-600"}`,padding:"none",children:[e.jsx("div",{className:`bg-gradient-to-r ${n.color} p-4`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:n.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:n.shortName}),e.jsx("p",{className:"text-white/80 text-xs",children:n.name})]})]}),a&&e.jsx("div",{className:"w-6 h-6 bg-white rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border ${i.bgColor} ${i.borderColor}`,children:[e.jsx("span",{className:"text-sm text-slate-300",children:"Health"}),e.jsx("span",{className:`text-sm font-semibold ${i.color}`,children:i.label})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Networks"}),e.jsx("p",{className:"text-lg font-bold text-white",children:s.networks})]}),e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Subnets"}),e.jsx("p",{className:"text-lg font-bold text-white",children:s.subnets})]}),e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded col-span-2",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Active Resources"}),e.jsx("p",{className:"text-lg font-bold text-white",children:s.activeResources})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Regions"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.regions.map(o=>e.jsx("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs",children:o},o))})]})]})]})})},Yg={vpc:"VPC",vnet:"VNet",vcn:"VCN"},Xg={active:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30"},inactive:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"},degraded:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30"},error:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30"},unknown:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"}},Jg=({networks:t,onSelectNetwork:s})=>e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:t.map(a=>{const r=Xg[a.status],n=a.subnets.length,i=a.routeTables.length,o=a.peerings.length,l=a.gateways.length;return e.jsxs(y,{className:"cursor-pointer hover:border-cyan-500 transition-colors",onClick:()=>s(a),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-white font-semibold text-lg",children:a.name}),e.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs font-mono",children:Yg[a.type]})]}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:a.id})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${r.bg} ${r.border} ${r.color}`,children:a.status.toUpperCase()})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-2",children:"CIDR Blocks"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.cidr.map((c,d)=>e.jsx("span",{className:"px-3 py-1 bg-slate-700/50 text-white rounded font-mono text-sm",children:c},d))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-slate-400 text-xs",children:"Region: "}),e.jsx("span",{className:"text-white text-sm",children:a.region})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[e.jsx("p",{className:"text-xl font-bold text-white",children:n}),e.jsx("p",{className:"text-xs text-slate-400",children:"Subnets"})]}),e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[e.jsx("p",{className:"text-xl font-bold text-white",children:i}),e.jsx("p",{className:"text-xs text-slate-400",children:"Routes"})]}),e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[e.jsx("p",{className:"text-xl font-bold text-white",children:o}),e.jsx("p",{className:"text-xs text-slate-400",children:"Peerings"})]}),e.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[e.jsx("p",{className:"text-xl font-bold text-white",children:l}),e.jsx("p",{className:"text-xs text-slate-400",children:"Gateways"})]})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[a.firewalls.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 border border-red-500/30 rounded",children:[" ",a.firewalls.length," Firewall",a.firewalls.length>1?"s":""]}),a.securityGroups.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded",children:[" ",a.securityGroups.length," SG/NSG"]})]}),Object.keys(a.tags).length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(a.tags).slice(0,3).map(([c,d])=>e.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs",children:[c,": ",d]},c))})]})]},a.id)})}),ut={active:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30"},inactive:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"},degraded:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30"},error:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30"},unknown:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"}},e1={local:{icon:"",color:"text-slate-400"},gateway:{icon:"",color:"text-cyan-400"},peering:{icon:"",color:"text-purple-400"},transit:{icon:"",color:"text-blue-400"},nat:{icon:"",color:"text-green-400"},instance:{icon:"",color:"text-yellow-400"},blackhole:{icon:"",color:"text-red-400"}},t1=({network:t,onClose:s})=>{const[a,r]=v.useState("overview"),n=[{id:"overview",label:"Overview"},{id:"subnets",label:"Subnets",count:t.subnets.length},{id:"routes",label:"Route Tables",count:t.routeTables.length},{id:"peerings",label:"Peerings",count:t.peerings.length},{id:"gateways",label:"Gateways",count:t.gateways.length},{id:"security",label:"Security",count:t.firewalls.length+t.securityGroups.length}];return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.name}),e.jsx("p",{className:"text-slate-400 text-sm font-mono mb-3",children:t.id}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded text-xs font-mono",children:t.type.toUpperCase()}),e.jsx("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:t.region}),e.jsx("span",{className:`px-3 py-1 rounded text-xs font-semibold border ${ut[t.status].bg} ${ut[t.status].border} ${ut[t.status].color}`,children:t.status.toUpperCase()})]})]}),e.jsx("button",{onClick:s,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"border-b border-slate-700",children:e.jsx("div",{className:"flex px-6 gap-1 overflow-x-auto",children:n.map(i=>e.jsxs("button",{onClick:()=>r(i.id),className:`px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${a===i.id?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-white"}`,children:[i.label,i.count!==void 0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-slate-700 rounded text-xs",children:i.count})]},i.id))})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"CIDR Blocks"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.cidr.map((i,o)=>e.jsx("span",{className:"px-3 py-2 bg-slate-700/50 text-white rounded font-mono",children:i},o))})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Provider"}),e.jsx("p",{className:"text-white",children:t.provider.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Region"}),e.jsx("p",{className:"text-white",children:t.region})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Created"}),e.jsx("p",{className:"text-white",children:new Date(t.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Last Modified"}),e.jsx("p",{className:"text-white",children:new Date(t.lastModified).toLocaleString()})]})]})]}),Object.keys(t.tags).length>0&&e.jsxs(y,{className:"p-4",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Tags"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(t.tags).map(([i,o])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-slate-400 text-sm",children:[i,":"]}),e.jsx("span",{className:"text-white text-sm font-mono",children:o})]},i))})]})]}),a==="subnets"&&e.jsx("div",{className:"space-y-4",children:t.subnets.map(i=>{const o=i.usedIps/(i.usedIps+i.availableIps)*100;return e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold",children:i.name}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:i.id})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${i.public?"bg-cyan-500/20 text-cyan-400":"bg-slate-500/20 text-slate-400"}`,children:i.public?"Public":"Private"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"CIDR"}),e.jsx("p",{className:"text-white font-mono text-sm",children:i.cidr})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Availability Zone"}),e.jsx("p",{className:"text-white text-sm",children:i.availabilityZone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Status"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${ut[i.status].bg} ${ut[i.status].color}`,children:i.status})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-slate-400",children:"IP Usage"}),e.jsxs("span",{className:"text-white",children:[i.usedIps," / ",i.usedIps+i.availableIps," (",o.toFixed(1),"%)"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${o>80?"bg-red-500":o>60?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${o}%`}})})]}),i.resources.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Resources (",i.resources.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[i.resources.slice(0,3).map(l=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-700/30 rounded text-xs",children:[e.jsx("span",{className:"text-slate-400",children:l.type}),e.jsx("span",{className:"text-white font-mono flex-1",children:l.privateIp}),l.publicIp&&e.jsx("span",{className:"text-cyan-400 font-mono",children:l.publicIp})]},l.id)),i.resources.length>3&&e.jsxs("p",{className:"text-slate-400 text-xs text-center",children:["+",i.resources.length-3," more resources"]})]})]})]},i.id)})}),a==="routes"&&e.jsx("div",{className:"space-y-4",children:t.routeTables.map(i=>e.jsxs(y,{className:"p-4",children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:i.name}),e.jsx("p",{className:"text-slate-400 text-sm font-mono mb-4",children:i.id}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-slate-300 font-medium text-sm mb-2",children:"Routes"}),e.jsx("div",{className:"space-y-2",children:i.routes.map((o,l)=>{const c=e1[o.targetType];return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded border ${o.status==="blackhole"?"bg-red-500/10 border-red-500/30":"bg-slate-700/30 border-slate-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("span",{className:`text-2xl ${c.color}`,children:c.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-mono text-sm",children:o.destination}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[" ",o.target," (",o.targetType,")",o.propagated&&e.jsx("span",{className:"ml-2 text-cyan-400",children:" Propagated"})]})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${o.status==="active"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:o.status})]},l)})})]}),i.associations.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-slate-300 font-medium text-sm mb-2",children:"Associated Subnets"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.associations.map(o=>e.jsx("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:o.subnetName},o.subnetId))})]})]},i.id))}),a==="peerings"&&e.jsx("div",{className:"space-y-4",children:t.peerings.length===0?e.jsx(y,{className:"p-8 text-center",children:e.jsx("p",{className:"text-slate-400",children:"No peering connections configured"})}):t.peerings.map(i=>e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold",children:i.name}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:i.id})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${i.status==="active"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":i.status==="pending"?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:i.status.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Requester"}),e.jsx("p",{className:"text-white text-sm font-semibold",children:i.requesterNetworkName}),e.jsx("p",{className:"text-cyan-400 text-xs font-mono",children:i.requesterCidr})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Accepter"}),e.jsx("p",{className:"text-white text-sm font-semibold",children:i.accepterNetworkName}),e.jsx("p",{className:"text-cyan-400 text-xs font-mono",children:i.accepterCidr})]})]}),e.jsxs("div",{className:"flex gap-2",children:[i.crossRegion&&e.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs",children:"Cross-Region"}),i.crossAccount&&e.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:"Cross-Account"})]})]},i.id))}),a==="gateways"&&e.jsx("div",{className:"space-y-4",children:t.gateways.length===0?e.jsx(y,{className:"p-8 text-center",children:e.jsx("p",{className:"text-slate-400",children:"No gateways configured"})}):t.gateways.map(i=>e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold",children:i.name}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:i.id})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${ut[i.status].bg} ${ut[i.status].color}`,children:i.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Type"}),e.jsx("p",{className:"text-white text-sm",children:i.type.replace("_"," ").toUpperCase()})]}),i.publicIp&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Public IP"}),e.jsx("p",{className:"text-cyan-400 text-sm font-mono",children:i.publicIp})]}),i.bandwidth&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Bandwidth"}),e.jsx("p",{className:"text-white text-sm",children:i.bandwidth})]}),i.redundancy&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Redundancy"}),e.jsx("p",{className:"text-white text-sm",children:i.redundancy.toUpperCase()})]})]})]},i.id))}),a==="security"&&e.jsxs("div",{className:"space-y-6",children:[t.firewalls.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Firewalls"}),e.jsx("div",{className:"space-y-4",children:t.firewalls.map(i=>e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold",children:i.name}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:i.id})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${ut[i.status].bg} ${ut[i.status].color}`,children:i.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Type"}),e.jsx("p",{className:"text-white text-sm",children:i.type.replace("_"," ").toUpperCase()})]}),i.vendor&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Vendor"}),e.jsx("p",{className:"text-white text-sm",children:i.vendor})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Throughput"}),e.jsx("p",{className:"text-white text-sm",children:i.throughput})]})]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[i.loggingEnabled&&e.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:"Logging Enabled"}),i.intrusionPrevention&&e.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs",children:"IPS Enabled"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Rules (",i.rules.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[i.rules.slice(0,3).map(o=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-700/30 rounded text-xs",children:[e.jsx("span",{className:"text-white",children:o.name}),e.jsx("span",{className:`px-2 py-1 rounded ${o.action==="allow"?"bg-emerald-500/20 text-emerald-400":o.action==="deny"?"bg-red-500/20 text-red-400":"bg-amber-500/20 text-amber-400"}`,children:o.action.toUpperCase()})]},o.id)),i.rules.length>3&&e.jsxs("p",{className:"text-slate-400 text-xs text-center py-1",children:["+",i.rules.length-3," more rules"]})]})]})]},i.id))})]}),t.securityGroups.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Security Groups / NSGs"}),e.jsx("div",{className:"space-y-4",children:t.securityGroups.map(i=>e.jsxs(y,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold",children:i.name}),e.jsx("p",{className:"text-slate-400 text-sm",children:i.description}),e.jsx("p",{className:"text-slate-400 text-xs font-mono mt-1",children:i.id})]}),e.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:i.type==="security_group"?"Security Group":"NSG"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Inbound Rules (",i.inboundRules.length,")"]}),e.jsx("div",{className:"space-y-1",children:i.inboundRules.slice(0,2).map(o=>e.jsxs("div",{className:"p-2 bg-slate-700/30 rounded text-xs",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-white",children:o.protocol.toUpperCase()}),e.jsx("span",{className:`px-1 rounded ${o.action==="allow"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:o.action})]}),e.jsxs("p",{className:"text-slate-400",children:["Port: ",o.portRange]})]},o.id))})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Outbound Rules (",i.outboundRules.length,")"]}),e.jsx("div",{className:"space-y-1",children:i.outboundRules.slice(0,2).map(o=>e.jsxs("div",{className:"p-2 bg-slate-700/30 rounded text-xs",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-white",children:o.protocol.toUpperCase()}),e.jsx("span",{className:`px-1 rounded ${o.action==="allow"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:o.action})]}),e.jsxs("p",{className:"text-slate-400",children:["Port: ",o.portRange]})]},o.id))})]})]})]},i.id))})]})]})]})]})})},s1=[{id:"vpc-0a1b2c3d4e5f6g7h8",name:"Production VPC",provider:"aws",type:"vpc",cidr:["10.100.0.0/16"],region:"us-east-1",status:"active",subnets:[{id:"subnet-pub-1a",name:"Public Subnet 1A",cidr:"10.100.1.0/24",availabilityZone:"us-east-1a",routeTableId:"rtb-public",public:!0,status:"active",usedIps:45,availableIps:206,resources:[{id:"i-123",name:"web-server-01",type:"instance",privateIp:"10.100.1.10",publicIp:"52.94.76.50"},{id:"lb-456",name:"app-load-balancer",type:"loadbalancer",privateIp:"10.100.1.20",publicIp:"52.94.76.51"}]},{id:"subnet-priv-1a",name:"Private Subnet 1A",cidr:"10.100.10.0/24",availabilityZone:"us-east-1a",routeTableId:"rtb-private",public:!1,status:"active",usedIps:82,availableIps:169,resources:[{id:"i-789",name:"app-server-01",type:"instance",privateIp:"10.100.10.10"},{id:"rds-001",name:"prod-database",type:"database",privateIp:"10.100.10.50"}]}],routeTables:[{id:"rtb-public",name:"Public Route Table",status:"active",routes:[{destination:"10.100.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"igw-12345678",targetType:"gateway",status:"active",propagated:!1},{destination:"10.200.0.0/16",target:"pcx-azure-peer",targetType:"peering",status:"active",propagated:!1}],associations:[{subnetId:"subnet-pub-1a",subnetName:"Public Subnet 1A"}]},{id:"rtb-private",name:"Private Route Table",status:"active",routes:[{destination:"10.100.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"nat-0abc123",targetType:"nat",status:"active",propagated:!1},{destination:"172.16.0.0/12",target:"tgw-09876543",targetType:"transit",status:"active",propagated:!0}],associations:[{subnetId:"subnet-priv-1a",subnetName:"Private Subnet 1A"}]}],peerings:[{id:"pcx-azure-peer",name:"AWS-Azure Peering",requesterNetworkId:"vpc-0a1b2c3d4e5f6g7h8",requesterNetworkName:"Production VPC",requesterCidr:"10.100.0.0/16",accepterNetworkId:"vnet-azure-prod",accepterNetworkName:"Azure Production VNet",accepterCidr:"10.200.0.0/16",status:"active",crossRegion:!0,crossAccount:!1}],gateways:[{id:"igw-12345678",name:"Production Internet Gateway",type:"internet",status:"active",attachedTo:["vpc-0a1b2c3d4e5f6g7h8"]},{id:"nat-0abc123",name:"NAT Gateway 1A",type:"nat",status:"active",attachedTo:["subnet-pub-1a"],publicIp:"52.94.76.100"}],firewalls:[],securityGroups:[{id:"sg-web-tier",name:"Web Tier Security Group",type:"security_group",description:"Security group for web servers",status:"active",attachedResources:["i-123"],inboundRules:[{id:"sgr-001",priority:100,name:"Allow HTTP",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"80"},{id:"sgr-002",priority:110,name:"Allow HTTPS",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"443"}],outboundRules:[{id:"sgr-out-001",priority:100,name:"Allow All Outbound",direction:"outbound",action:"allow",protocol:"all",sourceType:"any",source:"any",destinationType:"cidr",destination:"0.0.0.0/0",portRange:"all"}]}],tags:{Environment:"Production",Team:"Platform",CostCenter:"Engineering"},createdAt:"2024-01-15T10:00:00Z",lastModified:"2026-01-19T14:30:00Z"}],a1=[{id:"vnet-azure-prod",name:"Azure Production VNet",provider:"azure",type:"vnet",cidr:["10.200.0.0/16"],region:"eastus",status:"active",subnets:[{id:"subnet-web",name:"WebSubnet",cidr:"10.200.1.0/24",availabilityZone:"eastus-1",routeTableId:"rt-web",public:!0,status:"active",usedIps:30,availableIps:221,resources:[{id:"vm-web-01",name:"web-vm-01",type:"instance",privateIp:"10.200.1.10",publicIp:"13.82.100.50"}]},{id:"subnet-app",name:"AppSubnet",cidr:"10.200.10.0/24",availabilityZone:"eastus-1",routeTableId:"rt-app",public:!1,status:"active",usedIps:55,availableIps:196,resources:[{id:"vm-app-01",name:"app-vm-01",type:"instance",privateIp:"10.200.10.10"},{id:"sqldb-01",name:"sqldb-prod",type:"database",privateIp:"10.200.10.50"}]}],routeTables:[{id:"rt-web",name:"Web Route Table",status:"active",routes:[{destination:"10.200.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"internet",targetType:"gateway",status:"active",propagated:!1},{destination:"10.100.0.0/16",target:"vnet-peering-aws",targetType:"peering",status:"active",propagated:!1}],associations:[{subnetId:"subnet-web",subnetName:"WebSubnet"}]}],peerings:[{id:"peer-azure-gcp",name:"Azure-GCP Peering",requesterNetworkId:"vnet-azure-prod",requesterNetworkName:"Azure Production VNet",requesterCidr:"10.200.0.0/16",accepterNetworkId:"vpc-gcp-prod",accepterNetworkName:"GCP Production VPC",accepterCidr:"10.150.0.0/16",status:"active",crossRegion:!0,crossAccount:!1}],gateways:[{id:"vgw-azure-01",name:"Azure Virtual Network Gateway",type:"vpn",status:"active",attachedTo:["vnet-azure-prod"],bandwidth:"1 Gbps",redundancy:"ha"}],firewalls:[{id:"azfw-prod-01",name:"Azure Firewall - Production",type:"managed",vendor:"Microsoft",status:"active",throughput:"30 Gbps",loggingEnabled:!0,intrusionPrevention:!0,rules:[{id:"fw-rule-001",name:"Allow-Web-Traffic",priority:100,action:"allow",source:"0.0.0.0/0",destination:"10.200.1.0/24",ports:"80,443",protocol:"tcp",enabled:!0},{id:"fw-rule-002",name:"Deny-All-Inbound",priority:65e3,action:"deny",source:"any",destination:"any",ports:"any",protocol:"any",enabled:!0}]}],securityGroups:[{id:"nsg-web",name:"Web NSG",type:"nsg",description:"Network Security Group for web tier",status:"active",attachedResources:["subnet-web"],inboundRules:[{id:"nsg-in-001",priority:100,name:"Allow-HTTPS",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"443"}],outboundRules:[{id:"nsg-out-001",priority:100,name:"Allow-All-Outbound",direction:"outbound",action:"allow",protocol:"all",sourceType:"any",source:"any",destinationType:"cidr",destination:"0.0.0.0/0",portRange:"all"}]}],tags:{Environment:"Production",Team:"Cloud",Owner:"DevOps"},createdAt:"2024-02-10T09:00:00Z",lastModified:"2026-01-19T13:15:00Z"}],r1=[{id:"vpc-gcp-prod",name:"GCP Production VPC",provider:"gcp",type:"vpc",cidr:["10.150.0.0/16"],region:"us-central1",status:"active",subnets:[{id:"subnet-gcp-us-central1",name:"us-central1-subnet",cidr:"10.150.1.0/24",availabilityZone:"us-central1-a",routeTableId:"default",public:!1,status:"active",usedIps:25,availableIps:226,resources:[{id:"instance-1",name:"gcp-web-01",type:"instance",privateIp:"10.150.1.10",publicIp:"35.192.50.25"}]}],routeTables:[{id:"default",name:"Default Route Table",status:"active",routes:[{destination:"10.150.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"default-internet-gateway",targetType:"gateway",status:"active",propagated:!1}],associations:[{subnetId:"subnet-gcp-us-central1",subnetName:"us-central1-subnet"}]}],peerings:[],gateways:[{id:"default-internet-gateway",name:"Default Internet Gateway",type:"internet",status:"active",attachedTo:["vpc-gcp-prod"]}],firewalls:[],securityGroups:[],tags:{environment:"production",team:"platform"},createdAt:"2024-03-05T11:30:00Z",lastModified:"2026-01-18T16:45:00Z"}],n1=[{id:"vcn-oci-prod",name:"OCI Production VCN",provider:"oci",type:"vcn",cidr:["10.50.0.0/16"],region:"us-ashburn-1",status:"active",subnets:[{id:"subnet-oci-public",name:"Public Subnet",cidr:"10.50.1.0/24",availabilityZone:"AD-1",routeTableId:"rt-public",public:!0,status:"active",usedIps:15,availableIps:236,resources:[]}],routeTables:[{id:"rt-public",name:"Public Route Table",status:"active",routes:[{destination:"10.50.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"igw-oci",targetType:"gateway",status:"active",propagated:!1}],associations:[{subnetId:"subnet-oci-public",subnetName:"Public Subnet"}]}],peerings:[],gateways:[{id:"igw-oci",name:"OCI Internet Gateway",type:"internet",status:"active",attachedTo:["vcn-oci-prod"]}],firewalls:[],securityGroups:[{id:"sl-oci-web",name:"Web Security List",type:"security_group",description:"Security list for web tier",status:"active",attachedResources:["subnet-oci-public"],inboundRules:[{id:"sl-in-001",priority:1,name:"Allow-SSH",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"22"}],outboundRules:[{id:"sl-out-001",priority:1,name:"Allow-All",direction:"outbound",action:"allow",protocol:"all",sourceType:"any",source:"any",destinationType:"cidr",destination:"0.0.0.0/0",portRange:"all"}]}],tags:{Environment:"Production"},createdAt:"2024-04-12T08:00:00Z",lastModified:"2026-01-17T10:20:00Z"}],i1=[{id:"dc-us-east-1",name:"Data Center US-EAST-1",provider:"onprem",type:"vpc",cidr:["172.16.0.0/12"],region:"on-premises",status:"active",subnets:[{id:"subnet-dmz",name:"DMZ Subnet",cidr:"172.16.1.0/24",availabilityZone:"Rack-A",routeTableId:"rt-dmz",public:!0,status:"active",usedIps:50,availableIps:201,resources:[{id:"srv-fw-01",name:"firewall-01",type:"other",privateIp:"172.16.1.1"}]},{id:"subnet-app",name:"Application Subnet",cidr:"172.16.10.0/24",availabilityZone:"Rack-B",routeTableId:"rt-internal",public:!1,status:"active",usedIps:120,availableIps:131,resources:[{id:"srv-app-01",name:"app-server-01",type:"instance",privateIp:"172.16.10.10"}]}],routeTables:[{id:"rt-dmz",name:"DMZ Route Table",status:"active",routes:[{destination:"172.16.0.0/12",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"edge-router",targetType:"gateway",status:"active",propagated:!1}],associations:[{subnetId:"subnet-dmz",subnetName:"DMZ Subnet"}]}],peerings:[],gateways:[{id:"vpn-aws-direct-connect",name:"AWS Direct Connect",type:"direct_connect",status:"active",attachedTo:["dc-us-east-1"],bandwidth:"10 Gbps",redundancy:"ha"}],firewalls:[{id:"fw-palo-alto-01",name:"Palo Alto NGFW - DC Edge",type:"third_party",vendor:"Palo Alto Networks",status:"active",throughput:"40 Gbps",loggingEnabled:!0,intrusionPrevention:!0,rules:[{id:"pa-rule-001",name:"Allow-Internet-Outbound",priority:10,action:"allow",source:"172.16.0.0/12",destination:"any",ports:"80,443",protocol:"tcp",enabled:!0},{id:"pa-rule-002",name:"Block-High-Risk-Countries",priority:5,action:"deny",source:"high-risk-geoip",destination:"172.16.0.0/12",ports:"any",protocol:"any",enabled:!0}]}],securityGroups:[],tags:{Location:"US-EAST-1",Tier:"Production"},createdAt:"2020-01-01T00:00:00Z",lastModified:"2026-01-19T12:00:00Z"}],o1=[{id:"tgw-09876543",name:"Production Transit Gateway",provider:"aws",region:"us-east-1",asn:64512,status:"active",attachments:[{id:"tgw-attach-vpc-prod",name:"Prod VPC Attachment",type:"vpc",transitGatewayId:"tgw-09876543",transitGatewayName:"Production Transit Gateway",networkId:"vpc-0a1b2c3d4e5f6g7h8",networkName:"Production VPC",status:"active",routeTableId:"tgw-rtb-main"},{id:"tgw-attach-vpn-onprem",name:"On-Prem VPN Attachment",type:"vpn",transitGatewayId:"tgw-09876543",transitGatewayName:"Production Transit Gateway",networkId:"vpn-connection-001",networkName:"DC US-EAST-1 VPN",status:"active",routeTableId:"tgw-rtb-main"}],routeTables:[{id:"tgw-rtb-main",name:"Main Transit Route Table",routes:[{destination:"10.100.0.0/16",target:"tgw-attach-vpc-prod",targetType:"transit",status:"active",propagated:!0},{destination:"172.16.0.0/12",target:"tgw-attach-vpn-onprem",targetType:"transit",status:"active",propagated:!0}],associations:["tgw-attach-vpc-prod","tgw-attach-vpn-onprem"],propagations:["tgw-attach-vpc-prod","tgw-attach-vpn-onprem"]}]}],l1=[...s1,...a1,...r1,...n1,...i1],vc=l1,ra=o1[0],c1=()=>{const[t,s]=v.useState("all"),[a,r]=v.useState(null),[n,i]=v.useState(""),o=v.useMemo(()=>{const d={aws:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},azure:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},gcp:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},oci:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},onprem:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"}};let h=0,u=0,x=0,_=0,b=0,m=0,T=0;return vc.forEach(p=>{const g=p.provider;d[g].networks++,d[g].subnets+=p.subnets.length;const f=p.subnets.reduce((j,N)=>j+N.resources.length,0);d[g].activeResources+=f,d[g].regions.includes(p.region)||d[g].regions.push(p.region),p.status==="error"?d[g].health="critical":p.status==="degraded"&&d[g].health!=="critical"&&(d[g].health="degraded"),h++,u+=p.subnets.length,x+=p.routeTables.length,_+=p.peerings.length,b+=p.gateways.length,m+=p.firewalls.length,T+=p.securityGroups.length}),{totalNetworks:h,totalSubnets:u,totalRouteTables:x,totalPeerings:_,totalGateways:b,totalFirewalls:m,totalSecurityGroups:T,byProvider:d}},[]),l=v.useMemo(()=>{let d=vc;if(t!=="all"&&(d=d.filter(h=>h.provider===t)),n){const h=n.toLowerCase();d=d.filter(u=>u.name.toLowerCase().includes(h)||u.id.toLowerCase().includes(h)||u.region.toLowerCase().includes(h)||u.cidr.some(x=>x.includes(h)))}return d},[t,n]),c=["aws","azure","gcp","oci","onprem"];return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Multi-Cloud Visibility"}),e.jsx("p",{className:"text-slate-400",children:"Unified view of network infrastructure across AWS, Azure, GCP, OCI, and On-Premises"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-6",children:[e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalNetworks}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Networks"})]}),e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalSubnets}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Subnets"})]}),e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalRouteTables}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Route Tables"})]}),e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalPeerings}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Peerings"})]}),e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalGateways}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Gateways"})]}),e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalFirewalls}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Firewalls"})]}),e.jsxs(y,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:o.totalSecurityGroups}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Security Groups"})]})]}),e.jsxs(y,{className:"p-6 mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),"Cloud Providers"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("button",{onClick:()=>s("all"),className:`p-4 rounded-lg border-2 transition-all ${t==="all"?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-slate-600 to-slate-700 rounded-lg flex items-center justify-center text-2xl mb-2 mx-auto",children:""}),e.jsx("h4",{className:"text-white font-semibold text-sm text-center",children:"All Providers"}),e.jsxs("p",{className:"text-slate-400 text-xs text-center mt-1",children:[o.totalNetworks," networks"]})]}),c.map(d=>e.jsx(Qg,{provider:d,summary:o.byProvider[d],selected:t===d,onClick:()=>s(d)},d))]})]}),e.jsx(y,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:n,onChange:d=>i(d.target.value),placeholder:"Search by name, ID, CIDR, or region...",className:"w-full pl-10 pr-4 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:border-cyan-500 focus:outline-none"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-white font-semibold",children:[t==="all"?"All Networks":`${t.toUpperCase()} Networks`,e.jsxs("span",{className:"ml-2 text-slate-400 text-sm font-normal",children:["(",l.length," ",l.length===1?"network":"networks",")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]})]}),l.length===0?e.jsxs(y,{className:"p-12 text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-slate-600 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-slate-400 text-lg mb-2",children:"No networks found"}),e.jsx("p",{className:"text-slate-500 text-sm",children:n?"Try adjusting your search query or filters":"No networks configured for the selected provider"})]}):e.jsx(Jg,{networks:l,onSelectNetwork:r}),e.jsxs(y,{className:"p-6 mt-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Transit Gateway"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Name"}),e.jsx("p",{className:"text-white font-semibold",children:ra.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Region"}),e.jsx("p",{className:"text-white",children:ra.region})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Attachments"}),e.jsx("p",{className:"text-white font-semibold",children:ra.attachments.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Status"}),e.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-sm",children:ra.status.toUpperCase()})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"Attachments"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:ra.attachments.map(d=>e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-white text-sm font-semibold",children:d.name}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:d.type})]}),e.jsx("p",{className:"text-slate-400 text-xs",children:d.networkName})]},d.id))})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsxs(D,{variant:"ghost",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"View Topology"]}),e.jsxs(D,{variant:"primary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Network"]})]})]}),a&&e.jsx(t1,{network:a,onClose:()=>r(null)})]})},d1=()=>{const[t,s]=v.useState("192.168.1.100"),[a,r]=v.useState(""),[n,i]=v.useState("icmp"),[o,l]=v.useState(""),[c,d]=v.useState(null),[h,u]=v.useState([]),[x,_]=v.useState([]),[b,m]=v.useState(!1),[T,p]=v.useState(!0),[g,f]=v.useState(!0),[j,N]=v.useState(null);v.useEffect(()=>{(async()=>{try{const[w,R]=await Promise.all([Ke.getHistory(),Ke.getSavedPaths()]);u(w),_(R)}catch(w){N(w instanceof Error?w.message:"Failed to load data")}finally{p(!1),f(!1)}})()},[]);const S=v.useCallback(async()=>{if(!a.trim()){N("Please enter a destination IP address or hostname");return}if((n==="tcp"||n==="udp")&&!o){N("Please enter a port number for TCP/UDP");return}m(!0),N(null),d(null);try{const P={source:t,destination:a,protocol:n,port:o?parseInt(o,10):void 0,maxHops:30,timeout:5e3,probesPerHop:3,resolveHostnames:!0},w=await Ke.runAnalysis(P);d(w);const R=await Ke.getHistory();u(R)}catch(P){N(P instanceof Error?P.message:"Path analysis failed")}finally{m(!1)}},[t,a,n,o]),A=v.useCallback(async P=>{var w;s(P.source),r(P.destination),i(P.protocol),l(((w=P.port)==null?void 0:w.toString())||""),m(!0),N(null),d(null);try{const R={source:P.source,destination:P.destination,protocol:P.protocol,port:P.port,maxHops:30,timeout:5e3,probesPerHop:3,resolveHostnames:!0},V=await Ke.runAnalysis(R);d(V),await Ke.updateSavedPathRun(P.id);const he=await Ke.getSavedPaths();_(he);const L=await Ke.getHistory();u(L)}catch(R){N(R instanceof Error?R.message:"Path analysis failed")}finally{m(!1)}},[]),k=v.useCallback(async P=>{if(!P.trim()){N("Please enter a name for the saved path");return}if(!a.trim()){N("Please enter a destination before saving");return}try{const w=await Ke.savePath({name:P,source:t,destination:a,protocol:n,port:o?parseInt(o,10):void 0});_(R=>[w,...R])}catch(w){N(w instanceof Error?w.message:"Failed to save path")}},[t,a,n,o]),I=v.useCallback(async P=>{try{await Ke.deleteSavedPath(P),_(w=>w.filter(R=>R.id!==P))}catch(w){N(w instanceof Error?w.message:"Failed to delete path")}},[]),E=v.useCallback(async()=>{try{await Ke.clearHistory(),u([])}catch(P){N(P instanceof Error?P.message:"Failed to clear history")}},[]),W=v.useCallback(()=>{d(null)},[]),Z=v.useCallback(()=>{N(null)},[]);return{source:t,destination:a,protocol:n,port:o,result:c,history:h,savedPaths:x,isRunning:b,isLoadingHistory:T,isLoadingSaved:g,error:j,setSource:s,setDestination:r,setProtocol:i,setPort:l,runAnalysis:S,runSavedPath:A,savePath:k,deleteSavedPath:I,clearHistory:E,clearResult:W,clearError:Z}},u1=[{name:"Google DNS",ip:"8.8.8.8"},{name:"Cloudflare DNS",ip:"1.1.1.1"},{name:"AWS us-east-1",ip:"52.94.76.1"},{name:"Azure East US",ip:"13.82.0.1"},{name:"GCP us-central1",ip:"35.192.0.1"}],yc=({health:t})=>{const s={healthy:"success",degraded:"warning",critical:"error",unknown:"default"};return e.jsx(F,{variant:s[t],children:t})},p1=({status:t,latency:s})=>{const a=()=>t==="timeout"?"bg-gray-400":t==="unreachable"?"bg-red-500":s>100?"bg-yellow-500":"bg-green-500";return e.jsx("div",{className:`w-3 h-3 rounded-full ${a()}`,title:t})},m1=({hop:t,isLast:s})=>{const[a,r]=v.useState(!1);return e.jsxs("div",{className:"relative",children:[!s&&e.jsx("div",{className:"absolute left-[18px] top-10 w-0.5 h-8 bg-gray-300"}),e.jsxs("div",{className:`border rounded-lg p-3 mb-2 cursor-pointer transition-all ${a?"bg-gray-50 border-blue-300":"bg-white hover:bg-gray-50"}`,onClick:()=>r(!a),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 w-16",children:[e.jsx(p1,{status:t.status,latency:t.avgLatency}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",t.hopNumber]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono text-sm text-gray-900",children:t.ipAddress}),t.hostname&&e.jsx("div",{className:"text-xs text-gray-500 truncate",children:t.hostname})]}),e.jsx("div",{className:"hidden md:block w-32 text-sm text-gray-600",children:t.location||"-"}),e.jsx("div",{className:"w-24 text-right",children:t.status==="timeout"?e.jsx("span",{className:"text-gray-400",children:"* * *"}):e.jsxs("span",{className:`font-medium ${t.avgLatency>100?"text-yellow-600":t.avgLatency>50?"text-blue-600":"text-green-600"}`,children:[t.avgLatency.toFixed(1)," ms"]})}),e.jsx("div",{className:"w-20 text-right",children:e.jsxs("span",{className:`text-sm ${t.packetLoss>5?"text-red-600":"text-gray-500"}`,children:[t.packetLoss.toFixed(1),"% loss"]})}),e.jsx("div",{className:"w-20",children:t.cloudProvider&&e.jsx(F,{variant:"default",className:"text-xs",children:t.cloudProvider.toUpperCase()})}),e.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&e.jsxs("div",{className:"mt-3 pt-3 border-t grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Min Latency"}),e.jsxs("div",{className:"font-medium",children:[t.minLatency.toFixed(2)," ms"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Max Latency"}),e.jsxs("div",{className:"font-medium",children:[t.maxLatency.toFixed(2)," ms"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Jitter"}),e.jsxs("div",{className:"font-medium",children:[t.jitter.toFixed(2)," ms"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Device Type"}),e.jsx("div",{className:"font-medium capitalize",children:t.deviceType||"Unknown"})]}),t.asn&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"ASN"}),e.jsx("div",{className:"font-medium",children:t.asn})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Organization"}),e.jsx("div",{className:"font-medium",children:t.asnOrg||"-"})]})]}),t.region&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Region"}),e.jsx("div",{className:"font-medium",children:t.region})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"RTT Samples"}),e.jsx("div",{className:"font-mono text-xs",children:t.latency.length>0?t.latency.map(n=>n.toFixed(1)).join(" / "):"* / * / *"})]})]})]})]})},h1=()=>{const{source:t,destination:s,protocol:a,port:r,result:n,history:i,savedPaths:o,isRunning:l,isLoadingHistory:c,isLoadingSaved:d,error:h,setSource:u,setDestination:x,setProtocol:_,setPort:b,runAnalysis:m,runSavedPath:T,savePath:p,deleteSavedPath:g,clearHistory:f,clearResult:j,clearError:N}=d1(),[S,A]=v.useState(!1),[k,I]=v.useState(""),[E,W]=v.useState("results"),Z=async()=>{await p(k),A(!1),I("")},P=w=>new Date(w).toLocaleString();return e.jsxs(ee,{children:[h&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-red-700",children:h}),e.jsx("button",{onClick:N,className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(y,{className:"bg-white shadow-lg mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Path Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source IP"}),e.jsx(dr,{value:t,onChange:w=>u(w.target.value),placeholder:"e.g., 192.168.1.100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),e.jsx(dr,{value:s,onChange:w=>x(w.target.value),placeholder:"e.g., 8.8.8.8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Protocol"}),e.jsxs(gh,{value:a,onChange:w=>_(w.target.value),children:[e.jsx("option",{value:"icmp",children:"ICMP"}),e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),e.jsx(dr,{type:"number",value:r,onChange:w=>b(w.target.value),placeholder:"e.g., 443",disabled:a==="icmp"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(D,{onClick:m,disabled:l,className:"w-full",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Tracing..."]}):"Run Traceroute"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500 mr-2",children:"Quick targets:"}),u1.map(w=>e.jsx("button",{onClick:()=>x(w.ip),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded text-gray-700",children:w.name},w.ip))]})]})}),e.jsx("div",{className:"flex gap-2 mb-4",children:["results","saved","history"].map(w=>e.jsxs("button",{onClick:()=>W(w),className:`px-4 py-2 rounded-lg font-medium transition-colors ${E===w?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[w==="results"&&"Results",w==="saved"&&`Saved Paths (${o.length})`,w==="history"&&`History (${i.length})`]},w))}),E==="results"&&e.jsx(e.Fragment,{children:n?e.jsx(y,{className:"bg-white shadow-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Path: ",n.source,"  ",n.destination]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.protocol.toUpperCase(),n.port?`:${n.port}`:""," | Completed at ",P(n.endTime||n.startTime)]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(yc,{health:n.health}),e.jsx(D,{variant:"secondary",onClick:()=>A(!0),children:"Save Path"}),e.jsx(D,{variant:"secondary",onClick:j,children:"Clear"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.totalHops}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Hops"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[n.avgLatency.toFixed(1)," ms"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Avg Latency"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[n.totalLatency.toFixed(1)," ms"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total RTT"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${n.packetLoss>5?"text-red-600":"text-green-600"}`,children:[n.packetLoss.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Packet Loss"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.mtu}),e.jsx("div",{className:"text-sm text-gray-500",children:"MTU"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Hop-by-Hop Path"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{children:"Healthy (<50ms)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{children:"Normal (50-100ms)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{children:"High Latency (>100ms)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{children:"Unreachable"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-400"}),e.jsx("span",{children:"Timeout"})]})]}),e.jsx("div",{className:"space-y-0",children:n.hops.map((w,R)=>e.jsx(m1,{hop:w,isLast:R===n.hops.length-1},w.hopNumber))})]})]})}):e.jsx(y,{className:"bg-white shadow-lg",children:e.jsx("div",{className:"text-center py-16 text-gray-400",children:l?e.jsxs("div",{children:[e.jsxs("svg",{className:"animate-spin mx-auto h-12 w-12 text-blue-500 mb-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Running path analysis..."}),e.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Discovering network hops to ",s]})]}):e.jsxs("div",{children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),e.jsx("p",{children:'Enter a destination and click "Run Traceroute" to analyze the network path'})]})})})}),E==="saved"&&e.jsx(y,{className:"bg-white shadow-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Saved Paths"}),d?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading saved paths..."}):o.length===0?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No saved paths. Run an analysis and save it for quick access."}):e.jsx("div",{className:"space-y-3",children:o.map(w=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[w.source,"  ",w.destination,e.jsx("span",{className:"mx-2",children:"|"}),w.protocol.toUpperCase(),w.port?`:${w.port}`:""]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[w.runCount," runs | Last: ",w.lastRun?P(w.lastRun):"Never"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"primary",onClick:()=>T(w),disabled:l,children:"Run"}),e.jsx(D,{variant:"secondary",onClick:()=>g(w.id),children:"Delete"})]})]},w.id))})]})}),E==="history"&&e.jsx(y,{className:"bg-white shadow-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analysis History"}),i.length>0&&e.jsx(D,{variant:"secondary",onClick:f,children:"Clear History"})]}),c?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading history..."}):i.length===0?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No analysis history yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Time"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Source"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Destination"}),e.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Hops"}),e.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Avg Latency"}),e.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Health"}),e.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Status"})]})}),e.jsx("tbody",{children:i.map(w=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-3 text-sm text-gray-600",children:P(w.timestamp)}),e.jsx("td",{className:"py-3 px-3 text-sm font-mono text-gray-900",children:w.source}),e.jsx("td",{className:"py-3 px-3 text-sm font-mono text-gray-900",children:w.destination}),e.jsx("td",{className:"py-3 px-3 text-sm text-center text-gray-600",children:w.totalHops}),e.jsxs("td",{className:"py-3 px-3 text-sm text-center text-gray-600",children:[w.avgLatency.toFixed(1)," ms"]}),e.jsx("td",{className:"py-3 px-3 text-center",children:e.jsx(yc,{health:w.health})}),e.jsx("td",{className:"py-3 px-3 text-center",children:e.jsx(F,{variant:w.status==="completed"?"success":"error",children:w.status})})]},w.id))})]})})]})}),S&&e.jsx(fh,{isOpen:S,onClose:()=>A(!1),title:"Save Path",children:e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Path Name"}),e.jsx(dr,{value:k,onChange:w=>I(w.target.value),placeholder:"e.g., Production to AWS",className:"mb-4"}),e.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[t,"  ",s," (",a.toUpperCase(),r?`:${r}`:"",")"]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{variant:"secondary",onClick:()=>A(!1),children:"Cancel"}),e.jsx(D,{onClick:Z,children:"Save"})]})]})})]})},x1={source:{icon:"",label:"Source",color:"from-blue-500 to-blue-600",borderColor:"border-blue-500"},firewall:{icon:"",label:"Firewall",color:"from-red-500 to-red-600",borderColor:"border-red-500"},cloud_gateway:{icon:"",label:"Cloud Gateway",color:"from-cyan-500 to-cyan-600",borderColor:"border-cyan-500"},nsg:{icon:"",label:"Network Security Group",color:"from-blue-500 to-indigo-600",borderColor:"border-blue-500"},security_group:{icon:"",label:"Security Group",color:"from-orange-500 to-orange-600",borderColor:"border-orange-500"},router:{icon:"",label:"Router",color:"from-purple-500 to-purple-600",borderColor:"border-purple-500"},destination:{icon:"",label:"Destination",color:"from-emerald-500 to-emerald-600",borderColor:"border-emerald-500"},unknown:{icon:"",label:"Unknown",color:"from-slate-500 to-slate-600",borderColor:"border-slate-500"}},g1={low:"bg-slate-500/20 text-slate-400 border-slate-500/30",medium:"bg-amber-500/20 text-amber-400 border-amber-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",critical:"bg-red-500/20 text-red-400 border-red-500/30"},f1=({type:t})=>t==="blocked"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}):t==="asymmetric_routing"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}):t==="missing_rule"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),v1=({hop:t,isLast:s})=>{var d,h,u;const[a,r]=v.useState(!1),n=x1[t.hopType],i=t.issues&&t.issues.length>0,o=(d=t.issues)==null?void 0:d.some(x=>x.type==="blocked"),l=(h=t.issues)==null?void 0:h.some(x=>x.type==="asymmetric_routing"),c=(u=t.issues)==null?void 0:u.some(x=>x.type==="missing_rule");return e.jsxs("div",{className:"relative",children:[!s&&e.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-1 h-12 flex flex-col items-center",children:[e.jsx("div",{className:`flex-1 w-1 ${o?"bg-red-500 animate-pulse":"bg-slate-600"}`}),e.jsx("svg",{className:`w-6 h-6 ${o?"text-red-500":"text-slate-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 16l-6-6h12z"})})]}),e.jsxs("div",{onClick:()=>r(!a),className:`relative bg-slate-800 rounded-lg border-2 ${o?"border-red-500 shadow-red-500/50":l?"border-amber-500 shadow-amber-500/50":c?"border-orange-500 shadow-orange-500/50":n.borderColor} shadow-lg cursor-pointer transition-all hover:scale-105 ${a?"ring-2 ring-cyan-500":""}`,children:[i&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-xs font-bold text-white border-2 border-slate-900",children:t.issues.length}),e.jsx("div",{className:`bg-gradient-to-r ${n.color} p-4 rounded-t-lg`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:n.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-lg",children:t.deviceName||n.label}),e.jsx("p",{className:"text-white/80 text-sm font-mono",children:t.ipAddress})]})]}),e.jsxs("div",{className:"text-white/90 font-mono text-sm",children:["#",t.hopNumber]})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-slate-700/50 p-2 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Latency"}),e.jsxs("p",{className:`font-bold ${t.avgLatency>100?"text-red-400":t.avgLatency>50?"text-amber-400":"text-emerald-400"}`,children:[t.avgLatency.toFixed(1)," ms"]})]}),e.jsxs("div",{className:"bg-slate-700/50 p-2 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Packet Loss"}),e.jsxs("p",{className:`font-bold ${t.packetLoss>0?"text-red-400":"text-emerald-400"}`,children:[t.packetLoss.toFixed(1),"%"]})]})]}),(t.location||t.cloudProvider)&&e.jsxs("div",{className:"flex gap-2 text-sm",children:[t.location&&e.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs",children:[" ",t.location]}),t.cloudProvider&&e.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs uppercase",children:[t.cloudProvider==="aws"&&" AWS",t.cloudProvider==="azure"&&" Azure",t.cloudProvider==="gcp"&&" GCP"]})]}),i&&e.jsx("div",{className:"space-y-2",children:t.issues.map((x,_)=>e.jsx("div",{className:`p-3 rounded-lg border ${g1[x.severity]}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f1,{type:x.type}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h5",{className:"font-semibold text-sm capitalize",children:x.type.replace(/_/g," ")}),e.jsx("span",{className:"text-xs uppercase font-bold",children:x.severity})]}),e.jsx("p",{className:"text-sm",children:x.message}),a&&e.jsx("div",{className:"mt-2 pt-2 border-t border-current/20",children:e.jsxs("p",{className:"text-xs opacity-80",children:[" ",x.recommendation]})})]})]})},_))}),a&&t.securityRules&&t.securityRules.length>0&&e.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[e.jsxs("h5",{className:"text-white font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Security Rules"]}),e.jsx("div",{className:"space-y-1",children:t.securityRules.map(x=>e.jsxs("div",{className:`p-2 rounded text-xs font-mono ${x.matched?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-slate-700/30 text-slate-400"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:x.name}),e.jsx("span",{className:`uppercase font-bold ${x.action==="allow"?"text-emerald-400":"text-red-400"}`,children:x.action})]}),e.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[x.source,"  ",x.destination,":",x.port,"/",x.protocol]})]},x.id))})]}),a&&t.returnPath&&e.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[e.jsx("h5",{className:"text-white font-semibold text-sm mb-2",children:"Return Path"}),e.jsx("div",{className:`p-2 rounded text-sm ${t.returnPath.isSymmetric?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-amber-500/20 text-amber-400 border border-amber-500/30"}`,children:t.returnPath.isSymmetric?e.jsxs("span",{children:[" Symmetric routing via ",t.returnPath.ipAddress]}):e.jsxs("div",{children:[e.jsx("p",{children:" Asymmetric routing detected"}),e.jsx("p",{className:"text-xs mt-1 opacity-80",children:t.returnPath.asymmetryReason})]})})]}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"text-xs text-slate-400 hover:text-cyan-400 flex items-center justify-center gap-1 mx-auto",children:[a?"Less Details":"More Details",e.jsx("svg",{className:`w-3 h-3 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})]})]})},y1=({pathData:t})=>e.jsxs(y,{children:[e.jsx(B,{title:"Network Path Graph",subtitle:`${t.source}  ${t.destination}`}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-700/50 p-4 rounded-lg border border-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Total Hops"}),e.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:t.hops.length})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${t.issues.blocked>0?"bg-red-500/10 border-red-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Blocked Hops"}),e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})]}),e.jsx("div",{className:`text-3xl font-bold ${t.issues.blocked>0?"text-red-400":"text-emerald-400"}`,children:t.issues.blocked})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${t.issues.asymmetricRouting>0?"bg-amber-500/10 border-amber-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Asymmetric Routes"}),e.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})]}),e.jsx("div",{className:`text-3xl font-bold ${t.issues.asymmetricRouting>0?"text-amber-400":"text-emerald-400"}`,children:t.issues.asymmetricRouting})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${t.issues.missingRules>0?"bg-orange-500/10 border-orange-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Missing Rules"}),e.jsx("svg",{className:"w-5 h-5 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),e.jsx("div",{className:`text-3xl font-bold ${t.issues.missingRules>0?"text-orange-400":"text-emerald-400"}`,children:t.issues.missingRules})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:`p-4 rounded-lg border-2 ${t.health==="healthy"?"bg-emerald-500/10 border-emerald-500/30":t.health==="degraded"?"bg-amber-500/10 border-amber-500/30":t.health==="critical"?"bg-red-500/10 border-red-500/30":"bg-slate-500/10 border-slate-500/30"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-1",children:"Overall Path Health"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[t.health==="healthy"&&"All hops are operational with no issues detected",t.health==="degraded"&&"Some issues detected - path is functional but may have performance impacts",t.health==="critical"&&"Critical issues detected - path may be blocked or severely degraded",t.health==="unknown"&&"Unable to determine path health"]})]}),e.jsx("div",{className:`px-6 py-3 rounded-lg text-lg font-bold uppercase ${t.health==="healthy"?"bg-emerald-500 text-white":t.health==="degraded"?"bg-amber-500 text-white":t.health==="critical"?"bg-red-500 text-white":"bg-slate-500 text-white"}`,children:t.health})]})})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"grid grid-cols-1 gap-12 max-w-4xl mx-auto",children:t.hops.map((s,a)=>e.jsx(v1,{hop:s,isFirst:a===0,isLast:a===t.hops.length-1},s.hopNumber))})}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-700",children:[e.jsx("h4",{className:"text-white font-semibold mb-4",children:"Legend"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded animate-pulse"}),e.jsx("span",{className:"text-slate-300",children:"Blocked Traffic"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-amber-500 rounded"}),e.jsx("span",{className:"text-slate-300",children:"Asymmetric Routing"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsx("span",{className:"text-slate-300",children:"Missing Rule"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-emerald-500 rounded"}),e.jsx("span",{className:"text-slate-300",children:"Healthy"})]})]})]})]})]}),b1={id:"path-001",source:"10.100.5.10",destination:"52.94.76.50",health:"healthy",hasReturnPath:!0,issues:{blocked:0,asymmetricRouting:0,missingRules:0,total:0},hops:[{hopNumber:1,hopType:"source",deviceName:"App Server - prod-web-01",ipAddress:"10.100.5.10",hostname:"prod-web-01.company.local",location:"DC-US-EAST-1",asn:null,asnOrg:null,latency:[.8,.9,.7],avgLatency:.8,minLatency:.7,maxLatency:.9,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[],securityRules:[],returnPath:{hopNumber:1,ipAddress:"10.100.5.10",isSymmetric:!0}},{hopNumber:2,hopType:"router",deviceName:"Core Router",ipAddress:"10.100.1.1",hostname:"core-rtr-01.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[2.1,2.3,2],avgLatency:2.1,minLatency:2,maxLatency:2.3,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[],returnPath:{hopNumber:2,ipAddress:"10.100.1.1",isSymmetric:!0}},{hopNumber:3,hopType:"firewall",deviceName:"Production Edge Firewall",ipAddress:"10.100.0.1",hostname:"fw-prod-edge-01.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[4.5,4.8,4.3],avgLatency:4.5,minLatency:4.3,maxLatency:4.8,jitter:.3,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:null,issues:[],securityRules:[{id:"rule-001",name:"Allow-Outbound-HTTPS",action:"allow",source:"10.100.0.0/16",destination:"any",port:"443",protocol:"tcp",priority:100,matched:!0}],returnPath:{hopNumber:3,ipAddress:"10.100.0.1",isSymmetric:!0}},{hopNumber:4,hopType:"cloud_gateway",deviceName:"AWS Direct Connect",ipAddress:"169.254.1.1",hostname:"dx-vif-aws.company.local",location:"us-east-1",asn:"AS16509",asnOrg:"Amazon.com Inc.",latency:[8.2,8.5,8.1],avgLatency:8.3,minLatency:8.1,maxLatency:8.5,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:"aws",region:"us-east-1",issues:[],returnPath:{hopNumber:4,ipAddress:"169.254.1.1",isSymmetric:!0}},{hopNumber:5,hopType:"security_group",deviceName:"App-Tier Security Group",ipAddress:"172.31.10.1",hostname:null,location:"us-east-1a",asn:"AS16509",asnOrg:"Amazon.com Inc.",latency:[10.1,10.4,9.9],avgLatency:10.1,minLatency:9.9,maxLatency:10.4,jitter:.3,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:"aws",region:"us-east-1",issues:[],securityRules:[{id:"sg-rule-001",name:"Allow-Inbound-HTTPS",action:"allow",source:"10.100.0.0/16",destination:"172.31.10.0/24",port:"443",protocol:"tcp",priority:100,matched:!0}],returnPath:{hopNumber:5,ipAddress:"172.31.10.1",isSymmetric:!0}},{hopNumber:6,hopType:"destination",deviceName:"AWS Application Server",ipAddress:"52.94.76.50",hostname:"ec2-52-94-76-50.compute-1.amazonaws.com",location:"us-east-1a",asn:"AS16509",asnOrg:"Amazon.com Inc.",latency:[12.3,12.6,12.1],avgLatency:12.3,minLatency:12.1,maxLatency:12.6,jitter:.3,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:"aws",region:"us-east-1",issues:[],returnPath:{hopNumber:6,ipAddress:"52.94.76.50",isSymmetric:!0}}]},_1={id:"path-002",source:"10.200.15.20",destination:"172.16.50.100",health:"critical",hasReturnPath:!1,issues:{blocked:1,asymmetricRouting:0,missingRules:0,total:1},hops:[{hopNumber:1,hopType:"source",deviceName:"UAT Server",ipAddress:"10.200.15.20",hostname:"uat-app-02.company.local",location:"DC-US-WEST-1",asn:null,asnOrg:null,latency:[.9,1,.8],avgLatency:.9,minLatency:.8,maxLatency:1,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[],securityRules:[]},{hopNumber:2,hopType:"router",deviceName:"Distribution Router",ipAddress:"10.200.1.1",hostname:"dist-rtr-02.company.local",location:"DC-US-WEST-1",asn:"AS64512",asnOrg:"Company Network",latency:[3.2,3.5,3.1],avgLatency:3.3,minLatency:3.1,maxLatency:3.5,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[]},{hopNumber:3,hopType:"firewall",deviceName:"UAT Firewall",ipAddress:"10.200.0.1",hostname:"fw-uat-01.company.local",location:"DC-US-WEST-1",asn:"AS64512",asnOrg:"Company Network",latency:[0,0,0],avgLatency:0,minLatency:0,maxLatency:0,jitter:0,packetLoss:100,status:"unreachable",deviceType:"firewall",cloudProvider:null,issues:[{type:"blocked",severity:"critical",message:"Traffic is being blocked by firewall rule",recommendation:"Review firewall rules and add appropriate allow rule for this traffic",details:"Deny rule at priority 50 is blocking TCP/443 traffic from 10.200.0.0/16 to 172.16.50.0/24"},{type:"missing_rule",severity:"high",message:"No explicit allow rule found for this traffic",recommendation:"Add allow rule: permit tcp 10.200.15.20 172.16.50.100 eq 443"}],securityRules:[{id:"rule-deny-001",name:"Deny-UAT-to-Prod",action:"deny",source:"10.200.0.0/16",destination:"172.16.0.0/16",port:"any",protocol:"any",priority:50,matched:!0}]}]},w1={id:"path-003",source:"10.100.20.30",destination:"13.82.100.50",health:"degraded",hasReturnPath:!0,issues:{blocked:0,asymmetricRouting:2,missingRules:0,total:2},hops:[{hopNumber:1,hopType:"source",deviceName:"Production DB Server",ipAddress:"10.100.20.30",hostname:"prod-db-01.company.local",location:"DC-US-EAST-1",asn:null,asnOrg:null,latency:[.7,.8,.7],avgLatency:.7,minLatency:.7,maxLatency:.8,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[],returnPath:{hopNumber:1,ipAddress:"10.100.20.30",isSymmetric:!0}},{hopNumber:2,hopType:"router",deviceName:"Core Router Primary",ipAddress:"10.100.1.5",hostname:"core-rtr-pri.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[2.5,2.7,2.4],avgLatency:2.5,minLatency:2.4,maxLatency:2.7,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[{type:"asymmetric_routing",severity:"medium",message:"Return path uses different router (core-rtr-sec)",recommendation:"Verify routing policies and ensure symmetric routing for stateful connections",details:"Forward: core-rtr-pri (10.100.1.5), Return: core-rtr-sec (10.100.1.6)"}],returnPath:{hopNumber:2,ipAddress:"10.100.1.6",isSymmetric:!1,asymmetryReason:"Return path uses secondary core router due to ECMP load balancing"}},{hopNumber:3,hopType:"firewall",deviceName:"Production Firewall",ipAddress:"10.100.0.1",hostname:"fw-prod-01.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[5.2,5.5,5.1],avgLatency:5.3,minLatency:5.1,maxLatency:5.5,jitter:.2,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:null,issues:[],securityRules:[{id:"rule-002",name:"Allow-Azure-Access",action:"allow",source:"10.100.0.0/16",destination:"13.0.0.0/8",port:"443",protocol:"tcp",priority:100,matched:!0}],returnPath:{hopNumber:3,ipAddress:"10.100.0.1",isSymmetric:!0}},{hopNumber:4,hopType:"cloud_gateway",deviceName:"Azure ExpressRoute",ipAddress:"169.254.2.1",hostname:"er-vnet-azure.company.local",location:"eastus",asn:"AS8075",asnOrg:"Microsoft Corporation",latency:[15.3,15.8,15.1],avgLatency:15.4,minLatency:15.1,maxLatency:15.8,jitter:.4,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:"azure",region:"eastus",issues:[{type:"asymmetric_routing",severity:"medium",message:"Return traffic routed through different ExpressRoute circuit",recommendation:"Configure route preferences to ensure symmetric routing",details:"Forward: Primary circuit, Return: Secondary circuit"}],returnPath:{hopNumber:4,ipAddress:"169.254.2.2",isSymmetric:!1,asymmetryReason:"Return path uses secondary ExpressRoute circuit for load distribution"}},{hopNumber:5,hopType:"nsg",deviceName:"Database NSG",ipAddress:"10.50.20.1",hostname:null,location:"eastus",asn:"AS8075",asnOrg:"Microsoft Corporation",latency:[18.2,18.6,18],avgLatency:18.3,minLatency:18,maxLatency:18.6,jitter:.3,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:"azure",region:"eastus",issues:[],securityRules:[{id:"nsg-rule-001",name:"Allow-Internal-DB",action:"allow",source:"10.100.0.0/16",destination:"10.50.20.0/24",port:"1433",protocol:"tcp",priority:100,matched:!1},{id:"nsg-rule-002",name:"Allow-HTTPS",action:"allow",source:"any",destination:"10.50.20.0/24",port:"443",protocol:"tcp",priority:110,matched:!0}],returnPath:{hopNumber:5,ipAddress:"10.50.20.1",isSymmetric:!0}},{hopNumber:6,hopType:"destination",deviceName:"Azure SQL Database",ipAddress:"13.82.100.50",hostname:"sqldb-prod-01.database.windows.net",location:"eastus",asn:"AS8075",asnOrg:"Microsoft Corporation",latency:[20.5,20.9,20.3],avgLatency:20.6,minLatency:20.3,maxLatency:20.9,jitter:.3,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:"azure",region:"eastus",issues:[],returnPath:{hopNumber:6,ipAddress:"13.82.100.50",isSymmetric:!0}}]},j1={id:"path-004",source:"10.150.10.15",destination:"35.192.50.25",health:"degraded",hasReturnPath:!0,issues:{blocked:0,asymmetricRouting:0,missingRules:1,total:1},hops:[{hopNumber:1,hopType:"source",deviceName:"Dev Application Server",ipAddress:"10.150.10.15",hostname:"dev-app-03.company.local",location:"DC-US-WEST-2",asn:null,asnOrg:null,latency:[1,1.1,.9],avgLatency:1,minLatency:.9,maxLatency:1.1,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[]},{hopNumber:2,hopType:"router",deviceName:"Access Router",ipAddress:"10.150.1.1",hostname:"access-rtr-03.company.local",location:"DC-US-WEST-2",asn:"AS64512",asnOrg:"Company Network",latency:[3.8,4,3.7],avgLatency:3.8,minLatency:3.7,maxLatency:4,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[]},{hopNumber:3,hopType:"firewall",deviceName:"Dev Firewall",ipAddress:"10.150.0.1",hostname:"fw-dev-01.company.local",location:"DC-US-WEST-2",asn:"AS64512",asnOrg:"Company Network",latency:[125.3,128.5,124.1],avgLatency:126,minLatency:124.1,maxLatency:128.5,jitter:2.2,packetLoss:2.5,status:"reachable",deviceType:"firewall",cloudProvider:null,issues:[{type:"missing_rule",severity:"high",message:"No explicit rule found - traffic falling back to default policy",recommendation:"Add explicit allow rule to improve performance and security posture",details:"Traffic is allowed by implicit default-allow but causing deep packet inspection delays"},{type:"high_latency",severity:"medium",message:"High latency detected (126ms) - significantly above baseline",recommendation:"Investigate firewall processing load and rule optimization"},{type:"packet_loss",severity:"low",message:"Minor packet loss detected (2.5%)",recommendation:"Monitor for persistent packet loss issues"}],securityRules:[{id:"rule-default",name:"Default-Allow-All",action:"allow",source:"any",destination:"any",port:"any",protocol:"any",priority:9999,matched:!0}]},{hopNumber:4,hopType:"cloud_gateway",deviceName:"GCP Cloud Interconnect",ipAddress:"169.254.3.1",hostname:"interconnect-gcp.company.local",location:"us-west2",asn:"AS15169",asnOrg:"Google LLC",latency:[135.2,136.1,134.8],avgLatency:135.4,minLatency:134.8,maxLatency:136.1,jitter:.7,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:"gcp",region:"us-west2",issues:[]},{hopNumber:5,hopType:"destination",deviceName:"GCP Compute Instance",ipAddress:"35.192.50.25",hostname:"instance-1.us-west2-a.c.project-id.internal",location:"us-west2-a",asn:"AS15169",asnOrg:"Google LLC",latency:[138.5,139.2,138.1],avgLatency:138.6,minLatency:138.1,maxLatency:139.2,jitter:.6,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:"gcp",region:"us-west2",issues:[]}]},bc={healthy:b1,blocked:_1,asymmetric:w1,missingRule:j1},N1=()=>{const[t,s]=v.useState("graph"),[a,r]=v.useState("healthy"),[n,i]=v.useState(bc.healthy),o=c=>{r(c),c!=="custom"&&i(bc[c])},l=[{id:"healthy",name:"Healthy Path",description:"Production to AWS - No issues",icon:"",color:"from-emerald-500 to-emerald-600"},{id:"blocked",name:"Blocked Traffic",description:"Firewall blocking UAT to Prod",icon:"",color:"from-red-500 to-red-600"},{id:"asymmetric",name:"Asymmetric Routing",description:"Different forward/return paths",icon:"",color:"from-amber-500 to-amber-600"},{id:"missingRule",name:"Missing Rule",description:"Fallback to default policy",icon:"",color:"from-orange-500 to-orange-600"}];return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Traffic Path Analysis"}),e.jsx("p",{className:"text-slate-400",children:"Graph-based visualization with blocked hop, asymmetric routing, and missing rule detection"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs(y,{className:"p-4",children:[e.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Visualization Mode"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:t==="graph"?"primary":"secondary",onClick:()=>s("graph"),className:"flex-1",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"Graph View"]}),e.jsxs(D,{variant:t==="list"?"primary":"secondary",onClick:()=>s("list"),className:"flex-1",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),"List View"]})]})]}),e.jsxs(y,{className:"p-4 col-span-2",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Current Path"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Source"}),e.jsx("p",{className:"text-white font-mono",children:n.source})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Destination"}),e.jsx("p",{className:"text-white font-mono",children:n.destination})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Total Hops"}),e.jsx("p",{className:"text-white font-semibold",children:n.hops.length})]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs(y,{className:"p-6",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),"Sample Scenarios"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:l.map(c=>e.jsxs("button",{onClick:()=>o(c.id),className:`p-4 rounded-lg border-2 transition-all text-left ${a===c.id?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${c.color} rounded-lg flex items-center justify-center text-2xl mb-3`,children:c.icon}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:c.name}),e.jsx("p",{className:"text-slate-400 text-xs",children:c.description})]},c.id))})]})}),t==="graph"?e.jsx(y1,{pathData:n}):e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"List View"}),e.jsx("p",{className:"text-slate-400 text-center py-8",children:"List view coming soon - showing classic hop-by-hop table format"})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsxs(D,{variant:"ghost",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Report"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Compare Paths"]}),e.jsxs(D,{variant:"primary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Run New Analysis"]})]})]})]})},S1={totalRoutes:847,optimalRoutes:712,suboptimalRoutes:98,degradedRoutes:24,failingRoutes:13,staticRoutes:156,dynamicRoutes:691,bgpRoutes:423,ospfRoutes:268,connectedRoutes:89},k1={averageLatency:42.3,routeAvailability:99.87,optimalRoutesPercentage:84.1,optimizationOpportunities:7,estimatedMonthlySavings:34500},C1=[{id:"ROUTE-001",name:"Primary Internet Gateway - US East",source:"10.0.0.0/8",destination:"0.0.0.0/0",nextHop:"203.0.113.1",protocol:"BGP",routeType:"bgp",status:"suboptimal",health:"warning",metrics:{latencyMs:78.5,jitterMs:4.2,packetLoss:.15,bandwidth:"10 Gbps",utilization:67.3,throughput:"6.73 Gbps",mtu:1500,hopCount:12},path:[{sequence:1,ipAddress:"10.0.1.1",hostname:"core-router-01.internal",location:"US-EAST-DC1",latencyMs:.8,asn:64512,provider:"Internal"},{sequence:2,ipAddress:"203.0.113.1",hostname:"edge-gw-01.isp.net",location:"US-EAST-POP",latencyMs:2.1,asn:701,provider:"Verizon"},{sequence:3,ipAddress:"198.51.100.5",hostname:"transit-01.backbone.net",location:"US-EAST",latencyMs:12.3,asn:174,provider:"Cogent"},{sequence:4,ipAddress:"192.0.2.10",hostname:"peer-exchange.ix.net",location:"US-CENTRAL-IX",latencyMs:28.7,asn:6939,provider:"Hurricane Electric"},{sequence:5,ipAddress:"8.8.8.8",hostname:"dns.google.com",location:"US-WEST",latencyMs:34.6}],alternatives:[{id:"ALT-001-A",path:[{sequence:1,ipAddress:"10.0.1.2",hostname:"core-router-02.internal",location:"US-EAST-DC1",latencyMs:.7,asn:64512,provider:"Internal"},{sequence:2,ipAddress:"203.0.113.10",hostname:"edge-gw-02.isp.net",location:"US-EAST-POP",latencyMs:1.8,asn:3356,provider:"Level3"},{sequence:3,ipAddress:"198.51.100.20",hostname:"transit-02.backbone.net",location:"US-EAST",latencyMs:8.2,asn:1299,provider:"Telia"},{sequence:4,ipAddress:"8.8.8.8",hostname:"dns.google.com",location:"US-WEST",latencyMs:23.1}],metrics:{latencyMs:33.8,jitterMs:1.8,packetLoss:.05,bandwidth:"10 Gbps",utilization:42.1,throughput:"4.21 Gbps",mtu:1500,hopCount:8},estimatedImprovement:{latencyReduction:57,costSavings:1200,reliabilityIncrease:12.5},implementationComplexity:"low",riskLevel:"low",recommendationScore:94}],aiRecommendations:[{id:"REC-001-1",type:"optimize",priority:"high",title:"Switch to Lower Latency Transit Provider",description:"Current path through Cogent (AS174) is adding 16.4ms latency. Alternative via Level3/Telia reduces latency by 57%",rationale:["Cogent transit has consistently higher latency (avg 78.5ms vs 33.8ms)","Level3 path has 4 fewer hops reducing failure points","Current path experiencing 0.15% packet loss vs 0.05% on alternative","Cost analysis shows $1,200/month savings with improved SLA","Historical data shows 99.95% uptime on Level3 vs 99.82% on Cogent"],expectedBenefit:"57% latency reduction, 67% packet loss reduction, improved reliability",estimatedImpact:{performance:57,cost:1200,reliability:12.5},implementationSteps:["Configure BGP peering with Level3 (AS3356) on edge-gw-02","Set higher local preference (150) for Level3 paths","Monitor traffic shift over 2-hour window","Verify latency and packet loss improvements","Update route policies and documentation","Decommission Cogent circuit after 30-day validation"],automationAvailable:!0,confidenceScore:94},{id:"REC-001-2",type:"load-balance",priority:"medium",title:"Implement Intelligent Load Balancing",description:"Use AI-driven traffic steering to automatically select optimal path based on real-time performance",rationale:["Current static routing misses optimization opportunities","Traffic patterns show 30% could benefit from dynamic path selection","Multiple providers available but underutilized","Real-time latency-based routing can improve user experience"],expectedBenefit:"Dynamic optimization, improved fault tolerance, better resource utilization",estimatedImpact:{performance:25,cost:-500,reliability:18},implementationSteps:["Deploy SD-WAN controller with AI routing engine","Configure performance thresholds and policies","Enable real-time path monitoring","Implement gradual traffic shift (10% increments)","Monitor and tune ML models over 2 weeks"],automationAvailable:!0,confidenceScore:87}],anomalies:[{id:"ANOM-001-1",detectedAt:"2024-01-19T14:23:00Z",type:"latency_spike",severity:"medium",description:"Latency increased from 45ms baseline to 78.5ms (74% increase) over past 6 hours",affectedRoutes:["ROUTE-001"],impact:"Degraded user experience for east coast traffic, 850 affected users",rootCause:"Cogent (AS174) experiencing congestion at US-CENTRAL-IX peering point",recommendation:"Switch to alternative Level3 path immediately"},{id:"ANOM-001-2",detectedAt:"2024-01-19T11:15:00Z",type:"packet_loss",severity:"high",description:"Packet loss increased to 0.15% from 0.02% baseline",affectedRoutes:["ROUTE-001"],impact:"TCP retransmissions causing throughput degradation",rootCause:"Fiber cut reported by Cogent on primary backbone link",recommendation:"Failover to secondary transit provider"}],performanceHistory:[{timestamp:"2024-01-19T08:00:00Z",latencyMs:43.2,packetLoss:.02,availability:100,throughputMbps:6820},{timestamp:"2024-01-19T09:00:00Z",latencyMs:44.8,packetLoss:.03,availability:100,throughputMbps:6790},{timestamp:"2024-01-19T10:00:00Z",latencyMs:52.1,packetLoss:.05,availability:99.9,throughputMbps:6650},{timestamp:"2024-01-19T11:00:00Z",latencyMs:68.3,packetLoss:.12,availability:99.5,throughputMbps:6420},{timestamp:"2024-01-19T12:00:00Z",latencyMs:75.2,packetLoss:.14,availability:99.3,throughputMbps:6350},{timestamp:"2024-01-19T13:00:00Z",latencyMs:78.5,packetLoss:.15,availability:99.2,throughputMbps:6290}],administrativeDistance:20,metric:100,age:"3d 7h",tags:["internet","primary","us-east","needs-optimization"],lastUpdated:"2024-01-19T14:30:00Z"},{id:"ROUTE-002",name:"AWS DirectConnect - US East",source:"10.0.0.0/8",destination:"172.16.0.0/12",nextHop:"169.254.1.1",protocol:"BGP",routeType:"bgp",status:"optimal",health:"healthy",metrics:{latencyMs:2.3,jitterMs:.3,packetLoss:.001,bandwidth:"10 Gbps",utilization:34.2,throughput:"3.42 Gbps",mtu:9001,hopCount:2},path:[{sequence:1,ipAddress:"10.0.1.1",hostname:"core-router-01.internal",location:"US-EAST-DC1",latencyMs:.5,asn:64512,provider:"Internal"},{sequence:2,ipAddress:"169.254.1.1",hostname:"dx-vif-01.aws.com",location:"US-EAST-1",latencyMs:1.8,asn:16509,provider:"AWS"}],alternatives:[],aiRecommendations:[{id:"REC-002-1",type:"optimize",priority:"low",title:"Increase DirectConnect Capacity",description:"Current 10Gbps link at 34.2% utilization, but forecasted to reach 80% in 3 months based on growth trends",rationale:["Traffic growth rate: 8.5% month-over-month","Projected capacity exhaustion in Q2 2024","Adding second 10Gbps link now avoids emergency upgrade","Cost-effective to add capacity before hitting 80% threshold"],expectedBenefit:"Proactive capacity planning, avoid performance degradation, improved redundancy",estimatedImpact:{performance:5,cost:-2500,reliability:45},implementationSteps:["Order additional 10Gbps DirectConnect circuit","Configure LAG (Link Aggregation Group) for 20Gbps total","Update BGP configuration for ECMP load balancing","Test failover scenarios","Update capacity monitoring thresholds"],automationAvailable:!1,confidenceScore:78}],anomalies:[],performanceHistory:[{timestamp:"2024-01-19T08:00:00Z",latencyMs:2.1,packetLoss:.001,availability:100,throughputMbps:3380},{timestamp:"2024-01-19T09:00:00Z",latencyMs:2.2,packetLoss:.001,availability:100,throughputMbps:3390},{timestamp:"2024-01-19T10:00:00Z",latencyMs:2.3,packetLoss:.001,availability:100,throughputMbps:3410},{timestamp:"2024-01-19T11:00:00Z",latencyMs:2.2,packetLoss:.001,availability:100,throughputMbps:3420},{timestamp:"2024-01-19T12:00:00Z",latencyMs:2.4,packetLoss:.001,availability:100,throughputMbps:3430},{timestamp:"2024-01-19T13:00:00Z",latencyMs:2.3,packetLoss:.001,availability:100,throughputMbps:3420}],administrativeDistance:20,metric:100,age:"45d 12h",vrf:"AWS-PROD",tags:["aws","directconnect","optimal","production"],lastUpdated:"2024-01-19T14:30:00Z"},{id:"ROUTE-003",name:"Azure ExpressRoute - US West",source:"10.0.0.0/8",destination:"172.17.0.0/16",nextHop:"192.168.1.1",protocol:"BGP",routeType:"bgp",status:"degraded",health:"critical",metrics:{latencyMs:145.7,jitterMs:18.5,packetLoss:1.25,bandwidth:"1 Gbps",utilization:92.3,throughput:"923 Mbps",mtu:1500,hopCount:8},path:[{sequence:1,ipAddress:"10.0.2.1",hostname:"core-router-02.internal",location:"US-WEST-DC1",latencyMs:.9,asn:64512,provider:"Internal"},{sequence:2,ipAddress:"192.168.1.1",hostname:"msee-01.azure.com",location:"US-WEST-2",latencyMs:144.8,asn:12076,provider:"Microsoft"}],alternatives:[{id:"ALT-003-A",path:[{sequence:1,ipAddress:"10.0.2.2",hostname:"core-router-03.internal",location:"US-WEST-DC1",latencyMs:.8,asn:64512,provider:"Internal"},{sequence:2,ipAddress:"192.168.1.10",hostname:"msee-02.azure.com",location:"US-WEST-2",latencyMs:3.5,asn:12076,provider:"Microsoft"}],metrics:{latencyMs:4.3,jitterMs:.8,packetLoss:.01,bandwidth:"10 Gbps",utilization:15.2,throughput:"1.52 Gbps",mtu:1500,hopCount:3},estimatedImprovement:{latencyReduction:97,costSavings:0,reliabilityIncrease:98.5},implementationComplexity:"low",riskLevel:"low",recommendationScore:98}],aiRecommendations:[{id:"REC-003-1",type:"failover",priority:"critical",title:"Immediate Failover to Secondary ExpressRoute",description:"Primary circuit experiencing severe degradation with 1.25% packet loss and 145ms latency. Secondary circuit healthy with 4.3ms latency",rationale:["Packet loss exceeds SLA threshold (>1%)","Latency 33x higher than baseline (4.3ms)","Circuit utilization at 92.3% indicating congestion","Secondary circuit available with 97% better performance","User impact: 2,400 Azure workloads experiencing degradation"],expectedBenefit:"Immediate performance restoration, eliminate packet loss, 97% latency reduction",estimatedImpact:{performance:97,cost:0,reliability:98.5},implementationSteps:["Verify secondary ExpressRoute health (COMPLETE)","Adjust BGP local preference to prefer secondary (Priority 1)","Monitor traffic migration over 5 minutes","Verify performance metrics return to baseline","Open ticket with Microsoft for primary circuit investigation","Keep primary disabled until root cause resolved"],automationAvailable:!0,confidenceScore:98},{id:"REC-003-2",type:"replace",priority:"high",title:"Upgrade Primary ExpressRoute to 10Gbps",description:"Current 1Gbps circuit insufficient for workload, causing congestion. Secondary 10Gbps circuit demonstrates adequate capacity",rationale:["Primary circuit consistently at >90% utilization","Traffic growth requires minimum 2Gbps capacity","10Gbps provides headroom for 3-year growth","Cost per Mbps decreases with 10Gbps tier"],expectedBenefit:"Eliminate capacity bottleneck, improve redundancy, future-proof connectivity",estimatedImpact:{performance:85,cost:-3500,reliability:25},implementationSteps:["Order 10Gbps ExpressRoute upgrade for primary circuit","Schedule maintenance window for cutover","Update routing policies for equal-cost multipath","Test load balancing across both circuits","Update monitoring thresholds for 10Gbps capacity"],automationAvailable:!1,confidenceScore:92}],anomalies:[{id:"ANOM-003-1",detectedAt:"2024-01-19T13:45:00Z",type:"latency_spike",severity:"critical",description:"Catastrophic latency increase from 4.5ms to 145.7ms (3137% increase)",affectedRoutes:["ROUTE-003"],impact:"Azure workloads experiencing severe degradation, 2,400 affected connections",rootCause:"ExpressRoute primary circuit capacity exhaustion causing buffering and delays",recommendation:"IMMEDIATE FAILOVER REQUIRED - Secondary circuit available and healthy"},{id:"ANOM-003-2",detectedAt:"2024-01-19T13:50:00Z",type:"packet_loss",severity:"critical",description:"Packet loss at 1.25% exceeding SLA threshold of 0.1%",affectedRoutes:["ROUTE-003"],impact:"Application timeouts, database connection failures, user complaints",rootCause:"Circuit congestion causing buffer overflow and packet drops",recommendation:"Failover to secondary circuit immediately"}],performanceHistory:[{timestamp:"2024-01-19T08:00:00Z",latencyMs:4.2,packetLoss:.01,availability:100,throughputMbps:780},{timestamp:"2024-01-19T09:00:00Z",latencyMs:4.5,packetLoss:.01,availability:100,throughputMbps:850},{timestamp:"2024-01-19T10:00:00Z",latencyMs:5.8,packetLoss:.05,availability:99.9,throughputMbps:895},{timestamp:"2024-01-19T11:00:00Z",latencyMs:12.3,packetLoss:.15,availability:99.7,throughputMbps:912},{timestamp:"2024-01-19T12:00:00Z",latencyMs:48.7,packetLoss:.45,availability:99.2,throughputMbps:920},{timestamp:"2024-01-19T13:00:00Z",latencyMs:145.7,packetLoss:1.25,availability:97.8,throughputMbps:923}],administrativeDistance:20,metric:100,age:"12d 3h",vrf:"AZURE-PROD",tags:["azure","expressroute","critical","needs-immediate-action"],lastUpdated:"2024-01-19T14:30:00Z"},{id:"ROUTE-004",name:"GCP Interconnect - US Central",source:"10.0.0.0/8",destination:"172.18.0.0/16",nextHop:"169.254.2.1",protocol:"BGP",routeType:"bgp",status:"optimal",health:"healthy",metrics:{latencyMs:1.8,jitterMs:.2,packetLoss:.001,bandwidth:"10 Gbps",utilization:28.5,throughput:"2.85 Gbps",mtu:1500,hopCount:2},path:[{sequence:1,ipAddress:"10.0.3.1",hostname:"core-router-03.internal",location:"US-CENTRAL-DC1",latencyMs:.4,asn:64512,provider:"Internal"},{sequence:2,ipAddress:"169.254.2.1",hostname:"interconnect-01.gcp.com",location:"US-CENTRAL-1",latencyMs:1.4,asn:15169,provider:"Google"}],alternatives:[],aiRecommendations:[],anomalies:[],performanceHistory:[{timestamp:"2024-01-19T08:00:00Z",latencyMs:1.7,packetLoss:.001,availability:100,throughputMbps:2820},{timestamp:"2024-01-19T09:00:00Z",latencyMs:1.8,packetLoss:.001,availability:100,throughputMbps:2830},{timestamp:"2024-01-19T10:00:00Z",latencyMs:1.9,packetLoss:.001,availability:100,throughputMbps:2845},{timestamp:"2024-01-19T11:00:00Z",latencyMs:1.8,packetLoss:.001,availability:100,throughputMbps:2850},{timestamp:"2024-01-19T12:00:00Z",latencyMs:1.7,packetLoss:.001,availability:100,throughputMbps:2855},{timestamp:"2024-01-19T13:00:00Z",latencyMs:1.8,packetLoss:.001,availability:100,throughputMbps:2850}],administrativeDistance:20,metric:100,age:"28d 15h",vrf:"GCP-PROD",tags:["gcp","interconnect","optimal","production"],lastUpdated:"2024-01-19T14:30:00Z"}],A1=[{id:"OPP-001",title:"Optimize Internet Gateway Transit Provider",description:"Switch primary internet route from Cogent to Level3 for 57% latency reduction and improved reliability",affectedRoutes:["ROUTE-001"],potentialSavings:1200,performanceGain:57,implementationEffort:"low",priority:"high",estimatedROI:340},{id:"OPP-002",title:"Azure ExpressRoute Emergency Failover",description:"Immediate failover required - primary circuit experiencing critical degradation (1.25% packet loss, 145ms latency)",affectedRoutes:["ROUTE-003"],potentialSavings:0,performanceGain:97,implementationEffort:"low",priority:"critical",estimatedROI:9500},{id:"OPP-003",title:"Upgrade Azure ExpressRoute Capacity",description:"Primary circuit at 92.3% utilization. Upgrade from 1Gbps to 10Gbps to eliminate bottleneck",affectedRoutes:["ROUTE-003"],potentialSavings:-3500,performanceGain:85,implementationEffort:"medium",priority:"high",estimatedROI:220},{id:"OPP-004",title:"Implement AI-Driven Load Balancing",description:"Deploy SD-WAN with ML-based routing to automatically select optimal paths in real-time",affectedRoutes:["ROUTE-001","ROUTE-002","ROUTE-003","ROUTE-004"],potentialSavings:-500,performanceGain:25,implementationEffort:"high",priority:"medium",estimatedROI:180},{id:"OPP-005",title:"Proactive AWS DirectConnect Capacity Expansion",description:"Add second 10Gbps circuit before hitting 80% utilization threshold in Q2 2024",affectedRoutes:["ROUTE-002"],potentialSavings:-2500,performanceGain:5,implementationEffort:"medium",priority:"low",estimatedROI:85},{id:"OPP-006",title:"Consolidate Underutilized Circuits",description:"Analysis shows 3 legacy MPLS circuits with <15% utilization that can be decommissioned",affectedRoutes:[],potentialSavings:8200,performanceGain:0,implementationEffort:"medium",priority:"medium",estimatedROI:450},{id:"OPP-007",title:"Optimize BGP Route Advertisement",description:"Reduce BGP table size by 18% through route aggregation and filtering, improving convergence time",affectedRoutes:["ROUTE-001","ROUTE-002","ROUTE-003","ROUTE-004"],potentialSavings:0,performanceGain:12,implementationEffort:"low",priority:"medium",estimatedROI:95}],T1=[{id:"ANOM-RECENT-1",detectedAt:"2024-01-19T13:45:00Z",type:"latency_spike",severity:"critical",description:"Azure ExpressRoute primary circuit latency catastrophic increase to 145.7ms",affectedRoutes:["ROUTE-003"],impact:"CRITICAL - 2,400 Azure workloads affected, multiple application timeouts",rootCause:"Circuit capacity exhaustion at 92.3% utilization",recommendation:"IMMEDIATE ACTION: Failover to secondary circuit"},{id:"ANOM-RECENT-2",detectedAt:"2024-01-19T14:23:00Z",type:"latency_spike",severity:"medium",description:"Internet gateway latency elevated to 78.5ms from 45ms baseline",affectedRoutes:["ROUTE-001"],impact:"User experience degradation for 850 users on east coast",rootCause:"Cogent backbone congestion at IX peering point",recommendation:"Switch to Level3 transit provider"},{id:"ANOM-RECENT-3",detectedAt:"2024-01-19T11:15:00Z",type:"packet_loss",severity:"high",description:"Internet gateway packet loss increased to 0.15%",affectedRoutes:["ROUTE-001"],impact:"TCP retransmissions causing throughput degradation",rootCause:"Fiber cut on Cogent backbone reported",recommendation:"Migrate to alternative transit path"},{id:"ANOM-RECENT-4",detectedAt:"2024-01-19T09:30:00Z",type:"route_flap",severity:"medium",description:"BGP route flapping detected on 23 routes in past hour",affectedRoutes:["ROUTE-001"],impact:"Intermittent connectivity issues, routing instability",rootCause:"BGP dampening not configured, upstream provider instability",recommendation:"Enable BGP route dampening with appropriate thresholds"},{id:"ANOM-RECENT-5",detectedAt:"2024-01-19T07:15:00Z",type:"suboptimal_path",severity:"low",description:"Traffic to 8.8.8.8 taking suboptimal 12-hop path via Cogent",affectedRoutes:["ROUTE-001"],impact:"Minor - 8ms additional latency for DNS queries",rootCause:"BGP path selection favoring higher AS path count",recommendation:"Adjust BGP attributes to prefer direct peering path"}],P1={routes:C1,summary:S1,metrics:k1,optimizationOpportunities:A1,recentAnomalies:T1},I1=()=>{const{routes:t,summary:s,metrics:a,optimizationOpportunities:r,recentAnomalies:n}=P1,[i,o]=v.useState(null),[l,c]=v.useState("all"),[d,h]=v.useState("all"),u=t.filter(m=>!(l!=="all"&&m.status!==l||d!=="all"&&m.health!==d)),x=m=>{switch(m){case"optimal":return"bg-emerald-500";case"suboptimal":return"bg-yellow-500";case"degraded":return"bg-orange-500";case"failing":return"bg-red-500";case"blackhole":return"bg-red-900"}},_=m=>{switch(m){case"optimal":return"success";case"suboptimal":return"warning";case"degraded":return"warning";case"failing":return"error";case"blackhole":return"error"}},b=m=>{switch(m){case"healthy":return"text-emerald-400";case"warning":return"text-yellow-400";case"critical":return"text-red-400";case"unknown":return"text-slate-400"}};return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Route Intelligence"}),e.jsx("p",{className:"text-slate-400",children:"AI-powered routing analysis and optimization recommendations"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-6",children:[e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[a.averageLatency.toFixed(1),"ms"]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Avg Latency"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-emerald-400 mb-1",children:[a.routeAvailability.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Availability"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-cyan-400 mb-1",children:[a.optimalRoutesPercentage.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Optimal Routes"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400 mb-1",children:a.optimizationOpportunities}),e.jsx("div",{className:"text-xs text-slate-400",children:"Opportunities"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-400 mb-1",children:["$",(a.estimatedMonthlySavings/1e3).toFixed(1),"K"]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Est. Savings/mo"})]})})]}),e.jsxs(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Routing Table Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 lg:grid-cols-10 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:s.totalRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Total Routes"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-400 mb-1",children:s.optimalRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Optimal"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400 mb-1",children:s.suboptimalRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Suboptimal"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:s.degradedRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Degraded"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-400 mb-1",children:s.failingRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Failing"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:s.bgpRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"BGP"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:s.ospfRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"OSPF"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400 mb-1",children:s.staticRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Static"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:s.dynamicRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Dynamic"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-400 mb-1",children:s.connectedRoutes}),e.jsx("div",{className:"text-xs text-slate-400",children:"Connected"})]})]})]}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Top Optimization Opportunities"}),e.jsx("div",{className:"space-y-3",children:r.slice(0,5).map(m=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(F,{variant:m.priority==="critical"?"error":m.priority==="high"?"warning":"info",children:m.priority.toUpperCase()}),e.jsx("span",{className:"font-mono text-xs text-slate-400",children:m.id})]}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:m.title}),e.jsx("p",{className:"text-sm text-slate-300 mb-2",children:m.description})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Savings: "}),e.jsxs("span",{className:m.potentialSavings>=0?"text-green-400":"text-red-400",children:[m.potentialSavings>=0?"+":"",m.potentialSavings>=0?"$":"-$",Math.abs(m.potentialSavings).toLocaleString(),"/mo"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Performance: "}),e.jsxs("span",{className:"text-cyan-400 font-semibold",children:["+",m.performanceGain,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Effort: "}),e.jsx("span",{className:"text-white",children:m.implementationEffort.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"ROI: "}),e.jsxs("span",{className:"text-emerald-400 font-semibold",children:[m.estimatedROI,"%"]})]})]})]},m.id))})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Recent Anomalies Detected"}),e.jsx("div",{className:"space-y-3",children:n.slice(0,3).map(m=>e.jsxs("div",{className:`bg-slate-900/50 rounded-lg p-3 border ${m.severity==="critical"?"border-red-500/50":m.severity==="high"?"border-orange-500/50":"border-slate-700"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:m.severity==="critical"?"error":m.severity==="high"?"warning":"info",children:m.severity.toUpperCase()}),e.jsx("span",{className:"text-xs text-slate-400",children:new Date(m.detectedAt).toLocaleString()})]}),e.jsx(F,{variant:"default",className:"text-xs",children:m.type.replace("_"," ").toUpperCase()})]}),e.jsx("p",{className:"text-sm text-slate-200 mb-2",children:m.description}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"text-slate-400",children:["Impact: ",e.jsx("span",{className:"text-orange-300",children:m.impact})]}),m.rootCause&&e.jsxs("div",{className:"text-slate-400",children:["Root Cause: ",e.jsx("span",{className:"text-slate-300",children:m.rootCause})]}),m.recommendation&&e.jsxs("div",{className:"text-slate-400",children:["Recommendation: ",e.jsx("span",{className:"text-cyan-300",children:m.recommendation})]})]})]},m.id))})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Status Filter"}),e.jsxs("select",{value:l,onChange:m=>c(m.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"optimal",children:"Optimal"}),e.jsx("option",{value:"suboptimal",children:"Suboptimal"}),e.jsx("option",{value:"degraded",children:"Degraded"}),e.jsx("option",{value:"failing",children:"Failing"}),e.jsx("option",{value:"blackhole",children:"Blackhole"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Health Filter"}),e.jsxs("select",{value:d,onChange:m=>h(m.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Health"}),e.jsx("option",{value:"healthy",children:"Healthy"}),e.jsx("option",{value:"warning",children:"Warning"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"unknown",children:"Unknown"})]})]}),e.jsx("div",{className:"ml-auto",children:e.jsxs("div",{className:"text-sm text-slate-400",children:["Showing ",u.length," of ",t.length," routes"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Network Routes"}),u.map(m=>e.jsx(y,{className:`bg-slate-800/50 border-slate-700 cursor-pointer transition-all hover:border-cyan-500 ${(i==null?void 0:i.id)===m.id?"border-cyan-500 ring-2 ring-cyan-500/50":""}`,onClick:()=>o(m),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${x(m.status)} animate-pulse`}),e.jsx("span",{className:"text-xs font-mono text-slate-400",children:m.id})]}),e.jsx(F,{variant:_(m.status),children:m.status.toUpperCase()})]}),e.jsx("h3",{className:"text-white font-semibold text-sm leading-tight",children:m.name}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Protocol:"}),e.jsx(F,{variant:"info",className:"text-xs",children:m.protocol})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Health:"}),e.jsx("span",{className:`font-semibold ${b(m.health)}`,children:m.health.toUpperCase()})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Latency:"}),e.jsxs("span",{className:`font-semibold ${m.metrics.latencyMs>50?"text-orange-400":"text-emerald-400"}`,children:[m.metrics.latencyMs.toFixed(1),"ms"]})]})]}),m.aiRecommendations.length>0&&e.jsx("div",{className:"pt-2 border-t border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx("span",{className:"text-cyan-400",children:""}),e.jsxs("span",{className:"text-cyan-400",children:[m.aiRecommendations.length," AI Recommendations"]})]})})]})},m.id))]}),e.jsx("div",{className:"lg:col-span-2",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{className:`border-2 ${i.status==="optimal"?"border-emerald-500/50 bg-emerald-600/10":i.status==="degraded"||i.status==="failing"?"border-red-500/50 bg-red-600/10":"border-yellow-500/50 bg-yellow-600/10"}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(F,{variant:_(i.status),children:i.status.toUpperCase()}),e.jsx("span",{className:"font-mono text-sm text-slate-400",children:i.id}),e.jsx(F,{variant:"info",children:i.protocol}),e.jsx("span",{className:`text-sm font-semibold ${b(i.health)}`,children:i.health.toUpperCase()})]}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:i.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"text-slate-300",children:[e.jsx("span",{className:"text-slate-400",children:"Source:"})," ",i.source]}),e.jsxs("div",{className:"text-slate-300",children:[e.jsx("span",{className:"text-slate-400",children:"Destination:"})," ",i.destination]}),e.jsxs("div",{className:"text-slate-300",children:[e.jsx("span",{className:"text-slate-400",children:"Next Hop:"})," ",i.nextHop]}),e.jsxs("div",{className:"text-slate-300",children:[e.jsx("span",{className:"text-slate-400",children:"Age:"})," ",i.age]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-slate-700",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Latency"}),e.jsxs("div",{className:`text-xl font-bold ${i.metrics.latencyMs>50?"text-orange-400":"text-emerald-400"}`,children:[i.metrics.latencyMs.toFixed(1),"ms"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Packet Loss"}),e.jsxs("div",{className:`text-xl font-bold ${i.metrics.packetLoss>.1?"text-red-400":"text-emerald-400"}`,children:[i.metrics.packetLoss.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Utilization"}),e.jsxs("div",{className:`text-xl font-bold ${i.metrics.utilization>80?"text-orange-400":"text-cyan-400"}`,children:[i.metrics.utilization.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Throughput"}),e.jsx("div",{className:"text-xl font-bold text-white",children:i.metrics.throughput})]})]})]})}),i.aiRecommendations.length>0&&e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" AI Recommendations"}),i.aiRecommendations.map(m=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-cyan-500/30",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(F,{variant:m.priority==="critical"?"error":m.priority==="high"?"warning":"info",children:m.priority.toUpperCase()}),e.jsxs("span",{className:"text-xs text-slate-400",children:["Confidence: ",m.confidenceScore,"%"]}),m.automationAvailable&&e.jsx(F,{variant:"success",className:"text-xs",children:"AUTO"})]}),e.jsx("h4",{className:"text-white font-bold mb-1",children:m.title}),e.jsx("p",{className:"text-sm text-slate-300 mb-3",children:m.description})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Performance:"}),e.jsxs("span",{className:"text-emerald-400 font-semibold ml-2",children:["+",m.estimatedImpact.performance,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Cost:"}),e.jsxs("span",{className:`font-semibold ml-2 ${m.estimatedImpact.cost>=0?"text-green-400":"text-red-400"}`,children:[m.estimatedImpact.cost>=0?"+$":"-$",Math.abs(m.estimatedImpact.cost),"/mo"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Reliability:"}),e.jsxs("span",{className:"text-cyan-400 font-semibold ml-2",children:["+",m.estimatedImpact.reliability,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-300 mb-1",children:"Rationale:"}),e.jsx("ul",{className:"space-y-1",children:m.rationale.map((T,p)=>e.jsxs("li",{className:"text-xs text-slate-300 flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),e.jsx("span",{children:T})]},p))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-300 mb-1",children:"Implementation Steps:"}),e.jsx("ol",{className:"space-y-1",children:m.implementationSteps.map((T,p)=>e.jsxs("li",{className:"text-xs text-slate-300 flex items-start gap-2",children:[e.jsxs("span",{className:"text-cyan-400 mt-0.5",children:[p+1,"."]}),e.jsx("span",{children:T})]},p))})]})]})]},m.id))]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white",children:[" Route Path (",i.path.length," hops)"]}),e.jsx("div",{className:"space-y-2",children:i.path.map((m,T)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:m.sequence}),e.jsxs("div",{className:"flex-grow bg-slate-900/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-semibold text-sm",children:m.hostname}),e.jsxs("span",{className:"text-slate-400 text-xs ml-2",children:["(",m.ipAddress,")"]})]}),e.jsxs("span",{className:"text-cyan-400 font-semibold text-sm",children:[m.latencyMs.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-400",children:[e.jsxs("span",{children:[" ",m.location]}),m.asn&&e.jsxs("span",{children:["AS",m.asn]}),m.provider&&e.jsxs("span",{children:[" ",m.provider]})]})]})]},T))})]})}),i.alternatives.length>0&&e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Alternative Paths Available"}),i.alternatives.map(m=>e.jsxs("div",{className:"bg-emerald-900/20 rounded-lg p-4 border border-emerald-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-white font-semibold",children:["Alternative Path (",m.path.length," hops)"]}),e.jsxs(F,{variant:"success",className:"text-sm",children:["Score: ",m.recommendationScore,"/100"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Latency Reduction:"}),e.jsxs("span",{className:"text-emerald-400 font-semibold ml-2",children:[m.estimatedImprovement.latencyReduction,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Cost Savings:"}),e.jsxs("span",{className:"text-green-400 font-semibold ml-2",children:["$",m.estimatedImprovement.costSavings,"/mo"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Reliability:"}),e.jsxs("span",{className:"text-cyan-400 font-semibold ml-2",children:["+",m.estimatedImprovement.reliabilityIncrease,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:["Complexity: ",e.jsx("span",{className:"text-white",children:m.implementationComplexity.toUpperCase()})]}),e.jsxs("span",{className:"text-slate-400",children:["Risk: ",e.jsx("span",{className:m.riskLevel==="low"?"text-green-400":m.riskLevel==="medium"?"text-yellow-400":"text-red-400",children:m.riskLevel.toUpperCase()})]})]})]},m.id))]})}),i.anomalies.length>0&&e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Detected Anomalies"}),i.anomalies.map(m=>e.jsxs("div",{className:"bg-red-900/20 rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(F,{variant:"error",children:m.severity.toUpperCase()}),e.jsx("span",{className:"text-xs text-slate-400",children:new Date(m.detectedAt).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-slate-200 mb-2",children:m.description}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"text-slate-400",children:["Impact: ",e.jsx("span",{className:"text-orange-300",children:m.impact})]}),m.rootCause&&e.jsxs("div",{className:"text-slate-400",children:["Root Cause: ",e.jsx("span",{className:"text-slate-300",children:m.rootCause})]}),m.recommendation&&e.jsxs("div",{className:"text-slate-400",children:["Recommendation: ",e.jsx("span",{className:"text-cyan-300",children:m.recommendation})]})]})]},m.id))]})})]}):e.jsx(y,{className:"bg-slate-800/50 border-slate-700 h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Select a Route"}),e.jsx("p",{className:"text-slate-400",children:"Click on a route from the list to view AI-powered analysis and recommendations"})]})})})]})]})},B0=()=>{const[t,s]=v.useState([]),[a,r]=v.useState(null),[n,i]=v.useState(!0),[o,l]=v.useState(!1),[c,d]=v.useState(null),[h,u]=v.useState({}),[x,_]=v.useState(null),[b,m]=v.useState(!1),T=v.useCallback(async I=>{try{i(!0),d(null);const E=I??h,W=await Bt.getTickets(E);s(W)}catch(E){d(E instanceof Error?E.message:"Failed to load tickets")}finally{i(!1)}},[h]);v.useEffect(()=>{T()},[]);const p={awaiting:t.filter(I=>I.status==="awaiting"),approved:t.filter(I=>I.status==="approved"),implementing:t.filter(I=>I.status==="implementing"),completed:t.filter(I=>I.status==="completed"),rejected:t.filter(I=>I.status==="rejected")},g=v.useCallback(async I=>{if(!I){r(null);return}try{const E=await Bt.getTicketById(I);r(E)}catch(E){d(E instanceof Error?E.message:"Failed to load ticket details")}},[]),f=v.useCallback(async I=>{l(!0),d(null);try{const E=await Bt.createTicket(I);return s(W=>[E,...W]),E}catch(E){const W=E instanceof Error?E.message:"Failed to create ticket";throw d(W),new Error(W)}finally{l(!1)}},[]),j=v.useCallback(async(I,E)=>{try{const W=await Bt.updateTicketStatus(I,E);W&&(s(Z=>Z.map(P=>P.id===I?W:P)),(a==null?void 0:a.id)===I&&r(W))}catch(W){d(W instanceof Error?W.message:"Failed to update ticket status")}},[a]),N=v.useCallback(async(I,E,W)=>{try{const Z=await Bt.approveTicketStep(I,E,W);Z&&(s(P=>P.map(w=>w.id===I?Z:w)),(a==null?void 0:a.id)===I&&r(Z))}catch(Z){d(Z instanceof Error?Z.message:"Failed to approve ticket step")}},[a]),S=v.useCallback(async(I,E,W)=>{try{const Z=await Bt.rejectTicketStep(I,E,W);Z&&(s(P=>P.map(w=>w.id===I?Z:w)),(a==null?void 0:a.id)===I&&r(Z))}catch(Z){d(Z instanceof Error?Z.message:"Failed to reject ticket step")}},[a]),A=v.useCallback(async I=>{m(!0);try{const E=await Bt.calculateRisk(I);_(E)}catch(E){d(E instanceof Error?E.message:"Failed to calculate risk")}finally{m(!1)}},[]),k=v.useCallback(()=>{d(null)},[]);return{tickets:t,ticketsByStatus:p,selectedTicket:a,isLoading:n,isSubmitting:o,error:c,filter:h,riskAssessment:x,isCalculatingRisk:b,loadTickets:T,selectTicket:g,createTicket:f,updateStatus:j,approveStep:N,rejectStep:S,setFilter:I=>{u(I),T(I)},calculateRisk:A,clearError:k}},_c={title:"",description:"",priority:"medium",category:"firewall_rule",changeType:"add",sourceIp:"",destinationIp:"",port:"",protocol:"tcp",action:"allow",platform:"aws",justification:"",scheduledAt:"",rollbackPlan:""},R1=[{value:"firewall_rule",label:"Firewall Rule"},{value:"security_group",label:"Security Group"},{value:"network_acl",label:"Network ACL"},{value:"routing",label:"Routing"},{value:"load_balancer",label:"Load Balancer"},{value:"vpn",label:"VPN"},{value:"dns",label:"DNS"},{value:"other",label:"Other"}],E1=[{value:"low",label:"Low",color:"bg-slate-500"},{value:"medium",label:"Medium",color:"bg-amber-500"},{value:"high",label:"High",color:"bg-orange-500"},{value:"critical",label:"Critical",color:"bg-red-500"}],L1=[{value:"add",label:"Add Rule",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})},{value:"modify",label:"Modify Rule",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{value:"delete",label:"Delete Rule",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}],O1=({assessment:t,isLoading:s})=>{if(s)return e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-6 w-6 text-cyan-500",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-2 text-slate-400",children:"Calculating risk..."})]});if(!t)return e.jsx("div",{className:"text-center py-8 text-slate-500",children:"Fill in the rule details to see risk assessment"});const a={low:"text-emerald-400 bg-emerald-500/20",medium:"text-amber-400 bg-amber-500/20",high:"text-orange-400 bg-orange-500/20",critical:"text-red-400 bg-red-500/20"},r={low:"bg-emerald-500",medium:"bg-amber-500",high:"bg-orange-500",critical:"bg-red-500"};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Risk Score"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl font-bold text-white",children:t.score}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a[t.level]}`,children:t.level.toUpperCase()})]})]})}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${r[t.level]} transition-all duration-500`,style:{width:`${t.score}%`}})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Risk Factors"}),t.factors.map((n,i)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n.impact==="negative"?e.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):e.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-slate-300",children:n.name})]}),e.jsxs("span",{className:n.weight>0?"text-red-400":"text-emerald-400",children:[n.weight>0?"+":"",n.weight]})]},i))]}),e.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Recommendation"}),e.jsx("p",{className:"text-white",children:t.recommendation})]})]})},D1=()=>{const{createTicket:t,isSubmitting:s,riskAssessment:a,isCalculatingRisk:r,calculateRisk:n,error:i,clearError:o}=B0(),[l,c]=v.useState(_c),[d,h]=v.useState(!1),[u,x]=v.useState(null);v.useEffect(()=>{const m=setTimeout(()=>{(l.sourceIp||l.destinationIp||l.port)&&n(l)},500);return()=>clearTimeout(m)},[l.sourceIp,l.destinationIp,l.port,l.action,l.changeType,l.priority,n]);const _=async m=>{m.preventDefault();try{const T=await t(l);x(T.serviceNowId),h(!0)}catch{}},b=()=>{c(_c),h(!1),x(null),o()};return d&&u?e.jsx(ee,{children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(y,{className:"text-center",children:e.jsxs("div",{className:"py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Change Request Submitted"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"Your request has been submitted to ServiceNow for review."}),e.jsxs("div",{className:"inline-block px-4 py-2 bg-slate-700 rounded-lg mb-6",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"ServiceNow Ticket ID"}),e.jsx("p",{className:"text-xl font-mono font-bold text-cyan-400",children:u})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx(D,{variant:"primary",onClick:b,children:"Create Another Request"}),e.jsx(D,{variant:"secondary",children:"View in ServiceNow"})]})]})})})}):e.jsx(ee,{children:e.jsx("form",{onSubmit:_,children:e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-2 space-y-6",children:[i&&e.jsxs("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-red-400",children:i}),e.jsx("button",{type:"button",onClick:o,className:"text-red-400 hover:text-red-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Request Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Request Title *"}),e.jsx("input",{type:"text",required:!0,value:l.title,onChange:m=>c({...l,title:m.target.value}),placeholder:"e.g., Allow HTTPS traffic from DMZ to Production",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Description *"}),e.jsx("textarea",{required:!0,rows:3,value:l.description,onChange:m=>c({...l,description:m.target.value}),placeholder:"Describe the change and business justification...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Category *"}),e.jsx("select",{value:l.category,onChange:m=>c({...l,category:m.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:R1.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Target Platform *"}),e.jsxs("select",{value:l.platform,onChange:m=>c({...l,platform:m.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"aws",children:"AWS"}),e.jsx("option",{value:"azure",children:"Azure"}),e.jsx("option",{value:"gcp",children:"GCP"}),e.jsx("option",{value:"onprem",children:"On-Premises"})]})]})]})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Change Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:L1.map(m=>e.jsxs("button",{type:"button",onClick:()=>c({...l,changeType:m.value}),className:`p-4 rounded-lg border-2 transition-all flex flex-col items-center gap-2 ${l.changeType===m.value?"border-cyan-500 bg-cyan-500/10 text-cyan-400":"border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600"}`,children:[m.icon,e.jsx("span",{className:"font-medium",children:m.label})]},m.value))})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Rule Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Source IP/CIDR *"}),e.jsx("input",{type:"text",required:!0,value:l.sourceIp,onChange:m=>c({...l,sourceIp:m.target.value}),placeholder:"e.g., 10.0.1.0/24",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Destination IP/CIDR *"}),e.jsx("input",{type:"text",required:!0,value:l.destinationIp,onChange:m=>c({...l,destinationIp:m.target.value}),placeholder:"e.g., 10.0.2.0/24",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Port *"}),e.jsx("input",{type:"text",required:!0,value:l.port,onChange:m=>c({...l,port:m.target.value}),placeholder:"e.g., 443",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Protocol *"}),e.jsxs("select",{value:l.protocol,onChange:m=>c({...l,protocol:m.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"}),e.jsx("option",{value:"icmp",children:"ICMP"}),e.jsx("option",{value:"any",children:"Any"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Action *"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>c({...l,action:"allow"}),className:`px-4 py-2 rounded-lg font-medium transition-all ${l.action==="allow"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:"Allow"}),e.jsx("button",{type:"button",onClick:()=>c({...l,action:"deny"}),className:`px-4 py-2 rounded-lg font-medium transition-all ${l.action==="deny"?"bg-red-500 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:"Deny"})]})]})]})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Implementation Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Business Justification *"}),e.jsx("textarea",{required:!0,rows:2,value:l.justification,onChange:m=>c({...l,justification:m.target.value}),placeholder:"Why is this change necessary?",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Scheduled Date/Time"}),e.jsx("input",{type:"datetime-local",value:l.scheduledAt,onChange:m=>c({...l,scheduledAt:m.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Priority *"}),e.jsx("div",{className:"flex gap-2",children:E1.map(m=>e.jsx("button",{type:"button",onClick:()=>c({...l,priority:m.value}),className:`flex-1 px-3 py-2 rounded-lg font-medium text-sm transition-all ${l.priority===m.value?`${m.color} text-white`:"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:m.label},m.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Rollback Plan"}),e.jsx("textarea",{rows:2,value:l.rollbackPlan,onChange:m=>c({...l,rollbackPlan:m.target.value}),placeholder:"How will you revert this change if needed?",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(D,{type:"button",variant:"ghost",onClick:b,children:"Clear Form"}),e.jsx(D,{type:"submit",variant:"primary",isLoading:s,children:"Submit Change Request"})]})]}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"sticky top-6",children:e.jsxs(y,{children:[e.jsx(B,{title:"Risk Assessment"}),e.jsx(O1,{assessment:a,isLoading:r})]})})})]})})})},Qi={awaiting:{label:"Awaiting Approval",color:"bg-amber-500",bgColor:"bg-amber-50"},approved:{label:"Approved",color:"bg-blue-500",bgColor:"bg-blue-50"},implementing:{label:"Implementing",color:"bg-purple-500",bgColor:"bg-purple-50"},completed:{label:"Completed",color:"bg-green-500",bgColor:"bg-green-50"},rejected:{label:"Rejected",color:"bg-red-500",bgColor:"bg-red-50"}},Z0={low:{label:"Low",color:"text-slate-600",dotColor:"bg-slate-400"},medium:{label:"Medium",color:"text-blue-600",dotColor:"bg-blue-500"},high:{label:"High",color:"text-amber-600",dotColor:"bg-amber-500"},critical:{label:"Critical",color:"text-red-600",dotColor:"bg-red-500"}},q0={low:{color:"text-green-700",bgColor:"bg-green-100"},medium:{color:"text-amber-700",bgColor:"bg-amber-100"},high:{color:"text-orange-700",bgColor:"bg-orange-100"},critical:{color:"text-red-700",bgColor:"bg-red-100"}},K0={firewall_rule:"Firewall Rule",security_group:"Security Group",network_acl:"Network ACL",routing:"Routing",load_balancer:"Load Balancer",vpn:"VPN",dns:"DNS",other:"Other"},M1=()=>{const{ticketsByStatus:t,isLoading:s,error:a,selectedTicket:r,selectTicket:n,updateStatus:i,approveStep:o,rejectStep:l}=B0(),[c,d]=v.useState(!1),[h,u]=v.useState(""),[x,_]=v.useState(""),[b,m]=v.useState(null),T=async S=>{await n(S.id),d(!0),u(""),_(""),m(null)},p=()=>{d(!1),n(null)},g=async S=>{r&&(await o(r.id,S,h),u(""),m(null))},f=async S=>{r&&x.trim()&&(await l(r.id,S,x),_(""),m(null))},j=async(S,A)=>{await i(S,A)},N=["awaiting","approved","implementing","completed","rejected"];return s?e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),e.jsx("span",{className:"ml-3 text-slate-600",children:"Loading tickets..."})]})}):a?e.jsx(ee,{children:e.jsxs("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg",children:["Error loading tickets: ",a]})}):e.jsx(ee,{children:e.jsxs("div",{className:"flex gap-6 h-[calc(100vh-200px)]",children:[e.jsx("div",{className:`flex-1 grid grid-cols-5 gap-4 transition-all ${c?"w-2/3":"w-full"}`,children:N.map(S=>e.jsx(F1,{status:S,config:Qi[S],tickets:t[S],onTicketClick:T,onStatusChange:j,selectedTicketId:r==null?void 0:r.id},S))}),c&&r&&e.jsx(V1,{ticket:r,onClose:p,approvalComment:h,setApprovalComment:u,rejectComment:x,setRejectComment:_,activeApprovalStep:b,setActiveApprovalStep:m,onApprove:g,onReject:f})]})})},F1=({config:t,tickets:s,onTicketClick:a,selectedTicketId:r})=>e.jsxs("div",{className:`${t.bgColor} rounded-xl overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:`${t.color} px-4 py-3 text-white font-semibold flex items-center justify-between`,children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-sm",children:s.length})]}),e.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-3",children:s.length===0?e.jsx("div",{className:"text-center text-slate-400 py-8 text-sm",children:"No tickets"}):s.map(n=>e.jsx(G1,{ticket:n,onClick:()=>a(n),isSelected:n.id===r},n.id))})]}),G1=({ticket:t,onClick:s,isSelected:a})=>{const r=Z0[t.priority],n=q0[t.riskAssessment.level],i=t.approvalSteps.filter(l=>l.status==="pending").length,o=t.approvalSteps.length;return e.jsxs("div",{onClick:s,className:`bg-white rounded-lg p-3 shadow-sm cursor-pointer transition-all hover:shadow-md ${a?"ring-2 ring-cyan-500 shadow-md":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-mono text-slate-500",children:t.serviceNowId}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${r.dotColor}`}),e.jsx("span",{className:`text-xs ${r.color}`,children:r.label})]})]}),e.jsx("h4",{className:"font-medium text-slate-800 text-sm mb-2 line-clamp-2",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded",children:K0[t.category]||t.category}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.changeType==="add"?"bg-green-100 text-green-700":t.changeType==="delete"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:t.changeType.charAt(0).toUpperCase()+t.changeType.slice(1)})]}),e.jsxs("div",{className:`text-xs px-2 py-1 rounded ${n.bgColor} ${n.color} mb-2 inline-block`,children:["Risk: ",t.riskAssessment.level.charAt(0).toUpperCase()+t.riskAssessment.level.slice(1)," (",t.riskAssessment.score,"/100)"]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 pt-2 border-t border-slate-100",children:[e.jsx("span",{children:t.assignee}),o>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),o-i,"/",o]})]})]})},V1=({ticket:t,onClose:s,approvalComment:a,setApprovalComment:r,rejectComment:n,setRejectComment:i,activeApprovalStep:o,setActiveApprovalStep:l,onApprove:c,onReject:d})=>{const h=Z0[t.priority],u=q0[t.riskAssessment.level];return e.jsxs("div",{className:"w-1/3 min-w-[400px] bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-slate-800 text-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-mono text-sm text-slate-300",children:t.serviceNowId}),e.jsx("button",{onClick:s,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:`${Qi[t.status].color} text-white text-xs px-2 py-1 rounded`,children:Qi[t.status].label}),e.jsxs("span",{className:`flex items-center gap-1 text-xs ${h.color}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${h.dotColor}`}),h.label," Priority"]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("section",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-600",children:t.description})]}),e.jsxs("section",{className:"grid grid-cols-2 gap-3",children:[e.jsx(gs,{label:"Category",value:K0[t.category]||t.category}),e.jsx(gs,{label:"Change Type",value:t.changeType.charAt(0).toUpperCase()+t.changeType.slice(1)}),e.jsx(gs,{label:"Requester",value:t.requester}),e.jsx(gs,{label:"Assignee",value:t.assignee}),e.jsx(gs,{label:"Created",value:new Date(t.createdAt).toLocaleDateString()}),t.scheduledAt&&e.jsx(gs,{label:"Scheduled",value:new Date(t.scheduledAt).toLocaleDateString()})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Risk Assessment"}),e.jsxs("div",{className:`${u.bgColor} ${u.color} rounded-lg p-3`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold",children:[t.riskAssessment.level.charAt(0).toUpperCase()+t.riskAssessment.level.slice(1)," Risk"]}),e.jsxs("span",{className:"text-lg font-bold",children:[t.riskAssessment.score,"/100"]})]}),e.jsx("p",{className:"text-sm",children:t.riskAssessment.recommendation}),t.riskAssessment.factors.length>0&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-current/20",children:[e.jsx("p",{className:"text-xs font-medium mb-1",children:"Risk Factors:"}),e.jsx("ul",{className:"text-xs space-y-1",children:t.riskAssessment.factors.slice(0,3).map((x,_)=>e.jsxs("li",{className:"flex items-start gap-1",children:[e.jsx("span",{children:x.impact==="negative"?"":x.impact==="positive"?"":""}),e.jsx("span",{children:x.description})]},_))})]})]})]}),t.affectedResources.length>0&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Affected Resources"}),e.jsx("div",{className:"space-y-2",children:t.affectedResources.map(x=>e.jsxs("div",{className:"bg-slate-50 rounded p-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:x.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${x.platform==="aws"?"bg-orange-100 text-orange-700":x.platform==="azure"?"bg-blue-100 text-blue-700":x.platform==="gcp"?"bg-red-100 text-red-700":"bg-slate-200 text-slate-700"}`,children:x.platform.toUpperCase()})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[x.type," ",x.region&&` ${x.region}`]})]},x.id))})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Approval Workflow"}),e.jsx("div",{className:"space-y-2",children:t.approvalSteps.map(x=>e.jsx(U1,{step:x,isActive:o===x.id,onToggle:()=>l(o===x.id?null:x.id),approvalComment:a,setApprovalComment:r,rejectComment:n,setRejectComment:i,onApprove:()=>c(x.id),onReject:()=>d(x.id)},x.id))})]}),t.rollbackPlan&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Rollback Plan"}),e.jsx("p",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3",children:t.rollbackPlan})]}),t.implementationNotes&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Implementation Notes"}),e.jsx("p",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3",children:t.implementationNotes})]})]})]})},gs=({label:t,value:s})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:t}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:s})]}),U1=({step:t,isActive:s,onToggle:a,approvalComment:r,setApprovalComment:n,rejectComment:i,setRejectComment:o,onApprove:l,onReject:c})=>{const h={pending:{icon:"",color:"text-amber-600",bg:"bg-amber-50"},approved:{icon:"",color:"text-green-600",bg:"bg-green-50"},rejected:{icon:"",color:"text-red-600",bg:"bg-red-50"}}[t.status];return e.jsxs("div",{className:`${h.bg} rounded-lg overflow-hidden`,children:[e.jsxs("div",{className:`p-3 flex items-center justify-between cursor-pointer ${t.status==="pending"?"hover:bg-amber-100":""}`,onClick:t.status==="pending"?a:void 0,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${h.bg} ${h.color}`,children:h.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:t.name}),e.jsx("p",{className:"text-xs text-slate-500",children:t.approver})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-xs font-medium ${h.color}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),t.timestamp&&e.jsx("p",{className:"text-xs text-slate-400",children:new Date(t.timestamp).toLocaleDateString()})]})]}),t.status==="pending"&&s&&e.jsxs("div",{className:"p-3 border-t border-amber-200 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Approval Comment (optional)"}),e.jsx("textarea",{value:r,onChange:u=>n(u.target.value),className:"w-full px-3 py-2 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-cyan-500 focus:border-transparent",rows:2,placeholder:"Add a comment..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:l,className:"flex-1 bg-green-500 text-white py-2 px-3 rounded text-sm font-medium hover:bg-green-600 transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>{i.trim()||o("")},className:"flex-1 bg-white text-slate-700 py-2 px-3 rounded text-sm font-medium border border-slate-300 hover:bg-slate-50 transition-colors",children:"Reject"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Rejection Reason (required to reject)"}),e.jsx("textarea",{value:i,onChange:u=>o(u.target.value),className:"w-full px-3 py-2 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-red-500 focus:border-transparent",rows:2,placeholder:"Explain why this is being rejected..."}),i.trim()&&e.jsx("button",{onClick:c,className:"mt-2 w-full bg-red-500 text-white py-2 px-3 rounded text-sm font-medium hover:bg-red-600 transition-colors",children:"Confirm Rejection"})]})]}),t.comments&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("p",{className:"text-xs text-slate-500 italic",children:['"',t.comments,'"']})})]})},H1={production:"bg-red-500/20 text-red-400 border-red-500/30",uat:"bg-amber-500/20 text-amber-400 border-amber-500/30",development:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"},W1=({parsedData:t})=>e.jsxs(y,{children:[e.jsx(B,{title:"AI Ticket Analysis",subtitle:"Automatically extracted from ServiceNow"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold border ${H1[t.environment]}`,children:[t.environment.toUpperCase()," Environment"]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Source IP/CIDR"}),e.jsx("p",{className:"text-white font-mono font-semibold",children:t.sourceIp})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Destination IP"}),e.jsx("p",{className:"text-white font-mono font-semibold",children:t.destinationIp})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Port"}),e.jsx("p",{className:"text-white font-mono font-semibold",children:t.port})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Protocol"}),e.jsx("p",{className:"text-white font-mono font-semibold uppercase",children:t.protocol})]})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Description"}),e.jsx("p",{className:"text-white text-sm",children:t.description})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Business Justification"}),e.jsx("p",{className:"text-white text-sm",children:t.businessJustification})]})]})]}),z1={aws:"",azure:"",gcp:"",onprem:""},$1={aws:"bg-orange-500/20 text-orange-400 border-orange-500/30",azure:"bg-blue-500/20 text-blue-400 border-blue-500/30",gcp:"bg-red-500/20 text-red-400 border-red-500/30",onprem:"bg-slate-500/20 text-slate-400 border-slate-500/30"},B1={firewall:"Firewall",nsg:"Network Security Group",security_group:"Security Group",nacl:"Network ACL"},Z1=({firewalls:t})=>e.jsxs(y,{children:[e.jsx(B,{title:"Firewalls in Traffic Path",subtitle:`${t.length} security control${t.length!==1?"s":""} identified`}),e.jsx("div",{className:"space-y-3",children:t.map((s,a)=>e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-cyan-500/20 rounded-full flex items-center justify-center border border-cyan-500/30",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-sm",children:a+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-white font-semibold",children:s.name}),e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium border ${$1[s.platform]}`,children:[z1[s.platform]," ",s.platform.toUpperCase()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Type:"})," ",e.jsx("span",{className:"text-white",children:B1[s.type]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Location:"})," ",e.jsx("span",{className:"text-white",children:s.location})]}),s.zone&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-400",children:"Zone:"})," ",e.jsx("span",{className:"text-white font-mono text-xs",children:s.zone})]}),s.managementUrl&&e.jsx("div",{className:"col-span-2",children:e.jsxs("a",{href:s.managementUrl,target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:text-cyan-300 text-xs flex items-center gap-1",children:["Open Management Console",e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})]}),a<t.length-1&&e.jsx("div",{className:"flex justify-center mt-3",children:e.jsx("svg",{className:"w-6 h-6 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})]},s.id))})]}),q1=({recommendations:t})=>{var n;const[s,a]=v.useState(((n=t[0])==null?void 0:n.firewallId)||null),r=i=>{navigator.clipboard.writeText(i)};return e.jsxs(y,{children:[e.jsx(B,{title:"Rule Recommendations",subtitle:"Platform-specific firewall rules generated by AI"}),e.jsx("div",{className:"space-y-3",children:t.map(i=>{const o=s===i.firewallId;return e.jsxs("div",{className:"border border-slate-600 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>a(o?null:i.firewallId),className:"w-full p-4 bg-slate-700/30 hover:bg-slate-700/50 transition-colors flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${i.platform==="aws"?"bg-orange-500/20":i.platform==="azure"?"bg-blue-500/20":i.platform==="gcp"?"bg-red-500/20":"bg-slate-500/20"}`,children:e.jsx("span",{className:"text-lg",children:i.platform==="aws"?"":i.platform==="azure"?"":i.platform==="gcp"?"":""})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:"text-white font-semibold",children:i.firewallName}),e.jsx("p",{className:"text-sm text-slate-400",children:i.ruleType.replace(/_/g," ")})]})]}),e.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&e.jsxs("div",{className:"p-4 bg-slate-800/50 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[e.jsx("span",{className:"text-slate-400",children:"Action:"})," ",e.jsx("span",{className:`font-semibold ${i.rule.action==="allow"?"text-emerald-400":"text-red-400"}`,children:i.rule.action.toUpperCase()})]}),e.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[e.jsx("span",{className:"text-slate-400",children:"Protocol:"})," ",e.jsx("span",{className:"text-white font-mono",children:i.rule.protocol.toUpperCase()})]}),e.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[e.jsx("span",{className:"text-slate-400",children:"Source:"})," ",e.jsx("span",{className:"text-white font-mono text-xs",children:i.rule.source})]}),e.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[e.jsx("span",{className:"text-slate-400",children:"Port:"})," ",e.jsx("span",{className:"text-white font-mono",children:i.rule.port})]}),e.jsxs("div",{className:"col-span-2 p-2 bg-slate-700/30 rounded",children:[e.jsx("span",{className:"text-slate-400",children:"Destination:"})," ",e.jsx("span",{className:"text-white font-mono text-xs",children:i.rule.destination})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Platform-Specific Syntax"}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>r(i.syntax),children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})]}),e.jsx("pre",{className:"p-3 bg-slate-900 rounded-lg border border-slate-700 overflow-x-auto",children:e.jsx("code",{className:"text-cyan-400 text-xs font-mono",children:i.syntax})})]})]})]},i.firewallId)})})]})},Q0={low:"bg-slate-500/20 text-slate-400 border-slate-500/30",medium:"bg-amber-500/20 text-amber-400 border-amber-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",critical:"bg-red-500/20 text-red-400 border-red-500/30"},K1={shadowing:"Rule Shadowing",overlap:"Rule Overlap",contradiction:"Rule Contradiction",redundancy:"Rule Redundancy"},Q1={broad_rule:"Broad Rule Scope",high_risk_port:"High Risk Port",cross_environment:"Cross-Environment Access",compliance:"Compliance Concern"},Y1=({conflict:t})=>e.jsx("div",{className:`p-4 rounded-lg border ${Q0[t.severity]}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold",children:K1[t.type]}),e.jsx("span",{className:"text-xs uppercase font-bold",children:t.severity})]}),e.jsx("p",{className:"text-sm mb-3",children:t.message}),e.jsxs("div",{className:"p-3 bg-slate-900/50 rounded border border-slate-700",children:[e.jsx("p",{className:"text-xs uppercase font-semibold mb-2 opacity-70",children:"Existing Rule"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Source:"})," ",t.existingRule.source]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Destination:"})," ",t.existingRule.destination]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Port:"})," ",t.existingRule.port]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Action:"})," ",t.existingRule.action]})]})]}),e.jsxs("div",{className:"mt-3 p-2 bg-slate-900/30 rounded text-sm",children:[e.jsx("span",{className:"opacity-70",children:" Recommendation:"})," ",t.recommendation]})]})]})}),X1=({warning:t})=>e.jsx("div",{className:`p-3 rounded-lg border ${Q0[t.severity]}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h5",{className:"font-medium text-sm",children:Q1[t.type]}),e.jsx("span",{className:"text-xs uppercase font-bold",children:t.severity})]}),e.jsx("p",{className:"text-sm",children:t.message})]})]})}),J1=({conflictCheck:t})=>{const s=t.hasConflicts||t.warnings.length>0;return e.jsxs(y,{children:[e.jsx(B,{title:"Conflict & Security Analysis",subtitle:"Automated conflict detection and risk assessment"}),s?e.jsxs("div",{className:"space-y-4",children:[t.conflicts.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Rule Conflicts (",t.conflicts.length,")"]}),e.jsx("div",{className:"space-y-3",children:t.conflicts.map(a=>e.jsx(Y1,{conflict:a},a.id))})]}),t.warnings.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Security Warnings (",t.warnings.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.warnings.map(a=>e.jsx(X1,{warning:a},a.id))})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:"No Conflicts Detected"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"No rule conflicts or major security concerns found"})]})]})},ef={low:{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30",gauge:"bg-emerald-500"},medium:{bg:"bg-amber-500/20",text:"text-amber-400",border:"border-amber-500/30",gauge:"bg-amber-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/30",gauge:"bg-orange-500"},critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500/30",gauge:"bg-red-500"}},tf=({assessment:t})=>{const s=ef[t.level];return e.jsxs(y,{children:[e.jsx(B,{title:"Risk Assessment",subtitle:"AI-calculated risk score based on multiple factors"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"inline-flex flex-col items-center",children:[e.jsx("div",{className:`w-32 h-32 rounded-full ${s.bg} border-4 ${s.border} flex items-center justify-center mb-3`,children:e.jsxs("div",{children:[e.jsx("div",{className:`text-4xl font-bold ${s.text}`,children:t.score}),e.jsx("div",{className:"text-xs text-slate-400",children:"/ 100"})]})}),e.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-bold uppercase ${s.bg} ${s.text} border ${s.border}`,children:[t.level," Risk"]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-2",children:[e.jsx("span",{children:"Low"}),e.jsx("span",{children:"Medium"}),e.jsx("span",{children:"High"}),e.jsx("span",{children:"Critical"})]}),e.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${s.gauge} transition-all duration-1000 ease-out`,style:{width:`${t.score}%`}})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Risk Factors"]}),e.jsx("div",{className:"space-y-2",children:t.factors.map((a,r)=>{const n=a.impact==="negative",i=a.impact==="positive";return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n&&e.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),i&&e.jsx("svg",{className:"w-5 h-5 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.impact==="neutral"&&e.jsx("svg",{className:"w-5 h-5 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium capitalize",children:a.name}),e.jsx("p",{className:"text-xs text-slate-400",children:a.description})]})]}),e.jsxs("span",{className:`text-lg font-bold min-w-[3rem] text-right ${a.weight>0?"text-red-400":a.weight<0?"text-emerald-400":"text-slate-400"}`,children:[a.weight>0?"+":"",a.weight]})]},r)})})]}),e.jsx("div",{className:`p-4 rounded-lg border ${s.bg} ${s.border}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:`w-6 h-6 ${s.text} flex-shrink-0 mt-0.5`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsxs("div",{children:[e.jsx("h5",{className:`font-semibold ${s.text} mb-1`,children:"Recommendation"}),e.jsx("p",{className:"text-white text-sm",children:t.recommendation})]})]})})]})]})},sf=({status:t})=>t==="approved"?e.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-full flex items-center justify-center border-2 border-emerald-500",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):t==="rejected"?e.jsx("div",{className:"w-10 h-10 bg-red-500/20 rounded-full flex items-center justify-center border-2 border-red-500",children:e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-full flex items-center justify-center border-2 border-slate-600",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),af=({ticket:t,onApprove:s,onReject:a,onImplement:r,onRollback:n})=>{const[i,o]=v.useState(!1),[l,c]=v.useState(null),d=t.approvalChain.every(g=>g.status==="approved"),h=t.approvalChain.some(g=>g.status==="rejected"),u=d&&(t.status==="approved"||t.status==="pending_approval"),x=t.status==="analyzed"||t.status==="pending_approval",_=t.status==="implementing",m=(t.status==="completed"||t.status==="rolled_back")&&t.rollbackAvailable,T=g=>{c(g),o(!0)},p=()=>{l==="approve"&&s&&s(),l==="reject"&&a&&a(),l==="implement"&&r&&r(),l==="rollback"&&n&&n(),o(!1),c(null)};return e.jsxs(y,{children:[e.jsx(B,{title:"Approval Workflow",subtitle:t.mode==="automatic"?"Automatic Implementation Mode":"Manual Implementation Mode"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:t.mode==="automatic"?e.jsxs("span",{className:"px-3 py-1 bg-cyan-500/20 text-cyan-400 border border-cyan-500/30 rounded-full text-sm font-semibold flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Auto-Implement"]}):e.jsx("span",{className:"px-3 py-1 bg-slate-500/20 text-slate-400 border border-slate-500/30 rounded-full text-sm font-semibold",children:"Manual Mode"})}),e.jsx("div",{className:"space-y-3",children:t.approvalChain.map((g,f)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(sf,{status:g.status}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-white font-semibold",children:g.name}),e.jsx("span",{className:`text-xs uppercase font-bold ${g.status==="approved"?"text-emerald-400":g.status==="rejected"?"text-red-400":"text-slate-400"}`,children:g.status==="pending"?"Pending":g.status})]}),e.jsx("p",{className:"text-sm text-slate-400",children:g.approver}),g.timestamp&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:new Date(g.timestamp).toLocaleString()}),g.comments&&e.jsxs("div",{className:"mt-2 p-2 bg-slate-700/30 rounded text-sm text-slate-300",children:[" ",g.comments]})]})]}),f<t.approvalChain.length-1&&e.jsx("div",{className:"ml-5 h-6 border-l-2 border-slate-700"})]},g.id))}),_&&t.implementationStatus&&e.jsxs("div",{className:"p-4 bg-cyan-500/10 border border-cyan-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("svg",{className:"w-5 h-5 text-cyan-400 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-cyan-400 font-semibold",children:t.implementationStatus.step}),e.jsx("p",{className:"text-sm text-cyan-300/70",children:t.implementationStatus.message})]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 transition-all duration-500",style:{width:`${t.implementationStatus.progress}%`}})})]}),!i&&e.jsxs("div",{className:"flex gap-3",children:[x&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(D,{variant:"primary",className:"flex-1",onClick:()=>T("approve"),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve"]}),e.jsx(D,{variant:"ghost",onClick:()=>T("reject"),children:"Reject"})]}),u&&t.mode==="automatic"&&e.jsxs(D,{variant:"primary",className:"flex-1",onClick:()=>T("implement"),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Auto-Implement Rules"]}),m&&e.jsxs(D,{variant:"ghost",className:"border-red-500/30 text-red-400 hover:bg-red-500/10",onClick:()=>T("rollback"),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Rollback Changes"]})]}),i&&e.jsxs("div",{className:"p-4 bg-slate-700 border border-slate-600 rounded-lg space-y-3",children:[e.jsxs("p",{className:"text-white font-semibold",children:[l==="approve"&&"Confirm Approval",l==="reject"&&"Confirm Rejection",l==="implement"&&"Confirm Auto-Implementation",l==="rollback"&&"Confirm Rollback"]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[l==="approve"&&"This will approve the change request and move it to the next approval stage.",l==="reject"&&"This will reject the change request. The ticket will be closed.",l==="implement"&&"This will automatically implement all firewall rules. The process cannot be stopped once started.",l==="rollback"&&"This will remove all implemented rules in reverse order. This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"primary",onClick:p,className:"flex-1",children:"Confirm"}),e.jsx(D,{variant:"ghost",onClick:()=>{o(!1),c(null)},children:"Cancel"})]})]}),t.rollbackPlan&&!_&&e.jsx("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-slate-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-300 mb-1",children:"Rollback Plan"}),e.jsx("p",{className:"text-sm text-slate-400",children:t.rollbackPlan})]})]})})]})]})},rf=async t=>(await new Promise(a=>setTimeout(a,1500)),{sourceIp:"10.100.5.0/24",destinationIp:"172.16.20.50",port:"443",protocol:"tcp",environment:"production",description:"Allow HTTPS traffic from application servers to database endpoint",businessJustification:"Required for new microservice deployment to access production database"}),nf=async(t,s,a)=>{await new Promise(n=>setTimeout(n,1e3));const r=[];return a==="production"?r.push({id:"fw-prod-edge-01",name:"Production Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-prod-edge-01.company.com"},{id:"sg-0a1b2c3d4e5f",name:"App-Tier Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-12345678",managementUrl:"https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#SecurityGroups"},{id:"nsg-db-tier-prod",name:"Database NSG - Production",type:"nsg",platform:"azure",location:"eastus",zone:"vnet-prod-001",managementUrl:"https://portal.azure.com/#resource/subscriptions/.../networkSecurityGroups/nsg-db-tier-prod"}):a==="uat"?r.push({id:"fw-uat-edge-01",name:"UAT Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-uat-edge-01.company.com"},{id:"sg-uat-9z8y7x6w5v",name:"UAT Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-uat-001"}):r.push({id:"fw-dev-edge-01",name:"Development Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-WEST-1",managementUrl:"https://fw-dev-edge-01.company.com"}),r},of=async(t,s)=>(await new Promise(r=>setTimeout(r,800)),s.map(r=>{const n={source:t.sourceIp,destination:t.destinationIp,port:t.port,protocol:t.protocol,action:"allow"};let i="";switch(r.platform){case"aws":i=`{
  "IpProtocol": "${t.protocol}",
  "FromPort": ${t.port},
  "ToPort": ${t.port},
  "IpRanges": [{ "CidrIp": "${t.sourceIp}" }],
  "Description": "${t.description}"
}`;break;case"azure":i=`{
  "name": "Allow-${t.port}-Inbound",
  "protocol": "${t.protocol.toUpperCase()}",
  "sourceAddressPrefix": "${t.sourceIp}",
  "destinationAddressPrefix": "${t.destinationIp}",
  "destinationPortRange": "${t.port}",
  "access": "Allow",
  "priority": 100,
  "direction": "Inbound"
}`;break;case"gcp":i=`{
  "name": "allow-${t.protocol}-${t.port}",
  "network": "default",
  "sourceRanges": ["${t.sourceIp}"],
  "allowed": [{
    "IPProtocol": "${t.protocol}",
    "ports": ["${t.port}"]
  }]
}`;break;case"onprem":i=`access-list ${r.id} extended permit ${t.protocol} ${t.sourceIp} ${t.destinationIp} eq ${t.port}`;break}return{firewallId:r.id,firewallName:r.name,ruleType:r.type,rule:n,syntax:i,platform:r.platform}})),lf=async(t,s)=>{await new Promise(i=>setTimeout(i,1200));const a=[],r=[];return t.sourceIp.includes("10.100")&&a.push({id:"conflict-001",type:"shadowing",severity:"medium",existingRule:{id:"rule-12345",source:"10.100.0.0/16",destination:"any",port:"any",action:"deny"},message:"Existing deny rule may shadow this allow rule",recommendation:"Review rule priority or modify existing rule scope"}),["22","23","3389","445","139"].includes(t.port)&&r.push({id:"warn-001",type:"high_risk_port",severity:"high",message:`Port ${t.port} is commonly targeted by attackers`}),(t.sourceIp.includes("/8")||t.sourceIp.includes("/16"))&&r.push({id:"warn-002",type:"broad_rule",severity:"medium",message:"Source IP range is very broad - consider narrowing the scope"}),s==="production"&&t.sourceIp.includes("10.200")&&r.push({id:"warn-003",type:"cross_environment",severity:"high",message:"Production access from non-production network detected"}),{hasConflicts:a.length>0,conflicts:a,warnings:r}},cf=(t,s,a)=>{let r=20;const n=[];a==="production"?(r+=15,n.push({name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"})):a==="uat"?(r+=8,n.push({name:"UAT Environment",impact:"negative",weight:8,description:"UAT environment changes require careful testing"})):n.push({name:"Development Environment",impact:"positive",weight:-5,description:"Development environment has lower risk"}),s.conflicts.forEach(c=>{const d=c.severity==="critical"?25:c.severity==="high"?18:c.severity==="medium"?12:6;r+=d,n.push({name:`Rule ${c.type}`,impact:"negative",weight:d,description:c.message})}),s.warnings.forEach(c=>{const d=c.severity==="high"?12:c.severity==="medium"?7:3;r+=d,n.push({name:c.type.replace(/_/g," "),impact:"negative",weight:d,description:c.message})}),["80","443","22","3389"].includes(t.port)&&n.push({name:"Well-known port",impact:"neutral",weight:0,description:"Standard service port"});let o,l;return r>=70?(o="critical",l="Critical risk - Requires security team review and change advisory board approval"):r>=50?(o="high",l="High risk - Requires senior approval and detailed testing plan"):r>=30?(o="medium",l="Medium risk - Standard approval process with peer review"):(o="low",l="Low risk - Can proceed with standard L1 approval"),{score:Math.min(r,100),level:o,factors:n,recommendation:l}},df=async(t,s)=>{const a=await rf(),r=await nf(a.sourceIp,a.destinationIp,a.environment),n=await of(a,r),i=await lf(a,a.environment),o=cf(a,i,a.environment),l=[{id:"step-1",name:"L1 Engineer Review",approver:"L1 Operations Team",status:"pending"}];return(o.level==="high"||o.level==="critical")&&l.push({id:"step-2",name:"Security Team Review",approver:"Security Operations",status:"pending"}),a.environment==="production"&&l.push({id:"step-3",name:"Change Advisory Board",approver:"CAB Team",status:"pending"}),{id:`L1-${Date.now()}`,serviceNowId:t,status:"analyzed",mode:s,parsedData:a,firewallsInPath:r,recommendations:n,riskAssessment:o,conflictCheck:i,approvalChain:l,rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order of implementation",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"system"}},uf=async(t,s)=>{await new Promise(a=>setTimeout(a,2e3))},pf=async t=>{await new Promise(s=>setTimeout(s,1500))},mf=[{id:"L1-1705847230001",serviceNowId:"CHG0012345",status:"completed",mode:"automatic",parsedData:{sourceIp:"10.100.5.0/24",destinationIp:"172.16.20.50",port:"443",protocol:"tcp",environment:"production",description:"Allow HTTPS traffic from application servers to database endpoint",businessJustification:"Required for new microservice deployment to access production database"},firewallsInPath:[{id:"fw-prod-edge-01",name:"Production Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-prod-edge-01.company.com"},{id:"sg-0a1b2c3d4e5f",name:"App-Tier Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-12345678"}],recommendations:[{firewallId:"fw-prod-edge-01",firewallName:"Production Edge Firewall",ruleType:"firewall",rule:{source:"10.100.5.0/24",destination:"172.16.20.50",port:"443",protocol:"tcp",action:"allow"},syntax:"access-list fw-prod-edge-01 extended permit tcp 10.100.5.0/24 172.16.20.50 eq 443",platform:"onprem"},{firewallId:"sg-0a1b2c3d4e5f",firewallName:"App-Tier Security Group",ruleType:"security_group",rule:{source:"10.100.5.0/24",destination:"172.16.20.50",port:"443",protocol:"tcp",action:"allow"},syntax:`{
  "IpProtocol": "tcp",
  "FromPort": 443,
  "ToPort": 443,
  "IpRanges": [{ "CidrIp": "10.100.5.0/24" }]
}`,platform:"aws"}],riskAssessment:{score:35,level:"medium",factors:[{name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"},{name:"Well-known port",impact:"neutral",weight:0,description:"Standard HTTPS port"}],recommendation:"Medium risk - Standard approval process with peer review"},conflictCheck:{hasConflicts:!1,conflicts:[],warnings:[]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"John Smith",status:"approved",timestamp:"2026-01-18T14:30:00Z",comments:"Verified rule details and business justification"},{id:"step-2",name:"Change Advisory Board",approver:"CAB Team",status:"approved",timestamp:"2026-01-18T15:45:00Z",comments:"Approved for implementation during next change window"}],rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-18T14:00:00Z",updatedAt:"2026-01-18T16:30:00Z",completedAt:"2026-01-18T16:30:00Z",createdBy:"system",approvedBy:"CAB Team"},{id:"L1-1705847230002",serviceNowId:"CHG0012346",status:"pending_approval",mode:"automatic",parsedData:{sourceIp:"192.168.10.0/24",destinationIp:"10.50.100.25",port:"22",protocol:"tcp",environment:"production",description:"SSH access from jump server to production web servers",businessJustification:"Required for emergency maintenance access"},firewallsInPath:[{id:"fw-prod-dmz-01",name:"Production DMZ Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-prod-dmz-01.company.com"},{id:"nsg-web-tier-prod",name:"Web Tier NSG - Production",type:"nsg",platform:"azure",location:"eastus",zone:"vnet-prod-001"}],recommendations:[{firewallId:"fw-prod-dmz-01",firewallName:"Production DMZ Firewall",ruleType:"firewall",rule:{source:"192.168.10.0/24",destination:"10.50.100.25",port:"22",protocol:"tcp",action:"allow"},syntax:"access-list fw-prod-dmz-01 extended permit tcp 192.168.10.0/24 10.50.100.25 eq 22",platform:"onprem"},{firewallId:"nsg-web-tier-prod",firewallName:"Web Tier NSG - Production",ruleType:"nsg",rule:{source:"192.168.10.0/24",destination:"10.50.100.25",port:"22",protocol:"tcp",action:"allow",priority:100},syntax:`{
  "name": "Allow-22-Inbound",
  "protocol": "TCP",
  "sourceAddressPrefix": "192.168.10.0/24",
  "destinationPortRange": "22",
  "access": "Allow"
}`,platform:"azure"}],riskAssessment:{score:58,level:"high",factors:[{name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"},{name:"high risk port",impact:"negative",weight:12,description:"Port 22 is commonly targeted by attackers"}],recommendation:"High risk - Requires senior approval and detailed testing plan"},conflictCheck:{hasConflicts:!1,conflicts:[],warnings:[{id:"warn-001",type:"high_risk_port",severity:"high",message:"Port 22 is commonly targeted by attackers"}]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"L1 Operations Team",status:"pending"},{id:"step-2",name:"Security Team Review",approver:"Security Operations",status:"pending"},{id:"step-3",name:"Change Advisory Board",approver:"CAB Team",status:"pending"}],rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-19T09:15:00Z",updatedAt:"2026-01-19T09:15:00Z",createdBy:"system"},{id:"L1-1705847230003",serviceNowId:"CHG0012347",status:"analyzed",mode:"manual",parsedData:{sourceIp:"10.200.15.0/24",destinationIp:"172.31.50.100",port:"3306",protocol:"tcp",environment:"uat",description:"MySQL access from UAT application to database",businessJustification:"Testing new database connection for upcoming release"},firewallsInPath:[{id:"fw-uat-edge-01",name:"UAT Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-uat-edge-01.company.com"},{id:"sg-uat-db-9z8y7x6w",name:"UAT Database Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-uat-001"}],recommendations:[{firewallId:"fw-uat-edge-01",firewallName:"UAT Edge Firewall",ruleType:"firewall",rule:{source:"10.200.15.0/24",destination:"172.31.50.100",port:"3306",protocol:"tcp",action:"allow"},syntax:"access-list fw-uat-edge-01 extended permit tcp 10.200.15.0/24 172.31.50.100 eq 3306",platform:"onprem"},{firewallId:"sg-uat-db-9z8y7x6w",firewallName:"UAT Database Security Group",ruleType:"security_group",rule:{source:"10.200.15.0/24",destination:"172.31.50.100",port:"3306",protocol:"tcp",action:"allow"},syntax:`{
  "IpProtocol": "tcp",
  "FromPort": 3306,
  "ToPort": 3306,
  "IpRanges": [{ "CidrIp": "10.200.15.0/24" }]
}`,platform:"aws"}],riskAssessment:{score:28,level:"low",factors:[{name:"UAT Environment",impact:"negative",weight:8,description:"UAT environment changes require careful testing"}],recommendation:"Low risk - Can proceed with standard L1 approval"},conflictCheck:{hasConflicts:!1,conflicts:[],warnings:[]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"L1 Operations Team",status:"pending"}],rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-19T10:30:00Z",updatedAt:"2026-01-19T10:30:00Z",createdBy:"system"},{id:"L1-1705847230004",serviceNowId:"CHG0012348",status:"implementing",mode:"automatic",parsedData:{sourceIp:"10.100.0.0/16",destinationIp:"172.16.0.0/16",port:"80",protocol:"tcp",environment:"production",description:"HTTP traffic from internal network to application tier",businessJustification:"Legacy application access requirement"},firewallsInPath:[{id:"fw-prod-core-01",name:"Production Core Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1"}],recommendations:[{firewallId:"fw-prod-core-01",firewallName:"Production Core Firewall",ruleType:"firewall",rule:{source:"10.100.0.0/16",destination:"172.16.0.0/16",port:"80",protocol:"tcp",action:"allow"},syntax:"access-list fw-prod-core-01 extended permit tcp 10.100.0.0/16 172.16.0.0/16 eq 80",platform:"onprem"}],riskAssessment:{score:52,level:"high",factors:[{name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"},{name:"broad rule",impact:"negative",weight:7,description:"Source IP range is very broad - consider narrowing the scope"},{name:"Rule shadowing",impact:"negative",weight:12,description:"Existing deny rule may shadow this allow rule"}],recommendation:"High risk - Requires senior approval and detailed testing plan"},conflictCheck:{hasConflicts:!0,conflicts:[{id:"conflict-001",type:"shadowing",severity:"medium",existingRule:{id:"rule-12345",source:"10.100.0.0/16",destination:"any",port:"any",action:"deny"},message:"Existing deny rule may shadow this allow rule",recommendation:"Review rule priority or modify existing rule scope"}],warnings:[{id:"warn-002",type:"broad_rule",severity:"medium",message:"Source IP range is very broad - consider narrowing the scope"}]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"Sarah Johnson",status:"approved",timestamp:"2026-01-19T11:00:00Z"},{id:"step-2",name:"Security Team Review",approver:"Mike Chen",status:"approved",timestamp:"2026-01-19T11:30:00Z",comments:"Approved with recommendation to narrow scope in next iteration"}],implementationStatus:{step:"Applying rule to Production Core Firewall",progress:75,message:"Verifying rule application..."},rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-19T10:45:00Z",updatedAt:"2026-01-19T11:35:00Z",createdBy:"system",approvedBy:"Mike Chen"}],hf=()=>{const[t,s]=v.useState(""),[a,r]=v.useState("automatic"),[n,i]=v.useState(!1),[o,l]=v.useState(null),[c,d]=v.useState(null),[h,u]=v.useState(!1),x=async f=>{f.preventDefault(),d(null),i(!0);try{const j=await df(t,a);l(j)}catch{d("Failed to process ServiceNow ticket. Please check the ticket ID and try again.")}finally{i(!1)}},_=async()=>{if(!o)return;const f={...o,status:"approved",approvalChain:o.approvalChain.map((j,N)=>N===0?{...j,status:"approved",timestamp:new Date().toISOString(),approver:"Current User",comments:"Reviewed and approved"}:j)};l(f)},b=()=>{if(!o)return;const f={...o,status:"rejected",approvalChain:o.approvalChain.map((j,N)=>N===0?{...j,status:"rejected",timestamp:new Date().toISOString(),approver:"Current User",comments:"Rejected - does not meet security requirements"}:j)};l(f)},m=async()=>{if(!o)return;l({...o,status:"implementing",implementationStatus:{step:"Initializing implementation",progress:0,message:"Preparing to apply firewall rules..."}});const f=[{step:"Applying rule to Production Edge Firewall",progress:25,message:"Connecting to firewall..."},{step:"Applying rule to Production Edge Firewall",progress:50,message:"Rule applied successfully"},{step:"Applying rule to App-Tier Security Group",progress:75,message:"Updating AWS Security Group..."},{step:"Finalizing implementation",progress:95,message:"Verifying all changes..."}];for(const j of f)await new Promise(N=>setTimeout(N,1500)),l(N=>N?{...N,implementationStatus:j}:null);await new Promise(j=>setTimeout(j,1e3)),await uf(o.id),l(j=>j?{...j,status:"completed",completedAt:new Date().toISOString(),implementationStatus:void 0}:null)},T=async()=>{o&&(l({...o,status:"implementing",implementationStatus:{step:"Rolling back changes",progress:50,message:"Removing firewall rules in reverse order..."}}),await pf(o.id),await new Promise(f=>setTimeout(f,2e3)),l({...o,status:"rolled_back",implementationStatus:void 0,updatedAt:new Date().toISOString()}))},p=()=>{l(null),s(""),d(null)},g=f=>{l(f),s(f.serviceNowId),u(!1)};return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"L1 Firewall Whitelisting"}),e.jsx("p",{className:"text-slate-400",children:"AI-powered ticket processing with automatic firewall rule implementation"})]}),!o&&e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(y,{children:[e.jsx(B,{title:"Process ServiceNow Ticket",subtitle:"Enter a ServiceNow ticket ID to begin AI analysis"}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[c&&e.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg",children:e.jsx("p",{className:"text-red-400",children:c})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"ServiceNow Ticket ID"}),e.jsx("input",{type:"text",value:t,onChange:f=>s(f.target.value),placeholder:"e.g., CHG0012345",required:!0,className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500 font-mono"}),e.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"The AI will automatically extract source IP, destination IP, port, protocol, and environment"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Implementation Mode"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>r("automatic"),className:`p-4 rounded-lg border-2 transition-all ${a==="automatic"?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:`w-5 h-5 ${a==="automatic"?"text-cyan-400":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("span",{className:`font-semibold ${a==="automatic"?"text-cyan-400":"text-slate-400"}`,children:"Automatic"})]}),e.jsx("p",{className:"text-xs text-slate-400 text-left",children:"Rules implemented automatically after approval"})]}),e.jsxs("button",{type:"button",onClick:()=>r("manual"),className:`p-4 rounded-lg border-2 transition-all ${a==="manual"?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:`w-5 h-5 ${a==="manual"?"text-cyan-400":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),e.jsx("span",{className:`font-semibold ${a==="manual"?"text-cyan-400":"text-slate-400"}`,children:"Manual"})]}),e.jsx("p",{className:"text-xs text-slate-400 text-left",children:"Review recommendations, implement manually"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(D,{type:"submit",variant:"primary",isLoading:n,className:"flex-1",children:n?"Processing Ticket...":"Process Ticket"}),e.jsx(D,{type:"button",variant:"ghost",onClick:()=>u(!h),children:h?"Hide History":"View History"})]})]}),h&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700",children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:"Recent Tickets"}),e.jsx("div",{className:"space-y-2",children:mf.slice(0,4).map(f=>e.jsx("button",{onClick:()=>g(f),className:"w-full p-3 bg-slate-700/30 hover:bg-slate-700/50 rounded-lg border border-slate-600 hover:border-cyan-500/50 transition-all text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium font-mono text-sm",children:f.serviceNowId}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:f.parsedData.description})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${f.status==="completed"?"bg-emerald-500/20 text-emerald-400":f.status==="implementing"?"bg-cyan-500/20 text-cyan-400":f.status==="pending_approval"?"bg-amber-500/20 text-amber-400":"bg-slate-500/20 text-slate-400"}`,children:f.status.replace(/_/g," ")})]})},f.id))})]})]})}),o&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-1",children:["Ticket: ",e.jsx("span",{className:"text-cyan-400 font-mono",children:o.serviceNowId})]}),e.jsxs("p",{className:"text-slate-400",children:["Created ",new Date(o.createdAt).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold uppercase border ${o.status==="completed"?"bg-emerald-500/20 text-emerald-400 border-emerald-500/30":o.status==="implementing"?"bg-cyan-500/20 text-cyan-400 border-cyan-500/30":o.status==="approved"||o.status==="pending_approval"?"bg-amber-500/20 text-amber-400 border-amber-500/30":o.status==="rejected"?"bg-red-500/20 text-red-400 border-red-500/30":o.status==="rolled_back"?"bg-slate-500/20 text-slate-400 border-slate-500/30":"bg-blue-500/20 text-blue-400 border-blue-500/30"}`,children:o.status.replace(/_/g," ")}),e.jsx(D,{variant:"ghost",onClick:p,children:"New Ticket"})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-2 space-y-6",children:[e.jsx(W1,{parsedData:o.parsedData}),e.jsx(Z1,{firewalls:o.firewallsInPath}),e.jsx(q1,{recommendations:o.recommendations}),e.jsx(J1,{conflictCheck:o.conflictCheck})]}),e.jsxs("div",{className:"col-span-1 space-y-6",children:[e.jsx(tf,{assessment:o.riskAssessment}),e.jsx(af,{ticket:o,onApprove:_,onReject:b,onImplement:m,onRollback:T})]})]})]})]})},xf={name:"",description:"",sourceIp:"",destinationIp:"",port:"",protocol:"tcp",action:"allow",direction:"inbound"},Ko={aws:{id:"aws",name:"AWS Security Group",category:"cloud",icon:"aws",description:"Amazon Web Services Security Groups",syntaxExample:"aws ec2 authorize-security-group-ingress ..."},azure:{id:"azure",name:"Azure NSG",category:"cloud",icon:"azure",description:"Azure Network Security Groups",syntaxExample:"az network nsg rule create ..."},gcp:{id:"gcp",name:"GCP Firewall",category:"cloud",icon:"gcp",description:"Google Cloud Platform Firewall Rules",syntaxExample:"gcloud compute firewall-rules create ..."},palo_alto:{id:"palo_alto",name:"Palo Alto",category:"firewall",icon:"firewall",description:"Palo Alto Networks PAN-OS",syntaxExample:"set rulebase security rules ..."},cisco_asa:{id:"cisco_asa",name:"Cisco ASA",category:"firewall",icon:"firewall",description:"Cisco Adaptive Security Appliance",syntaxExample:"access-list outside_access_in extended ..."},fortinet:{id:"fortinet",name:"Fortinet FortiGate",category:"firewall",icon:"firewall",description:"Fortinet FortiGate Firewall",syntaxExample:"config firewall policy ..."},iptables:{id:"iptables",name:"Linux iptables",category:"linux",icon:"linux",description:"Linux iptables/nftables",syntaxExample:"iptables -A INPUT -p tcp ..."}},gf=["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"],ff=()=>{const[t,s]=v.useState(xf),[a,r]=v.useState(["aws","azure","gcp"]),[n,i]=v.useState([]),[o,l]=v.useState([]),[c,d]=v.useState(!1),[h,u]=v.useState(!0),[x,_]=v.useState(null);v.useEffect(()=>{(async()=>{try{const A=await uc.getTemplates();l(A)}catch(A){_(A instanceof Error?A.message:"Failed to load templates")}finally{u(!1)}})()},[]);const b=v.useCallback(S=>{s(A=>({...A,...S}))},[]),m=v.useCallback(S=>{r(A=>A.includes(S)?A.filter(k=>k!==S):[...A,S])},[]),T=v.useCallback(()=>{r(gf)},[]),p=v.useCallback(()=>{r([])},[]),g=v.useCallback(async()=>{if(a.length===0){_("Please select at least one platform");return}d(!0),_(null);try{const S=await uc.generateRules(t,a);i(S)}catch(S){_(S instanceof Error?S.message:"Failed to generate rules")}finally{d(!1)}},[t,a]),f=v.useCallback(S=>{s(S.input),r(S.platforms),i([])},[]),j=v.useCallback(()=>{i([])},[]),N=v.useCallback(()=>{_(null)},[]);return{input:t,selectedPlatforms:a,generatedRules:n,templates:o,isGenerating:c,isLoadingTemplates:h,error:x,setInput:s,updateInput:b,togglePlatform:m,selectAllPlatforms:T,clearPlatforms:p,generateRules:g,applyTemplate:f,clearOutput:j,clearError:N}},wc={web:{bg:"bg-blue-100",text:"text-blue-700"},database:{bg:"bg-purple-100",text:"text-purple-700"},application:{bg:"bg-green-100",text:"text-green-700"},management:{bg:"bg-amber-100",text:"text-amber-700"},security:{bg:"bg-red-100",text:"text-red-700"},custom:{bg:"bg-slate-100",text:"text-slate-700"}},vf=()=>{const{input:t,selectedPlatforms:s,generatedRules:a,templates:r,isGenerating:n,error:i,updateInput:o,togglePlatform:l,selectAllPlatforms:c,clearPlatforms:d,generateRules:h,applyTemplate:u,clearOutput:x,clearError:_}=ff(),[b,m]=v.useState("input"),[T,p]=v.useState(null),g=async f=>{try{await navigator.clipboard.writeText(f.syntax),p(f.platform),setTimeout(()=>p(null),2e3)}catch{}};return e.jsx(ee,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m("input"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${b==="input"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Custom Rule"}),e.jsx("button",{onClick:()=>m("templates"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${b==="templates"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Templates"})]}),i&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-red-700",children:i})]}),e.jsx("button",{onClick:_,className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),b==="input"?e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Rule Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Rule Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.name,onChange:f=>o({name:f.target.value}),placeholder:"e.g., Allow-HTTPS-Inbound",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:f=>o({description:f.target.value}),placeholder:"Brief description of the rule",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source IP/CIDR"}),e.jsx("input",{type:"text",value:t.sourceIp,onChange:f=>o({sourceIp:f.target.value}),placeholder:"10.0.0.0/8 or * for any",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Destination IP/CIDR"}),e.jsx("input",{type:"text",value:t.destinationIp,onChange:f=>o({destinationIp:f.target.value}),placeholder:"192.168.1.0/24 or * for any",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Port"}),e.jsx("input",{type:"text",value:t.port,onChange:f=>o({port:f.target.value}),placeholder:"443 or 80-443",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Protocol"}),e.jsxs("select",{value:t.protocol,onChange:f=>o({protocol:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"}),e.jsx("option",{value:"icmp",children:"ICMP"}),e.jsx("option",{value:"any",children:"Any"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Action"}),e.jsxs("select",{value:t.action,onChange:f=>o({action:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"allow",children:"Allow"}),e.jsx("option",{value:"deny",children:"Deny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Direction"}),e.jsxs("select",{value:t.direction,onChange:f=>o({direction:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"inbound",children:"Inbound"}),e.jsx("option",{value:"outbound",children:"Outbound"}),e.jsx("option",{value:"both",children:"Both"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Priority (optional)"}),e.jsx("input",{type:"number",value:t.priority||"",onChange:f=>o({priority:f.target.value?parseInt(f.target.value):void 0}),placeholder:"100",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]})]}):e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Rule Templates"}),e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:r.map(f=>e.jsx(yf,{template:f,onApply:()=>{u(f),m("input")}},f.id))})]}),e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Target Platforms"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:c,className:"text-sm text-cyan-600 hover:text-cyan-700",children:"Select All"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("button",{onClick:d,className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.values(Ko).map(f=>e.jsx(bf,{platform:f,isSelected:s.includes(f.id),onToggle:()=>l(f.id)},f.id))})]}),e.jsx("button",{onClick:h,disabled:n||s.length===0,className:"w-full bg-cyan-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Generate Rules (",s.length," platforms)"]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Generated Rules"}),a.length>0&&e.jsx("button",{onClick:x,className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear Output"})]}),a.length===0?e.jsx(y,{className:"bg-slate-50 border-2 border-dashed border-slate-200",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),e.jsx("p",{className:"text-slate-500",children:"Configure a rule and select platforms to generate firewall rules"})]})}):e.jsx("div",{className:"space-y-4 max-h-[calc(100vh-250px)] overflow-y-auto",children:a.map(f=>e.jsx(_f,{rule:f,onCopy:()=>g(f),isCopied:T===f.platform},f.platform))})]})]})})},yf=({template:t,onApply:s})=>{const a=wc[t.category]||wc.custom;return e.jsx("div",{className:"border border-slate-200 rounded-lg p-3 hover:border-cyan-300 hover:bg-cyan-50/30 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-slate-800",children:t.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.bg} ${a.text}`,children:t.category})]}),e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:t.description}),e.jsxs("div",{className:"flex gap-1",children:[t.platforms.slice(0,4).map(r=>{var n;return e.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded",children:((n=Ko[r])==null?void 0:n.name.split(" ")[0])||r},r)}),t.platforms.length>4&&e.jsxs("span",{className:"text-xs text-slate-400",children:["+",t.platforms.length-4]})]})]}),e.jsx("button",{onClick:s,className:"text-cyan-600 hover:text-cyan-700 hover:bg-cyan-100 p-2 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},bf=({platform:t,isSelected:s,onToggle:a})=>{const r={cloud:"border-blue-200 bg-blue-50",firewall:"border-orange-200 bg-orange-50",linux:"border-slate-200 bg-slate-50"};return e.jsx("button",{onClick:a,className:`p-3 rounded-lg border-2 text-left transition-all ${s?"border-cyan-500 bg-cyan-50 ring-2 ring-cyan-200":r[t.category]||"border-slate-200 bg-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center ${s?"border-cyan-500 bg-cyan-500":"border-slate-300"}`,children:s&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:`text-sm font-medium ${s?"text-cyan-700":"text-slate-700"}`,children:t.name})]})})},_f=({rule:t,onCopy:s,isCopied:a})=>{const r=Ko[t.platform];return e.jsxs(y,{className:"bg-white shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-8 h-8 rounded flex items-center justify-center text-white ${r.category==="cloud"?"bg-blue-500":r.category==="firewall"?"bg-orange-500":"bg-slate-500"}`,children:r.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:r.name}),e.jsx("p",{className:"text-xs text-slate-500",children:r.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.isValid?e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:"Valid"}):e.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded",children:"Invalid"}),e.jsx("button",{onClick:s,disabled:!t.isValid,className:"p-2 text-slate-500 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors disabled:opacity-50",title:"Copy to clipboard",children:a?e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),t.warnings&&t.warnings.length>0&&e.jsx("div",{className:"mb-3",children:t.warnings.map((n,i)=>e.jsxs("div",{className:"flex items-start gap-2 text-amber-700 bg-amber-50 p-2 rounded text-sm mb-1",children:[e.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{children:n})]},i))}),t.validationErrors&&t.validationErrors.length>0&&e.jsx("div",{className:"mb-3",children:t.validationErrors.map((n,i)=>e.jsxs("div",{className:"flex items-start gap-2 text-red-700 bg-red-50 p-2 rounded text-sm mb-1",children:[e.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:n})]},i))}),t.syntax&&e.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-sm font-mono whitespace-pre-wrap",children:t.syntax})]})},wf=()=>{const[t,s]=v.useState("aws"),[a,r]=v.useState(""),[n,i]=v.useState(null),[o,l]=v.useState([]),[c,d]=v.useState([]),[h,u]=v.useState(!1),[x,_]=v.useState(!0),[b,m]=v.useState(null);v.useEffect(()=>{(async()=>{try{const S=await ps.getValidationHistory();d(S)}catch(S){m(S instanceof Error?S.message:"Failed to load history")}finally{_(!1)}})()},[]);const T=v.useCallback(async()=>{if(!a.trim()){m("Please enter rule content to validate");return}u(!0),m(null);try{const[N,S]=await Promise.all([ps.validateRules(t,a),ps.runSecurityAnalysis(a)]);i(N),l(S);const A=await ps.getValidationHistory();d(A)}catch(N){m(N instanceof Error?N.message:"Validation failed")}finally{u(!1)}},[t,a]),p=v.useCallback(async()=>{if(!a.trim()){m("Please enter rule content to analyze");return}u(!0),m(null);try{const N=await ps.runSecurityAnalysis(a);l(N)}catch(N){m(N instanceof Error?N.message:"Security analysis failed")}finally{u(!1)}},[a]),g=v.useCallback(()=>{i(null),l([])},[]),f=v.useCallback(async()=>{try{await ps.clearHistory(),d([])}catch(N){m(N instanceof Error?N.message:"Failed to clear history")}},[]),j=v.useCallback(()=>{m(null)},[]);return{platform:t,content:a,result:n,securityChecks:o,history:c,isValidating:h,isLoadingHistory:x,error:b,setPlatform:s,setContent:r,validate:T,runSecurityAnalysis:p,clearResult:g,clearHistory:f,clearError:j}},jc={aws:`# AWS Security Group Rules (CLI format)
aws ec2 authorize-security-group-ingress \\
  --group-id sg-12345678 \\
  --protocol tcp \\
  --port 443 \\
  --cidr 10.0.0.0/8

aws ec2 authorize-security-group-ingress \\
  --group-id sg-12345678 \\
  --protocol tcp \\
  --port 22 \\
  --cidr 10.0.0.0/8`,azure:`# Azure NSG Rules (CLI format)
az network nsg rule create \\
  --resource-group myRG \\
  --nsg-name myNSG \\
  --name Allow-HTTPS \\
  --priority 100 \\
  --direction Inbound \\
  --access Allow \\
  --protocol Tcp \\
  --source-address-prefixes 10.0.0.0/8 \\
  --destination-port-ranges 443`,gcp:`# GCP Firewall Rules (gcloud format)
gcloud compute firewall-rules create allow-https \\
  --network=my-vpc \\
  --direction=INGRESS \\
  --action=ALLOW \\
  --rules=tcp:443 \\
  --source-ranges=10.0.0.0/8`,palo_alto:`# Palo Alto PAN-OS Rules
set rulebase security rules "Allow-HTTPS" from untrust to trust
set rulebase security rules "Allow-HTTPS" source any
set rulebase security rules "Allow-HTTPS" destination 10.0.0.0/8
set rulebase security rules "Allow-HTTPS" application ssl
set rulebase security rules "Allow-HTTPS" service application-default
set rulebase security rules "Allow-HTTPS" action allow`,cisco_asa:`! Cisco ASA Access List
access-list outside_access_in extended permit tcp any host 10.0.0.50 eq 443
access-list outside_access_in extended permit tcp 10.0.0.0 255.0.0.0 any eq 22
access-list outside_access_in extended deny ip any any log`,fortinet:`# FortiGate Firewall Policy
config firewall policy
    edit 1
        set name "Allow-HTTPS"
        set srcintf "wan1"
        set dstintf "lan"
        set srcaddr "all"
        set dstaddr "webservers"
        set action accept
        set schedule "always"
        set service "HTTPS"
        set logtraffic all
    next
end`,iptables:`# Linux iptables Rules
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp --dport 22 -s 10.0.0.0/8 -j ACCEPT
iptables -A INPUT -p tcp --dport 3306 -s 10.1.0.0/16 -j ACCEPT
iptables -A INPUT -j DROP`},jf={totalValidations:1247,successfulValidations:982,totalIssues:1834,errorCount:345,warningCount:876,avgSyntaxScore:87.5,avgSecurityScore:82.3,avgComplianceScore:91.2,topPlatform:"aws"},Nf=[{id:"BP-001",title:"Avoid Allowing Traffic from 0.0.0.0/0 (Any)",description:"Opening ports to the entire internet (0.0.0.0/0) exposes your infrastructure to potential attacks. Restrict access to known IP ranges.",category:"security",severity:"error",examples:{bad:"aws ec2 authorize-security-group-ingress --cidr 0.0.0.0/0 --port 22",good:"aws ec2 authorize-security-group-ingress --cidr 10.0.0.0/8 --port 22",explanation:"SSH (port 22) should only be accessible from trusted IP ranges, not the entire internet. Use VPN or bastion hosts for remote access."},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"BP-002",title:'Use Specific Protocols Instead of "any"',description:"Specifying exact protocols (TCP, UDP, ICMP) provides better security and makes rules easier to understand and audit.",category:"best_practice",severity:"warning",examples:{bad:"access-list ACL_IN extended permit ip any any",good:"access-list ACL_IN extended permit tcp 10.0.0.0 255.0.0.0 any eq 443",explanation:'Using "any" protocol allows all traffic types. Specify TCP/UDP with exact ports for better security control.'},platforms:["cisco_asa","palo_alto","fortinet"]},{id:"BP-003",title:"Explicitly Deny All at End of Rules",description:"Always end your rule set with an explicit deny-all rule to ensure default-deny posture.",category:"security",severity:"warning",examples:{bad:`iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp --dport 80 -j ACCEPT`,good:`iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -j DROP`,explanation:"Without explicit deny-all, default policy may allow unintended traffic. Always add final deny/drop rule."},platforms:["iptables","cisco_asa","palo_alto"]},{id:"BP-004",title:"Restrict Database Ports to Application Tier Only",description:"Database ports (3306, 5432, 1433, etc.) should only be accessible from application servers, never from the internet.",category:"security",severity:"error",examples:{bad:"aws ec2 authorize-security-group-ingress --port 3306 --cidr 0.0.0.0/0",good:"aws ec2 authorize-security-group-ingress --port 3306 --source-group sg-app-tier",explanation:"Exposing database ports to the internet is a critical security risk. Use security groups or IP restrictions."},platforms:["aws","azure","gcp"]},{id:"BP-005",title:"Use Descriptive Rule Names and Comments",description:"Clear rule names and comments make firewall policies easier to manage, audit, and troubleshoot.",category:"best_practice",severity:"info",examples:{bad:'set rulebase security rules "rule1" action allow',good:'set rulebase security rules "Allow-Web-From-LB" description "HTTPS from load balancer to web tier" action allow',explanation:"Descriptive names help teams understand rule purpose without analyzing every detail."},platforms:["palo_alto","fortinet","cisco_asa"]},{id:"BP-006",title:"Use Named Port Numbers",description:"Reference well-known services by name (https, ssh, mysql) instead of numbers for better readability.",category:"best_practice",severity:"info",examples:{bad:"az network nsg rule create --destination-port-ranges 443",good:"az network nsg rule create --destination-port-ranges https",explanation:"Named services are more readable and some platforms provide additional validation."},platforms:["azure","gcp","palo_alto"]},{id:"BP-007",title:"Implement Egress Filtering",description:"Control outbound traffic as well as inbound. Egress filtering prevents data exfiltration and lateral movement.",category:"security",severity:"warning",examples:{bad:`# Only inbound rules defined
iptables -A INPUT -p tcp --dport 443 -j ACCEPT`,good:`# Both ingress and egress
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 443 -d trusted-apis.com -j ACCEPT
iptables -A OUTPUT -j DROP`,explanation:"Egress filtering prevents compromised servers from connecting to attacker infrastructure."},platforms:["iptables","aws","azure","gcp","palo_alto"]},{id:"BP-008",title:"Regular Rule Audits and Cleanup",description:"Periodically review firewall rules to remove unused or outdated entries that accumulate over time.",category:"best_practice",severity:"info",examples:{bad:"# 500 rules accumulated over 3 years, many unused",good:"# Quarterly audit: disabled 45 unused rules, removed 23 obsolete rules, consolidated 12 duplicates",explanation:"Rule bloat makes policies harder to manage and can hide security issues. Regular cleanup is essential."},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet"]}],Sf=[{id:"MSG-001",type:"warning",title:"High Volume of Security Violations Detected",message:"In the last 24 hours, 34% of validations contained security violations (primarily SSH and RDP exposure to internet). Consider implementing automated security scanning in CI/CD.",timestamp:"2024-01-19T15:00:00Z",dismissible:!0,actionLabel:"View Security Report",actionUrl:"#security-report"},{id:"MSG-002",type:"success",title:"Validation Success Rate Improved",message:"Validation success rate increased from 75% to 79% this week. Great progress on firewall rule quality!",timestamp:"2024-01-19T14:30:00Z",dismissible:!0},{id:"MSG-003",type:"info",title:"New Best Practice Guide Available",message:"Updated AWS Security Group best practices guide now includes VPC endpoint patterns and IMDSv2 requirements.",timestamp:"2024-01-19T13:00:00Z",dismissible:!0,actionLabel:"Read Guide",actionUrl:"#best-practices"},{id:"MSG-004",type:"error",title:"Critical: Production Rules Failed Validation",message:"3 production firewall rules failed validation with critical security issues. Immediate review required.",timestamp:"2024-01-19T12:45:00Z",dismissible:!1,actionLabel:"Review Now",actionUrl:"#critical-issues"},{id:"MSG-005",type:"info",title:"Platform Support Update",message:"Added support for Fortinet FortiGate v7.2 firewall policy validation with enhanced security checks.",timestamp:"2024-01-19T10:00:00Z",dismissible:!0}],Ue={metrics:jf,bestPractices:Nf,messages:Sf},kr=[{id:"aws",name:"AWS Security Group",category:"cloud"},{id:"azure",name:"Azure NSG",category:"cloud"},{id:"gcp",name:"GCP Firewall",category:"cloud"},{id:"palo_alto",name:"Palo Alto",category:"firewall"},{id:"cisco_asa",name:"Cisco ASA",category:"firewall"},{id:"fortinet",name:"Fortinet",category:"firewall"},{id:"iptables",name:"iptables",category:"linux"}],kf=()=>{var S,A;const{platform:t,content:s,result:a,securityChecks:r,history:n,isValidating:i,error:o,setPlatform:l,setContent:c,validate:d,clearResult:h,clearError:u}=wf(),[x,_]=v.useState(!1),[b,m]=v.useState(new Set),[T,p]=v.useState("all"),g=k=>{m(I=>new Set(I).add(k))},f=Ue.messages.filter(k=>!b.has(k.id)),j=T==="all"?Ue.bestPractices:Ue.bestPractices.filter(k=>k.category===T),N=()=>{c(jc[t]),_(!1),h()};return e.jsxs(ee,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs(y,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx("div",{className:"text-sm opacity-90 mb-1",children:"Total Validations"}),e.jsx("div",{className:"text-3xl font-bold",children:Ue.metrics.totalValidations.toLocaleString()}),e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:[Ue.metrics.successfulValidations," successful"]})]}),e.jsxs(y,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx("div",{className:"text-sm opacity-90 mb-1",children:"Avg Security Score"}),e.jsxs("div",{className:"text-3xl font-bold",children:[Ue.metrics.avgSecurityScore,"%"]}),e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["Syntax: ",Ue.metrics.avgSyntaxScore,"%"]})]}),e.jsxs(y,{className:"bg-gradient-to-br from-amber-500 to-amber-600 text-white",children:[e.jsx("div",{className:"text-sm opacity-90 mb-1",children:"Total Issues"}),e.jsx("div",{className:"text-3xl font-bold",children:Ue.metrics.totalIssues.toLocaleString()}),e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:[Ue.metrics.errorCount," errors, ",Ue.metrics.warningCount," warnings"]})]}),e.jsxs(y,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[e.jsx("div",{className:"text-sm opacity-90 mb-1",children:"Top Platform"}),e.jsx("div",{className:"text-3xl font-bold uppercase",children:Ue.metrics.topPlatform}),e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["Compliance: ",Ue.metrics.avgComplianceScore,"%"]})]})]}),f.length>0&&e.jsx("div",{className:"mb-6 space-y-3",children:f.map(k=>e.jsx(Pf,{message:k,onDismiss:()=>g(k.id)},k.id))}),e.jsxs(y,{className:"bg-white shadow-lg mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Validation Best Practices"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p("all"),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${T==="all"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"All"}),e.jsx("button",{onClick:()=>p("security"),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${T==="security"?"bg-red-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Security"}),e.jsx("button",{onClick:()=>p("best_practice"),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${T==="best_practice"?"bg-blue-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Best Practices"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 max-h-[500px] overflow-y-auto",children:j.map(k=>e.jsx(If,{practice:k},k.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Select Platform"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:kr.map(k=>e.jsx("button",{onClick:()=>{l(k.id),h()},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${t===k.id?"bg-cyan-500 text-white":k.category==="cloud"?"bg-blue-50 text-blue-700 hover:bg-blue-100":k.category==="firewall"?"bg-orange-50 text-orange-700 hover:bg-orange-100":"bg-slate-50 text-slate-700 hover:bg-slate-100"}`,children:k.name},k.id))})]}),o&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-red-700",children:o})]}),e.jsx("button",{onClick:u,className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Rule Content"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_(!x),className:"text-sm text-cyan-600 hover:text-cyan-700",children:x?"Hide Example":"Show Example"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("button",{onClick:()=>{c(""),h()},className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear"})]})]}),x&&e.jsxs("div",{className:"mb-4 p-3 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-slate-600",children:["Example for ",(S=kr.find(k=>k.id===t))==null?void 0:S.name]}),e.jsx("button",{onClick:N,className:"text-sm text-cyan-600 hover:text-cyan-700 font-medium",children:"Load Example"})]}),e.jsxs("pre",{className:"text-xs text-slate-500 overflow-x-auto whitespace-pre-wrap",children:[jc[t].substring(0,200),"..."]})]}),e.jsx("textarea",{value:s,onChange:k=>c(k.target.value),placeholder:`Enter ${(A=kr.find(k=>k.id===t))==null?void 0:A.name} rules to validate...`,className:"w-full h-64 px-4 py-3 font-mono text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent resize-none",spellCheck:!1}),e.jsx("div",{className:"flex gap-4 mt-4",children:e.jsx("button",{onClick:d,disabled:i||!s.trim(),className:"flex-1 bg-cyan-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Validating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Validate Rules"]})})})]}),a&&e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Validation Results"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a.isValid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.isValid?"Valid":"Invalid"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsx(ei,{label:"Syntax",score:a.syntaxScore}),e.jsx(ei,{label:"Security",score:a.securityScore}),e.jsx(ei,{label:"Compliance",score:a.complianceScore})]}),a.issues.length>0?e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-slate-700 mb-3",children:["Issues Found (",a.issues.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:a.issues.map(k=>e.jsx(Cf,{issue:k},k.id))})]}):e.jsxs("div",{className:"text-center py-8 text-green-600",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"font-medium",children:"No issues found!"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Your rules passed all validation checks."})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[r.length>0&&e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Security Analysis"}),e.jsx("div",{className:"space-y-2",children:r.map(k=>e.jsx(Af,{check:k},k.id))})]}),e.jsxs(y,{className:"bg-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Recent Validations"}),n.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:"No validation history"}):e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:n.map(k=>e.jsx(Tf,{item:k},k.id))})]}),e.jsxs(y,{className:"bg-gradient-to-br from-cyan-500 to-blue-600 text-white shadow-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Validation Tips"}),e.jsxs("ul",{className:"space-y-2 text-sm text-cyan-100",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-200 mt-0.5",children:"1."}),e.jsx("span",{children:"Never open SSH (22) or RDP (3389) to 0.0.0.0/0"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-200 mt-0.5",children:"2."}),e.jsx("span",{children:'Use specific IP ranges instead of "any" when possible'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-200 mt-0.5",children:"3."}),e.jsx("span",{children:"Keep database ports restricted to internal networks"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-200 mt-0.5",children:"4."}),e.jsx("span",{children:"Use HTTPS instead of HTTP for web traffic"})]})]})]})]})]})]})},ei=({label:t,score:s})=>{const a=n=>n>=90?"text-green-600":n>=70?"text-amber-600":"text-red-600",r=n=>n>=90?"bg-green-500":n>=70?"bg-amber-500":"bg-red-500";return e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:t}),e.jsxs("p",{className:`text-2xl font-bold ${a(s)}`,children:[s,"%"]}),e.jsx("div",{className:"w-full h-2 bg-slate-200 rounded-full mt-2",children:e.jsx("div",{className:`h-full rounded-full transition-all ${r(s)}`,style:{width:`${s}%`}})})]})},Cf=({issue:t})=>{const a={error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",icon:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},warning:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700",icon:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}[t.severity];return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-3`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:`w-5 h-5 ${a.text} flex-shrink-0 mt-0.5`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.line>0&&e.jsxs("span",{className:"text-xs bg-slate-200 text-slate-600 px-1.5 py-0.5 rounded",children:["Line ",t.line]}),e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${t.category==="syntax"?"bg-purple-100 text-purple-700":t.category==="security"?"bg-red-100 text-red-700":t.category==="compliance"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:t.category})]}),e.jsx("p",{className:`text-sm ${a.text}`,children:t.message}),t.suggestion&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Suggestion:"})," ",t.suggestion]})]})]})})},Af=({check:t})=>{const a={pass:{bg:"bg-green-50",text:"text-green-700",icon:"M5 13l4 4L19 7"},fail:{bg:"bg-red-50",text:"text-red-700",icon:"M6 18L18 6M6 6l12 12"},warning:{bg:"bg-amber-50",text:"text-amber-700",icon:"M12 9v2m0 4h.01"},skipped:{bg:"bg-slate-50",text:"text-slate-500",icon:"M20 12H4"}}[t.status];return e.jsx("div",{className:`${a.bg} rounded-lg p-3`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${a.text}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a.icon})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${a.text}`,children:t.name}),e.jsx("p",{className:"text-xs text-slate-500",children:t.description}),t.details&&e.jsx("p",{className:"text-xs text-slate-600 mt-1",children:t.details})]})]})})},Tf=({item:t})=>{var a;const s=((a=kr.find(r=>r.id===t.platform))==null?void 0:a.name)||t.platform;return e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-800",children:s}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.isValid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.isValid?"Valid":"Invalid"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[e.jsxs("span",{children:[t.ruleCount," rules"]}),e.jsxs("span",{children:[t.issueCount," issues"]})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1 truncate font-mono",children:t.snippet}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:new Date(t.timestamp).toLocaleString()})]})},Pf=({message:t,onDismiss:s})=>{const r={success:{bg:"bg-green-50",border:"border-green-200",text:"text-green-700",icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",iconColor:"text-green-500"},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",icon:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",iconColor:"text-red-500"},warning:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700",icon:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",iconColor:"text-amber-500"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",iconColor:"text-blue-500"}}[t.type];return e.jsx("div",{className:`${r.bg} ${r.border} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:`w-6 h-6 ${r.iconColor} flex-shrink-0 mt-0.5`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:r.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-semibold ${r.text} mb-1`,children:t.title}),e.jsx("p",{className:"text-sm text-slate-600",children:t.message}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:new Date(t.timestamp).toLocaleString()}),t.actionLabel&&t.actionUrl&&e.jsxs("a",{href:t.actionUrl,className:`text-xs font-medium ${r.text} hover:underline`,children:[t.actionLabel," "]})]})]}),t.dismissible&&e.jsx("button",{onClick:s,className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},If=({practice:t})=>{const[s,a]=v.useState(!1),r={error:{bg:"bg-red-100",text:"text-red-700",badge:"bg-red-500"},warning:{bg:"bg-amber-100",text:"text-amber-700",badge:"bg-amber-500"},info:{bg:"bg-blue-100",text:"text-blue-700",badge:"bg-blue-500"}},n={syntax:{bg:"bg-purple-100",text:"text-purple-700"},security:{bg:"bg-red-100",text:"text-red-700"},best_practice:{bg:"bg-blue-100",text:"text-blue-700"},compliance:{bg:"bg-green-100",text:"text-green-700"}},i=r[t.severity],o=n[t.category];return e.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${i.badge}`}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${o.bg} ${o.text} font-medium`,children:t.category.replace("_"," ")})]}),e.jsx("h4",{className:"font-semibold text-slate-800 text-sm",children:t.title})]}),e.jsx("button",{onClick:()=>a(!s),className:"text-cyan-600 hover:text-cyan-700 ml-2",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("p",{className:"text-xs text-slate-600 mb-2",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.platforms.slice(0,3).map(l=>e.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded",children:l},l)),t.platforms.length>3&&e.jsxs("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded",children:["+",t.platforms.length-3," more"]})]})]}),s&&e.jsx("div",{className:"border-t border-slate-200 p-4 bg-slate-50",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"Bad Example:"})]}),e.jsx("pre",{className:"text-xs bg-red-50 text-red-800 p-2 rounded font-mono overflow-x-auto",children:t.examples.bad})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"Good Example:"})]}),e.jsx("pre",{className:"text-xs bg-green-50 text-green-800 p-2 rounded font-mono overflow-x-auto",children:t.examples.good})]}),e.jsx("div",{className:"pt-2 border-t border-slate-200",children:e.jsxs("p",{className:"text-xs text-slate-600",children:[e.jsx("span",{className:"font-semibold",children:"Explanation:"})," ",t.examples.explanation]})})]})})]})},Rf={totalRulesAnalyzed:8247,totalConflictsDetected:127,criticalConflicts:8,resolvedConflicts:89,policyViolations:15,averageResolutionTime:"4.2 hours",conflictsByType:{shadowing:28,redundancy:34,correlation:15,generalization:18,overlap:22,contradiction:5,policy_violation:15}},Ef=[{id:"CONFLICT-001",type:"shadowing",severity:"critical",status:"active",title:"Production Database Access Rule Completely Shadowed",description:"Critical database access rule (PROD-DB-ACCESS-001) is completely shadowed by earlier broad ANY-ANY rule, potentially blocking legitimate database traffic",detectedAt:"2024-01-19T10:23:15Z",rule1:{ruleId:"FW-PROD-001",ruleName:"Allow-Internal-Any",firewall:"PA-FW-PROD-01",zone:"trust-to-dmz",priority:100,action:"allow",source:"10.0.0.0/8",destination:"any",service:"any",enabled:!0,createdAt:"2023-08-15T09:00:00Z",lastModified:"2023-08-15T09:00:00Z",owner:"legacy-migration@company.com"},rule2:{ruleId:"FW-PROD-125",ruleName:"PROD-DB-ACCESS-001",firewall:"PA-FW-PROD-01",zone:"trust-to-dmz",priority:125,action:"allow",source:"10.50.0.0/24",destination:"172.16.10.0/24",service:"tcp/3306,tcp/5432",application:"mysql,postgresql",enabled:!0,createdAt:"2024-01-10T14:20:00Z",lastModified:"2024-01-10T14:20:00Z",owner:"database-team@company.com"},evidence:[{description:"Rule FW-PROD-001 at priority 100 matches all traffic that FW-PROD-125 at priority 125 would match",technicalDetail:"FW-PROD-001 (10.0.0.0/8  any:any) is a superset of FW-PROD-125 (10.50.0.0/24  172.16.10.0/24:tcp/3306,5432)",trafficExample:"Traffic from 10.50.0.15:54321  172.16.10.5:3306 matches FW-PROD-001 and never reaches FW-PROD-125",riskScore:95},{description:"FW-PROD-125 has never processed any traffic since creation (0 hit count)",technicalDetail:"Database team believes this rule is active, but monitoring shows zero hits in 9 days",riskScore:90},{description:"Security policy requires specific database access control with application-level inspection",technicalDetail:'FW-PROD-001 uses "any" service without application filtering, bypassing required database security controls',riskScore:88}],impact:{securityRisk:"high",performanceImpact:"low",complianceViolation:!0,affectedTraffic:"All database traffic from application tier (10.50.0.0/24) to database tier (172.16.10.0/24)",estimatedHitCount:145e3,potentialDataExposure:!0},resolutionOptions:[{id:"RES-001-A",strategy:"reorder",title:"Move Specific Rule Before Broad Rule (Recommended)",description:"Change rule priority to place FW-PROD-125 (priority 125  99) before FW-PROD-001 (priority 100)",steps:["Backup current firewall configuration","Change FW-PROD-125 priority from 125 to 99","Commit and verify rule order in policy","Monitor traffic for 24 hours to confirm expected behavior","Update documentation with new rule order"],affectedRules:["FW-PROD-001","FW-PROD-125"],automationAvailable:!0,riskLevel:"low",estimatedEffort:"30 minutes",recommendationScore:95,rollbackPlan:"Revert priority to 125 if issues detected"},{id:"RES-001-B",strategy:"modify",title:"Narrow Scope of Broad Rule",description:"Modify FW-PROD-001 to exclude database subnet (172.16.10.0/24) from destination",steps:['Create address object "DB-Exclude" for 172.16.10.0/24',"Modify FW-PROD-001 destination to exclude DB subnet","Test with non-database traffic to verify functionality","Verify FW-PROD-125 now processes database traffic","Update change management documentation"],affectedRules:["FW-PROD-001"],automationAvailable:!1,riskLevel:"medium",estimatedEffort:"1 hour",recommendationScore:78,rollbackPlan:'Restore FW-PROD-001 to original "any" destination'},{id:"RES-001-C",strategy:"remove",title:"Remove Legacy Broad Rule (High Risk)",description:"Delete FW-PROD-001 as it was a temporary migration rule from 2023",steps:["Analyze all traffic currently hitting FW-PROD-001","Create specific rules for each legitimate traffic pattern","Test new rules in staging environment","Disable (not delete) FW-PROD-001 for 7-day monitoring period","Permanently delete if no issues detected"],affectedRules:["FW-PROD-001"],automationAvailable:!1,riskLevel:"high",estimatedEffort:"4 hours",recommendationScore:65,rollbackPlan:"Re-enable FW-PROD-001 immediately if traffic breaks"}],similarConflicts:["CONFLICT-007","CONFLICT-012"],tags:["critical","shadowing","database","compliance","production"],assignedTo:"security-team@company.com"},{id:"CONFLICT-002",type:"redundancy",severity:"high",status:"active",title:"Duplicate SSH Access Rules Creating Management Overhead",description:"Three nearly identical SSH access rules exist for the same source/destination, causing unnecessary policy bloat and maintenance complexity",detectedAt:"2024-01-19T09:15:30Z",rule1:{ruleId:"FW-MGMT-042",ruleName:"SSH-Mgmt-Access-v1",firewall:"PA-FW-MGMT-01",zone:"mgmt-to-servers",priority:200,action:"allow",source:"10.100.0.0/24",destination:"10.200.0.0/16",service:"tcp/22",application:"ssh",enabled:!0,createdAt:"2023-06-12T10:00:00Z",lastModified:"2023-06-12T10:00:00Z",owner:"ops-team@company.com"},rule2:{ruleId:"FW-MGMT-087",ruleName:"SSH-Admin-Access",firewall:"PA-FW-MGMT-01",zone:"mgmt-to-servers",priority:201,action:"allow",source:"10.100.0.0/24",destination:"10.200.0.0/16",service:"tcp/22",enabled:!0,createdAt:"2023-09-23T14:30:00Z",lastModified:"2023-09-23T14:30:00Z",owner:"admin-team@company.com"},evidence:[{description:"Rules FW-MGMT-042 and FW-MGMT-087 have identical match criteria",technicalDetail:"Both rules match source 10.100.0.0/24, destination 10.200.0.0/16, service tcp/22, action allow",trafficExample:"SSH from 10.100.0.50:55123  10.200.5.10:22 matches FW-MGMT-042 and never reaches FW-MGMT-087",riskScore:45},{description:"FW-MGMT-087 has 0 hit count in past 120 days",technicalDetail:"All matching traffic is processed by FW-MGMT-042 (avg 2,340 hits/day), FW-MGMT-087 is unused",riskScore:40},{description:"Third similar rule FW-MGMT-098 also exists with 99% overlap",technicalDetail:"Total of 3 rules performing same function, increasing policy complexity",riskScore:35}],impact:{securityRisk:"low",performanceImpact:"low",complianceViolation:!1,affectedTraffic:"SSH management traffic from jump hosts to server infrastructure",estimatedHitCount:2340,potentialDataExposure:!1},resolutionOptions:[{id:"RES-002-A",strategy:"merge",title:"Consolidate All SSH Rules Into Single Rule",description:"Keep FW-MGMT-042, delete redundant FW-MGMT-087 and FW-MGMT-098",steps:["Verify FW-MGMT-042 covers all required SSH access","Update FW-MGMT-042 description to note consolidated rule","Disable FW-MGMT-087 and FW-MGMT-098 for 7-day monitoring","Permanently delete after confirmation","Update firewall documentation"],affectedRules:["FW-MGMT-042","FW-MGMT-087","FW-MGMT-098"],automationAvailable:!0,riskLevel:"low",estimatedEffort:"20 minutes",recommendationScore:92}],similarConflicts:["CONFLICT-009","CONFLICT-015"],tags:["redundancy","ssh","management","cleanup"],assignedTo:"ops-team@company.com"},{id:"CONFLICT-003",type:"contradiction",severity:"critical",status:"active",title:"Contradictory Allow/Deny Rules for Production API",description:"Critical contradiction: Rule allows API traffic (priority 150) but later rule denies same traffic (priority 180), causing intermittent access issues",detectedAt:"2024-01-19T11:45:22Z",rule1:{ruleId:"FW-API-023",ruleName:"Allow-Partner-API-Access",firewall:"PA-FW-EDGE-02",zone:"untrust-to-dmz",priority:150,action:"allow",source:"203.0.113.0/24",destination:"198.51.100.50",service:"tcp/443",application:"web-browsing,ssl",enabled:!0,createdAt:"2024-01-05T09:00:00Z",lastModified:"2024-01-05T09:00:00Z",owner:"api-team@company.com"},rule2:{ruleId:"FW-SEC-112",ruleName:"Block-Untrusted-API-Access",firewall:"PA-FW-EDGE-02",zone:"untrust-to-dmz",priority:180,action:"deny",source:"any",destination:"198.51.100.0/24",service:"tcp/443",enabled:!0,createdAt:"2024-01-12T16:30:00Z",lastModified:"2024-01-12T16:30:00Z",owner:"security-team@company.com"},evidence:[{description:"Allow rule at priority 150 is contradicted by deny rule at priority 180",technicalDetail:"Traffic from 203.0.113.0/24 matches FW-API-023 (allow) first, but FW-SEC-112 (deny) could block if source is outside partner range",trafficExample:"Traffic from 203.0.113.50:48932  198.51.100.50:443 allowed, but from 203.0.114.50 denied",riskScore:92},{description:"Partner complaints of intermittent API access failures correlate with FW-SEC-112 deployment",technicalDetail:"Support tickets increased 400% starting Jan 12 when FW-SEC-112 was added",riskScore:88},{description:"FW-SEC-112 blocks legitimate traffic when partner IPs rotate outside 203.0.113.0/24",technicalDetail:"Partner uses dynamic IP pool including 203.0.113.0/24 and 203.0.114.0/24",riskScore:85}],impact:{securityRisk:"medium",performanceImpact:"low",complianceViolation:!0,affectedTraffic:"External partner API access to production endpoints",estimatedHitCount:45e3,potentialDataExposure:!1},resolutionOptions:[{id:"RES-003-A",strategy:"modify",title:"Expand Allow Rule to Include All Partner IPs",description:"Update FW-API-023 to include 203.0.114.0/24 in source",steps:["Contact partner to confirm complete IP range",'Create address group "Partner-API-Sources"',"Add 203.0.113.0/24 and 203.0.114.0/24 to group","Update FW-API-023 source to use address group","Test with partner for 48 hours"],affectedRules:["FW-API-023"],automationAvailable:!1,riskLevel:"low",estimatedEffort:"45 minutes",recommendationScore:94},{id:"RES-003-B",strategy:"modify",title:"Modify Deny Rule to Exclude API Subnet",description:"Update FW-SEC-112 destination to exclude 198.51.100.50",steps:['Create address object "API-Servers-Exclude"',"Modify FW-SEC-112 destination to exclude API servers","Test deny rule still blocks unauthorized access","Verify partner access restored","Update security documentation"],affectedRules:["FW-SEC-112"],automationAvailable:!1,riskLevel:"medium",estimatedEffort:"1 hour",recommendationScore:82}],similarConflicts:[],tags:["critical","contradiction","api","partner","production-impact"],assignedTo:"security-team@company.com"},{id:"CONFLICT-004",type:"generalization",severity:"medium",status:"active",title:"Overly Broad Web Access Rule Can Be Optimized",description:"General web access rule matches traffic better handled by more specific rules, reducing policy effectiveness",detectedAt:"2024-01-19T08:30:45Z",rule1:{ruleId:"FW-WEB-001",ruleName:"General-Web-Access",firewall:"PA-FW-CORP-01",zone:"trust-to-untrust",priority:300,action:"allow",source:"10.0.0.0/8",destination:"any",service:"tcp/80,tcp/443",enabled:!0,createdAt:"2022-03-15T10:00:00Z",lastModified:"2022-03-15T10:00:00Z",owner:"network-team@company.com"},rule2:{ruleId:"FW-WEB-045",ruleName:"Dev-Team-Web-Access",firewall:"PA-FW-CORP-01",zone:"trust-to-untrust",priority:350,action:"allow",source:"10.50.0.0/24",destination:"any",service:"tcp/80,tcp/443",application:"web-browsing,ssl",enabled:!0,createdAt:"2023-11-20T14:00:00Z",lastModified:"2023-11-20T14:00:00Z",owner:"dev-team@company.com"},evidence:[{description:"FW-WEB-001 generalizes FW-WEB-045 by matching all sources including dev team subnet",technicalDetail:"FW-WEB-001 (10.0.0.0/8) is superset of FW-WEB-045 (10.50.0.0/24), making specific rule redundant",riskScore:55},{description:"FW-WEB-045 intended for application-level inspection never triggers",technicalDetail:"Dev team rule includes app-id filtering (web-browsing,ssl) but general rule processes traffic first",riskScore:48}],impact:{securityRisk:"medium",performanceImpact:"low",complianceViolation:!1,affectedTraffic:"General internet web access from corporate network",estimatedHitCount:125e3,potentialDataExposure:!1},resolutionOptions:[{id:"RES-004-A",strategy:"split",title:"Split General Rule to Exclude Specific Subnets",description:"Create exception in FW-WEB-001 for subnets with specific rules",steps:['Create address group "Web-Specific-Subnets"',"Add 10.50.0.0/24 and other specific subnets to group","Modify FW-WEB-001 source to exclude specific subnets","Verify specific rules now process their designated traffic"],affectedRules:["FW-WEB-001","FW-WEB-045"],automationAvailable:!1,riskLevel:"low",estimatedEffort:"45 minutes",recommendationScore:75}],similarConflicts:["CONFLICT-011","CONFLICT-018"],tags:["generalization","web-access","optimization"]}],Lf=[{id:"VIOLATION-001",policyName:"Database Access Control Policy",violationType:"Missing Application Filtering",severity:"high",description:"Database access rules must use application-level filtering (App-ID) to enforce protocol compliance",violatingRules:[{ruleId:"FW-PROD-001",ruleName:"Allow-Internal-Any",firewall:"PA-FW-PROD-01",zone:"trust-to-dmz",priority:100,action:"allow",source:"10.0.0.0/8",destination:"any",service:"any",enabled:!0,createdAt:"2023-08-15T09:00:00Z",lastModified:"2023-08-15T09:00:00Z",owner:"legacy-migration@company.com"}],policyRequirement:"All database traffic must specify application (mysql, postgresql, mssql-db) for deep packet inspection",detectedAt:"2024-01-19T10:23:15Z",complianceFramework:["PCI-DSS 1.2.1","SOC2 CC6.6"],remediationRequired:!0},{id:"VIOLATION-002",policyName:"Default Deny Policy",violationType:"Any-Any Allow Rule",severity:"critical",description:'Explicit "any-any-allow" rules violate zero trust security model and must be removed',violatingRules:[{ruleId:"FW-PROD-001",ruleName:"Allow-Internal-Any",firewall:"PA-FW-PROD-01",zone:"trust-to-dmz",priority:100,action:"allow",source:"10.0.0.0/8",destination:"any",service:"any",enabled:!0,createdAt:"2023-08-15T09:00:00Z",lastModified:"2023-08-15T09:00:00Z",owner:"legacy-migration@company.com"}],policyRequirement:'All rules must specify explicit source, destination, and service - no "any" values allowed',detectedAt:"2024-01-19T10:23:15Z",complianceFramework:["NIST 800-53 SC-7","CIS Benchmark 1.1.4"],remediationRequired:!0},{id:"VIOLATION-003",policyName:"Change Management Policy",violationType:"Untracked Rule Modification",severity:"medium",description:"Firewall rule modifications must reference change ticket, but no ticket found",violatingRules:[{ruleId:"FW-SEC-112",ruleName:"Block-Untrusted-API-Access",firewall:"PA-FW-EDGE-02",zone:"untrust-to-dmz",priority:180,action:"deny",source:"any",destination:"198.51.100.0/24",service:"tcp/443",enabled:!0,createdAt:"2024-01-12T16:30:00Z",lastModified:"2024-01-12T16:30:00Z",owner:"security-team@company.com"}],policyRequirement:"All firewall changes must include change ticket number in rule description",detectedAt:"2024-01-19T11:45:22Z",complianceFramework:["ITIL Change Management"],remediationRequired:!1}],Of=[{firewall:"PA-FW-PROD-01",totalRules:847,conflictingRules:23,shadowedRules:8,redundantRules:12,unusedRules:34,healthScore:87},{firewall:"PA-FW-EDGE-02",totalRules:623,conflictingRules:15,shadowedRules:5,redundantRules:7,unusedRules:28,healthScore:91},{firewall:"PA-FW-CORP-01",totalRules:1245,conflictingRules:38,shadowedRules:12,redundantRules:18,unusedRules:67,healthScore:82},{firewall:"PA-FW-MGMT-01",totalRules:345,conflictingRules:9,shadowedRules:3,redundantRules:5,unusedRules:15,healthScore:94},{firewall:"ASA-FW-DC1",totalRules:2134,conflictingRules:67,shadowedRules:24,redundantRules:31,unusedRules:189,healthScore:68},{firewall:"ASA-FW-DC2",totalRules:2087,conflictingRules:62,shadowedRules:21,redundantRules:28,unusedRules:175,healthScore:71}],Df={conflicts:Ef,policyViolations:Lf,metrics:Rf,firewallStats:Of},Mf=()=>{const{conflicts:t,policyViolations:s,metrics:a,firewallStats:r}=Df,[n,i]=v.useState(null),[o,l]=v.useState("all"),[c,d]=v.useState("all"),[h,u]=v.useState("all"),x=t.filter(p=>!(o!=="all"&&p.type!==o||c!=="all"&&p.severity!==c||h!=="all"&&p.status!==h)),_=p=>{switch(p){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";case"info":return"bg-slate-500"}},b=p=>{switch(p){case"critical":return"error";case"high":return"warning";case"medium":return"warning";case"low":return"info";case"info":return"default"}},m=p=>{switch(p){case"shadowing":return"text-red-400";case"redundancy":return"text-yellow-400";case"contradiction":return"text-red-400";case"generalization":return"text-orange-400";case"overlap":return"text-yellow-400";case"correlation":return"text-blue-400";case"policy_violation":return"text-purple-400"}},T=p=>{switch(p){case"active":return"text-red-400";case"resolved":return"text-green-400";case"ignored":return"text-slate-400";case"false_positive":return"text-yellow-400"}};return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Conflict Detection Engine"}),e.jsx("p",{className:"text-slate-400",children:"AI-powered firewall rule conflict analysis and policy violation detection"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6",children:[e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:a.totalRulesAnalyzed.toLocaleString()}),e.jsx("div",{className:"text-xs text-slate-400",children:"Rules Analyzed"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400 mb-1",children:a.totalConflictsDetected}),e.jsx("div",{className:"text-xs text-slate-400",children:"Conflicts Found"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-400 mb-1",children:a.criticalConflicts}),e.jsx("div",{className:"text-xs text-slate-400",children:"Critical"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-emerald-400 mb-1",children:a.resolvedConflicts}),e.jsx("div",{className:"text-xs text-slate-400",children:"Resolved"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-400 mb-1",children:a.policyViolations}),e.jsx("div",{className:"text-xs text-slate-400",children:"Policy Violations"})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-cyan-400 mb-1",children:a.averageResolutionTime}),e.jsx("div",{className:"text-xs text-slate-400",children:"Avg Resolution"})]})})]}),e.jsxs(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Conflicts by Type"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:Object.entries(a.conflictsByType).map(([p,g])=>e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:g}),e.jsx("div",{className:"text-xs text-slate-400 capitalize",children:p.replace("_"," ")})]},p))})]}),e.jsxs(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Firewall Health Scores"}),e.jsx("div",{className:"space-y-3",children:r.map(p=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-semibold",children:p.firewall}),e.jsxs("span",{className:"text-slate-400 text-sm ml-3",children:[p.totalRules," rules"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-2xl font-bold ${p.healthScore>=90?"text-emerald-400":p.healthScore>=75?"text-yellow-400":"text-red-400"}`,children:p.healthScore}),e.jsx("div",{className:"text-xs text-slate-400",children:"Health Score"})]})})]}),e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:["Conflicts: ",e.jsx("span",{className:"text-orange-400 font-semibold",children:p.conflictingRules})]}),e.jsxs("span",{className:"text-slate-400",children:["Shadowed: ",e.jsx("span",{className:"text-red-400 font-semibold",children:p.shadowedRules})]}),e.jsxs("span",{className:"text-slate-400",children:["Redundant: ",e.jsx("span",{className:"text-yellow-400 font-semibold",children:p.redundantRules})]}),e.jsxs("span",{className:"text-slate-400",children:["Unused: ",e.jsx("span",{className:"text-slate-500 font-semibold",children:p.unusedRules})]})]})]},p.firewall))})]}),s.length>0&&e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Policy Violations"}),e.jsx("div",{className:"space-y-3",children:s.map(p=>e.jsxs("div",{className:"bg-purple-900/20 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(F,{variant:b(p.severity),children:p.severity.toUpperCase()}),e.jsx("span",{className:"font-mono text-xs text-slate-400",children:p.id}),p.remediationRequired&&e.jsx(F,{variant:"error",className:"text-xs",children:"REMEDIATION REQUIRED"})]}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:p.policyName}),e.jsx("p",{className:"text-sm text-slate-300 mb-2",children:p.description})]})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"text-slate-400",children:["Violation Type: ",e.jsx("span",{className:"text-orange-400",children:p.violationType})]}),e.jsxs("div",{className:"text-slate-400",children:["Policy Requirement: ",e.jsx("span",{className:"text-slate-300",children:p.policyRequirement})]}),p.complianceFramework&&e.jsxs("div",{className:"text-slate-400",children:["Compliance: ",p.complianceFramework.map((g,f)=>e.jsx(F,{variant:"info",className:"ml-2 text-xs",children:g},f))]}),e.jsxs("div",{className:"text-slate-400",children:["Violating Rules: ",e.jsx("span",{className:"text-red-400 font-semibold",children:p.violatingRules.length})]})]})]},p.id))})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700 mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Type Filter"}),e.jsxs("select",{value:o,onChange:p=>l(p.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"shadowing",children:"Shadowing"}),e.jsx("option",{value:"redundancy",children:"Redundancy"}),e.jsx("option",{value:"contradiction",children:"Contradiction"}),e.jsx("option",{value:"generalization",children:"Generalization"}),e.jsx("option",{value:"overlap",children:"Overlap"}),e.jsx("option",{value:"correlation",children:"Correlation"}),e.jsx("option",{value:"policy_violation",children:"Policy Violation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Severity Filter"}),e.jsxs("select",{value:c,onChange:p=>d(p.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Severity"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 mb-2 block",children:"Status Filter"}),e.jsxs("select",{value:h,onChange:p=>u(p.target.value),className:"bg-slate-900 text-white px-4 py-2 rounded-lg border border-slate-700 focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"ignored",children:"Ignored"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]})]}),e.jsx("div",{className:"ml-auto",children:e.jsxs("div",{className:"text-sm text-slate-400",children:["Showing ",x.length," of ",t.length," conflicts"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Detected Conflicts"}),x.map(p=>e.jsx(y,{className:`bg-slate-800/50 border-slate-700 cursor-pointer transition-all hover:border-cyan-500 ${(n==null?void 0:n.id)===p.id?"border-cyan-500 ring-2 ring-cyan-500/50":""}`,onClick:()=>i(p),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_(p.severity)} animate-pulse`}),e.jsx("span",{className:"text-xs font-mono text-slate-400",children:p.id})]}),e.jsx(F,{variant:b(p.severity),children:p.severity.toUpperCase()})]}),e.jsx("h3",{className:"text-white font-semibold text-sm leading-tight",children:p.title}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:`font-semibold capitalize ${m(p.type)}`,children:p.type.replace("_"," ")}),e.jsx("span",{className:`font-semibold ${T(p.status)}`,children:p.status.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[p.rule1.firewall,"  ",p.resolutionOptions.length," solutions"]})]})},p.id))]}),e.jsx("div",{className:"lg:col-span-2",children:n?e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{className:`border-2 ${n.severity==="critical"?"border-red-500/50 bg-red-600/10":n.severity==="high"?"border-orange-500/50 bg-orange-600/10":"border-yellow-500/50 bg-yellow-600/10"}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(F,{variant:b(n.severity),children:n.severity.toUpperCase()}),e.jsx("span",{className:"font-mono text-sm text-slate-400",children:n.id}),e.jsx(F,{variant:"info",className:"capitalize",children:n.type.replace("_"," ")}),e.jsx("span",{className:`text-sm font-semibold ${T(n.status)}`,children:n.status.replace("_"," ").toUpperCase()})]}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:n.title}),e.jsx("p",{className:"text-slate-300",children:n.description})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 pt-4 border-t border-slate-700",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Security Risk"}),e.jsx("div",{className:`text-lg font-bold ${n.impact.securityRisk==="high"?"text-red-400":n.impact.securityRisk==="medium"?"text-yellow-400":"text-emerald-400"}`,children:n.impact.securityRisk.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Daily Traffic"}),e.jsx("div",{className:"text-lg font-bold text-white",children:n.impact.estimatedHitCount.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Compliance"}),e.jsx("div",{className:`text-lg font-bold ${n.impact.complianceViolation?"text-red-400":"text-emerald-400"}`,children:n.impact.complianceViolation?"VIOLATED":"OK"})]})]})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Conflicting Rules"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(F,{variant:"error",children:"RULE 1"}),e.jsx("span",{className:"font-mono text-sm text-slate-400",children:n.rule1.ruleId}),e.jsx(F,{variant:n.rule1.action==="allow"?"success":"error",className:"text-xs",children:n.rule1.action.toUpperCase()})]}),e.jsx("h4",{className:"text-white font-semibold",children:n.rule1.ruleName})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-cyan-400 font-semibold",children:["Priority ",n.rule1.priority]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Firewall:"}),e.jsx("span",{className:"text-white ml-2",children:n.rule1.firewall})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Zone:"}),e.jsx("span",{className:"text-white ml-2",children:n.rule1.zone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Source:"}),e.jsx("span",{className:"text-cyan-400 ml-2",children:n.rule1.source})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Destination:"}),e.jsx("span",{className:"text-cyan-400 ml-2",children:n.rule1.destination})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Service:"}),e.jsx("span",{className:"text-cyan-400 ml-2",children:n.rule1.service})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Owner:"}),e.jsx("span",{className:"text-white ml-2",children:n.rule1.owner})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-orange-500/30",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(F,{variant:"warning",children:"RULE 2"}),e.jsx("span",{className:"font-mono text-sm text-slate-400",children:n.rule2.ruleId}),e.jsx(F,{variant:n.rule2.action==="allow"?"success":"error",className:"text-xs",children:n.rule2.action.toUpperCase()})]}),e.jsx("h4",{className:"text-white font-semibold",children:n.rule2.ruleName})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-cyan-400 font-semibold",children:["Priority ",n.rule2.priority]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Firewall:"}),e.jsx("span",{className:"text-white ml-2",children:n.rule2.firewall})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Zone:"}),e.jsx("span",{className:"text-white ml-2",children:n.rule2.zone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Source:"}),e.jsx("span",{className:"text-cyan-400 ml-2",children:n.rule2.source})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Destination:"}),e.jsx("span",{className:"text-cyan-400 ml-2",children:n.rule2.destination})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Service:"}),e.jsx("span",{className:"text-cyan-400 ml-2",children:n.rule2.service})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Owner:"}),e.jsx("span",{className:"text-white ml-2",children:n.rule2.owner})]})]})]})]})]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Evidence"}),n.evidence.map((p,g)=>e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-4 border border-cyan-500/30",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"text-white font-semibold text-sm",children:p.description}),e.jsxs(F,{variant:"info",className:"text-xs",children:["Risk: ",p.riskScore,"/100"]})]}),e.jsx("p",{className:"text-sm text-slate-300 mb-2",children:p.technicalDetail}),p.trafficExample&&e.jsxs("div",{className:"text-xs text-slate-400 bg-slate-950/50 rounded p-2",children:[e.jsx("span",{className:"text-cyan-400",children:"Example:"})," ",p.trafficExample]})]},g))]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Resolution Options"}),n.resolutionOptions.map(p=>e.jsxs("div",{className:"bg-emerald-900/20 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(F,{variant:"success",className:"capitalize",children:p.strategy}),e.jsxs("span",{className:"text-xs text-slate-400",children:["Score: ",p.recommendationScore,"/100"]}),p.automationAvailable&&e.jsx(F,{variant:"info",className:"text-xs",children:"AUTO"})]}),e.jsx("h4",{className:"text-white font-bold mb-1",children:p.title}),e.jsx("p",{className:"text-sm text-slate-300 mb-3",children:p.description})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:["Effort: ",e.jsx("span",{className:"text-white",children:p.estimatedEffort})]}),e.jsxs("span",{className:"text-slate-400",children:["Risk: ",e.jsx("span",{className:p.riskLevel==="low"?"text-green-400":p.riskLevel==="medium"?"text-yellow-400":"text-red-400",children:p.riskLevel.toUpperCase()})]}),e.jsxs("span",{className:"text-slate-400",children:["Affected Rules: ",e.jsx("span",{className:"text-cyan-400",children:p.affectedRules.length})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-300 mb-1",children:"Implementation Steps:"}),e.jsx("ol",{className:"space-y-1",children:p.steps.map((g,f)=>e.jsxs("li",{className:"text-xs text-slate-300 flex items-start gap-2",children:[e.jsxs("span",{className:"text-cyan-400 mt-0.5",children:[f+1,"."]}),e.jsx("span",{children:g})]},f))})]}),p.rollbackPlan&&e.jsxs("div",{className:"text-xs text-slate-400 bg-slate-950/50 rounded p-2",children:[e.jsx("span",{className:"text-yellow-400",children:"Rollback Plan:"})," ",p.rollbackPlan]})]})]},p.id))]})}),e.jsx(y,{className:"bg-slate-800/50 border-slate-700",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:" Impact Analysis"}),e.jsx("div",{className:"bg-slate-900/50 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Security Risk:"}),e.jsx("span",{className:`font-semibold ${n.impact.securityRisk==="high"?"text-red-400":n.impact.securityRisk==="medium"?"text-yellow-400":"text-emerald-400"}`,children:n.impact.securityRisk.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Performance Impact:"}),e.jsx("span",{className:"text-white",children:n.impact.performanceImpact.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Compliance Violation:"}),e.jsx("span",{className:n.impact.complianceViolation?"text-red-400":"text-emerald-400",children:n.impact.complianceViolation?"YES":"NO"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Potential Data Exposure:"}),e.jsx("span",{className:n.impact.potentialDataExposure?"text-red-400":"text-emerald-400",children:n.impact.potentialDataExposure?"YES":"NO"})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-700",children:[e.jsx("span",{className:"text-slate-400",children:"Affected Traffic:"}),e.jsx("p",{className:"text-white mt-1",children:n.impact.affectedTraffic})]})]})})]})})]}):e.jsx(y,{className:"bg-slate-800/50 border-slate-700 h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Select a Conflict"}),e.jsx("p",{className:"text-slate-400",children:"Click on a conflict from the list to view detailed analysis and resolution options"})]})})})]})]})},Ff=()=>{const[t,s]=v.useState(null),[a,r]=v.useState([]),[n,i]=v.useState("cloud"),[o,l]=v.useState(!0),[c,d]=v.useState(null),[h,u]=v.useState(null),[x,_]=v.useState(null),b=v.useCallback(async()=>{try{l(!0),d(null);const P=await Ae.getSettings();s(P)}catch(P){d(P instanceof Error?P.message:"Failed to load settings")}finally{l(!1)}},[]);v.useEffect(()=>{b()},[b]);const m=v.useCallback(async P=>{u(P),_(null);try{const w=await Ae.testCloudConnection(P);_(w)}catch(w){_({success:!1,message:w instanceof Error?w.message:"Test failed"})}finally{u(null)}},[]),T=v.useCallback(async(P,w)=>{try{const R=await Ae.updateCloudConnection(P,w);s(V=>V&&{...V,cloudConnections:V.cloudConnections.map(he=>he.id===P?R:he)})}catch(R){d(R instanceof Error?R.message:"Failed to update connection")}},[]),p=v.useCallback(async P=>{try{const w=await Ae.addCloudConnection(P);s(R=>R&&{...R,cloudConnections:[...R.cloudConnections,w]})}catch(w){d(w instanceof Error?w.message:"Failed to add connection")}},[]),g=v.useCallback(async P=>{try{await Ae.deleteCloudConnection(P),s(w=>w&&{...w,cloudConnections:w.cloudConnections.filter(R=>R.id!==P)})}catch(w){d(w instanceof Error?w.message:"Failed to delete connection")}},[]),f=v.useCallback(async P=>{try{const w=await Ae.updateServiceNowConfig(P);s(R=>R&&{...R,serviceNow:w})}catch(w){d(w instanceof Error?w.message:"Failed to update ServiceNow config")}},[]),j=v.useCallback(async()=>{u("servicenow"),_(null);try{const P=await Ae.testServiceNowConnection();_(P)}catch(P){_({success:!1,message:P instanceof Error?P.message:"Test failed"})}finally{u(null)}},[]),N=v.useCallback(async P=>{try{const w=await Ae.updateSIEMConfig(P);s(R=>R&&{...R,siem:w})}catch(w){d(w instanceof Error?w.message:"Failed to update SIEM config")}},[]),S=v.useCallback(async P=>{try{const w=await Ae.updateAPMConfig(P);s(R=>R&&{...R,apm:w})}catch(w){d(w instanceof Error?w.message:"Failed to update APM config")}},[]),A=v.useCallback(async P=>{try{const w=await Ae.addUser(P);s(R=>R&&{...R,users:[...R.users,w]})}catch(w){d(w instanceof Error?w.message:"Failed to add user")}},[]),k=v.useCallback(async(P,w)=>{try{const R=await Ae.updateUser(P,w);s(V=>V&&{...V,users:V.users.map(he=>he.id===P?R:he)})}catch(R){d(R instanceof Error?R.message:"Failed to update user")}},[]),I=v.useCallback(async P=>{try{await Ae.deleteUser(P),s(w=>w&&{...w,users:w.users.filter(R=>R.id!==P)})}catch(w){d(w instanceof Error?w.message:"Failed to delete user")}},[]),E=v.useCallback(async P=>{try{const w=await Ae.updateNotificationPreferences(P);s(R=>R&&{...R,notifications:w})}catch(w){d(w instanceof Error?w.message:"Failed to update notification preferences")}},[]),W=v.useCallback(async P=>{try{const w=await Ae.getAuditLogs(P);r(w)}catch(w){d(w instanceof Error?w.message:"Failed to load audit logs")}},[]),Z=v.useCallback(()=>{_(null)},[]);return{settings:t,auditLogs:a,activeTab:n,isLoading:o,error:c,testingConnection:h,testResult:x,setActiveTab:i,testCloudConnection:m,updateCloudConnection:T,addCloudConnection:p,deleteCloudConnection:g,updateServiceNowConfig:f,testServiceNowConnection:j,updateSIEMConfig:N,updateAPMConfig:S,addUser:A,updateUser:k,deleteUser:I,updateNotificationPreferences:E,loadAuditLogs:W,clearTestResult:Z,refreshSettings:b}},Gf=[{id:"cloud",label:"Cloud Connections",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})},{id:"servicenow",label:"ServiceNow",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})},{id:"siem",label:"SIEM",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},{id:"apm",label:"APM",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"users",label:"Users",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{id:"notifications",label:"Notifications",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})},{id:"audit",label:"Audit Logs",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}],Vf=({activeTab:t,onTabChange:s})=>e.jsx("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-2",children:e.jsx("nav",{className:"flex flex-col gap-1",children:Gf.map(a=>{const r=t===a.id;return e.jsxs("button",{onClick:()=>s(a.id),className:`flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-all ${r?"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 text-cyan-400 border border-cyan-500/30":"text-slate-400 hover:bg-slate-700/50 hover:text-white"}`,children:[a.icon,e.jsx("span",{className:"font-medium",children:a.label})]},a.id)})})}),Uf={aws:{name:"AWS",color:"from-orange-500 to-orange-600",icon:e.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 01-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 01-.287-.375 6.18 6.18 0 01-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 01-.28.104.488.488 0 01-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 01.224-.167c.279-.144.614-.264 1.005-.36a4.84 4.84 0 011.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 00-.735-.136 6.02 6.02 0 00-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 01-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 01.32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 01.311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 01-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 01-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 01-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 00.415-.758.777.777 0 00-.215-.559c-.144-.151-.415-.287-.806-.407l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 01-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 01.24.2.43.43 0 01.071.263v.375c0 .168-.064.256-.184.256a.83.83 0 01-.303-.096 3.652 3.652 0 00-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167z"})})},azure:{name:"Azure",color:"from-blue-500 to-blue-600",icon:e.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M5.483 21.3H24L14.025 4.013l-3.038 8.347 5.836 6.938L5.483 21.3zM13.23 2.7L6.105 8.677 0 19.253h5.505l7.725-16.553z"})})},gcp:{name:"GCP",color:"from-red-500 to-yellow-500",icon:e.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12.19 2.38a9.344 9.344 0 00-9.234 6.893c.053-.02-.055.013 0 0-3.875 2.551-3.922 8.11-.247 10.941l.006-.007-.007.03a6.717 6.717 0 006.212 3.76h10.39c2.51-.034 4.659-1.9 5.42-4.287a5.91 5.91 0 00-.49-4.643 5.906 5.906 0 00-3.83-2.799l-.006-.004-.001-.009A9.34 9.34 0 0012.19 2.38zm-.358 4.146c1.244-.04 2.518.368 3.486 1.15a5.186 5.186 0 011.862 4.078v.518c3.53-.07 3.53 5.262 0 5.193h-5.193v-.518c-1.243.04-2.517-.368-3.485-1.15a5.186 5.186 0 01-1.863-4.078v-.518c-3.53.07-3.53-5.262 0-5.193h5.193v.518z"})})},onprem:{name:"On-Premises",color:"from-slate-500 to-slate-600",icon:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})})}},Hf={connected:{label:"Connected",variant:"success"},disconnected:{label:"Disconnected",variant:"default"},error:{label:"Error",variant:"error"},pending:{label:"Pending",variant:"warning"}},Wf=({connections:t,testingConnection:s,testResult:a,onTestConnection:r,onAddConnection:n,onDeleteConnection:i,onClearTestResult:o})=>{const[l,c]=v.useState(null),d=h=>h?new Date(h).toLocaleString():"Never";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Cloud Connections"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Manage connections to AWS, Azure, GCP, and On-Premises infrastructure"})]}),e.jsxs(D,{variant:"primary",size:"md",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Connection"]})]}),a&&e.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between ${a.success?"bg-emerald-500/20 border border-emerald-500/30":"bg-red-500/20 border border-red-500/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.success?e.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:a.success?"text-emerald-400":"text-red-400",children:a.message})]}),e.jsx("button",{onClick:o,className:"text-slate-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"grid gap-4",children:t.map(h=>{const u=Uf[h.provider],x=Hf[h.status],_=l===h.id,b=s===h.id;return e.jsxs(y,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>c(_?null:h.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${u.color} flex items-center justify-center text-white`,children:u.icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-bold text-white",children:h.name}),e.jsx(F,{variant:x.variant,size:"sm",children:x.label})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[u.name," ",h.region&&`- ${h.region}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{variant:"secondary",size:"sm",isLoading:b,onClick:m=>{m.stopPropagation(),r(h.id)},children:"Test Connection"}),e.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${_?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),_&&e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-slate-700",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Account/Project ID"}),e.jsx("p",{className:"text-sm text-slate-300 font-mono",children:h.accountId||h.subscriptionId||h.projectId||h.datacenterName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Last Sync"}),e.jsx("p",{className:"text-sm text-slate-300",children:d(h.lastSync)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Credentials Type"}),e.jsx("p",{className:"text-sm text-slate-300 capitalize",children:h.credentials.type.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Credentials Status"}),e.jsx(F,{variant:h.credentials.configured?"success":"warning",size:"sm",children:h.credentials.configured?"Configured":"Not Configured"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"ghost",size:"sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),e.jsxs(D,{variant:"ghost",size:"sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sync Now"]}),e.jsxs(D,{variant:"danger",size:"sm",onClick:m=>{m.stopPropagation(),i(h.id)},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})]},h.id)})})]})},zf=({config:t,testingConnection:s,testResult:a,onUpdate:r,onTestConnection:n,onClearTestResult:i})=>{const[o,l]=v.useState(!1),[c,d]=v.useState(t),h=()=>{r(c),l(!1)},u=()=>{d(t),l(!1)},x=s==="servicenow";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"ServiceNow Integration"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Configure ServiceNow ITSM integration for ticket management"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(F,{variant:t.isConfigured?"success":"warning",size:"lg",children:t.isConfigured?"Configured":"Not Configured"})})]}),a&&e.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between ${a.success?"bg-emerald-500/20 border border-emerald-500/30":"bg-red-500/20 border border-red-500/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.success?e.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:a.success?"text-emerald-400":"text-red-400",children:a.message})]}),e.jsx("button",{onClick:i,className:"text-slate-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Connection Settings",action:!o&&e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>l(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Instance URL"}),o?e.jsx("input",{type:"url",value:c.instanceUrl,onChange:_=>d({...c,instanceUrl:_.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://your-instance.service-now.com"}):e.jsx("p",{className:"text-white font-mono",children:t.instanceUrl})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Username"}),o?e.jsx("input",{type:"text",value:c.username,onChange:_=>d({...c,username:_.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"}):e.jsx("p",{className:"text-white font-mono",children:t.username})]})]}),o&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Password"}),e.jsx("input",{type:"password",placeholder:"Enter new password to change",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),o&&e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(D,{variant:"primary",size:"sm",onClick:h,children:"Save Changes"}),e.jsx(D,{variant:"ghost",size:"sm",onClick:u,children:"Cancel"})]}),!o&&e.jsx(D,{variant:"secondary",size:"sm",isLoading:x,onClick:n,children:"Test Connection"})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Ticket Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Auto-Create Tickets"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Automatically create tickets for critical alerts"})]}),e.jsx("button",{onClick:()=>r({autoCreateTickets:!t.autoCreateTickets}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.autoCreateTickets?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.autoCreateTickets?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Default Assignment Group"}),e.jsxs("select",{value:t.defaultAssignmentGroup,onChange:_=>r({defaultAssignmentGroup:_.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"Network Operations",children:"Network Operations"}),e.jsx("option",{value:"Security Operations",children:"Security Operations"}),e.jsx("option",{value:"Cloud Infrastructure",children:"Cloud Infrastructure"}),e.jsx("option",{value:"Application Support",children:"Application Support"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Default Priority"}),e.jsxs("select",{value:t.defaultPriority,onChange:_=>r({defaultPriority:_.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Sync Interval (minutes)"}),e.jsx("input",{type:"number",min:"1",max:"60",value:t.syncInterval,onChange:_=>r({syncInterval:parseInt(_.target.value,10)}),className:"w-32 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]})]})]})},$f=[{value:"splunk",label:"Splunk",icon:"S"},{value:"qradar",label:"IBM QRadar",icon:"Q"},{value:"sentinel",label:"Microsoft Sentinel",icon:"M"},{value:"elastic",label:"Elastic Security",icon:"E"},{value:"none",label:"None",icon:"-"}],Bf=({config:t,onUpdate:s})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"SIEM Integration"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Configure Security Information and Event Management integration"})]}),e.jsx(F,{variant:t.isConfigured?"success":"warning",size:"lg",children:t.isConfigured?"Configured":"Not Configured"})]}),e.jsxs(y,{children:[e.jsx(B,{title:"SIEM Platform"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:$f.map(a=>e.jsxs("button",{onClick:()=>s({type:a.value}),className:`p-4 rounded-lg border-2 transition-all ${t.type===a.value?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[e.jsx("div",{className:`w-10 h-10 mx-auto mb-2 rounded-lg flex items-center justify-center text-lg font-bold ${t.type===a.value?"bg-cyan-500 text-white":"bg-slate-700 text-slate-400"}`,children:a.icon}),e.jsx("p",{className:`text-sm font-medium text-center ${t.type===a.value?"text-cyan-400":"text-slate-400"}`,children:a.label})]},a.value))})]}),t.type!=="none"&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx(B,{title:"Connection Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Endpoint"}),e.jsx("input",{type:"url",value:t.endpoint,onChange:a=>s({endpoint:a.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://your-siem.example.com:8089"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Key / Token"}),e.jsx("input",{type:"password",placeholder:"Enter API key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Index / Data Source"}),e.jsx("input",{type:"text",placeholder:"main",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),e.jsx(D,{variant:"secondary",size:"sm",children:"Test Connection"})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Data Forwarding"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Forward Alerts"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Send security alerts to SIEM platform"})]}),e.jsx("button",{onClick:()=>s({forwardAlerts:!t.forwardAlerts}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.forwardAlerts?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.forwardAlerts?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Forward Logs"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Send audit and system logs to SIEM"})]}),e.jsx("button",{onClick:()=>s({forwardLogs:!t.forwardLogs}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.forwardLogs?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.forwardLogs?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Alert Severity Threshold"}),e.jsxs("select",{value:t.alertSeverityThreshold,onChange:a=>s({alertSeverityThreshold:a.target.value}),className:"w-48 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"low",children:"Low and above"}),e.jsx("option",{value:"medium",children:"Medium and above"}),e.jsx("option",{value:"high",children:"High and above"}),e.jsx("option",{value:"critical",children:"Critical only"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Only forward alerts at or above this severity"})]})]})]})]})]}),Zf=[{value:"datadog",label:"Datadog",color:"from-purple-500 to-purple-600"},{value:"newrelic",label:"New Relic",color:"from-teal-500 to-teal-600"},{value:"dynatrace",label:"Dynatrace",color:"from-blue-500 to-blue-600"},{value:"appdynamics",label:"AppDynamics",color:"from-cyan-500 to-cyan-600"},{value:"none",label:"None",color:"from-slate-500 to-slate-600"}],qf=({config:t,onUpdate:s})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"APM Integration"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Configure Application Performance Monitoring integration"})]}),e.jsx(F,{variant:t.isConfigured?"success":"warning",size:"lg",children:t.isConfigured?"Configured":"Not Configured"})]}),e.jsxs(y,{children:[e.jsx(B,{title:"APM Platform"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:Zf.map(a=>e.jsxs("button",{onClick:()=>s({type:a.value}),className:`p-4 rounded-lg border-2 transition-all ${t.type===a.value?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[e.jsx("div",{className:`w-10 h-10 mx-auto mb-2 rounded-lg bg-gradient-to-br ${a.color} flex items-center justify-center text-white font-bold`,children:a.label.charAt(0)}),e.jsx("p",{className:`text-sm font-medium text-center ${t.type===a.value?"text-cyan-400":"text-slate-400"}`,children:a.label})]},a.value))})]}),t.type!=="none"&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx(B,{title:"Connection Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Endpoint"}),e.jsx("input",{type:"url",value:t.apiEndpoint,onChange:a=>s({apiEndpoint:a.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://api.datadoghq.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Key"}),e.jsx("input",{type:"password",placeholder:"Enter API key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Application Key"}),e.jsx("input",{type:"password",placeholder:"Enter application key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),e.jsx(D,{variant:"secondary",size:"sm",children:"Test Connection"})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Data Collection"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Collect Metrics"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Import application metrics from APM platform"})]}),e.jsx("button",{onClick:()=>s({collectMetrics:!t.collectMetrics}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.collectMetrics?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.collectMetrics?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Collect Traces"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Import distributed traces for path analysis"})]}),e.jsx("button",{onClick:()=>s({collectTraces:!t.collectTraces}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.collectTraces?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.collectTraces?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Sample Rate"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:t.sampleRate,onChange:a=>s({sampleRate:parseFloat(a.target.value)}),className:"flex-1 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),e.jsxs("span",{className:"text-white font-mono w-16 text-right",children:[(t.sampleRate*100).toFixed(0),"%"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Percentage of traces to collect. Lower values reduce overhead."})]})]})]})]})]}),Kt={admin:{label:"Administrator",color:"bg-purple-500/20 text-purple-400",description:"Full access to all features and settings"},operator:{label:"Operator",color:"bg-blue-500/20 text-blue-400",description:"Can manage rules and view all dashboards"},viewer:{label:"Viewer",color:"bg-slate-500/20 text-slate-400",description:"Read-only access to dashboards"},auditor:{label:"Auditor",color:"bg-amber-500/20 text-amber-400",description:"Can view audit logs and export reports"}},Y0={admin:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!0,canModifySettings:!0,canViewAuditLogs:!0,canManageUsers:!0,canExportData:!0},operator:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!0},viewer:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!1},auditor:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!0,canManageUsers:!1,canExportData:!0}},Kf=({onClose:t,onAdd:s})=>{const[a,r]=v.useState({email:"",name:"",role:"viewer"}),n=i=>{i.preventDefault(),s({...a,status:"pending",permissions:Y0[a.role]}),t()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Add New User"}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:a.email,onChange:i=>r({...a,email:i.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"user@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",required:!0,value:a.name,onChange:i=>r({...a,name:i.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Role"}),e.jsx("select",{value:a.role,onChange:i=>r({...a,role:i.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:Object.entries(Kt).map(([i,{label:o}])=>e.jsx("option",{value:i,children:o},i))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:Kt[a.role].description})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(D,{type:"submit",variant:"primary",children:"Add User"}),e.jsx(D,{type:"button",variant:"ghost",onClick:t,children:"Cancel"})]})]})]})})},Qf=({users:t,onAddUser:s,onUpdateUser:a,onDeleteUser:r})=>{const[n,i]=v.useState(!1),[o,l]=v.useState(null),c=h=>h?new Date(h).toLocaleString():"Never",d=o?t.find(h=>h.id===o):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"User Management"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Manage user accounts and permissions"})]}),e.jsxs(D,{variant:"primary",onClick:()=>i(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Role Permissions Matrix"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-left py-2 px-3 text-slate-400 font-medium",children:"Permission"}),Object.entries(Kt).map(([h,{label:u}])=>e.jsx("th",{className:"text-center py-2 px-3 text-slate-400 font-medium",children:u},h))]})}),e.jsx("tbody",{children:[{key:"canViewDashboard",label:"View Dashboards"},{key:"canManageRules",label:"Manage Rules"},{key:"canApproveTickets",label:"Approve Tickets"},{key:"canModifySettings",label:"Modify Settings"},{key:"canViewAuditLogs",label:"View Audit Logs"},{key:"canManageUsers",label:"Manage Users"},{key:"canExportData",label:"Export Data"}].map(h=>e.jsxs("tr",{className:"border-b border-slate-700/50",children:[e.jsx("td",{className:"py-2 px-3 text-slate-300",children:h.label}),Object.keys(Kt).map(u=>e.jsx("td",{className:"text-center py-2 px-3",children:Y0[u][h.key]?e.jsx("svg",{className:"w-5 h-5 text-emerald-400 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-5 h-5 text-slate-600 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})},u))]},h.key))})]})})]}),e.jsxs(y,{children:[e.jsx(B,{title:`Users (${t.length})`}),e.jsx("div",{className:"divide-y divide-slate-700",children:t.map(h=>e.jsxs("div",{className:"py-3 flex items-center justify-between hover:bg-slate-700/30 -mx-6 px-6 cursor-pointer",onClick:()=>l(h.id===o?null:h.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white font-bold",children:h.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-white font-medium",children:h.name}),e.jsx(F,{variant:h.status==="active"?"success":h.status==="pending"?"warning":"default",size:"sm",children:h.status})]}),e.jsx("p",{className:"text-sm text-slate-400",children:h.email})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Kt[h.role].color}`,children:Kt[h.role].label}),e.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${o===h.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]},h.id))})]}),d&&e.jsxs(y,{children:[e.jsx(B,{title:`User Details: ${d.name}`,action:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>{const h=d.status==="active"?"inactive":"active";a(d.id,{status:h})},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),d.status==="active"?"Deactivate":"Activate"]}),e.jsxs(D,{variant:"danger",size:"sm",onClick:()=>{r(d.id),l(null)},children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Email"}),e.jsx("p",{className:"text-slate-300",children:d.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Role"}),e.jsx("p",{className:"text-slate-300",children:Kt[d.role].label})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Created"}),e.jsx("p",{className:"text-slate-300",children:c(d.createdAt)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Last Login"}),e.jsx("p",{className:"text-slate-300",children:c(d.lastLogin)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 mb-2",children:"Permissions"}),e.jsx("div",{className:"space-y-2",children:Object.entries(d.permissions).map(([h,u])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:h.replace(/^can/,"").replace(/([A-Z])/g," $1").trim()}),u?e.jsx("span",{className:"text-emerald-400",children:"Allowed"}):e.jsx("span",{className:"text-slate-600",children:"Denied"})]},h))})]})]})]}),n&&e.jsx(Kf,{onClose:()=>i(!1),onAdd:s})]})},Yf={email:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),slack:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"})}),pagerduty:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M16.965 1.18C15.085.164 13.769 0 10.683 0H3.73v14.55h6.926c2.743 0 4.8-.164 6.61-1.37 1.975-1.303 3.004-3.453 3.004-6.14 0-2.605-.933-4.673-3.305-5.86zM10.437 10.2H7.744V4.177h2.952c2.99 0 4.618.886 4.618 2.991 0 2.36-1.628 3.031-4.877 3.031zM3.73 24h4.015V17.29H3.73V24z"})}),webhook:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),teams:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M20.625 8.073h-5.27V5.138c0-.666.535-1.21 1.193-1.21h3.885c.656 0 1.192.544 1.192 1.21v1.925c0 .555-.448 1.01-1 1.01zm.25 1.49v5.22c0 .84-.68 1.52-1.52 1.52h-4.27v-6.74h5.79zm-7.74-5.1v11.84c0 .84-.68 1.52-1.52 1.52H4.94c-.84 0-1.52-.68-1.52-1.52V4.463c0-.84.68-1.52 1.52-1.52h6.675c.84 0 1.52.68 1.52 1.52z"})})},Xf={email:"bg-blue-500/20 text-blue-400",slack:"bg-purple-500/20 text-purple-400",pagerduty:"bg-emerald-500/20 text-emerald-400",webhook:"bg-slate-500/20 text-slate-400",teams:"bg-indigo-500/20 text-indigo-400"},Jf=({preferences:t,onUpdate:s})=>{const a=r=>{const n=t.channels.map(i=>i.id===r?{...i,isEnabled:!i.isEnabled}:i);s({channels:n})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Notification Preferences"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Configure how and when you receive alerts"})]}),e.jsxs(D,{variant:"primary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Channel"]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Alert Channels"}),e.jsx("div",{className:"space-y-3",children:t.channels.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Xf[r.type]}`,children:Yf[r.type]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-white font-medium",children:r.name}),e.jsx(F,{variant:"info",size:"sm",children:r.type.charAt(0).toUpperCase()+r.type.slice(1)})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[r.type==="email"&&r.config.recipients,r.type==="slack"&&r.config.channel,r.type==="pagerduty"&&`Service: ${r.config.severity}`,r.type==="webhook"&&"Custom webhook",r.type==="teams"&&"Microsoft Teams"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>a(r.id),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.isEnabled?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.isEnabled?"translate-x-6":"translate-x-1"}`})}),e.jsx(D,{variant:"ghost",size:"sm",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]},r.id))})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Alert Threshold"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Receive notifications for alerts at or above the selected severity level"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:["all","warning","critical"].map(r=>e.jsxs("button",{onClick:()=>s({alertThreshold:r}),className:`p-4 rounded-lg border-2 transition-all ${t.alertThreshold===r?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[e.jsx("p",{className:`font-medium capitalize ${t.alertThreshold===r?"text-cyan-400":"text-slate-400"}`,children:r==="all"?"All Alerts":`${r} & Above`}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[r==="all"&&"Info, Warning, Critical",r==="warning"&&"Warning, Critical",r==="critical"&&"Critical only"]})]},r))})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Quiet Hours"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Enable Quiet Hours"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Suppress non-critical notifications during specified hours"})]}),e.jsx("button",{onClick:()=>s({quietHours:{...t.quietHours,enabled:!t.quietHours.enabled}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.quietHours.enabled?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.quietHours.enabled?"translate-x-6":"translate-x-1"}`})})]}),t.quietHours.enabled&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Start Time"}),e.jsx("input",{type:"time",value:t.quietHours.start,onChange:r=>s({quietHours:{...t.quietHours,start:r.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"End Time"}),e.jsx("input",{type:"time",value:t.quietHours.end,onChange:r=>s({quietHours:{...t.quietHours,end:r.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Timezone"}),e.jsxs("select",{value:t.quietHours.timezone,onChange:r=>s({quietHours:{...t.quietHours,timezone:r.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"America/New_York",children:"Eastern Time"}),e.jsx("option",{value:"America/Chicago",children:"Central Time"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),e.jsx("option",{value:"UTC",children:"UTC"})]})]})]})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Email Digest"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Enable Digest Emails"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Receive a summary of alerts and activities"})]}),e.jsx("button",{onClick:()=>s({digest:{...t.digest,enabled:!t.digest.enabled}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.digest.enabled?"bg-cyan-500":"bg-slate-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.digest.enabled?"translate-x-6":"translate-x-1"}`})})]}),t.digest.enabled&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Frequency"}),e.jsxs("select",{value:t.digest.frequency,onChange:r=>s({digest:{...t.digest,frequency:r.target.value}}),className:"w-48 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"})]})]})]})]})]})},ev={UPDATE_SETTINGS:"bg-blue-500/20 text-blue-400",CREATE_RULE:"bg-emerald-500/20 text-emerald-400",TEST_CONNECTION:"bg-amber-500/20 text-amber-400",ADD_USER:"bg-purple-500/20 text-purple-400",UPDATE_PERMISSIONS:"bg-indigo-500/20 text-indigo-400",APPROVE_TICKET:"bg-cyan-500/20 text-cyan-400",EXPORT_REPORT:"bg-slate-500/20 text-slate-400",SYNC_CLOUD:"bg-teal-500/20 text-teal-400",DELETE_RULE:"bg-red-500/20 text-red-400"},tv=[{value:"",label:"All Actions"},{value:"UPDATE_SETTINGS",label:"Update Settings"},{value:"CREATE_RULE",label:"Create Rule"},{value:"DELETE_RULE",label:"Delete Rule"},{value:"TEST_CONNECTION",label:"Test Connection"},{value:"ADD_USER",label:"Add User"},{value:"UPDATE_PERMISSIONS",label:"Update Permissions"},{value:"APPROVE_TICKET",label:"Approve Ticket"},{value:"EXPORT_REPORT",label:"Export Report"},{value:"SYNC_CLOUD",label:"Sync Cloud"}],sv=({logs:t,onLoadLogs:s})=>{const[a,r]=v.useState(""),[n,i]=v.useState("");v.useEffect(()=>{s()},[s]);const o=()=>{s({user:a||void 0,action:n||void 0})},l=()=>{r(""),i(""),s()},c=h=>{const u=new Date(h),_=new Date().getTime()-u.getTime(),b=Math.floor(_/6e4),m=Math.floor(_/36e5),T=Math.floor(_/864e5);return b<60?`${b} min ago`:m<24?`${m} hours ago`:T<7?`${T} days ago`:u.toLocaleDateString()},d=h=>h.replace(/_/g," ").toLowerCase().replace(/\b\w/g,u=>u.toUpperCase());return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Logs"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Track all system activities and changes"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export CSV"]}),e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export JSON"]})]})]}),e.jsxs(y,{children:[e.jsx(B,{title:"Filters"}),e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"User"}),e.jsx("input",{type:"text",value:a,onChange:h=>r(h.target.value),placeholder:"Search by email or username",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Action"}),e.jsx("select",{value:n,onChange:h=>i(h.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:tv.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),e.jsx(D,{variant:"primary",onClick:o,children:"Apply Filters"}),e.jsx(D,{variant:"ghost",onClick:l,children:"Clear"})]})]}),e.jsxs(y,{padding:"none",children:[e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-white",children:"Activity Log"}),e.jsxs("span",{className:"text-sm text-slate-400",children:[t.length," entries"]})]})}),e.jsx("div",{className:"divide-y divide-slate-700",children:t.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No audit logs found matching your criteria"}):t.map(h=>e.jsx("div",{className:"p-4 hover:bg-slate-700/30 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`mt-1 w-2 h-2 rounded-full ${h.status==="success"?"bg-emerald-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ev[h.action]||"bg-slate-500/20 text-slate-400"}`,children:d(h.action)}),e.jsx("span",{className:"text-white font-medium",children:h.resource})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:h.details}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),h.user]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),h.ipAddress]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-slate-400",children:c(h.timestamp)}),e.jsx(F,{variant:h.status==="success"?"success":"error",size:"sm",children:h.status})]})]})},h.id))})]})]})},av=()=>{const{settings:t,auditLogs:s,activeTab:a,isLoading:r,testingConnection:n,testResult:i,setActiveTab:o,testCloudConnection:l,updateCloudConnection:c,addCloudConnection:d,deleteCloudConnection:h,updateServiceNowConfig:u,testServiceNowConnection:x,updateSIEMConfig:_,updateAPMConfig:b,addUser:m,updateUser:T,deleteUser:p,updateNotificationPreferences:g,loadAuditLogs:f,clearTestResult:j}=Ff();if(r||!t)return e.jsx(ee,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[e.jsxs("svg",{className:"animate-spin h-6 w-6",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading settings..."]})})});const N=()=>{switch(a){case"cloud":return e.jsx(Wf,{connections:t.cloudConnections,testingConnection:n,testResult:i,onTestConnection:l,onUpdateConnection:c,onAddConnection:d,onDeleteConnection:h,onClearTestResult:j});case"servicenow":return e.jsx(zf,{config:t.serviceNow,testingConnection:n,testResult:i,onUpdate:u,onTestConnection:x,onClearTestResult:j});case"siem":return e.jsx(Bf,{config:t.siem,onUpdate:_});case"apm":return e.jsx(qf,{config:t.apm,onUpdate:b});case"users":return e.jsx(Qf,{users:t.users,onAddUser:m,onUpdateUser:T,onDeleteUser:p});case"notifications":return e.jsx(Jf,{preferences:t.notifications,onUpdate:g});case"audit":return e.jsx(sv,{logs:s,onLoadLogs:f});default:return null}};return e.jsx(ee,{children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-64 flex-shrink-0",children:e.jsx(Vf,{activeTab:a,onTabChange:o})}),e.jsx("div",{className:"flex-1 min-w-0",children:N()})]})})},rv={beforeAIOps:{averageTATHours:48.5,p50Hours:36,p95Hours:96,totalTickets:1245},afterAIOps:{averageTATHours:8.2,p50Hours:4,p95Hours:18,totalTickets:1567},improvement:{percentageReduction:83.1,hoursSaved:63156,ticketsAccelerated:1567},trendData:[{month:"Jul 2023",beforeAIOps:52,afterAIOps:0,ticketCount:189},{month:"Aug 2023",beforeAIOps:49,afterAIOps:0,ticketCount:203},{month:"Sep 2023",beforeAIOps:47,afterAIOps:0,ticketCount:195},{month:"Oct 2023",beforeAIOps:48,afterAIOps:18,ticketCount:211},{month:"Nov 2023",beforeAIOps:46,afterAIOps:14,ticketCount:224},{month:"Dec 2023",beforeAIOps:51,afterAIOps:11,ticketCount:198},{month:"Jan 2024",beforeAIOps:0,afterAIOps:9,ticketCount:247}]},nv={manual:{count:234,averageTimeHours:4.5,errorRate:12.8,totalEffort:1053},automated:{count:1876,averageTimeMinutes:8,errorRate:2.1,totalEffort:250},improvement:{automationRate:88.9,timeSavingsHours:6593,errorReduction:83.6},byCategory:[{category:"Firewall Rule Changes",manual:45,automated:523,automationRate:92.1,timeSaved:1892},{category:"ACL Updates",manual:67,automated:412,automationRate:86,timeSaved:1345},{category:"Compliance Remediation",manual:89,automated:567,automationRate:86.4,timeSaved:2134},{category:"Network Policy Validation",manual:23,automated:289,automationRate:92.6,timeSaved:876},{category:"Security Group Changes",manual:10,automated:85,automationRate:89.5,timeSaved:346}]},iv={totalChanges:2345,successful:2267,failed:56,failureRate:2.4,failuresByReason:[{reason:"Configuration Syntax Error",count:18,percentage:32.1,avgResolutionTime:1.2},{reason:"Conflicting Rules",count:14,percentage:25,avgResolutionTime:2.8},{reason:"Resource Capacity",count:9,percentage:16.1,avgResolutionTime:4.5},{reason:"Network Connectivity",count:8,percentage:14.3,avgResolutionTime:3.1},{reason:"Permission Issues",count:7,percentage:12.5,avgResolutionTime:.8}],trendData:[{month:"Jul 2023",totalChanges:298,failures:24,failureRate:8.1},{month:"Aug 2023",totalChanges:312,failures:19,failureRate:6.1},{month:"Sep 2023",totalChanges:287,failures:15,failureRate:5.2},{month:"Oct 2023",totalChanges:334,failures:12,failureRate:3.6},{month:"Nov 2023",totalChanges:389,failures:9,failureRate:2.3},{month:"Dec 2023",totalChanges:356,failures:7,failureRate:2},{month:"Jan 2024",totalChanges:369,failures:6,failureRate:1.6}],mttr:2.1,impactAnalysis:{highImpactFailures:8,mediumImpactFailures:23,lowImpactFailures:25,totalDowntimeHours:47.3}},ov={currentScore:87.3,previousScore:64.2,improvement:23.1,riskReduction:{criticalIssues:{before:47,after:8,reduction:83},highRiskIssues:{before:132,after:23,reduction:82.6},mediumRiskIssues:{before:287,after:67,reduction:76.7}},byFramework:[{framework:"PCI-DSS",previousScore:68.5,currentScore:91.2,improvement:22.7,issuesResolved:34},{framework:"SOC2",previousScore:71.3,currentScore:89.7,improvement:18.4,issuesResolved:28},{framework:"CIS AWS",previousScore:59.8,currentScore:85.1,improvement:25.3,issuesResolved:42},{framework:"NIST 800-53",previousScore:62.4,currentScore:84.8,improvement:22.4,issuesResolved:38},{framework:"ISO 27001",previousScore:66.1,currentScore:86.3,improvement:20.2,issuesResolved:31}],estimatedFinancialImpact:{potentialFinesSaved:245e4,auditCostReduction:38e4,incidentCostAvoidance:182e4,totalValue:465e4}},H={timeSavings:{hours:69749,monetaryValue:4184940},errorReduction:{incidents:203,monetaryValue:2842e3},complianceValue:{riskReduction:83,monetaryValue:465e4},totalROI:11676940,costOfAIOps:85e4,netBenefit:10826940,roiPercentage:1373.8},O={ticketTAT:rv,automation:nv,firewallChanges:iv,complianceRisk:ov},lv=()=>{const[t,s]=v.useState("summary"),a=[{id:"tat",title:"Ticket TAT",description:"Before vs After AIOps",icon:"",value:`${O.ticketTAT.improvement.percentageReduction.toFixed(1)}%`,label:"Reduction",color:"from-emerald-500 to-emerald-600",improvement:O.ticketTAT.improvement.percentageReduction},{id:"automation",title:"Automation Rate",description:"Manual vs Automated",icon:"",value:`${O.automation.improvement.automationRate.toFixed(1)}%`,label:"Automated",color:"from-cyan-500 to-cyan-600",improvement:O.automation.improvement.automationRate},{id:"failures",title:"Change Success",description:"Firewall change quality",icon:"",value:`${(100-O.firewallChanges.failureRate).toFixed(1)}%`,label:"Success Rate",color:"from-blue-500 to-blue-600",improvement:100-O.firewallChanges.failureRate},{id:"compliance",title:"Compliance Score",description:"Risk reduction",icon:"",value:`${O.complianceRisk.improvement.toFixed(1)}%`,label:"Improvement",color:"from-purple-500 to-purple-600",improvement:O.complianceRisk.improvement},{id:"roi",title:"ROI",description:"Return on investment",icon:"",value:`${H.roiPercentage.toFixed(0)}%`,label:"ROI",color:"from-amber-500 to-amber-600",improvement:H.roiPercentage}];return e.jsxs(ee,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Ops Value Dashboard"}),e.jsx("p",{className:"text-slate-400",children:"Operational metrics demonstrating AIOps value and business impact"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6",children:a.map(r=>e.jsxs("button",{onClick:()=>s(r.id),className:`p-4 rounded-lg border-2 transition-all text-left ${t===r.id?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${r.color} rounded-lg flex items-center justify-center text-2xl mb-3`,children:r.icon}),e.jsx("h3",{className:"text-white font-semibold mb-1",children:r.title}),e.jsx("p",{className:"text-slate-400 text-xs mb-2",children:r.description}),e.jsx("p",{className:"text-2xl font-bold text-white mb-1",children:r.value}),e.jsx("p",{className:"text-xs text-emerald-400",children:r.label})]},r.id))}),t==="summary"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Executive Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-semibold mb-1",children:"Total ROI"}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(H.totalROI/1e6).toFixed(2),"M"]}),e.jsxs("p",{className:"text-sm text-slate-300 mt-2",children:[H.roiPercentage.toFixed(0),"% return on $",(H.costOfAIOps/1e3).toFixed(0),"K investment"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Time Saved"}),e.jsxs("p",{className:"text-white font-semibold",children:[O.ticketTAT.improvement.hoursSaved.toLocaleString()," hrs"]})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Errors Avoided"}),e.jsxs("p",{className:"text-white font-semibold",children:[H.errorReduction.incidents," incidents"]})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Automation Rate"}),e.jsxs("p",{className:"text-white font-semibold",children:[O.automation.improvement.automationRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Compliance"}),e.jsxs("p",{className:"text-white font-semibold",children:[O.complianceRisk.currentScore.toFixed(1),"%"]})]})]})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Financial Impact"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-slate-300",children:"Time Savings Value"}),e.jsxs("span",{className:"text-white font-semibold",children:["$",(H.timeSavings.monetaryValue/1e6).toFixed(2),"M"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600",style:{width:`${H.timeSavings.monetaryValue/H.totalROI*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-slate-300",children:"Error Reduction Value"}),e.jsxs("span",{className:"text-white font-semibold",children:["$",(H.errorReduction.monetaryValue/1e6).toFixed(2),"M"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-600",style:{width:`${H.errorReduction.monetaryValue/H.totalROI*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-slate-300",children:"Compliance Value"}),e.jsxs("span",{className:"text-white font-semibold",children:["$",(H.complianceValue.monetaryValue/1e6).toFixed(2),"M"]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600",style:{width:`${H.complianceValue.monetaryValue/H.totalROI*100}%`}})})]}),e.jsx("div",{className:"pt-3 border-t border-slate-600",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-white font-semibold",children:"Net Benefit"}),e.jsxs("span",{className:"text-2xl font-bold text-emerald-400",children:["$",(H.netBenefit/1e6).toFixed(2),"M"]})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Avg TAT (Before)"}),e.jsxs("p",{className:"text-2xl font-bold text-red-400",children:[O.ticketTAT.beforeAIOps.averageTATHours.toFixed(1),"h"]})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Avg TAT (After)"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:[O.ticketTAT.afterAIOps.averageTATHours.toFixed(1),"h"]})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Manual Changes"}),e.jsx("p",{className:"text-2xl font-bold text-amber-400",children:O.automation.manual.count})]}),e.jsxs(y,{className:"p-4",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Automated Changes"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:O.automation.automated.count})]})]})]}),t==="tat"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Ticket Turnaround Time Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-6 bg-red-500/10 rounded-lg border border-red-500/30",children:[e.jsx("p",{className:"text-red-400 font-semibold mb-4",children:"Before AIOps"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Average TAT"}),e.jsxs("span",{className:"text-white font-bold",children:[O.ticketTAT.beforeAIOps.averageTATHours.toFixed(1)," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"P50 (Median)"}),e.jsxs("span",{className:"text-white font-bold",children:[O.ticketTAT.beforeAIOps.p50Hours," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"P95"}),e.jsxs("span",{className:"text-white font-bold",children:[O.ticketTAT.beforeAIOps.p95Hours," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Total Tickets"}),e.jsx("span",{className:"text-white font-bold",children:O.ticketTAT.beforeAIOps.totalTickets})]})]})]}),e.jsxs("div",{className:"p-6 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-semibold mb-4",children:"After AIOps"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Average TAT"}),e.jsxs("span",{className:"text-white font-bold",children:[O.ticketTAT.afterAIOps.averageTATHours.toFixed(1)," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"P50 (Median)"}),e.jsxs("span",{className:"text-white font-bold",children:[O.ticketTAT.afterAIOps.p50Hours," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"P95"}),e.jsxs("span",{className:"text-white font-bold",children:[O.ticketTAT.afterAIOps.p95Hours," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Total Tickets"}),e.jsx("span",{className:"text-white font-bold",children:O.ticketTAT.afterAIOps.totalTickets})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"TAT Reduction"}),e.jsxs("p",{className:"text-3xl font-bold text-cyan-400",children:[O.ticketTAT.improvement.percentageReduction.toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Hours Saved"}),e.jsx("p",{className:"text-3xl font-bold text-purple-400",children:O.ticketTAT.improvement.hoursSaved.toLocaleString()})]}),e.jsxs("div",{className:"p-4 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Tickets Accelerated"}),e.jsx("p",{className:"text-3xl font-bold text-amber-400",children:O.ticketTAT.improvement.ticketsAccelerated.toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"TAT Trend Over Time"}),e.jsx("div",{className:"space-y-2",children:O.ticketTAT.trendData.map(r=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-slate-400 text-sm w-24",children:r.month}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[r.beforeAIOps>0&&e.jsx("div",{className:"relative flex-1",children:e.jsx("div",{className:"h-8 bg-gradient-to-r from-red-500 to-red-600 rounded flex items-center justify-end px-3",style:{width:`${r.beforeAIOps/60*100}%`},children:e.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.beforeAIOps,"h"]})})}),r.afterAIOps>0&&e.jsx("div",{className:"relative flex-1",children:e.jsx("div",{className:"h-8 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded flex items-center justify-end px-3",style:{width:`${r.afterAIOps/60*100}%`},children:e.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.afterAIOps,"h"]})})})]}),e.jsxs("span",{className:"text-slate-400 text-sm w-20 text-right",children:[r.ticketCount," tickets"]})]},r.month))}),e.jsxs("div",{className:"flex gap-4 mt-4 justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-red-500 to-red-600 rounded"}),e.jsx("span",{className:"text-slate-400 text-sm",children:"Before AIOps"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded"}),e.jsx("span",{className:"text-slate-400 text-sm",children:"After AIOps"})]})]})]})]})}),t==="automation"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Manual vs Automated Changes"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-6 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-semibold mb-4",children:"Manual Changes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Total Count"}),e.jsx("span",{className:"text-white font-bold",children:O.automation.manual.count})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Avg Time"}),e.jsxs("span",{className:"text-white font-bold",children:[O.automation.manual.averageTimeHours," hours"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Error Rate"}),e.jsxs("span",{className:"text-white font-bold",children:[O.automation.manual.errorRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Total Effort"}),e.jsxs("span",{className:"text-white font-bold",children:[O.automation.manual.totalEffort,"h"]})]})]})]}),e.jsxs("div",{className:"p-6 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsx("p",{className:"text-cyan-400 font-semibold mb-4",children:"Automated Changes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Total Count"}),e.jsx("span",{className:"text-white font-bold",children:O.automation.automated.count})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Avg Time"}),e.jsxs("span",{className:"text-white font-bold",children:[O.automation.automated.averageTimeMinutes," minutes"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Error Rate"}),e.jsxs("span",{className:"text-white font-bold",children:[O.automation.automated.errorRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-300",children:"Total Effort"}),e.jsxs("span",{className:"text-white font-bold",children:[O.automation.automated.totalEffort,"h"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Automation Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[O.automation.improvement.automationRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Time Savings"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:[O.automation.improvement.timeSavingsHours.toLocaleString(),"h"]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Error Reduction"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-400",children:[O.automation.improvement.errorReduction.toFixed(1),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Automation by Category"}),e.jsx("div",{className:"space-y-3",children:O.automation.byCategory.map(r=>e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-white font-semibold",children:r.category}),e.jsxs("span",{className:"text-emerald-400 font-bold",children:[r.automationRate.toFixed(1),"% Automated"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Manual"}),e.jsx("p",{className:"text-white font-semibold",children:r.manual})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Automated"}),e.jsx("p",{className:"text-white font-semibold",children:r.automated})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Time Saved"}),e.jsxs("p",{className:"text-white font-semibold",children:[r.timeSaved,"h"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs",children:"Total"}),e.jsx("p",{className:"text-white font-semibold",children:r.manual+r.automated})]})]}),e.jsx("div",{className:"mt-2 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-600",style:{width:`${r.automationRate}%`}})})]},r.category))})]})]})}),t==="failures"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Firewall Change Quality Metrics"}),e.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Changes"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:O.firewallChanges.totalChanges})]}),e.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Successful"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:O.firewallChanges.successful})]}),e.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Failed"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:O.firewallChanges.failed})]}),e.jsxs("div",{className:"p-4 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Failure Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-amber-400",children:[O.firewallChanges.failureRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"MTTR"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:[O.firewallChanges.mttr.toFixed(1),"h"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Failure Rate Trend"}),e.jsx("div",{className:"space-y-2",children:O.firewallChanges.trendData.map(r=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-slate-400 text-sm w-24",children:r.month}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsxs("span",{className:"text-slate-400",children:[r.totalChanges," changes"]}),e.jsxs("span",{className:"text-white",children:[r.failureRate.toFixed(1),"% failure rate"]})]}),e.jsx("div",{className:"h-6 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-end px-2",style:{width:`${r.failureRate*10}%`},children:e.jsx("span",{className:"text-white text-xs font-semibold",children:r.failures})})})]})]},r.month))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Failure Root Causes"}),e.jsx("div",{className:"space-y-3",children:O.firewallChanges.failuresByReason.map(r=>e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-white font-semibold",children:r.reason}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-slate-400 text-sm",children:["Avg Resolution: ",r.avgResolutionTime,"h"]}),e.jsxs("span",{className:"text-red-400 font-bold",children:[r.count," failures"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600",style:{width:`${r.percentage}%`}})}),e.jsxs("span",{className:"text-white text-sm font-semibold w-16 text-right",children:[r.percentage.toFixed(1),"%"]})]})]},r.reason))})]}),e.jsxs("div",{className:"p-6 bg-slate-700/30 rounded-lg",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Failure Impact Analysis"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-3 bg-red-500/10 rounded border border-red-500/30",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"High Impact"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:O.firewallChanges.impactAnalysis.highImpactFailures})]}),e.jsxs("div",{className:"p-3 bg-orange-500/10 rounded border border-orange-500/30",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Medium Impact"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:O.firewallChanges.impactAnalysis.mediumImpactFailures})]}),e.jsxs("div",{className:"p-3 bg-yellow-500/10 rounded border border-yellow-500/30",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Low Impact"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:O.firewallChanges.impactAnalysis.lowImpactFailures})]}),e.jsxs("div",{className:"p-3 bg-purple-500/10 rounded border border-purple-500/30",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total Downtime"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-400",children:[O.firewallChanges.impactAnalysis.totalDowntimeHours.toFixed(1),"h"]})]})]})]})]})}),t==="compliance"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Compliance Risk Reduction"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-6 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"Previous Score"}),e.jsxs("p",{className:"text-5xl font-bold text-white mb-4",children:[O.complianceRisk.previousScore.toFixed(1),"%"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-300",children:"Critical Issues"}),e.jsx("span",{className:"text-red-400 font-semibold",children:O.complianceRisk.riskReduction.criticalIssues.before})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-300",children:"High Risk Issues"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:O.complianceRisk.riskReduction.highRiskIssues.before})]})]})]}),e.jsxs("div",{className:"p-6 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-semibold mb-2",children:"Current Score"}),e.jsxs("p",{className:"text-5xl font-bold text-white mb-4",children:[O.complianceRisk.currentScore.toFixed(1),"%"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-300",children:"Critical Issues"}),e.jsx("span",{className:"text-emerald-400 font-semibold",children:O.complianceRisk.riskReduction.criticalIssues.after})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-300",children:"High Risk Issues"}),e.jsx("span",{className:"text-cyan-400 font-semibold",children:O.complianceRisk.riskReduction.highRiskIssues.after})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical Issues Resolved"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[O.complianceRisk.riskReduction.criticalIssues.reduction.toFixed(0),"%"]}),e.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[O.complianceRisk.riskReduction.criticalIssues.before,"  ",O.complianceRisk.riskReduction.criticalIssues.after]})]}),e.jsxs("div",{className:"p-4 bg-orange-500/10 rounded-lg border border-orange-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"High Risk Resolved"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[O.complianceRisk.riskReduction.highRiskIssues.reduction.toFixed(0),"%"]}),e.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[O.complianceRisk.riskReduction.highRiskIssues.before,"  ",O.complianceRisk.riskReduction.highRiskIssues.after]})]}),e.jsxs("div",{className:"p-4 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Medium Risk Resolved"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[O.complianceRisk.riskReduction.mediumRiskIssues.reduction.toFixed(0),"%"]}),e.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[O.complianceRisk.riskReduction.mediumRiskIssues.before,"  ",O.complianceRisk.riskReduction.mediumRiskIssues.after]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Compliance by Framework"}),e.jsx("div",{className:"space-y-3",children:O.complianceRisk.byFramework.map(r=>e.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-white font-semibold",children:r.framework}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-emerald-400 font-bold",children:["+",r.improvement.toFixed(1),"%"]}),e.jsxs("span",{className:"text-slate-400 text-sm",children:[r.issuesResolved," issues resolved"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-slate-400 text-sm w-20",children:"Before:"}),e.jsx("div",{className:"flex-1 h-6 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-amber-600 flex items-center justify-end px-3",style:{width:`${r.previousScore}%`},children:e.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.previousScore.toFixed(1),"%"]})})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-slate-400 text-sm w-20",children:"After:"}),e.jsx("div",{className:"flex-1 h-6 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600 flex items-center justify-end px-3",style:{width:`${r.currentScore}%`},children:e.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.currentScore.toFixed(1),"%"]})})})]})]},r.framework))})]}),e.jsxs("div",{className:"p-6 bg-gradient-to-r from-emerald-500/10 to-cyan-500/10 rounded-lg border border-emerald-500/30",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Estimated Financial Impact"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Potential Fines Saved"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:["$",(O.complianceRisk.estimatedFinancialImpact.potentialFinesSaved/1e6).toFixed(2),"M"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Audit Cost Reduction"}),e.jsxs("p",{className:"text-2xl font-bold text-cyan-400",children:["$",(O.complianceRisk.estimatedFinancialImpact.auditCostReduction/1e3).toFixed(0),"K"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Incident Cost Avoidance"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-400",children:["$",(O.complianceRisk.estimatedFinancialImpact.incidentCostAvoidance/1e6).toFixed(2),"M"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Value"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",(O.complianceRisk.estimatedFinancialImpact.totalValue/1e6).toFixed(2),"M"]})]})]})]})]})}),t==="roi"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(y,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Return on Investment Analysis"}),e.jsxs("div",{className:"p-8 bg-gradient-to-r from-emerald-500/20 to-cyan-500/20 rounded-lg border-2 border-emerald-500/50 mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-slate-300 text-lg mb-2",children:"Total ROI"}),e.jsxs("p",{className:"text-6xl font-bold text-white mb-2",children:[H.roiPercentage.toFixed(0),"%"]}),e.jsxs("p",{className:"text-emerald-400 text-xl font-semibold",children:["$",(H.netBenefit/1e6).toFixed(2),"M Net Benefit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Investment"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",(H.costOfAIOps/1e3).toFixed(0),"K"]})]}),e.jsxs("div",{className:"text-center p-4 bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Value"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:["$",(H.totalROI/1e6).toFixed(2),"M"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-white font-semibold",children:"Value Breakdown"}),e.jsxs("div",{className:"p-6 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-emerald-400 font-semibold mb-1",children:"Time Savings Value"}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[H.timeSavings.hours.toLocaleString()," hours saved"]})]}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(H.timeSavings.monetaryValue/1e6).toFixed(2),"M"]})]}),e.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600",style:{width:`${H.timeSavings.monetaryValue/H.totalROI*100}%`}})}),e.jsxs("p",{className:"text-slate-400 text-xs mt-2",children:[(H.timeSavings.monetaryValue/H.totalROI*100).toFixed(1),"% of total value"]})]}),e.jsxs("div",{className:"p-6 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-cyan-400 font-semibold mb-1",children:"Error Reduction Value"}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[H.errorReduction.incidents," incidents avoided"]})]}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(H.errorReduction.monetaryValue/1e6).toFixed(2),"M"]})]}),e.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-600",style:{width:`${H.errorReduction.monetaryValue/H.totalROI*100}%`}})}),e.jsxs("p",{className:"text-slate-400 text-xs mt-2",children:[(H.errorReduction.monetaryValue/H.totalROI*100).toFixed(1),"% of total value"]})]}),e.jsxs("div",{className:"p-6 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-purple-400 font-semibold mb-1",children:"Compliance Value"}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[H.complianceValue.riskReduction.toFixed(1),"% risk reduction"]})]}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(H.complianceValue.monetaryValue/1e6).toFixed(2),"M"]})]}),e.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600",style:{width:`${H.complianceValue.monetaryValue/H.totalROI*100}%`}})}),e.jsxs("p",{className:"text-slate-400 text-xs mt-2",children:[(H.complianceValue.monetaryValue/H.totalROI*100).toFixed(1),"% of total value"]})]})]})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(D,{variant:"ghost",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),e.jsxs(D,{variant:"primary",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export to PDF"]})]})]})]})},cv=({activeView:t,onNavigate:s})=>{if(t==="dashboard")return e.jsx(Bx,{onNavigate:s});const r={opsvalue:lv,compliance:pg,monitoring:Pg,dependencymap:Ig,incidents:Dg,cloudmanagement:Vg,multicloudvisibility:c1,pathanalysis:h1,pathanalysisenhanced:N1,routeintelligence:I1,tickets:D1,statusboard:M1,l1whitelisting:hf,rulegenerator:vf,validation:kf,conflicts:Mf,settings:av}[t];return r?e.jsx(r,{}):e.jsx(dv,{})},dv=()=>e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-slate-400",children:"View not found"})}),uv=()=>{const{activeView:t,viewInfo:s,setActiveView:a}=Rh(),[r,n]=Ih(!1),[i]=v.useState(3);return e.jsx(Ah,{menuItems:Dm,activeView:t,viewInfo:s,sidebarCollapsed:r,notifications:i,onViewChange:a,onToggleSidebar:n,children:e.jsx(cv,{activeView:t,onNavigate:a})})},pv=ti.createRoot(document.getElementById("root"));pv.render(e.jsx(Lc.StrictMode,{children:e.jsx(uv,{})}));

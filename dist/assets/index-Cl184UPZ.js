var $u=Object.defineProperty;var Bu=(e,s,a)=>s in e?$u(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a;var dn=(e,s,a)=>Bu(e,typeof s!="symbol"?s+"":s,a);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();function Zu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yc={exports:{}},Br={},bc={exports:{}},U={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ra=Symbol.for("react.element"),qu=Symbol.for("react.portal"),Ku=Symbol.for("react.fragment"),Qu=Symbol.for("react.strict_mode"),Yu=Symbol.for("react.profiler"),Xu=Symbol.for("react.provider"),Ju=Symbol.for("react.context"),e0=Symbol.for("react.forward_ref"),t0=Symbol.for("react.suspense"),s0=Symbol.for("react.memo"),a0=Symbol.for("react.lazy"),$i=Symbol.iterator;function r0(e){return e===null||typeof e!="object"?null:(e=$i&&e[$i]||e["@@iterator"],typeof e=="function"?e:null)}var _c={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wc=Object.assign,jc={};function Fs(e,s,a){this.props=e,this.context=s,this.refs=jc,this.updater=a||_c}Fs.prototype.isReactComponent={};Fs.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};Fs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Nc(){}Nc.prototype=Fs.prototype;function Bo(e,s,a){this.props=e,this.context=s,this.refs=jc,this.updater=a||_c}var Zo=Bo.prototype=new Nc;Zo.constructor=Bo;wc(Zo,Fs.prototype);Zo.isPureReactComponent=!0;var Bi=Array.isArray,kc=Object.prototype.hasOwnProperty,qo={current:null},Sc={key:!0,ref:!0,__self:!0,__source:!0};function Cc(e,s,a){var r,n={},o=null,i=null;if(s!=null)for(r in s.ref!==void 0&&(i=s.ref),s.key!==void 0&&(o=""+s.key),s)kc.call(s,r)&&!Sc.hasOwnProperty(r)&&(n[r]=s[r]);var l=arguments.length-2;if(l===1)n.children=a;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)n[r]===void 0&&(n[r]=l[r]);return{$$typeof:Ra,type:e,key:o,ref:i,props:n,_owner:qo.current}}function n0(e,s){return{$$typeof:Ra,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function Ko(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ra}function o0(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return s[a]})}var Zi=/\/+/g;function un(e,s){return typeof e=="object"&&e!==null&&e.key!=null?o0(""+e.key):s.toString(36)}function cr(e,s,a,r,n){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Ra:case qu:i=!0}}if(i)return i=e,n=n(i),e=r===""?"."+un(i,0):r,Bi(n)?(a="",e!=null&&(a=e.replace(Zi,"$&/")+"/"),cr(n,s,a,"",function(d){return d})):n!=null&&(Ko(n)&&(n=n0(n,a+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(Zi,"$&/")+"/")+e)),s.push(n)),1;if(i=0,r=r===""?".":r+":",Bi(e))for(var l=0;l<e.length;l++){o=e[l];var c=r+un(o,l);i+=cr(o,s,a,c,n)}else if(c=r0(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=r+un(o,l++),i+=cr(o,s,a,c,n);else if(o==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return i}function Ha(e,s,a){if(e==null)return e;var r=[],n=0;return cr(e,r,"","",function(o){return s.call(a,o,n++)}),r}function i0(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var Se={current:null},dr={transition:null},l0={ReactCurrentDispatcher:Se,ReactCurrentBatchConfig:dr,ReactCurrentOwner:qo};function Ac(){throw Error("act(...) is not supported in production builds of React.")}U.Children={map:Ha,forEach:function(e,s,a){Ha(e,function(){s.apply(this,arguments)},a)},count:function(e){var s=0;return Ha(e,function(){s++}),s},toArray:function(e){return Ha(e,function(s){return s})||[]},only:function(e){if(!Ko(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};U.Component=Fs;U.Fragment=Ku;U.Profiler=Yu;U.PureComponent=Bo;U.StrictMode=Qu;U.Suspense=t0;U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l0;U.act=Ac;U.cloneElement=function(e,s,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=wc({},e.props),n=e.key,o=e.ref,i=e._owner;if(s!=null){if(s.ref!==void 0&&(o=s.ref,i=qo.current),s.key!==void 0&&(n=""+s.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in s)kc.call(s,c)&&!Sc.hasOwnProperty(c)&&(r[c]=s[c]===void 0&&l!==void 0?l[c]:s[c])}var c=arguments.length-2;if(c===1)r.children=a;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Ra,type:e.type,key:n,ref:o,props:r,_owner:i}};U.createContext=function(e){return e={$$typeof:Ju,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Xu,_context:e},e.Consumer=e};U.createElement=Cc;U.createFactory=function(e){var s=Cc.bind(null,e);return s.type=e,s};U.createRef=function(){return{current:null}};U.forwardRef=function(e){return{$$typeof:e0,render:e}};U.isValidElement=Ko;U.lazy=function(e){return{$$typeof:a0,_payload:{_status:-1,_result:e},_init:i0}};U.memo=function(e,s){return{$$typeof:s0,type:e,compare:s===void 0?null:s}};U.startTransition=function(e){var s=dr.transition;dr.transition={};try{e()}finally{dr.transition=s}};U.unstable_act=Ac;U.useCallback=function(e,s){return Se.current.useCallback(e,s)};U.useContext=function(e){return Se.current.useContext(e)};U.useDebugValue=function(){};U.useDeferredValue=function(e){return Se.current.useDeferredValue(e)};U.useEffect=function(e,s){return Se.current.useEffect(e,s)};U.useId=function(){return Se.current.useId()};U.useImperativeHandle=function(e,s,a){return Se.current.useImperativeHandle(e,s,a)};U.useInsertionEffect=function(e,s){return Se.current.useInsertionEffect(e,s)};U.useLayoutEffect=function(e,s){return Se.current.useLayoutEffect(e,s)};U.useMemo=function(e,s){return Se.current.useMemo(e,s)};U.useReducer=function(e,s,a){return Se.current.useReducer(e,s,a)};U.useRef=function(e){return Se.current.useRef(e)};U.useState=function(e){return Se.current.useState(e)};U.useSyncExternalStore=function(e,s,a){return Se.current.useSyncExternalStore(e,s,a)};U.useTransition=function(){return Se.current.useTransition()};U.version="18.3.1";bc.exports=U;var f=bc.exports;const c0=Zu(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d0=f,u0=Symbol.for("react.element"),p0=Symbol.for("react.fragment"),m0=Object.prototype.hasOwnProperty,h0=d0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g0={key:!0,ref:!0,__self:!0,__source:!0};function Tc(e,s,a){var r,n={},o=null,i=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(i=s.ref);for(r in s)m0.call(s,r)&&!g0.hasOwnProperty(r)&&(n[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:u0,type:e,key:o,ref:i,props:n,_owner:h0.current}}Br.Fragment=p0;Br.jsx=Tc;Br.jsxs=Tc;yc.exports=Br;var t=yc.exports,Qn={},Pc={exports:{}},Ve={},Ic={exports:{}},Ec={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(E,V){var H=E.length;E.push(V);e:for(;0<H;){var ne=H-1>>>1,de=E[ne];if(0<n(de,V))E[ne]=V,E[H]=de,H=ne;else break e}}function a(E){return E.length===0?null:E[0]}function r(E){if(E.length===0)return null;var V=E[0],H=E.pop();if(H!==V){E[0]=H;e:for(var ne=0,de=E.length,Va=de>>>1;ne<Va;){var Wt=2*(ne+1)-1,cn=E[Wt],Ut=Wt+1,Ga=E[Ut];if(0>n(cn,H))Ut<de&&0>n(Ga,cn)?(E[ne]=Ga,E[Ut]=H,ne=Ut):(E[ne]=cn,E[Wt]=H,ne=Wt);else if(Ut<de&&0>n(Ga,H))E[ne]=Ga,E[Ut]=H,ne=Ut;else break e}}return V}function n(E,V){var H=E.sortIndex-V.sortIndex;return H!==0?H:E.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,p=null,h=3,y=!1,j=!1,v=!1,L=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(E){for(var V=a(d);V!==null;){if(V.callback===null)r(d);else if(V.startTime<=E)r(d),V.sortIndex=V.expirationTime,s(c,V);else break;V=a(d)}}function w(E){if(v=!1,g(E),!j)if(a(c)!==null)j=!0,G(N);else{var V=a(d);V!==null&&me(w,V.startTime-E)}}function N(E,V){j=!1,v&&(v=!1,x(O),O=-1),y=!0;var H=h;try{for(g(V),p=a(c);p!==null&&(!(p.expirationTime>V)||E&&!W());){var ne=p.callback;if(typeof ne=="function"){p.callback=null,h=p.priorityLevel;var de=ne(p.expirationTime<=V);V=e.unstable_now(),typeof de=="function"?p.callback=de:p===a(c)&&r(c),g(V)}else r(c);p=a(c)}if(p!==null)var Va=!0;else{var Wt=a(d);Wt!==null&&me(w,Wt.startTime-V),Va=!1}return Va}finally{p=null,h=H,y=!1}}var k=!1,C=null,O=-1,P=5,I=-1;function W(){return!(e.unstable_now()-I<P)}function B(){if(C!==null){var E=e.unstable_now();I=E;var V=!0;try{V=C(!0,E)}finally{V?A():(k=!1,C=null)}}else k=!1}var A;if(typeof m=="function")A=function(){m(B)};else if(typeof MessageChannel<"u"){var _=new MessageChannel,T=_.port2;_.port1.onmessage=B,A=function(){T.postMessage(null)}}else A=function(){L(B,0)};function G(E){C=E,k||(k=!0,A())}function me(E,V){O=L(function(){E(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(E){E.callback=null},e.unstable_continueExecution=function(){j||y||(j=!0,G(N))},e.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<E?Math.floor(1e3/E):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return a(c)},e.unstable_next=function(E){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var H=h;h=V;try{return E()}finally{h=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(E,V){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var H=h;h=E;try{return V()}finally{h=H}},e.unstable_scheduleCallback=function(E,V,H){var ne=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ne+H:ne):H=ne,E){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=H+de,E={id:u++,callback:V,priorityLevel:E,startTime:H,expirationTime:de,sortIndex:-1},H>ne?(E.sortIndex=H,s(d,E),a(c)===null&&E===a(d)&&(v?(x(O),O=-1):v=!0,me(w,H-ne))):(E.sortIndex=de,s(c,E),j||y||(j=!0,G(N))),E},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(E){var V=h;return function(){var H=h;h=V;try{return E.apply(this,arguments)}finally{h=H}}}})(Ec);Ic.exports=Ec;var x0=Ic.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f0=f,Me=x0;function S(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rc=new Set,xa={};function is(e,s){Rs(e,s),Rs(e+"Capture",s)}function Rs(e,s){for(xa[e]=s,e=0;e<s.length;e++)Rc.add(s[e])}var xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yn=Object.prototype.hasOwnProperty,v0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qi={},Ki={};function y0(e){return Yn.call(Ki,e)?!0:Yn.call(qi,e)?!1:v0.test(e)?Ki[e]=!0:(qi[e]=!0,!1)}function b0(e,s,a,r){if(a!==null&&a.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return r?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _0(e,s,a,r){if(s===null||typeof s>"u"||b0(e,s,a,r))return!0;if(r)return!1;if(a!==null)switch(a.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Ce(e,s,a,r,n,o,i){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=a,this.propertyName=e,this.type=s,this.sanitizeURL=o,this.removeEmptyString=i}var fe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fe[e]=new Ce(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];fe[s]=new Ce(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fe[e]=new Ce(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fe[e]=new Ce(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fe[e]=new Ce(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fe[e]=new Ce(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fe[e]=new Ce(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fe[e]=new Ce(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fe[e]=new Ce(e,5,!1,e.toLowerCase(),null,!1,!1)});var Qo=/[\-:]([a-z])/g;function Yo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(Qo,Yo);fe[s]=new Ce(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(Qo,Yo);fe[s]=new Ce(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(Qo,Yo);fe[s]=new Ce(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fe[e]=new Ce(e,1,!1,e.toLowerCase(),null,!1,!1)});fe.xlinkHref=new Ce("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fe[e]=new Ce(e,1,!1,e.toLowerCase(),null,!0,!0)});function Xo(e,s,a,r){var n=fe.hasOwnProperty(s)?fe[s]:null;(n!==null?n.type!==0:r||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(_0(s,a,n,r)&&(a=null),r||n===null?y0(s)&&(a===null?e.removeAttribute(s):e.setAttribute(s,""+a)):n.mustUseProperty?e[n.propertyName]=a===null?n.type===3?!1:"":a:(s=n.attributeName,r=n.attributeNamespace,a===null?e.removeAttribute(s):(n=n.type,a=n===3||n===4&&a===!0?"":""+a,r?e.setAttributeNS(r,s,a):e.setAttribute(s,a))))}var bt=f0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fa=Symbol.for("react.element"),gs=Symbol.for("react.portal"),xs=Symbol.for("react.fragment"),Jo=Symbol.for("react.strict_mode"),Xn=Symbol.for("react.profiler"),Lc=Symbol.for("react.provider"),Oc=Symbol.for("react.context"),ei=Symbol.for("react.forward_ref"),Jn=Symbol.for("react.suspense"),eo=Symbol.for("react.suspense_list"),ti=Symbol.for("react.memo"),jt=Symbol.for("react.lazy"),Dc=Symbol.for("react.offscreen"),Qi=Symbol.iterator;function zs(e){return e===null||typeof e!="object"?null:(e=Qi&&e[Qi]||e["@@iterator"],typeof e=="function"?e:null)}var ae=Object.assign,pn;function ea(e){if(pn===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);pn=s&&s[1]||""}return`
`+pn+e}var mn=!1;function hn(e,s){if(!e||mn)return"";mn=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(d){var r=d}Reflect.construct(e,[],s)}else{try{s.call()}catch(d){r=d}e.call(s.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),o=r.stack.split(`
`),i=n.length-1,l=o.length-1;1<=i&&0<=l&&n[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||n[i]!==o[l]){var c=`
`+n[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{mn=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?ea(e):""}function w0(e){switch(e.tag){case 5:return ea(e.type);case 16:return ea("Lazy");case 13:return ea("Suspense");case 19:return ea("SuspenseList");case 0:case 2:case 15:return e=hn(e.type,!1),e;case 11:return e=hn(e.type.render,!1),e;case 1:return e=hn(e.type,!0),e;default:return""}}function to(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xs:return"Fragment";case gs:return"Portal";case Xn:return"Profiler";case Jo:return"StrictMode";case Jn:return"Suspense";case eo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Oc:return(e.displayName||"Context")+".Consumer";case Lc:return(e._context.displayName||"Context")+".Provider";case ei:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ti:return s=e.displayName||null,s!==null?s:to(e.type)||"Memo";case jt:s=e._payload,e=e._init;try{return to(e(s))}catch{}}return null}function j0(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return to(s);case 8:return s===Jo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Mt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mc(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function N0(e){var s=Mc(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),r=""+e[s];if(!e.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var n=a.get,o=a.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return n.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(e,s,{enumerable:a.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function Wa(e){e._valueTracker||(e._valueTracker=N0(e))}function Vc(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var a=s.getValue(),r="";return e&&(r=Mc(e)?e.checked?"true":"false":e.value),e=r,e!==a?(s.setValue(e),!0):!1}function wr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function so(e,s){var a=s.checked;return ae({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Yi(e,s){var a=s.defaultValue==null?"":s.defaultValue,r=s.checked!=null?s.checked:s.defaultChecked;a=Mt(s.value!=null?s.value:a),e._wrapperState={initialChecked:r,initialValue:a,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function Gc(e,s){s=s.checked,s!=null&&Xo(e,"checked",s,!1)}function ao(e,s){Gc(e,s);var a=Mt(s.value),r=s.type;if(a!=null)r==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?ro(e,s.type,a):s.hasOwnProperty("defaultValue")&&ro(e,s.type,Mt(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function Xi(e,s,a){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var r=s.type;if(!(r!=="submit"&&r!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,a||s===e.value||(e.value=s),e.defaultValue=s}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function ro(e,s,a){(s!=="number"||wr(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var ta=Array.isArray;function Cs(e,s,a,r){if(e=e.options,s){s={};for(var n=0;n<a.length;n++)s["$"+a[n]]=!0;for(a=0;a<e.length;a++)n=s.hasOwnProperty("$"+e[a].value),e[a].selected!==n&&(e[a].selected=n),n&&r&&(e[a].defaultSelected=!0)}else{for(a=""+Mt(a),s=null,n=0;n<e.length;n++){if(e[n].value===a){e[n].selected=!0,r&&(e[n].defaultSelected=!0);return}s!==null||e[n].disabled||(s=e[n])}s!==null&&(s.selected=!0)}}function no(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(S(91));return ae({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ji(e,s){var a=s.value;if(a==null){if(a=s.children,s=s.defaultValue,a!=null){if(s!=null)throw Error(S(92));if(ta(a)){if(1<a.length)throw Error(S(93));a=a[0]}s=a}s==null&&(s=""),a=s}e._wrapperState={initialValue:Mt(a)}}function Hc(e,s){var a=Mt(s.value),r=Mt(s.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),s.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),r!=null&&(e.defaultValue=""+r)}function el(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function Fc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oo(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?Fc(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ua,Wc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,a,r,n){MSApp.execUnsafeLocalFunction(function(){return e(s,a,r,n)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(Ua=Ua||document.createElement("div"),Ua.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Ua.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function fa(e,s){if(s){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=s;return}}e.textContent=s}var oa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k0=["Webkit","ms","Moz","O"];Object.keys(oa).forEach(function(e){k0.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),oa[s]=oa[e]})});function Uc(e,s,a){return s==null||typeof s=="boolean"||s===""?"":a||typeof s!="number"||s===0||oa.hasOwnProperty(e)&&oa[e]?(""+s).trim():s+"px"}function zc(e,s){e=e.style;for(var a in s)if(s.hasOwnProperty(a)){var r=a.indexOf("--")===0,n=Uc(a,s[a],r);a==="float"&&(a="cssFloat"),r?e.setProperty(a,n):e[a]=n}}var S0=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function io(e,s){if(s){if(S0[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(S(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(S(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(S(61))}if(s.style!=null&&typeof s.style!="object")throw Error(S(62))}}function lo(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var co=null;function si(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var uo=null,As=null,Ts=null;function tl(e){if(e=Da(e)){if(typeof uo!="function")throw Error(S(280));var s=e.stateNode;s&&(s=Yr(s),uo(e.stateNode,e.type,s))}}function $c(e){As?Ts?Ts.push(e):Ts=[e]:As=e}function Bc(){if(As){var e=As,s=Ts;if(Ts=As=null,tl(e),s)for(e=0;e<s.length;e++)tl(s[e])}}function Zc(e,s){return e(s)}function qc(){}var gn=!1;function Kc(e,s,a){if(gn)return e(s,a);gn=!0;try{return Zc(e,s,a)}finally{gn=!1,(As!==null||Ts!==null)&&(qc(),Bc())}}function va(e,s){var a=e.stateNode;if(a===null)return null;var r=Yr(a);if(r===null)return null;a=r[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(S(231,s,typeof a));return a}var po=!1;if(xt)try{var $s={};Object.defineProperty($s,"passive",{get:function(){po=!0}}),window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{po=!1}function C0(e,s,a,r,n,o,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{s.apply(a,d)}catch(u){this.onError(u)}}var ia=!1,jr=null,Nr=!1,mo=null,A0={onError:function(e){ia=!0,jr=e}};function T0(e,s,a,r,n,o,i,l,c){ia=!1,jr=null,C0.apply(A0,arguments)}function P0(e,s,a,r,n,o,i,l,c){if(T0.apply(this,arguments),ia){if(ia){var d=jr;ia=!1,jr=null}else throw Error(S(198));Nr||(Nr=!0,mo=d)}}function ls(e){var s=e,a=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(a=s.return),e=s.return;while(e)}return s.tag===3?a:null}function Qc(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function sl(e){if(ls(e)!==e)throw Error(S(188))}function I0(e){var s=e.alternate;if(!s){if(s=ls(e),s===null)throw Error(S(188));return s!==e?null:e}for(var a=e,r=s;;){var n=a.return;if(n===null)break;var o=n.alternate;if(o===null){if(r=n.return,r!==null){a=r;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===a)return sl(n),e;if(o===r)return sl(n),s;o=o.sibling}throw Error(S(188))}if(a.return!==r.return)a=n,r=o;else{for(var i=!1,l=n.child;l;){if(l===a){i=!0,a=n,r=o;break}if(l===r){i=!0,r=n,a=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===a){i=!0,a=o,r=n;break}if(l===r){i=!0,r=o,a=n;break}l=l.sibling}if(!i)throw Error(S(189))}}if(a.alternate!==r)throw Error(S(190))}if(a.tag!==3)throw Error(S(188));return a.stateNode.current===a?e:s}function Yc(e){return e=I0(e),e!==null?Xc(e):null}function Xc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=Xc(e);if(s!==null)return s;e=e.sibling}return null}var Jc=Me.unstable_scheduleCallback,al=Me.unstable_cancelCallback,E0=Me.unstable_shouldYield,R0=Me.unstable_requestPaint,oe=Me.unstable_now,L0=Me.unstable_getCurrentPriorityLevel,ai=Me.unstable_ImmediatePriority,ed=Me.unstable_UserBlockingPriority,kr=Me.unstable_NormalPriority,O0=Me.unstable_LowPriority,td=Me.unstable_IdlePriority,Zr=null,ot=null;function D0(e){if(ot&&typeof ot.onCommitFiberRoot=="function")try{ot.onCommitFiberRoot(Zr,e,void 0,(e.current.flags&128)===128)}catch{}}var Xe=Math.clz32?Math.clz32:G0,M0=Math.log,V0=Math.LN2;function G0(e){return e>>>=0,e===0?32:31-(M0(e)/V0|0)|0}var za=64,$a=4194304;function sa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Sr(e,s){var a=e.pendingLanes;if(a===0)return 0;var r=0,n=e.suspendedLanes,o=e.pingedLanes,i=a&268435455;if(i!==0){var l=i&~n;l!==0?r=sa(l):(o&=i,o!==0&&(r=sa(o)))}else i=a&~n,i!==0?r=sa(i):o!==0&&(r=sa(o));if(r===0)return 0;if(s!==0&&s!==r&&!(s&n)&&(n=r&-r,o=s&-s,n>=o||n===16&&(o&4194240)!==0))return s;if(r&4&&(r|=a&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=r;0<s;)a=31-Xe(s),n=1<<a,r|=e[a],s&=~n;return r}function H0(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F0(e,s){for(var a=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-Xe(o),l=1<<i,c=n[i];c===-1?(!(l&a)||l&r)&&(n[i]=H0(l,s)):c<=s&&(e.expiredLanes|=l),o&=~l}}function ho(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sd(){var e=za;return za<<=1,!(za&4194240)&&(za=64),e}function xn(e){for(var s=[],a=0;31>a;a++)s.push(e);return s}function La(e,s,a){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-Xe(s),e[s]=a}function W0(e,s){var a=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<a;){var n=31-Xe(a),o=1<<n;s[n]=0,r[n]=-1,e[n]=-1,a&=~o}}function ri(e,s){var a=e.entangledLanes|=s;for(e=e.entanglements;a;){var r=31-Xe(a),n=1<<r;n&s|e[r]&s&&(e[r]|=s),a&=~n}}var Z=0;function ad(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var rd,ni,nd,od,id,go=!1,Ba=[],Tt=null,Pt=null,It=null,ya=new Map,ba=new Map,kt=[],U0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rl(e,s){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":ya.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ba.delete(s.pointerId)}}function Bs(e,s,a,r,n,o){return e===null||e.nativeEvent!==o?(e={blockedOn:s,domEventName:a,eventSystemFlags:r,nativeEvent:o,targetContainers:[n]},s!==null&&(s=Da(s),s!==null&&ni(s)),e):(e.eventSystemFlags|=r,s=e.targetContainers,n!==null&&s.indexOf(n)===-1&&s.push(n),e)}function z0(e,s,a,r,n){switch(s){case"focusin":return Tt=Bs(Tt,e,s,a,r,n),!0;case"dragenter":return Pt=Bs(Pt,e,s,a,r,n),!0;case"mouseover":return It=Bs(It,e,s,a,r,n),!0;case"pointerover":var o=n.pointerId;return ya.set(o,Bs(ya.get(o)||null,e,s,a,r,n)),!0;case"gotpointercapture":return o=n.pointerId,ba.set(o,Bs(ba.get(o)||null,e,s,a,r,n)),!0}return!1}function ld(e){var s=Kt(e.target);if(s!==null){var a=ls(s);if(a!==null){if(s=a.tag,s===13){if(s=Qc(a),s!==null){e.blockedOn=s,id(e.priority,function(){nd(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ur(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var a=xo(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var r=new a.constructor(a.type,a);co=r,a.target.dispatchEvent(r),co=null}else return s=Da(a),s!==null&&ni(s),e.blockedOn=a,!1;s.shift()}return!0}function nl(e,s,a){ur(e)&&a.delete(s)}function $0(){go=!1,Tt!==null&&ur(Tt)&&(Tt=null),Pt!==null&&ur(Pt)&&(Pt=null),It!==null&&ur(It)&&(It=null),ya.forEach(nl),ba.forEach(nl)}function Zs(e,s){e.blockedOn===s&&(e.blockedOn=null,go||(go=!0,Me.unstable_scheduleCallback(Me.unstable_NormalPriority,$0)))}function _a(e){function s(n){return Zs(n,e)}if(0<Ba.length){Zs(Ba[0],e);for(var a=1;a<Ba.length;a++){var r=Ba[a];r.blockedOn===e&&(r.blockedOn=null)}}for(Tt!==null&&Zs(Tt,e),Pt!==null&&Zs(Pt,e),It!==null&&Zs(It,e),ya.forEach(s),ba.forEach(s),a=0;a<kt.length;a++)r=kt[a],r.blockedOn===e&&(r.blockedOn=null);for(;0<kt.length&&(a=kt[0],a.blockedOn===null);)ld(a),a.blockedOn===null&&kt.shift()}var Ps=bt.ReactCurrentBatchConfig,Cr=!0;function B0(e,s,a,r){var n=Z,o=Ps.transition;Ps.transition=null;try{Z=1,oi(e,s,a,r)}finally{Z=n,Ps.transition=o}}function Z0(e,s,a,r){var n=Z,o=Ps.transition;Ps.transition=null;try{Z=4,oi(e,s,a,r)}finally{Z=n,Ps.transition=o}}function oi(e,s,a,r){if(Cr){var n=xo(e,s,a,r);if(n===null)Sn(e,s,r,Ar,a),rl(e,r);else if(z0(n,e,s,a,r))r.stopPropagation();else if(rl(e,r),s&4&&-1<U0.indexOf(e)){for(;n!==null;){var o=Da(n);if(o!==null&&rd(o),o=xo(e,s,a,r),o===null&&Sn(e,s,r,Ar,a),o===n)break;n=o}n!==null&&r.stopPropagation()}else Sn(e,s,r,null,a)}}var Ar=null;function xo(e,s,a,r){if(Ar=null,e=si(r),e=Kt(e),e!==null)if(s=ls(e),s===null)e=null;else if(a=s.tag,a===13){if(e=Qc(s),e!==null)return e;e=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return Ar=e,null}function cd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(L0()){case ai:return 1;case ed:return 4;case kr:case O0:return 16;case td:return 536870912;default:return 16}default:return 16}}var Ct=null,ii=null,pr=null;function dd(){if(pr)return pr;var e,s=ii,a=s.length,r,n="value"in Ct?Ct.value:Ct.textContent,o=n.length;for(e=0;e<a&&s[e]===n[e];e++);var i=a-e;for(r=1;r<=i&&s[a-r]===n[o-r];r++);return pr=n.slice(e,1<r?1-r:void 0)}function mr(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function Za(){return!0}function ol(){return!1}function Ge(e){function s(a,r,n,o,i){this._reactName=a,this._targetInst=n,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(a=e[l],this[l]=a?a(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Za:ol,this.isPropagationStopped=ol,this}return ae(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Za)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Za)},persist:function(){},isPersistent:Za}),s}var Ws={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},li=Ge(Ws),Oa=ae({},Ws,{view:0,detail:0}),q0=Ge(Oa),fn,vn,qs,qr=ae({},Oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ci,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==qs&&(qs&&e.type==="mousemove"?(fn=e.screenX-qs.screenX,vn=e.screenY-qs.screenY):vn=fn=0,qs=e),fn)},movementY:function(e){return"movementY"in e?e.movementY:vn}}),il=Ge(qr),K0=ae({},qr,{dataTransfer:0}),Q0=Ge(K0),Y0=ae({},Oa,{relatedTarget:0}),yn=Ge(Y0),X0=ae({},Ws,{animationName:0,elapsedTime:0,pseudoElement:0}),J0=Ge(X0),ep=ae({},Ws,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),tp=Ge(ep),sp=ae({},Ws,{data:0}),ll=Ge(sp),ap={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},np={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function op(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=np[e])?!!s[e]:!1}function ci(){return op}var ip=ae({},Oa,{key:function(e){if(e.key){var s=ap[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=mr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?rp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ci,charCode:function(e){return e.type==="keypress"?mr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lp=Ge(ip),cp=ae({},qr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cl=Ge(cp),dp=ae({},Oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ci}),up=Ge(dp),pp=ae({},Ws,{propertyName:0,elapsedTime:0,pseudoElement:0}),mp=Ge(pp),hp=ae({},qr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gp=Ge(hp),xp=[9,13,27,32],di=xt&&"CompositionEvent"in window,la=null;xt&&"documentMode"in document&&(la=document.documentMode);var fp=xt&&"TextEvent"in window&&!la,ud=xt&&(!di||la&&8<la&&11>=la),dl=" ",ul=!1;function pd(e,s){switch(e){case"keyup":return xp.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function md(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fs=!1;function vp(e,s){switch(e){case"compositionend":return md(s);case"keypress":return s.which!==32?null:(ul=!0,dl);case"textInput":return e=s.data,e===dl&&ul?null:e;default:return null}}function yp(e,s){if(fs)return e==="compositionend"||!di&&pd(e,s)?(e=dd(),pr=ii=Ct=null,fs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ud&&s.locale!=="ko"?null:s.data;default:return null}}var bp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pl(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!bp[e.type]:s==="textarea"}function hd(e,s,a,r){$c(r),s=Tr(s,"onChange"),0<s.length&&(a=new li("onChange","change",null,a,r),e.push({event:a,listeners:s}))}var ca=null,wa=null;function _p(e){kd(e,0)}function Kr(e){var s=bs(e);if(Vc(s))return e}function wp(e,s){if(e==="change")return s}var gd=!1;if(xt){var bn;if(xt){var _n="oninput"in document;if(!_n){var ml=document.createElement("div");ml.setAttribute("oninput","return;"),_n=typeof ml.oninput=="function"}bn=_n}else bn=!1;gd=bn&&(!document.documentMode||9<document.documentMode)}function hl(){ca&&(ca.detachEvent("onpropertychange",xd),wa=ca=null)}function xd(e){if(e.propertyName==="value"&&Kr(wa)){var s=[];hd(s,wa,e,si(e)),Kc(_p,s)}}function jp(e,s,a){e==="focusin"?(hl(),ca=s,wa=a,ca.attachEvent("onpropertychange",xd)):e==="focusout"&&hl()}function Np(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kr(wa)}function kp(e,s){if(e==="click")return Kr(s)}function Sp(e,s){if(e==="input"||e==="change")return Kr(s)}function Cp(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var et=typeof Object.is=="function"?Object.is:Cp;function ja(e,s){if(et(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var a=Object.keys(e),r=Object.keys(s);if(a.length!==r.length)return!1;for(r=0;r<a.length;r++){var n=a[r];if(!Yn.call(s,n)||!et(e[n],s[n]))return!1}return!0}function gl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xl(e,s){var a=gl(e);e=0;for(var r;a;){if(a.nodeType===3){if(r=e+a.textContent.length,e<=s&&r>=s)return{node:a,offset:s-e};e=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=gl(a)}}function fd(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?fd(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function vd(){for(var e=window,s=wr();s instanceof e.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)e=s.contentWindow;else break;s=wr(e.document)}return s}function ui(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function Ap(e){var s=vd(),a=e.focusedElem,r=e.selectionRange;if(s!==a&&a&&a.ownerDocument&&fd(a.ownerDocument.documentElement,a)){if(r!==null&&ui(a)){if(s=r.start,e=r.end,e===void 0&&(e=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(e,a.value.length);else if(e=(s=a.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var n=a.textContent.length,o=Math.min(r.start,n);r=r.end===void 0?o:Math.min(r.end,n),!e.extend&&o>r&&(n=r,r=o,o=n),n=xl(a,o);var i=xl(a,r);n&&i&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(s=s.createRange(),s.setStart(n.node,n.offset),e.removeAllRanges(),o>r?(e.addRange(s),e.extend(i.node,i.offset)):(s.setEnd(i.node,i.offset),e.addRange(s)))}}for(s=[],e=a;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)e=s[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Tp=xt&&"documentMode"in document&&11>=document.documentMode,vs=null,fo=null,da=null,vo=!1;function fl(e,s,a){var r=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;vo||vs==null||vs!==wr(r)||(r=vs,"selectionStart"in r&&ui(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),da&&ja(da,r)||(da=r,r=Tr(fo,"onSelect"),0<r.length&&(s=new li("onSelect","select",null,s,a),e.push({event:s,listeners:r}),s.target=vs)))}function qa(e,s){var a={};return a[e.toLowerCase()]=s.toLowerCase(),a["Webkit"+e]="webkit"+s,a["Moz"+e]="moz"+s,a}var ys={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},wn={},yd={};xt&&(yd=document.createElement("div").style,"AnimationEvent"in window||(delete ys.animationend.animation,delete ys.animationiteration.animation,delete ys.animationstart.animation),"TransitionEvent"in window||delete ys.transitionend.transition);function Qr(e){if(wn[e])return wn[e];if(!ys[e])return e;var s=ys[e],a;for(a in s)if(s.hasOwnProperty(a)&&a in yd)return wn[e]=s[a];return e}var bd=Qr("animationend"),_d=Qr("animationiteration"),wd=Qr("animationstart"),jd=Qr("transitionend"),Nd=new Map,vl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gt(e,s){Nd.set(e,s),is(s,[e])}for(var jn=0;jn<vl.length;jn++){var Nn=vl[jn],Pp=Nn.toLowerCase(),Ip=Nn[0].toUpperCase()+Nn.slice(1);Gt(Pp,"on"+Ip)}Gt(bd,"onAnimationEnd");Gt(_d,"onAnimationIteration");Gt(wd,"onAnimationStart");Gt("dblclick","onDoubleClick");Gt("focusin","onFocus");Gt("focusout","onBlur");Gt(jd,"onTransitionEnd");Rs("onMouseEnter",["mouseout","mouseover"]);Rs("onMouseLeave",["mouseout","mouseover"]);Rs("onPointerEnter",["pointerout","pointerover"]);Rs("onPointerLeave",["pointerout","pointerover"]);is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));is("onBeforeInput",["compositionend","keypress","textInput","paste"]);is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var aa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ep=new Set("cancel close invalid load scroll toggle".split(" ").concat(aa));function yl(e,s,a){var r=e.type||"unknown-event";e.currentTarget=a,P0(r,s,void 0,e),e.currentTarget=null}function kd(e,s){s=(s&4)!==0;for(var a=0;a<e.length;a++){var r=e[a],n=r.event;r=r.listeners;e:{var o=void 0;if(s)for(var i=r.length-1;0<=i;i--){var l=r[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&n.isPropagationStopped())break e;yl(n,l,d),o=c}else for(i=0;i<r.length;i++){if(l=r[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&n.isPropagationStopped())break e;yl(n,l,d),o=c}}}if(Nr)throw e=mo,Nr=!1,mo=null,e}function Q(e,s){var a=s[jo];a===void 0&&(a=s[jo]=new Set);var r=e+"__bubble";a.has(r)||(Sd(s,e,2,!1),a.add(r))}function kn(e,s,a){var r=0;s&&(r|=4),Sd(a,e,r,s)}var Ka="_reactListening"+Math.random().toString(36).slice(2);function Na(e){if(!e[Ka]){e[Ka]=!0,Rc.forEach(function(a){a!=="selectionchange"&&(Ep.has(a)||kn(a,!1,e),kn(a,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[Ka]||(s[Ka]=!0,kn("selectionchange",!1,s))}}function Sd(e,s,a,r){switch(cd(s)){case 1:var n=B0;break;case 4:n=Z0;break;default:n=oi}a=n.bind(null,s,a,e),n=void 0,!po||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(n=!0),r?n!==void 0?e.addEventListener(s,a,{capture:!0,passive:n}):e.addEventListener(s,a,!0):n!==void 0?e.addEventListener(s,a,{passive:n}):e.addEventListener(s,a,!1)}function Sn(e,s,a,r,n){var o=r;if(!(s&1)&&!(s&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;l!==null;){if(i=Kt(l),i===null)return;if(c=i.tag,c===5||c===6){r=o=i;continue e}l=l.parentNode}}r=r.return}Kc(function(){var d=o,u=si(a),p=[];e:{var h=Nd.get(e);if(h!==void 0){var y=li,j=e;switch(e){case"keypress":if(mr(a)===0)break e;case"keydown":case"keyup":y=lp;break;case"focusin":j="focus",y=yn;break;case"focusout":j="blur",y=yn;break;case"beforeblur":case"afterblur":y=yn;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=il;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Q0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=up;break;case bd:case _d:case wd:y=J0;break;case jd:y=mp;break;case"scroll":y=q0;break;case"wheel":y=gp;break;case"copy":case"cut":case"paste":y=tp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=cl}var v=(s&4)!==0,L=!v&&e==="scroll",x=v?h!==null?h+"Capture":null:h;v=[];for(var m=d,g;m!==null;){g=m;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,x!==null&&(w=va(m,x),w!=null&&v.push(ka(m,w,g)))),L)break;m=m.return}0<v.length&&(h=new y(h,j,null,a,u),p.push({event:h,listeners:v}))}}if(!(s&7)){e:{if(h=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",h&&a!==co&&(j=a.relatedTarget||a.fromElement)&&(Kt(j)||j[ft]))break e;if((y||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,y?(j=a.relatedTarget||a.toElement,y=d,j=j?Kt(j):null,j!==null&&(L=ls(j),j!==L||j.tag!==5&&j.tag!==6)&&(j=null)):(y=null,j=d),y!==j)){if(v=il,w="onMouseLeave",x="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(v=cl,w="onPointerLeave",x="onPointerEnter",m="pointer"),L=y==null?h:bs(y),g=j==null?h:bs(j),h=new v(w,m+"leave",y,a,u),h.target=L,h.relatedTarget=g,w=null,Kt(u)===d&&(v=new v(x,m+"enter",j,a,u),v.target=g,v.relatedTarget=L,w=v),L=w,y&&j)t:{for(v=y,x=j,m=0,g=v;g;g=cs(g))m++;for(g=0,w=x;w;w=cs(w))g++;for(;0<m-g;)v=cs(v),m--;for(;0<g-m;)x=cs(x),g--;for(;m--;){if(v===x||x!==null&&v===x.alternate)break t;v=cs(v),x=cs(x)}v=null}else v=null;y!==null&&bl(p,h,y,v,!1),j!==null&&L!==null&&bl(p,L,j,v,!0)}}e:{if(h=d?bs(d):window,y=h.nodeName&&h.nodeName.toLowerCase(),y==="select"||y==="input"&&h.type==="file")var N=wp;else if(pl(h))if(gd)N=Sp;else{N=Np;var k=jp}else(y=h.nodeName)&&y.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=kp);if(N&&(N=N(e,d))){hd(p,N,a,u);break e}k&&k(e,h,d),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&ro(h,"number",h.value)}switch(k=d?bs(d):window,e){case"focusin":(pl(k)||k.contentEditable==="true")&&(vs=k,fo=d,da=null);break;case"focusout":da=fo=vs=null;break;case"mousedown":vo=!0;break;case"contextmenu":case"mouseup":case"dragend":vo=!1,fl(p,a,u);break;case"selectionchange":if(Tp)break;case"keydown":case"keyup":fl(p,a,u)}var C;if(di)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else fs?pd(e,a)&&(O="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(O="onCompositionStart");O&&(ud&&a.locale!=="ko"&&(fs||O!=="onCompositionStart"?O==="onCompositionEnd"&&fs&&(C=dd()):(Ct=u,ii="value"in Ct?Ct.value:Ct.textContent,fs=!0)),k=Tr(d,O),0<k.length&&(O=new ll(O,e,null,a,u),p.push({event:O,listeners:k}),C?O.data=C:(C=md(a),C!==null&&(O.data=C)))),(C=fp?vp(e,a):yp(e,a))&&(d=Tr(d,"onBeforeInput"),0<d.length&&(u=new ll("onBeforeInput","beforeinput",null,a,u),p.push({event:u,listeners:d}),u.data=C))}kd(p,s)})}function ka(e,s,a){return{instance:e,listener:s,currentTarget:a}}function Tr(e,s){for(var a=s+"Capture",r=[];e!==null;){var n=e,o=n.stateNode;n.tag===5&&o!==null&&(n=o,o=va(e,a),o!=null&&r.unshift(ka(e,o,n)),o=va(e,s),o!=null&&r.push(ka(e,o,n))),e=e.return}return r}function cs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bl(e,s,a,r,n){for(var o=s._reactName,i=[];a!==null&&a!==r;){var l=a,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,n?(c=va(a,o),c!=null&&i.unshift(ka(a,c,l))):n||(c=va(a,o),c!=null&&i.push(ka(a,c,l)))),a=a.return}i.length!==0&&e.push({event:s,listeners:i})}var Rp=/\r\n?/g,Lp=/\u0000|\uFFFD/g;function _l(e){return(typeof e=="string"?e:""+e).replace(Rp,`
`).replace(Lp,"")}function Qa(e,s,a){if(s=_l(s),_l(e)!==s&&a)throw Error(S(425))}function Pr(){}var yo=null,bo=null;function _o(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var wo=typeof setTimeout=="function"?setTimeout:void 0,Op=typeof clearTimeout=="function"?clearTimeout:void 0,wl=typeof Promise=="function"?Promise:void 0,Dp=typeof queueMicrotask=="function"?queueMicrotask:typeof wl<"u"?function(e){return wl.resolve(null).then(e).catch(Mp)}:wo;function Mp(e){setTimeout(function(){throw e})}function Cn(e,s){var a=s,r=0;do{var n=a.nextSibling;if(e.removeChild(a),n&&n.nodeType===8)if(a=n.data,a==="/$"){if(r===0){e.removeChild(n),_a(s);return}r--}else a!=="$"&&a!=="$?"&&a!=="$!"||r++;a=n}while(a);_a(s)}function Et(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function jl(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return e;s--}else a==="/$"&&s++}e=e.previousSibling}return null}var Us=Math.random().toString(36).slice(2),nt="__reactFiber$"+Us,Sa="__reactProps$"+Us,ft="__reactContainer$"+Us,jo="__reactEvents$"+Us,Vp="__reactListeners$"+Us,Gp="__reactHandles$"+Us;function Kt(e){var s=e[nt];if(s)return s;for(var a=e.parentNode;a;){if(s=a[ft]||a[nt]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(e=jl(e);e!==null;){if(a=e[nt])return a;e=jl(e)}return s}e=a,a=e.parentNode}return null}function Da(e){return e=e[nt]||e[ft],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(S(33))}function Yr(e){return e[Sa]||null}var No=[],_s=-1;function Ht(e){return{current:e}}function Y(e){0>_s||(e.current=No[_s],No[_s]=null,_s--)}function K(e,s){_s++,No[_s]=e.current,e.current=s}var Vt={},we=Ht(Vt),Ie=Ht(!1),ts=Vt;function Ls(e,s){var a=e.type.contextTypes;if(!a)return Vt;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===s)return r.__reactInternalMemoizedMaskedChildContext;var n={},o;for(o in a)n[o]=s[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=n),n}function Ee(e){return e=e.childContextTypes,e!=null}function Ir(){Y(Ie),Y(we)}function Nl(e,s,a){if(we.current!==Vt)throw Error(S(168));K(we,s),K(Ie,a)}function Cd(e,s,a){var r=e.stateNode;if(s=s.childContextTypes,typeof r.getChildContext!="function")return a;r=r.getChildContext();for(var n in r)if(!(n in s))throw Error(S(108,j0(e)||"Unknown",n));return ae({},a,r)}function Er(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vt,ts=we.current,K(we,e),K(Ie,Ie.current),!0}function kl(e,s,a){var r=e.stateNode;if(!r)throw Error(S(169));a?(e=Cd(e,s,ts),r.__reactInternalMemoizedMergedChildContext=e,Y(Ie),Y(we),K(we,e)):Y(Ie),K(Ie,a)}var pt=null,Xr=!1,An=!1;function Ad(e){pt===null?pt=[e]:pt.push(e)}function Hp(e){Xr=!0,Ad(e)}function Ft(){if(!An&&pt!==null){An=!0;var e=0,s=Z;try{var a=pt;for(Z=1;e<a.length;e++){var r=a[e];do r=r(!0);while(r!==null)}pt=null,Xr=!1}catch(n){throw pt!==null&&(pt=pt.slice(e+1)),Jc(ai,Ft),n}finally{Z=s,An=!1}}return null}var ws=[],js=0,Rr=null,Lr=0,Fe=[],We=0,ss=null,mt=1,ht="";function Bt(e,s){ws[js++]=Lr,ws[js++]=Rr,Rr=e,Lr=s}function Td(e,s,a){Fe[We++]=mt,Fe[We++]=ht,Fe[We++]=ss,ss=e;var r=mt;e=ht;var n=32-Xe(r)-1;r&=~(1<<n),a+=1;var o=32-Xe(s)+n;if(30<o){var i=n-n%5;o=(r&(1<<i)-1).toString(32),r>>=i,n-=i,mt=1<<32-Xe(s)+n|a<<n|r,ht=o+e}else mt=1<<o|a<<n|r,ht=e}function pi(e){e.return!==null&&(Bt(e,1),Td(e,1,0))}function mi(e){for(;e===Rr;)Rr=ws[--js],ws[js]=null,Lr=ws[--js],ws[js]=null;for(;e===ss;)ss=Fe[--We],Fe[We]=null,ht=Fe[--We],Fe[We]=null,mt=Fe[--We],Fe[We]=null}var De=null,Oe=null,X=!1,Ye=null;function Pd(e,s){var a=Ue(5,null,null,0);a.elementType="DELETED",a.stateNode=s,a.return=e,s=e.deletions,s===null?(e.deletions=[a],e.flags|=16):s.push(a)}function Sl(e,s){switch(e.tag){case 5:var a=e.type;return s=s.nodeType!==1||a.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,De=e,Oe=Et(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,De=e,Oe=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(a=ss!==null?{id:mt,overflow:ht}:null,e.memoizedState={dehydrated:s,treeContext:a,retryLane:1073741824},a=Ue(18,null,null,0),a.stateNode=s,a.return=e,e.child=a,De=e,Oe=null,!0):!1;default:return!1}}function ko(e){return(e.mode&1)!==0&&(e.flags&128)===0}function So(e){if(X){var s=Oe;if(s){var a=s;if(!Sl(e,s)){if(ko(e))throw Error(S(418));s=Et(a.nextSibling);var r=De;s&&Sl(e,s)?Pd(r,a):(e.flags=e.flags&-4097|2,X=!1,De=e)}}else{if(ko(e))throw Error(S(418));e.flags=e.flags&-4097|2,X=!1,De=e}}}function Cl(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;De=e}function Ya(e){if(e!==De)return!1;if(!X)return Cl(e),X=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!_o(e.type,e.memoizedProps)),s&&(s=Oe)){if(ko(e))throw Id(),Error(S(418));for(;s;)Pd(e,s),s=Et(s.nextSibling)}if(Cl(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(S(317));e:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(s===0){Oe=Et(e.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++}e=e.nextSibling}Oe=null}}else Oe=De?Et(e.stateNode.nextSibling):null;return!0}function Id(){for(var e=Oe;e;)e=Et(e.nextSibling)}function Os(){Oe=De=null,X=!1}function hi(e){Ye===null?Ye=[e]:Ye.push(e)}var Fp=bt.ReactCurrentBatchConfig;function Ks(e,s,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(S(309));var r=a.stateNode}if(!r)throw Error(S(147,e));var n=r,o=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===o?s.ref:(s=function(i){var l=n.refs;i===null?delete l[o]:l[o]=i},s._stringRef=o,s)}if(typeof e!="string")throw Error(S(284));if(!a._owner)throw Error(S(290,e))}return e}function Xa(e,s){throw e=Object.prototype.toString.call(s),Error(S(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function Al(e){var s=e._init;return s(e._payload)}function Ed(e){function s(x,m){if(e){var g=x.deletions;g===null?(x.deletions=[m],x.flags|=16):g.push(m)}}function a(x,m){if(!e)return null;for(;m!==null;)s(x,m),m=m.sibling;return null}function r(x,m){for(x=new Map;m!==null;)m.key!==null?x.set(m.key,m):x.set(m.index,m),m=m.sibling;return x}function n(x,m){return x=Dt(x,m),x.index=0,x.sibling=null,x}function o(x,m,g){return x.index=g,e?(g=x.alternate,g!==null?(g=g.index,g<m?(x.flags|=2,m):g):(x.flags|=2,m)):(x.flags|=1048576,m)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,m,g,w){return m===null||m.tag!==6?(m=On(g,x.mode,w),m.return=x,m):(m=n(m,g),m.return=x,m)}function c(x,m,g,w){var N=g.type;return N===xs?u(x,m,g.props.children,w,g.key):m!==null&&(m.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===jt&&Al(N)===m.type)?(w=n(m,g.props),w.ref=Ks(x,m,g),w.return=x,w):(w=br(g.type,g.key,g.props,null,x.mode,w),w.ref=Ks(x,m,g),w.return=x,w)}function d(x,m,g,w){return m===null||m.tag!==4||m.stateNode.containerInfo!==g.containerInfo||m.stateNode.implementation!==g.implementation?(m=Dn(g,x.mode,w),m.return=x,m):(m=n(m,g.children||[]),m.return=x,m)}function u(x,m,g,w,N){return m===null||m.tag!==7?(m=es(g,x.mode,w,N),m.return=x,m):(m=n(m,g),m.return=x,m)}function p(x,m,g){if(typeof m=="string"&&m!==""||typeof m=="number")return m=On(""+m,x.mode,g),m.return=x,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Fa:return g=br(m.type,m.key,m.props,null,x.mode,g),g.ref=Ks(x,null,m),g.return=x,g;case gs:return m=Dn(m,x.mode,g),m.return=x,m;case jt:var w=m._init;return p(x,w(m._payload),g)}if(ta(m)||zs(m))return m=es(m,x.mode,g,null),m.return=x,m;Xa(x,m)}return null}function h(x,m,g,w){var N=m!==null?m.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return N!==null?null:l(x,m,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Fa:return g.key===N?c(x,m,g,w):null;case gs:return g.key===N?d(x,m,g,w):null;case jt:return N=g._init,h(x,m,N(g._payload),w)}if(ta(g)||zs(g))return N!==null?null:u(x,m,g,w,null);Xa(x,g)}return null}function y(x,m,g,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(g)||null,l(m,x,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fa:return x=x.get(w.key===null?g:w.key)||null,c(m,x,w,N);case gs:return x=x.get(w.key===null?g:w.key)||null,d(m,x,w,N);case jt:var k=w._init;return y(x,m,g,k(w._payload),N)}if(ta(w)||zs(w))return x=x.get(g)||null,u(m,x,w,N,null);Xa(m,w)}return null}function j(x,m,g,w){for(var N=null,k=null,C=m,O=m=0,P=null;C!==null&&O<g.length;O++){C.index>O?(P=C,C=null):P=C.sibling;var I=h(x,C,g[O],w);if(I===null){C===null&&(C=P);break}e&&C&&I.alternate===null&&s(x,C),m=o(I,m,O),k===null?N=I:k.sibling=I,k=I,C=P}if(O===g.length)return a(x,C),X&&Bt(x,O),N;if(C===null){for(;O<g.length;O++)C=p(x,g[O],w),C!==null&&(m=o(C,m,O),k===null?N=C:k.sibling=C,k=C);return X&&Bt(x,O),N}for(C=r(x,C);O<g.length;O++)P=y(C,x,O,g[O],w),P!==null&&(e&&P.alternate!==null&&C.delete(P.key===null?O:P.key),m=o(P,m,O),k===null?N=P:k.sibling=P,k=P);return e&&C.forEach(function(W){return s(x,W)}),X&&Bt(x,O),N}function v(x,m,g,w){var N=zs(g);if(typeof N!="function")throw Error(S(150));if(g=N.call(g),g==null)throw Error(S(151));for(var k=N=null,C=m,O=m=0,P=null,I=g.next();C!==null&&!I.done;O++,I=g.next()){C.index>O?(P=C,C=null):P=C.sibling;var W=h(x,C,I.value,w);if(W===null){C===null&&(C=P);break}e&&C&&W.alternate===null&&s(x,C),m=o(W,m,O),k===null?N=W:k.sibling=W,k=W,C=P}if(I.done)return a(x,C),X&&Bt(x,O),N;if(C===null){for(;!I.done;O++,I=g.next())I=p(x,I.value,w),I!==null&&(m=o(I,m,O),k===null?N=I:k.sibling=I,k=I);return X&&Bt(x,O),N}for(C=r(x,C);!I.done;O++,I=g.next())I=y(C,x,O,I.value,w),I!==null&&(e&&I.alternate!==null&&C.delete(I.key===null?O:I.key),m=o(I,m,O),k===null?N=I:k.sibling=I,k=I);return e&&C.forEach(function(B){return s(x,B)}),X&&Bt(x,O),N}function L(x,m,g,w){if(typeof g=="object"&&g!==null&&g.type===xs&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Fa:e:{for(var N=g.key,k=m;k!==null;){if(k.key===N){if(N=g.type,N===xs){if(k.tag===7){a(x,k.sibling),m=n(k,g.props.children),m.return=x,x=m;break e}}else if(k.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===jt&&Al(N)===k.type){a(x,k.sibling),m=n(k,g.props),m.ref=Ks(x,k,g),m.return=x,x=m;break e}a(x,k);break}else s(x,k);k=k.sibling}g.type===xs?(m=es(g.props.children,x.mode,w,g.key),m.return=x,x=m):(w=br(g.type,g.key,g.props,null,x.mode,w),w.ref=Ks(x,m,g),w.return=x,x=w)}return i(x);case gs:e:{for(k=g.key;m!==null;){if(m.key===k)if(m.tag===4&&m.stateNode.containerInfo===g.containerInfo&&m.stateNode.implementation===g.implementation){a(x,m.sibling),m=n(m,g.children||[]),m.return=x,x=m;break e}else{a(x,m);break}else s(x,m);m=m.sibling}m=Dn(g,x.mode,w),m.return=x,x=m}return i(x);case jt:return k=g._init,L(x,m,k(g._payload),w)}if(ta(g))return j(x,m,g,w);if(zs(g))return v(x,m,g,w);Xa(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,m!==null&&m.tag===6?(a(x,m.sibling),m=n(m,g),m.return=x,x=m):(a(x,m),m=On(g,x.mode,w),m.return=x,x=m),i(x)):a(x,m)}return L}var Ds=Ed(!0),Rd=Ed(!1),Or=Ht(null),Dr=null,Ns=null,gi=null;function xi(){gi=Ns=Dr=null}function fi(e){var s=Or.current;Y(Or),e._currentValue=s}function Co(e,s,a){for(;e!==null;){var r=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,r!==null&&(r.childLanes|=s)):r!==null&&(r.childLanes&s)!==s&&(r.childLanes|=s),e===a)break;e=e.return}}function Is(e,s){Dr=e,gi=Ns=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(Pe=!0),e.firstContext=null)}function $e(e){var s=e._currentValue;if(gi!==e)if(e={context:e,memoizedValue:s,next:null},Ns===null){if(Dr===null)throw Error(S(308));Ns=e,Dr.dependencies={lanes:0,firstContext:e}}else Ns=Ns.next=e;return s}var Qt=null;function vi(e){Qt===null?Qt=[e]:Qt.push(e)}function Ld(e,s,a,r){var n=s.interleaved;return n===null?(a.next=a,vi(s)):(a.next=n.next,n.next=a),s.interleaved=a,vt(e,r)}function vt(e,s){e.lanes|=s;var a=e.alternate;for(a!==null&&(a.lanes|=s),a=e,e=e.return;e!==null;)e.childLanes|=s,a=e.alternate,a!==null&&(a.childLanes|=s),a=e,e=e.return;return a.tag===3?a.stateNode:null}var Nt=!1;function yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Od(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gt(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function Rt(e,s,a){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,z&2){var n=r.pending;return n===null?s.next=s:(s.next=n.next,n.next=s),r.pending=s,vt(e,a)}return n=r.interleaved,n===null?(s.next=s,vi(r)):(s.next=n.next,n.next=s),r.interleaved=s,vt(e,a)}function hr(e,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194240)!==0)){var r=s.lanes;r&=e.pendingLanes,a|=r,s.lanes=a,ri(e,a)}}function Tl(e,s){var a=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,a===r)){var n=null,o=null;if(a=a.firstBaseUpdate,a!==null){do{var i={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};o===null?n=o=i:o=o.next=i,a=a.next}while(a!==null);o===null?n=o=s:o=o.next=s}else n=o=s;a={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=s:e.next=s,a.lastBaseUpdate=s}function Mr(e,s,a,r){var n=e.updateQueue;Nt=!1;var o=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var p=n.baseState;i=0,u=d=c=null,l=o;do{var h=l.lane,y=l.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var j=e,v=l;switch(h=s,y=a,v.tag){case 1:if(j=v.payload,typeof j=="function"){p=j.call(y,p,h);break e}p=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=v.payload,h=typeof j=="function"?j.call(y,p,h):j,h==null)break e;p=ae({},p,h);break e;case 2:Nt=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[l]:h.push(l))}else y={eventTime:y,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=y,c=p):u=u.next=y,i|=h;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;h=l,l=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(u===null&&(c=p),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=u,s=n.shared.interleaved,s!==null){n=s;do i|=n.lane,n=n.next;while(n!==s)}else o===null&&(n.shared.lanes=0);rs|=i,e.lanes=i,e.memoizedState=p}}function Pl(e,s,a){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var r=e[s],n=r.callback;if(n!==null){if(r.callback=null,r=a,typeof n!="function")throw Error(S(191,n));n.call(r)}}}var Ma={},it=Ht(Ma),Ca=Ht(Ma),Aa=Ht(Ma);function Yt(e){if(e===Ma)throw Error(S(174));return e}function bi(e,s){switch(K(Aa,s),K(Ca,e),K(it,Ma),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:oo(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=oo(s,e)}Y(it),K(it,s)}function Ms(){Y(it),Y(Ca),Y(Aa)}function Dd(e){Yt(Aa.current);var s=Yt(it.current),a=oo(s,e.type);s!==a&&(K(Ca,e),K(it,a))}function _i(e){Ca.current===e&&(Y(it),Y(Ca))}var te=Ht(0);function Vr(e){for(var s=e;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Tn=[];function wi(){for(var e=0;e<Tn.length;e++)Tn[e]._workInProgressVersionPrimary=null;Tn.length=0}var gr=bt.ReactCurrentDispatcher,Pn=bt.ReactCurrentBatchConfig,as=0,se=null,le=null,ue=null,Gr=!1,ua=!1,Ta=0,Wp=0;function ye(){throw Error(S(321))}function ji(e,s){if(s===null)return!1;for(var a=0;a<s.length&&a<e.length;a++)if(!et(e[a],s[a]))return!1;return!0}function Ni(e,s,a,r,n,o){if(as=o,se=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,gr.current=e===null||e.memoizedState===null?Bp:Zp,e=a(r,n),ua){o=0;do{if(ua=!1,Ta=0,25<=o)throw Error(S(301));o+=1,ue=le=null,s.updateQueue=null,gr.current=qp,e=a(r,n)}while(ua)}if(gr.current=Hr,s=le!==null&&le.next!==null,as=0,ue=le=se=null,Gr=!1,s)throw Error(S(300));return e}function ki(){var e=Ta!==0;return Ta=0,e}function rt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ue===null?se.memoizedState=ue=e:ue=ue.next=e,ue}function Be(){if(le===null){var e=se.alternate;e=e!==null?e.memoizedState:null}else e=le.next;var s=ue===null?se.memoizedState:ue.next;if(s!==null)ue=s,le=e;else{if(e===null)throw Error(S(310));le=e,e={memoizedState:le.memoizedState,baseState:le.baseState,baseQueue:le.baseQueue,queue:le.queue,next:null},ue===null?se.memoizedState=ue=e:ue=ue.next=e}return ue}function Pa(e,s){return typeof s=="function"?s(e):s}function In(e){var s=Be(),a=s.queue;if(a===null)throw Error(S(311));a.lastRenderedReducer=e;var r=le,n=r.baseQueue,o=a.pending;if(o!==null){if(n!==null){var i=n.next;n.next=o.next,o.next=i}r.baseQueue=n=o,a.pending=null}if(n!==null){o=n.next,r=r.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((as&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,i=r):c=c.next=p,se.lanes|=u,rs|=u}d=d.next}while(d!==null&&d!==o);c===null?i=r:c.next=l,et(r,s.memoizedState)||(Pe=!0),s.memoizedState=r,s.baseState=i,s.baseQueue=c,a.lastRenderedState=r}if(e=a.interleaved,e!==null){n=e;do o=n.lane,se.lanes|=o,rs|=o,n=n.next;while(n!==e)}else n===null&&(a.lanes=0);return[s.memoizedState,a.dispatch]}function En(e){var s=Be(),a=s.queue;if(a===null)throw Error(S(311));a.lastRenderedReducer=e;var r=a.dispatch,n=a.pending,o=s.memoizedState;if(n!==null){a.pending=null;var i=n=n.next;do o=e(o,i.action),i=i.next;while(i!==n);et(o,s.memoizedState)||(Pe=!0),s.memoizedState=o,s.baseQueue===null&&(s.baseState=o),a.lastRenderedState=o}return[o,r]}function Md(){}function Vd(e,s){var a=se,r=Be(),n=s(),o=!et(r.memoizedState,n);if(o&&(r.memoizedState=n,Pe=!0),r=r.queue,Si(Fd.bind(null,a,r,e),[e]),r.getSnapshot!==s||o||ue!==null&&ue.memoizedState.tag&1){if(a.flags|=2048,Ia(9,Hd.bind(null,a,r,n,s),void 0,null),pe===null)throw Error(S(349));as&30||Gd(a,s,n)}return n}function Gd(e,s,a){e.flags|=16384,e={getSnapshot:s,value:a},s=se.updateQueue,s===null?(s={lastEffect:null,stores:null},se.updateQueue=s,s.stores=[e]):(a=s.stores,a===null?s.stores=[e]:a.push(e))}function Hd(e,s,a,r){s.value=a,s.getSnapshot=r,Wd(s)&&Ud(e)}function Fd(e,s,a){return a(function(){Wd(s)&&Ud(e)})}function Wd(e){var s=e.getSnapshot;e=e.value;try{var a=s();return!et(e,a)}catch{return!0}}function Ud(e){var s=vt(e,1);s!==null&&Je(s,e,1,-1)}function Il(e){var s=rt();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:e},s.queue=e,e=e.dispatch=$p.bind(null,se,e),[s.memoizedState,e]}function Ia(e,s,a,r){return e={tag:e,create:s,destroy:a,deps:r,next:null},s=se.updateQueue,s===null?(s={lastEffect:null,stores:null},se.updateQueue=s,s.lastEffect=e.next=e):(a=s.lastEffect,a===null?s.lastEffect=e.next=e:(r=a.next,a.next=e,e.next=r,s.lastEffect=e)),e}function zd(){return Be().memoizedState}function xr(e,s,a,r){var n=rt();se.flags|=e,n.memoizedState=Ia(1|s,a,void 0,r===void 0?null:r)}function Jr(e,s,a,r){var n=Be();r=r===void 0?null:r;var o=void 0;if(le!==null){var i=le.memoizedState;if(o=i.destroy,r!==null&&ji(r,i.deps)){n.memoizedState=Ia(s,a,o,r);return}}se.flags|=e,n.memoizedState=Ia(1|s,a,o,r)}function El(e,s){return xr(8390656,8,e,s)}function Si(e,s){return Jr(2048,8,e,s)}function $d(e,s){return Jr(4,2,e,s)}function Bd(e,s){return Jr(4,4,e,s)}function Zd(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function qd(e,s,a){return a=a!=null?a.concat([e]):null,Jr(4,4,Zd.bind(null,s,e),a)}function Ci(){}function Kd(e,s){var a=Be();s=s===void 0?null:s;var r=a.memoizedState;return r!==null&&s!==null&&ji(s,r[1])?r[0]:(a.memoizedState=[e,s],e)}function Qd(e,s){var a=Be();s=s===void 0?null:s;var r=a.memoizedState;return r!==null&&s!==null&&ji(s,r[1])?r[0]:(e=e(),a.memoizedState=[e,s],e)}function Yd(e,s,a){return as&21?(et(a,s)||(a=sd(),se.lanes|=a,rs|=a,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,Pe=!0),e.memoizedState=a)}function Up(e,s){var a=Z;Z=a!==0&&4>a?a:4,e(!0);var r=Pn.transition;Pn.transition={};try{e(!1),s()}finally{Z=a,Pn.transition=r}}function Xd(){return Be().memoizedState}function zp(e,s,a){var r=Ot(e);if(a={lane:r,action:a,hasEagerState:!1,eagerState:null,next:null},Jd(e))eu(s,a);else if(a=Ld(e,s,a,r),a!==null){var n=ke();Je(a,e,r,n),tu(a,s,r)}}function $p(e,s,a){var r=Ot(e),n={lane:r,action:a,hasEagerState:!1,eagerState:null,next:null};if(Jd(e))eu(s,n);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=s.lastRenderedReducer,o!==null))try{var i=s.lastRenderedState,l=o(i,a);if(n.hasEagerState=!0,n.eagerState=l,et(l,i)){var c=s.interleaved;c===null?(n.next=n,vi(s)):(n.next=c.next,c.next=n),s.interleaved=n;return}}catch{}finally{}a=Ld(e,s,n,r),a!==null&&(n=ke(),Je(a,e,r,n),tu(a,s,r))}}function Jd(e){var s=e.alternate;return e===se||s!==null&&s===se}function eu(e,s){ua=Gr=!0;var a=e.pending;a===null?s.next=s:(s.next=a.next,a.next=s),e.pending=s}function tu(e,s,a){if(a&4194240){var r=s.lanes;r&=e.pendingLanes,a|=r,s.lanes=a,ri(e,a)}}var Hr={readContext:$e,useCallback:ye,useContext:ye,useEffect:ye,useImperativeHandle:ye,useInsertionEffect:ye,useLayoutEffect:ye,useMemo:ye,useReducer:ye,useRef:ye,useState:ye,useDebugValue:ye,useDeferredValue:ye,useTransition:ye,useMutableSource:ye,useSyncExternalStore:ye,useId:ye,unstable_isNewReconciler:!1},Bp={readContext:$e,useCallback:function(e,s){return rt().memoizedState=[e,s===void 0?null:s],e},useContext:$e,useEffect:El,useImperativeHandle:function(e,s,a){return a=a!=null?a.concat([e]):null,xr(4194308,4,Zd.bind(null,s,e),a)},useLayoutEffect:function(e,s){return xr(4194308,4,e,s)},useInsertionEffect:function(e,s){return xr(4,2,e,s)},useMemo:function(e,s){var a=rt();return s=s===void 0?null:s,e=e(),a.memoizedState=[e,s],e},useReducer:function(e,s,a){var r=rt();return s=a!==void 0?a(s):s,r.memoizedState=r.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},r.queue=e,e=e.dispatch=zp.bind(null,se,e),[r.memoizedState,e]},useRef:function(e){var s=rt();return e={current:e},s.memoizedState=e},useState:Il,useDebugValue:Ci,useDeferredValue:function(e){return rt().memoizedState=e},useTransition:function(){var e=Il(!1),s=e[0];return e=Up.bind(null,e[1]),rt().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,a){var r=se,n=rt();if(X){if(a===void 0)throw Error(S(407));a=a()}else{if(a=s(),pe===null)throw Error(S(349));as&30||Gd(r,s,a)}n.memoizedState=a;var o={value:a,getSnapshot:s};return n.queue=o,El(Fd.bind(null,r,o,e),[e]),r.flags|=2048,Ia(9,Hd.bind(null,r,o,a,s),void 0,null),a},useId:function(){var e=rt(),s=pe.identifierPrefix;if(X){var a=ht,r=mt;a=(r&~(1<<32-Xe(r)-1)).toString(32)+a,s=":"+s+"R"+a,a=Ta++,0<a&&(s+="H"+a.toString(32)),s+=":"}else a=Wp++,s=":"+s+"r"+a.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Zp={readContext:$e,useCallback:Kd,useContext:$e,useEffect:Si,useImperativeHandle:qd,useInsertionEffect:$d,useLayoutEffect:Bd,useMemo:Qd,useReducer:In,useRef:zd,useState:function(){return In(Pa)},useDebugValue:Ci,useDeferredValue:function(e){var s=Be();return Yd(s,le.memoizedState,e)},useTransition:function(){var e=In(Pa)[0],s=Be().memoizedState;return[e,s]},useMutableSource:Md,useSyncExternalStore:Vd,useId:Xd,unstable_isNewReconciler:!1},qp={readContext:$e,useCallback:Kd,useContext:$e,useEffect:Si,useImperativeHandle:qd,useInsertionEffect:$d,useLayoutEffect:Bd,useMemo:Qd,useReducer:En,useRef:zd,useState:function(){return En(Pa)},useDebugValue:Ci,useDeferredValue:function(e){var s=Be();return le===null?s.memoizedState=e:Yd(s,le.memoizedState,e)},useTransition:function(){var e=En(Pa)[0],s=Be().memoizedState;return[e,s]},useMutableSource:Md,useSyncExternalStore:Vd,useId:Xd,unstable_isNewReconciler:!1};function Ke(e,s){if(e&&e.defaultProps){s=ae({},s),e=e.defaultProps;for(var a in e)s[a]===void 0&&(s[a]=e[a]);return s}return s}function Ao(e,s,a,r){s=e.memoizedState,a=a(r,s),a=a==null?s:ae({},s,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var en={isMounted:function(e){return(e=e._reactInternals)?ls(e)===e:!1},enqueueSetState:function(e,s,a){e=e._reactInternals;var r=ke(),n=Ot(e),o=gt(r,n);o.payload=s,a!=null&&(o.callback=a),s=Rt(e,o,n),s!==null&&(Je(s,e,n,r),hr(s,e,n))},enqueueReplaceState:function(e,s,a){e=e._reactInternals;var r=ke(),n=Ot(e),o=gt(r,n);o.tag=1,o.payload=s,a!=null&&(o.callback=a),s=Rt(e,o,n),s!==null&&(Je(s,e,n,r),hr(s,e,n))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var a=ke(),r=Ot(e),n=gt(a,r);n.tag=2,s!=null&&(n.callback=s),s=Rt(e,n,r),s!==null&&(Je(s,e,r,a),hr(s,e,r))}};function Rl(e,s,a,r,n,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,i):s.prototype&&s.prototype.isPureReactComponent?!ja(a,r)||!ja(n,o):!0}function su(e,s,a){var r=!1,n=Vt,o=s.contextType;return typeof o=="object"&&o!==null?o=$e(o):(n=Ee(s)?ts:we.current,r=s.contextTypes,o=(r=r!=null)?Ls(e,n):Vt),s=new s(a,o),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=en,e.stateNode=s,s._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=o),s}function Ll(e,s,a,r){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,r),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,r),s.state!==e&&en.enqueueReplaceState(s,s.state,null)}function To(e,s,a,r){var n=e.stateNode;n.props=a,n.state=e.memoizedState,n.refs={},yi(e);var o=s.contextType;typeof o=="object"&&o!==null?n.context=$e(o):(o=Ee(s)?ts:we.current,n.context=Ls(e,o)),n.state=e.memoizedState,o=s.getDerivedStateFromProps,typeof o=="function"&&(Ao(e,s,o,a),n.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(s=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),s!==n.state&&en.enqueueReplaceState(n,n.state,null),Mr(e,a,n,r),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function Vs(e,s){try{var a="",r=s;do a+=w0(r),r=r.return;while(r);var n=a}catch(o){n=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:s,stack:n,digest:null}}function Rn(e,s,a){return{value:e,source:null,stack:a??null,digest:s??null}}function Po(e,s){try{console.error(s.value)}catch(a){setTimeout(function(){throw a})}}var Kp=typeof WeakMap=="function"?WeakMap:Map;function au(e,s,a){a=gt(-1,a),a.tag=3,a.payload={element:null};var r=s.value;return a.callback=function(){Wr||(Wr=!0,Ho=r),Po(e,s)},a}function ru(e,s,a){a=gt(-1,a),a.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var n=s.value;a.payload=function(){return r(n)},a.callback=function(){Po(e,s)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(a.callback=function(){Po(e,s),typeof r!="function"&&(Lt===null?Lt=new Set([this]):Lt.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})}),a}function Ol(e,s,a){var r=e.pingCache;if(r===null){r=e.pingCache=new Kp;var n=new Set;r.set(s,n)}else n=r.get(s),n===void 0&&(n=new Set,r.set(s,n));n.has(a)||(n.add(a),e=cm.bind(null,e,s,a),s.then(e,e))}function Dl(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function Ml(e,s,a,r,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===s?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(s=gt(-1,1),s.tag=2,Rt(a,s,1))),a.lanes|=1),e)}var Qp=bt.ReactCurrentOwner,Pe=!1;function Ne(e,s,a,r){s.child=e===null?Rd(s,null,a,r):Ds(s,e.child,a,r)}function Vl(e,s,a,r,n){a=a.render;var o=s.ref;return Is(s,n),r=Ni(e,s,a,r,o,n),a=ki(),e!==null&&!Pe?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~n,yt(e,s,n)):(X&&a&&pi(s),s.flags|=1,Ne(e,s,r,n),s.child)}function Gl(e,s,a,r,n){if(e===null){var o=a.type;return typeof o=="function"&&!Oi(o)&&o.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(s.tag=15,s.type=o,nu(e,s,o,r,n)):(e=br(a.type,null,r,s,s.mode,n),e.ref=s.ref,e.return=s,s.child=e)}if(o=e.child,!(e.lanes&n)){var i=o.memoizedProps;if(a=a.compare,a=a!==null?a:ja,a(i,r)&&e.ref===s.ref)return yt(e,s,n)}return s.flags|=1,e=Dt(o,r),e.ref=s.ref,e.return=s,s.child=e}function nu(e,s,a,r,n){if(e!==null){var o=e.memoizedProps;if(ja(o,r)&&e.ref===s.ref)if(Pe=!1,s.pendingProps=r=o,(e.lanes&n)!==0)e.flags&131072&&(Pe=!0);else return s.lanes=e.lanes,yt(e,s,n)}return Io(e,s,a,r,n)}function ou(e,s,a){var r=s.pendingProps,n=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},K(Ss,Le),Le|=a;else{if(!(a&1073741824))return e=o!==null?o.baseLanes|a:a,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,K(Ss,Le),Le|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:a,K(Ss,Le),Le|=r}else o!==null?(r=o.baseLanes|a,s.memoizedState=null):r=a,K(Ss,Le),Le|=r;return Ne(e,s,n,a),s.child}function iu(e,s){var a=s.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(s.flags|=512,s.flags|=2097152)}function Io(e,s,a,r,n){var o=Ee(a)?ts:we.current;return o=Ls(s,o),Is(s,n),a=Ni(e,s,a,r,o,n),r=ki(),e!==null&&!Pe?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~n,yt(e,s,n)):(X&&r&&pi(s),s.flags|=1,Ne(e,s,a,n),s.child)}function Hl(e,s,a,r,n){if(Ee(a)){var o=!0;Er(s)}else o=!1;if(Is(s,n),s.stateNode===null)fr(e,s),su(s,a,r),To(s,a,r,n),r=!0;else if(e===null){var i=s.stateNode,l=s.memoizedProps;i.props=l;var c=i.context,d=a.contextType;typeof d=="object"&&d!==null?d=$e(d):(d=Ee(a)?ts:we.current,d=Ls(s,d));var u=a.getDerivedStateFromProps,p=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Ll(s,i,r,d),Nt=!1;var h=s.memoizedState;i.state=h,Mr(s,r,i,n),c=s.memoizedState,l!==r||h!==c||Ie.current||Nt?(typeof u=="function"&&(Ao(s,a,u,r),c=s.memoizedState),(l=Nt||Rl(s,a,l,r,h,c,d))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(s.flags|=4194308)):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=r,s.memoizedState=c),i.props=r,i.state=c,i.context=d,r=l):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),r=!1)}else{i=s.stateNode,Od(e,s),l=s.memoizedProps,d=s.type===s.elementType?l:Ke(s.type,l),i.props=d,p=s.pendingProps,h=i.context,c=a.contextType,typeof c=="object"&&c!==null?c=$e(c):(c=Ee(a)?ts:we.current,c=Ls(s,c));var y=a.getDerivedStateFromProps;(u=typeof y=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Ll(s,i,r,c),Nt=!1,h=s.memoizedState,i.state=h,Mr(s,r,i,n);var j=s.memoizedState;l!==p||h!==j||Ie.current||Nt?(typeof y=="function"&&(Ao(s,a,y,r),j=s.memoizedState),(d=Nt||Rl(s,a,d,r,h,j,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,j,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,j,c)),typeof i.componentDidUpdate=="function"&&(s.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(s.flags|=1024),s.memoizedProps=r,s.memoizedState=j),i.props=r,i.state=j,i.context=c,r=d):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(s.flags|=1024),r=!1)}return Eo(e,s,a,r,o,n)}function Eo(e,s,a,r,n,o){iu(e,s);var i=(s.flags&128)!==0;if(!r&&!i)return n&&kl(s,a,!1),yt(e,s,o);r=s.stateNode,Qp.current=s;var l=i&&typeof a.getDerivedStateFromError!="function"?null:r.render();return s.flags|=1,e!==null&&i?(s.child=Ds(s,e.child,null,o),s.child=Ds(s,null,l,o)):Ne(e,s,l,o),s.memoizedState=r.state,n&&kl(s,a,!0),s.child}function lu(e){var s=e.stateNode;s.pendingContext?Nl(e,s.pendingContext,s.pendingContext!==s.context):s.context&&Nl(e,s.context,!1),bi(e,s.containerInfo)}function Fl(e,s,a,r,n){return Os(),hi(n),s.flags|=256,Ne(e,s,a,r),s.child}var Ro={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function cu(e,s,a){var r=s.pendingProps,n=te.current,o=!1,i=(s.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(n&2)!==0),l?(o=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),K(te,n&1),e===null)return So(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(i=r.children,e=r.fallback,o?(r=s.mode,o=s.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=an(i,r,0,null),e=es(e,r,a,null),o.return=s,e.return=s,o.sibling=e,s.child=o,s.child.memoizedState=Lo(a),s.memoizedState=Ro,e):Ai(s,i));if(n=e.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return Yp(e,s,i,r,l,n,a);if(o){o=r.fallback,i=s.mode,n=e.child,l=n.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&s.child!==n?(r=s.child,r.childLanes=0,r.pendingProps=c,s.deletions=null):(r=Dt(n,c),r.subtreeFlags=n.subtreeFlags&14680064),l!==null?o=Dt(l,o):(o=es(o,i,a,null),o.flags|=2),o.return=s,r.return=s,r.sibling=o,s.child=r,r=o,o=s.child,i=e.child.memoizedState,i=i===null?Lo(a):{baseLanes:i.baseLanes|a,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~a,s.memoizedState=Ro,r}return o=e.child,e=o.sibling,r=Dt(o,{mode:"visible",children:r.children}),!(s.mode&1)&&(r.lanes=a),r.return=s,r.sibling=null,e!==null&&(a=s.deletions,a===null?(s.deletions=[e],s.flags|=16):a.push(e)),s.child=r,s.memoizedState=null,r}function Ai(e,s){return s=an({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function Ja(e,s,a,r){return r!==null&&hi(r),Ds(s,e.child,null,a),e=Ai(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function Yp(e,s,a,r,n,o,i){if(a)return s.flags&256?(s.flags&=-257,r=Rn(Error(S(422))),Ja(e,s,i,r)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(o=r.fallback,n=s.mode,r=an({mode:"visible",children:r.children},n,0,null),o=es(o,n,i,null),o.flags|=2,r.return=s,o.return=s,r.sibling=o,s.child=r,s.mode&1&&Ds(s,e.child,null,i),s.child.memoizedState=Lo(i),s.memoizedState=Ro,o);if(!(s.mode&1))return Ja(e,s,i,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(S(419)),r=Rn(o,r,void 0),Ja(e,s,i,r)}if(l=(i&e.childLanes)!==0,Pe||l){if(r=pe,r!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|i)?0:n,n!==0&&n!==o.retryLane&&(o.retryLane=n,vt(e,n),Je(r,e,n,-1))}return Li(),r=Rn(Error(S(421))),Ja(e,s,i,r)}return n.data==="$?"?(s.flags|=128,s.child=e.child,s=dm.bind(null,e),n._reactRetry=s,null):(e=o.treeContext,Oe=Et(n.nextSibling),De=s,X=!0,Ye=null,e!==null&&(Fe[We++]=mt,Fe[We++]=ht,Fe[We++]=ss,mt=e.id,ht=e.overflow,ss=s),s=Ai(s,r.children),s.flags|=4096,s)}function Wl(e,s,a){e.lanes|=s;var r=e.alternate;r!==null&&(r.lanes|=s),Co(e.return,s,a)}function Ln(e,s,a,r,n){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:r,tail:a,tailMode:n}:(o.isBackwards=s,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=a,o.tailMode=n)}function du(e,s,a){var r=s.pendingProps,n=r.revealOrder,o=r.tail;if(Ne(e,s,r.children,a),r=te.current,r&2)r=r&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Wl(e,a,s);else if(e.tag===19)Wl(e,a,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(K(te,r),!(s.mode&1))s.memoizedState=null;else switch(n){case"forwards":for(a=s.child,n=null;a!==null;)e=a.alternate,e!==null&&Vr(e)===null&&(n=a),a=a.sibling;a=n,a===null?(n=s.child,s.child=null):(n=a.sibling,a.sibling=null),Ln(s,!1,n,a,o);break;case"backwards":for(a=null,n=s.child,s.child=null;n!==null;){if(e=n.alternate,e!==null&&Vr(e)===null){s.child=n;break}e=n.sibling,n.sibling=a,a=n,n=e}Ln(s,!0,a,null,o);break;case"together":Ln(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function fr(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function yt(e,s,a){if(e!==null&&(s.dependencies=e.dependencies),rs|=s.lanes,!(a&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(S(153));if(s.child!==null){for(e=s.child,a=Dt(e,e.pendingProps),s.child=a,a.return=s;e.sibling!==null;)e=e.sibling,a=a.sibling=Dt(e,e.pendingProps),a.return=s;a.sibling=null}return s.child}function Xp(e,s,a){switch(s.tag){case 3:lu(s),Os();break;case 5:Dd(s);break;case 1:Ee(s.type)&&Er(s);break;case 4:bi(s,s.stateNode.containerInfo);break;case 10:var r=s.type._context,n=s.memoizedProps.value;K(Or,r._currentValue),r._currentValue=n;break;case 13:if(r=s.memoizedState,r!==null)return r.dehydrated!==null?(K(te,te.current&1),s.flags|=128,null):a&s.child.childLanes?cu(e,s,a):(K(te,te.current&1),e=yt(e,s,a),e!==null?e.sibling:null);K(te,te.current&1);break;case 19:if(r=(a&s.childLanes)!==0,e.flags&128){if(r)return du(e,s,a);s.flags|=128}if(n=s.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),K(te,te.current),r)break;return null;case 22:case 23:return s.lanes=0,ou(e,s,a)}return yt(e,s,a)}var uu,Oo,pu,mu;uu=function(e,s){for(var a=s.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Oo=function(){};pu=function(e,s,a,r){var n=e.memoizedProps;if(n!==r){e=s.stateNode,Yt(it.current);var o=null;switch(a){case"input":n=so(e,n),r=so(e,r),o=[];break;case"select":n=ae({},n,{value:void 0}),r=ae({},r,{value:void 0}),o=[];break;case"textarea":n=no(e,n),r=no(e,r),o=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Pr)}io(a,r);var i;a=null;for(d in n)if(!r.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var l=n[d];for(i in l)l.hasOwnProperty(i)&&(a||(a={}),a[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xa.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(l=n!=null?n[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(a||(a={}),a[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(a||(a={}),a[i]=c[i])}else a||(o||(o=[]),o.push(d,a)),a=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Q("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}a&&(o=o||[]).push("style",a);var d=o;(s.updateQueue=d)&&(s.flags|=4)}};mu=function(e,s,a,r){a!==r&&(s.flags|=4)};function Qs(e,s){if(!X)switch(e.tailMode){case"hidden":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var r=null;a!==null;)a.alternate!==null&&(r=a),a=a.sibling;r===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function be(e){var s=e.alternate!==null&&e.alternate.child===e.child,a=0,r=0;if(s)for(var n=e.child;n!==null;)a|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)a|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=a,s}function Jp(e,s,a){var r=s.pendingProps;switch(mi(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return be(s),null;case 1:return Ee(s.type)&&Ir(),be(s),null;case 3:return r=s.stateNode,Ms(),Y(Ie),Y(we),wi(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ya(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Ye!==null&&(Uo(Ye),Ye=null))),Oo(e,s),be(s),null;case 5:_i(s);var n=Yt(Aa.current);if(a=s.type,e!==null&&s.stateNode!=null)pu(e,s,a,r,n),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!r){if(s.stateNode===null)throw Error(S(166));return be(s),null}if(e=Yt(it.current),Ya(s)){r=s.stateNode,a=s.type;var o=s.memoizedProps;switch(r[nt]=s,r[Sa]=o,e=(s.mode&1)!==0,a){case"dialog":Q("cancel",r),Q("close",r);break;case"iframe":case"object":case"embed":Q("load",r);break;case"video":case"audio":for(n=0;n<aa.length;n++)Q(aa[n],r);break;case"source":Q("error",r);break;case"img":case"image":case"link":Q("error",r),Q("load",r);break;case"details":Q("toggle",r);break;case"input":Yi(r,o),Q("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Q("invalid",r);break;case"textarea":Ji(r,o),Q("invalid",r)}io(a,o),n=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Qa(r.textContent,l,e),n=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Qa(r.textContent,l,e),n=["children",""+l]):xa.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Q("scroll",r)}switch(a){case"input":Wa(r),Xi(r,o,!0);break;case"textarea":Wa(r),el(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Pr)}r=n,s.updateQueue=r,r!==null&&(s.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fc(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(a,{is:r.is}):(e=i.createElement(a),a==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,a),e[nt]=s,e[Sa]=r,uu(e,s,!1,!1),s.stateNode=e;e:{switch(i=lo(a,r),a){case"dialog":Q("cancel",e),Q("close",e),n=r;break;case"iframe":case"object":case"embed":Q("load",e),n=r;break;case"video":case"audio":for(n=0;n<aa.length;n++)Q(aa[n],e);n=r;break;case"source":Q("error",e),n=r;break;case"img":case"image":case"link":Q("error",e),Q("load",e),n=r;break;case"details":Q("toggle",e),n=r;break;case"input":Yi(e,r),n=so(e,r),Q("invalid",e);break;case"option":n=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},n=ae({},r,{value:void 0}),Q("invalid",e);break;case"textarea":Ji(e,r),n=no(e,r),Q("invalid",e);break;default:n=r}io(a,n),l=n;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?zc(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Wc(e,c)):o==="children"?typeof c=="string"?(a!=="textarea"||c!=="")&&fa(e,c):typeof c=="number"&&fa(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xa.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Q("scroll",e):c!=null&&Xo(e,o,c,i))}switch(a){case"input":Wa(e),Xi(e,r,!1);break;case"textarea":Wa(e),el(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Mt(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Cs(e,!!r.multiple,o,!1):r.defaultValue!=null&&Cs(e,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=Pr)}switch(a){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return be(s),null;case 6:if(e&&s.stateNode!=null)mu(e,s,e.memoizedProps,r);else{if(typeof r!="string"&&s.stateNode===null)throw Error(S(166));if(a=Yt(Aa.current),Yt(it.current),Ya(s)){if(r=s.stateNode,a=s.memoizedProps,r[nt]=s,(o=r.nodeValue!==a)&&(e=De,e!==null))switch(e.tag){case 3:Qa(r.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qa(r.nodeValue,a,(e.mode&1)!==0)}o&&(s.flags|=4)}else r=(a.nodeType===9?a:a.ownerDocument).createTextNode(r),r[nt]=s,s.stateNode=r}return be(s),null;case 13:if(Y(te),r=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(X&&Oe!==null&&s.mode&1&&!(s.flags&128))Id(),Os(),s.flags|=98560,o=!1;else if(o=Ya(s),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(S(318));if(o=s.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(S(317));o[nt]=s}else Os(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;be(s),o=!1}else Ye!==null&&(Uo(Ye),Ye=null),o=!0;if(!o)return s.flags&65536?s:null}return s.flags&128?(s.lanes=a,s):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(s.child.flags|=8192,s.mode&1&&(e===null||te.current&1?ce===0&&(ce=3):Li())),s.updateQueue!==null&&(s.flags|=4),be(s),null);case 4:return Ms(),Oo(e,s),e===null&&Na(s.stateNode.containerInfo),be(s),null;case 10:return fi(s.type._context),be(s),null;case 17:return Ee(s.type)&&Ir(),be(s),null;case 19:if(Y(te),o=s.memoizedState,o===null)return be(s),null;if(r=(s.flags&128)!==0,i=o.rendering,i===null)if(r)Qs(o,!1);else{if(ce!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(i=Vr(e),i!==null){for(s.flags|=128,Qs(o,!1),r=i.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),s.subtreeFlags=0,r=a,a=s.child;a!==null;)o=a,e=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return K(te,te.current&1|2),s.child}e=e.sibling}o.tail!==null&&oe()>Gs&&(s.flags|=128,r=!0,Qs(o,!1),s.lanes=4194304)}else{if(!r)if(e=Vr(i),e!==null){if(s.flags|=128,r=!0,a=e.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),Qs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!X)return be(s),null}else 2*oe()-o.renderingStartTime>Gs&&a!==1073741824&&(s.flags|=128,r=!0,Qs(o,!1),s.lanes=4194304);o.isBackwards?(i.sibling=s.child,s.child=i):(a=o.last,a!==null?a.sibling=i:s.child=i,o.last=i)}return o.tail!==null?(s=o.tail,o.rendering=s,o.tail=s.sibling,o.renderingStartTime=oe(),s.sibling=null,a=te.current,K(te,r?a&1|2:a&1),s):(be(s),null);case 22:case 23:return Ri(),r=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(s.flags|=8192),r&&s.mode&1?Le&1073741824&&(be(s),s.subtreeFlags&6&&(s.flags|=8192)):be(s),null;case 24:return null;case 25:return null}throw Error(S(156,s.tag))}function em(e,s){switch(mi(s),s.tag){case 1:return Ee(s.type)&&Ir(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return Ms(),Y(Ie),Y(we),wi(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return _i(s),null;case 13:if(Y(te),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(S(340));Os()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return Y(te),null;case 4:return Ms(),null;case 10:return fi(s.type._context),null;case 22:case 23:return Ri(),null;case 24:return null;default:return null}}var er=!1,_e=!1,tm=typeof WeakSet=="function"?WeakSet:Set,D=null;function ks(e,s){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(r){re(e,s,r)}else a.current=null}function Do(e,s,a){try{a()}catch(r){re(e,s,r)}}var Ul=!1;function sm(e,s){if(yo=Cr,e=vd(),ui(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var r=a.getSelection&&a.getSelection();if(r&&r.rangeCount!==0){a=r.anchorNode;var n=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{a.nodeType,o.nodeType}catch{a=null;break e}var i=0,l=-1,c=-1,d=0,u=0,p=e,h=null;t:for(;;){for(var y;p!==a||n!==0&&p.nodeType!==3||(l=i+n),p!==o||r!==0&&p.nodeType!==3||(c=i+r),p.nodeType===3&&(i+=p.nodeValue.length),(y=p.firstChild)!==null;)h=p,p=y;for(;;){if(p===e)break t;if(h===a&&++d===n&&(l=i),h===o&&++u===r&&(c=i),(y=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=y}a=l===-1||c===-1?null:{start:l,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(bo={focusedElem:e,selectionRange:a},Cr=!1,D=s;D!==null;)if(s=D,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,D=e;else for(;D!==null;){s=D;try{var j=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var v=j.memoizedProps,L=j.memoizedState,x=s.stateNode,m=x.getSnapshotBeforeUpdate(s.elementType===s.type?v:Ke(s.type,v),L);x.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var g=s.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(S(163))}}catch(w){re(s,s.return,w)}if(e=s.sibling,e!==null){e.return=s.return,D=e;break}D=s.return}return j=Ul,Ul=!1,j}function pa(e,s,a){var r=s.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&e)===e){var o=n.destroy;n.destroy=void 0,o!==void 0&&Do(s,a,o)}n=n.next}while(n!==r)}}function tn(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var r=a.create;a.destroy=r()}a=a.next}while(a!==s)}}function Mo(e){var s=e.ref;if(s!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof s=="function"?s(e):s.current=e}}function hu(e){var s=e.alternate;s!==null&&(e.alternate=null,hu(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[nt],delete s[Sa],delete s[jo],delete s[Vp],delete s[Gp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gu(e){return e.tag===5||e.tag===3||e.tag===4}function zl(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||gu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vo(e,s,a){var r=e.tag;if(r===5||r===6)e=e.stateNode,s?a.nodeType===8?a.parentNode.insertBefore(e,s):a.insertBefore(e,s):(a.nodeType===8?(s=a.parentNode,s.insertBefore(e,a)):(s=a,s.appendChild(e)),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Pr));else if(r!==4&&(e=e.child,e!==null))for(Vo(e,s,a),e=e.sibling;e!==null;)Vo(e,s,a),e=e.sibling}function Go(e,s,a){var r=e.tag;if(r===5||r===6)e=e.stateNode,s?a.insertBefore(e,s):a.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Go(e,s,a),e=e.sibling;e!==null;)Go(e,s,a),e=e.sibling}var ge=null,Qe=!1;function _t(e,s,a){for(a=a.child;a!==null;)xu(e,s,a),a=a.sibling}function xu(e,s,a){if(ot&&typeof ot.onCommitFiberUnmount=="function")try{ot.onCommitFiberUnmount(Zr,a)}catch{}switch(a.tag){case 5:_e||ks(a,s);case 6:var r=ge,n=Qe;ge=null,_t(e,s,a),ge=r,Qe=n,ge!==null&&(Qe?(e=ge,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):ge.removeChild(a.stateNode));break;case 18:ge!==null&&(Qe?(e=ge,a=a.stateNode,e.nodeType===8?Cn(e.parentNode,a):e.nodeType===1&&Cn(e,a),_a(e)):Cn(ge,a.stateNode));break;case 4:r=ge,n=Qe,ge=a.stateNode.containerInfo,Qe=!0,_t(e,s,a),ge=r,Qe=n;break;case 0:case 11:case 14:case 15:if(!_e&&(r=a.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var o=n,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Do(a,s,i),n=n.next}while(n!==r)}_t(e,s,a);break;case 1:if(!_e&&(ks(a,s),r=a.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=a.memoizedProps,r.state=a.memoizedState,r.componentWillUnmount()}catch(l){re(a,s,l)}_t(e,s,a);break;case 21:_t(e,s,a);break;case 22:a.mode&1?(_e=(r=_e)||a.memoizedState!==null,_t(e,s,a),_e=r):_t(e,s,a);break;default:_t(e,s,a)}}function $l(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new tm),s.forEach(function(r){var n=um.bind(null,e,r);a.has(r)||(a.add(r),r.then(n,n))})}}function Ze(e,s){var a=s.deletions;if(a!==null)for(var r=0;r<a.length;r++){var n=a[r];try{var o=e,i=s,l=i;e:for(;l!==null;){switch(l.tag){case 5:ge=l.stateNode,Qe=!1;break e;case 3:ge=l.stateNode.containerInfo,Qe=!0;break e;case 4:ge=l.stateNode.containerInfo,Qe=!0;break e}l=l.return}if(ge===null)throw Error(S(160));xu(o,i,n),ge=null,Qe=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(d){re(n,s,d)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)fu(s,e),s=s.sibling}function fu(e,s){var a=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ze(s,e),tt(e),r&4){try{pa(3,e,e.return),tn(3,e)}catch(v){re(e,e.return,v)}try{pa(5,e,e.return)}catch(v){re(e,e.return,v)}}break;case 1:Ze(s,e),tt(e),r&512&&a!==null&&ks(a,a.return);break;case 5:if(Ze(s,e),tt(e),r&512&&a!==null&&ks(a,a.return),e.flags&32){var n=e.stateNode;try{fa(n,"")}catch(v){re(e,e.return,v)}}if(r&4&&(n=e.stateNode,n!=null)){var o=e.memoizedProps,i=a!==null?a.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Gc(n,o),lo(l,i);var d=lo(l,o);for(i=0;i<c.length;i+=2){var u=c[i],p=c[i+1];u==="style"?zc(n,p):u==="dangerouslySetInnerHTML"?Wc(n,p):u==="children"?fa(n,p):Xo(n,u,p,d)}switch(l){case"input":ao(n,o);break;case"textarea":Hc(n,o);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!o.multiple;var y=o.value;y!=null?Cs(n,!!o.multiple,y,!1):h!==!!o.multiple&&(o.defaultValue!=null?Cs(n,!!o.multiple,o.defaultValue,!0):Cs(n,!!o.multiple,o.multiple?[]:"",!1))}n[Sa]=o}catch(v){re(e,e.return,v)}}break;case 6:if(Ze(s,e),tt(e),r&4){if(e.stateNode===null)throw Error(S(162));n=e.stateNode,o=e.memoizedProps;try{n.nodeValue=o}catch(v){re(e,e.return,v)}}break;case 3:if(Ze(s,e),tt(e),r&4&&a!==null&&a.memoizedState.isDehydrated)try{_a(s.containerInfo)}catch(v){re(e,e.return,v)}break;case 4:Ze(s,e),tt(e);break;case 13:Ze(s,e),tt(e),n=e.child,n.flags&8192&&(o=n.memoizedState!==null,n.stateNode.isHidden=o,!o||n.alternate!==null&&n.alternate.memoizedState!==null||(Ii=oe())),r&4&&$l(e);break;case 22:if(u=a!==null&&a.memoizedState!==null,e.mode&1?(_e=(d=_e)||u,Ze(s,e),_e=d):Ze(s,e),tt(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(D=e,u=e.child;u!==null;){for(p=D=u;D!==null;){switch(h=D,y=h.child,h.tag){case 0:case 11:case 14:case 15:pa(4,h,h.return);break;case 1:ks(h,h.return);var j=h.stateNode;if(typeof j.componentWillUnmount=="function"){r=h,a=h.return;try{s=r,j.props=s.memoizedProps,j.state=s.memoizedState,j.componentWillUnmount()}catch(v){re(r,a,v)}}break;case 5:ks(h,h.return);break;case 22:if(h.memoizedState!==null){Zl(p);continue}}y!==null?(y.return=h,D=y):Zl(p)}u=u.sibling}e:for(u=null,p=e;;){if(p.tag===5){if(u===null){u=p;try{n=p.stateNode,d?(o=n.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Uc("display",i))}catch(v){re(e,e.return,v)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(v){re(e,e.return,v)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Ze(s,e),tt(e),r&4&&$l(e);break;case 21:break;default:Ze(s,e),tt(e)}}function tt(e){var s=e.flags;if(s&2){try{e:{for(var a=e.return;a!==null;){if(gu(a)){var r=a;break e}a=a.return}throw Error(S(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(fa(n,""),r.flags&=-33);var o=zl(e);Go(e,o,n);break;case 3:case 4:var i=r.stateNode.containerInfo,l=zl(e);Vo(e,l,i);break;default:throw Error(S(161))}}catch(c){re(e,e.return,c)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function am(e,s,a){D=e,vu(e)}function vu(e,s,a){for(var r=(e.mode&1)!==0;D!==null;){var n=D,o=n.child;if(n.tag===22&&r){var i=n.memoizedState!==null||er;if(!i){var l=n.alternate,c=l!==null&&l.memoizedState!==null||_e;l=er;var d=_e;if(er=i,(_e=c)&&!d)for(D=n;D!==null;)i=D,c=i.child,i.tag===22&&i.memoizedState!==null?ql(n):c!==null?(c.return=i,D=c):ql(n);for(;o!==null;)D=o,vu(o),o=o.sibling;D=n,er=l,_e=d}Bl(e)}else n.subtreeFlags&8772&&o!==null?(o.return=n,D=o):Bl(e)}}function Bl(e){for(;D!==null;){var s=D;if(s.flags&8772){var a=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:_e||tn(5,s);break;case 1:var r=s.stateNode;if(s.flags&4&&!_e)if(a===null)r.componentDidMount();else{var n=s.elementType===s.type?a.memoizedProps:Ke(s.type,a.memoizedProps);r.componentDidUpdate(n,a.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=s.updateQueue;o!==null&&Pl(s,o,r);break;case 3:var i=s.updateQueue;if(i!==null){if(a=null,s.child!==null)switch(s.child.tag){case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}Pl(s,i,a)}break;case 5:var l=s.stateNode;if(a===null&&s.flags&4){a=l;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var d=s.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&_a(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(S(163))}_e||s.flags&512&&Mo(s)}catch(h){re(s,s.return,h)}}if(s===e){D=null;break}if(a=s.sibling,a!==null){a.return=s.return,D=a;break}D=s.return}}function Zl(e){for(;D!==null;){var s=D;if(s===e){D=null;break}var a=s.sibling;if(a!==null){a.return=s.return,D=a;break}D=s.return}}function ql(e){for(;D!==null;){var s=D;try{switch(s.tag){case 0:case 11:case 15:var a=s.return;try{tn(4,s)}catch(c){re(s,a,c)}break;case 1:var r=s.stateNode;if(typeof r.componentDidMount=="function"){var n=s.return;try{r.componentDidMount()}catch(c){re(s,n,c)}}var o=s.return;try{Mo(s)}catch(c){re(s,o,c)}break;case 5:var i=s.return;try{Mo(s)}catch(c){re(s,i,c)}}}catch(c){re(s,s.return,c)}if(s===e){D=null;break}var l=s.sibling;if(l!==null){l.return=s.return,D=l;break}D=s.return}}var rm=Math.ceil,Fr=bt.ReactCurrentDispatcher,Ti=bt.ReactCurrentOwner,ze=bt.ReactCurrentBatchConfig,z=0,pe=null,ie=null,xe=0,Le=0,Ss=Ht(0),ce=0,Ea=null,rs=0,sn=0,Pi=0,ma=null,Te=null,Ii=0,Gs=1/0,ut=null,Wr=!1,Ho=null,Lt=null,tr=!1,At=null,Ur=0,ha=0,Fo=null,vr=-1,yr=0;function ke(){return z&6?oe():vr!==-1?vr:vr=oe()}function Ot(e){return e.mode&1?z&2&&xe!==0?xe&-xe:Fp.transition!==null?(yr===0&&(yr=sd()),yr):(e=Z,e!==0||(e=window.event,e=e===void 0?16:cd(e.type)),e):1}function Je(e,s,a,r){if(50<ha)throw ha=0,Fo=null,Error(S(185));La(e,a,r),(!(z&2)||e!==pe)&&(e===pe&&(!(z&2)&&(sn|=a),ce===4&&St(e,xe)),Re(e,r),a===1&&z===0&&!(s.mode&1)&&(Gs=oe()+500,Xr&&Ft()))}function Re(e,s){var a=e.callbackNode;F0(e,s);var r=Sr(e,e===pe?xe:0);if(r===0)a!==null&&al(a),e.callbackNode=null,e.callbackPriority=0;else if(s=r&-r,e.callbackPriority!==s){if(a!=null&&al(a),s===1)e.tag===0?Hp(Kl.bind(null,e)):Ad(Kl.bind(null,e)),Dp(function(){!(z&6)&&Ft()}),a=null;else{switch(ad(r)){case 1:a=ai;break;case 4:a=ed;break;case 16:a=kr;break;case 536870912:a=td;break;default:a=kr}a=Su(a,yu.bind(null,e))}e.callbackPriority=s,e.callbackNode=a}}function yu(e,s){if(vr=-1,yr=0,z&6)throw Error(S(327));var a=e.callbackNode;if(Es()&&e.callbackNode!==a)return null;var r=Sr(e,e===pe?xe:0);if(r===0)return null;if(r&30||r&e.expiredLanes||s)s=zr(e,r);else{s=r;var n=z;z|=2;var o=_u();(pe!==e||xe!==s)&&(ut=null,Gs=oe()+500,Jt(e,s));do try{im();break}catch(l){bu(e,l)}while(!0);xi(),Fr.current=o,z=n,ie!==null?s=0:(pe=null,xe=0,s=ce)}if(s!==0){if(s===2&&(n=ho(e),n!==0&&(r=n,s=Wo(e,n))),s===1)throw a=Ea,Jt(e,0),St(e,r),Re(e,oe()),a;if(s===6)St(e,r);else{if(n=e.current.alternate,!(r&30)&&!nm(n)&&(s=zr(e,r),s===2&&(o=ho(e),o!==0&&(r=o,s=Wo(e,o))),s===1))throw a=Ea,Jt(e,0),St(e,r),Re(e,oe()),a;switch(e.finishedWork=n,e.finishedLanes=r,s){case 0:case 1:throw Error(S(345));case 2:Zt(e,Te,ut);break;case 3:if(St(e,r),(r&130023424)===r&&(s=Ii+500-oe(),10<s)){if(Sr(e,0)!==0)break;if(n=e.suspendedLanes,(n&r)!==r){ke(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=wo(Zt.bind(null,e,Te,ut),s);break}Zt(e,Te,ut);break;case 4:if(St(e,r),(r&4194240)===r)break;for(s=e.eventTimes,n=-1;0<r;){var i=31-Xe(r);o=1<<i,i=s[i],i>n&&(n=i),r&=~o}if(r=n,r=oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*rm(r/1960))-r,10<r){e.timeoutHandle=wo(Zt.bind(null,e,Te,ut),r);break}Zt(e,Te,ut);break;case 5:Zt(e,Te,ut);break;default:throw Error(S(329))}}}return Re(e,oe()),e.callbackNode===a?yu.bind(null,e):null}function Wo(e,s){var a=ma;return e.current.memoizedState.isDehydrated&&(Jt(e,s).flags|=256),e=zr(e,s),e!==2&&(s=Te,Te=a,s!==null&&Uo(s)),e}function Uo(e){Te===null?Te=e:Te.push.apply(Te,e)}function nm(e){for(var s=e;;){if(s.flags&16384){var a=s.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var r=0;r<a.length;r++){var n=a[r],o=n.getSnapshot;n=n.value;try{if(!et(o(),n))return!1}catch{return!1}}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function St(e,s){for(s&=~Pi,s&=~sn,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var a=31-Xe(s),r=1<<a;e[a]=-1,s&=~r}}function Kl(e){if(z&6)throw Error(S(327));Es();var s=Sr(e,0);if(!(s&1))return Re(e,oe()),null;var a=zr(e,s);if(e.tag!==0&&a===2){var r=ho(e);r!==0&&(s=r,a=Wo(e,r))}if(a===1)throw a=Ea,Jt(e,0),St(e,s),Re(e,oe()),a;if(a===6)throw Error(S(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,Zt(e,Te,ut),Re(e,oe()),null}function Ei(e,s){var a=z;z|=1;try{return e(s)}finally{z=a,z===0&&(Gs=oe()+500,Xr&&Ft())}}function ns(e){At!==null&&At.tag===0&&!(z&6)&&Es();var s=z;z|=1;var a=ze.transition,r=Z;try{if(ze.transition=null,Z=1,e)return e()}finally{Z=r,ze.transition=a,z=s,!(z&6)&&Ft()}}function Ri(){Le=Ss.current,Y(Ss)}function Jt(e,s){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Op(a)),ie!==null)for(a=ie.return;a!==null;){var r=a;switch(mi(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ir();break;case 3:Ms(),Y(Ie),Y(we),wi();break;case 5:_i(r);break;case 4:Ms();break;case 13:Y(te);break;case 19:Y(te);break;case 10:fi(r.type._context);break;case 22:case 23:Ri()}a=a.return}if(pe=e,ie=e=Dt(e.current,null),xe=Le=s,ce=0,Ea=null,Pi=sn=rs=0,Te=ma=null,Qt!==null){for(s=0;s<Qt.length;s++)if(a=Qt[s],r=a.interleaved,r!==null){a.interleaved=null;var n=r.next,o=a.pending;if(o!==null){var i=o.next;o.next=n,r.next=i}a.pending=r}Qt=null}return e}function bu(e,s){do{var a=ie;try{if(xi(),gr.current=Hr,Gr){for(var r=se.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}Gr=!1}if(as=0,ue=le=se=null,ua=!1,Ta=0,Ti.current=null,a===null||a.return===null){ce=1,Ea=s,ie=null;break}e:{var o=e,i=a.return,l=a,c=s;if(s=xe,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var y=Dl(i);if(y!==null){y.flags&=-257,Ml(y,i,l,o,s),y.mode&1&&Ol(o,d,s),s=y,c=d;var j=s.updateQueue;if(j===null){var v=new Set;v.add(c),s.updateQueue=v}else j.add(c);break e}else{if(!(s&1)){Ol(o,d,s),Li();break e}c=Error(S(426))}}else if(X&&l.mode&1){var L=Dl(i);if(L!==null){!(L.flags&65536)&&(L.flags|=256),Ml(L,i,l,o,s),hi(Vs(c,l));break e}}o=c=Vs(c,l),ce!==4&&(ce=2),ma===null?ma=[o]:ma.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,s&=-s,o.lanes|=s;var x=au(o,c,s);Tl(o,x);break e;case 1:l=c;var m=o.type,g=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Lt===null||!Lt.has(g)))){o.flags|=65536,s&=-s,o.lanes|=s;var w=ru(o,l,s);Tl(o,w);break e}}o=o.return}while(o!==null)}ju(a)}catch(N){s=N,ie===a&&a!==null&&(ie=a=a.return);continue}break}while(!0)}function _u(){var e=Fr.current;return Fr.current=Hr,e===null?Hr:e}function Li(){(ce===0||ce===3||ce===2)&&(ce=4),pe===null||!(rs&268435455)&&!(sn&268435455)||St(pe,xe)}function zr(e,s){var a=z;z|=2;var r=_u();(pe!==e||xe!==s)&&(ut=null,Jt(e,s));do try{om();break}catch(n){bu(e,n)}while(!0);if(xi(),z=a,Fr.current=r,ie!==null)throw Error(S(261));return pe=null,xe=0,ce}function om(){for(;ie!==null;)wu(ie)}function im(){for(;ie!==null&&!E0();)wu(ie)}function wu(e){var s=ku(e.alternate,e,Le);e.memoizedProps=e.pendingProps,s===null?ju(e):ie=s,Ti.current=null}function ju(e){var s=e;do{var a=s.alternate;if(e=s.return,s.flags&32768){if(a=em(a,s),a!==null){a.flags&=32767,ie=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ce=6,ie=null;return}}else if(a=Jp(a,s,Le),a!==null){ie=a;return}if(s=s.sibling,s!==null){ie=s;return}ie=s=e}while(s!==null);ce===0&&(ce=5)}function Zt(e,s,a){var r=Z,n=ze.transition;try{ze.transition=null,Z=1,lm(e,s,a,r)}finally{ze.transition=n,Z=r}return null}function lm(e,s,a,r){do Es();while(At!==null);if(z&6)throw Error(S(327));a=e.finishedWork;var n=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(S(177));e.callbackNode=null,e.callbackPriority=0;var o=a.lanes|a.childLanes;if(W0(e,o),e===pe&&(ie=pe=null,xe=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||tr||(tr=!0,Su(kr,function(){return Es(),null})),o=(a.flags&15990)!==0,a.subtreeFlags&15990||o){o=ze.transition,ze.transition=null;var i=Z;Z=1;var l=z;z|=4,Ti.current=null,sm(e,a),fu(a,e),Ap(bo),Cr=!!yo,bo=yo=null,e.current=a,am(a),R0(),z=l,Z=i,ze.transition=o}else e.current=a;if(tr&&(tr=!1,At=e,Ur=n),o=e.pendingLanes,o===0&&(Lt=null),D0(a.stateNode),Re(e,oe()),s!==null)for(r=e.onRecoverableError,a=0;a<s.length;a++)n=s[a],r(n.value,{componentStack:n.stack,digest:n.digest});if(Wr)throw Wr=!1,e=Ho,Ho=null,e;return Ur&1&&e.tag!==0&&Es(),o=e.pendingLanes,o&1?e===Fo?ha++:(ha=0,Fo=e):ha=0,Ft(),null}function Es(){if(At!==null){var e=ad(Ur),s=ze.transition,a=Z;try{if(ze.transition=null,Z=16>e?16:e,At===null)var r=!1;else{if(e=At,At=null,Ur=0,z&6)throw Error(S(331));var n=z;for(z|=4,D=e.current;D!==null;){var o=D,i=o.child;if(D.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(D=d;D!==null;){var u=D;switch(u.tag){case 0:case 11:case 15:pa(8,u,o)}var p=u.child;if(p!==null)p.return=u,D=p;else for(;D!==null;){u=D;var h=u.sibling,y=u.return;if(hu(u),u===d){D=null;break}if(h!==null){h.return=y,D=h;break}D=y}}}var j=o.alternate;if(j!==null){var v=j.child;if(v!==null){j.child=null;do{var L=v.sibling;v.sibling=null,v=L}while(v!==null)}}D=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,D=i;else e:for(;D!==null;){if(o=D,o.flags&2048)switch(o.tag){case 0:case 11:case 15:pa(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,D=x;break e}D=o.return}}var m=e.current;for(D=m;D!==null;){i=D;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,D=g;else e:for(i=m;D!==null;){if(l=D,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:tn(9,l)}}catch(N){re(l,l.return,N)}if(l===i){D=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,D=w;break e}D=l.return}}if(z=n,Ft(),ot&&typeof ot.onPostCommitFiberRoot=="function")try{ot.onPostCommitFiberRoot(Zr,e)}catch{}r=!0}return r}finally{Z=a,ze.transition=s}}return!1}function Ql(e,s,a){s=Vs(a,s),s=au(e,s,1),e=Rt(e,s,1),s=ke(),e!==null&&(La(e,1,s),Re(e,s))}function re(e,s,a){if(e.tag===3)Ql(e,e,a);else for(;s!==null;){if(s.tag===3){Ql(s,e,a);break}else if(s.tag===1){var r=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Lt===null||!Lt.has(r))){e=Vs(a,e),e=ru(s,e,1),s=Rt(s,e,1),e=ke(),s!==null&&(La(s,1,e),Re(s,e));break}}s=s.return}}function cm(e,s,a){var r=e.pingCache;r!==null&&r.delete(s),s=ke(),e.pingedLanes|=e.suspendedLanes&a,pe===e&&(xe&a)===a&&(ce===4||ce===3&&(xe&130023424)===xe&&500>oe()-Ii?Jt(e,0):Pi|=a),Re(e,s)}function Nu(e,s){s===0&&(e.mode&1?(s=$a,$a<<=1,!($a&130023424)&&($a=4194304)):s=1);var a=ke();e=vt(e,s),e!==null&&(La(e,s,a),Re(e,a))}function dm(e){var s=e.memoizedState,a=0;s!==null&&(a=s.retryLane),Nu(e,a)}function um(e,s){var a=0;switch(e.tag){case 13:var r=e.stateNode,n=e.memoizedState;n!==null&&(a=n.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(S(314))}r!==null&&r.delete(s),Nu(e,a)}var ku;ku=function(e,s,a){if(e!==null)if(e.memoizedProps!==s.pendingProps||Ie.current)Pe=!0;else{if(!(e.lanes&a)&&!(s.flags&128))return Pe=!1,Xp(e,s,a);Pe=!!(e.flags&131072)}else Pe=!1,X&&s.flags&1048576&&Td(s,Lr,s.index);switch(s.lanes=0,s.tag){case 2:var r=s.type;fr(e,s),e=s.pendingProps;var n=Ls(s,we.current);Is(s,a),n=Ni(null,s,r,e,n,a);var o=ki();return s.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Ee(r)?(o=!0,Er(s)):o=!1,s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,yi(s),n.updater=en,s.stateNode=n,n._reactInternals=s,To(s,r,e,a),s=Eo(null,s,r,!0,o,a)):(s.tag=0,X&&o&&pi(s),Ne(null,s,n,a),s=s.child),s;case 16:r=s.elementType;e:{switch(fr(e,s),e=s.pendingProps,n=r._init,r=n(r._payload),s.type=r,n=s.tag=mm(r),e=Ke(r,e),n){case 0:s=Io(null,s,r,e,a);break e;case 1:s=Hl(null,s,r,e,a);break e;case 11:s=Vl(null,s,r,e,a);break e;case 14:s=Gl(null,s,r,Ke(r.type,e),a);break e}throw Error(S(306,r,""))}return s;case 0:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Ke(r,n),Io(e,s,r,n,a);case 1:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Ke(r,n),Hl(e,s,r,n,a);case 3:e:{if(lu(s),e===null)throw Error(S(387));r=s.pendingProps,o=s.memoizedState,n=o.element,Od(e,s),Mr(s,r,null,a);var i=s.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},s.updateQueue.baseState=o,s.memoizedState=o,s.flags&256){n=Vs(Error(S(423)),s),s=Fl(e,s,r,a,n);break e}else if(r!==n){n=Vs(Error(S(424)),s),s=Fl(e,s,r,a,n);break e}else for(Oe=Et(s.stateNode.containerInfo.firstChild),De=s,X=!0,Ye=null,a=Rd(s,null,r,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Os(),r===n){s=yt(e,s,a);break e}Ne(e,s,r,a)}s=s.child}return s;case 5:return Dd(s),e===null&&So(s),r=s.type,n=s.pendingProps,o=e!==null?e.memoizedProps:null,i=n.children,_o(r,n)?i=null:o!==null&&_o(r,o)&&(s.flags|=32),iu(e,s),Ne(e,s,i,a),s.child;case 6:return e===null&&So(s),null;case 13:return cu(e,s,a);case 4:return bi(s,s.stateNode.containerInfo),r=s.pendingProps,e===null?s.child=Ds(s,null,r,a):Ne(e,s,r,a),s.child;case 11:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Ke(r,n),Vl(e,s,r,n,a);case 7:return Ne(e,s,s.pendingProps,a),s.child;case 8:return Ne(e,s,s.pendingProps.children,a),s.child;case 12:return Ne(e,s,s.pendingProps.children,a),s.child;case 10:e:{if(r=s.type._context,n=s.pendingProps,o=s.memoizedProps,i=n.value,K(Or,r._currentValue),r._currentValue=i,o!==null)if(et(o.value,i)){if(o.children===n.children&&!Ie.current){s=yt(e,s,a);break e}}else for(o=s.child,o!==null&&(o.return=s);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=gt(-1,a&-a),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=a,c=o.alternate,c!==null&&(c.lanes|=a),Co(o.return,a,s),l.lanes|=a;break}c=c.next}}else if(o.tag===10)i=o.type===s.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(S(341));i.lanes|=a,l=i.alternate,l!==null&&(l.lanes|=a),Co(i,a,s),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===s){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Ne(e,s,n.children,a),s=s.child}return s;case 9:return n=s.type,r=s.pendingProps.children,Is(s,a),n=$e(n),r=r(n),s.flags|=1,Ne(e,s,r,a),s.child;case 14:return r=s.type,n=Ke(r,s.pendingProps),n=Ke(r.type,n),Gl(e,s,r,n,a);case 15:return nu(e,s,s.type,s.pendingProps,a);case 17:return r=s.type,n=s.pendingProps,n=s.elementType===r?n:Ke(r,n),fr(e,s),s.tag=1,Ee(r)?(e=!0,Er(s)):e=!1,Is(s,a),su(s,r,n),To(s,r,n,a),Eo(null,s,r,!0,e,a);case 19:return du(e,s,a);case 22:return ou(e,s,a)}throw Error(S(156,s.tag))};function Su(e,s){return Jc(e,s)}function pm(e,s,a,r){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ue(e,s,a,r){return new pm(e,s,a,r)}function Oi(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mm(e){if(typeof e=="function")return Oi(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ei)return 11;if(e===ti)return 14}return 2}function Dt(e,s){var a=e.alternate;return a===null?(a=Ue(e.tag,s,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=s,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,s=e.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function br(e,s,a,r,n,o){var i=2;if(r=e,typeof e=="function")Oi(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case xs:return es(a.children,n,o,s);case Jo:i=8,n|=8;break;case Xn:return e=Ue(12,a,s,n|2),e.elementType=Xn,e.lanes=o,e;case Jn:return e=Ue(13,a,s,n),e.elementType=Jn,e.lanes=o,e;case eo:return e=Ue(19,a,s,n),e.elementType=eo,e.lanes=o,e;case Dc:return an(a,n,o,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Lc:i=10;break e;case Oc:i=9;break e;case ei:i=11;break e;case ti:i=14;break e;case jt:i=16,r=null;break e}throw Error(S(130,e==null?e:typeof e,""))}return s=Ue(i,a,s,n),s.elementType=e,s.type=r,s.lanes=o,s}function es(e,s,a,r){return e=Ue(7,e,r,s),e.lanes=a,e}function an(e,s,a,r){return e=Ue(22,e,r,s),e.elementType=Dc,e.lanes=a,e.stateNode={isHidden:!1},e}function On(e,s,a){return e=Ue(6,e,null,s),e.lanes=a,e}function Dn(e,s,a){return s=Ue(4,e.children!==null?e.children:[],e.key,s),s.lanes=a,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function hm(e,s,a,r,n){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xn(0),this.expirationTimes=xn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xn(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Di(e,s,a,r,n,o,i,l,c){return e=new hm(e,s,a,l,c),s===1?(s=1,o===!0&&(s|=8)):s=0,o=Ue(3,null,null,s),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},yi(o),e}function gm(e,s,a){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gs,key:r==null?null:""+r,children:e,containerInfo:s,implementation:a}}function Cu(e){if(!e)return Vt;e=e._reactInternals;e:{if(ls(e)!==e||e.tag!==1)throw Error(S(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Ee(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(S(171))}if(e.tag===1){var a=e.type;if(Ee(a))return Cd(e,a,s)}return s}function Au(e,s,a,r,n,o,i,l,c){return e=Di(a,r,!0,e,n,o,i,l,c),e.context=Cu(null),a=e.current,r=ke(),n=Ot(a),o=gt(r,n),o.callback=s??null,Rt(a,o,n),e.current.lanes=n,La(e,n,r),Re(e,r),e}function rn(e,s,a,r){var n=s.current,o=ke(),i=Ot(n);return a=Cu(a),s.context===null?s.context=a:s.pendingContext=a,s=gt(o,i),s.payload={element:e},r=r===void 0?null:r,r!==null&&(s.callback=r),e=Rt(n,s,i),e!==null&&(Je(e,n,i,o),hr(e,n,i)),i}function $r(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yl(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<s?a:s}}function Mi(e,s){Yl(e,s),(e=e.alternate)&&Yl(e,s)}function xm(){return null}var Tu=typeof reportError=="function"?reportError:function(e){console.error(e)};function Vi(e){this._internalRoot=e}nn.prototype.render=Vi.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(S(409));rn(e,s,null,null)};nn.prototype.unmount=Vi.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;ns(function(){rn(null,e,null,null)}),s[ft]=null}};function nn(e){this._internalRoot=e}nn.prototype.unstable_scheduleHydration=function(e){if(e){var s=od();e={blockedOn:null,target:e,priority:s};for(var a=0;a<kt.length&&s!==0&&s<kt[a].priority;a++);kt.splice(a,0,e),a===0&&ld(e)}};function Gi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function on(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Xl(){}function fm(e,s,a,r,n){if(n){if(typeof r=="function"){var o=r;r=function(){var d=$r(i);o.call(d)}}var i=Au(s,r,e,0,null,!1,!1,"",Xl);return e._reactRootContainer=i,e[ft]=i.current,Na(e.nodeType===8?e.parentNode:e),ns(),i}for(;n=e.lastChild;)e.removeChild(n);if(typeof r=="function"){var l=r;r=function(){var d=$r(c);l.call(d)}}var c=Di(e,0,!1,null,null,!1,!1,"",Xl);return e._reactRootContainer=c,e[ft]=c.current,Na(e.nodeType===8?e.parentNode:e),ns(function(){rn(s,c,a,r)}),c}function ln(e,s,a,r,n){var o=a._reactRootContainer;if(o){var i=o;if(typeof n=="function"){var l=n;n=function(){var c=$r(i);l.call(c)}}rn(s,i,e,n)}else i=fm(a,s,e,n,r);return $r(i)}rd=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var a=sa(s.pendingLanes);a!==0&&(ri(s,a|1),Re(s,oe()),!(z&6)&&(Gs=oe()+500,Ft()))}break;case 13:ns(function(){var r=vt(e,1);if(r!==null){var n=ke();Je(r,e,1,n)}}),Mi(e,1)}};ni=function(e){if(e.tag===13){var s=vt(e,134217728);if(s!==null){var a=ke();Je(s,e,134217728,a)}Mi(e,134217728)}};nd=function(e){if(e.tag===13){var s=Ot(e),a=vt(e,s);if(a!==null){var r=ke();Je(a,e,s,r)}Mi(e,s)}};od=function(){return Z};id=function(e,s){var a=Z;try{return Z=e,s()}finally{Z=a}};uo=function(e,s,a){switch(s){case"input":if(ao(e,a),s=a.name,a.type==="radio"&&s!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<a.length;s++){var r=a[s];if(r!==e&&r.form===e.form){var n=Yr(r);if(!n)throw Error(S(90));Vc(r),ao(r,n)}}}break;case"textarea":Hc(e,a);break;case"select":s=a.value,s!=null&&Cs(e,!!a.multiple,s,!1)}};Zc=Ei;qc=ns;var vm={usingClientEntryPoint:!1,Events:[Da,bs,Yr,$c,Bc,Ei]},Ys={findFiberByHostInstance:Kt,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ym={bundleType:Ys.bundleType,version:Ys.version,rendererPackageName:Ys.rendererPackageName,rendererConfig:Ys.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Yc(e),e===null?null:e.stateNode},findFiberByHostInstance:Ys.findFiberByHostInstance||xm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sr.isDisabled&&sr.supportsFiber)try{Zr=sr.inject(ym),ot=sr}catch{}}Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vm;Ve.createPortal=function(e,s){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gi(s))throw Error(S(200));return gm(e,s,null,a)};Ve.createRoot=function(e,s){if(!Gi(e))throw Error(S(299));var a=!1,r="",n=Tu;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(r=s.identifierPrefix),s.onRecoverableError!==void 0&&(n=s.onRecoverableError)),s=Di(e,1,!1,null,null,a,!1,r,n),e[ft]=s.current,Na(e.nodeType===8?e.parentNode:e),new Vi(s)};Ve.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(S(188)):(e=Object.keys(e).join(","),Error(S(268,e)));return e=Yc(s),e=e===null?null:e.stateNode,e};Ve.flushSync=function(e){return ns(e)};Ve.hydrate=function(e,s,a){if(!on(s))throw Error(S(200));return ln(null,e,s,!0,a)};Ve.hydrateRoot=function(e,s,a){if(!Gi(e))throw Error(S(405));var r=a!=null&&a.hydratedSources||null,n=!1,o="",i=Tu;if(a!=null&&(a.unstable_strictMode===!0&&(n=!0),a.identifierPrefix!==void 0&&(o=a.identifierPrefix),a.onRecoverableError!==void 0&&(i=a.onRecoverableError)),s=Au(s,null,e,1,a??null,n,!1,o,i),e[ft]=s.current,Na(e),r)for(e=0;e<r.length;e++)a=r[e],n=a._getVersion,n=n(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,n]:s.mutableSourceEagerHydrationData.push(a,n);return new nn(s)};Ve.render=function(e,s,a){if(!on(s))throw Error(S(200));return ln(null,e,s,!1,a)};Ve.unmountComponentAtNode=function(e){if(!on(e))throw Error(S(40));return e._reactRootContainer?(ns(function(){ln(null,null,e,!1,function(){e._reactRootContainer=null,e[ft]=null})}),!0):!1};Ve.unstable_batchedUpdates=Ei;Ve.unstable_renderSubtreeIntoContainer=function(e,s,a,r){if(!on(a))throw Error(S(200));if(e==null||e._reactInternals===void 0)throw Error(S(38));return ln(e,s,a,!1,r)};Ve.version="18.3.1-next-f1338f8080-20240426";function Pu(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pu)}catch(e){console.error(e)}}Pu(),Pc.exports=Ve;var bm=Pc.exports,Jl=bm;Qn.createRoot=Jl.createRoot,Qn.hydrateRoot=Jl.hydrateRoot;const _m={none:"",sm:"p-3",md:"p-4",lg:"p-6"},wm={default:"bg-slate-800 border border-slate-700",gradient:"bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700",bordered:"bg-slate-800/50 backdrop-blur-sm border border-slate-700"},b=({children:e,className:s="",variant:a="default",padding:r="lg",hover:n=!1,onClick:o})=>{const i="rounded-xl transition-all",l=n?"hover:border-slate-600 hover:scale-[1.02]":"",c=o?"cursor-pointer":"";return t.jsx("div",{className:`${i} ${wm[a]} ${_m[r]} ${l} ${c} ${s}`,onClick:o,children:e})},$=({title:e,subtitle:s,action:a})=>t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-white",children:e}),s&&t.jsx("p",{className:"text-sm text-slate-400",children:s})]}),a]}),jm={success:"bg-emerald-500/20 text-emerald-400",error:"bg-red-500/20 text-red-400",warning:"bg-amber-500/20 text-amber-400",info:"bg-blue-500/20 text-blue-400",default:"bg-slate-500/20 text-slate-400"},Nm={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"},ve=({children:e,variant:s="default",size:a="md",className:r="",pill:n=!0})=>{const o=n?"rounded-full":"rounded";return t.jsx("span",{className:`inline-flex items-center font-medium ${o} ${jm[s]} ${Nm[a]} ${r}`,children:e})},km=({change:e,trend:s})=>{const a=s==="up"?"success":s==="down"?"error":"default";return t.jsx(ve,{variant:a,size:"sm",children:e})},Sm={primary:"bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:from-cyan-600 hover:to-blue-700 shadow-lg shadow-cyan-500/25",secondary:"bg-slate-700 text-white hover:bg-slate-600 border border-slate-600",ghost:"text-slate-400 hover:text-white hover:bg-slate-700",danger:"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30"},Cm={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},M=({children:e,variant:s="primary",size:a="md",fullWidth:r=!1,isLoading:n=!1,leftIcon:o,rightIcon:i,className:l="",disabled:c,...d})=>{const u="inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-slate-900",p=r?"w-full":"",h=c||n?"opacity-50 cursor-not-allowed":"";return t.jsxs("button",{className:`${u} ${Sm[s]} ${Cm[a]} ${p} ${h} ${l}`,disabled:c||n,...d,children:[n?t.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):o,e,i]})},Am={sm:"h-1",md:"h-2",lg:"h-3"},ra=({value:e,max:s=100,color:a="bg-cyan-500",label:r,showValue:n=!1,size:o="md",className:i=""})=>{const l=Math.min(100,Math.max(0,e/s*100));return t.jsxs("div",{className:i,children:[(r||n)&&t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r&&t.jsx("span",{className:"text-white font-medium",children:r}),n&&t.jsxs("span",{className:"text-slate-400",children:[l.toFixed(0),"%"]})]}),t.jsx("div",{className:`${Am[o]} bg-slate-700 rounded-full overflow-hidden`,children:t.jsx("div",{className:`h-full ${a} rounded-full transition-all duration-500`,style:{width:`${l}%`}})})]})},Tm=({label:e,value:s,color:a})=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-white font-medium",children:e}),t.jsxs("span",{className:"text-slate-400",children:[s,"%"]})]}),t.jsx(ra,{value:s,color:a,size:"md"})]}),Pm=[{id:"dashboard",label:"Dashboard",icon:"dashboard"},{id:"opsvalue",label:"Ops Value Dashboard",icon:"opsvalue"},{id:"compliance",label:"Compliance",icon:"compliance"},{id:"monitoring",label:"Real-Time Monitoring",icon:"monitoring"},{id:"dependencymap",label:"Dependency Map",icon:"topology"},{id:"incidents",label:"Incident Correlation",icon:"incidents"},{id:"cloudmanagement",label:"Cloud Management",icon:"cloud"},{id:"multicloudvisibility",label:"Multi-Cloud Visibility",icon:"multicloud"},{id:"pathanalysis",label:"Path Analysis (Classic)",icon:"path"},{id:"pathanalysisenhanced",label:"Path Analysis (Graph)",icon:"path"},{id:"routeintelligence",label:"Route Intelligence",icon:"route"},{id:"l1whitelisting",label:"L1 Whitelisting",icon:"whitelist"},{id:"tickets",label:"Create Ticket",icon:"ticket"},{id:"statusboard",label:"Ticket Status",icon:"kanban"},{id:"rulegenerator",label:"Rule Generator",icon:"code"},{id:"validation",label:"Validation",icon:"validation"},{id:"conflicts",label:"Conflict Detection",icon:"conflicts"},{id:"settings",label:"Settings",icon:"settings"}],ec={dashboard:{title:"Executive Dashboard",subtitle:"High-level overview of security posture and operations"},compliance:{title:"Compliance Dashboard",subtitle:"Framework compliance scores and violation tracking"},monitoring:{title:"Real-Time Monitoring",subtitle:"Live metrics across AWS, Azure, GCP & On-Premises infrastructure"},dependencymap:{title:"Application Dependency Map",subtitle:"Real-time service topology with health scores and latency monitoring"},incidents:{title:"Incident Correlation",subtitle:"AI-powered root cause analysis across multi-cloud infrastructure"},cloudmanagement:{title:"Multi-Cloud Management",subtitle:"Unified view of AWS, Azure & GCP security controls"},pathanalysis:{title:"Network Path Analysis",subtitle:"Trace traffic flow through security controls and routing components"},pathanalysisenhanced:{title:"Traffic Path Analysis (Graph View)",subtitle:"Graph-based visualization with blocked hop, asymmetric routing, and missing rule detection"},routeintelligence:{title:"Route Intelligence",subtitle:"AI-powered anomaly detection for network routing issues"},tickets:{title:"Create Policy Change Request",subtitle:"ServiceNow Integration - Automated Risk Assessment"},statusboard:{title:"Ticket Status Board",subtitle:"Track policy change requests through approval workflow"},rulegenerator:{title:"Multi-Cloud Rule Generator",subtitle:"Generate platform-specific firewall rules from unified policy"},validation:{title:"Rule Validation Dashboard",subtitle:"Syntax, Conflict Detection & Compliance Validation"},conflicts:{title:"Conflict Detection Engine",subtitle:"Identify Allow/Deny conflicts, Shadowing & Redundancy issues"},l1whitelisting:{title:"L1 Firewall Whitelisting",subtitle:"AI-powered ServiceNow ticket processing with automatic implementation"},multicloudvisibility:{title:"Multi-Cloud Visibility",subtitle:"Unified view of network infrastructure across AWS, Azure, GCP, OCI, and On-Premises"},opsvalue:{title:"Ops Value Dashboard",subtitle:"Metrics for management: Ticket TAT, Automation Rate, Change Success, Compliance & ROI"},settings:{title:"Settings & Configuration",subtitle:"Manage cloud connections, integrations, users, and system preferences"}},tc="dashboard",na={score:{excellent:{stroke:"#10b981"},good:{stroke:"#06b6d4"},warning:{stroke:"#f59e0b"},critical:{stroke:"#ef4444"}},alert:{critical:{bg:"bg-red-500/10",border:"border-red-500/30",borderLeft:"border-l-red-500",hover:"hover:bg-red-500/20"},warning:{bg:"bg-amber-500/10",border:"border-amber-500/30",borderLeft:"border-l-amber-500",hover:"hover:bg-amber-500/20"},info:{bg:"bg-blue-500/10",border:"border-blue-500/30",borderLeft:"border-l-blue-500",hover:"hover:bg-blue-500/20"}}},Im={arcRatio:.75},sc={name:"Atlas AIOps",tagline:"Multi-Cloud Manager"},Hi={REAL_TIME:2e3,ALERTS:5e3,METRICS:1e3},Iu={MAX_ALERTS:15,TRAFFIC_GRAPH_POINTS:60},ar={activeConnections:{min:30,max:70},ingress:{min:10,max:40},egress:{min:8,max:35},firewallCpu:{min:50,max:85}},ac={WARNING:60,CRITICAL:75},Em={sm:{width:80,radius:30,strokeWidth:6},md:{width:128,radius:45,strokeWidth:10},lg:{width:160,radius:55,strokeWidth:12}},Rm=e=>{switch(e){case"critical":return{stroke:na.score.critical.stroke,bg:"from-red-500/20 to-red-600/10",text:"text-red-400",dot:"bg-red-500 animate-pulse"};case"warning":return{stroke:na.score.warning.stroke,bg:"from-amber-500/20 to-amber-600/10",text:"text-amber-400",dot:"bg-amber-500 animate-pulse"};case"good":return{stroke:na.score.excellent.stroke,bg:"from-emerald-500/20 to-emerald-600/10",text:"text-emerald-400",dot:"bg-emerald-500"};default:return{stroke:na.score.good.stroke,bg:"from-cyan-500/20 to-cyan-600/10",text:"text-cyan-400",dot:"bg-cyan-500"}}},Lm=e=>{switch(e){case"critical":return"Critical";case"warning":return"Warning";case"good":case"normal":return"Normal";default:return"Unknown"}},rr=({value:e,label:s,sublabel:a,status:r,icon:n,size:o="md",animated:i=!0})=>{const[l,c]=f.useState(0);f.useEffect(()=>{if(i){const j=setTimeout(()=>c(e),100);return()=>clearTimeout(j)}else c(e)},[e,i]);const d=Em[o],u=2*Math.PI*d.radius,p=Im.arcRatio,h=u-l/100*u*p,y=Rm(r);return t.jsxs("div",{className:`bg-gradient-to-br ${y.bg} backdrop-blur-sm rounded-2xl p-6 border border-white/10 hover:border-white/20 transition-all`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold text-lg",children:s}),a&&t.jsx("p",{className:"text-slate-400 text-sm",children:a})]}),n&&t.jsx("div",{className:"text-2xl",children:n})]}),t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs("div",{className:"relative",children:[t.jsxs("svg",{className:"transform -rotate-135",width:d.width,height:d.width,children:[t.jsx("circle",{cx:d.width/2,cy:d.width/2,r:d.radius,fill:"none",stroke:"rgba(255,255,255,0.1)",strokeWidth:d.strokeWidth,strokeDasharray:u,strokeDashoffset:u*(1-p),strokeLinecap:"round"}),t.jsx("circle",{cx:d.width/2,cy:d.width/2,r:d.radius,fill:"none",stroke:y.stroke,strokeWidth:d.strokeWidth,strokeDasharray:u,strokeDashoffset:h,strokeLinecap:"round",className:"transition-all duration-1000 ease-out",style:{filter:`drop-shadow(0 0 8px ${y.stroke})`}})]}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("span",{className:"text-3xl font-bold text-white",children:Math.round(l)}),t.jsx("span",{className:"text-lg text-slate-400",children:"%"})]})})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${y.dot}`}),t.jsx("span",{className:`text-sm font-medium ${y.text}`,children:Lm(r)})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-slate-500",children:"Current"}),t.jsxs("span",{className:"text-white font-mono",children:[Math.round(l),"%"]})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-slate-500",children:"Max"}),t.jsx("span",{className:"text-white font-mono",children:"100%"})]})]})]})]})]})},Om={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},rc={success:"bg-emerald-500",error:"bg-red-500",warning:"bg-amber-500",info:"bg-blue-500",default:"bg-slate-500",operational:"bg-emerald-500",degraded:"bg-amber-500",down:"bg-red-500",critical:"bg-red-500"},Fi=({status:e,size:s="md",pulse:a=!1,className:r=""})=>{const n=rc[e]||rc.default,o=a||e==="critical"||e==="degraded"?"animate-pulse":"";return t.jsx("div",{className:`rounded-full ${Om[s]} ${n} ${o} ${r}`})},Dm=({label:e="LIVE",className:s=""})=>t.jsxs("div",{className:`flex items-center gap-2 ${s}`,children:[t.jsx(Fi,{status:"success",size:"md",pulse:!0}),t.jsx("span",{className:"text-emerald-400 font-medium",children:e})]}),Mm=({name:e,status:s,latency:a,icon:r})=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:r}),t.jsx("span",{className:"text-white text-sm",children:e})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-slate-400 text-xs font-mono",children:a}),t.jsx(Fi,{status:s,pulse:s!=="operational"})]})]}),Eu=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),Vm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Ru=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Gm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),Hm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Fm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),Wm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),Um=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),zm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),$m=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),Bm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Zm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),qm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Km=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),Qm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ym=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Xm=({className:e="w-5 h-5"})=>t.jsxs("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Jm=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Lu=({className:e="w-6 h-6"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),eh=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),th=({className:e="w-5 h-5"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),sh=({className:e="w-6 h-6"})=>t.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),ah={dashboard:Eu,compliance:Vm,monitoring:Ru,topology:Gm,incidents:Hm,cloud:Fm,multicloud:Qm,path:Wm,route:Um,ticket:zm,kanban:$m,whitelist:Bm,code:Zm,validation:qm,conflicts:Km,opsvalue:Ym,settings:Xm},rh=({name:e,className:s})=>{const a=ah[e]||Eu;return t.jsx(a,{className:s})},nh=({value:e,onChange:s,placeholder:a="Search...",className:r=""})=>t.jsxs("div",{className:`relative ${r}`,children:[t.jsx("input",{type:"text",value:e,onChange:n=>s==null?void 0:s(n.target.value),placeholder:a,className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),t.jsx(Jm,{className:"w-5 h-5 text-slate-400 absolute left-3 top-2.5"})]}),oh=({time:e,label:s="Current Time (UTC)",format:a="24h",className:r=""})=>{const n=e.toLocaleTimeString("en-US",{hour12:a==="12h"});return t.jsxs("div",{className:`bg-slate-800 rounded-xl px-6 py-3 border border-slate-700 ${r}`,children:[t.jsx("div",{className:"text-xs text-slate-400 mb-1",children:s}),t.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:n})]})},ih=({time:e,label:s="Current Time (UTC)",format:a="24h",className:r=""})=>{const n=e.toLocaleTimeString("en-US",{hour12:a==="12h"});return t.jsxs("div",{className:`bg-slate-800/50 backdrop-blur-sm rounded-xl px-6 py-3 border border-slate-700 ${r}`,children:[t.jsx("div",{className:"text-xs text-slate-400 mb-1",children:s}),t.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:n})]})},lh=({label:e,value:s,change:a,trend:r="stable",icon:n,className:o=""})=>t.jsxs(b,{hover:!0,className:o,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n&&t.jsx("span",{className:"text-3xl",children:n}),a&&t.jsx(km,{change:a,trend:r})]}),t.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s}),t.jsx("div",{className:"text-sm text-slate-400",children:e})]}),ch=({label:e,value:s,unit:a="",icon:r,trend:n,colorClass:o="from-cyan-500/20 to-cyan-600/10"})=>{const i=l=>l.includes("")?"text-emerald-400":l.includes("")?"text-red-400":"text-slate-400";return t.jsxs("div",{className:`bg-gradient-to-br ${o} backdrop-blur-sm rounded-xl p-3 border border-white/10`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"text-slate-400 text-xs",children:e}),t.jsx("span",{className:"text-lg",children:r})]}),t.jsxs("div",{className:"flex items-baseline gap-1",children:[t.jsx("span",{className:"text-xl font-bold text-white",children:s}),t.jsx("span",{className:"text-slate-400 text-xs",children:a})]}),n&&t.jsx("div",{className:`text-xs mt-1 ${i(n)}`,children:n})]})},Mn=({label:e,value:s,valueColor:a="text-white"})=>t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:`text-2xl font-bold ${a}`,children:s}),t.jsx("div",{className:"text-xs text-slate-400",children:e})]}),nr=({label:e,error:s,className:a="",...r})=>t.jsxs("div",{children:[e&&t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),t.jsx("input",{className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
          focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed
          ${s?"border-red-500":""} ${a}`,...r}),s&&t.jsx("p",{className:"mt-1 text-sm text-red-600",children:s})]}),dh=({label:e,error:s,className:a="",children:r,...n})=>t.jsxs("div",{children:[e&&t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),t.jsx("select",{className:`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm
          focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500
          disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed
          ${s?"border-red-500":""} ${a}`,...n,children:r}),s&&t.jsx("p",{className:"mt-1 text-sm text-red-600",children:s})]}),uh=({isOpen:e,onClose:s,title:a,children:r,size:n="md"})=>{if(!e)return null;const o={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};return t.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:s}),t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl w-full ${o[n]}`,onClick:i=>i.stopPropagation(),children:[a&&t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r]})})]})},ph=({menuItems:e,activeView:s,collapsed:a,onViewChange:r,onToggleCollapse:n})=>t.jsxs("aside",{className:`${a?"w-20":"w-64"} bg-slate-800 border-r border-slate-700 flex flex-col transition-all duration-300`,children:[t.jsx(mh,{collapsed:a}),t.jsx(hh,{menuItems:e,activeView:s,collapsed:a,onViewChange:r}),t.jsx(xh,{collapsed:a,onToggleCollapse:n})]}),mh=({collapsed:e})=>t.jsx("div",{className:"p-4 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0",children:t.jsx(sh,{className:"w-6 h-6 text-white"})}),!e&&t.jsxs("div",{children:[t.jsx("h1",{className:"text-lg font-bold text-white",children:sc.name}),t.jsx("p",{className:"text-xs text-slate-400",children:sc.tagline})]})]})}),hh=({menuItems:e,activeView:s,collapsed:a,onViewChange:r})=>t.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:t.jsx("ul",{className:"space-y-2",children:e.map(n=>t.jsx(gh,{item:n,isActive:s===n.id,collapsed:a,onClick:()=>r(n.id)},n.id))})}),gh=({item:e,isActive:s,collapsed:a,onClick:r})=>t.jsx("li",{children:t.jsxs("button",{onClick:r,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${s?"bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-lg shadow-cyan-500/25":"text-slate-400 hover:bg-slate-700 hover:text-white"}`,title:a?e.label:void 0,"aria-current":s?"page":void 0,children:[t.jsx(rh,{name:e.icon}),!a&&t.jsx("span",{className:"font-medium",children:e.label})]})}),xh=({collapsed:e,onToggleCollapse:s})=>t.jsx("div",{className:"p-4 border-t border-slate-700",children:t.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":e?"Expand sidebar":"Collapse sidebar",children:[t.jsx(eh,{className:`w-5 h-5 transition-transform ${e?"rotate-180":""}`}),!e&&t.jsx("span",{className:"text-sm",children:"Collapse"})]})}),fh=({viewInfo:e,notifications:s,onNotificationClick:a})=>t.jsx("header",{className:"bg-slate-800 border-b border-slate-700 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(vh,{title:e.title,subtitle:e.subtitle}),t.jsx(yh,{notifications:s,onNotificationClick:a})]})}),vh=({title:e,subtitle:s})=>t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:e}),t.jsx("p",{className:"text-sm text-slate-400",children:s})]}),yh=({notifications:e,onNotificationClick:s})=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(nh,{className:"w-64"}),t.jsx(bh,{count:e,onClick:s}),t.jsx(_h,{})]}),bh=({count:e,onClick:s})=>t.jsxs("button",{onClick:s,className:"relative p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors","aria-label":`Notifications (${e} unread)`,children:[t.jsx(Lu,{className:"w-6 h-6"}),e>0&&t.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:e})]}),_h=()=>t.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-slate-700",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm font-medium text-white",children:"Admin User"}),t.jsx("div",{className:"text-xs text-slate-400",children:"Security Team"})]}),t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:"AU"})]}),wh=({children:e,menuItems:s,activeView:a,viewInfo:r,sidebarCollapsed:n,notifications:o,onViewChange:i,onToggleSidebar:l,onNotificationClick:c})=>t.jsxs("div",{className:"min-h-screen bg-slate-900 flex",children:[t.jsx(ph,{menuItems:s,activeView:a,collapsed:n,onViewChange:i,onToggleCollapse:l}),t.jsxs("main",{className:"flex-1 flex flex-col",children:[t.jsx(fh,{viewInfo:r,notifications:o,onNotificationClick:c}),t.jsx("div",{className:"flex-1 overflow-auto bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e})]})]}),J=({children:e,className:s=""})=>t.jsx("div",{className:`p-6 ${s}`,children:e}),jh={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6"},Nh={sm:"gap-3",md:"gap-4",lg:"gap-6"},Wi=({children:e,cols:s=4,gap:a="lg",className:r=""})=>t.jsx("div",{className:`grid ${jh[s]} ${Nh[a]} ${r}`,children:e});function Ou(e={}){const{refreshInterval:s=Hi.METRICS}=e,[a,r]=f.useState(new Date);return f.useEffect(()=>{const n=setInterval(()=>{r(new Date)},s);return()=>clearInterval(n)},[s]),a}function kh(e=!1){const[s,a]=f.useState(e),r=f.useCallback(()=>{a(o=>!o)},[]),n=f.useCallback(o=>{a(o)},[]);return[s,r,n]}function Sh(e=tc){const[s,a]=f.useState(e),r=f.useMemo(()=>ec[s]||ec[tc],[s]),n=f.useCallback(o=>{a(o)},[]);return{activeView:s,viewInfo:r,setActiveView:n}}const Ch={headers:{"Content-Type":"application/json"},timeout:3e4};class Ah{constructor(s="",a={}){dn(this,"baseUrl");dn(this,"defaultConfig");this.baseUrl=s,this.defaultConfig={...Ch,...a}}async request(s,a={}){const r=`${this.baseUrl}${s}`,n={...a,headers:{...this.defaultConfig.headers,...a.headers}};try{const o=new AbortController,i=a.timeout||this.defaultConfig.timeout,l=setTimeout(()=>o.abort(),i),c=await fetch(r,{...n,signal:o.signal});if(clearTimeout(l),!c.ok){const u=await c.json().catch(()=>({}));throw{status:c.status,message:u.message||c.statusText,code:u.code}}return{data:await c.json(),status:c.status}}catch(o){throw o.name==="AbortError"?{status:408,message:"Request timeout",code:"TIMEOUT"}:o}}async get(s,a){return this.request(s,{method:"GET",...a})}async post(s,a,r){return this.request(s,{method:"POST",body:a?JSON.stringify(a):void 0,...r})}async put(s,a,r){return this.request(s,{method:"PUT",body:a?JSON.stringify(a):void 0,...r})}async patch(s,a,r){return this.request(s,{method:"PATCH",body:a?JSON.stringify(a):void 0,...r})}async delete(s,a){return this.request(s,{method:"DELETE",...a})}}new Ah("/api");const Th=async()=>[{label:"Active Rules",value:"4,892",change:"+12",trend:"up",icon:"",color:"cyan"},{label:"Security Groups",value:"247",change:"+3",trend:"up",icon:"",color:"purple"},{label:"Transit Gateways",value:"18",change:"0",trend:"stable",icon:"",color:"emerald"},{label:"Open Tickets",value:"23",change:"-5",trend:"down",icon:"",color:"amber"}],Ph=async()=>[{id:1,action:"Rule deployed",target:"sg-web-prod",user:"automation",time:"2 min ago",status:"success"},{id:2,action:"Policy change approved",target:"CHG0012347",user:"j.smith",time:"15 min ago",status:"success"},{id:3,action:"Validation failed",target:"Allow-External-SSH",user:"system",time:"32 min ago",status:"error"},{id:4,action:"Compliance scan completed",target:"PCI-DSS",user:"scanner",time:"1 hour ago",status:"success"},{id:5,action:"Anomaly detected",target:"tgw-prod-east",user:"ai-engine",time:"2 hours ago",status:"warning"}],Ih=async()=>[{name:"AWS",value:65,color:"bg-orange-500"},{name:"Azure",value:25,color:"bg-blue-500"},{name:"GCP",value:10,color:"bg-red-500"}],Eh=async()=>({activeConnections:49,ingress:24,egress:18,firewallCpu:67}),Rh=async()=>[{label:"Blocked Attacks",value:"1,247",unit:"/hr",icon:"",color:"red",trend:" -12%"},{label:"Policy Changes",value:"23",unit:"pending",icon:"",color:"amber",trend:" +5"},{label:"Compliance",value:"98.5",unit:"%",icon:"",color:"emerald",trend:" +0.2%"},{label:"Avg Latency",value:"12",unit:"ms",icon:"",color:"cyan",trend:" -2ms"},{label:"Active Rules",value:"4,892",unit:"",icon:"",color:"purple"},{label:"TGW Attachments",value:"18",unit:"active",icon:"",color:"cyan"}],Lh=async()=>[{name:"AWS",status:"operational",latency:"12ms",icon:""},{name:"Azure",status:"operational",latency:"18ms",icon:""},{name:"GCP",status:"degraded",latency:"45ms",icon:""},{name:"Palo Alto",status:"operational",latency:"3ms",icon:""}],Oh=async()=>({compliance:"98.5%",uptime:"99.9%",avgLatency:"12ms"}),Dh=async()=>({packetDropRate:.05+Math.random()*.1,throughput:{ingress:24.5+Math.random()*5,egress:18.2+Math.random()*3},connections:{active:Math.floor(45e3+Math.random()*1e4),blocked:Math.floor(1200+Math.random()*300)},latency:{avg:12,p95:28,p99:45},firewallHealth:{cpu:Math.floor(55+Math.random()*20),memory:Math.floor(45+Math.random()*15),sessions:Math.floor(30+Math.random()*25)}}),Mh=()=>[{id:1,type:"critical",message:"Firewall CPU exceeded 65% threshold",source:"pa-fw-prod-east",time:new Date(Date.now()-3e4),acknowledged:!1},{id:2,type:"warning",message:"Asymmetric routing detected on db-cluster path",source:"tgw-prod",time:new Date(Date.now()-12e4),acknowledged:!1},{id:3,type:"info",message:"New security group rule deployed successfully",source:"sg-web-prod",time:new Date(Date.now()-3e5),acknowledged:!0},{id:4,type:"warning",message:"High connection rate from 203.0.113.0/24",source:"alb-prod",time:new Date(Date.now()-45e4),acknowledged:!1},{id:5,type:"critical",message:"Black hole route detected for 10.60.0.0/16",source:"rtb-prod-main",time:new Date(Date.now()-6e5),acknowledged:!1},{id:6,type:"info",message:"Compliance scan completed - 98.5% score",source:"atlas-scanner",time:new Date(Date.now()-9e5),acknowledged:!0},{id:7,type:"warning",message:"SSL certificate expires in 14 days",source:"cert-manager",time:new Date(Date.now()-12e5),acknowledged:!1},{id:8,type:"info",message:"Transit Gateway attachment created",source:"tgw-attach-analytics",time:new Date(Date.now()-15e5),acknowledged:!0}],Vh=()=>{const e=[{type:"info",message:"Health check passed for web-servers",source:"alb-prod"},{type:"warning",message:"Elevated latency on cross-region traffic",source:"cloud-router-us"},{type:"info",message:"Auto-scaling triggered for app-tier",source:"asg-app-prod"},{type:"warning",message:"Connection pool nearing capacity",source:"rds-primary"}];return e[Math.floor(Math.random()*e.length)]},Gh=e=>({id:Date.now(),...e,time:new Date,acknowledged:!1}),Hh=e=>{const s=Math.floor((Date.now()-e.getTime())/1e3);return s<60?`${s}s ago`:s<3600?`${Math.floor(s/60)}m ago`:`${Math.floor(s/3600)}h ago`},Fh=e=>({critical:"",warning:"",info:""})[e]||"",Du=e=>({critical:e.filter(s=>s.type==="critical"&&!s.acknowledged).length,warning:e.filter(s=>s.type==="warning"&&!s.acknowledged).length,info:e.filter(s=>s.type==="info"&&!s.acknowledged).length,unacknowledged:e.filter(s=>!s.acknowledged).length}),st=[{id:"aws-1",provider:"aws",name:"Production AWS",status:"connected",region:"us-east-1",accountId:"123456789012",lastSync:new Date(Date.now()-5*60*1e3).toISOString(),credentials:{type:"access_key",configured:!0}},{id:"azure-1",provider:"azure",name:"Azure Enterprise",status:"connected",region:"eastus",subscriptionId:"sub-abc123-def456",lastSync:new Date(Date.now()-10*60*1e3).toISOString(),credentials:{type:"service_principal",configured:!0}},{id:"gcp-1",provider:"gcp",name:"GCP Analytics",status:"error",region:"us-central1",projectId:"analytics-prod-12345",lastSync:new Date(Date.now()-60*60*1e3).toISOString(),credentials:{type:"service_account",configured:!0}},{id:"onprem-1",provider:"onprem",name:"DC-East Datacenter",status:"connected",datacenterName:"DC-EAST-01",lastSync:new Date(Date.now()-2*60*1e3).toISOString(),credentials:{type:"api_key",configured:!0}}],Vn={instanceUrl:"https://company.service-now.com",username:"api_integration",isConfigured:!0,autoCreateTickets:!0,defaultAssignmentGroup:"Network Operations",defaultPriority:"medium",syncInterval:5},Gn={type:"splunk",endpoint:"https://splunk.company.com:8089",isConfigured:!0,forwardAlerts:!0,forwardLogs:!1,alertSeverityThreshold:"medium"},Hn={type:"datadog",apiEndpoint:"https://api.datadoghq.com",isConfigured:!0,collectMetrics:!0,collectTraces:!0,sampleRate:.1},lt=[{id:"user-1",email:"admin@company.com",name:"System Administrator",role:"admin",status:"active",lastLogin:new Date(Date.now()-30*60*1e3).toISOString(),createdAt:"2024-01-15T10:00:00Z",permissions:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!0,canModifySettings:!0,canViewAuditLogs:!0,canManageUsers:!0,canExportData:!0}},{id:"user-2",email:"operator@company.com",name:"Network Operator",role:"operator",status:"active",lastLogin:new Date(Date.now()-2*60*60*1e3).toISOString(),createdAt:"2024-02-20T14:30:00Z",permissions:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!0}},{id:"user-3",email:"viewer@company.com",name:"Security Viewer",role:"viewer",status:"active",lastLogin:new Date(Date.now()-24*60*60*1e3).toISOString(),createdAt:"2024-03-10T09:15:00Z",permissions:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!1}},{id:"user-4",email:"auditor@company.com",name:"Compliance Auditor",role:"auditor",status:"active",lastLogin:new Date(Date.now()-48*60*60*1e3).toISOString(),createdAt:"2024-03-25T11:00:00Z",permissions:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!0,canManageUsers:!1,canExportData:!0}}],Fn={channels:[{id:"email-1",type:"email",name:"Operations Team",isEnabled:!0,config:{recipients:"ops@company.com"}},{id:"slack-1",type:"slack",name:"#network-alerts",isEnabled:!0,config:{channel:"#network-alerts",webhook:"https://hooks.slack.com/..."}},{id:"pagerduty-1",type:"pagerduty",name:"Critical Alerts",isEnabled:!0,config:{serviceKey:"pd-service-key",severity:"critical"}},{id:"teams-1",type:"teams",name:"Security Team",isEnabled:!1,config:{webhook:"https://outlook.office.com/webhook/..."}}],alertThreshold:"warning",quietHours:{enabled:!0,start:"22:00",end:"07:00",timezone:"America/New_York"},digest:{enabled:!0,frequency:"daily"}},Wn=[{id:"log-1",timestamp:new Date(Date.now()-5*60*1e3).toISOString(),user:"admin@company.com",action:"UPDATE_SETTINGS",resource:"ServiceNow Configuration",details:"Updated sync interval from 10 to 5 minutes",ipAddress:"10.0.1.50",status:"success"},{id:"log-2",timestamp:new Date(Date.now()-30*60*1e3).toISOString(),user:"operator@company.com",action:"CREATE_RULE",resource:"Firewall Rule",details:"Created rule: Allow HTTPS from DMZ to Production",ipAddress:"10.0.1.51",status:"success"},{id:"log-3",timestamp:new Date(Date.now()-60*60*1e3).toISOString(),user:"admin@company.com",action:"TEST_CONNECTION",resource:"GCP Analytics",details:"Connection test failed: Invalid credentials",ipAddress:"10.0.1.50",status:"failure"},{id:"log-4",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),user:"admin@company.com",action:"ADD_USER",resource:"User Management",details:"Added new user: viewer@company.com with role: viewer",ipAddress:"10.0.1.50",status:"success"},{id:"log-5",timestamp:new Date(Date.now()-3*60*60*1e3).toISOString(),user:"operator@company.com",action:"APPROVE_TICKET",resource:"Ticket CHG0012345",details:"Approved policy change request for web server access",ipAddress:"10.0.1.51",status:"success"},{id:"log-6",timestamp:new Date(Date.now()-4*60*60*1e3).toISOString(),user:"auditor@company.com",action:"EXPORT_REPORT",resource:"Compliance Report",details:"Exported PCI-DSS compliance report for Q4 2024",ipAddress:"10.0.1.55",status:"success"},{id:"log-7",timestamp:new Date(Date.now()-5*60*60*1e3).toISOString(),user:"admin@company.com",action:"UPDATE_PERMISSIONS",resource:"User Management",details:"Updated permissions for operator@company.com",ipAddress:"10.0.1.50",status:"success"},{id:"log-8",timestamp:new Date(Date.now()-24*60*60*1e3).toISOString(),user:"system",action:"SYNC_CLOUD",resource:"AWS Production",details:"Automatic sync completed: 847 resources discovered",ipAddress:"127.0.0.1",status:"success"}],he=e=>new Promise(s=>setTimeout(s,e)),Ae={async getSettings(){return await he(500),{cloudConnections:st,serviceNow:Vn,siem:Gn,apm:Hn,users:lt,notifications:Fn}},async getCloudConnections(){return await he(300),st},async testCloudConnection(e){await he(2e3);const s=st.find(a=>a.id===e);return s?s.status==="error"?{success:!1,message:"Authentication failed. Please verify credentials."}:{success:!0,message:"Connection successful. All services accessible."}:{success:!1,message:"Connection not found"}},async updateCloudConnection(e,s){await he(500);const a=st.findIndex(r=>r.id===e);if(a===-1)throw new Error("Connection not found");return st[a]={...st[a],...s},st[a]},async addCloudConnection(e){await he(500);const s={...e,id:`${e.provider}-${Date.now()}`};return st.push(s),s},async deleteCloudConnection(e){await he(300);const s=st.findIndex(a=>a.id===e);s!==-1&&st.splice(s,1)},async updateServiceNowConfig(e){return await he(500),Object.assign(Vn,e),Vn},async testServiceNowConnection(){return await he(1500),{success:!0,message:"ServiceNow connection verified successfully."}},async updateSIEMConfig(e){return await he(500),Object.assign(Gn,e),Gn},async updateAPMConfig(e){return await he(500),Object.assign(Hn,e),Hn},async getUsers(){return await he(300),lt},async addUser(e){await he(500);const s={...e,id:`user-${Date.now()}`,createdAt:new Date().toISOString()};return lt.push(s),s},async updateUser(e,s){await he(500);const a=lt.findIndex(r=>r.id===e);if(a===-1)throw new Error("User not found");return lt[a]={...lt[a],...s},lt[a]},async deleteUser(e){await he(300);const s=lt.findIndex(a=>a.id===e);s!==-1&&lt.splice(s,1)},async updateNotificationPreferences(e){return await he(500),Object.assign(Fn,e),Fn},async getAuditLogs(e){await he(400);let s=[...Wn];return e!=null&&e.user&&(s=s.filter(a=>a.user.toLowerCase().includes(e.user.toLowerCase()))),e!=null&&e.action&&(s=s.filter(a=>a.action===e.action)),e!=null&&e.startDate&&(s=s.filter(a=>new Date(a.timestamp)>=new Date(e.startDate))),e!=null&&e.endDate&&(s=s.filter(a=>new Date(a.timestamp)<=new Date(e.endDate))),s.sort((a,r)=>new Date(r.timestamp).getTime()-new Date(a.timestamp).getTime())},async exportAuditLogs(e){if(await he(1e3),e==="json")return JSON.stringify(Wn,null,2);const s=["Timestamp","User","Action","Resource","Details","IP Address","Status"],a=Wn.map(r=>[r.timestamp,r.user,r.action,r.resource,r.details,r.ipAddress,r.status]);return[s.join(","),...a.map(r=>r.join(","))].join(`
`)}},os=e=>!e||e==="*"||e==="any"||e==="0.0.0.0/0"?"0.0.0.0/0":!e.includes("/")&&!e.includes("-")?`${e}/32`:e,Wh=e=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:o,action:i,direction:l,description:c}=e,d=os(a),u=os(r);if(i==="deny")return`# AWS Security Groups do not support explicit deny rules
# Consider using Network ACLs for deny rules
# aws ec2 create-network-acl-entry --network-acl-id <acl-id> \\
#   --rule-number 100 --protocol ${o==="any"?"-1":o} \\
#   --port-range From=${n},To=${n} --cidr-block ${d} \\
#   --rule-action deny --${l==="inbound"?"ingress":"egress"}`;const p=o==="icmp"?"":`--port ${n}`,h=l==="inbound"||l==="both",y=[];return h&&y.push(`# ${s} - ${c||"Inbound rule"}
aws ec2 authorize-security-group-ingress \\
  --group-id <security-group-id> \\
  --protocol ${o==="any"?"-1":o} ${p} \\
  --cidr ${d} \\
  --tag-specifications 'ResourceType=security-group-rule,Tags=[{Key=Name,Value=${s}}]'`),(l==="outbound"||l==="both")&&y.push(`# ${s} - ${c||"Outbound rule"}
aws ec2 authorize-security-group-egress \\
  --group-id <security-group-id> \\
  --protocol ${o==="any"?"-1":o} ${p} \\
  --cidr ${u}`),y.join(`

`)},Uh=e=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:o,action:i,direction:l,priority:c=100,description:d}=e,u=a==="*"||!a?"*":os(a),p=r==="*"||!r?"*":os(r);return`# ${s} - ${d||"Azure NSG Rule"}
az network nsg rule create \\
  --resource-group <resource-group-name> \\
  --nsg-name <nsg-name> \\
  --name "${s.replace(/\s+/g,"-")}" \\
  --priority ${c} \\
  --direction ${l==="inbound"?"Inbound":"Outbound"} \\
  --access ${i==="allow"?"Allow":"Deny"} \\
  --protocol ${o==="any"?"*":o.charAt(0).toUpperCase()+o.slice(1)} \\
  --source-address-prefixes "${u}" \\
  --source-port-ranges "*" \\
  --destination-address-prefixes "${p}" \\
  --destination-port-ranges "${n||"*"}"`},zh=e=>{const{name:s,sourceIp:a,port:r,protocol:n,action:o,direction:i,priority:l=1e3,description:c}=e,d=s.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),u=os(a),p=n==="icmp"?"":r?` --rules ${n}:${r}`:` --rules ${n}`;return o==="deny"?`# ${s} - ${c||"GCP Deny Rule"}
gcloud compute firewall-rules create ${d} \\
  --project=<project-id> \\
  --network=<vpc-network> \\
  --priority=${l} \\
  --direction=${i==="inbound"?"INGRESS":"EGRESS"} \\
  --action=DENY \\
  --source-ranges="${u}"${p} \\
  --description="${c||s}"`:`# ${s} - ${c||"GCP Allow Rule"}
gcloud compute firewall-rules create ${d} \\
  --project=<project-id> \\
  --network=<vpc-network> \\
  --priority=${l} \\
  --direction=${i==="inbound"?"INGRESS":"EGRESS"} \\
  --action=ALLOW \\
  --source-ranges="${u}"${p} \\
  --target-tags=<target-tags> \\
  --description="${c||s}"`},$h=e=>{const{name:s,sourceIp:a,destinationIp:r,port:n,action:o,description:i}=e,l="untrust",c="trust",d="any",u=n?`tcp-${n}`:"any";return`# ${s} - ${i||"Palo Alto Security Rule"}
set rulebase security rules "${s}" from ${l}
set rulebase security rules "${s}" to ${c}
set rulebase security rules "${s}" source ${a||"any"}
set rulebase security rules "${s}" destination ${r||"any"}
set rulebase security rules "${s}" application ${d}
set rulebase security rules "${s}" service ${u}
set rulebase security rules "${s}" action ${o}
set rulebase security rules "${s}" log-start yes
set rulebase security rules "${s}" log-end yes
set rulebase security rules "${s}" description "${i||s}"`},Bh=e=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:o,action:i,direction:l,description:c}=e,d=l==="inbound"?"outside_access_in":"inside_access_out",u=a!=null&&a.includes("/")?`${a.split("/")[0]} ${nc(a)}`:`host ${a||"any"}`,p=r!=null&&r.includes("/")?`${r.split("/")[0]} ${nc(r)}`:`host ${r||"any"}`,h=n?`eq ${n}`:"";return`! ${s} - ${c||"Cisco ASA Rule"}
access-list ${d} extended ${i==="allow"?"permit":"deny"} ${o} ${u} ${p} ${h}
! Apply to interface (if not already applied)
! access-group ${d} in interface outside`},Zh=e=>{const{name:s,sourceIp:a,destinationIp:r,port:n,action:o,description:i}=e,l=n?`TCP/${n}`:"ALL";return`# ${s} - ${i||"FortiGate Policy"}
config firewall policy
    edit 0
        set name "${s}"
        set srcintf "wan1"
        set dstintf "lan"
        set srcaddr "${a||"all"}"
        set dstaddr "${r||"all"}"
        set action ${o}
        set schedule "always"
        set service "${l}"
        set logtraffic all
        set comments "${i||s}"
    next
end`},qh=e=>{const{name:s,sourceIp:a,destinationIp:r,port:n,protocol:o,action:i,direction:l,description:c}=e,d=l==="inbound"?"INPUT":"OUTPUT",u=i==="allow"?"ACCEPT":"DROP",p=a&&a!=="*"?`-s ${os(a)}`:"",h=r&&r!=="*"?`-d ${os(r)}`:"",y=o!=="any"?`-p ${o}`:"",j=n&&o!=="icmp"&&o!=="any"?`--dport ${n}`:"";return`# ${s} - ${c||"iptables rule"}
iptables -A ${d} ${y} ${p} ${h} ${j} -j ${u} -m comment --comment "${s}"

# For persistent rules, save with:
# iptables-save > /etc/iptables/rules.v4

# Or using nftables equivalent:
# nft add rule inet filter ${d.toLowerCase()} ${o!=="any"?`${o} `:""}${j?`dport ${n} `:""}${p?`ip saddr ${a} `:""}${h?`ip daddr ${r} `:""}${u.toLowerCase()}`};function nc(e){const a=~(2**(32-parseInt(e.split("/")[1]||"32",10))-1);return[a>>>24&255,a>>>16&255,a>>>8&255,a&255].join(".")}const Kh=e=>{var a;const s=[];return(a=e.name)!=null&&a.trim()||s.push("Rule name is required"),e.sourceIp&&!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$|^\*$|^any$/.test(e.sourceIp)&&s.push("Invalid source IP format"),e.destinationIp&&!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$|^\*$|^any$/.test(e.destinationIp)&&s.push("Invalid destination IP format"),e.port&&!/^\d+(-\d+)?$/.test(e.port)&&s.push("Invalid port format (use single port or range like 80-443)"),e.port&&e.port.split("-").map(Number).some(n=>n<1||n>65535)&&s.push("Port must be between 1 and 65535"),s},Qh=(e,s)=>{const a=[];return s==="aws"&&e.action==="deny"&&a.push("AWS Security Groups do not support deny rules. Consider using Network ACLs."),(!e.sourceIp||e.sourceIp==="*"||e.sourceIp==="0.0.0.0/0")&&a.push("Source IP is open to all (0.0.0.0/0). This may pose security risks."),e.port==="22"&&e.action==="allow"&&(!e.sourceIp||e.sourceIp==="0.0.0.0/0")&&a.push("SSH (port 22) is open to the internet. Restrict source IPs for security."),e.port==="3389"&&e.action==="allow"&&(!e.sourceIp||e.sourceIp==="0.0.0.0/0")&&a.push("RDP (port 3389) is open to the internet. Restrict source IPs for security."),a},Yh={aws:Wh,azure:Uh,gcp:zh,palo_alto:$h,cisco_asa:Bh,fortinet:Zh,iptables:qh},Un=e=>new Promise(s=>setTimeout(s,e)),oc={async generateRules(e,s){await Un(500);const a=Kh(e);return s.map(r=>{const n=Qh(e,r),o=Yh[r];if(a.length>0)return{platform:r,syntax:"",isValid:!1,validationErrors:a,warnings:n};try{const i=o(e);return{platform:r,syntax:i,isValid:!0,warnings:n}}catch(i){return{platform:r,syntax:"",isValid:!1,validationErrors:[`Failed to generate rule: ${i instanceof Error?i.message:"Unknown error"}`],warnings:n}}})},async getTemplates(){return await Un(300),Xh},async validateSyntax(e,s){return await Un(200),s.trim()?{isValid:!0,errors:[]}:{isValid:!1,errors:["Empty rule syntax"]}}},Xh=[{id:"web-server-http",name:"Web Server HTTP",description:"Allow HTTP traffic (port 80) to web servers",category:"web",input:{name:"Allow-HTTP-Inbound",description:"Allow HTTP traffic from any source",sourceIp:"0.0.0.0/0",destinationIp:"",port:"80",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"web-server-https",name:"Web Server HTTPS",description:"Allow HTTPS traffic (port 443) to web servers",category:"web",input:{name:"Allow-HTTPS-Inbound",description:"Allow HTTPS traffic from any source",sourceIp:"0.0.0.0/0",destinationIp:"",port:"443",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"ssh-management",name:"SSH Management",description:"Allow SSH access from management network",category:"management",input:{name:"Allow-SSH-Management",description:"Allow SSH from management subnet",sourceIp:"10.0.0.0/8",destinationIp:"",port:"22",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"database-mysql",name:"MySQL Database",description:"Allow MySQL connections from application tier",category:"database",input:{name:"Allow-MySQL-AppTier",description:"Allow MySQL from application servers",sourceIp:"10.1.0.0/16",destinationIp:"",port:"3306",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"database-postgres",name:"PostgreSQL Database",description:"Allow PostgreSQL connections from application tier",category:"database",input:{name:"Allow-PostgreSQL-AppTier",description:"Allow PostgreSQL from application servers",sourceIp:"10.1.0.0/16",destinationIp:"",port:"5432",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","iptables"]},{id:"rdp-management",name:"RDP Management",description:"Allow RDP access from management network",category:"management",input:{name:"Allow-RDP-Management",description:"Allow RDP from management subnet",sourceIp:"10.0.0.0/8",destinationIp:"",port:"3389",protocol:"tcp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"deny-all-inbound",name:"Deny All Inbound",description:"Default deny rule for all inbound traffic",category:"security",input:{name:"Deny-All-Inbound",description:"Block all inbound traffic by default",sourceIp:"0.0.0.0/0",destinationIp:"",port:"",protocol:"any",action:"deny",direction:"inbound"},platforms:["azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]},{id:"icmp-ping",name:"Allow ICMP Ping",description:"Allow ICMP echo requests for ping",category:"management",input:{name:"Allow-ICMP-Ping",description:"Allow ICMP for network diagnostics",sourceIp:"10.0.0.0/8",destinationIp:"",port:"",protocol:"icmp",action:"allow",direction:"inbound"},platforms:["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"]}],Jh=[{sg_id:"sg-0f1e2d3c4b5a6001",name:"sg-webapp-prod",vpc:"vpc-prod-us-east-1",description:"Production web application tier"},{sg_id:"sg-0f1e2d3c4b5a6002",name:"sg-database-prod",vpc:"vpc-prod-us-east-1",description:"Production database tier"},{sg_id:"sg-0f1e2d3c4b5a6003",name:"sg-redis-prod",vpc:"vpc-prod-us-east-1",description:"Production Redis cache cluster"},{sg_id:"sg-0f1e2d3c4b5a6004",name:"sg-api-gateway",vpc:"vpc-prod-us-east-1",description:"API Gateway services"},{sg_id:"sg-0f1e2d3c4b5a6005",name:"sg-microservices",vpc:"vpc-prod-us-east-1",description:"Microservices tier"},{sg_id:"sg-0f1e2d3c4b5a6006",name:"sg-kafka-prod",vpc:"vpc-prod-us-east-1",description:"Kafka message broker cluster"},{sg_id:"sg-0f1e2d3c4b5a6007",name:"sg-analytics-prod",vpc:"vpc-prod-us-east-1",description:"Analytics and data science workloads"},{sg_id:"sg-0f1e2d3c4b5a6008",name:"sg-bastion",vpc:"vpc-prod-us-east-1",description:"Bastion host for SSH access"},{sg_id:"sg-0f1e2d3c4b5a6009",name:"sg-alb-public",vpc:"vpc-prod-us-east-1",description:"Public Application Load Balancer"},{sg_id:"sg-0f1e2d3c4b5a6010",name:"sg-alb-internal",vpc:"vpc-prod-us-east-1",description:"Internal Application Load Balancer"},{sg_id:"sg-0f1e2d3c4b5a6011",name:"sg-monitoring",vpc:"vpc-prod-us-east-1",description:"Monitoring stack (Prometheus/Grafana)"},{sg_id:"sg-0f1e2d3c4b5a6012",name:"sg-eks-nodes",vpc:"vpc-prod-us-east-1",description:"EKS worker nodes"},{sg_id:"sg-0f1e2d3c4b5a6013",name:"sg-eks-control",vpc:"vpc-prod-us-east-1",description:"EKS control plane"},{sg_id:"sg-0f1e2d3c4b5a6014",name:"sg-jenkins",vpc:"vpc-devops-us-east-1",description:"Jenkins CI/CD server"},{sg_id:"sg-0f1e2d3c4b5a6015",name:"sg-splunk",vpc:"vpc-prod-us-east-1",description:"Splunk SIEM cluster"},{sg_id:"sg-0f1e2d3c4b5a6016",name:"sg-vault",vpc:"vpc-prod-us-east-1",description:"HashiCorp Vault cluster"},{sg_id:"sg-0f1e2d3c4b5a6017",name:"sg-elasticsearch",vpc:"vpc-prod-us-east-1",description:"Elasticsearch cluster"},{sg_id:"sg-0f1e2d3c4b5a6018",name:"sg-payment",vpc:"vpc-pci-us-east-1",description:"Payment processing (PCI-DSS)"},{sg_id:"sg-0f1e2d3c4b5a6019",name:"sg-recommendation",vpc:"vpc-prod-us-east-1",description:"ML recommendation engine"},{sg_id:"sg-0f1e2d3c4b5a6020",name:"sg-nat-gateway",vpc:"vpc-prod-us-east-1",description:"NAT Gateway security group"}],eg=[{rule_id:"sgr-0a1b2c3d4e5f0001",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS from Internet via ALB"},{rule_id:"sgr-0a1b2c3d4e5f0002",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"80",source:"0.0.0.0/0",description:"HTTP redirect to HTTPS"},{rule_id:"sgr-0a1b2c3d4e5f0003",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"10.100.0.0/16",description:"SSH from VPN CIDR"},{rule_id:"sgr-0a1b2c3d4e5f0004",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-alb-public",description:"Application port from ALB"},{rule_id:"sgr-0a1b2c3d4e5f0005",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"PostgreSQL to database tier"},{rule_id:"sgr-0a1b2c3d4e5f0006",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache access"},{rule_id:"sgr-0a1b2c3d4e5f0007",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS to external APIs"},{rule_id:"sgr-0a1b2c3d4e5f0008",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka message publishing"},{rule_id:"sgr-0a1b2c3d4e5f0009",security_group:"sg-webapp-prod",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Node exporter metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0010",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Microservices API calls"},{rule_id:"sgr-0a1b2c3d4e5f0011",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-webapp-prod",description:"PostgreSQL from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0012",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-api-gateway",description:"PostgreSQL from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0013",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-microservices",description:"PostgreSQL from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0014",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-analytics-prod",description:"PostgreSQL from analytics"},{rule_id:"sgr-0a1b2c3d4e5f0015",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"10.100.0.0/16",description:"PostgreSQL from VPN for DBA access"},{rule_id:"sgr-0a1b2c3d4e5f0016",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"sg-bastion",description:"SSH from bastion host"},{rule_id:"sgr-0a1b2c3d4e5f0017",security_group:"sg-database-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for backups via prefix list"},{rule_id:"sgr-0a1b2c3d4e5f0018",security_group:"sg-database-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"10.120.0.0/16",description:"Replication to DR region"},{rule_id:"sgr-0a1b2c3d4e5f0019",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Node exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0020",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"9187",source:"sg-monitoring",description:"PostgreSQL exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0021",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-webapp-prod",description:"Redis from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0022",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-api-gateway",description:"Redis from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0023",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-microservices",description:"Redis from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0024",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"6379",source:"sg-recommendation",description:"Redis from recommendation engine"},{rule_id:"sgr-0a1b2c3d4e5f0025",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"16379",source:"sg-redis-prod",description:"Redis cluster bus port"},{rule_id:"sgr-0a1b2c3d4e5f0026",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"26379",source:"sg-redis-prod",description:"Redis Sentinel port"},{rule_id:"sgr-0a1b2c3d4e5f0027",security_group:"sg-redis-prod",type:"Inbound",protocol:"TCP",port_range:"9121",source:"sg-monitoring",description:"Redis exporter metrics"},{rule_id:"sgr-0a1b2c3d4e5f0028",security_group:"sg-redis-prod",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cluster replication"},{rule_id:"sgr-0a1b2c3d4e5f0029",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-alb-public",description:"HTTPS from public ALB"},{rule_id:"sgr-0a1b2c3d4e5f0030",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-alb-internal",description:"HTTPS from internal ALB"},{rule_id:"sgr-0a1b2c3d4e5f0031",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"8443",source:"10.100.0.0/16",description:"API access from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0032",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Route to microservices"},{rule_id:"sgr-0a1b2c3d4e5f0033",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database queries"},{rule_id:"sgr-0a1b2c3d4e5f0034",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache"},{rule_id:"sgr-0a1b2c3d4e5f0035",security_group:"sg-api-gateway",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka event publishing"},{rule_id:"sgr-0a1b2c3d4e5f0036",security_group:"sg-api-gateway",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Prometheus metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0037",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-api-gateway",description:"API gateway requests"},{rule_id:"sgr-0a1b2c3d4e5f0038",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"Inter-service communication"},{rule_id:"sgr-0a1b2c3d4e5f0039",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"Web tier service calls"},{rule_id:"sgr-0a1b2c3d4e5f0040",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database access"},{rule_id:"sgr-0a1b2c3d4e5f0041",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Redis cache access"},{rule_id:"sgr-0a1b2c3d4e5f0042",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka messaging"},{rule_id:"sgr-0a1b2c3d4e5f0043",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"External HTTPS APIs"},{rule_id:"sgr-0a1b2c3d4e5f0044",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"9200",source:"sg-elasticsearch",description:"Elasticsearch logging"},{rule_id:"sgr-0a1b2c3d4e5f0045",security_group:"sg-microservices",type:"Outbound",protocol:"TCP",port_range:"8200",source:"sg-vault",description:"Vault secrets retrieval"},{rule_id:"sgr-0a1b2c3d4e5f0046",security_group:"sg-microservices",type:"Inbound",protocol:"TCP",port_range:"9100",source:"sg-monitoring",description:"Prometheus metrics"},{rule_id:"sgr-0a1b2c3d4e5f0047",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-webapp-prod",description:"Kafka from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0048",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-api-gateway",description:"Kafka from API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0049",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-microservices",description:"Kafka from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0050",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9092",source:"sg-analytics-prod",description:"Kafka from analytics"},{rule_id:"sgr-0a1b2c3d4e5f0051",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9093",source:"sg-kafka-prod",description:"Kafka inter-broker SSL"},{rule_id:"sgr-0a1b2c3d4e5f0052",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"2181",source:"sg-kafka-prod",description:"Zookeeper client port"},{rule_id:"sgr-0a1b2c3d4e5f0053",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"2888",source:"sg-kafka-prod",description:"Zookeeper peer port"},{rule_id:"sgr-0a1b2c3d4e5f0054",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"3888",source:"sg-kafka-prod",description:"Zookeeper leader election"},{rule_id:"sgr-0a1b2c3d4e5f0055",security_group:"sg-kafka-prod",type:"Inbound",protocol:"TCP",port_range:"9999",source:"sg-monitoring",description:"JMX metrics for Kafka"},{rule_id:"sgr-0a1b2c3d4e5f0056",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"8888",source:"10.100.0.0/16",description:"Jupyter notebook from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0057",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"4040",source:"10.100.0.0/16",description:"Spark UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0058",security_group:"sg-analytics-prod",type:"Inbound",protocol:"TCP",port_range:"22",source:"sg-bastion",description:"SSH from bastion"},{rule_id:"sgr-0a1b2c3d4e5f0059",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Database queries"},{rule_id:"sgr-0a1b2c3d4e5f0060",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"9092",source:"sg-kafka-prod",description:"Kafka streaming"},{rule_id:"sgr-0a1b2c3d4e5f0061",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 data lake access"},{rule_id:"sgr-0a1b2c3d4e5f0062",security_group:"sg-analytics-prod",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"External ML APIs"},{rule_id:"sgr-0a1b2c3d4e5f0063",security_group:"sg-bastion",type:"Inbound",protocol:"TCP",port_range:"22",source:"10.100.0.0/16",description:"SSH from VPN only"},{rule_id:"sgr-0a1b2c3d4e5f0064",security_group:"sg-bastion",type:"Outbound",protocol:"TCP",port_range:"22",source:"10.0.0.0/8",description:"SSH to all internal hosts"},{rule_id:"sgr-0a1b2c3d4e5f0065",security_group:"sg-bastion",type:"Outbound",protocol:"TCP",port_range:"3389",source:"10.0.0.0/8",description:"RDP to Windows hosts"},{rule_id:"sgr-0a1b2c3d4e5f0066",security_group:"sg-alb-public",type:"Inbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"HTTPS from Internet"},{rule_id:"sgr-0a1b2c3d4e5f0067",security_group:"sg-alb-public",type:"Inbound",protocol:"TCP",port_range:"80",source:"0.0.0.0/0",description:"HTTP redirect"},{rule_id:"sgr-0a1b2c3d4e5f0068",security_group:"sg-alb-public",type:"Outbound",protocol:"TCP",port_range:"443",source:"sg-api-gateway",description:"To API gateway"},{rule_id:"sgr-0a1b2c3d4e5f0069",security_group:"sg-alb-public",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"To web application"},{rule_id:"sgr-0a1b2c3d4e5f0070",security_group:"sg-alb-internal",type:"Inbound",protocol:"TCP",port_range:"443",source:"10.0.0.0/8",description:"HTTPS from internal"},{rule_id:"sgr-0a1b2c3d4e5f0071",security_group:"sg-alb-internal",type:"Outbound",protocol:"TCP",port_range:"8080",source:"sg-microservices",description:"To microservices"},{rule_id:"sgr-0a1b2c3d4e5f0072",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"9090",source:"10.100.0.0/16",description:"Prometheus UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0073",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"3000",source:"10.100.0.0/16",description:"Grafana from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0074",security_group:"sg-monitoring",type:"Inbound",protocol:"TCP",port_range:"9093",source:"10.100.0.0/16",description:"Alertmanager from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0075",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"9100",source:"10.0.0.0/8",description:"Node exporter scrape all"},{rule_id:"sgr-0a1b2c3d4e5f0076",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"9090",source:"10.0.0.0/8",description:"Application metrics scrape"},{rule_id:"sgr-0a1b2c3d4e5f0077",security_group:"sg-monitoring",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"PagerDuty/Slack alerts"},{rule_id:"sgr-0a1b2c3d4e5f0078",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-eks-control",description:"Kubelet API from control plane"},{rule_id:"sgr-0a1b2c3d4e5f0079",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"10250",source:"sg-eks-control",description:"Kubelet from control plane"},{rule_id:"sgr-0a1b2c3d4e5f0080",security_group:"sg-eks-nodes",type:"Inbound",protocol:"ALL",port_range:"ALL",source:"sg-eks-nodes",description:"Node to node all traffic"},{rule_id:"sgr-0a1b2c3d4e5f0081",security_group:"sg-eks-nodes",type:"Inbound",protocol:"TCP",port_range:"30000-32767",source:"sg-alb-internal",description:"NodePort services from ALB"},{rule_id:"sgr-0a1b2c3d4e5f0082",security_group:"sg-eks-nodes",type:"Outbound",protocol:"ALL",port_range:"ALL",source:"0.0.0.0/0",description:"All outbound for pods"},{rule_id:"sgr-0a1b2c3d4e5f0083",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"10.100.0.0/16",description:"Kubernetes API from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0084",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-eks-nodes",description:"Kubernetes API from nodes"},{rule_id:"sgr-0a1b2c3d4e5f0085",security_group:"sg-eks-control",type:"Inbound",protocol:"TCP",port_range:"443",source:"sg-jenkins",description:"Kubernetes API from CI/CD"},{rule_id:"sgr-0a1b2c3d4e5f0086",security_group:"sg-jenkins",type:"Inbound",protocol:"TCP",port_range:"8080",source:"10.100.0.0/16",description:"Jenkins UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0087",security_group:"sg-jenkins",type:"Inbound",protocol:"TCP",port_range:"50000",source:"10.80.0.0/16",description:"Jenkins agent connection"},{rule_id:"sgr-0a1b2c3d4e5f0088",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"22",source:"10.0.0.0/8",description:"SSH to build agents"},{rule_id:"sgr-0a1b2c3d4e5f0089",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"Git and registry access"},{rule_id:"sgr-0a1b2c3d4e5f0090",security_group:"sg-jenkins",type:"Outbound",protocol:"TCP",port_range:"443",source:"sg-eks-control",description:"Kubernetes deployment"},{rule_id:"sgr-0a1b2c3d4e5f0091",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"9997",source:"10.0.0.0/8",description:"Log forwarding from all"},{rule_id:"sgr-0a1b2c3d4e5f0092",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"8000",source:"10.100.0.0/16",description:"Splunk Web from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0093",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"8089",source:"10.90.0.0/16",description:"Splunk API from monitoring"},{rule_id:"sgr-0a1b2c3d4e5f0094",security_group:"sg-splunk",type:"Inbound",protocol:"UDP",port_range:"514",source:"10.0.0.0/8",description:"Syslog UDP from all"},{rule_id:"sgr-0a1b2c3d4e5f0095",security_group:"sg-splunk",type:"Inbound",protocol:"TCP",port_range:"514",source:"10.0.0.0/8",description:"Syslog TCP from all"},{rule_id:"sgr-0a1b2c3d4e5f0096",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.30.0.0/16",description:"Vault API from applications"},{rule_id:"sgr-0a1b2c3d4e5f0097",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.80.0.0/16",description:"Vault API from CI/CD"},{rule_id:"sgr-0a1b2c3d4e5f0098",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8200",source:"10.100.0.0/16",description:"Vault UI from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0099",security_group:"sg-vault",type:"Inbound",protocol:"TCP",port_range:"8201",source:"sg-vault",description:"Vault cluster port"},{rule_id:"sgr-0a1b2c3d4e5f0100",security_group:"sg-vault",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-68a54001",description:"DynamoDB for storage backend"},{rule_id:"sgr-0a1b2c3d4e5f0101",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"sg-microservices",description:"ES API from microservices"},{rule_id:"sgr-0a1b2c3d4e5f0102",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"sg-splunk",description:"ES API from Splunk"},{rule_id:"sgr-0a1b2c3d4e5f0103",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9200",source:"10.100.0.0/16",description:"Kibana from VPN"},{rule_id:"sgr-0a1b2c3d4e5f0104",security_group:"sg-elasticsearch",type:"Inbound",protocol:"TCP",port_range:"9300",source:"sg-elasticsearch",description:"ES cluster transport"},{rule_id:"sgr-0a1b2c3d4e5f0105",security_group:"sg-elasticsearch",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for snapshots"},{rule_id:"sgr-0a1b2c3d4e5f0106",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"8443",source:"sg-api-gateway",description:"Payment API from gateway"},{rule_id:"sgr-0a1b2c3d4e5f0107",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"443",source:"203.0.113.0/24",description:"Stripe webhooks"},{rule_id:"sgr-0a1b2c3d4e5f0108",security_group:"sg-payment",type:"Inbound",protocol:"TCP",port_range:"443",source:"199.16.156.0/24",description:"PayPal webhooks"},{rule_id:"sgr-0a1b2c3d4e5f0109",security_group:"sg-payment",type:"Outbound",protocol:"TCP",port_range:"443",source:"0.0.0.0/0",description:"Payment provider APIs"},{rule_id:"sgr-0a1b2c3d4e5f0110",security_group:"sg-payment",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"Transaction database"},{rule_id:"sgr-0a1b2c3d4e5f0111",security_group:"sg-recommendation",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-api-gateway",description:"ML API from gateway"},{rule_id:"sgr-0a1b2c3d4e5f0112",security_group:"sg-recommendation",type:"Inbound",protocol:"TCP",port_range:"8080",source:"sg-webapp-prod",description:"ML API from web tier"},{rule_id:"sgr-0a1b2c3d4e5f0113",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"5432",source:"sg-database-prod",description:"User profiles database"},{rule_id:"sgr-0a1b2c3d4e5f0114",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"6379",source:"sg-redis-prod",description:"Feature caching"},{rule_id:"sgr-0a1b2c3d4e5f0115",security_group:"sg-recommendation",type:"Outbound",protocol:"TCP",port_range:"443",source:"pl-63a5400a",description:"S3 for model artifacts"},{rule_id:"sgr-0a1b2c3d4e5f0116",security_group:"sg-nat-gateway",type:"Inbound",protocol:"ALL",port_range:"ALL",source:"10.0.0.0/8",description:"NAT from private subnets"},{rule_id:"sgr-0a1b2c3d4e5f0117",security_group:"sg-nat-gateway",type:"Outbound",protocol:"ALL",port_range:"ALL",source:"0.0.0.0/0",description:"NAT to Internet"},{rule_id:"sgr-0a1b2c3d4e5f0118",security_group:"sg-webapp-prod",type:"Outbound",protocol:"TCP",port_range:"9997",source:"sg-splunk",description:"Log forwarding to Splunk"},{rule_id:"sgr-0a1b2c3d4e5f0119",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-recommendation",description:"PostgreSQL from recommendation"},{rule_id:"sgr-0a1b2c3d4e5f0120",security_group:"sg-database-prod",type:"Inbound",protocol:"TCP",port_range:"5432",source:"sg-payment",description:"PostgreSQL from payment service"}],ga={security_groups:Jh,rules:eg},tg=[{nsg_id:"nsg-webapp-prod",name:"nsg-webapp-prod",resource_group:"rg-production-eastus",location:"eastus",description:"Production web application NSG"},{nsg_id:"nsg-database-prod",name:"nsg-database-prod",resource_group:"rg-production-eastus",location:"eastus",description:"Production database NSG"},{nsg_id:"nsg-api-prod",name:"nsg-api-prod",resource_group:"rg-production-eastus",location:"eastus",description:"API tier NSG"},{nsg_id:"nsg-aks-nodes",name:"nsg-aks-nodes",resource_group:"rg-aks-eastus",location:"eastus",description:"AKS worker nodes NSG"},{nsg_id:"nsg-management",name:"nsg-management",resource_group:"rg-management",location:"eastus",description:"Management subnet NSG"},{nsg_id:"nsg-dmz",name:"nsg-dmz",resource_group:"rg-production-eastus",location:"eastus",description:"DMZ subnet NSG"}],sg=[{rule_name:"Allow-HTTPS-Internet-Inbound",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"443"},{rule_name:"Allow-HTTP-Redirect-Inbound",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"80"},{rule_name:"Allow-AppGW-to-WebApp",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"GatewaySubnet",destination_asg:"asg-webapp",port:"8080"},{rule_name:"Allow-WebApp-to-API",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-api",port:"8080"},{rule_name:"Allow-API-Internal-Comm",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-api",port:"8080"},{rule_name:"Allow-WebApp-to-SQL",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-API-to-SQL",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-Analytics-to-SQL",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-Jenkins-to-SQL",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-jenkins",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-VPN-to-SQL",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-database",port:"1433"},{rule_name:"Allow-WebApp-to-Redis",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-redis",port:"6379"},{rule_name:"Allow-API-to-Redis",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-redis",port:"6379"},{rule_name:"Allow-Redis-Cluster-Internal",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"16379"},{rule_name:"Allow-Redis-Sentinel",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"26379"},{rule_name:"Allow-WebApp-to-Kafka",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-API-to-Kafka",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-Analytics-to-Kafka",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"asg-kafka",port:"9092"},{rule_name:"Allow-Kafka-Inter-Broker",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"9093"},{rule_name:"Allow-Kafka-Zookeeper",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"2181"},{rule_name:"Allow-Kafka-ZK-Peer",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-kafka",destination_asg:"asg-kafka",port:"2888"},{rule_name:"Allow-Prometheus-Scrape-All",priority:200,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"*",port:"9090"},{rule_name:"Allow-NodeExporter-Scrape",priority:210,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"*",port:"9100"},{rule_name:"Allow-Grafana-VPN",priority:220,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"3000"},{rule_name:"Allow-Prometheus-VPN",priority:230,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"9090"},{rule_name:"Allow-Alertmanager-VPN",priority:240,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-monitoring",port:"9093"},{rule_name:"Allow-AKS-NodePort-Range",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-appgw",destination_asg:"asg-aks-nodes",port:"30000-32767"},{rule_name:"Allow-AKS-Kubelet",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureKubernetes",destination_asg:"asg-aks-nodes",port:"10250"},{rule_name:"Allow-AKS-DNS",priority:120,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"asg-aks-nodes",destination_asg:"asg-aks-nodes",port:"53"},{rule_name:"Allow-AKS-Node-Internal",priority:130,direction:"Inbound",access:"Allow",protocol:"*",source_asg:"asg-aks-nodes",destination_asg:"asg-aks-nodes",port:"*"},{rule_name:"Allow-AKS-Metrics",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-monitoring",destination_asg:"asg-aks-nodes",port:"10255"},{rule_name:"Allow-Bastion-SSH-All",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureBastionSubnet",destination_asg:"*",port:"22"},{rule_name:"Allow-Bastion-RDP-All",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureBastionSubnet",destination_asg:"*",port:"3389"},{rule_name:"Allow-VPN-SSH",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"*",port:"22"},{rule_name:"Allow-Jenkins-VPN",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-jenkins",port:"8080"},{rule_name:"Allow-Jenkins-Agent",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.80.0.0/16",destination_asg:"asg-jenkins",port:"50000"},{rule_name:"Allow-ES-from-API",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-elasticsearch",port:"9200"},{rule_name:"Allow-ES-from-WebApp",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-elasticsearch",port:"9200"},{rule_name:"Allow-ES-Cluster-Transport",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-elasticsearch",destination_asg:"asg-elasticsearch",port:"9300"},{rule_name:"Allow-Kibana-VPN",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-elasticsearch",port:"5601"},{rule_name:"Allow-CosmosDB-Access",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"AzureCosmosDB",port:"443"},{rule_name:"Allow-Storage-Access",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"Storage",port:"443"},{rule_name:"Allow-KeyVault-Access",priority:120,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureKeyVault",port:"443"},{rule_name:"Allow-EventHub-Access",priority:130,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"EventHub",port:"5671"},{rule_name:"Allow-ServiceBus-Access",priority:140,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"ServiceBus",port:"5671"},{rule_name:"Allow-AzureMonitor-Outbound",priority:150,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureMonitor",port:"443"},{rule_name:"Allow-AzureAD-Outbound",priority:160,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureActiveDirectory",port:"443"},{rule_name:"Allow-ACR-Outbound",priority:170,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-aks-nodes",destination_asg:"AzureContainerRegistry",port:"443"},{rule_name:"Deny-Internet-DB-Outbound",priority:4e3,direction:"Outbound",access:"Deny",protocol:"*",source_asg:"asg-database",destination_asg:"Internet",port:"*"},{rule_name:"Allow-LB-Health-Probe",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureLoadBalancer",destination_asg:"*",port:"*"},{rule_name:"Allow-FrontDoor-to-AppGW",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureFrontDoor.Backend",destination_asg:"asg-appgw",port:"443"},{rule_name:"Allow-VNet-Internal",priority:65e3,direction:"Inbound",access:"Allow",protocol:"*",source_asg:"VirtualNetwork",destination_asg:"VirtualNetwork",port:"*"},{rule_name:"Allow-PostgreSQL-Flexible",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"5432"},{rule_name:"Allow-MySQL-Flexible",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"3306"},{rule_name:"Allow-Synapse-Analytics",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"Sql",port:"1433"},{rule_name:"Allow-DataFactory-Integration",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"DataFactory",port:"443"},{rule_name:"Deny-All-Inbound-Default",priority:65500,direction:"Inbound",access:"Deny",protocol:"*",source_asg:"*",destination_asg:"*",port:"*"},{rule_name:"Allow-Analytics-Jupyter",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-analytics",port:"8888"},{rule_name:"Allow-Analytics-Spark-UI",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"10.100.0.0/16",destination_asg:"asg-analytics",port:"4040"},{rule_name:"Allow-Analytics-to-Storage",priority:120,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-analytics",destination_asg:"Storage.EastUS",port:"443"},{rule_name:"Allow-WebApp-HTTPS-Out",priority:100,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"Internet",port:"443"},{rule_name:"Allow-API-HTTPS-Out",priority:110,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"Internet",port:"443"},{rule_name:"Allow-NTP-Outbound",priority:200,direction:"Outbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"*",port:"123"},{rule_name:"Allow-DNS-Outbound",priority:210,direction:"Outbound",access:"Allow",protocol:"*",source_asg:"*",destination_asg:"*",port:"53"},{rule_name:"Allow-SMTP-Outbound",priority:300,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"*",port:"587"},{rule_name:"Allow-SignalR-WebSocket",priority:160,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-webapp",port:"443"},{rule_name:"Allow-AppInsights-Outbound",priority:180,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"ApplicationInsightsAvailability",port:"443"},{rule_name:"Allow-Redis-Enterprise-Sync",priority:140,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-redis",destination_asg:"asg-redis",port:"8443"},{rule_name:"Allow-SQL-Managed-Instance",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"asg-database",port:"11000-11999"},{rule_name:"Allow-SFTP-Partner-Access",priority:170,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"198.51.100.0/24",destination_asg:"asg-webapp",port:"22"},{rule_name:"Allow-VPN-Gateway-IKE",priority:100,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"GatewaySubnet",port:"500"},{rule_name:"Allow-VPN-Gateway-NAT-T",priority:110,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"*",destination_asg:"GatewaySubnet",port:"4500"},{rule_name:"Allow-ExpressRoute-BGP",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"GatewaySubnet",destination_asg:"GatewaySubnet",port:"179"},{rule_name:"Allow-APIM-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"ApiManagement",destination_asg:"asg-api",port:"3443"},{rule_name:"Allow-APIM-Gateway",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"asg-api",port:"443"},{rule_name:"Allow-ServiceFabric-Cluster",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-webapp",port:"19000-19080"},{rule_name:"Allow-AKS-Tunnel-Front",priority:150,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"9000"},{rule_name:"Allow-AKS-Tunnel-TCP",priority:160,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"1194"},{rule_name:"Allow-AKS-Tunnel-UDP",priority:170,direction:"Inbound",access:"Allow",protocol:"Udp",source_asg:"AzureCloud",destination_asg:"asg-aks-nodes",port:"1194"},{rule_name:"Allow-HDInsight-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"HDInsight",destination_asg:"asg-analytics",port:"443"},{rule_name:"Allow-Databricks-Control",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureDatabricks",destination_asg:"asg-analytics",port:"443"},{rule_name:"Allow-ML-Studio-Compute",priority:120,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AzureMachineLearning",destination_asg:"asg-analytics",port:"44224"},{rule_name:"Allow-Batch-NodeMgmt",priority:130,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"BatchNodeManagement",destination_asg:"asg-analytics",port:"29876-29877"},{rule_name:"Allow-LogAnalytics-Agent",priority:200,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureMonitor",port:"443"},{rule_name:"Allow-ASE-Management",priority:100,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"AppServiceManagement",destination_asg:"asg-webapp",port:"454-455"},{rule_name:"Allow-ASE-Internal-LB",priority:110,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-webapp",destination_asg:"asg-webapp",port:"16001"},{rule_name:"Deny-SQL-Internet-Inbound",priority:4090,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"asg-database",port:"1433"},{rule_name:"Deny-SSH-Internet-Inbound",priority:4091,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"*",port:"22"},{rule_name:"Deny-RDP-Internet-Inbound",priority:4092,direction:"Inbound",access:"Deny",protocol:"Tcp",source_asg:"Internet",destination_asg:"*",port:"3389"},{rule_name:"Allow-Private-Endpoint-SQL",priority:200,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"asg-api",destination_asg:"PrivateEndpoints",port:"1433"},{rule_name:"Allow-Private-Endpoint-Storage",priority:210,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"PrivateEndpoints",port:"443"},{rule_name:"Allow-Private-Endpoint-KV",priority:220,direction:"Inbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"PrivateEndpoints",port:"443"},{rule_name:"Allow-Defender-Communication",priority:190,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureSecurityCenter",port:"443"},{rule_name:"Allow-Update-Management",priority:195,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureUpdateDelivery",port:"443"},{rule_name:"Allow-Guest-Config",priority:196,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"GuestAndHybridManagement",port:"443"},{rule_name:"Allow-ServiceTags-AzureCloud",priority:3900,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureCloud",port:"443"},{rule_name:"Allow-Backup-to-RSV",priority:180,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureBackup",port:"443"},{rule_name:"Allow-ASR-Replication",priority:185,direction:"Outbound",access:"Allow",protocol:"Tcp",source_asg:"*",destination_asg:"AzureSiteRecovery",port:"443"},{rule_name:"Deny-All-Outbound-Default",priority:65500,direction:"Outbound",access:"Deny",protocol:"*",source_asg:"*",destination_asg:"*",port:"*"}],Xt={network_security_groups:tg,rules:sg},ag=[{network_id:"vpc-production",name:"vpc-production",project:"company-prod-12345",description:"Production VPC network"},{network_id:"vpc-staging",name:"vpc-staging",project:"company-staging-12345",description:"Staging VPC network"},{network_id:"vpc-development",name:"vpc-development",project:"company-dev-12345",description:"Development VPC network"},{network_id:"vpc-shared-services",name:"vpc-shared-services",project:"company-shared-12345",description:"Shared services VPC"},{network_id:"vpc-data-analytics",name:"vpc-data-analytics",project:"company-analytics-12345",description:"Data analytics VPC"}],rg=[{rule_name:"allow-https-ingress",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["web-server"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-http-ingress",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["web-server"],protocols:"tcp:80",logging:"Enabled"},{rule_name:"allow-ssh-iap",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:["allow-ssh"],protocols:"tcp:22",logging:"Enabled"},{rule_name:"allow-ssh-vpn",network:"vpc-production",priority:1010,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["allow-ssh"],protocols:"tcp:22",logging:"Enabled"},{rule_name:"allow-rdp-iap",network:"vpc-production",priority:1020,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:["allow-ssh"],protocols:"tcp:3389",logging:"Enabled"},{rule_name:"allow-db-from-app-postgres",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432",logging:"Enabled"},{rule_name:"allow-db-from-app-mysql",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-web",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-analytics",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-db-from-vpn",network:"vpc-production",priority:1004,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["database-server"],protocols:"tcp:5432,tcp:3306",logging:"Enabled"},{rule_name:"allow-redis-from-app",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-redis-from-web",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-redis-cluster-bus",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["redis-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:16379",logging:"Disabled"},{rule_name:"allow-redis-sentinel",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:["redis-server"],source_ranges:[],target_tags:["redis-server"],protocols:"tcp:26379",logging:"Disabled"},{rule_name:"allow-internal-all",network:"vpc-production",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"deny-all-ingress",network:"vpc-production",priority:65535,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-gke-master-to-nodes-https",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["172.16.0.0/28"],target_tags:["gke-node"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-gke-master-to-nodes-kubelet",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["172.16.0.0/28"],target_tags:["gke-node"],protocols:"tcp:10250",logging:"Enabled"},{rule_name:"allow-gke-node-to-node",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"all",logging:"Disabled"},{rule_name:"allow-gke-node-to-pods",network:"vpc-production",priority:1010,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-health-check-tcp",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.191.0.0/16","130.211.0.0/22"],target_tags:["allow-health-check"],protocols:"tcp",logging:"Enabled"},{rule_name:"allow-health-check-ssl",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.191.0.0/16","130.211.0.0/22"],target_tags:["allow-health-check"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-lb-to-backend-http",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:80",logging:"Enabled"},{rule_name:"allow-lb-to-backend-https",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-lb-to-backend-8080",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["130.211.0.0/22","35.191.0.0/16"],target_tags:["backend-service"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-kafka-producer",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server","web-server"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9092",logging:"Enabled"},{rule_name:"allow-kafka-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["kafka-broker"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9092,tcp:9093",logging:"Disabled"},{rule_name:"allow-kafka-jmx",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:["kafka-broker"],protocols:"tcp:9999",logging:"Disabled"},{rule_name:"allow-zookeeper-client",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["kafka-broker"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:2181",logging:"Enabled"},{rule_name:"allow-zookeeper-peer",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["zookeeper"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:2888",logging:"Disabled"},{rule_name:"allow-zookeeper-election",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["zookeeper"],source_ranges:[],target_tags:["zookeeper"],protocols:"tcp:3888",logging:"Disabled"},{rule_name:"allow-prometheus-scrape-9090",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:[],protocols:"tcp:9090",logging:"Disabled"},{rule_name:"allow-prometheus-scrape-9100",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:[],protocols:"tcp:9100",logging:"Disabled"},{rule_name:"allow-grafana-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["monitoring"],protocols:"tcp:3000",logging:"Enabled"},{rule_name:"allow-alertmanager-vpn",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["monitoring"],protocols:"tcp:9093",logging:"Enabled"},{rule_name:"allow-elasticsearch-api",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["log-shipper","app-server"],source_ranges:[],target_tags:["elasticsearch"],protocols:"tcp:9200",logging:"Enabled"},{rule_name:"allow-elasticsearch-cluster",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["elasticsearch"],source_ranges:[],target_tags:["elasticsearch"],protocols:"tcp:9300",logging:"Disabled"},{rule_name:"allow-kibana-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["elasticsearch"],protocols:"tcp:5601",logging:"Enabled"},{rule_name:"allow-vault-api",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["app-server","web-server","jenkins"],source_ranges:[],target_tags:["vault-server"],protocols:"tcp:8200",logging:"Enabled"},{rule_name:"allow-vault-cluster",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["vault-server"],source_ranges:[],target_tags:["vault-server"],protocols:"tcp:8201",logging:"Disabled"},{rule_name:"allow-vault-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["vault-server"],protocols:"tcp:8200",logging:"Enabled"},{rule_name:"allow-jenkins-vpn",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["jenkins"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-jenkins-agent",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.80.0.0/16"],target_tags:["jenkins"],protocols:"tcp:50000",logging:"Enabled"},{rule_name:"allow-cloud-sql-proxy",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:3307",logging:"Enabled"},{rule_name:"allow-memorystore-redis",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:6379",logging:"Enabled"},{rule_name:"allow-pubsub-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["pubsub-client"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-bigquery-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-cloud-storage",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-monitoring-agent",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-analytics-jupyter",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8888",logging:"Enabled"},{rule_name:"allow-analytics-spark",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:4040",logging:"Enabled"},{rule_name:"allow-analytics-airflow",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"deny-egress-internet",network:"vpc-production",priority:65535,direction:"EGRESS",action:"deny",source_tags:[],source_ranges:[],target_tags:["no-internet"],protocols:"all",logging:"Enabled"},{rule_name:"allow-nat-egress",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["needs-nat"],source_ranges:[],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"allow-cloud-functions-vpc",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.8.0.0/28"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-cloud-run-vpc",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.8.0.16/28"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-gke-ingress-nginx",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:["gke-node"],protocols:"tcp:80,tcp:443",logging:"Enabled"},{rule_name:"allow-ml-training-gpu",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["ml-training"],protocols:"tcp:6006,tcp:8888",logging:"Enabled"},{rule_name:"allow-ml-training-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["ml-training"],source_ranges:[],target_tags:["ml-training"],protocols:"all",logging:"Disabled"},{rule_name:"allow-dataflow-worker",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:["analytics-server"],protocols:"tcp:12345-12346",logging:"Enabled"},{rule_name:"allow-dataproc-master",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8088,tcp:9870,tcp:8080",logging:"Enabled"},{rule_name:"allow-dataproc-worker",network:"vpc-data-analytics",priority:1001,direction:"INGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:["analytics-server"],protocols:"all",logging:"Disabled"},{rule_name:"allow-composer-airflow",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["analytics-server"],protocols:"tcp:8080,tcp:3306,tcp:6379",logging:"Enabled"},{rule_name:"allow-bigtable-api",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-spanner-api",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-firestore-api",network:"vpc-production",priority:1002,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-artifact-registry",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["gke-node","jenkins"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-gcr-io",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["gke-node","jenkins"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-web-to-app",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["web-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-app-internal",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-grpc-internal",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:50051",logging:"Enabled"},{rule_name:"allow-envoy-admin",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["monitoring"],source_ranges:[],target_tags:["app-server"],protocols:"tcp:15000",logging:"Disabled"},{rule_name:"allow-istio-pilot",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"tcp:15010,tcp:15012",logging:"Enabled"},{rule_name:"allow-istio-telemetry",network:"vpc-production",priority:1001,direction:"INGRESS",action:"allow",source_tags:["gke-node"],source_ranges:[],target_tags:["gke-node"],protocols:"tcp:15014",logging:"Disabled"},{rule_name:"allow-kiali-vpn",network:"vpc-production",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["gke-node"],protocols:"tcp:20001",logging:"Enabled"},{rule_name:"allow-jaeger-vpn",network:"vpc-production",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["gke-node"],protocols:"tcp:16686",logging:"Enabled"},{rule_name:"deny-ssh-public",network:"vpc-production",priority:2e3,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:22",logging:"Enabled"},{rule_name:"deny-rdp-public",network:"vpc-production",priority:2001,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:3389",logging:"Enabled"},{rule_name:"deny-mysql-public",network:"vpc-production",priority:2002,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:3306",logging:"Enabled"},{rule_name:"deny-postgres-public",network:"vpc-production",priority:2003,direction:"INGRESS",action:"deny",source_tags:[],source_ranges:["0.0.0.0/0"],target_tags:[],protocols:"tcp:5432",logging:"Enabled"},{rule_name:"allow-vpn-tunnel",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["198.51.100.0/24"],target_tags:[],protocols:"udp:500,udp:4500,esp",logging:"Enabled"},{rule_name:"allow-cloud-dns-forwarding",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.199.192.0/19"],target_tags:[],protocols:"tcp:53,udp:53",logging:"Enabled"},{rule_name:"allow-private-google-access",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-iap-forwarding",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["35.235.240.0/20"],target_tags:[],protocols:"tcp:22,tcp:3389",logging:"Enabled"},{rule_name:"allow-interconnect-attachment",network:"vpc-production",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"allow-stackdriver-agent",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:[],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Disabled"},{rule_name:"allow-secret-manager",network:"vpc-production",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"allow-kms-api",network:"vpc-production",priority:1001,direction:"EGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"},{rule_name:"staging-allow-https",network:"vpc-staging",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:["web-server"],protocols:"tcp:443",logging:"Enabled"},{rule_name:"staging-allow-all-internal",network:"vpc-staging",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"dev-allow-all-vpn",network:"vpc-development",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.100.0.0/16"],target_tags:[],protocols:"all",logging:"Enabled"},{rule_name:"dev-allow-all-internal",network:"vpc-development",priority:65534,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"all",logging:"Disabled"},{rule_name:"shared-allow-dns",network:"vpc-shared-services",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:53,udp:53",logging:"Enabled"},{rule_name:"shared-allow-ntp",network:"vpc-shared-services",priority:1001,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"udp:123",logging:"Disabled"},{rule_name:"shared-allow-ldap",network:"vpc-shared-services",priority:1002,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:389,tcp:636",logging:"Enabled"},{rule_name:"shared-allow-smtp",network:"vpc-shared-services",priority:1003,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.0.0.0/8"],target_tags:[],protocols:"tcp:25,tcp:587",logging:"Enabled"},{rule_name:"allow-vertex-ai-training",network:"vpc-data-analytics",priority:1e3,direction:"INGRESS",action:"allow",source_tags:[],source_ranges:["10.128.0.0/9"],target_tags:["ml-training"],protocols:"tcp:2222,tcp:6006",logging:"Enabled"},{rule_name:"allow-vertex-ai-prediction",network:"vpc-data-analytics",priority:1001,direction:"INGRESS",action:"allow",source_tags:["app-server"],source_ranges:[],target_tags:["ml-training"],protocols:"tcp:8080",logging:"Enabled"},{rule_name:"allow-notebooks-api",network:"vpc-data-analytics",priority:1e3,direction:"EGRESS",action:"allow",source_tags:["analytics-server"],source_ranges:[],target_tags:[],protocols:"tcp:443",logging:"Enabled"}],Hs={networks:ag,rules:rg},ng=()=>{const e=new Map;ga.security_groups.forEach(a=>e.set(a.name,a));const s=new Map;return ga.rules.forEach(a=>{s.has(a.security_group)||s.set(a.security_group,{inbound:[],outbound:[]});const r=s.get(a.security_group);a.type==="Inbound"?r.inbound.push(a):r.outbound.push(a)}),ga.security_groups.map(a=>{var r,n;return{id:a.sg_id,name:a.name,description:a.description,vpcId:a.vpc,vpcName:a.vpc,provider:"aws",inboundRules:(((r=s.get(a.name))==null?void 0:r.inbound)||[]).map(o=>({id:o.rule_id,protocol:o.protocol.toLowerCase(),portRange:o.port_range,source:o.source,description:o.description})),outboundRules:(((n=s.get(a.name))==null?void 0:n.outbound)||[]).map(o=>({id:o.rule_id,protocol:o.protocol.toLowerCase(),portRange:o.port_range,source:o.source,description:o.description}))}})},og=()=>{const e=new Map;return Xt.rules.forEach(s=>{const a=s.destination_asg||"default";e.has(a)||e.set(a,{inbound:[],outbound:[]});const r=e.get(a);s.direction==="Inbound"?r.inbound.push(s):r.outbound.push(s)}),Xt.network_security_groups.map(s=>({id:s.nsg_id,name:s.name,description:s.description,vpcId:s.resource_group,vpcName:s.resource_group,provider:"azure",inboundRules:Xt.rules.filter(a=>a.direction==="Inbound").slice(0,10).map((a,r)=>({id:`${s.nsg_id}-in-${r}`,protocol:a.protocol.toLowerCase(),portRange:String(a.port),source:a.source_asg,description:a.rule_name})),outboundRules:Xt.rules.filter(a=>a.direction==="Outbound").slice(0,5).map((a,r)=>({id:`${s.nsg_id}-out-${r}`,protocol:a.protocol.toLowerCase(),portRange:String(a.port),source:a.destination_asg,description:a.rule_name}))}))},ig=()=>{const e=new Map;return Hs.rules.forEach(s=>{e.has(s.network)||e.set(s.network,[]),e.get(s.network).push(s)}),Hs.networks.map(s=>{const a=e.get(s.name)||[];return{id:s.network_id,name:s.name,description:s.description,vpcId:s.project,vpcName:s.project,provider:"gcp",inboundRules:a.filter(r=>r.direction==="INGRESS").slice(0,10).map((r,n)=>{var o,i;return{id:`${s.network_id}-in-${n}`,protocol:r.protocols.split(":")[0]||"tcp",portRange:r.protocols.split(":")[1]||"all",source:((o=r.source_ranges)==null?void 0:o.join(", "))||((i=r.source_tags)==null?void 0:i.join(", "))||"any",description:r.rule_name}}),outboundRules:a.filter(r=>r.direction==="EGRESS").slice(0,5).map((r,n)=>{var o;return{id:`${s.network_id}-out-${n}`,protocol:r.protocols.split(":")[0]||"tcp",portRange:r.protocols.split(":")[1]||"all",source:((o=r.target_tags)==null?void 0:o.join(", "))||"any",description:r.rule_name}})}})},zn={aws:{provider:"aws",vpcCount:5,subnetCount:24,securityGroupCount:ga.security_groups.length,loadBalancerCount:8,transitGatewayCount:2,totalInstances:156,regions:["us-east-1","us-west-2","eu-west-1","ap-southeast-1"],healthScore:94,issueCount:3,lastSync:new Date(Date.now()-5*60*1e3).toISOString()},azure:{provider:"azure",vpcCount:Xt.network_security_groups.length,subnetCount:15,securityGroupCount:Xt.network_security_groups.length,loadBalancerCount:5,transitGatewayCount:1,totalInstances:89,regions:["eastus","westeurope","southeastasia"],healthScore:87,issueCount:5,lastSync:new Date(Date.now()-8*60*1e3).toISOString()},gcp:{provider:"gcp",vpcCount:Hs.networks.length,subnetCount:12,securityGroupCount:Hs.rules.length,loadBalancerCount:4,transitGatewayCount:0,totalInstances:67,regions:["us-central1","europe-west1"],healthScore:92,issueCount:2,lastSync:new Date(Date.now()-3*60*1e3).toISOString()}},$n={aws:[{id:"vpc-prod-us-east-1",name:"Production VPC US-East-1",cidrBlock:"10.0.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:8,securityGroupCount:ga.security_groups.filter(e=>e.vpc==="vpc-prod-us-east-1").length||15,instanceCount:45},{id:"vpc-devops-us-east-1",name:"DevOps VPC",cidrBlock:"10.80.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:4,securityGroupCount:8,instanceCount:23},{id:"vpc-pci-us-east-1",name:"PCI-DSS VPC",cidrBlock:"10.90.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:4,securityGroupCount:6,instanceCount:12},{id:"vpc-dmz-01",name:"DMZ VPC",cidrBlock:"172.16.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!1,subnetCount:2,securityGroupCount:10,instanceCount:8},{id:"vpc-default",name:"Default VPC",cidrBlock:"172.31.0.0/16",region:"us-east-1",provider:"aws",status:"active",isDefault:!0,subnetCount:6,securityGroupCount:8,instanceCount:68}],azure:Xt.network_security_groups.map((e,s)=>({id:`vnet-${e.location}-${s}`,name:`${e.resource_group} VNet`,cidrBlock:`10.${10+s}.0.0/16`,region:e.location,provider:"azure",status:"active",isDefault:!1,subnetCount:6,securityGroupCount:12,instanceCount:34})),gcp:Hs.networks.map(e=>({id:e.network_id,name:e.name,cidrBlock:"auto",region:"us-central1",provider:"gcp",status:"active",isDefault:!1,subnetCount:8,securityGroupCount:Hs.rules.filter(s=>s.network===e.name).length,instanceCount:45}))},ic={aws:ng(),azure:og(),gcp:ig()},lg={aws:[{id:"alb-prod-web",name:"prod-web-alb",type:"application",scheme:"internet-facing",state:"active",dnsName:"prod-web-alb-123456.us-east-1.elb.amazonaws.com",vpcId:"vpc-prod-us-east-1",listenerCount:2,targetGroupCount:3,healthyTargets:6,totalTargets:6},{id:"nlb-prod-api",name:"prod-api-nlb",type:"network",scheme:"internal",state:"active",dnsName:"prod-api-nlb-789012.us-east-1.elb.amazonaws.com",vpcId:"vpc-prod-us-east-1",listenerCount:1,targetGroupCount:1,healthyTargets:4,totalTargets:4},{id:"alb-staging",name:"staging-alb",type:"application",scheme:"internet-facing",state:"active",dnsName:"staging-alb-345678.us-west-2.elb.amazonaws.com",vpcId:"vpc-staging-01",listenerCount:1,targetGroupCount:2,healthyTargets:2,totalTargets:2}],azure:[{id:"lb-prod-web",name:"prod-web-lb",type:"application",scheme:"internet-facing",state:"active",dnsName:"prod-web-lb.eastus.cloudapp.azure.com",vpcId:"vnet-prod-01",listenerCount:2,targetGroupCount:2,healthyTargets:4,totalTargets:5},{id:"lb-prod-internal",name:"prod-internal-lb",type:"network",scheme:"internal",state:"active",dnsName:"prod-internal-lb.internal",vpcId:"vnet-prod-01",listenerCount:1,targetGroupCount:1,healthyTargets:3,totalTargets:3}],gcp:[{id:"lb-prod",name:"production-lb",type:"application",scheme:"internet-facing",state:"active",dnsName:"34.120.123.45",vpcId:"vpc-production",listenerCount:1,targetGroupCount:2,healthyTargets:5,totalTargets:5}]},cg={aws:[{id:"tgw-prod",name:"production-tgw",state:"available",routeTables:3,region:"us-east-1",attachments:[{id:"tgw-attach-1",resourceType:"vpc",resourceId:"vpc-prod-us-east-1",resourceName:"Production VPC",state:"available"},{id:"tgw-attach-2",resourceType:"vpc",resourceId:"vpc-devops-us-east-1",resourceName:"DevOps VPC",state:"available"},{id:"tgw-attach-3",resourceType:"vpc",resourceId:"vpc-pci-us-east-1",resourceName:"PCI-DSS VPC",state:"available"},{id:"tgw-attach-4",resourceType:"vpn",resourceId:"vpn-onprem",resourceName:"On-Premises VPN",state:"available"}]},{id:"tgw-dr",name:"disaster-recovery-tgw",state:"available",routeTables:1,region:"us-west-2",attachments:[{id:"tgw-attach-5",resourceType:"vpc",resourceId:"vpc-staging-01",resourceName:"Staging VPC",state:"available"},{id:"tgw-attach-6",resourceType:"peering",resourceId:"tgw-prod",resourceName:"Production TGW Peering",state:"available"}]}],azure:[{id:"vhub-prod",name:"production-virtual-hub",state:"available",routeTables:2,region:"eastus",attachments:[{id:"conn-1",resourceType:"vpc",resourceId:"vnet-eastus-0",resourceName:"Production VNet",state:"available"},{id:"conn-2",resourceType:"vpc",resourceId:"vnet-eastus-1",resourceName:"Development VNet",state:"available"}]}],gcp:[]},at=e=>new Promise(s=>setTimeout(s,e)),je={async getOverview(e){return await at(300),zn[e]},async getAllOverviews(){return await at(500),Object.values(zn)},async getVPCs(e){return await at(400),$n[e]||[]},async getVPCDetails(e,s){return await at(200),($n[e]||[]).find(r=>r.id===s)||null},async getSubnets(e,s){var o;await at(300);const a=(o=$n[e])==null?void 0:o.find(i=>i.id===s);if(!a)return[];const r=[],n=e==="aws"?["a","b","c"]:e==="azure"?["1","2","3"]:["a","b"];for(let i=0;i<a.subnetCount;i++){const l=i<a.subnetCount/2;r.push({id:`${s}-subnet-${i+1}`,name:`${l?"public":"private"}-subnet-${i%3+1}`,vpcId:s,cidrBlock:`10.${i}.0.0/24`,availabilityZone:`${a.region}${n[i%n.length]}`,isPublic:l,availableIps:250-Math.floor(Math.random()*100),instanceCount:Math.floor(a.instanceCount/a.subnetCount)})}return r},async getSecurityGroups(e,s){await at(400);let a=ic[e]||[];return s&&(a=a.filter(r=>r.vpcId===s)),a},async getSecurityGroupDetails(e,s){return await at(200),(ic[e]||[]).find(r=>r.id===s)||null},async getLoadBalancers(e){return await at(400),lg[e]||[]},async getTransitGateways(e){return await at(400),cg[e]||[]},async syncResources(e){return await at(2e3),zn[e].lastSync=new Date().toISOString(),{success:!0,message:`Successfully synced ${e.toUpperCase()} resources`}}},dg={total_validations:110,pass:45,fail:32,warning:23,exception:7,pending_review:3,by_severity:{critical:8,high:18,medium:35,low:29,info:20}},ug=[{validation_id:"VAL-0001",rule_reference:"sgr-0a1b2c3d4e5f0001",rule_name:"Web-HTTPS-Inbound",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"INFO",status:"PASS",expected_value:"Restricted source CIDR or security group",actual_value:"0.0.0.0/0 (Acceptable for public HTTPS)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Public web server - 0.0.0.0/0 is expected for port 443",remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0002",rule_reference:"sgr-legacy-ssh-001",rule_name:"Legacy-SSH-Any-Source",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"CRITICAL",status:"FAIL",expected_value:"Restricted source CIDR (VPN or bastion only)",actual_value:"0.0.0.0/0 to port 22",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict SSH access to VPN CIDR 10.100.0.0/16 or bastion security group sg-bastion",ticket_reference:null},{validation_id:"VAL-0003",rule_reference:"sgr-rdp-any-001",rule_name:"Legacy-RDP-Any-Source",platform:"AWS",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_SOURCE",check_description:"Validates that inbound rules do not allow unrestricted access (0.0.0.0/0) to sensitive ports",severity:"CRITICAL",status:"FAIL",expected_value:"Restricted source CIDR (VPN only)",actual_value:"0.0.0.0/0 to port 3389",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict RDP access to VPN CIDR 10.100.0.0/16 or use Azure Bastion/AWS SSM",ticket_reference:null},{validation_id:"VAL-0004",rule_reference:"sgr-0a1b2c3d4e5f0011",rule_name:"Database-PostgreSQL-Access",platform:"AWS",validation_category:"SECURITY",validation_check:"DATABASE_ACCESS_RESTRICTION",check_description:"Validates that database ports are only accessible from application tiers",severity:"LOW",status:"PASS",expected_value:"Source restricted to application security groups",actual_value:"sg-webapp-prod",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012346"},{validation_id:"VAL-0005",rule_reference:"nsg-rule-db-any",rule_name:"Database-Any-Access",platform:"Azure",validation_category:"SECURITY",validation_check:"DATABASE_ACCESS_RESTRICTION",check_description:"Validates that database ports are only accessible from application tiers",severity:"HIGH",status:"FAIL",expected_value:"Source restricted to application ASGs",actual_value:"Source: * (Any)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Change source from '*' to 'asg-webapp' or 'asg-api' application security groups",ticket_reference:null},{validation_id:"VAL-0006",rule_reference:"pa-rule-any-any",rule_name:"Allow-Any-Any-Trust",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"OVERLY_PERMISSIVE_RULE",check_description:"Validates that rules do not allow any-to-any traffic without restrictions",severity:"CRITICAL",status:"FAIL",expected_value:"Specific source, destination, application, and service",actual_value:"Source: any, Dest: any, App: any, Service: any",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace with specific rules for required traffic flows. Remove this overly permissive rule.",ticket_reference:null},{validation_id:"VAL-0007",rule_reference:"sgr-0a1b2c3d4e5f0021",rule_name:"Redis-Cache-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DESCRIPTION_REQUIRED",check_description:"Validates that all rules have meaningful descriptions",severity:"LOW",status:"PASS",expected_value:"Non-empty description explaining rule purpose",actual_value:"Allow Redis access from web tier for session caching",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012347"},{validation_id:"VAL-0008",rule_reference:"sgr-nodesc-001",rule_name:"Unnamed-Rule-8080",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DESCRIPTION_REQUIRED",check_description:"Validates that all rules have meaningful descriptions",severity:"MEDIUM",status:"FAIL",expected_value:"Non-empty description explaining rule purpose",actual_value:"(empty)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add description: 'Allow application traffic from [source] for [purpose]'",ticket_reference:null},{validation_id:"VAL-0009",rule_reference:"gcp-allow-all-egress",rule_name:"default-allow-all-egress",platform:"GCP",validation_category:"SECURITY",validation_check:"UNRESTRICTED_EGRESS",check_description:"Validates that egress rules are restricted to required destinations",severity:"HIGH",status:"WARNING",expected_value:"Egress restricted to specific destinations or services",actual_value:"0.0.0.0/0 for all protocols",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Consider restricting egress to specific destinations. Implement egress filtering for sensitive workloads.",ticket_reference:null},{validation_id:"VAL-0010",rule_reference:"nsg-webapp-prod-100",rule_name:"Allow-HTTPS-Internet-Inbound",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.3",check_description:"Validates DMZ architecture with restricted database access",severity:"LOW",status:"PASS",expected_value:"Web tier in DMZ, databases in private subnet",actual_value:"NSG properly segments web and database tiers",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0011",rule_reference:"pa-rule-pci-violation",rule_name:"Direct-Internet-to-DB",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.3",check_description:"Validates DMZ architecture with restricted database access",severity:"CRITICAL",status:"FAIL",expected_value:"No direct internet access to cardholder data environment",actual_value:"Rule allows Untrust zone to Database zone on port 5432",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove direct internet to database rule. Route through application tier in DMZ.",ticket_reference:null},{validation_id:"VAL-0012",rule_reference:"sgr-0a1b2c3d4e5f0047",rule_name:"Kafka-Producer-Access",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"PORT_RANGE_VALIDATION",check_description:"Validates that port ranges are correctly specified",severity:"LOW",status:"PASS",expected_value:"Valid port number or range (1-65535)",actual_value:"9092",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012348"},{validation_id:"VAL-0013",rule_reference:"nsg-invalid-port",rule_name:"Invalid-Port-Range",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"PORT_RANGE_VALIDATION",check_description:"Validates that port ranges are correctly specified",severity:"HIGH",status:"FAIL",expected_value:"Valid port number or range (1-65535)",actual_value:"Port range: 0-70000 (invalid)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Correct port range to valid values (1-65535). Split into multiple rules if needed.",ticket_reference:null},{validation_id:"VAL-0014",rule_reference:"sgr-dup-rule-001",rule_name:"Duplicate-HTTPS-Rule-1",platform:"AWS",validation_category:"REDUNDANCY",validation_check:"DUPLICATE_RULE_DETECTION",check_description:"Identifies duplicate or overlapping rules",severity:"MEDIUM",status:"WARNING",expected_value:"Unique rule without duplicates",actual_value:"Duplicate of sgr-dup-rule-002 (same source, port, protocol)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove duplicate rule sgr-dup-rule-002 or consolidate into single rule",ticket_reference:null},{validation_id:"VAL-0015",rule_reference:"gcp-conflict-001",rule_name:"Allow-SSH-Specific",platform:"GCP",validation_category:"CONFLICT",validation_check:"CONFLICTING_RULE_DETECTION",check_description:"Identifies rules that conflict with each other",severity:"HIGH",status:"FAIL",expected_value:"No conflicting allow/deny rules for same traffic",actual_value:"Conflicts with deny-ssh-all (priority 100 vs 1000)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review priority ordering. Higher priority deny rule (100) will block this allow rule (1000).",ticket_reference:null},{validation_id:"VAL-0016",rule_reference:"pa-expired-rule-001",rule_name:"Temp-Vendor-Access-Expired",platform:"Palo Alto",validation_category:"EXPIRATION",validation_check:"RULE_EXPIRATION_CHECK",check_description:"Validates that temporary rules are removed after expiration",severity:"MEDIUM",status:"FAIL",expected_value:"Rule should be disabled or removed after 2025-12-31",actual_value:"Rule still active, expired 13 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Disable or remove expired rule. If still needed, create new change request for extension.",ticket_reference:"CHG0011234"},{validation_id:"VAL-0017",rule_reference:"sgr-0a1b2c3d4e5f0086",rule_name:"Jenkins-CI-CD-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"TICKET_REFERENCE_REQUIRED",check_description:"Validates that all rules have associated change tickets",severity:"LOW",status:"PASS",expected_value:"Valid change ticket reference",actual_value:"CHG0012359",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012359"},{validation_id:"VAL-0018",rule_reference:"nsg-no-ticket-001",rule_name:"Unknown-Rule-No-Ticket",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"TICKET_REFERENCE_REQUIRED",check_description:"Validates that all rules have associated change tickets",severity:"MEDIUM",status:"FAIL",expected_value:"Valid change ticket reference",actual_value:"(no ticket reference)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Create change ticket documenting rule purpose and approval. Tag rule with ticket number.",ticket_reference:null},{validation_id:"VAL-0019",rule_reference:"sgr-0a1b2c3d4e5f0096",rule_name:"Vault-Secrets-Access",platform:"AWS",validation_category:"SECURITY",validation_check:"SENSITIVE_SERVICE_PROTECTION",check_description:"Validates that sensitive services have restricted access",severity:"LOW",status:"PASS",expected_value:"Vault access restricted to specific application groups",actual_value:"Source: 10.30.0.0/16 (Application CIDR only)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012360"},{validation_id:"VAL-0020",rule_reference:"gcp-vault-any",rule_name:"Vault-Any-Access",platform:"GCP",validation_category:"SECURITY",validation_check:"SENSITIVE_SERVICE_PROTECTION",check_description:"Validates that sensitive services have restricted access",severity:"HIGH",status:"FAIL",expected_value:"Vault access restricted to specific application groups",actual_value:"Source: 0.0.0.0/0 (unrestricted)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict Vault access to application network tags only. Remove public access.",ticket_reference:null},{validation_id:"VAL-0021",rule_reference:"pa-rule-payment",rule_name:"Allow-Payment-Processing",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.2",check_description:"Validates firewall rules restrict inbound and outbound traffic to CDE",severity:"LOW",status:"PASS",expected_value:"Traffic limited to payment processing requirements only",actual_value:"Source: AG-Payment-Servers, Dest: AG-Payment-Providers, App: ssl",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012352"},{validation_id:"VAL-0022",rule_reference:"sgr-wide-port-range",rule_name:"Wide-Port-Range-Rule",platform:"AWS",validation_category:"SECURITY",validation_check:"EXCESSIVE_PORT_RANGE",check_description:"Validates that port ranges are not excessively wide",severity:"HIGH",status:"FAIL",expected_value:"Specific ports or narrow ranges",actual_value:"Port range: 1-65535 (all ports)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict to specific ports required. Split into multiple rules for different services.",ticket_reference:null},{validation_id:"VAL-0023",rule_reference:"nsg-webapp-prod-100",rule_name:"Allow-HTTPS-Internet-Inbound",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"SOC2_ACCESS_CONTROL",check_description:"Validates logical access controls per SOC2 CC6.1",severity:"LOW",status:"PASS",expected_value:"Access restricted based on business requirements",actual_value:"HTTPS only, appropriate for public web application",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0024",rule_reference:"gcp-allow-https-ingress",rule_name:"allow-https-ingress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"LOGGING_ENABLED",check_description:"Validates that firewall logging is enabled for audit",severity:"MEDIUM",status:"PASS",expected_value:"Logging enabled",actual_value:"logging: true",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0025",rule_reference:"gcp-internal-no-log",rule_name:"allow-internal-traffic",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"LOGGING_ENABLED",check_description:"Validates that firewall logging is enabled for audit",severity:"MEDIUM",status:"WARNING",expected_value:"Logging enabled",actual_value:"logging: false",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Enable logging for audit trail. Consider log sampling for high-volume rules.",ticket_reference:null},{validation_id:"VAL-0026",rule_reference:"pa-security-profile",rule_name:"Allow-HTTPS-Inbound-DMZ",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SECURITY_PROFILE_ATTACHED",check_description:"Validates that security profiles are attached to allow rules",severity:"LOW",status:"PASS",expected_value:"Security profile group attached",actual_value:"Profile: Web-Protection (AV, AS, VP, URL, FP)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0027",rule_reference:"pa-no-profile",rule_name:"Allow-Internal-No-Profile",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SECURITY_PROFILE_ATTACHED",check_description:"Validates that security profiles are attached to allow rules",severity:"HIGH",status:"FAIL",expected_value:"Security profile group attached",actual_value:"Profile: (none)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Attach appropriate security profile (Internal-Protection or similar)",ticket_reference:null},{validation_id:"VAL-0028",rule_reference:"sgr-0a1b2c3d4e5f0073",rule_name:"Grafana-Dashboard-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"NAMING_CONVENTION",check_description:"Validates rule naming follows organizational standards",severity:"INFO",status:"PASS",expected_value:"Format: [Action]-[Service]-[Direction]-[Source]",actual_value:"Allow-Grafana-VPN-Inbound",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012367"},{validation_id:"VAL-0029",rule_reference:"nsg-bad-name",rule_name:"rule1",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"NAMING_CONVENTION",check_description:"Validates rule naming follows organizational standards",severity:"LOW",status:"FAIL",expected_value:"Format: [Action]-[Service]-[Direction]-[Source]",actual_value:"rule1",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Rename to follow convention, e.g., 'Allow-HTTPS-Inbound-Internet'",ticket_reference:null},{validation_id:"VAL-0030",rule_reference:"sgr-0a1b2c3d4e5f0052",rule_name:"Kafka-Zookeeper-Internal",platform:"AWS",validation_category:"PERFORMANCE",validation_check:"RULE_HIT_COUNT",check_description:"Identifies rules with zero or very low hit counts",severity:"INFO",status:"PASS",expected_value:"Hit count > 0 in last 30 days",actual_value:"Hit count: 1,245,678",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012368"},{validation_id:"VAL-0031",rule_reference:"pa-zero-hits",rule_name:"Allow-Legacy-FTP",platform:"Palo Alto",validation_category:"PERFORMANCE",validation_check:"RULE_HIT_COUNT",check_description:"Identifies rules with zero or very low hit counts",severity:"LOW",status:"WARNING",expected_value:"Hit count > 0 in last 30 days",actual_value:"Hit count: 0 (last 90 days)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review if rule is still needed. Consider disabling for 30 days before removal.",ticket_reference:null},{validation_id:"VAL-0032",rule_reference:"sgr-icmp-unrestricted",rule_name:"Allow-ICMP-All",platform:"AWS",validation_category:"SECURITY",validation_check:"ICMP_RESTRICTION",check_description:"Validates ICMP is restricted appropriately",severity:"MEDIUM",status:"FAIL",expected_value:"ICMP restricted to specific types (echo-request/reply) or internal only",actual_value:"All ICMP types from 0.0.0.0/0",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Restrict to ICMP types 0 and 8 (echo) from internal networks only",ticket_reference:null},{validation_id:"VAL-0033",rule_reference:"nsg-telnet-allow",rule_name:"Allow-Telnet-Internal",platform:"Azure",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"FAIL",expected_value:"No Telnet (port 23), use SSH instead",actual_value:"Port 23 allowed from internal networks",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Migrate to SSH (port 22). Remove Telnet rule after migration.",ticket_reference:null},{validation_id:"VAL-0034",rule_reference:"gcp-ftp-allow",rule_name:"allow-ftp-partner",platform:"GCP",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"FAIL",expected_value:"No unencrypted FTP (port 21), use SFTP instead",actual_value:"Port 21 allowed from partner IPs",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Migrate partners to SFTP (port 22) or FTPS (port 990). Update partner documentation.",ticket_reference:null},{validation_id:"VAL-0035",rule_reference:"pa-http-internal",rule_name:"Allow-HTTP-Internal",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"UNENCRYPTED_WEB_TRAFFIC",check_description:"Validates that HTTP is redirected to HTTPS",severity:"MEDIUM",status:"WARNING",expected_value:"HTTP redirected to HTTPS or blocked",actual_value:"HTTP (port 80) allowed internally",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Internal applications not yet migrated to HTTPS",remediation:"Plan migration of internal applications to HTTPS. Block HTTP after migration.",ticket_reference:"CHG0012500"},{validation_id:"VAL-0036",rule_reference:"sgr-0a1b2c3d4e5f0107",rule_name:"Payment-Webhook-Stripe",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"PCI_DSS_REQUIREMENT_1.4",check_description:"Validates personal firewall on mobile/employee-owned devices",severity:"INFO",status:"PASS",expected_value:"N/A for server rules",actual_value:"Server-side rule, requirement not applicable",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012352"},{validation_id:"VAL-0037",rule_reference:"nsg-storage-endpoint",rule_name:"Allow-Storage-Endpoint",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"SERVICE_TAG_USAGE",check_description:"Validates use of service tags for Azure services",severity:"LOW",status:"PASS",expected_value:"Service tag used instead of IP ranges",actual_value:"Destination: Storage",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012384"},{validation_id:"VAL-0038",rule_reference:"nsg-hardcoded-ips",rule_name:"Allow-Azure-Services-IPs",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"SERVICE_TAG_USAGE",check_description:"Validates use of service tags for Azure services",severity:"MEDIUM",status:"FAIL",expected_value:"Service tag used instead of IP ranges",actual_value:"Hardcoded IPs: 20.38.147.0/24, 20.150.0.0/24",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace hardcoded IPs with appropriate Azure service tags (e.g., AzureCloud, Storage)",ticket_reference:null},{validation_id:"VAL-0039",rule_reference:"sgr-s3-prefix-list",rule_name:"Allow-S3-VPC-Endpoint",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"PREFIX_LIST_USAGE",check_description:"Validates use of prefix lists for AWS services",severity:"LOW",status:"PASS",expected_value:"Prefix list used for AWS service endpoints",actual_value:"Destination: pl-63a5400a (S3)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012384"},{validation_id:"VAL-0040",rule_reference:"gcp-network-tags",rule_name:"allow-web-to-app",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"NETWORK_TAG_USAGE",check_description:"Validates use of network tags instead of IP ranges",severity:"LOW",status:"PASS",expected_value:"Network tags used for source/target",actual_value:"Source: web-server, Target: app-server",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012371"},{validation_id:"VAL-0041",rule_reference:"pa-address-group",rule_name:"Allow-App-to-DB",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"ADDRESS_GROUP_USAGE",check_description:"Validates use of address groups instead of individual IPs",severity:"LOW",status:"PASS",expected_value:"Address groups used for source/destination",actual_value:"Source: AG-App-Servers, Dest: AG-DB-Servers",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012346"},{validation_id:"VAL-0042",rule_reference:"pa-individual-ips",rule_name:"Allow-Specific-Hosts",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"ADDRESS_GROUP_USAGE",check_description:"Validates use of address groups instead of individual IPs",severity:"LOW",status:"WARNING",expected_value:"Address groups used for source/destination",actual_value:"Source: 10.30.1.15, 10.30.1.16, 10.30.1.17, 10.30.1.18",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Create address group for these hosts and reference group in rule",ticket_reference:null},{validation_id:"VAL-0043",rule_reference:"sgr-0a1b2c3d4e5f0080",rule_name:"EKS-Node-Communication",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"SELF_REFERENCING_GROUP",check_description:"Validates self-referencing security group for cluster communication",severity:"INFO",status:"PASS",expected_value:"Self-reference for internal cluster traffic",actual_value:"Source: sg-eks-nodes (self-reference)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0044",rule_reference:"nsg-mgmt-ports",rule_name:"Allow-Management-Ports",platform:"Azure",validation_category:"SECURITY",validation_check:"MANAGEMENT_PORT_PROTECTION",check_description:"Validates management ports have additional restrictions",severity:"MEDIUM",status:"PASS",expected_value:"SSH/RDP restricted to bastion or VPN only",actual_value:"Source: AzureBastionSubnet, Ports: 22, 3389",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012372"},{validation_id:"VAL-0045",rule_reference:"gcp-iap-ssh",rule_name:"allow-ssh-iap",platform:"GCP",validation_category:"SECURITY",validation_check:"IAP_TUNNEL_USAGE",check_description:"Validates SSH access uses Identity-Aware Proxy",severity:"LOW",status:"PASS",expected_value:"SSH from IAP range 35.235.240.0/20",actual_value:"Source: 35.235.240.0/20 (IAP range)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012430"},{validation_id:"VAL-0046",rule_reference:"sgr-expired-temp",rule_name:"Temp-Debug-Access",platform:"AWS",validation_category:"EXPIRATION",validation_check:"TEMPORARY_RULE_AUDIT",check_description:"Validates temporary rules have expiration dates",severity:"MEDIUM",status:"FAIL",expected_value:"Expiration date set for temporary rules",actual_value:"No expiration date, created 180 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add expiration date or convert to permanent rule with proper documentation",ticket_reference:"CHG0011000"},{validation_id:"VAL-0047",rule_reference:"pa-app-default",rule_name:"Allow-Web-Apps",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"APPLICATION_IDENTIFICATION",check_description:"Validates application identification is used instead of port-based",severity:"LOW",status:"PASS",expected_value:"Application-ID used instead of service ports",actual_value:"Application: web-browsing, ssl; Service: application-default",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0048",rule_reference:"pa-port-based",rule_name:"Allow-Port-8080",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"APPLICATION_IDENTIFICATION",check_description:"Validates application identification is used instead of port-based",severity:"MEDIUM",status:"WARNING",expected_value:"Application-ID used instead of service ports",actual_value:"Application: any; Service: tcp/8080",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Replace 'any' application with specific App-ID (e.g., web-browsing, ssl)",ticket_reference:null},{validation_id:"VAL-0049",rule_reference:"sgr-0a1b2c3d4e5f0091",rule_name:"Splunk-Log-Ingestion",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"AUDIT_LOG_PROTECTION",check_description:"Validates audit/log systems have proper access controls",severity:"LOW",status:"PASS",expected_value:"Log ingestion restricted to internal sources",actual_value:"Source: 10.0.0.0/8 (internal only)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012373"},{validation_id:"VAL-0050",rule_reference:"nsg-subnet-overlap",rule_name:"Allow-Subnet-Overlap",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"CIDR_OVERLAP_DETECTION",check_description:"Validates no overlapping CIDR ranges in rules",severity:"MEDIUM",status:"WARNING",expected_value:"No overlapping source/destination CIDRs",actual_value:"10.0.0.0/8 overlaps with 10.30.0.0/16 in other rule",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Use more specific CIDR ranges to avoid overlap confusion",ticket_reference:null},{validation_id:"VAL-0051",rule_reference:"gcp-deny-all-ingress",rule_name:"deny-all-ingress",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"DEFAULT_DENY_EXISTS",check_description:"Validates default deny rule exists at lowest priority",severity:"LOW",status:"PASS",expected_value:"Default deny rule at priority 65535",actual_value:"Priority: 65535, Action: deny, Direction: INGRESS",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0052",rule_reference:"pa-default-deny",rule_name:"Default-Deny-All",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"DEFAULT_DENY_EXISTS",check_description:"Validates default deny rule exists at end of policy",severity:"LOW",status:"PASS",expected_value:"Default deny rule at bottom of rulebase",actual_value:"Rule at position 105, Action: Deny, any-any",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0053",rule_reference:"sgr-dns-udp-only",rule_name:"Allow-DNS-Outbound",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"DNS_TCP_UDP_REQUIRED",check_description:"Validates DNS rules allow both TCP and UDP",severity:"LOW",status:"WARNING",expected_value:"DNS on both TCP/53 and UDP/53",actual_value:"UDP/53 only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add TCP/53 rule for DNS over TCP (large responses, zone transfers)",ticket_reference:null},{validation_id:"VAL-0054",rule_reference:"nsg-sql-internet",rule_name:"Deny-SQL-Internet",platform:"Azure",validation_category:"SECURITY",validation_check:"DATABASE_INTERNET_BLOCK",check_description:"Validates database ports are blocked from internet",severity:"LOW",status:"PASS",expected_value:"Database ports blocked from internet",actual_value:"Deny rule for 1433, 3306, 5432 from Internet",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012363"},{validation_id:"VAL-0055",rule_reference:"gcp-smb-exposed",rule_name:"allow-smb-external",platform:"GCP",validation_category:"SECURITY",validation_check:"DANGEROUS_PORT_EXPOSURE",check_description:"Validates dangerous ports are not exposed to internet",severity:"CRITICAL",status:"FAIL",expected_value:"SMB (445) not exposed to internet",actual_value:"Port 445 exposed to 0.0.0.0/0",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Remove SMB exposure to internet. High risk of exploitation.",ticket_reference:null},{validation_id:"VAL-0056",rule_reference:"pa-zone-protection",rule_name:"Untrust-Zone-Protection",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"ZONE_PROTECTION_PROFILE",check_description:"Validates zone protection profiles are applied",severity:"LOW",status:"PASS",expected_value:"Zone protection profile on untrust zone",actual_value:"Profile: External-Zone-Protection applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0057",rule_reference:"sgr-0a1b2c3d4e5f0018",rule_name:"Database-Replication-DR",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"DR_CONNECTIVITY",check_description:"Validates DR site connectivity is properly configured",severity:"LOW",status:"PASS",expected_value:"Replication traffic to DR site allowed",actual_value:"PostgreSQL (5432) to DR CIDR 10.120.0.0/16",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012380"},{validation_id:"VAL-0058",rule_reference:"nsg-priority-gap",rule_name:"Rule-Priority-100",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"PRIORITY_SPACING",check_description:"Validates adequate priority spacing for future rules",severity:"INFO",status:"WARNING",expected_value:"Priority spacing of at least 10",actual_value:"Rules at 100, 101, 102 (gap of 1)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Consider renumbering priorities with larger gaps (100, 110, 120)",ticket_reference:null},{validation_id:"VAL-0059",rule_reference:"gcp-priority-order",rule_name:"allow-specific-after-deny",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"PRIORITY_ORDER_VALIDATION",check_description:"Validates rule priority order is logical",severity:"HIGH",status:"FAIL",expected_value:"Allow rules have higher priority (lower number) than deny",actual_value:"Allow at 2000, Deny at 1000 (deny processed first)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Adjust priority: Allow rule should be < 1000 to be processed before deny",ticket_reference:null},{validation_id:"VAL-0060",rule_reference:"pa-rule-shadowed",rule_name:"Allow-HTTP-Specific",platform:"Palo Alto",validation_category:"REDUNDANCY",validation_check:"SHADOWED_RULE_DETECTION",check_description:"Identifies rules shadowed by more general rules above",severity:"MEDIUM",status:"WARNING",expected_value:"Rule not shadowed by broader rule",actual_value:"Shadowed by 'Allow-Any-HTTP' at position 5",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Reorder rules or remove shadowed rule if redundant",ticket_reference:null},{validation_id:"VAL-0061",rule_reference:"sgr-nat-gateway",rule_name:"NAT-Gateway-Outbound",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"NAT_GATEWAY_RULES",check_description:"Validates NAT gateway security group configuration",severity:"LOW",status:"PASS",expected_value:"NAT gateway allows outbound to internet",actual_value:"Outbound: 0.0.0.0/0, Protocol: ALL",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012400"},{validation_id:"VAL-0062",rule_reference:"nsg-keyvault-private",rule_name:"Allow-KeyVault-Private-Endpoint",platform:"Azure",validation_category:"SECURITY",validation_check:"PRIVATE_ENDPOINT_USAGE",check_description:"Validates private endpoints for sensitive services",severity:"LOW",status:"PASS",expected_value:"Key Vault accessed via private endpoint",actual_value:"Destination: Private endpoint 10.50.1.5",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012390"},{validation_id:"VAL-0063",rule_reference:"gcp-vpc-peering",rule_name:"allow-peered-vpc-traffic",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"VPC_PEERING_RULES",check_description:"Validates firewall rules for VPC peering",severity:"LOW",status:"PASS",expected_value:"Peered VPC traffic properly allowed",actual_value:"Source: 10.200.0.0/16 (peered VPC)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012450"},{validation_id:"VAL-0064",rule_reference:"pa-edl-malicious",rule_name:"Block-Malicious-IPs-EDL",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"THREAT_FEED_INTEGRATION",check_description:"Validates threat intelligence feeds are integrated",severity:"LOW",status:"PASS",expected_value:"External dynamic list for threat IPs",actual_value:"Source: EDL-Malicious-IPs (updated hourly)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012350"},{validation_id:"VAL-0065",rule_reference:"sgr-container-registry",rule_name:"ECR-Pull-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"CONTAINER_REGISTRY_ACCESS",check_description:"Validates container registry access is properly configured",severity:"LOW",status:"PASS",expected_value:"ECR access via VPC endpoint",actual_value:"Destination: vpce-ecr, Port: 443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012374"},{validation_id:"VAL-0066",rule_reference:"nsg-aks-nodeport",rule_name:"Allow-AKS-NodePort-Range",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"KUBERNETES_NODEPORT_RANGE",check_description:"Validates Kubernetes NodePort range is properly configured",severity:"LOW",status:"PASS",expected_value:"NodePort range 30000-32767",actual_value:"Port range: 30000-32767",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0067",rule_reference:"gcp-gke-master-node",rule_name:"allow-gke-master-to-nodes",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"GKE_MASTER_ACCESS",check_description:"Validates GKE master to node communication",severity:"LOW",status:"PASS",expected_value:"Master can reach nodes on 443, 10250",actual_value:"Source: gke-master tag, Ports: 443, 10250",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012369"},{validation_id:"VAL-0068",rule_reference:"pa-hipaa-encryption",rule_name:"Allow-Healthcare-Data",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"HIPAA_ENCRYPTION_REQUIREMENT",check_description:"Validates healthcare data is transmitted encrypted",severity:"LOW",status:"PASS",expected_value:"Only encrypted protocols for PHI",actual_value:"Application: ssl; Service: tcp/443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012455"},{validation_id:"VAL-0069",rule_reference:"sgr-unencrypted-phi",rule_name:"Allow-HTTP-Healthcare",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"HIPAA_ENCRYPTION_REQUIREMENT",check_description:"Validates healthcare data is transmitted encrypted",severity:"CRITICAL",status:"FAIL",expected_value:"Only encrypted protocols for PHI",actual_value:"HTTP (80) allowed for healthcare application",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Migrate to HTTPS. Unencrypted PHI transmission violates HIPAA.",ticket_reference:null},{validation_id:"VAL-0070",rule_reference:"nsg-monitoring-access",rule_name:"Allow-Monitoring-Agents",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"MONITORING_EGRESS",check_description:"Validates monitoring agent egress is allowed",severity:"LOW",status:"PASS",expected_value:"Monitoring agents can reach collectors",actual_value:"Destination: AzureMonitor, Port: 443",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012387"},{validation_id:"VAL-0071",rule_reference:"gcp-healthcheck-ranges",rule_name:"allow-health-check",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"HEALTH_CHECK_RANGES",check_description:"Validates GCP health check ranges are allowed",severity:"LOW",status:"PASS",expected_value:"Source: 35.191.0.0/16, 130.211.0.0/22",actual_value:"Source: 35.191.0.0/16, 130.211.0.0/22",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012370"},{validation_id:"VAL-0072",rule_reference:"pa-decryption-policy",rule_name:"SSL-Decryption-Web",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"SSL_DECRYPTION_ENABLED",check_description:"Validates SSL decryption is enabled for inspection",severity:"LOW",status:"PASS",expected_value:"SSL decryption enabled for outbound web",actual_value:"Decryption: Forward Proxy, Profile: SSL-Decrypt-Standard",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0073",rule_reference:"sgr-vpc-flow-logs",rule_name:"VPC-Flow-Logs-Config",platform:"AWS",validation_category:"COMPLIANCE",validation_check:"FLOW_LOGS_ENABLED",check_description:"Validates VPC flow logs are enabled for audit",severity:"INFO",status:"PASS",expected_value:"Flow logs enabled on VPC",actual_value:"Flow logs: ENABLED, Destination: S3",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0074",rule_reference:"nsg-flow-logs-disabled",rule_name:"NSG-No-Flow-Logs",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"NSG_FLOW_LOGS_ENABLED",check_description:"Validates NSG flow logs are enabled for audit",severity:"MEDIUM",status:"FAIL",expected_value:"NSG flow logs enabled",actual_value:"Flow logs: DISABLED",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Enable NSG flow logs for compliance and troubleshooting",ticket_reference:null},{validation_id:"VAL-0075",rule_reference:"gcp-org-policy",rule_name:"Org-Policy-Compliance",platform:"GCP",validation_category:"COMPLIANCE",validation_check:"ORG_POLICY_COMPLIANCE",check_description:"Validates firewall rules comply with organization policies",severity:"LOW",status:"PASS",expected_value:"Rules comply with org constraints",actual_value:"All rules comply with compute.restrictVpcPeering",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0076",rule_reference:"pa-commit-validation",rule_name:"Pending-Commit-Rules",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"UNCOMMITTED_CHANGES",check_description:"Validates no uncommitted changes pending",severity:"INFO",status:"WARNING",expected_value:"No uncommitted changes",actual_value:"3 uncommitted rule changes",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Commit pending changes or revert if not needed",ticket_reference:null},{validation_id:"VAL-0077",rule_reference:"sgr-deprecated-ami",rule_name:"Allow-Deprecated-AMI-Access",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"DEPRECATED_RESOURCE_REFERENCE",check_description:"Validates rules don't reference deprecated resources",severity:"LOW",status:"WARNING",expected_value:"No deprecated resource references",actual_value:"References deprecated security group sg-legacy-app",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Update rule to reference current security group",ticket_reference:null},{validation_id:"VAL-0078",rule_reference:"nsg-gdpr-data",rule_name:"Allow-EU-Data-Processing",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"GDPR_DATA_RESIDENCY",check_description:"Validates EU data stays within approved regions",severity:"LOW",status:"PASS",expected_value:"EU data within EU regions only",actual_value:"Destination: EU West, EU North only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012456"},{validation_id:"VAL-0079",rule_reference:"gcp-cross-region",rule_name:"allow-cross-region-db",platform:"GCP",validation_category:"COMPLIANCE",validation_check:"GDPR_DATA_RESIDENCY",check_description:"Validates EU data stays within approved regions",severity:"HIGH",status:"EXCEPTION",expected_value:"EU data within EU regions only",actual_value:"Cross-region replication to US for DR",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Approved exception for DR - Standard Contractual Clauses in place",remediation:null,ticket_reference:"EXC-0012"},{validation_id:"VAL-0080",rule_reference:"pa-url-filtering",rule_name:"Block-Malicious-URLs",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"URL_FILTERING_ENABLED",check_description:"Validates URL filtering is enabled for web traffic",severity:"LOW",status:"PASS",expected_value:"URL filtering profile attached",actual_value:"Profile: URL-Block-Profile (malware, phishing blocked)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0081",rule_reference:"sgr-stale-rule",rule_name:"Allow-Old-Partner-Access",platform:"AWS",validation_category:"EXPIRATION",validation_check:"STALE_RULE_DETECTION",check_description:"Identifies rules not modified in over 1 year",severity:"LOW",status:"WARNING",expected_value:"Rule reviewed within last year",actual_value:"Last modified: 2024-06-15 (577 days ago)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review rule validity. Update or remove if no longer needed.",ticket_reference:null},{validation_id:"VAL-0082",rule_reference:"nsg-asg-membership",rule_name:"Allow-ASG-WebApp",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"ASG_MEMBERSHIP_VALIDATION",check_description:"Validates ASG has active members",severity:"MEDIUM",status:"WARNING",expected_value:"ASG has active NIC memberships",actual_value:"asg-legacy-app has 0 members",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Add NICs to ASG or remove unused ASG references",ticket_reference:null},{validation_id:"VAL-0083",rule_reference:"gcp-firewall-insights",rule_name:"Firewall-Insights-Check",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"FIREWALL_INSIGHTS_ENABLED",check_description:"Validates Firewall Insights is enabled",severity:"INFO",status:"PASS",expected_value:"Firewall Insights enabled",actual_value:"Insights: ENABLED",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0084",rule_reference:"pa-rule-disable",rule_name:"Disabled-Rule-Check",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"DISABLED_RULE_AUDIT",check_description:"Identifies disabled rules that should be removed",severity:"INFO",status:"WARNING",expected_value:"Disabled rules removed after 30 days",actual_value:"5 rules disabled for > 90 days",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Review and remove disabled rules no longer needed",ticket_reference:null},{validation_id:"VAL-0085",rule_reference:"sgr-ipv6-support",rule_name:"IPv6-Dual-Stack",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"IPV6_COVERAGE",check_description:"Validates IPv6 rules exist for dual-stack",severity:"INFO",status:"PASS",expected_value:"IPv6 rules mirror IPv4",actual_value:"IPv6 rules present for all public services",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012457"},{validation_id:"VAL-0086",rule_reference:"nsg-cross-subscription",rule_name:"Allow-Cross-Subscription",platform:"Azure",validation_category:"SECURITY",validation_check:"CROSS_SUBSCRIPTION_ACCESS",check_description:"Validates cross-subscription access is authorized",severity:"MEDIUM",status:"EXCEPTION",expected_value:"Cross-subscription access documented and approved",actual_value:"Traffic to subscription: sub-shared-services",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Approved for shared services architecture - documented in ADR-0023",remediation:null,ticket_reference:"EXC-0015"},{validation_id:"VAL-0087",rule_reference:"gcp-shared-vpc",rule_name:"allow-shared-vpc-access",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"SHARED_VPC_RULES",check_description:"Validates Shared VPC firewall rules",severity:"LOW",status:"PASS",expected_value:"Shared VPC rules in host project",actual_value:"Rules managed in host project vpc-host-prod",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012458"},{validation_id:"VAL-0088",rule_reference:"pa-ha-sync",rule_name:"HA-Sync-Validation",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"HA_RULE_SYNC",check_description:"Validates rules are synced across HA pair",severity:"LOW",status:"PASS",expected_value:"Rules identical on both HA members",actual_value:"Primary and Secondary in sync",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0089",rule_reference:"sgr-cidr-specific",rule_name:"Allow-Partner-CIDR",platform:"AWS",validation_category:"BEST_PRACTICE",validation_check:"CIDR_SPECIFICITY",check_description:"Validates CIDRs are as specific as possible",severity:"LOW",status:"WARNING",expected_value:"Most specific CIDR for partner",actual_value:"198.51.100.0/24 could be 198.51.100.0/28",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Narrow CIDR to actual partner IP range",ticket_reference:null},{validation_id:"VAL-0090",rule_reference:"nsg-ddos-protection",rule_name:"DDoS-Protection-Check",platform:"Azure",validation_category:"SECURITY",validation_check:"DDOS_PROTECTION_ENABLED",check_description:"Validates DDoS protection is enabled",severity:"LOW",status:"PASS",expected_value:"DDoS Protection Standard enabled",actual_value:"DDoS Protection: ENABLED (Standard tier)",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0091",rule_reference:"gcp-armor-policy",rule_name:"Cloud-Armor-Check",platform:"GCP",validation_category:"SECURITY",validation_check:"CLOUD_ARMOR_ENABLED",check_description:"Validates Cloud Armor is enabled for public endpoints",severity:"LOW",status:"PASS",expected_value:"Cloud Armor policy attached to LB",actual_value:"Policy: web-protection-policy attached",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0092",rule_reference:"pa-dos-protection",rule_name:"DoS-Protection-Profile",platform:"Palo Alto",validation_category:"SECURITY",validation_check:"DOS_PROTECTION_ENABLED",check_description:"Validates DoS protection profiles are configured",severity:"LOW",status:"PASS",expected_value:"DoS protection on untrust zone",actual_value:"Profile: DoS-Protection-Aggregate applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0093",rule_reference:"sgr-lambda-access",rule_name:"Lambda-VPC-Access",platform:"AWS",validation_category:"CONFIGURATION",validation_check:"SERVERLESS_VPC_ACCESS",check_description:"Validates Lambda VPC access is properly configured",severity:"LOW",status:"PASS",expected_value:"Lambda SG allows required egress",actual_value:"Egress to RDS, ElastiCache, S3 endpoint",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012459"},{validation_id:"VAL-0094",rule_reference:"nsg-function-app",rule_name:"Function-App-VNet-Integration",platform:"Azure",validation_category:"CONFIGURATION",validation_check:"FUNCTION_VNET_INTEGRATION",check_description:"Validates Function App VNet integration rules",severity:"LOW",status:"PASS",expected_value:"Function App subnet allowed to backend",actual_value:"snet-functions-prod can access database and cache",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012460"},{validation_id:"VAL-0095",rule_reference:"gcp-cloud-run",rule_name:"allow-cloud-run-egress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"SERVERLESS_CONNECTOR",check_description:"Validates Serverless VPC Access connector rules",severity:"LOW",status:"PASS",expected_value:"VPC connector subnet has proper access",actual_value:"Connector subnet can reach Cloud SQL, Memorystore",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012461"},{validation_id:"VAL-0096",rule_reference:"pa-globalprotect",rule_name:"GlobalProtect-VPN-Access",platform:"Palo Alto",validation_category:"CONFIGURATION",validation_check:"VPN_ZONE_RULES",check_description:"Validates VPN zone rules are properly configured",severity:"LOW",status:"PASS",expected_value:"VPN zone has appropriate access",actual_value:"Zone VPN to Trust, Database restricted to DBA group",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012349"},{validation_id:"VAL-0097",rule_reference:"sgr-sso-integration",rule_name:"Allow-SSO-Provider",platform:"AWS",validation_category:"SECURITY",validation_check:"SSO_PROVIDER_ACCESS",check_description:"Validates SSO provider access is properly scoped",severity:"LOW",status:"PASS",expected_value:"SSO limited to HTTPS only",actual_value:"Okta access on 443 only",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012395"},{validation_id:"VAL-0098",rule_reference:"nsg-pending-review",rule_name:"New-Partner-Access-Request",platform:"Azure",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting security review - submitted 3 days ago",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Complete security review before implementation",ticket_reference:"CHG0012470"},{validation_id:"VAL-0099",rule_reference:"gcp-pending-firewall",rule_name:"New-API-Access-Rule",platform:"GCP",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting compliance review - HIPAA assessment needed",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Complete HIPAA compliance assessment before approval",ticket_reference:"CHG0012471"},{validation_id:"VAL-0100",rule_reference:"pa-pending-rule",rule_name:"New-Vendor-Integration",platform:"Palo Alto",validation_category:"BEST_PRACTICE",validation_check:"PENDING_APPROVAL",check_description:"Identifies rules pending security review",severity:"MEDIUM",status:"PENDING_REVIEW",expected_value:"Rule approved by security team",actual_value:"Awaiting vendor security questionnaire completion",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Obtain completed vendor security questionnaire before approval",ticket_reference:"CHG0012472"},{validation_id:"VAL-0101",rule_reference:"sgr-exception-approved",rule_name:"Legacy-Protocol-Exception",platform:"AWS",validation_category:"SECURITY",validation_check:"INSECURE_PROTOCOL",check_description:"Validates that insecure protocols are not allowed",severity:"HIGH",status:"EXCEPTION",expected_value:"No unencrypted protocols",actual_value:"FTP (21) allowed for legacy integration",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Legacy system cannot support SFTP - migration planned Q2 2026. Compensating controls: IP whitelist, network segmentation, enhanced logging",remediation:"Migration to SFTP scheduled for CHG0013000",ticket_reference:"EXC-0020"},{validation_id:"VAL-0102",rule_reference:"nsg-wide-open-dev",rule_name:"Dev-Environment-Open",platform:"Azure",validation_category:"SECURITY",validation_check:"DEV_ENVIRONMENT_ISOLATION",check_description:"Validates development environments are properly isolated",severity:"HIGH",status:"FAIL",expected_value:"Dev environment isolated from production",actual_value:"Dev NSG allows traffic to production subnet",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Remove production access from dev environment. Create separate connectivity path if needed.",ticket_reference:null},{validation_id:"VAL-0103",rule_reference:"gcp-prod-dev-mix",rule_name:"allow-dev-to-prod-db",platform:"GCP",validation_category:"SECURITY",validation_check:"ENVIRONMENT_SEPARATION",check_description:"Validates production and non-production are separated",severity:"CRITICAL",status:"FAIL",expected_value:"No cross-environment database access",actual_value:"Development VPC can access production database",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"IMMEDIATE: Remove development to production database access. Use data masking for dev data needs.",ticket_reference:null},{validation_id:"VAL-0104",rule_reference:"pa-backup-traffic",rule_name:"Allow-Backup-Egress",platform:"Palo Alto",validation_category:"COMPLIANCE",validation_check:"BACKUP_ENCRYPTION",check_description:"Validates backup traffic is encrypted",severity:"LOW",status:"PASS",expected_value:"Backup traffic uses encrypted protocols",actual_value:"Application: ssl; Destination: Backup zone",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012415"},{validation_id:"VAL-0105",rule_reference:"sgr-waf-integration",rule_name:"WAF-to-Origin",platform:"AWS",validation_category:"SECURITY",validation_check:"WAF_INTEGRATION",check_description:"Validates WAF is in path for web traffic",severity:"LOW",status:"PASS",expected_value:"Web traffic routes through WAF",actual_value:"ALB has WAF ACL attached, origin only accepts ALB traffic",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012345"},{validation_id:"VAL-0106",rule_reference:"nsg-missing-waf",rule_name:"Direct-Internet-to-Web",platform:"Azure",validation_category:"SECURITY",validation_check:"WAF_INTEGRATION",check_description:"Validates WAF is in path for web traffic",severity:"HIGH",status:"FAIL",expected_value:"Web traffic routes through WAF",actual_value:"Direct internet to VM without WAF",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:"Route traffic through Azure Application Gateway with WAF policy",ticket_reference:null},{validation_id:"VAL-0107",rule_reference:"gcp-cloud-nat",rule_name:"allow-cloud-nat-egress",platform:"GCP",validation_category:"CONFIGURATION",validation_check:"NAT_CONFIGURATION",check_description:"Validates Cloud NAT configuration for egress",severity:"LOW",status:"PASS",expected_value:"Cloud NAT configured for private instances",actual_value:"Cloud NAT enabled for needs-nat tagged instances",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012475"},{validation_id:"VAL-0108",rule_reference:"pa-qos-policy",rule_name:"QoS-Business-Critical",platform:"Palo Alto",validation_category:"PERFORMANCE",validation_check:"QOS_POLICY_ATTACHED",check_description:"Validates QoS policies for critical traffic",severity:"INFO",status:"PASS",expected_value:"QoS for business critical applications",actual_value:"QoS: Business-Critical class applied",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:null},{validation_id:"VAL-0109",rule_reference:"sgr-maintenance-window",rule_name:"Maintenance-Access-Rule",platform:"AWS",validation_category:"EXPIRATION",validation_check:"TIME_BASED_RULE",check_description:"Validates time-based rules have proper scheduling",severity:"LOW",status:"EXCEPTION",expected_value:"Time-based access with auto-disable",actual_value:"Rule active outside maintenance window",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:"Extended maintenance window approved - ticket EXT-0005",remediation:"Rule will auto-disable at end of extended window",ticket_reference:"EXT-0005"},{validation_id:"VAL-0110",rule_reference:"nsg-soc2-audit",rule_name:"SOC2-Audit-Access",platform:"Azure",validation_category:"COMPLIANCE",validation_check:"SOC2_AUDIT_TRAIL",check_description:"Validates audit trail requirements for SOC2",severity:"LOW",status:"PASS",expected_value:"All access logged and auditable",actual_value:"NSG flow logs, Activity logs, Diagnostic settings enabled",validation_timestamp:"2026-01-12T15:00:00Z",exception_reason:null,remediation:null,ticket_reference:"CHG0012480"}],zo={validation_summary:dg,validations:ug},ds=e=>new Promise(s=>setTimeout(s,e)),He={openSSH:/0\.0\.0\.0\/0.*(?:22|ssh)/i,openRDP:/0\.0\.0\.0\/0.*(?:3389|rdp)/i,openDatabase:/0\.0\.0\.0\/0.*(?:3306|5432|1433|27017)/i,anySource:/(?:source|src|cidr).*(?:0\.0\.0\.0\/0|any|\*)/i,insecureProtocol:/(?:telnet|ftp|http[^s])/i,widePortRange:/(?:0-65535|all|any)/i},pg=e=>{const s=[];return e.split(`
`).forEach((r,n)=>{const o=n+1,i=r.trim();i.startsWith("aws ec2")&&(!i.includes("--group-id")&&!i.includes("\\")&&s.push({id:`aws-${o}-1`,line:o,severity:"error",category:"syntax",message:"Missing --group-id parameter",suggestion:"Add --group-id sg-xxxxxxxx to specify the security group"}),i.includes("--cidr 0.0.0.0/0")&&i.includes("--port 22")&&s.push({id:`aws-${o}-2`,line:o,severity:"error",category:"security",message:"SSH port 22 is open to the internet (0.0.0.0/0)",suggestion:"Restrict SSH access to specific IP ranges",ruleId:"SEC-001"})),i.includes("--protocol")&&!i.match(/--protocol\s+(tcp|udp|icmp|-1)/i)&&s.push({id:`aws-${o}-3`,line:o,severity:"warning",category:"syntax",message:"Invalid protocol specified",suggestion:"Use tcp, udp, icmp, or -1 (all)"})}),s},mg=e=>{const s=[];return e.split(`
`).forEach((r,n)=>{const o=n+1,i=r.trim();i.includes("az network nsg rule")&&(!i.includes("--priority")&&!i.includes("\\")&&s.push({id:`azure-${o}-1`,line:o,severity:"warning",category:"syntax",message:"Missing --priority parameter",suggestion:"Add --priority 100-4096 for rule ordering"}),!i.includes("--direction")&&!i.includes("\\")&&s.push({id:`azure-${o}-2`,line:o,severity:"error",category:"syntax",message:"Missing --direction parameter",suggestion:"Add --direction Inbound or Outbound"})),(i.includes('--source-address-prefixes "*"')||i.includes("--source-address-prefixes '*'"))&&s.push({id:`azure-${o}-3`,line:o,severity:"warning",category:"security",message:"Source address is open to all (*)",suggestion:"Restrict to specific IP ranges when possible"})}),s},hg=e=>{const s=[];return e.split(`
`).forEach((r,n)=>{const o=n+1,i=r.trim();i.includes("gcloud compute firewall-rules")&&(!i.includes("--network")&&!i.includes("\\")&&s.push({id:`gcp-${o}-1`,line:o,severity:"error",category:"syntax",message:"Missing --network parameter",suggestion:"Specify the VPC network with --network=<network-name>"}),!i.includes("--direction")&&!i.includes("\\")&&s.push({id:`gcp-${o}-2`,line:o,severity:"warning",category:"syntax",message:"Missing --direction parameter",suggestion:"Add --direction=INGRESS or EGRESS"})),i.includes("--source-ranges=0.0.0.0/0")&&s.push({id:`gcp-${o}-3`,line:o,severity:"warning",category:"security",message:"Source ranges open to all (0.0.0.0/0)",suggestion:"Restrict to specific IP ranges"})}),s},gg=e=>{const s=[];return e.split(`
`).forEach((r,n)=>{const o=n+1,i=r.trim();(i.startsWith("iptables")||i.startsWith("-A"))&&(!i.includes("-j")&&i.length>10&&s.push({id:`ipt-${o}-1`,line:o,severity:"error",category:"syntax",message:"Missing jump target (-j)",suggestion:"Add -j ACCEPT, DROP, or REJECT"}),!i.includes("-A")&&!i.includes("-I")&&!i.includes("-D")&&s.push({id:`ipt-${o}-2`,line:o,severity:"warning",category:"syntax",message:"Missing chain operation",suggestion:"Use -A (append), -I (insert), or -D (delete)"})),i.includes("--dport 22")&&!i.includes("-s ")&&s.push({id:`ipt-${o}-3`,line:o,severity:"error",category:"security",message:"SSH rule without source restriction",suggestion:"Add -s <source-ip> to restrict SSH access"})}),s},xg=e=>{const s=[];return e.split(`
`).forEach((r,n)=>{const o=n+1,i=r.trim();i.startsWith("access-list")&&(!i.includes("extended")&&!i.includes("standard")&&s.push({id:`asa-${o}-1`,line:o,severity:"warning",category:"syntax",message:"Access list type not specified",suggestion:'Use "extended" for IP-based ACLs'}),i.match(/permit|deny/)||s.push({id:`asa-${o}-2`,line:o,severity:"error",category:"syntax",message:"Missing action (permit/deny)",suggestion:"Specify permit or deny action"})),i.includes("permit")&&i.includes("any any")&&s.push({id:`asa-${o}-3`,line:o,severity:"error",category:"security",message:"Rule permits any to any traffic",suggestion:"Restrict source and destination addresses"})}),s},lc=e=>{const s=[];return s.push({id:"sec-ssh-001",name:"SSH Access Restriction",description:"SSH should not be open to 0.0.0.0/0",category:"exposure",status:He.openSSH.test(e)?"fail":"pass",severity:"error",details:He.openSSH.test(e)?"SSH (port 22) is exposed to the internet":void 0}),s.push({id:"sec-rdp-001",name:"RDP Access Restriction",description:"RDP should not be open to 0.0.0.0/0",category:"exposure",status:He.openRDP.test(e)?"fail":"pass",severity:"error",details:He.openRDP.test(e)?"RDP (port 3389) is exposed to the internet":void 0}),s.push({id:"sec-db-001",name:"Database Port Restriction",description:"Database ports should not be publicly accessible",category:"exposure",status:He.openDatabase.test(e)?"fail":"pass",severity:"error",details:He.openDatabase.test(e)?"Database ports exposed to the internet":void 0}),s.push({id:"sec-src-001",name:"Source Address Scope",description:"Avoid using any/0.0.0.0/0 as source when possible",category:"access",status:He.anySource.test(e)?"warning":"pass",severity:"warning",details:He.anySource.test(e)?"Rules with overly permissive source addresses found":void 0}),s.push({id:"sec-proto-001",name:"Secure Protocol Usage",description:"Avoid using insecure protocols like Telnet, FTP",category:"compliance",status:He.insecureProtocol.test(e)?"warning":"pass",severity:"warning",details:He.insecureProtocol.test(e)?"Insecure protocols detected":void 0}),s.push({id:"sec-port-001",name:"Port Range Restriction",description:"Avoid opening all ports (0-65535)",category:"access",status:He.widePortRange.test(e)?"warning":"pass",severity:"warning",details:He.widePortRange.test(e)?"Wide port ranges detected":void 0}),s},fg=(e,s)=>{const a=e.filter(p=>p.category==="syntax"),r=a.filter(p=>p.severity==="error").length,n=a.filter(p=>p.severity==="warning").length,o=Math.max(0,100-r*20-n*5),i=s.filter(p=>p.status==="fail").length,l=s.filter(p=>p.status==="warning").length,c=Math.max(0,100-i*25-l*10),d=e.filter(p=>p.category==="compliance").length,u=Math.max(0,100-d*15);return{syntaxScore:o,securityScore:c,complianceScore:u}},Mu=()=>{const e=new Map;zo.validations.forEach(r=>{const n=r.platform.toLowerCase();e.has(n)||e.set(n,[]),e.get(n).push(r)});const s=[];let a=0;return e.forEach((r,n)=>{const o=r.filter(l=>l.status==="FAIL").length,i=r.filter(l=>l.status==="WARNING").length;s.push({id:`vh-real-${a++}`,timestamp:r[0].validation_timestamp,platform:n,ruleCount:r.length,issueCount:o+i,isValid:o===0,snippet:`${r.length} rules validated for ${n.toUpperCase()}`})}),s};let Bn=Mu();const us={async validateRules(e,s){if(await ds(800),!s.trim())return{isValid:!1,platform:e,issues:[{id:"empty-1",line:1,severity:"error",category:"syntax",message:"No rule content provided",suggestion:"Enter firewall rules to validate"}],syntaxScore:0,securityScore:0,complianceScore:0};let a=[];switch(e){case"aws":a=pg(s);break;case"azure":a=mg(s);break;case"gcp":a=hg(s);break;case"iptables":a=gg(s);break;case"cisco_asa":a=xg(s);break;default:s.length<10&&a.push({id:"gen-1",line:1,severity:"warning",category:"syntax",message:"Rule content appears incomplete"})}const r=lc(s);r.filter(c=>c.status==="fail"||c.status==="warning").forEach((c,d)=>{a.push({id:`sec-${d}`,line:0,severity:c.severity,category:"security",message:c.details||c.description,ruleId:c.id})});const{syntaxScore:n,securityScore:o,complianceScore:i}=fg(a,r),l=a.some(c=>c.severity==="error");return Bn.unshift({id:`vh-${Date.now()}`,timestamp:new Date().toISOString(),platform:e,ruleCount:s.split(`
`).filter(c=>c.trim()&&!c.trim().startsWith("#")&&!c.trim().startsWith("!")).length,issueCount:a.length,isValid:!l,snippet:s.substring(0,50)+"..."}),{isValid:!l,platform:e,issues:a,syntaxScore:n,securityScore:o,complianceScore:i}},async runSecurityAnalysis(e){return await ds(500),lc(e)},async getValidationHistory(){return await ds(300),Bn.slice(0,10)},async clearHistory(){await ds(200),Bn=Mu()},async getPreValidatedRules(){return await ds(300),zo.validations},async getValidationSummary(){return await ds(200),zo.validation_summary}},vg=[{analysis_id:"PATH-0001",analysis_timestamp:"2026-01-13T10:30:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-002 allows TCP/5432 to sg-database-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic to 10.0.0.0/8",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC routing",latency_ms:.2},{hop_number:4,component:"acl-prod-database",component_id:"acl-0a1b2c3d4e5f00003",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/5432 from 10.30.0.0/16",latency_ms:.1},{hop_number:5,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-101 allows TCP/5432 from sg-webapp-prod",latency_ms:.1},{hop_number:6,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Destination reached - PostgreSQL listening on port 5432",latency_ms:.2}]},{analysis_id:"PATH-0002",analysis_timestamp:"2026-01-13T10:31:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Internet",source_ip:"0.0.0.0/0",source_type:"External",source_vpc:null,destination:"webapp-prod-1",destination_ip:"10.30.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:8,path_latency_ms:15.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"cloudflare-edge",component_id:"cf-edge-iad-01",type:"CDN",direction:"Inbound",decision:"FORWARD",details:"Cloudflare edge node - WAF rules passed",latency_ms:5},{hop_number:2,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC via Internet Gateway",latency_ms:2},{hop_number:3,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/443 from 0.0.0.0/0",latency_ms:.1},{hop_number:4,component:"sg-alb-public",component_id:"sg-0a1b2c3d4e5f00005",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows HTTPS from Cloudflare IPs",latency_ms:.1},{hop_number:5,component:"prod-alb",component_id:"arn:aws:elasticloadbalancing:...",type:"Load Balancer",direction:"Forward",decision:"FORWARD",details:"ALB routes to target group tg-webapp-prod",latency_ms:3},{hop_number:6,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:7,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows TCP/8080 from sg-alb-public",latency_ms:.1},{hop_number:8,component:"webapp-prod-1",component_id:"i-0abc123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Destination reached - Application listening on port 8080",latency_ms:5.1}]},{analysis_id:"PATH-0003",analysis_timestamp:"2026-01-13T10:32:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"198.51.100.50",source_type:"External",source_vpc:null,destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"acl-prod-database",blocking_reason:"No route from internet to private database subnet"},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:null},{hop_number:2,component:"rtb-public",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"No direct route to 10.40.0.0/16 from public subnet",latency_ms:null},{hop_number:3,component:"acl-prod-database",component_id:"acl-0a1b2c3d4e5f00003",type:"Network ACL",direction:"Inbound",decision:"BLOCKED",details:"Rule 200 denies all traffic from 0.0.0.0/0 - Database isolated from internet",latency_ms:null}]},{analysis_id:"PATH-0004",analysis_timestamp:"2026-01-13T10:33:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"api-prod-1",source_ip:"10.31.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"api.stripe.com",destination_ip:"52.4.128.0",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:25.3,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-api-gateway",component_id:"sg-0a1b2c3d4e5f00006",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 110 allows TCP/443 outbound",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via nat-0a1b2c3d4e5f00001",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP 54.123.45.67",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"api.stripe.com",component_id:"52.4.128.0",type:"Destination",direction:"N/A",decision:"REACHED",details:"External destination reached via internet",latency_ms:21.8}]},{analysis_id:"PATH-0005",analysis_timestamp:"2026-01-13T10:34:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"dr-postgres-primary",destination_ip:"10.120.1.10",destination_type:"EC2",destination_vpc:"vpc-dr-east-1",protocol:"TCP",port:5432},summary:{total_hops:9,path_latency_ms:12.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows TCP/5432 to 10.120.0.0/16",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.120.0.0/16 via tgw-0a1b2c3d4e5f00001",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-prod",component_id:"tgw-attach-vpc-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic enters Transit Gateway from Production VPC",latency_ms:1},{hop_number:5,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.120.0.0/16 to tgw-attach-vpc-dr",latency_ms:.5},{hop_number:6,component:"tgw-attach-vpc-dr",component_id:"tgw-attach-vpc-dr",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to DR VPC",latency_ms:1},{hop_number:7,component:"acl-dr-database",component_id:"acl-dr-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/5432 from 10.0.0.0/8",latency_ms:.1},{hop_number:8,component:"sg-dr-database",component_id:"sg-dr-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows replication from production",latency_ms:.1},{hop_number:9,component:"dr-postgres-primary",component_id:"i-dr-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"DR database reached for replication",latency_ms:9.4}]},{analysis_id:"PATH-0006",analysis_timestamp:"2026-01-13T10:35:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vpn-user-laptop",source_ip:"10.100.50.25",source_type:"VPN Client",source_vpc:null,destination:"grafana-1",destination_ip:"10.50.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:3e3},summary:{total_hops:8,path_latency_ms:35.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"vpn-endpoint",component_id:"vpn-0abc123def456789",type:"VPN Gateway",direction:"Inbound",decision:"ALLOW",details:"VPN authenticated user - MFA verified",latency_ms:15},{hop_number:2,component:"tgw-attach-vpn-dc",component_id:"tgw-attach-vpn-dc",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"VPN traffic enters via Transit Gateway",latency_ms:2},{hop_number:3,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.50.0.0/24 to tgw-attach-vpc-prod",latency_ms:.5},{hop_number:4,component:"tgw-attach-vpc-prod",component_id:"tgw-attach-vpc-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to Production VPC",latency_ms:1},{hop_number:5,component:"rtb-tgw-subnet",component_id:"rtb-0a1b2c3d4e5f00005",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.50.0.0/24 via local",latency_ms:.2},{hop_number:6,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/3000 from 10.100.0.0/16",latency_ms:.1},{hop_number:7,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows Grafana from VPN",latency_ms:.1},{hop_number:8,component:"grafana-1",component_id:"i-0mon123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Grafana dashboard accessible",latency_ms:16.3}]},{analysis_id:"PATH-0007",analysis_timestamp:"2026-01-13T10:36:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"dev-server-1",source_ip:"10.100.5.10",source_type:"EC2",source_vpc:"vpc-dev-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"tgw-rtb-dev",blocking_reason:"Blackhole route prevents dev-to-prod database access"},hops:[{hop_number:1,component:"sg-dev-server",component_id:"sg-dev-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows all traffic",latency_ms:null},{hop_number:2,component:"rtb-dev-private",component_id:"rtb-dev-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via Transit Gateway",latency_ms:null},{hop_number:3,component:"tgw-attach-vpc-dev",component_id:"tgw-attach-vpc-dev",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic enters Transit Gateway",latency_ms:null},{hop_number:4,component:"tgw-rtb-dev",component_id:"tgw-rtb-dev",type:"Transit Gateway Route Table",direction:"Forward",decision:"BLOCKED",details:"Blackhole route for 10.0.0.0/8 - Dev isolated from production",latency_ms:null},{hop_number:5,component:"N/A",component_id:null,type:"Blackhole",direction:"N/A",decision:"DROPPED",details:"Traffic dropped by blackhole route - Environment isolation enforced",latency_ms:null}]},{analysis_id:"PATH-0008",analysis_timestamp:"2026-01-13T10:37:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"eks-node-1",source_ip:"10.60.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"ECR",destination_ip:"vpce-ecr",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.1,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-eks-nodes",component_id:"sg-0a1b2c3d4e5f00009",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to VPC endpoints",latency_ms:.1},{hop_number:2,component:"acl-eks-nodes",component_id:"acl-0a1b2c3d4e5f00007",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-eks-private",component_id:"rtb-0a1b2c3d4e5f00003",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to ECR endpoint via pl-ecr prefix list",latency_ms:.2},{hop_number:4,component:"vpce-ecr-api",component_id:"vpce-0a1b2c3d4e5f00001",type:"VPC Endpoint",direction:"Forward",decision:"FORWARD",details:"PrivateLink endpoint for ECR API",latency_ms:1.5},{hop_number:5,component:"ECR",component_id:"ecr.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"ECR service reached via PrivateLink",latency_ms:.2}]},{analysis_id:"PATH-0009",analysis_timestamp:"2026-01-13T10:38:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"redis-prod-cluster",destination_ip:"10.35.1.10",destination_type:"ElastiCache",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:6379},summary:{total_hops:5,path_latency_ms:.6,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-003 allows TCP/6379 to sg-redis-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.35.0.0/24 via local",latency_ms:.1},{hop_number:4,component:"sg-redis-prod",component_id:"sg-0a1b2c3d4e5f00003",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-201 allows TCP/6379 from sg-webapp-prod",latency_ms:.1},{hop_number:5,component:"redis-prod-cluster",component_id:"elasticache-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Redis cluster endpoint reached",latency_ms:.2}]},{analysis_id:"PATH-0010",analysis_timestamp:"2026-01-13T10:39:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"on-prem-dc-server",source_ip:"172.16.10.50",source_type:"On-Premises",source_vpc:null,destination:"shared-services-dns",destination_ip:"10.200.1.10",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"UDP",port:53},summary:{total_hops:7,path_latency_ms:18.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"dc-router",component_id:"router-dc-01",type:"On-Premises Router",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via VPN tunnel",latency_ms:1},{hop_number:2,component:"vpn-tunnel-1",component_id:"vpn-tun-0abc123",type:"VPN Tunnel",direction:"Forward",decision:"FORWARD",details:"IPSec tunnel to AWS - encrypted",latency_ms:8},{hop_number:3,component:"vgw-prod",component_id:"vgw-0a1b2c3d4e5f00001",type:"Virtual Private Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters AWS via VPN Gateway",latency_ms:1},{hop_number:4,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 to tgw-attach-vpc-shared",latency_ms:.5},{hop_number:5,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Traffic exits to Shared Services VPC",latency_ms:1},{hop_number:6,component:"sg-shared-dns",component_id:"sg-shared-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound allows UDP/53 from 172.16.0.0/12",latency_ms:.1},{hop_number:7,component:"shared-services-dns",component_id:"i-shared-dns-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"DNS server reached",latency_ms:6.9}]},{analysis_id:"PATH-0011",analysis_timestamp:"2026-01-13T10:40:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vm-webapp-prod-1",source_ip:"10.30.1.20",source_type:"Azure VM",source_vpc:"vnet-prod-eastus",destination:"postgres-flex-server",destination_ip:"10.40.1.20",destination_type:"Azure PostgreSQL",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:5432},summary:{total_hops:6,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"nsg-webapp-prod",component_id:"/subscriptions/.../nsg-webapp-prod",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Rule Allow-SQL-to-Database (priority 110) allows TCP/5432",latency_ms:.1},{hop_number:2,component:"udr-webapp-subnet",component_id:"/subscriptions/.../udr-webapp",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/24 via VNet local routing",latency_ms:.2},{hop_number:3,component:"snet-webapp-prod",component_id:"/subscriptions/.../snet-webapp-prod",type:"Subnet",direction:"Forward",decision:"ROUTE",details:"Subnet routing to database subnet",latency_ms:.1},{hop_number:4,component:"snet-database-prod",component_id:"/subscriptions/.../snet-database-prod",type:"Subnet",direction:"Inbound",decision:"ROUTE",details:"Traffic enters database subnet",latency_ms:.1},{hop_number:5,component:"nsg-database-prod",component_id:"/subscriptions/.../nsg-database-prod",type:"Network Security Group",direction:"Inbound",decision:"ALLOW",details:"Rule Allow-WebApp-to-SQL (priority 100) with ASG reference",latency_ms:.1},{hop_number:6,component:"postgres-flex-server",component_id:"/subscriptions/.../postgres-flex",type:"Destination",direction:"N/A",decision:"REACHED",details:"Azure PostgreSQL Flexible Server reached via private endpoint",latency_ms:.6}]},{analysis_id:"PATH-0012",analysis_timestamp:"2026-01-13T10:41:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vm-webapp-prod-1",source_ip:"10.30.1.20",source_type:"Azure VM",source_vpc:"vnet-prod-eastus",destination:"storage-account-prod",destination_ip:"Storage Service Tag",destination_type:"Azure Storage",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"nsg-webapp-prod",component_id:"/subscriptions/.../nsg-webapp-prod",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Rule Allow-Storage-Outbound (priority 130) allows to Storage service tag",latency_ms:.1},{hop_number:2,component:"udr-webapp-subnet",component_id:"/subscriptions/.../udr-webapp",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to Microsoft.Storage service endpoint",latency_ms:.2},{hop_number:3,component:"snet-webapp-prod-service-endpoint",component_id:"Microsoft.Storage",type:"Service Endpoint",direction:"Forward",decision:"FORWARD",details:"Service endpoint for Azure Storage - traffic stays on Azure backbone",latency_ms:.5},{hop_number:4,component:"storage-firewall",component_id:"storage-acl-prod",type:"Storage Firewall",direction:"Inbound",decision:"ALLOW",details:"Storage firewall allows access from snet-webapp-prod",latency_ms:.2},{hop_number:5,component:"storage-account-prod",component_id:"/subscriptions/.../storageAccounts/prodsa001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Azure Storage account reached via service endpoint",latency_ms:1.5}]},{analysis_id:"PATH-0013",analysis_timestamp:"2026-01-13T10:42:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"aks-pod-webapp",source_ip:"10.60.5.25",source_type:"AKS Pod",source_vpc:"vnet-prod-eastus",destination:"key-vault-prod",destination_ip:"10.50.1.5",destination_type:"Azure Key Vault",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:443},summary:{total_hops:6,path_latency_ms:3.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"aks-network-policy",component_id:"netpol-webapp-egress",type:"Network Policy",direction:"Outbound",decision:"ALLOW",details:"Kubernetes NetworkPolicy allows egress to Key Vault CIDR",latency_ms:.1},{hop_number:2,component:"nsg-aks-nodes",component_id:"/subscriptions/.../nsg-aks-nodes",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound to AzureKeyVault service tag allowed",latency_ms:.1},{hop_number:3,component:"udr-aks-subnet",component_id:"/subscriptions/.../udr-aks",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to Key Vault private endpoint",latency_ms:.2},{hop_number:4,component:"pep-keyvault-prod",component_id:"/subscriptions/.../privateEndpoints/pep-kv",type:"Private Endpoint",direction:"Forward",decision:"FORWARD",details:"Traffic routed via Private Endpoint",latency_ms:1},{hop_number:5,component:"kv-firewall",component_id:"key-vault-firewall",type:"Key Vault Firewall",direction:"Inbound",decision:"ALLOW",details:"Key Vault allows access from private endpoint",latency_ms:.3},{hop_number:6,component:"key-vault-prod",component_id:"/subscriptions/.../vaults/kv-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Key Vault reached via private endpoint",latency_ms:1.5}]},{analysis_id:"PATH-0014",analysis_timestamp:"2026-01-13T10:43:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"vm-dev-server",source_ip:"10.100.5.20",source_type:"Azure VM",source_vpc:"vnet-dev-eastus",destination:"vm-webapp-prod-1",destination_ip:"10.30.1.20",destination_type:"Azure VM",destination_vpc:"vnet-prod-eastus",protocol:"TCP",port:22},summary:{total_hops:4,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"azfw-prod-hub",blocking_reason:"Azure Firewall blocks dev-to-prod SSH access"},hops:[{hop_number:1,component:"nsg-dev-server",component_id:"/subscriptions/.../nsg-dev",type:"Network Security Group",direction:"Outbound",decision:"ALLOW",details:"Default outbound allow",latency_ms:null},{hop_number:2,component:"udr-dev-subnet",component_id:"/subscriptions/.../udr-dev",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.0.0.0/8 via Azure Firewall",latency_ms:null},{hop_number:3,component:"azfw-prod-hub",component_id:"/subscriptions/.../azfw-prod-hub",type:"Azure Firewall",direction:"Forward",decision:"BLOCKED",details:"Network rule collection rc-deny-dev-prod blocks dev-to-prod access",latency_ms:null},{hop_number:4,component:"N/A",component_id:null,type:"Firewall Block",direction:"N/A",decision:"DROPPED",details:"Traffic dropped by Azure Firewall - Environment isolation",latency_ms:null}]},{analysis_id:"PATH-0015",analysis_timestamp:"2026-01-13T10:44:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gce-webapp-1",source_ip:"10.30.1.30",source_type:"GCE Instance",source_vpc:"vpc-production",destination:"cloudsql-postgres",destination_ip:"10.40.1.30",destination_type:"Cloud SQL",destination_vpc:"vpc-production",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-db-from-app-postgres",component_id:"projects/.../firewalls/allow-db-from-app-postgres",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress allowed - no explicit deny rule",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/default-route",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to Cloud SQL private IP via VPC peering",latency_ms:.2},{hop_number:3,component:"servicenetworking-peering",component_id:"servicenetworking-googleapis-com",type:"VPC Peering",direction:"Forward",decision:"FORWARD",details:"Traffic enters Google-managed VPC for Cloud SQL",latency_ms:.5},{hop_number:4,component:"allow-db-from-app-postgres",component_id:"projects/.../firewalls/allow-db-from-app-postgres",type:"GCP Firewall Rule",direction:"Ingress",decision:"ALLOW",details:"Source tag app-server matches, TCP/5432 allowed",latency_ms:.1},{hop_number:5,component:"cloudsql-postgres",component_id:"projects/.../instances/cloudsql-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Cloud SQL instance reached via private IP",latency_ms:.6}]},{analysis_id:"PATH-0016",analysis_timestamp:"2026-01-13T10:45:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gke-node-1",source_ip:"10.60.1.30",source_type:"GKE Node",source_vpc:"vpc-production",destination:"gcr.io",destination_ip:"199.36.153.4",destination_type:"Google Container Registry",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:5.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-gke-egress",component_id:"projects/.../firewalls/allow-gke-egress",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress to Google APIs allowed",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/default-internet-gateway",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to private.googleapis.com via Private Google Access",latency_ms:.2},{hop_number:3,component:"private-google-access",component_id:"private.googleapis.com",type:"Private Google Access",direction:"Forward",decision:"FORWARD",details:"Traffic routed to Google APIs without public IP",latency_ms:2},{hop_number:4,component:"cloud-nat",component_id:"projects/.../routers/cloud-nat-prod",type:"Cloud NAT",direction:"Forward",decision:"NAT",details:"Cloud NAT not needed - using Private Google Access",latency_ms:0},{hop_number:5,component:"gcr.io",component_id:"gcr.io",type:"Destination",direction:"N/A",decision:"REACHED",details:"Google Container Registry reached via Private Google Access",latency_ms:2.9}]},{analysis_id:"PATH-0017",analysis_timestamp:"2026-01-13T10:46:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"gce-webapp-1",source_ip:"10.30.1.30",source_type:"GCE Instance",source_vpc:"vpc-production",destination:"memorystore-redis",destination_ip:"10.35.1.30",destination_type:"Memorystore",destination_vpc:"vpc-production",protocol:"TCP",port:6379},summary:{total_hops:4,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"allow-redis-from-app",component_id:"projects/.../firewalls/allow-redis-from-app",type:"GCP Firewall Rule",direction:"Egress",decision:"ALLOW",details:"Egress allowed - implicit allow",latency_ms:.1},{hop_number:2,component:"vpc-production-routing",component_id:"projects/.../routes/peering-memorystore",type:"VPC Route",direction:"Forward",decision:"ROUTE",details:"Route to Memorystore via VPC peering",latency_ms:.2},{hop_number:3,component:"allow-redis-from-app",component_id:"projects/.../firewalls/allow-redis-from-app",type:"GCP Firewall Rule",direction:"Ingress",decision:"ALLOW",details:"Source tags app-server,web-server match, TCP/6379 allowed",latency_ms:.1},{hop_number:4,component:"memorystore-redis",component_id:"projects/.../instances/redis-prod",type:"Destination",direction:"N/A",decision:"REACHED",details:"Memorystore Redis instance reached",latency_ms:.4}]},{analysis_id:"PATH-0018",analysis_timestamp:"2026-01-13T10:47:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"198.51.100.100",source_type:"External",source_vpc:null,destination:"gce-webapp-1",destination_ip:"10.30.1.30",destination_type:"GCE Instance",destination_vpc:"vpc-production",protocol:"TCP",port:22},summary:{total_hops:2,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"deny-ssh-public",blocking_reason:"SSH from internet blocked - use IAP instead"},hops:[{hop_number:1,component:"cloud-armor",component_id:"projects/.../securityPolicies/web-protection",type:"Cloud Armor",direction:"Inbound",decision:"ALLOW",details:"Cloud Armor not blocking this IP",latency_ms:null},{hop_number:2,component:"deny-ssh-public",component_id:"projects/.../firewalls/deny-ssh-public",type:"GCP Firewall Rule",direction:"Ingress",decision:"BLOCKED",details:"Priority 2000 deny rule blocks TCP/22 from 0.0.0.0/0",latency_ms:null}]},{analysis_id:"PATH-0019",analysis_timestamp:"2026-01-13T10:48:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Untrust-Zone",source_ip:"203.0.113.50",source_type:"External",source_vpc:null,destination:"webapp-prod-1-pa",destination_ip:"10.30.1.40",destination_type:"Server",destination_vpc:"DMZ",protocol:"TCP",port:443},summary:{total_hops:6,path_latency_ms:8.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"pa-external-interface",component_id:"ethernet1/1",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters Untrust zone",latency_ms:.5},{hop_number:2,component:"Block-Malicious-IPs-Inbound",component_id:"rule-50",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Source IP not in EDL-Malicious-IPs",latency_ms:.2},{hop_number:3,component:"Allow-API-Gateway-Inbound",component_id:"rule-1",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: Untrust->DMZ, ssl app, AG-Web-Servers dest",latency_ms:.3},{hop_number:4,component:"Web-Protection-Profile",component_id:"profile-group-web",type:"Security Profile",direction:"Forward",decision:"ALLOW",details:"AV: Clean, AS: Clean, VP: No vulnerabilities, URL: Allowed",latency_ms:2},{hop_number:5,component:"pa-dmz-interface",component_id:"ethernet1/3",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to DMZ zone",latency_ms:.5},{hop_number:6,component:"webapp-prod-1-pa",component_id:"10.30.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"Web server in DMZ reached",latency_ms:5}]},{analysis_id:"PATH-0020",analysis_timestamp:"2026-01-13T10:49:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"app-server-1-pa",source_ip:"10.31.1.40",source_type:"Server",source_vpc:"Application",destination:"db-server-1-pa",destination_ip:"10.40.1.40",destination_type:"Server",destination_vpc:"Database",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"pa-app-interface",component_id:"ethernet1/8",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters from Application zone",latency_ms:.1},{hop_number:2,component:"Allow-App-to-DB-Postgres",component_id:"rule-3",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: Application->Database, postgres app, AG-Database-Servers dest",latency_ms:.2},{hop_number:3,component:"Database-Protection-Profile",component_id:"profile-group-db",type:"Security Profile",direction:"Forward",decision:"ALLOW",details:"AV: Clean, AS: Clean, VP: No SQL injection detected",latency_ms:.3},{hop_number:4,component:"pa-db-interface",component_id:"ethernet1/10",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to Database zone",latency_ms:.1},{hop_number:5,component:"db-server-1-pa",component_id:"10.40.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"PostgreSQL server reached",latency_ms:.5}]},{analysis_id:"PATH-0021",analysis_timestamp:"2026-01-13T10:50:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Untrust-Zone",source_ip:"185.220.101.50",source_type:"Tor Exit Node",source_vpc:null,destination:"webapp-prod-1-pa",destination_ip:"10.30.1.40",destination_type:"Server",destination_vpc:"DMZ",protocol:"TCP",port:443},summary:{total_hops:2,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"Block-Tor-Exit-Nodes",blocking_reason:"Source IP in Tor Exit Node EDL - blocked by security policy"},hops:[{hop_number:1,component:"pa-external-interface",component_id:"ethernet1/1",type:"Palo Alto Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters Untrust zone",latency_ms:null},{hop_number:2,component:"Block-Tor-Exit-Nodes",component_id:"rule-51",type:"Palo Alto Security Rule",direction:"Forward",decision:"BLOCKED",details:"Source 185.220.101.50 matches EDL-Tor-Exit-Nodes - DENY action",latency_ms:null}]},{analysis_id:"PATH-0022",analysis_timestamp:"2026-01-13T10:51:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vpn-user-pa",source_ip:"10.100.50.60",source_type:"VPN User",source_vpc:"VPN",destination:"grafana-pa",destination_ip:"10.50.1.40",destination_type:"Server",destination_vpc:"Trust",protocol:"TCP",port:3e3},summary:{total_hops:5,path_latency_ms:2.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"globalprotect-gateway",component_id:"gp-gateway-1",type:"GlobalProtect Gateway",direction:"Inbound",decision:"ALLOW",details:"VPN user authenticated - MFA verified",latency_ms:.5},{hop_number:2,component:"pa-vpn-interface",component_id:"tunnel.1",type:"Palo Alto Tunnel Interface",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPN zone",latency_ms:.2},{hop_number:3,component:"Allow-Grafana-VPN",component_id:"rule-10",type:"Palo Alto Security Rule",direction:"Forward",decision:"ALLOW",details:"Rule matches: VPN->Trust, web-browsing app, AG-Monitoring-Servers dest",latency_ms:.3},{hop_number:4,component:"pa-trust-interface",component_id:"ethernet1/5",type:"Palo Alto Interface",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to Trust zone",latency_ms:.2},{hop_number:5,component:"grafana-pa",component_id:"10.50.1.40",type:"Destination",direction:"N/A",decision:"REACHED",details:"Grafana server reached via VPN",latency_ms:1.3}]},{analysis_id:"PATH-0023",analysis_timestamp:"2026-01-13T10:52:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"kafka-broker-1",destination_ip:"10.36.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9092},summary:{total_hops:5,path_latency_ms:.9,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-004 allows TCP/9092 to sg-kafka-prod",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.36.0.0/24 via local VPC routing",latency_ms:.2},{hop_number:4,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-301 allows TCP/9092 from sg-webapp-prod",latency_ms:.1},{hop_number:5,component:"kafka-broker-1",component_id:"i-0kf123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Kafka broker reached - topic access granted",latency_ms:.4}]},{analysis_id:"PATH-0024",analysis_timestamp:"2026-01-13T10:53:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"prometheus-1",source_ip:"10.50.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"webapp-prod-1",destination_ip:"10.30.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9100},summary:{total_hops:5,path_latency_ms:.7,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-701 allows TCP/9100 to 10.0.0.0/8",latency_ms:.1},{hop_number:2,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic to VirtualNetwork",latency_ms:.1},{hop_number:3,component:"rtb-monitoring",component_id:"rtb-0a1b2c3d4e5f00006",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.30.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-005 allows TCP/9100 from sg-monitoring",latency_ms:.1},{hop_number:5,component:"webapp-prod-1",component_id:"i-0abc123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Node exporter metrics endpoint accessible",latency_ms:.2}]},{analysis_id:"PATH-0025",analysis_timestamp:"2026-01-13T10:54:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"jenkins-master",source_ip:"10.70.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"github.com",destination_ip:"140.82.112.4",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:45.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-jenkins",component_id:"sg-0a1b2c3d4e5f00011",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1001 allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-cicd",component_id:"acl-0a1b2c3d4e5f00008",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:3,component:"rtb-cicd",component_id:"rtb-0a1b2c3d4e5f00008",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via nat-0a1b2c3d4e5f00002",latency_ms:.2},{hop_number:4,component:"nat-prod-1b",component_id:"nat-0a1b2c3d4e5f00002",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP 54.123.45.68",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"github.com",component_id:"140.82.112.4",type:"Destination",direction:"N/A",decision:"REACHED",details:"GitHub API accessible",latency_ms:41.7}]},{analysis_id:"PATH-0026",analysis_timestamp:"2026-01-13T10:55:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vault-1",source_ip:"10.90.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"DynamoDB",destination_ip:"vpce-dynamodb",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1202 allows HTTPS to pl-dynamodb",latency_ms:.1},{hop_number:2,component:"acl-vault",component_id:"acl-0a1b2c3d4e5f00009",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-vault",component_id:"rtb-0a1b2c3d4e5f00009",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to DynamoDB endpoint via pl-dynamodb prefix list",latency_ms:.2},{hop_number:4,component:"vpce-dynamodb",component_id:"vpce-0a1b2c3d4e5f00002",type:"VPC Gateway Endpoint",direction:"Forward",decision:"FORWARD",details:"Gateway endpoint for DynamoDB",latency_ms:1.5},{hop_number:5,component:"DynamoDB",component_id:"dynamodb.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"DynamoDB service reached via gateway endpoint",latency_ms:.9}]},{analysis_id:"PATH-0027",analysis_timestamp:"2026-01-13T10:56:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"splunk-indexer-1",source_ip:"10.80.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"S3",destination_ip:"vpce-s3",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:3.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1101 allows HTTPS to pl-63a5400a (S3)",latency_ms:.1},{hop_number:2,component:"acl-splunk",component_id:"acl-0a1b2c3d4e5f00010",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all traffic",latency_ms:.1},{hop_number:3,component:"rtb-splunk",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to S3 endpoint via pl-63a5400a prefix list",latency_ms:.2},{hop_number:4,component:"vpce-s3",component_id:"vpce-0a1b2c3d4e5f00003",type:"VPC Gateway Endpoint",direction:"Forward",decision:"FORWARD",details:"Gateway endpoint for S3",latency_ms:2},{hop_number:5,component:"S3",component_id:"s3.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"S3 service reached for log archival",latency_ms:1.1}]},{analysis_id:"PATH-0028",analysis_timestamp:"2026-01-13T10:57:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"prod-west-webapp",source_ip:"10.130.1.10",source_type:"EC2",source_vpc:"vpc-prod-west-2",destination:"shared-services-dns",destination_ip:"10.200.1.10",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"UDP",port:53},summary:{total_hops:10,path_latency_ms:65.5,path_status:"REACHABLE",bottlenecks:["Cross-region latency: 55ms"]},hops:[{hop_number:1,component:"sg-webapp-west",component_id:"sg-west-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows UDP/53",latency_ms:.1},{hop_number:2,component:"acl-prod-west",component_id:"acl-west-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal",latency_ms:.1},{hop_number:3,component:"rtb-prod-west",component_id:"rtb-west-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via tgw-west",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-prod-west",component_id:"tgw-attach-west-prod",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Enters West region TGW",latency_ms:1},{hop_number:5,component:"tgw-rtb-west",component_id:"tgw-rtb-west",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via cross-region peering",latency_ms:.5},{hop_number:6,component:"tgw-peer-west-east",component_id:"tgw-peer-east-west",type:"Transit Gateway Peering",direction:"Forward",decision:"FORWARD",details:"Cross-region peering us-west-2 to us-east-1",latency_ms:55},{hop_number:7,component:"tgw-rtb-prod",component_id:"tgw-rtb-prod",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 to shared services",latency_ms:.5},{hop_number:8,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Exits to Shared Services VPC",latency_ms:1},{hop_number:9,component:"sg-shared-dns",component_id:"sg-shared-0a1b2c3d4e5f00001",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows UDP/53 from 10.0.0.0/8",latency_ms:.1},{hop_number:10,component:"shared-services-dns",component_id:"i-shared-dns-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"DNS server reached via cross-region path",latency_ms:7}]},{analysis_id:"PATH-0029",analysis_timestamp:"2026-01-13T10:58:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"analytics-1",source_ip:"10.95.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"es-data-1",destination_ip:"10.85.1.20",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9200},summary:{total_hops:5,path_latency_ms:1.1,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-analytics-prod",component_id:"sg-0a1b2c3d4e5f00015",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1404 allows TCP/9200 to sg-elasticsearch",latency_ms:.1},{hop_number:2,component:"acl-analytics",component_id:"acl-0a1b2c3d4e5f00011",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-analytics",component_id:"rtb-0a1b2c3d4e5f00011",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.85.0.0/24 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule allows TCP/9200 from analytics SG",latency_ms:.1},{hop_number:5,component:"es-data-1",component_id:"i-0es123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Elasticsearch data node reached",latency_ms:.6}]},{analysis_id:"PATH-0030",analysis_timestamp:"2026-01-13T10:59:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"cryptomining-pool.io",destination_ip:"203.0.113.200",destination_type:"External",destination_vpc:null,protocol:"TCP",port:3333},summary:{total_hops:4,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"Block-Crypto-Mining-PA",blocking_reason:"Destination in crypto mining EDL - blocked by Palo Alto"},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"No specific deny for this port",latency_ms:null},{hop_number:2,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to internet via Palo Alto firewall",latency_ms:null},{hop_number:3,component:"pa-fw-prod-01",component_id:"pa-fw-prod-01",type:"Palo Alto Firewall",direction:"Forward",decision:"INSPECT",details:"Traffic enters firewall for inspection",latency_ms:null},{hop_number:4,component:"Block-Crypto-Mining",component_id:"rule-52",type:"Palo Alto Security Rule",direction:"Forward",decision:"BLOCKED",details:"Destination 203.0.113.200 matches EDL-Crypto-Mining-Pools - DENY action with alert",latency_ms:null}]},{analysis_id:"PATH-0031",analysis_timestamp:"2026-01-13T11:00:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"pci-webapp-1",source_ip:"10.150.1.10",source_type:"EC2",source_vpc:"vpc-pci-east-1",destination:"shared-services-vault",destination_ip:"10.200.1.50",destination_type:"EC2",destination_vpc:"vpc-shared-east-1",protocol:"TCP",port:8200},summary:{total_hops:8,path_latency_ms:4.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-pci-webapp",component_id:"sg-pci-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows TCP/8200 to shared services",latency_ms:.1},{hop_number:2,component:"acl-pci-app",component_id:"acl-pci-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows traffic to 10.200.0.0/16",latency_ms:.1},{hop_number:3,component:"rtb-pci-private",component_id:"rtb-pci-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.200.0.0/16 via Transit Gateway",latency_ms:.2},{hop_number:4,component:"tgw-attach-vpc-pci",component_id:"tgw-attach-vpc-pci",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Enters TGW from PCI VPC",latency_ms:1},{hop_number:5,component:"tgw-rtb-isolated",component_id:"tgw-rtb-isolated",type:"Transit Gateway Route Table",direction:"Forward",decision:"ROUTE",details:"Isolated route table - only shared services allowed",latency_ms:.5},{hop_number:6,component:"tgw-attach-vpc-shared",component_id:"tgw-attach-vpc-shared",type:"Transit Gateway Attachment",direction:"Forward",decision:"ROUTE",details:"Exits to Shared Services VPC",latency_ms:1},{hop_number:7,component:"sg-shared-vault",component_id:"sg-shared-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows TCP/8200 from PCI VPC CIDR",latency_ms:.1},{hop_number:8,component:"shared-services-vault",component_id:"i-shared-vault-001",type:"Destination",direction:"N/A",decision:"REACHED",details:"Vault server reached for secrets retrieval",latency_ms:1.5}]},{analysis_id:"PATH-0032",analysis_timestamp:"2026-01-13T11:01:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"api-prod-1",source_ip:"10.31.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"okta.com",destination_ip:"54.201.45.67",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:35.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-api-gateway",component_id:"sg-0a1b2c3d4e5f00006",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 110 allows TCP/443 outbound",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via NAT Gateway",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"okta.com",component_id:"54.201.45.67",type:"Destination",direction:"N/A",decision:"REACHED",details:"Okta SSO endpoint reached for authentication",latency_ms:32.3}]},{analysis_id:"PATH-0033",analysis_timestamp:"2026-01-13T11:02:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"bastion-prod",source_ip:"10.20.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:22},summary:{total_hops:5,path_latency_ms:.8,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-bastion",component_id:"sg-0a1b2c3d4e5f00007",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-601 allows SSH to 10.0.0.0/8",latency_ms:.1},{hop_number:2,component:"acl-bastion",component_id:"acl-0a1b2c3d4e5f00012",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-bastion",component_id:"rtb-0a1b2c3d4e5f00012",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-104 allows SSH from sg-bastion",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Database server SSH accessible from bastion",latency_ms:.3}]},{analysis_id:"PATH-0034",analysis_timestamp:"2026-01-13T11:03:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"eks-node-1",source_ip:"10.60.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"eks-control-plane",destination_ip:"10.60.0.5",destination_type:"EKS API",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:4,path_latency_ms:1.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-eks-nodes",component_id:"sg-0a1b2c3d4e5f00009",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-804 allows TCP/443 to sg-eks-control",latency_ms:.1},{hop_number:2,component:"rtb-eks-private",component_id:"rtb-0a1b2c3d4e5f00003",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to EKS control plane ENI",latency_ms:.2},{hop_number:3,component:"sg-eks-control",component_id:"sg-0a1b2c3d4e5f00010",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-902 allows TCP/443 from sg-eks-nodes",latency_ms:.1},{hop_number:4,component:"eks-control-plane",component_id:"arn:aws:eks:...",type:"Destination",direction:"N/A",decision:"REACHED",details:"EKS API server reached for kubelet communication",latency_ms:.8}]},{analysis_id:"PATH-0035",analysis_timestamp:"2026-01-13T11:04:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"kafka-broker-1",source_ip:"10.36.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"kafka-broker-2",destination_ip:"10.36.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9093},summary:{total_hops:4,path_latency_ms:.4,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-303 allows TCP/9093 to sg-kafka-prod (self)",latency_ms:.1},{hop_number:2,component:"rtb-kafka",component_id:"rtb-0a1b2c3d4e5f00004",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Kafka subnet",latency_ms:.1},{hop_number:3,component:"sg-kafka-prod",component_id:"sg-0a1b2c3d4e5f00004",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-306 allows TCP/9093 from sg-kafka-prod (self)",latency_ms:.1},{hop_number:4,component:"kafka-broker-2",component_id:"i-0kf123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Kafka inter-broker replication successful",latency_ms:.1}]},{analysis_id:"PATH-0036",analysis_timestamp:"2026-01-13T11:05:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"Internet-GitHub",source_ip:"140.82.112.10",source_type:"GitHub Webhook",source_vpc:null,destination:"jenkins-master",destination_ip:"10.70.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:18.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:2},{hop_number:2,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows TCP/443",latency_ms:.1},{hop_number:3,component:"sg-alb-jenkins",component_id:"sg-0a1b2c3d4e5f00016",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Allows HTTPS from GitHub IP range 140.82.112.0/20",latency_ms:.1},{hop_number:4,component:"alb-jenkins",component_id:"arn:aws:elasticloadbalancing:...",type:"Load Balancer",direction:"Forward",decision:"FORWARD",details:"ALB routes to Jenkins target group",latency_ms:3},{hop_number:5,component:"acl-cicd",component_id:"acl-0a1b2c3d4e5f00008",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"Rule 100 allows from ALB subnet",latency_ms:.1},{hop_number:6,component:"sg-jenkins",component_id:"sg-0a1b2c3d4e5f00011",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1003 allows HTTPS from GitHub",latency_ms:.1},{hop_number:7,component:"jenkins-master",component_id:"i-0jen123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Jenkins webhook endpoint accessible",latency_ms:13.1}]},{analysis_id:"PATH-0037",analysis_timestamp:"2026-01-13T11:06:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"vault-1",source_ip:"10.90.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"vault-2",destination_ip:"10.90.1.11",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:8201},summary:{total_hops:4,path_latency_ms:.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1201 allows TCP/8201 to sg-vault (self)",latency_ms:.1},{hop_number:2,component:"rtb-vault",component_id:"rtb-0a1b2c3d4e5f00009",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Vault subnet",latency_ms:.1},{hop_number:3,component:"sg-vault",component_id:"sg-0a1b2c3d4e5f00013",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1202 allows TCP/8201 from sg-vault (self)",latency_ms:.1},{hop_number:4,component:"vault-2",component_id:"i-0vlt123def456789b",type:"Destination",direction:"N/A",decision:"REACHED",details:"Vault HA cluster communication successful",latency_ms:.2}]},{analysis_id:"PATH-0038",analysis_timestamp:"2026-01-13T11:07:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"unknown-server",destination_ip:"192.168.1.100",destination_type:"Unknown",destination_vpc:null,protocol:"TCP",port:22},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"rtb-private-app",blocking_reason:"No route to RFC1918 address - destination unreachable"},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Default outbound allows this traffic",latency_ms:null},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal",latency_ms:null},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"BLOCKED",details:"No route to 192.168.0.0/16 - destination not in VPC CIDR or TGW routes",latency_ms:null}]},{analysis_id:"PATH-0039",analysis_timestamp:"2026-01-13T11:08:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"es-data-1",source_ip:"10.85.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"es-data-2",destination_ip:"10.85.1.21",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9300},summary:{total_hops:4,path_latency_ms:.4,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1301 allows TCP/9300 to sg-elasticsearch (self)",latency_ms:.1},{hop_number:2,component:"rtb-elasticsearch",component_id:"rtb-0a1b2c3d4e5f00013",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within ES subnet",latency_ms:.1},{hop_number:3,component:"sg-elasticsearch",component_id:"sg-0a1b2c3d4e5f00014",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1303 allows TCP/9300 from sg-elasticsearch (self)",latency_ms:.1},{hop_number:4,component:"es-data-2",component_id:"i-0es123def456789c",type:"Destination",direction:"N/A",decision:"REACHED",details:"Elasticsearch transport layer communication successful",latency_ms:.1}]},{analysis_id:"PATH-0040",analysis_timestamp:"2026-01-13T11:09:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"alertmanager-1",source_ip:"10.50.1.12",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"api.pagerduty.com",destination_ip:"52.206.43.0",destination_type:"External",destination_vpc:null,protocol:"TCP",port:443},summary:{total_hops:7,path_latency_ms:28.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-monitoring",component_id:"sg-0a1b2c3d4e5f00008",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-702 allows HTTPS to 0.0.0.0/0",latency_ms:.1},{hop_number:2,component:"acl-monitoring",component_id:"acl-0a1b2c3d4e5f00006",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:3,component:"rtb-monitoring",component_id:"rtb-0a1b2c3d4e5f00006",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 0.0.0.0/0 via NAT Gateway",latency_ms:.2},{hop_number:4,component:"nat-prod-1a",component_id:"nat-0a1b2c3d4e5f00001",type:"NAT Gateway",direction:"Forward",decision:"NAT",details:"SNAT to elastic IP",latency_ms:1},{hop_number:5,component:"acl-prod-public",component_id:"acl-0a1b2c3d4e5f00001",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all outbound",latency_ms:.1},{hop_number:6,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Outbound",decision:"ROUTE",details:"Traffic exits to internet",latency_ms:2},{hop_number:7,component:"api.pagerduty.com",component_id:"52.206.43.0",type:"Destination",direction:"N/A",decision:"REACHED",details:"PagerDuty API accessible for alert notifications",latency_ms:25}]},{analysis_id:"PATH-0041",analysis_timestamp:"2026-01-13T11:10:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"jupyter-hub",source_ip:"10.95.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:.9,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-analytics-prod",component_id:"sg-0a1b2c3d4e5f00015",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1401 allows TCP/5432 to sg-database-prod",latency_ms:.1},{hop_number:2,component:"acl-analytics",component_id:"acl-0a1b2c3d4e5f00011",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-analytics",component_id:"rtb-0a1b2c3d4e5f00011",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.2},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-103 allows TCP/5432 from sg-analytics-prod",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Database accessible for analytics queries",latency_ms:.4}]},{analysis_id:"PATH-0042",analysis_timestamp:"2026-01-13T11:11:00Z",status:"COMPLETED",result:"BLOCKED",input:{source:"Internet",source_ip:"203.0.113.100",source_type:"External",source_vpc:null,destination:"bastion-prod",destination_ip:"10.20.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:22},summary:{total_hops:3,path_latency_ms:null,path_status:"BLOCKED",blocking_component:"sg-bastion",blocking_reason:"Source IP not in allowed VPN or emergency IP list"},hops:[{hop_number:1,component:"igw-prod",component_id:"igw-0a1b2c3d4e5f00001",type:"Internet Gateway",direction:"Inbound",decision:"ROUTE",details:"Traffic enters VPC",latency_ms:null},{hop_number:2,component:"acl-bastion",component_id:"acl-0a1b2c3d4e5f00012",type:"Network ACL",direction:"Inbound",decision:"ALLOW",details:"NACL allows for evaluation",latency_ms:null},{hop_number:3,component:"sg-bastion",component_id:"sg-0a1b2c3d4e5f00007",type:"Security Group",direction:"Inbound",decision:"BLOCKED",details:"No rule allows SSH from 203.0.113.100 - only VPN (10.100.0.0/16) and emergency IP (203.0.113.50/32) allowed",latency_ms:null}]},{analysis_id:"PATH-0043",analysis_timestamp:"2026-01-13T11:12:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"splunk-search-1",source_ip:"10.80.1.20",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"splunk-indexer-1",destination_ip:"10.80.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:9997},summary:{total_hops:4,path_latency_ms:.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound rule sgr-out-1102 allows TCP/9997 to sg-splunk (self)",latency_ms:.1},{hop_number:2,component:"rtb-splunk",component_id:"rtb-0a1b2c3d4e5f00010",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Local route within Splunk subnet",latency_ms:.1},{hop_number:3,component:"sg-splunk",component_id:"sg-0a1b2c3d4e5f00012",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound rule sgr-in-1103 allows TCP/9997 from sg-splunk (self)",latency_ms:.1},{hop_number:4,component:"splunk-indexer-1",component_id:"i-0spl123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Splunk search head to indexer communication successful",latency_ms:.2}]},{analysis_id:"PATH-0044",analysis_timestamp:"2026-01-13T11:13:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"webapp-prod-1",source_ip:"10.30.1.10",source_type:"EC2",source_vpc:"vpc-prod-east-1",destination:"sqs-orders-queue",destination_ip:"vpce-sqs",destination_type:"VPC Endpoint",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:443},summary:{total_hops:5,path_latency_ms:2.2,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-webapp-prod",component_id:"sg-0a1b2c3d4e5f00001",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Outbound allows HTTPS to VPC endpoints",latency_ms:.1},{hop_number:2,component:"acl-prod-private",component_id:"acl-0a1b2c3d4e5f00002",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-private-app",component_id:"rtb-0a1b2c3d4e5f00001",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route to SQS endpoint via local ENI",latency_ms:.2},{hop_number:4,component:"vpce-sqs",component_id:"vpce-0a1b2c3d4e5f00004",type:"VPC Interface Endpoint",direction:"Forward",decision:"FORWARD",details:"PrivateLink endpoint for SQS",latency_ms:1.5},{hop_number:5,component:"SQS",component_id:"sqs.us-east-1.amazonaws.com",type:"Destination",direction:"N/A",decision:"REACHED",details:"SQS service reached via PrivateLink",latency_ms:.3}]},{analysis_id:"PATH-0045",analysis_timestamp:"2026-01-13T11:14:00Z",status:"COMPLETED",result:"SUCCESS",input:{source:"lambda-order-processor",source_ip:"10.65.1.50",source_type:"Lambda",source_vpc:"vpc-prod-east-1",destination:"postgres-primary",destination_ip:"10.40.1.10",destination_type:"EC2",destination_vpc:"vpc-prod-east-1",protocol:"TCP",port:5432},summary:{total_hops:5,path_latency_ms:1.5,path_status:"REACHABLE",bottlenecks:[]},hops:[{hop_number:1,component:"sg-lambda-vpc",component_id:"sg-0a1b2c3d4e5f00017",type:"Security Group",direction:"Outbound",decision:"ALLOW",details:"Lambda SG allows outbound to database",latency_ms:.1},{hop_number:2,component:"acl-lambda",component_id:"acl-0a1b2c3d4e5f00014",type:"Network ACL",direction:"Outbound",decision:"ALLOW",details:"Rule 100 allows all internal traffic",latency_ms:.1},{hop_number:3,component:"rtb-lambda",component_id:"rtb-0a1b2c3d4e5f00014",type:"Route Table",direction:"Forward",decision:"ROUTE",details:"Route 10.40.0.0/16 via local VPC",latency_ms:.3},{hop_number:4,component:"sg-database-prod",component_id:"sg-0a1b2c3d4e5f00002",type:"Security Group",direction:"Inbound",decision:"ALLOW",details:"Inbound allows PostgreSQL from Lambda SG",latency_ms:.1},{hop_number:5,component:"postgres-primary",component_id:"i-0db123def456789a",type:"Destination",direction:"N/A",decision:"REACHED",details:"Lambda function can access database",latency_ms:.9}]}],Vu={path_analyses:vg},zt=e=>new Promise(s=>setTimeout(s,e)),yg=(e,s=10)=>Array.from({length:3},()=>Math.max(1,e+(Math.random()-.5)*s*2)),bg=e=>{const s=Math.floor(Math.random()*8)+8,a=[],r=[{ip:"192.168.1.1",hostname:"gateway.local",location:"Local Network",deviceType:"router"},{ip:"10.0.0.1",hostname:"core-rtr-01.example.com",location:"Data Center",asn:"AS12345",asnOrg:"Example Corp",deviceType:"router"},{ip:"72.14.194.1",hostname:"edge-rtr-02.isp.net",location:"Chicago, IL",asn:"AS15169",asnOrg:"ISP Networks",deviceType:"router"},{ip:"142.250.80.1",hostname:"core-bb-01.transit.net",location:"Denver, CO",asn:"AS174",asnOrg:"Cogent",deviceType:"router"},{ip:"209.85.248.1",hostname:"ae-12.cr1.sjc.transit.net",location:"San Jose, CA",asn:"AS3356",asnOrg:"Level 3",deviceType:"router"},{ip:"72.14.232.1",hostname:"be-102.pr1.lax.cloud.net",location:"Los Angeles, CA",asn:"AS15169",asnOrg:"Google Cloud",deviceType:"router",cloudProvider:"gcp"},{ip:"52.93.127.1",hostname:"aws-edge-01.us-east-1",location:"Virginia, US",asn:"AS16509",asnOrg:"Amazon",deviceType:"firewall",cloudProvider:"aws"},{ip:"13.107.4.1",hostname:"azure-gw-01.eastus",location:"Virginia, US",asn:"AS8075",asnOrg:"Microsoft",deviceType:"router",cloudProvider:"azure"}];let n=1;for(let o=0;o<s;o++){const i=o===s-1,l=Math.min(o,r.length-1),c=r[l];n+=Math.random()*15+5;const d=Math.random()<.1,u=d&&Math.random()<.3,p=d?Math.random()*20:Math.random()*2,h=u?[]:yg(n,n*.2),y=h.length>0?h.reduce((j,v)=>j+v,0)/h.length:0;a.push({hopNumber:o+1,ipAddress:i?e:c.ip.replace(/\d+$/,String(o+1)),hostname:i?`target-${e.replace(/\./g,"-")}`:c.hostname,location:c.location,asn:c.asn||null,asnOrg:c.asnOrg||null,latency:h,avgLatency:parseFloat(y.toFixed(2)),minLatency:h.length>0?parseFloat(Math.min(...h).toFixed(2)):0,maxLatency:h.length>0?parseFloat(Math.max(...h).toFixed(2)):0,jitter:h.length>0?parseFloat((Math.max(...h)-Math.min(...h)).toFixed(2)):0,packetLoss:parseFloat(p.toFixed(1)),status:u?"timeout":p>10?"unreachable":"reachable",deviceType:c.deviceType,cloudProvider:c.cloudProvider||null,region:c.cloudProvider?"us-east-1":void 0})}return a},_g=e=>{const s=e.reduce((n,o)=>n+o.packetLoss,0)/e.length,a=e.filter(n=>n.status==="timeout").length,r=e.filter(n=>n.status==="unreachable").length;return a>2||r>1||s>10?"critical":a>0||s>5?"degraded":"healthy"},wg=()=>Vu.path_analyses.slice(0,20).map(e=>{let s="healthy";return e.result==="BLOCKED"||e.result==="FAILED"?s="critical":e.summary.bottlenecks&&e.summary.bottlenecks.length>0&&(s="degraded"),{id:e.analysis_id,source:e.input.source,destination:e.input.destination,timestamp:e.analysis_timestamp,totalHops:e.summary.total_hops,avgLatency:e.summary.path_latency_ms??0,health:s,status:"completed"}});let ps=wg();const jg=()=>{const e=new Map;return Vu.path_analyses.forEach(s=>{const a=`${s.input.source}-${s.input.destination}`;e.has(a)||e.set(a,s)}),Array.from(e.values()).slice(0,10).map((s,a)=>({id:`sp-${a+1}`,name:`${s.input.source} to ${s.input.destination}`,source:s.input.source_ip||s.input.source,destination:s.input.destination_ip||s.input.destination,protocol:s.input.protocol.toLowerCase(),port:s.input.port||void 0,createdAt:s.analysis_timestamp,lastRun:s.analysis_timestamp,runCount:Math.floor(Math.random()*50)+1}))};let Xs=jg();const qe={async runAnalysis(e){await zt(2e3+Math.random()*2e3);const s=new Date().toISOString(),a=bg(e.destination),r=new Date().toISOString(),n=a.reduce((c,d)=>c+d.avgLatency,0),o=n/a.length,i=a.reduce((c,d)=>c+d.packetLoss,0)/a.length,l={id:`pa-${Date.now()}`,source:e.source,destination:e.destination,protocol:e.protocol,port:e.port,hops:a,totalHops:a.length,totalLatency:parseFloat(n.toFixed(2)),avgLatency:parseFloat(o.toFixed(2)),packetLoss:parseFloat(i.toFixed(1)),health:_g(a),status:"completed",startTime:s,endTime:r,duration:2e3+Math.random()*2e3,mtu:1500,ttl:e.maxHops||30};return ps.unshift({id:l.id,source:l.source,destination:l.destination,timestamp:l.startTime,totalHops:l.totalHops,avgLatency:l.avgLatency,health:l.health,status:l.status}),ps.length>20&&(ps=ps.slice(0,20)),l},async getHistory(){return await zt(300),ps},async clearHistory(){await zt(200),ps=[]},async getSavedPaths(){return await zt(300),Xs},async savePath(e){await zt(300);const s={...e,id:`sp-${Date.now()}`,createdAt:new Date().toISOString(),lastRun:null,runCount:0};return Xs.unshift(s),s},async deleteSavedPath(e){await zt(200),Xs=Xs.filter(s=>s.id!==e)},async updateSavedPathRun(e){await zt(100);const s=Xs.find(a=>a.id===e);s&&(s.lastRun=new Date().toISOString(),s.runCount+=1)}},Ng=[{ticket_number:"CHG0012345",short_description:"Database access for recommendation-engine-v2 to user_profiles DB",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"recommendation-engine-v2",source_ip:"10.50.10.0/24",destination_system:"user_profiles PostgreSQL",destination_ip:"10.20.5.100",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"ML service requires read-write access to update user preference scores for personalized recommendations",requested_by:{name:"John Developer",email:"john.developer@company.com",department:"Engineering"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["GDPR","SOC2"],violations:[]},assigned_to:{name:"Sarah Security",email:"sarah.security@company.com",role:"Security Manager"},state:"Implementing",created_at:"2026-01-10T09:00:00Z",updated_at:"2026-01-12T14:30:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Risk acceptable"}],additional_controls:["Audit Logging"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove security group rule sgr-xxx",change_window:"2026-01-12T22:00:00Z to 2026-01-13T02:00:00Z"},{ticket_number:"CHG0012346",short_description:"Allow external API access to payment-gateway service",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"Partner API - Stripe Payment Provider",source_ip:"203.0.113.0/24",destination_system:"payment-gateway-prod",destination_ip:"api.payments.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Stripe webhook callbacks for payment confirmation notifications per PCI-DSS requirements",requested_by:{name:"Mike Finance",email:"mike.finance@company.com",department:"Finance"},atlas_risk_score:72,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["PCI-DSS 1.2.1","PCI-DSS 1.3.4"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-11T11:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Security Manager","CISO"],approval_history:[],additional_controls:["WAF Protection","Rate Limiting","IP Whitelist"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Disable WAF rule and remove IP whitelist entry",change_window:"2026-01-15T06:00:00Z to 2026-01-15T10:00:00Z"},{ticket_number:"CHG0012347",short_description:"VPN access for DevOps team to production Kubernetes cluster",category:"Network / VPN Access",priority:3,priority_label:"Moderate",source_system:"VPN Pool - DevOps Team",source_ip:"10.100.50.0/24",destination_system:"prod-eks-cluster API Server",destination_ip:"10.30.0.100",destination_port:6443,protocol:"TCP",action:"ALLOW",business_justification:"DevOps team requires kubectl access for deployment and troubleshooting of production workloads",requested_by:{name:"Lisa DevOps",email:"lisa.devops@company.com",department:"DevOps"},atlas_risk_score:58,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Tom Network",email:"tom.network@company.com",role:"Network Engineer"},state:"Approved",created_at:"2026-01-09T14:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"MFA enforcement verified"}],additional_controls:["MFA Required","Session Timeout 4hrs","Audit Logging"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove VPN group from Kubernetes RBAC",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012348",short_description:"Enable Transit Gateway routing between Analytics VPC and Data Lake VPC",category:"Network / Transit Gateway",priority:3,priority_label:"Moderate",source_system:"Analytics VPC",source_ip:"10.60.0.0/16",destination_system:"Data Lake VPC",destination_ip:"10.70.0.0/16",destination_port:null,protocol:"TCP",ports:[443,9092,3306],action:"ALLOW",business_justification:"Analytics platform requires access to data lake for ML model training and real-time analytics pipeline",requested_by:{name:"Data Team",email:"data.team@company.com",department:"Data Science"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Network Team",email:"network@company.com",role:"Operator"},state:"Implemented",created_at:"2026-01-08T10:00:00Z",updated_at:"2026-01-12T09:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-08T10:05:00Z",comments:"Risk score 35 below threshold 40"}],additional_controls:[],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove TGW route table association",change_window:null},{ticket_number:"CHG0012349",short_description:"Emergency block of malicious IP range - Active threat detected",category:"Security / Emergency Block",priority:1,priority_label:"Critical",source_system:"Malicious IP Range - Known Tor Exit Nodes",source_ip:"185.220.101.0/24",destination_system:"All public-facing services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Emergency security response to active threat - automated brute force attacks detected",requested_by:{name:"SOC Team",email:"soc@company.com",department:"Security Operations"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Incident Response"],violations:[]},assigned_to:{name:"SOC Team",email:"soc@company.com",role:"Security Analyst"},state:"Monitoring",created_at:"2026-01-12T14:00:00Z",updated_at:"2026-01-12T14:00:47Z",threat_intelligence_source:"Recorded Future Alert RF-2026-0112-001, AlienVault OTX Pulse",implementation_time_seconds:47,auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-12T14:00:05Z",comments:"Emergency protocol activated"}],additional_controls:["Active Monitoring","SIEM Alert","Threat Feed Integration"],estimated_implementation_time:"Immediate",actual_implementation_time:"47 seconds",rollback_plan:"Remove deny rules from all platforms",change_window:null},{ticket_number:"CHG0012350",short_description:"Temporary vendor access for SAP integration maintenance",category:"Network / Vendor Access",priority:3,priority_label:"Moderate",source_system:"SAP Consulting Jump Host",source_ip:"198.51.100.50/32",destination_system:"SAP HANA Production",destination_ip:"10.40.20.100",destination_port:30015,protocol:"TCP",action:"ALLOW",business_justification:"Scheduled SAP S/4HANA upgrade requiring vendor specialist support per contract SOW-SAP-2025-089",requested_by:{name:"IT Procurement",email:"procurement@company.com",department:"IT"},atlas_risk_score:65,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","Vendor Management"],violations:[]},assigned_to:{name:"Vendor Management",email:"vendor.mgmt@company.com",role:"Manager"},state:"Scheduled",created_at:"2026-01-10T16:00:00Z",updated_at:"2026-01-12T08:00:00Z",access_duration_hours:72,access_start:"2026-01-15T08:00:00Z",access_end:"2026-01-18T08:00:00Z",auto_expire:!0,required_approvers:["Security Manager","Vendor Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T09:00:00Z",comments:"Session recording required"},{approver:"James Vendor",action:"Approved",timestamp:"2026-01-11T14:00:00Z",comments:"Contract verified"}],additional_controls:["Session Recording","Real-time Monitoring","DLP Enabled","Auto-expire 72h"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Revoke vendor credentials and remove firewall rule",change_window:"2026-01-15T08:00:00Z to 2026-01-18T08:00:00Z"},{ticket_number:"CHG0012351",short_description:"Allow microservices communication for order-processing to inventory-service",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"order-processing-svc",source_ip:"10.30.20.0/24",destination_system:"inventory-service",destination_ip:"10.30.25.0/24",destination_port:8080,protocol:"TCP",action:"ALLOW",business_justification:"New microservice architecture requires inter-service communication for order fulfillment workflow",requested_by:{name:"Platform Team",email:"platform@company.com",department:"Platform Engineering"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Security",email:"platform.sec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-07T13:00:00Z",updated_at:"2026-01-11T16:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-07T13:02:00Z",comments:"Low risk - internal service mesh"}],additional_controls:["Service Mesh mTLS"],estimated_implementation_time:"15 minutes",actual_implementation_time:"12 minutes",rollback_plan:"Remove service mesh policy",change_window:null},{ticket_number:"CHG0012352",short_description:"Block deprecated API endpoint access from legacy systems",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Legacy Application Servers",source_ip:"10.5.0.0/16",destination_system:"Deprecated API Gateway",destination_ip:"10.10.100.50",destination_port:8443,protocol:"TCP",action:"DENY",business_justification:"Deprecating old API version as part of modernization initiative - redirect to new endpoints",requested_by:{name:"Architecture Team",email:"architecture@company.com",department:"Architecture"},atlas_risk_score:42,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["Change Management"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T09:00:00Z",updated_at:"2026-01-12T15:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T10:00:00Z",comments:"Grace period communication sent"}],additional_controls:["Logging Enabled","Grace Period 7 days"],estimated_implementation_time:"30 minutes",actual_implementation_time:null,rollback_plan:"Remove deny rule and restore API access",change_window:"2026-01-20T00:00:00Z to 2026-01-20T04:00:00Z"},{ticket_number:"CHG0012353",short_description:"Enable CloudWatch log streaming to Splunk SIEM",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS CloudWatch",source_ip:"AWS Internal",destination_system:"Splunk SIEM",destination_ip:"10.90.10.100",destination_port:9997,protocol:"TCP",action:"ALLOW",business_justification:"Centralized log aggregation for security monitoring and compliance requirements",requested_by:{name:"Security Operations",email:"secops@company.com",department:"Security"},atlas_risk_score:22,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"SIEM Team",email:"siem@company.com",role:"Administrator"},state:"Implementing",created_at:"2026-01-09T11:00:00Z",updated_at:"2026-01-12T13:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T11:01:00Z",comments:"Logging infrastructure - low risk"}],additional_controls:["TLS Encryption","Log Integrity Verification"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Disable CloudWatch subscription filter",change_window:null},{ticket_number:"CHG0012354",short_description:"Allow Redis cluster access from application caching layer",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Caching Layer",source_ip:"10.30.30.0/24",destination_system:"Redis Cluster",destination_ip:"10.20.50.0/24",destination_port:6379,protocol:"TCP",action:"ALLOW",business_justification:"Application requires distributed caching for session management and performance optimization",requested_by:{name:"Backend Team",email:"backend@company.com",department:"Engineering"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"DBA"},state:"Implemented",created_at:"2026-01-06T10:00:00Z",updated_at:"2026-01-10T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T10:01:00Z",comments:"Internal caching - low risk"}],additional_controls:["Redis AUTH Enabled","TLS in Transit"],estimated_implementation_time:"20 minutes",actual_implementation_time:"18 minutes",rollback_plan:"Remove security group rule",change_window:null},{ticket_number:"CHG0012355",short_description:"External partner API integration for FedEx shipping provider",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"FedEx API Gateway",source_ip:"199.16.156.0/24",destination_system:"Shipping Service API",destination_ip:"api.shipping.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Integration with FedEx shipping API for real-time tracking and label generation",requested_by:{name:"Logistics Team",email:"logistics@company.com",department:"Logistics"},atlas_risk_score:68,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-12T08:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager","Integration Manager"],approval_history:[],additional_controls:["WAF Rules","Rate Limiting","IP Whitelist"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Remove WAF exception and IP whitelist",change_window:"2026-01-16T06:00:00Z to 2026-01-16T12:00:00Z"},{ticket_number:"CHG0012356",short_description:"Database replication between primary and DR site",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Primary Database Cluster",source_ip:"10.20.10.0/24",destination_system:"DR Database Cluster",destination_ip:"10.120.10.0/24",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Enable database replication for disaster recovery compliance - RPO 15 minutes",requested_by:{name:"DR Team",email:"dr.team@company.com",department:"Infrastructure"},atlas_risk_score:55,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","Business Continuity"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"Senior DBA"},state:"Implementing",created_at:"2026-01-08T15:00:00Z",updated_at:"2026-01-12T12:00:00Z",required_approvers:["Security Manager","Database Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T10:00:00Z",comments:"Encryption verified"},{approver:"DBA Manager",action:"Approved",timestamp:"2026-01-09T14:00:00Z",comments:"Replication config reviewed"}],additional_controls:["Encryption in Transit","Replication Monitoring"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Disable replication and remove firewall rules",change_window:"2026-01-13T02:00:00Z to 2026-01-13T06:00:00Z"},{ticket_number:"CHG0012357",short_description:"Allow monitoring agent communication to Datadog",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"All Application Servers",source_ip:"10.0.0.0/8",destination_system:"Datadog Agent Endpoint",destination_ip:"agent.datadoghq.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable APM and infrastructure monitoring across all environments",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Network Team",email:"network@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T09:00:00Z",updated_at:"2026-01-09T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T09:01:00Z",comments:"Monitoring egress - low risk"}],additional_controls:["Egress Only","No Inbound"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012358",short_description:"Block suspicious IP range from Eastern Europe - Threat Response",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"Suspicious IP Range",source_ip:"91.134.0.0/16",destination_system:"All Internet-Facing Services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Threat intelligence indicates active scanning and brute force attempts from this range",requested_by:{name:"Threat Intelligence",email:"threat.intel@company.com",department:"Security"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Incident Response"],violations:[]},assigned_to:{name:"SOC Team",email:"soc@company.com",role:"Analyst"},state:"Monitoring",created_at:"2026-01-12T10:00:00Z",updated_at:"2026-01-12T10:01:23Z",threat_intelligence_source:"Internal Threat Detection, VirusTotal",implementation_time_seconds:83,auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-12T10:00:10Z",comments:"Threat response protocol"}],additional_controls:["Geo-blocking","Rate Limiting Backup"],estimated_implementation_time:"Immediate",actual_implementation_time:"83 seconds",rollback_plan:"Remove deny rules when threat cleared",change_window:null},{ticket_number:"CHG0012359",short_description:"Allow CI/CD pipeline access to Artifactory repository",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Jenkins Build Agents",source_ip:"10.80.0.0/16",destination_system:"Artifactory Repository",destination_ip:"10.85.10.50",destination_port:8081,protocol:"TCP",action:"ALLOW",business_justification:"CI/CD pipeline requires access to push and pull build artifacts",requested_by:{name:"DevOps Team",email:"devops@company.com",department:"DevOps"},atlas_risk_score:41,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"DevOps Security",email:"devsec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-10T14:00:00Z",updated_at:"2026-01-12T09:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T08:00:00Z",comments:"Service account verified"}],additional_controls:["Service Account Auth","Artifact Signing"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove firewall rule and revoke service account",change_window:null},{ticket_number:"CHG0012360",short_description:"Enable cross-region VPC peering for global load balancing",category:"Network / VPC Peering",priority:2,priority_label:"High",source_system:"US-East Production VPC",source_ip:"10.10.0.0/16",destination_system:"EU-West Production VPC",destination_ip:"10.110.0.0/16",destination_port:null,protocol:"ALL",action:"ALLOW",business_justification:"Global load balancing architecture for improved latency and disaster recovery",requested_by:{name:"Infrastructure Team",email:"infrastructure@company.com",department:"Infrastructure"},atlas_risk_score:48,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","GDPR"],violations:[]},assigned_to:{name:"Cloud Architecture",email:"cloud.arch@company.com",role:"Senior Engineer"},state:"Approved",created_at:"2026-01-09T08:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager","Network Architect"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"GDPR data flow verified"},{approver:"Network Architect",action:"Approved",timestamp:"2026-01-10T14:00:00Z",comments:"Architecture reviewed"}],additional_controls:["Transit Encryption","Route Verification"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Delete VPC peering connection",change_window:"2026-01-14T02:00:00Z to 2026-01-14T08:00:00Z"},{ticket_number:"CHG0012361",short_description:"Allow Kafka cluster access for event streaming",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Event Producers",source_ip:"10.30.0.0/16",destination_system:"Kafka Cluster",destination_ip:"10.25.10.0/24",destination_port:9092,protocol:"TCP",action:"ALLOW",business_justification:"Enable event-driven architecture for real-time data processing",requested_by:{name:"Data Engineering",email:"data.eng@company.com",department:"Data"},atlas_risk_score:36,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Team",email:"platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T11:00:00Z",updated_at:"2026-01-08T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T11:01:00Z",comments:"Internal messaging - low risk"}],additional_controls:["SASL Authentication","TLS Encryption"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove Kafka ACLs and security group rules",change_window:null},{ticket_number:"CHG0012362",short_description:"External webhook integration for GitHub Actions",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"GitHub Actions",source_ip:"140.82.112.0/20",destination_system:"Deployment Webhook Service",destination_ip:"hooks.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"GitHub Actions requires webhook callback for deployment status updates",requested_by:{name:"DevOps",email:"devops@company.com",department:"DevOps"},atlas_risk_score:52,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"Security Engineering",email:"sec.eng@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T10:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T09:00:00Z",comments:"Webhook signature validation required"}],additional_controls:["Webhook Signature Validation","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rule and IP whitelist",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012363",short_description:"Block crypto mining pool connections",category:"Security / Threat Response",priority:2,priority_label:"High",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"Known Mining Pools",destination_ip:"Multiple IPs",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Prevent unauthorized cryptocurrency mining on company resources",requested_by:{name:"Security Team",email:"security@company.com",department:"Security"},atlas_risk_score:null,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["Security Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T08:00:00Z",updated_at:"2026-01-07T12:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-03T10:00:00Z",comments:"Policy enforcement"}],additional_controls:["DNS Sinkhole","Threat Feed Integration"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove deny rules and DNS sinkhole entries",change_window:null},{ticket_number:"CHG0012364",short_description:"Allow Elasticsearch cluster access for log analytics",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Log Aggregation Services",source_ip:"10.90.0.0/16",destination_system:"Elasticsearch Cluster",destination_ip:"10.25.20.0/24",destination_port:9200,protocol:"TCP",action:"ALLOW",business_justification:"Enable centralized log search and analytics capabilities",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:34,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Data Platform",email:"data.platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T09:00:00Z",updated_at:"2026-01-06T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-02T09:01:00Z",comments:"Logging infrastructure"}],additional_controls:["TLS Encryption","Role-Based Access"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove security group rules",change_window:null},{ticket_number:"CHG0012365",short_description:"Enable S3 VPC Endpoint for secure data transfer",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"AWS S3 Service",destination_ip:"S3 Prefix List",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Route S3 traffic through VPC endpoint for security and cost optimization",requested_by:{name:"Cloud Team",email:"cloud@company.com",department:"Cloud Infrastructure"},atlas_risk_score:25,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-01T10:00:00Z",updated_at:"2026-01-05T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-01T10:01:00Z",comments:"AWS managed endpoint - low risk"}],additional_controls:["VPC Endpoint Policy","S3 Bucket Policy"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove VPC endpoint and route table entries",change_window:null},{ticket_number:"CHG0012366",short_description:"Allow Azure AD authentication traffic",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"All Corporate Applications",source_ip:"10.0.0.0/8",destination_system:"Azure AD Endpoints",destination_ip:"login.microsoftonline.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Azure AD SSO authentication for corporate applications",requested_by:{name:"Identity Team",email:"identity@company.com",department:"IT Security"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Identity Security",email:"idsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2025-12-28T14:00:00Z",updated_at:"2026-01-02T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2025-12-28T14:01:00Z",comments:"Identity provider - low risk"}],additional_controls:["TLS 1.2+","Certificate Pinning"],estimated_implementation_time:"1 hour",actual_implementation_time:"45 minutes",rollback_plan:"Remove egress rules for Azure AD endpoints",change_window:null},{ticket_number:"CHG0012367",short_description:"Block outbound DNS to non-corporate resolvers",category:"Security / Access Revocation",priority:2,priority_label:"High",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"External DNS Servers",destination_ip:"0.0.0.0/0",destination_port:53,protocol:"UDP",action:"DENY",business_justification:"Enforce use of corporate DNS for security monitoring and DNS tunneling prevention",requested_by:{name:"Security Architecture",email:"sec.arch@company.com",department:"Security"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","Security Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Senior Engineer"},state:"Approved",created_at:"2026-01-10T09:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager","Network Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Exception list reviewed"},{approver:"Network Manager",action:"Approved",timestamp:"2026-01-12T09:00:00Z",comments:"Impact assessment complete"}],additional_controls:["DNS Logging","Exception Whitelist for Cloud Services"],estimated_implementation_time:"4 hours",actual_implementation_time:null,rollback_plan:"Remove deny rules",change_window:"2026-01-15T02:00:00Z to 2026-01-15T06:00:00Z"},{ticket_number:"CHG0012368",short_description:"Allow GraphQL API access for mobile applications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Mobile App Users",source_ip:"0.0.0.0/0",destination_system:"GraphQL API Gateway",destination_ip:"graphql.api.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"New mobile app requires GraphQL API access for data queries",requested_by:{name:"Mobile Team",email:"mobile@company.com",department:"Mobile Development"},atlas_risk_score:62,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","OWASP"],violations:[]},assigned_to:null,state:"Awaiting Approval",created_at:"2026-01-12T11:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager","API Security"],approval_history:[],additional_controls:["WAF Rules","Rate Limiting","Query Depth Limiting","Authentication Required"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Disable API endpoint",change_window:"2026-01-16T10:00:00Z to 2026-01-16T14:00:00Z"},{ticket_number:"CHG0012369",short_description:"Enable MongoDB Atlas peering connection",category:"Network / VPC Peering",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"MongoDB Atlas",destination_ip:"192.168.248.0/21",destination_port:27017,protocol:"TCP",action:"ALLOW",business_justification:"Migrate to MongoDB Atlas for managed database services",requested_by:{name:"Database Team",email:"dba@company.com",department:"Database"},atlas_risk_score:44,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","HIPAA"],violations:[]},assigned_to:{name:"Cloud Database",email:"cloud.db@company.com",role:"DBA"},state:"Approved",created_at:"2026-01-08T13:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T11:00:00Z",comments:"MongoDB Atlas SOC2 verified"}],additional_controls:["TLS Encryption","IP Whitelist","Authentication"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Delete VPC peering connection",change_window:"2026-01-14T06:00:00Z to 2026-01-14T10:00:00Z"},{ticket_number:"CHG0012370",short_description:"Allow Okta SCIM provisioning traffic",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Okta Cloud",source_ip:"Multiple Okta IPs",destination_system:"Identity Provisioning API",destination_ip:"scim.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable automated user provisioning through Okta SCIM",requested_by:{name:"Identity Team",email:"identity@company.com",department:"IT Security"},atlas_risk_score:48,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"Identity Engineering",email:"id.eng@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-07T10:00:00Z",updated_at:"2026-01-12T08:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-08T09:00:00Z",comments:"Okta IP ranges verified"}],additional_controls:["Bearer Token Auth","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rules and IP whitelist",change_window:null},{ticket_number:"CHG0012371",short_description:"Rejected - Overly permissive database access request",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Development Environment",source_ip:"0.0.0.0/0",destination_system:"Production Database",destination_ip:"10.20.10.100",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Developer needs quick access to debug production issue",requested_by:{name:"Dev User",email:"dev@company.com",department:"Engineering"},atlas_risk_score:95,risk_level:"CRITICAL",compliance_status:{passed:!1,frameworks:[],violations:["PCI-DSS 1.2.1","SOC2 CC6.1"]},assigned_to:null,state:"Rejected",created_at:"2026-01-11T15:00:00Z",updated_at:"2026-01-11T16:00:00Z",required_approvers:["Security Manager","CISO"],approval_history:[{approver:"Sarah Security",action:"Rejected",timestamp:"2026-01-11T16:00:00Z",comments:"0.0.0.0/0 source not allowed for production databases. Use VPN access instead."}],additional_controls:[],rejection_reason:"Overly permissive source CIDR violates security policy",estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012372",short_description:"Allow Snowflake data warehouse access",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Analytics Applications",source_ip:"10.60.0.0/16",destination_system:"Snowflake Cloud",destination_ip:"company.snowflakecomputing.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Connect analytics tools to Snowflake data warehouse",requested_by:{name:"BI Team",email:"bi@company.com",department:"Business Intelligence"},atlas_risk_score:39,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Data Platform",email:"data.platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T14:00:00Z",updated_at:"2026-01-07T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-03T14:01:00Z",comments:"SaaS analytics - low risk"}],additional_controls:["SSO Authentication","Role-Based Access"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012373",short_description:"Enable AWS PrivateLink for third-party SaaS",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application VPC",source_ip:"10.30.0.0/16",destination_system:"SaaS Provider PrivateLink",destination_ip:"vpce-xxx",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Secure private connectivity to SaaS provider without internet exposure",requested_by:{name:"Cloud Architecture",email:"cloud.arch@company.com",department:"Architecture"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T11:00:00Z",updated_at:"2026-01-12T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T11:01:00Z",comments:"PrivateLink - low risk"}],additional_controls:["VPC Endpoint Policy"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Delete VPC endpoint",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012374",short_description:"Block TikTok domains for corporate network",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Corporate Network",source_ip:"10.0.0.0/8",destination_system:"TikTok Domains",destination_ip:"Multiple",destination_port:443,protocol:"HTTPS",action:"DENY",business_justification:"Corporate policy prohibits TikTok access due to security concerns",requested_by:{name:"CISO Office",email:"ciso@company.com",department:"Security"},atlas_risk_score:null,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["Corporate Policy"],violations:[]},assigned_to:{name:"Web Security",email:"websec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T08:00:00Z",updated_at:"2026-01-05T12:00:00Z",required_approvers:["CISO"],approval_history:[{approver:"CISO",action:"Approved",timestamp:"2026-01-02T09:00:00Z",comments:"Corporate policy enforcement"}],additional_controls:["DNS Blocking","URL Filtering"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove DNS and URL filter entries",change_window:null},{ticket_number:"CHG0012375",short_description:"Allow Terraform Cloud API access for IaC deployments",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"CI/CD Pipeline",source_ip:"10.80.0.0/16",destination_system:"Terraform Cloud",destination_ip:"app.terraform.io",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable infrastructure as code deployments through Terraform Cloud",requested_by:{name:"Platform Engineering",email:"platform@company.com",department:"Platform"},atlas_risk_score:42,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","SDLC"],violations:[]},assigned_to:{name:"DevSecOps",email:"devsecops@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-10T16:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"API token rotation policy required"}],additional_controls:["API Token Authentication","Workspace Isolation"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012376",short_description:"Enable AWS Systems Manager access for EC2 management",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"EC2 Instances",source_ip:"10.30.0.0/16",destination_system:"AWS SSM Endpoints",destination_ip:"SSM Prefix List",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable secure SSH-less management of EC2 instances through Systems Manager",requested_by:{name:"Operations Team",email:"ops@company.com",department:"Operations"},atlas_risk_score:26,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","NIST"],violations:[]},assigned_to:{name:"AWS Operations",email:"aws.ops@company.com",role:"Engineer"},state:"Implemented",created_at:"2025-12-30T10:00:00Z",updated_at:"2026-01-03T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2025-12-30T10:01:00Z",comments:"AWS managed service - low risk"}],additional_controls:["IAM Instance Profile","Session Logging"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove VPC endpoints",change_window:null},{ticket_number:"CHG0012377",short_description:"Cancelled - Duplicate request for Redis access",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Tier",source_ip:"10.30.30.0/24",destination_system:"Redis Cluster",destination_ip:"10.20.50.0/24",destination_port:6379,protocol:"TCP",action:"ALLOW",business_justification:"Application needs Redis access",requested_by:{name:"Developer",email:"dev@company.com",department:"Engineering"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:null,state:"Cancelled",created_at:"2026-01-11T14:00:00Z",updated_at:"2026-01-11T15:00:00Z",required_approvers:[],approval_history:[],cancellation_reason:"Duplicate of CHG0012354 - access already granted",additional_controls:[],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012378",short_description:"Allow PagerDuty webhook for incident notifications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"PagerDuty Cloud",source_ip:"Multiple PagerDuty IPs",destination_system:"Incident Webhook Handler",destination_ip:"incidents.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable PagerDuty to send incident webhooks for automation",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:46,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-08T09:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-09T10:00:00Z",comments:"Webhook signature validation confirmed"}],additional_controls:["Webhook Signature Validation","Rate Limiting"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012379",short_description:"Enable AWS Secrets Manager access for credential rotation",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"AWS Secrets Manager",destination_ip:"secretsmanager.us-east-1.amazonaws.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Implement automated credential rotation for security compliance",requested_by:{name:"Security Engineering",email:"sec.eng@company.com",department:"Security"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS","NIST"],violations:[]},assigned_to:{name:"AWS Security",email:"aws.sec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T11:00:00Z",updated_at:"2026-01-08T15:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T11:01:00Z",comments:"Security service - low risk"}],additional_controls:["VPC Endpoint","IAM Policy"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove VPC endpoint",change_window:null},{ticket_number:"CHG0012380",short_description:"Block Russia and Belarus IP ranges",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"RU/BY Country IP Ranges",source_ip:"Multiple Country CIDR Blocks",destination_system:"All Public Services",destination_ip:"0.0.0.0/0",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Geopolitical risk mitigation - no business operations in these regions",requested_by:{name:"CISO",email:"ciso@company.com",department:"Security"},atlas_risk_score:null,risk_level:"EMERGENCY",compliance_status:{passed:!0,frameworks:["Security Policy","Risk Management"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Senior Engineer"},state:"Implemented",created_at:"2026-01-05T08:00:00Z",updated_at:"2026-01-05T10:00:00Z",required_approvers:["CISO"],approval_history:[{approver:"CISO",action:"Approved",timestamp:"2026-01-05T08:30:00Z",comments:"Executive directive"}],additional_controls:["Geo-IP Blocking","Threat Feed Integration"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove geo-blocking rules",change_window:null},{ticket_number:"CHG0012381",short_description:"Allow Cloudflare WAF to origin servers",category:"Network / WAF Change",priority:2,priority_label:"High",source_system:"Cloudflare Edge",source_ip:"Cloudflare IP Ranges",destination_system:"Origin Web Servers",destination_ip:"10.10.5.0/24",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Route traffic through Cloudflare for DDoS protection and WAF",requested_by:{name:"Security Architecture",email:"sec.arch@company.com",department:"Security"},atlas_risk_score:55,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"Web Security",email:"websec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-09T14:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T09:00:00Z",comments:"Cloudflare authenticated origin pull required"}],additional_controls:["Authenticated Origin Pull","TLS 1.3"],estimated_implementation_time:"3 hours",actual_implementation_time:null,rollback_plan:"Remove Cloudflare IP whitelist",change_window:null},{ticket_number:"CHG0012382",short_description:"On Hold - Pending vendor security assessment",category:"Network / Vendor Access",priority:3,priority_label:"Moderate",source_system:"New SaaS Vendor",source_ip:"203.0.113.100/32",destination_system:"Internal API",destination_ip:"10.10.10.50",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"New vendor integration for HR system",requested_by:{name:"HR IT",email:"hr.it@company.com",department:"HR"},atlas_risk_score:70,risk_level:"HIGH",compliance_status:{passed:!1,frameworks:[],violations:["Pending vendor SOC2 review"]},assigned_to:{name:"Vendor Security",email:"vendor.sec@company.com",role:"Analyst"},state:"On Hold",created_at:"2026-01-07T11:00:00Z",updated_at:"2026-01-12T09:00:00Z",required_approvers:["Security Manager","Vendor Manager"],approval_history:[],hold_reason:"Awaiting vendor SOC2 Type II report review",hold_until:"2026-01-20T00:00:00Z",additional_controls:["Pending security assessment"],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012383",short_description:"Allow Lambda functions to access RDS via VPC",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS Lambda",source_ip:"Lambda ENI IPs",destination_system:"RDS PostgreSQL",destination_ip:"10.20.10.0/24",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Serverless functions require database access for API backend",requested_by:{name:"Serverless Team",email:"serverless@company.com",department:"Engineering"},atlas_risk_score:40,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Cloud Team",email:"cloud@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-11T13:00:00Z",updated_at:"2026-01-12T15:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T10:00:00Z",comments:"Lambda security group configured correctly"}],additional_controls:["Lambda VPC Config","Security Group"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove Lambda from VPC",change_window:"2026-01-13T18:00:00Z to 2026-01-13T20:00:00Z"},{ticket_number:"CHG0012384",short_description:"Enable Azure Event Hub access for log streaming",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Azure VMs",source_ip:"10.50.0.0/16",destination_system:"Azure Event Hub",destination_ip:"eventhub.servicebus.windows.net",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Stream Azure logs to central logging platform",requested_by:{name:"Azure Team",email:"azure@company.com",department:"Cloud"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Azure Operations",email:"azure.ops@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-06T15:00:00Z",updated_at:"2026-01-10T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T15:01:00Z",comments:"Azure managed service"}],additional_controls:["Service Endpoint","NSG Rules"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove NSG rules",change_window:null},{ticket_number:"CHG0012385",short_description:"Block known malware C2 domains",category:"Security / Threat Response",priority:1,priority_label:"Critical",source_system:"All Internal Systems",source_ip:"10.0.0.0/8",destination_system:"Malware C2 Domains",destination_ip:"Multiple",destination_port:null,protocol:"ALL",action:"DENY",business_justification:"Block communication with known malware command and control infrastructure",requested_by:{name:"Threat Intelligence",email:"threat.intel@company.com",department:"Security"},atlas_risk_score:null,risk_level:"CRITICAL",compliance_status:{passed:!0,frameworks:["Security Policy"],violations:[]},assigned_to:{name:"SOC",email:"soc@company.com",role:"Analyst"},state:"Implemented",created_at:"2026-01-08T06:00:00Z",updated_at:"2026-01-08T07:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Emergency Auto-Approved",timestamp:"2026-01-08T06:01:00Z",comments:"Threat intelligence auto-block"}],additional_controls:["DNS Sinkhole","Threat Feed Integration","SIEM Alert"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove DNS sinkhole entries",change_window:null},{ticket_number:"CHG0012386",short_description:"Allow GCP Cloud Functions to access Cloud SQL",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"GCP Cloud Functions",source_ip:"Serverless VPC Connector",destination_system:"Cloud SQL PostgreSQL",destination_ip:"10.128.0.0/20",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Serverless functions need database connectivity",requested_by:{name:"GCP Team",email:"gcp@company.com",department:"Cloud"},atlas_risk_score:38,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"GCP Operations",email:"gcp.ops@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-10T10:00:00Z",updated_at:"2026-01-12T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-10T10:01:00Z",comments:"Internal GCP traffic"}],additional_controls:["VPC Connector","Firewall Rules"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove VPC connector",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012387",short_description:"Enable Twilio webhook for SMS notifications",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Twilio Cloud",source_ip:"Twilio IP Ranges",destination_system:"SMS Webhook Handler",destination_ip:"sms.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Twilio webhooks for SMS status callbacks",requested_by:{name:"Communications Team",email:"comms@company.com",department:"Communications"},atlas_risk_score:50,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-11T09:00:00Z",updated_at:"2026-01-12T13:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-12T08:00:00Z",comments:"Request signature validation required"}],additional_controls:["Request Signature Validation","Rate Limiting"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:null},{ticket_number:"CHG0012388",short_description:"Allow Prometheus to scrape metrics from all namespaces",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Prometheus Server",source_ip:"10.90.5.0/24",destination_system:"All Kubernetes Pods",destination_ip:"10.30.0.0/16",destination_port:9090,protocol:"TCP",action:"ALLOW",business_justification:"Enable comprehensive metrics collection for observability",requested_by:{name:"Observability Team",email:"observability@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Platform Team",email:"platform@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T14:00:00Z",updated_at:"2026-01-09T10:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T14:01:00Z",comments:"Monitoring traffic"}],additional_controls:["Network Policy","Service Account"],estimated_implementation_time:"1 hour",actual_implementation_time:"50 minutes",rollback_plan:"Remove network policy",change_window:null},{ticket_number:"CHG0012389",short_description:"Enable AWS KMS access for encryption key management",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"AWS KMS",destination_ip:"kms.us-east-1.amazonaws.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable encryption key management for data protection compliance",requested_by:{name:"Security Engineering",email:"sec.eng@company.com",department:"Security"},atlas_risk_score:28,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS","HIPAA"],violations:[]},assigned_to:{name:"Security Operations",email:"secops@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-03T09:00:00Z",updated_at:"2026-01-07T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-03T09:01:00Z",comments:"Security service - critical"}],additional_controls:["VPC Endpoint","Key Policy"],estimated_implementation_time:"45 minutes",actual_implementation_time:"40 minutes",rollback_plan:"Remove VPC endpoint",change_window:null},{ticket_number:"CHG0012390",short_description:"Allow SendGrid for transactional email",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Email Service",source_ip:"10.30.40.0/24",destination_system:"SendGrid API",destination_ip:"api.sendgrid.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable transactional email delivery through SendGrid",requested_by:{name:"Communications",email:"comms@company.com",department:"Marketing"},atlas_risk_score:35,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","CAN-SPAM"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T16:00:00Z",updated_at:"2026-01-08T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T16:01:00Z",comments:"SaaS email service"}],additional_controls:["API Key Authentication","Rate Limiting"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012391",short_description:"Block BitTorrent traffic on corporate network",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Corporate Network",source_ip:"10.0.0.0/8",destination_system:"BitTorrent Peers",destination_ip:"0.0.0.0/0",destination_port:"6881-6889",protocol:"TCP/UDP",action:"DENY",business_justification:"Block P2P file sharing to prevent copyright infringement and data exfiltration",requested_by:{name:"IT Security",email:"it.security@company.com",department:"IT"},atlas_risk_score:null,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["Corporate Policy"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-02T11:00:00Z",updated_at:"2026-01-06T09:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-02T14:00:00Z",comments:"Policy enforcement"}],additional_controls:["Application Control","Protocol Detection"],estimated_implementation_time:"2 hours",actual_implementation_time:"1.5 hours",rollback_plan:"Remove application control rules",change_window:null},{ticket_number:"CHG0012392",short_description:"Enable HashiCorp Vault access for secrets management",category:"Network / Firewall Change",priority:2,priority_label:"High",source_system:"Application Services",source_ip:"10.30.0.0/16",destination_system:"HashiCorp Vault Cluster",destination_ip:"10.90.20.0/24",destination_port:8200,protocol:"TCP",action:"ALLOW",business_justification:"Enable centralized secrets management for applications",requested_by:{name:"Platform Security",email:"platform.sec@company.com",department:"Security"},atlas_risk_score:45,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"Security Engineering",email:"sec.eng@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T15:00:00Z",updated_at:"2026-01-12T11:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-10T10:00:00Z",comments:"AppRole authentication configured"}],additional_controls:["TLS Encryption","AppRole Auth","Audit Logging"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove security group rules",change_window:"2026-01-14T10:00:00Z to 2026-01-14T14:00:00Z"},{ticket_number:"CHG0012393",short_description:"Allow Grafana access to Prometheus for dashboards",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Grafana Server",source_ip:"10.90.10.50",destination_system:"Prometheus Server",destination_ip:"10.90.5.100",destination_port:9090,protocol:"TCP",action:"ALLOW",business_justification:"Enable Grafana dashboards to query Prometheus metrics",requested_by:{name:"Observability Team",email:"observability@company.com",department:"SRE"},atlas_risk_score:22,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Monitoring Team",email:"monitoring@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-05T10:00:00Z",updated_at:"2026-01-09T14:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-05T10:01:00Z",comments:"Monitoring infrastructure"}],additional_controls:["Internal Only"],estimated_implementation_time:"15 minutes",actual_implementation_time:"12 minutes",rollback_plan:"Remove security group rule",change_window:null},{ticket_number:"CHG0012394",short_description:"Enable AWS ALB access logs to S3",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"AWS ALB",source_ip:"ALB Internal",destination_system:"S3 Logging Bucket",destination_ip:"S3 Endpoint",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable ALB access logging for security and compliance",requested_by:{name:"Compliance Team",email:"compliance@company.com",department:"Compliance"},atlas_risk_score:20,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2","PCI-DSS"],violations:[]},assigned_to:{name:"AWS Team",email:"aws@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-04T13:00:00Z",updated_at:"2026-01-08T16:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-04T13:01:00Z",comments:"Logging configuration"}],additional_controls:["S3 Bucket Policy","Log Retention"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Disable ALB access logging",change_window:null},{ticket_number:"CHG0012395",short_description:"Draft - New microservice API access request",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"New Checkout Service",source_ip:"10.30.50.0/24",destination_system:"Payment Service",destination_ip:"10.30.25.0/24",destination_port:8443,protocol:"HTTPS",action:"ALLOW",business_justification:"New checkout service needs to call payment service APIs",requested_by:{name:"E-commerce Team",email:"ecommerce@company.com",department:"Engineering"},atlas_risk_score:52,risk_level:"MEDIUM",compliance_status:{passed:null,frameworks:[],violations:[]},assigned_to:null,state:"Draft",created_at:"2026-01-12T16:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:[],approval_history:[],additional_controls:[],estimated_implementation_time:null,actual_implementation_time:null,rollback_plan:null,change_window:null},{ticket_number:"CHG0012396",short_description:"Allow Jira webhook for issue tracking integration",category:"Network / WAF Change",priority:3,priority_label:"Moderate",source_system:"Atlassian Jira Cloud",source_ip:"Atlassian IP Ranges",destination_system:"Issue Webhook Handler",destination_ip:"issues.company.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable Jira webhooks for automated issue tracking",requested_by:{name:"Project Management",email:"pm@company.com",department:"PMO"},atlas_risk_score:44,risk_level:"MEDIUM",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Integration Team",email:"integrations@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-10T11:00:00Z",updated_at:"2026-01-12T14:00:00Z",required_approvers:["Security Manager"],approval_history:[{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T09:00:00Z",comments:"Webhook validation configured"}],additional_controls:["Webhook Signature Validation"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove WAF rule",change_window:"2026-01-13T10:00:00Z to 2026-01-13T12:00:00Z"},{ticket_number:"CHG0012397",short_description:"Block Zoom for regulated departments",category:"Security / Access Revocation",priority:3,priority_label:"Moderate",source_system:"Regulated Department Networks",source_ip:"10.200.0.0/16",destination_system:"Zoom Cloud",destination_ip:"Zoom Domains",destination_port:443,protocol:"HTTPS",action:"DENY",business_justification:"Compliance requirement prohibits certain video conferencing for regulated departments",requested_by:{name:"Compliance",email:"compliance@company.com",department:"Compliance"},atlas_risk_score:null,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["Regulatory Compliance"],violations:[]},assigned_to:{name:"Network Security",email:"netsec@company.com",role:"Engineer"},state:"Implementing",created_at:"2026-01-11T08:00:00Z",updated_at:"2026-01-12T10:00:00Z",required_approvers:["Compliance Manager","Security Manager"],approval_history:[{approver:"Compliance Manager",action:"Approved",timestamp:"2026-01-11T10:00:00Z",comments:"Regulatory requirement"},{approver:"Sarah Security",action:"Approved",timestamp:"2026-01-11T14:00:00Z",comments:"Implementation plan reviewed"}],additional_controls:["URL Filtering","DNS Blocking"],estimated_implementation_time:"2 hours",actual_implementation_time:null,rollback_plan:"Remove URL filter and DNS block",change_window:null},{ticket_number:"CHG0012398",short_description:"Enable AWS EFS access for shared storage",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application EC2 Instances",source_ip:"10.30.0.0/16",destination_system:"AWS EFS",destination_ip:"10.30.100.0/24",destination_port:2049,protocol:"TCP",action:"ALLOW",business_justification:"Enable shared file storage for application cluster",requested_by:{name:"Application Team",email:"app@company.com",department:"Engineering"},atlas_risk_score:30,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Storage Team",email:"storage@company.com",role:"Engineer"},state:"Approved",created_at:"2026-01-09T09:00:00Z",updated_at:"2026-01-12T11:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-09T09:01:00Z",comments:"Internal storage - low risk"}],additional_controls:["NFS Security Group","IAM Authorization"],estimated_implementation_time:"1 hour",actual_implementation_time:null,rollback_plan:"Remove mount targets",change_window:"2026-01-13T14:00:00Z to 2026-01-13T16:00:00Z"},{ticket_number:"CHG0012399",short_description:"Allow New Relic APM agent communication",category:"Network / Firewall Change",priority:3,priority_label:"Moderate",source_system:"Application Servers",source_ip:"10.30.0.0/16",destination_system:"New Relic Collector",destination_ip:"collector.newrelic.com",destination_port:443,protocol:"HTTPS",action:"ALLOW",business_justification:"Enable APM monitoring through New Relic",requested_by:{name:"SRE Team",email:"sre@company.com",department:"SRE"},atlas_risk_score:32,risk_level:"LOW",compliance_status:{passed:!0,frameworks:["SOC2"],violations:[]},assigned_to:{name:"Monitoring Team",email:"monitoring@company.com",role:"Engineer"},state:"Implemented",created_at:"2026-01-06T14:00:00Z",updated_at:"2026-01-10T09:00:00Z",auto_approved:!0,required_approvers:[],approval_history:[{approver:"SYSTEM",action:"Auto-Approved",timestamp:"2026-01-06T14:01:00Z",comments:"Monitoring egress"}],additional_controls:["License Key Auth"],estimated_implementation_time:"30 minutes",actual_implementation_time:"25 minutes",rollback_plan:"Remove egress rule",change_window:null},{ticket_number:"CHG0012400",short_description:"Enable inter-region database replication for DR",category:"Network / Transit Gateway",priority:1,priority_label:"Critical",source_system:"US-East Database VPC",source_ip:"10.20.0.0/16",destination_system:"US-West Database VPC",destination_ip:"10.120.0.0/16",destination_port:5432,protocol:"TCP",action:"ALLOW",business_justification:"Critical DR requirement - cross-region database replication for business continuity",requested_by:{name:"DR Team",email:"dr@company.com",department:"Infrastructure"},atlas_risk_score:60,risk_level:"HIGH",compliance_status:{passed:!0,frameworks:["SOC2","Business Continuity","HIPAA"],violations:[]},assigned_to:{name:"Database Team",email:"dba@company.com",role:"Senior DBA"},state:"Awaiting Approval",created_at:"2026-01-12T09:00:00Z",updated_at:"2026-01-12T16:00:00Z",required_approvers:["Security Manager","CISO","Database Manager"],approval_history:[{approver:"Database Manager",action:"Approved",timestamp:"2026-01-12T11:00:00Z",comments:"Replication config verified"}],additional_controls:["TLS 1.3 Encryption","Inter-Region TGW Peering","Replication Monitoring"],estimated_implementation_time:"6 hours",actual_implementation_time:null,rollback_plan:"Remove TGW peering and replication configuration",change_window:"2026-01-18T02:00:00Z to 2026-01-18T10:00:00Z"}],kg={tickets:Ng},Sg=e=>({Draft:"awaiting","Awaiting Approval":"awaiting",Approved:"approved",Implementing:"implementing",Implemented:"completed",Monitoring:"completed",Scheduled:"approved",Rejected:"rejected",Cancelled:"rejected","On Hold":"awaiting"})[e]||"awaiting",Cg=e=>e===1?"critical":e===2?"high":e===3?"medium":"low",Ag=e=>({"Network / Firewall Change":"firewall_rule","Network / WAF Change":"firewall_rule","Network / VPN Access":"vpn","Network / Transit Gateway":"routing","Network / VPC Peering":"routing","Network / Vendor Access":"firewall_rule","Network / Load Balancer":"load_balancer","Security / Emergency Block":"firewall_rule","Security / Threat Response":"firewall_rule","Security / Access Revocation":"security_group","Compliance / Audit Remediation":"security_group","Compliance / Policy Update":"other"})[e]||"other",Tg=e=>({LOW:"low",MEDIUM:"medium",HIGH:"high",CRITICAL:"critical",EMERGENCY:"critical"})[e]||"medium",Pg=(e,s)=>{var n,o,i,l,c,d,u;const a=e.atlas_risk_score??50,r=Tg(e.risk_level);return{id:`TKT-${String(s+1).padStart(3,"0")}`,serviceNowId:e.ticket_number,title:e.short_description,description:e.business_justification,status:Sg(e.state),priority:Cg(e.priority),category:Ag(e.category),changeType:e.action==="DENY"?"delete":"add",assignee:((n=e.assigned_to)==null?void 0:n.name)||"Unassigned",requester:((o=e.requested_by)==null?void 0:o.email)||"unknown@company.com",createdAt:e.created_at,updatedAt:e.updated_at,scheduledAt:(i=e.change_window)==null?void 0:i.split(" to ")[0],completedAt:e.state==="Implemented"?e.updated_at:void 0,affectedResources:[{id:`res-${s}-src`,type:"Source System",name:e.source_system,platform:"aws"},{id:`res-${s}-dst`,type:"Destination System",name:e.destination_system,platform:"aws"}],riskAssessment:{score:a,level:r,factors:[{name:"Risk Score",impact:a>60?"negative":a>40?"neutral":"positive",weight:a,description:`Atlas risk score: ${a}`},...((c=(l=e.compliance_status)==null?void 0:l.violations)==null?void 0:c.length)>0?[{name:"Compliance Violations",impact:"negative",weight:20,description:`${e.compliance_status.violations.length} compliance violations`}]:[],...((d=e.additional_controls)==null?void 0:d.length)>0?[{name:"Additional Controls",impact:"positive",weight:-10,description:`Controls: ${e.additional_controls.join(", ")}`}]:[]],recommendation:r==="critical"?"Requires CISO approval and detailed review.":r==="high"?"Proceed with caution. Implement during maintenance window.":r==="medium"?"Standard approval process. Monitor after implementation.":"Low risk. Can proceed with minimal oversight."},approvalSteps:((u=e.approval_history)==null?void 0:u.map((p,h)=>({id:`step-${h+1}`,name:p.approver==="SYSTEM"?"Auto Approval":"Manual Review",approver:p.approver,status:p.action.toLowerCase().includes("approved")?"approved":p.action.toLowerCase().includes("rejected")?"rejected":"pending",timestamp:p.timestamp,comments:p.comments})))||[],rollbackPlan:e.rollback_plan??void 0}},ct=kg.tickets.map(Pg),wt=e=>new Promise(s=>setTimeout(s,e)),$t={async getTickets(e){var a,r,n;await wt(500);let s=[...ct];if((a=e==null?void 0:e.status)!=null&&a.length&&(s=s.filter(o=>e.status.includes(o.status))),(r=e==null?void 0:e.priority)!=null&&r.length&&(s=s.filter(o=>e.priority.includes(o.priority))),(n=e==null?void 0:e.category)!=null&&n.length&&(s=s.filter(o=>e.category.includes(o.category))),e!=null&&e.search){const o=e.search.toLowerCase();s=s.filter(i=>i.title.toLowerCase().includes(o)||i.description.toLowerCase().includes(o)||i.serviceNowId.toLowerCase().includes(o))}return s.sort((o,i)=>new Date(i.createdAt).getTime()-new Date(o.createdAt).getTime())},async getTicketById(e){return await wt(300),ct.find(s=>s.id===e)||null},async getTicketsByStatus(e){return await wt(300),ct.filter(s=>s.status===e)},async createTicket(e){await wt(1e3);const s=cc(e),a={id:`TKT-${String(ct.length+1).padStart(3,"0")}`,serviceNowId:`CHG00${12350+ct.length}`,title:e.title,description:e.description,status:"awaiting",priority:e.priority,category:e.category,changeType:e.changeType,assignee:"Unassigned",requester:"current.user@company.com",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),scheduledAt:e.scheduledAt,affectedResources:[],riskAssessment:s,approvalSteps:[{id:"step-1",name:"Security Review",approver:"Security Team",status:"pending"},{id:"step-2",name:"Manager Approval",approver:"Network Manager",status:"pending"}],rollbackPlan:e.rollbackPlan};return ct.push(a),a},async updateTicketStatus(e,s){await wt(500);const a=ct.find(r=>r.id===e);return a&&(a.status=s,a.updatedAt=new Date().toISOString(),s==="completed"&&(a.completedAt=new Date().toISOString())),a||null},async approveTicketStep(e,s,a){await wt(500);const r=ct.find(n=>n.id===e);if(r){const n=r.approvalSteps.find(i=>i.id===s);n&&(n.status="approved",n.timestamp=new Date().toISOString(),n.comments=a),r.updatedAt=new Date().toISOString(),r.approvalSteps.every(i=>i.status==="approved")&&(r.status="approved")}return r||null},async rejectTicketStep(e,s,a){await wt(500);const r=ct.find(n=>n.id===e);if(r){const n=r.approvalSteps.find(o=>o.id===s);n&&(n.status="rejected",n.timestamp=new Date().toISOString(),n.comments=a),r.status="rejected",r.updatedAt=new Date().toISOString()}return r||null},async calculateRisk(e){return await wt(800),cc(e)}};function cc(e){const s=[];let a=50;e.changeType==="delete"?(s.push({name:"Rule Removal",impact:"positive",weight:-20,description:"Removing rules generally reduces attack surface"}),a-=20):e.changeType==="add"&&(s.push({name:"New Rule",impact:"negative",weight:15,description:"New rules may increase exposure"}),a+=15),e.action==="deny"&&(s.push({name:"Deny Action",impact:"positive",weight:-15,description:"Deny rules improve security posture"}),a-=15),e.priority==="critical"&&(s.push({name:"Critical Priority",impact:"negative",weight:20,description:"Expedited changes may miss thorough review"}),a+=20),(e.sourceIp==="0.0.0.0/0"||e.sourceIp==="any")&&(s.push({name:"Any Source",impact:"negative",weight:30,description:"Allows traffic from any source IP"}),a+=30);const r=["80","443","22","3389"];e.port&&r.includes(e.port)&&(s.push({name:"Standard Port",impact:"positive",weight:-10,description:"Uses well-known standard port"}),a-=10);const n=Math.max(0,Math.min(100,a));let o,i;return n<30?(o="low",i="Low risk change. Can proceed with standard approval process."):n<50?(o="medium",i="Moderate risk. Recommend implementing during maintenance window."):n<75?(o="high",i="High risk change. Requires CAB approval and detailed rollback plan."):(o="critical",i="Critical risk. Requires CISO approval and must include monitoring plan."),{score:n,level:o,factors:s,recommendation:i}}function Ig(){const[e,s]=f.useState([]),[a,r]=f.useState([]),[n,o]=f.useState([]),[i,l]=f.useState({compliance:"0%",uptime:"0%",avgLatency:"0ms"}),[c,d]=f.useState(null),[u,p]=f.useState(!0),[h,y]=f.useState(null);return f.useEffect(()=>{(async()=>{try{p(!0);const[v,L,x,m,g]=await Promise.all([Th(),Ph(),Ih(),Oh(),Dh()]);s(v),r(L),o(x),l(m),d(g),y(null)}catch(v){y(v instanceof Error?v:new Error("Failed to fetch dashboard data"))}finally{p(!1)}})()},[]),{metrics:e,recentActivity:a,platformDistribution:n,summaryStats:i,networkStats:c,isLoading:u,error:h}}const Eg=({currentTime:e,userName:s="Admin"})=>t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-2xl font-bold text-white",children:["Welcome back, ",s]}),t.jsx("p",{className:"text-slate-400",children:"Here's what's happening across your infrastructure"})]}),t.jsx(oh,{time:e})]}),Rg=({metrics:e})=>t.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:e.map((s,a)=>t.jsx(lh,{label:s.label,value:s.value,change:s.change,trend:s.trend,icon:s.icon,color:s.color},a))}),Lg=({platforms:e,summaryStats:s})=>t.jsxs(b,{padding:"none",className:"overflow-hidden",children:[t.jsx("div",{className:"p-4 border-b border-slate-700",children:t.jsx($,{title:"Platform Distribution"})}),t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"space-y-4",children:e.map((a,r)=>t.jsx(Tm,{label:a.name,value:a.value,color:a.color},r))}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700 grid grid-cols-3 gap-4",children:[t.jsx(Mn,{label:"Compliance",value:s.compliance,valueColor:"text-emerald-400"}),t.jsx(Mn,{label:"Uptime",value:s.uptime,valueColor:"text-cyan-400"}),t.jsx(Mn,{label:"Avg Latency",value:s.avgLatency,valueColor:"text-purple-400"})]})]})]}),Og=({activities:e})=>t.jsxs(b,{padding:"none",className:"overflow-hidden",children:[t.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[t.jsx("h3",{className:"font-bold text-white",children:"Recent Activity"}),t.jsx("span",{className:"text-xs text-slate-400",children:"Last 24 hours"})]}),t.jsx("div",{className:"divide-y divide-slate-700",children:e.map(s=>t.jsx(Dg,{activity:s},s.id))})]}),Dg=({activity:e})=>t.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Fi,{status:e.status,size:"sm"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-sm font-medium",children:e.action}),t.jsxs("div",{className:"text-xs text-slate-400",children:[t.jsx("span",{className:"font-mono text-cyan-400",children:e.target}),t.jsx("span",{className:"mx-2",children:""}),t.jsx("span",{children:e.user})]})]})]}),t.jsx("span",{className:"text-xs text-slate-500",children:e.time})]})}),Mg=({onNavigate:e})=>{const s=[{id:"firewall-whitelisting",title:"Firewall Whitelisting (L1 Guided)",description:"L1 guided workflow for firewall rule creation with automated validation",icon:"",gradientFrom:"from-blue-600",gradientTo:"to-blue-800",route:"l1whitelisting",badge:"L1 Guided"},{id:"traffic-path-analysis",title:"Traffic Path Analysis",description:"Visualize network traffic flow across multi-cloud infrastructure with graph view",icon:"",gradientFrom:"from-purple-600",gradientTo:"to-purple-800",route:"pathanalysisenhanced"},{id:"multi-cloud-route-validation",title:"Multi-Cloud Route Validation",description:"Unified view of network routes across AWS, Azure, GCP, OCI & On-Prem",icon:"",gradientFrom:"from-cyan-600",gradientTo:"to-cyan-800",route:"multicloudvisibility"},{id:"firewall-patch-management",title:"Firewall Patch Management",description:"Track unpatched firewalls, CVE vulnerabilities, and security updates",icon:"",gradientFrom:"from-green-600",gradientTo:"to-green-800",route:"compliance"},{id:"compliance-drift-reports",title:"Compliance & Drift Reports",description:"Monitor compliance frameworks, detect configuration drift, and view audit reports",icon:"",gradientFrom:"from-amber-600",gradientTo:"to-amber-800",route:"compliance"},{id:"incident-root-cause-analysis",title:"Incident Root Cause Analysis",description:"AI-powered correlation and root cause identification for network incidents",icon:"",gradientFrom:"from-red-600",gradientTo:"to-red-800",route:"incidents"}];return t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Quick Access to Key Features"}),t.jsx("span",{className:"px-3 py-1 bg-cyan-500/20 text-cyan-400 rounded-full text-xs font-semibold border border-cyan-500/30",children:"6 Features"})]}),t.jsx("p",{className:"text-slate-400",children:"Click on any tile below to navigate directly to the feature. Each module provides specialized AI-powered capabilities for network operations."})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(a=>t.jsx("div",{onClick:()=>e(a.route),onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),e(a.route))},role:"button",tabIndex:0,"aria-label":`Navigate to ${a.title}`,className:"group cursor-pointer focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-slate-900 rounded-xl",children:t.jsx(b,{variant:"gradient",padding:"none",hover:!0,className:`bg-gradient-to-br ${a.gradientFrom} ${a.gradientTo} border-0 h-full overflow-hidden shadow-lg group-hover:shadow-2xl transition-shadow`,children:t.jsxs("div",{className:"p-6 relative",children:[t.jsx("div",{className:"absolute inset-0 opacity-10 group-hover:opacity-20 transition-opacity",children:t.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}})}),a.badge&&t.jsx("div",{className:"absolute top-4 right-4 z-10",children:t.jsx("span",{className:"px-2 py-1 bg-white/20 backdrop-blur-sm rounded-full text-xs font-semibold text-white border border-white/30",children:a.badge})}),t.jsx("div",{className:"mb-4 relative z-10",children:t.jsx("div",{className:"w-14 h-14 bg-white/10 backdrop-blur-sm rounded-xl flex items-center justify-center text-3xl group-hover:scale-110 group-hover:rotate-3 transition-all duration-300 shadow-lg",children:a.icon})}),t.jsxs("div",{className:"relative z-10",children:[t.jsx("h3",{className:"text-xl font-bold text-white mb-2 group-hover:translate-x-1 transition-transform",children:a.title}),t.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:a.description})]}),t.jsxs("div",{className:"mt-4 flex items-center text-white/60 group-hover:text-white group-hover:translate-x-2 transition-all relative z-10",children:[t.jsx("span",{className:"text-sm font-medium",children:"Launch Module"}),t.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})},a.id))})]})},Vg=e=>e<.1?"success":e<1?"warning":"error",ms=e=>e<60?"success":e<80?"warning":"error",Gg=({stats:e})=>{const s=Vg(e.packetDropRate);return t.jsx(b,{className:"bg-white shadow-lg h-full",children:t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Statistics"}),t.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Packet Drop Rate"}),t.jsxs(ve,{variant:s,children:[e.packetDropRate.toFixed(2),"%"]})]}),t.jsx(ra,{value:Math.min(e.packetDropRate*10,100),max:100,color:s==="success"?"green":s==="warning"?"yellow":"red"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s==="success"&&"Excellent - Network is performing well",s==="warning"&&"Elevated - Monitor for potential issues",s==="error"&&"Critical - Investigate immediately"]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Throughput"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsxs("div",{className:"text-lg font-bold text-green-600",children:[e.throughput.ingress.toFixed(1)," Gbps"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Ingress"})]}),t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[e.throughput.egress.toFixed(1)," Gbps"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Egress"})]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Connections"}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xl font-bold text-gray-900",children:e.connections.active.toLocaleString()}),t.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"active"})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("span",{className:"text-xl font-bold text-red-600",children:e.connections.blocked.toLocaleString()}),t.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"blocked/hr"})]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Latency"}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[t.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[t.jsxs("div",{className:"font-medium text-gray-900",children:[e.latency.avg,"ms"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Avg"})]}),t.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[t.jsxs("div",{className:"font-medium text-gray-900",children:[e.latency.p95,"ms"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"P95"})]}),t.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[t.jsxs("div",{className:"font-medium text-gray-900",children:[e.latency.p99,"ms"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"P99"})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Firewall Health"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[t.jsx("span",{children:"CPU"}),t.jsxs("span",{className:ms(e.firewallHealth.cpu)==="error"?"text-red-600":"",children:[e.firewallHealth.cpu,"%"]})]}),t.jsx(ra,{value:e.firewallHealth.cpu,max:100,color:ms(e.firewallHealth.cpu)==="success"?"blue":ms(e.firewallHealth.cpu)==="warning"?"yellow":"red"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[t.jsx("span",{children:"Memory"}),t.jsxs("span",{className:ms(e.firewallHealth.memory)==="error"?"text-red-600":"",children:[e.firewallHealth.memory,"%"]})]}),t.jsx(ra,{value:e.firewallHealth.memory,max:100,color:ms(e.firewallHealth.memory)==="success"?"blue":ms(e.firewallHealth.memory)==="warning"?"yellow":"red"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[t.jsx("span",{children:"Sessions"}),t.jsxs("span",{children:[e.firewallHealth.sessions,"%"]})]}),t.jsx(ra,{value:e.firewallHealth.sessions,max:100,color:"purple"})]})]})]})]})})},Hg=({onNavigate:e})=>{const s=Ou(),{metrics:a,recentActivity:r,platformDistribution:n,summaryStats:o,networkStats:i,isLoading:l}=Ig(),c=d=>{e&&e(d)};return l?t.jsx(J,{children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-slate-400",children:"Loading dashboard..."})})}):t.jsxs(J,{children:[t.jsx(Eg,{currentTime:s}),t.jsx(Rg,{metrics:a}),t.jsx(Mg,{onNavigate:c}),t.jsxs(Wi,{cols:3,children:[t.jsx(Lg,{platforms:n,summaryStats:o}),i&&t.jsx(Gg,{stats:i}),t.jsx(Og,{activities:r})]})]})},Fg={compliant:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30",label:"Compliant"},drift_detected:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30",label:"Drift Detected"},critical_drift:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30",label:"Critical Drift"},unknown:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30",label:"Unknown"}},Wg={critical:{color:"text-red-400",bg:"bg-red-500/20"},high:{color:"text-orange-400",bg:"bg-orange-500/20"},medium:{color:"text-amber-400",bg:"bg-amber-500/20"},low:{color:"text-yellow-400",bg:"bg-yellow-500/20"},info:{color:"text-blue-400",bg:"bg-blue-500/20"}},Ug=({drifts:e})=>{const[s,a]=f.useState(null),r=e.filter(i=>i.status==="critical_drift").length,n=e.filter(i=>i.status==="drift_detected").length,o=e.filter(i=>i.aiAnalysis.autoRemediationPossible).length;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Firewalls"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:e.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical Drift"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:r})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Drift Detected"}),t.jsx("p",{className:"text-3xl font-bold text-amber-400",children:n})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Remediation"}),t.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:o})]})]}),t.jsxs(b,{className:"p-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Policy Drift Detection"}),t.jsx("div",{className:"space-y-3",children:e.map(i=>{const l=Fg[i.status];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>a(i),children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h4",{className:"text-white font-semibold",children:i.firewallName}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:i.vendor.replace("_"," ").toUpperCase()}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${l.bg} ${l.border} ${l.color}`,children:l.label})]}),t.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:["Baseline: ",i.baselineName," v",i.baselineVersion]}),t.jsxs("p",{className:"text-slate-500 text-xs",children:["Location: ",i.location]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Drift Items"}),t.jsx("p",{className:"text-2xl font-bold text-white",children:i.driftItems.length})]})]}),i.aiAnalysis.violatesBaseline.length>0&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-600",children:[t.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[t.jsx("span",{className:"text-red-400 text-sm",children:""}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-red-400 text-sm font-medium mb-1",children:"Baseline Violations:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:i.aiAnalysis.violatesBaseline.map((c,d)=>t.jsx("span",{className:"px-2 py-1 bg-red-500/10 text-red-400 rounded text-xs",children:c},d))})]})]}),t.jsx("div",{className:"flex items-center gap-2 mt-2",children:i.aiAnalysis.autoRemediationPossible?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-emerald-400 text-sm",children:""}),t.jsx("span",{className:"text-emerald-400 text-sm font-medium",children:"Auto-remediation: Available"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-amber-400 text-sm",children:""}),t.jsx("span",{className:"text-amber-400 text-sm font-medium",children:"Auto-remediation: Manual Required"})]})})]})]},i.id)})})]}),s&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx("div",{className:"p-6 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:s.firewallName}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Drift Details & Remediation Plan"})]}),t.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Configuration Drift Items"}),t.jsx("div",{className:"space-y-3",children:s.driftItems.map(i=>{const l=Wg[i.severity];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("div",{className:"flex items-start justify-between mb-2",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${l.bg} ${l.color}`,children:i.severity.toUpperCase()}),t.jsx("span",{className:"px-2 py-1 bg-slate-600 text-slate-300 rounded text-xs",children:i.type.replace("_"," ").toUpperCase()})]})}),t.jsx("p",{className:"text-white font-medium mb-2",children:i.description}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Baseline:"}),t.jsx("p",{className:"text-slate-300 font-mono text-xs",children:i.baseline})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Current:"}),t.jsx("p",{className:"text-amber-400 font-mono text-xs",children:i.current})]})]}),t.jsx("div",{className:"mt-2 pt-2 border-t border-slate-600",children:t.jsxs("p",{className:"text-red-400 text-xs",children:["Impact: ",i.impact]})})]},i.id)})})]}),t.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsxs("h3",{className:"text-cyan-400 font-semibold mb-3 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"AI Analysis"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Reasoning:"}),t.jsx("p",{className:"text-white text-sm",children:s.aiAnalysis.reasoning})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Confidence Level:"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-emerald-500",style:{width:`${s.aiAnalysis.confidence*100}%`}})}),t.jsxs("span",{className:"text-white text-sm font-semibold",children:[(s.aiAnalysis.confidence*100).toFixed(0),"%"]})]})]}),s.aiAnalysis.autoRemediationPossible&&s.aiAnalysis.remediationSteps&&t.jsxs("div",{children:[t.jsx("p",{className:"text-emerald-400 text-sm font-medium mb-2",children:" Auto-Remediation Steps:"}),t.jsx("ol",{className:"space-y-1 ml-4",children:s.aiAnalysis.remediationSteps.map((i,l)=>t.jsxs("li",{className:"text-slate-300 text-sm",children:[l+1,". ",i]},l))})]})]})]})]}),t.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-between",children:[t.jsx("button",{className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Export Report"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),s.aiAnalysis.autoRemediationPossible&&t.jsx("button",{className:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-500 transition-colors",children:"Execute Auto-Remediation"})]})]})]})})]})},zg={unused:{color:"text-red-400",bg:"bg-red-500/20",label:"Unused",icon:""},low_usage:{color:"text-amber-400",bg:"bg-amber-500/20",label:"Low Usage",icon:""},high_usage:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"High Usage",icon:""},active:{color:"text-cyan-400",bg:"bg-cyan-500/20",label:"Active",icon:""}},$g=({hitCounts:e})=>{const s=e.filter(n=>n.status==="unused"),a=e.filter(n=>n.status==="low_usage"),r=e.filter(n=>n.autoRemediationPossible).length;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Rules"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:e.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Unused Rules"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:s.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Low Usage"}),t.jsx("p",{className:"text-3xl font-bold text-amber-400",children:a.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Removable"}),t.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:r})]})]}),t.jsxs(b,{className:"p-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Firewall Rule Hit Count Analysis"}),t.jsx("div",{className:"space-y-2",children:e.map(n=>{const o=zg[n.status];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 transition-colors",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("span",{className:"text-xl",children:o.icon}),t.jsx("h4",{className:"text-white font-semibold",children:n.ruleName}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:n.vendor.replace("_"," ").toUpperCase()}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${o.bg} ${o.color}`,children:o.label}),n.autoRemediationPossible&&t.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-xs",children:"Auto-Removable"})]}),t.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:["Firewall: ",n.firewallName]}),t.jsxs("p",{className:"text-slate-500 text-xs",children:["Rule ID: ",n.ruleId]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Hit Count"}),t.jsx("p",{className:"text-2xl font-bold text-white",children:n.hitCount.toLocaleString()}),t.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:[n.daysActive," days active"]})]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-600",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Last Hit:"}),t.jsx("p",{className:"text-white",children:n.lastHit?new Date(n.lastHit).toLocaleString():"Never"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Created:"}),t.jsx("p",{className:"text-white",children:new Date(n.createdAt).toLocaleDateString()})]})]}),t.jsx("div",{className:"mt-2",children:t.jsxs("p",{className:"text-cyan-400 text-sm",children:[" Recommendation: ",n.recommendation]})})]})]},n.id)})})]})]})},Bg={critical:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30"},high:{color:"text-orange-400",bg:"bg-orange-500/20",border:"border-orange-500/30"},medium:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30"},low:{color:"text-yellow-400",bg:"bg-yellow-500/20",border:"border-yellow-500/30"},info:{color:"text-blue-400",bg:"bg-blue-500/20",border:"border-blue-500/30"}},Zg={aws:"bg-orange-500/20 text-orange-400",azure:"bg-blue-500/20 text-blue-400",gcp:"bg-red-500/20 text-red-400",oci:"bg-orange-600/20 text-orange-500"},qg=({violations:e})=>{var i;const[s,a]=f.useState(null),r=e.filter(l=>l.severity==="critical").length,n=e.filter(l=>l.severity==="high").length,o=e.filter(l=>l.aiRemediation.autoRemediationPossible).length;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Violations"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:e.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:r})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"High Severity"}),t.jsx("p",{className:"text-3xl font-bold text-orange-400",children:n})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Fixable"}),t.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:o})]})]}),t.jsxs(b,{className:"p-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Cloud NSG/Security Group Violations"}),t.jsx("div",{className:"space-y-3",children:e.map(l=>{const c=Bg[l.severity],d=Zg[l.provider];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>a(l),children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${c.bg} ${c.border} ${c.color}`,children:l.severity.toUpperCase()}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${d}`,children:l.provider.toUpperCase()}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:l.resourceType.replace("_"," ")})]}),t.jsx("h4",{className:"text-white font-semibold mb-1",children:l.resourceName}),t.jsx("p",{className:"text-slate-400 text-sm mb-2",children:l.description}),t.jsxs("p",{className:"text-slate-500 text-xs",children:["Region: ",l.region," | Account: ",l.accountId]})]})}),l.baselineViolation&&t.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-red-400",children:""}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-red-400 text-sm font-medium mb-1",children:["Violates: ",l.baselineViolation.baselineName]}),t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:l.baselineViolation.requirement}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:l.baselineViolation.complianceFramework.map((u,p)=>t.jsx("span",{className:"px-2 py-0.5 bg-red-500/10 text-red-400 rounded text-xs",children:u},p))})]})]})}),t.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600",children:l.aiRemediation.autoRemediationPossible?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-emerald-400",children:""}),t.jsxs("span",{className:"text-emerald-400 text-sm font-medium",children:["Auto-remediation available (",l.aiRemediation.estimatedTime,")"]})]}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-amber-400",children:""}),t.jsx("span",{className:"text-amber-400 text-sm font-medium",children:"Manual remediation required"})]})})]},l.id)})})]}),s&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx("div",{className:"p-6 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:s.resourceName}),t.jsx("p",{className:"text-slate-400 text-sm",children:s.description})]}),t.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Affected Rules"}),t.jsx("div",{className:"space-y-2",children:s.affectedRules.map(l=>t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded border border-slate-600",children:[t.jsx("p",{className:"text-white font-medium mb-2",children:l.ruleName}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Protocol:"}),t.jsx("p",{className:"text-white font-mono",children:l.protocol})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Port Range:"}),t.jsx("p",{className:"text-white font-mono",children:l.portRange})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Source:"}),t.jsx("p",{className:"text-white font-mono text-xs",children:l.sourceRange})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Destination:"}),t.jsx("p",{className:"text-white font-mono text-xs",children:l.destinationRange})]})]}),t.jsxs("p",{className:"text-red-400 text-xs mt-2",children:[" ",l.issue]})]},l.ruleId))})]}),t.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsx("h3",{className:"text-cyan-400 font-semibold mb-3",children:"AI Remediation Plan"}),t.jsx("p",{className:"text-slate-300 text-sm mb-3",children:s.aiRemediation.reasoning}),s.aiRemediation.autoRemediationPossible&&s.aiRemediation.remediationPlan?t.jsxs("div",{children:[t.jsx("p",{className:"text-emerald-400 text-sm font-medium mb-2",children:"Automated Steps:"}),t.jsx("ol",{className:"space-y-1 ml-4",children:s.aiRemediation.remediationPlan.map((l,c)=>t.jsxs("li",{className:"text-slate-300 text-sm",children:[c+1,". ",l]},c))}),t.jsxs("p",{className:"text-slate-400 text-xs mt-3",children:["Estimated Time: ",s.aiRemediation.estimatedTime," | Risk: ",s.aiRemediation.riskLevel]})]}):t.jsxs("div",{children:[t.jsx("p",{className:"text-amber-400 text-sm font-medium mb-2",children:"Manual Steps Required:"}),t.jsx("ol",{className:"space-y-1 ml-4",children:(i=s.aiRemediation.manualSteps)==null?void 0:i.map((l,c)=>t.jsxs("li",{className:"text-slate-300 text-sm",children:[c+1,". ",l]},c))})]})]})]}),t.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),s.aiRemediation.autoRemediationPossible&&t.jsx("button",{className:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-500 transition-colors",children:"Execute Remediation"})]})]})})]})},Kg={expired:{color:"text-red-400",bg:"bg-red-500/20",label:"Expired",icon:""},expiring_soon:{color:"text-amber-400",bg:"bg-amber-500/20",label:"Expiring Soon",icon:""},active:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Active",icon:""},removed:{color:"text-slate-400",bg:"bg-slate-500/20",label:"Removed",icon:""}},Qg={low:{color:"text-emerald-400",label:"Low Risk"},medium:{color:"text-amber-400",label:"Medium Risk"},high:{color:"text-red-400",label:"High Risk"}},Yg=({whitelists:e})=>{const s=e.filter(n=>n.status==="expired"),a=e.filter(n=>n.status==="expiring_soon"),r=e.filter(n=>n.autoRemovalPossible&&n.status==="expired").length;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Whitelists"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:e.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Expired"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:s.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Expiring Soon"}),t.jsx("p",{className:"text-3xl font-bold text-amber-400",children:a.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Removable"}),t.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:r})]})]}),t.jsxs(b,{className:"p-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Expired & Expiring Whitelist Rules"}),t.jsx("div",{className:"space-y-3",children:e.map(n=>{const o=Kg[n.status],i=Qg[n.removalRisk];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"text-xl",children:o.icon}),t.jsx("h4",{className:"text-white font-semibold",children:n.ruleName}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${o.bg} ${o.color}`,children:o.label}),n.status==="expired"&&t.jsxs("span",{className:"px-2 py-1 bg-red-500/10 text-red-400 rounded text-xs",children:[n.daysOverdue," days overdue"]}),n.autoRemovalPossible&&n.status==="expired"&&t.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-xs",children:"Auto-Removable"})]}),t.jsxs("p",{className:"text-slate-400 text-sm mb-1",children:["Firewall: ",n.firewallName]}),t.jsxs("p",{className:"text-slate-400 text-sm",children:["Ticket: ",n.ticketId," | Requested by: ",n.requestedBy]})]}),t.jsx("div",{className:"text-right",children:t.jsx("p",{className:`${i.color} text-sm font-medium`,children:i.label})})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-3 p-3 bg-slate-800/50 rounded",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Source IP"}),t.jsx("p",{className:"text-white font-mono text-sm",children:n.sourceIp})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Destination IP"}),t.jsx("p",{className:"text-white font-mono text-sm",children:n.destinationIp})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Port"}),t.jsx("p",{className:"text-white font-mono text-sm",children:n.port})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Protocol"}),t.jsx("p",{className:"text-white font-mono text-sm",children:n.protocol.toUpperCase()})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Created:"}),t.jsx("p",{className:"text-white",children:new Date(n.createdAt).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Expires:"}),t.jsx("p",{className:"text-white",children:new Date(n.expiresAt).toLocaleDateString()})]})]}),t.jsxs("div",{className:"mb-3 p-3 bg-slate-800/50 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Business Justification:"}),t.jsx("p",{className:"text-slate-300 text-sm",children:n.businessJustification})]}),t.jsx("div",{className:"pt-3 border-t border-slate-600",children:t.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[t.jsx("span",{className:"text-cyan-400",children:""}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-cyan-400 text-sm font-medium mb-1",children:"AI Analysis:"}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400",children:"Still in Use:"}),t.jsx("p",{className:n.aiAnalysis.stillInUse?"text-amber-400 font-medium":"text-emerald-400 font-medium",children:n.aiAnalysis.stillInUse?"Yes":"No"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400",children:"Usage Count:"}),t.jsx("p",{className:"text-white font-medium",children:n.aiAnalysis.usageCount})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400",children:"Last Used:"}),t.jsx("p",{className:"text-white font-medium",children:n.aiAnalysis.lastUsed?new Date(n.aiAnalysis.lastUsed).toLocaleDateString():"Never"})]})]}),t.jsx("p",{className:"text-slate-300 text-sm mt-2",children:n.aiAnalysis.removalImpact}),t.jsxs("p",{className:"text-emerald-400 text-sm mt-1",children:[" ",n.aiAnalysis.recommendation]})]})]})})]},n.id)})})]})]})},Xg={critical:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30",label:"Critical",icon:""},high_priority:{color:"text-orange-400",bg:"bg-orange-500/20",border:"border-orange-500/30",label:"High Priority",icon:""},normal:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30",label:"Normal",icon:""},up_to_date:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30",label:"Up to Date",icon:""}},dc={critical:{color:"text-red-400",bg:"bg-red-500/20"},high:{color:"text-orange-400",bg:"bg-orange-500/20"},medium:{color:"text-amber-400",bg:"bg-amber-500/20"},low:{color:"text-yellow-400",bg:"bg-yellow-500/20"},info:{color:"text-blue-400",bg:"bg-blue-500/20"}},Jg=({firewalls:e})=>{const[s,a]=f.useState(null),r=e.filter(i=>i.patchStatus==="critical").length,n=e.reduce((i,l)=>i+l.vulnerabilities.length,0),o=e.filter(i=>i.autoUpdateSupported).length;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Firewalls"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:e.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:r})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Vulnerabilities"}),t.jsx("p",{className:"text-3xl font-bold text-orange-400",children:n})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Update"}),t.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:o})]})]}),t.jsxs(b,{className:"p-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Firewall Patch Status"}),t.jsx("div",{className:"space-y-3",children:e.map(i=>{const l=Xg[i.patchStatus];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>a(i),children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("span",{className:"text-2xl",children:l.icon}),t.jsx("h4",{className:"text-white font-semibold",children:i.firewallName}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:i.vendor.replace("_"," ").toUpperCase()}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${l.bg} ${l.border} ${l.color}`,children:l.label}),i.autoUpdateSupported&&t.jsx("span",{className:"px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:"Auto-Update Available"})]}),t.jsxs("p",{className:"text-slate-400 text-sm",children:["Location: ",i.location]})]}),t.jsx("div",{className:"text-right",children:i.patchStatus!=="up_to_date"&&t.jsxs("p",{className:"text-red-400 text-sm font-medium",children:[i.daysOutdated," days outdated"]})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 p-3 bg-slate-800/50 rounded",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Current Version"}),t.jsx("p",{className:"text-white font-mono text-sm",children:i.currentVersion})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Latest Version"}),t.jsx("p",{className:"text-emerald-400 font-mono text-sm",children:i.latestVersion})]})]}),i.vulnerabilities.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("p",{className:"text-red-400 text-sm font-medium mb-2",children:[" Known Vulnerabilities (",i.vulnerabilities.length,"):"]}),t.jsxs("div",{className:"space-y-2",children:[i.vulnerabilities.slice(0,2).map(c=>{const d=dc[c.severity];return t.jsxs("div",{className:"p-2 bg-slate-800/50 rounded",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${d.bg} ${d.color}`,children:c.severity.toUpperCase()}),t.jsx("span",{className:"text-white font-mono text-xs",children:c.cveId}),c.exploitAvailable&&t.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs",children:"Exploit Available"})]}),t.jsx("p",{className:"text-slate-300 text-xs",children:c.description})]},c.cveId)}),i.vulnerabilities.length>2&&t.jsxs("p",{className:"text-slate-400 text-xs text-center",children:["+",i.vulnerabilities.length-2," more vulnerabilities"]})]})]}),i.complianceImpact.length>0&&t.jsxs("div",{className:"mb-3 pt-3 border-t border-slate-600",children:[t.jsx("p",{className:"text-amber-400 text-sm mb-2",children:"Compliance Impact:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:i.complianceImpact.map((c,d)=>t.jsx("span",{className:"px-2 py-1 bg-amber-500/10 text-amber-400 rounded text-xs",children:c},d))})]}),i.maintenanceWindow&&t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-cyan-400",children:""}),t.jsx("span",{className:"text-slate-400",children:"Maintenance Window:"}),t.jsx("span",{className:"text-white",children:new Date(i.maintenanceWindow).toLocaleString()})]})]},i.id)})})]}),s&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx("div",{className:"p-6 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:s.firewallName}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Patch Details & Vulnerability Information"})]}),t.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"All Vulnerabilities"}),t.jsx("div",{className:"space-y-3",children:s.vulnerabilities.map(i=>{const l=dc[i.severity];return t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${l.bg} ${l.color}`,children:i.severity.toUpperCase()}),t.jsx("span",{className:"text-white font-mono",children:i.cveId}),i.exploitAvailable&&t.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-semibold",children:" Exploit Available"})]}),t.jsx("p",{className:"text-white mb-2",children:i.description}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Published:"}),t.jsx("p",{className:"text-white",children:new Date(i.published).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Patched In:"}),t.jsx("p",{className:"text-emerald-400 font-mono",children:i.patchedInVersion})]})]})]},i.cveId)})})]}),s.affectedServices.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Affected Services"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:s.affectedServices.map((i,l)=>t.jsx("span",{className:"px-3 py-2 bg-amber-500/10 text-amber-400 rounded border border-amber-500/30",children:i},l))})]}),t.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsx("h3",{className:"text-cyan-400 font-semibold mb-2",children:"Update Risk Assessment"}),t.jsxs("p",{className:"text-white text-sm",children:["Update Risk: ",t.jsx("span",{className:"font-semibold",children:s.updateRisk.toUpperCase()})]}),s.autoUpdateSupported&&t.jsx("p",{className:"text-emerald-400 text-sm mt-2",children:" Automatic updates supported for this firewall"})]})]}),t.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),t.jsx("button",{className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors",children:"Schedule Update"})]})]})})]})},ex=[{id:"drift-001",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",location:"us-east-1",status:"critical_drift",baselineName:"PCI-DSS Production Baseline",baselineVersion:"2.1.0",driftDetectedAt:"2024-01-18T14:30:00Z",driftItems:[{id:"drift-item-001",type:"rule_added",description:"Unauthorized rule allowing RDP from internet",severity:"critical",baseline:"No RDP access from 0.0.0.0/0",current:"RDP allowed from 0.0.0.0/0 on port 3389",impact:"Critical security exposure - PCI-DSS violation"},{id:"drift-item-002",type:"rule_modified",description:"Management access rule expanded beyond approved IPs",severity:"high",baseline:"Management access: 10.0.0.0/24",current:"Management access: 0.0.0.0/0",impact:"Increases attack surface for management interface"},{id:"drift-item-003",type:"config_changed",description:"Logging disabled for denied traffic",severity:"medium",baseline:"Log all denied traffic",current:"Logging disabled",impact:"Audit trail incomplete - SOC2 non-compliance"}],aiAnalysis:{violatesBaseline:["PCI-DSS Requirement 1.3.2","CIS AWS 5.2","SOC2 CC6.1"],autoRemediationPossible:!0,remediationSteps:["Remove unauthorized RDP rule (id: rule-12345)","Revert management access rule to 10.0.0.0/24","Re-enable logging for denied traffic","Create change ticket for audit trail"],confidence:.95,reasoning:"Changes detected are clear violations of baseline policy. All modifications can be automatically reverted without service disruption.",estimatedImpact:"low"},remediationStatus:"possible"},{id:"drift-002",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",vendor:"cisco_asa",location:"us-west-2",status:"drift_detected",baselineName:"Branch Office Standard",baselineVersion:"1.5.2",driftDetectedAt:"2024-01-19T09:15:00Z",driftItems:[{id:"drift-item-004",type:"rule_added",description:"New HTTPS rule for third-party vendor",severity:"medium",baseline:"No third-party vendor access",current:"HTTPS access to 192.168.100.0/24",impact:"Requires approval from security team"}],aiAnalysis:{violatesBaseline:["Internal Policy Section 4.2.1"],autoRemediationPossible:!1,confidence:.88,reasoning:"Rule appears to be intentional for business need. Requires security team review before removal.",estimatedImpact:"medium"},remediationStatus:"manual_required"},{id:"drift-003",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",vendor:"fortinet",location:"eu-west-1",status:"compliant",baselineName:"DMZ Hardening Standard",baselineVersion:"3.0.1",driftDetectedAt:"2024-01-15T08:00:00Z",driftItems:[],aiAnalysis:{violatesBaseline:[],autoRemediationPossible:!1,confidence:1,reasoning:"Configuration matches baseline perfectly. No violations detected.",estimatedImpact:"low"},remediationStatus:"completed"}],Zn=[{id:"hitcount-001",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",ruleName:"Legacy-App-Access",ruleId:"rule-54321",hitCount:0,lastHit:null,createdAt:"2023-03-15T10:00:00Z",daysActive:310,status:"unused",recommendation:"Rule has not been used in 310 days. Consider removing to reduce policy complexity.",autoRemediationPossible:!0},{id:"hitcount-002",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",ruleName:"Temp-Contractor-VPN",ruleId:"rule-67890",hitCount:3,lastHit:"2023-11-20T15:30:00Z",createdAt:"2023-11-01T09:00:00Z",daysActive:79,status:"low_usage",recommendation:"Low usage detected. Last hit 60 days ago. Verify if still needed.",autoRemediationPossible:!1},{id:"hitcount-003",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",vendor:"cisco_asa",ruleName:"Production-API-Gateway",ruleId:"rule-11111",hitCount:1547892,lastHit:"2024-01-19T12:45:00Z",createdAt:"2023-01-10T08:00:00Z",daysActive:374,status:"high_usage",recommendation:"Critical production rule. Do not remove.",autoRemediationPossible:!1},{id:"hitcount-004",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",vendor:"fortinet",ruleName:"Holiday-Sales-Promo",ruleId:"rule-22222",hitCount:0,lastHit:null,createdAt:"2023-12-01T00:00:00Z",daysActive:49,status:"unused",recommendation:"Promotional rule never used. Created for Black Friday event. Safe to remove.",autoRemediationPossible:!0},{id:"hitcount-005",firewallName:"CP-HQ-FW-01",firewallId:"cp-001",vendor:"checkpoint",ruleName:"Test-Environment-Access",ruleId:"rule-33333",hitCount:1,lastHit:"2024-01-05T10:00:00Z",createdAt:"2024-01-05T09:55:00Z",daysActive:14,status:"low_usage",recommendation:"Test rule with minimal usage. Validate if still required.",autoRemediationPossible:!1}],tx=[{id:"violation-001",provider:"aws",resourceType:"security_group",resourceName:"prod-web-sg",resourceId:"sg-0123456789abcdef0",region:"us-east-1",accountId:"123456789012",violationType:"open_to_internet",severity:"critical",description:"Security group allows SSH access from entire internet",detectedAt:"2024-01-19T08:00:00Z",affectedRules:[{ruleId:"sgr-001",ruleName:"Allow SSH",protocol:"tcp",sourceRange:"0.0.0.0/0",destinationRange:"sg-0123456789abcdef0",portRange:"22",action:"allow",issue:"SSH exposed to internet - brute force risk"}],baselineViolation:{baselineName:"AWS Production Security Baseline",requirement:"SSH access must be restricted to corporate VPN range",expectedValue:"10.0.0.0/8",actualValue:"0.0.0.0/0",complianceFramework:["CIS AWS 5.2","NIST 800-53 AC-4"]},aiRemediation:{autoRemediationPossible:!0,remediationPlan:["Identify legitimate SSH source IPs from VPC Flow Logs","Update security group rule to restrict to 10.0.0.0/8","Verify connectivity after change","Document change in CMDB"],estimatedTime:"5 minutes",riskLevel:"low",reasoning:"SSH restriction is standard security practice. VPC Flow Logs show all legitimate access comes from corporate VPN range."}},{id:"violation-002",provider:"azure",resourceType:"nsg",resourceName:"prod-db-nsg",resourceId:"/subscriptions/xxx/resourceGroups/prod-rg/providers/Microsoft.Network/networkSecurityGroups/prod-db-nsg",region:"eastus",accountId:"sub-12345",violationType:"unauthorized_port",severity:"high",description:"Database port exposed to wider range than approved",detectedAt:"2024-01-18T16:30:00Z",affectedRules:[{ruleId:"nsg-rule-001",ruleName:"Allow-MySQL",protocol:"tcp",sourceRange:"172.16.0.0/16",destinationRange:"10.1.2.0/24",portRange:"3306",action:"allow",issue:"Source range exceeds approved application subnets"}],baselineViolation:{baselineName:"Azure Database Security Standard",requirement:"Database access restricted to application tier only",expectedValue:"172.16.10.0/24, 172.16.11.0/24",actualValue:"172.16.0.0/16",complianceFramework:["PCI-DSS 1.3.2","Azure CIS 6.4"]},aiRemediation:{autoRemediationPossible:!0,remediationPlan:["Replace broad /16 range with specific application subnets","Update NSG rule to: 172.16.10.0/24, 172.16.11.0/24","Test application connectivity","Monitor for any connection failures"],estimatedTime:"10 minutes",riskLevel:"medium",reasoning:"Legitimate application traffic uses only specific subnets. NSG flow logs confirm no traffic from other subnets in /16 range."}},{id:"violation-003",provider:"gcp",resourceType:"firewall_policy",resourceName:"dev-allow-all",resourceId:"projects/project-123/global/firewalls/dev-allow-all",region:"us-central1",accountId:"project-123",violationType:"overly_permissive",severity:"high",description:"Development firewall rule allows all protocols from anywhere",detectedAt:"2024-01-19T10:00:00Z",affectedRules:[{ruleId:"fw-rule-001",ruleName:"dev-allow-all",protocol:"all",sourceRange:"0.0.0.0/0",destinationRange:"10.10.0.0/16",portRange:"all",action:"allow",issue:"Permits any protocol/port from internet to dev environment"}],baselineViolation:{baselineName:"GCP Network Security Baseline",requirement:"Development environments must follow principle of least privilege",expectedValue:"Specific protocols and ports only",actualValue:"all/all from 0.0.0.0/0",complianceFramework:["GCP CIS 3.7","GDPR Article 32"]},aiRemediation:{autoRemediationPossible:!1,manualSteps:["Audit actual development usage patterns","Create specific rules for SSH (22), HTTP (80), HTTPS (443)","Restrict sources to developer VPN range","Remove overly permissive rule after validation"],estimatedTime:"30 minutes",riskLevel:"high",reasoning:"Development environment may have legitimate need for various protocols. Manual review required to avoid breaking developer workflows."}}],uc=[{id:"expired-001",ticketId:"INC0012345",ruleName:"Temp-Partner-API-Access",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",location:"us-east-1",sourceIp:"203.0.113.50",destinationIp:"10.100.50.100",port:"8443",protocol:"tcp",createdAt:"2023-10-01T09:00:00Z",expiresAt:"2023-12-31T23:59:59Z",status:"expired",daysOverdue:19,requestedBy:"john.doe@company.com",businessJustification:"Temporary API access for Partner XYZ integration testing",autoRemovalPossible:!0,removalRisk:"low",aiAnalysis:{stillInUse:!1,lastUsed:"2023-11-15T14:30:00Z",usageCount:47,removalImpact:"No traffic detected in last 65 days. Safe to remove.",recommendation:"Auto-remove: No recent usage, project completed, expired 19 days ago."}},{id:"expired-002",ticketId:"CHG0034567",ruleName:"Q4-Vendor-FTP-Access",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",location:"us-west-2",sourceIp:"198.51.100.0/24",destinationIp:"172.16.20.50",port:"21",protocol:"tcp",createdAt:"2023-09-01T00:00:00Z",expiresAt:"2023-12-31T23:59:59Z",status:"expired",daysOverdue:19,requestedBy:"finance@company.com",businessJustification:"Q4 financial data transfer to external auditor",autoRemovalPossible:!1,removalRisk:"medium",aiAnalysis:{stillInUse:!0,lastUsed:"2024-01-18T08:00:00Z",usageCount:234,removalImpact:"Active usage detected. Recent connection 1 day ago. May impact ongoing operations.",recommendation:"Manual review required: Rule expired but still actively used. Contact requester to extend or find alternative."}},{id:"expired-003",ticketId:"INC0045678",ruleName:"Emergency-Support-Access",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",location:"eu-west-1",sourceIp:"192.0.2.100",destinationIp:"10.50.100.200",port:"22",protocol:"tcp",createdAt:"2024-01-10T18:00:00Z",expiresAt:"2024-01-17T18:00:00Z",status:"expired",daysOverdue:2,requestedBy:"ops-team@company.com",businessJustification:"Emergency SSH access for critical incident resolution",autoRemovalPossible:!0,removalRisk:"low",aiAnalysis:{stillInUse:!1,lastUsed:"2024-01-12T20:15:00Z",usageCount:8,removalImpact:"Incident resolved. No usage in last 7 days. Safe to remove.",recommendation:"Auto-remove: Emergency access no longer needed, incident closed."}},{id:"expiring-001",ticketId:"CHG0056789",ruleName:"Contractor-Remote-Access",firewallName:"CP-HQ-FW-01",firewallId:"cp-001",location:"us-east-2",sourceIp:"203.0.113.0/24",destinationIp:"10.200.50.0/24",port:"443",protocol:"tcp",createdAt:"2023-12-01T00:00:00Z",expiresAt:"2024-01-31T23:59:59Z",status:"expiring_soon",daysOverdue:0,requestedBy:"hr@company.com",businessJustification:"Contractor access for Q4 project work",autoRemovalPossible:!0,removalRisk:"low",aiAnalysis:{stillInUse:!0,lastUsed:"2024-01-19T11:00:00Z",usageCount:567,removalImpact:"Expires in 12 days. Currently active. Consider extension if contractor still working.",recommendation:"Notify requester: Rule expires soon. Extend if contractor engagement continues."}}],sx=[{id:"unpatched-001",firewallName:"PA-DC-FW-01",firewallId:"pa-fw-001",vendor:"palo_alto",location:"us-east-1",currentVersion:"10.1.9",latestVersion:"10.1.14",patchStatus:"critical",daysOutdated:45,vulnerabilities:[{cveId:"CVE-2023-12345",severity:"critical",description:"Remote code execution in management interface",exploitAvailable:!0,patchedInVersion:"10.1.10",published:"2023-12-01"},{cveId:"CVE-2023-54321",severity:"high",description:"Authentication bypass in web UI",exploitAvailable:!1,patchedInVersion:"10.1.12",published:"2023-12-15"}],maintenanceWindow:"2024-01-27T02:00:00Z",autoUpdateSupported:!0,updateRisk:"low",affectedServices:["Production Web Traffic","API Gateway"],complianceImpact:["PCI-DSS 6.2","SOC2 CC7.1","ISO 27001 A.12.6.1"]},{id:"unpatched-002",firewallName:"ASA-BRANCH-01",firewallId:"asa-001",vendor:"cisco_asa",location:"us-west-2",currentVersion:"9.16.3",latestVersion:"9.16.5",patchStatus:"high_priority",daysOutdated:30,vulnerabilities:[{cveId:"CVE-2024-11111",severity:"high",description:"Denial of service in VPN subsystem",exploitAvailable:!1,patchedInVersion:"9.16.4",published:"2024-01-05"}],maintenanceWindow:null,autoUpdateSupported:!1,updateRisk:"medium",affectedServices:["Branch Office VPN","Remote Access"],complianceImpact:["CIS Cisco ASA 1.1.2"]},{id:"unpatched-003",firewallName:"FGT-DMZ-01",firewallId:"fgt-001",vendor:"fortinet",location:"eu-west-1",currentVersion:"7.2.5",latestVersion:"7.2.6",patchStatus:"normal",daysOutdated:15,vulnerabilities:[{cveId:"CVE-2024-22222",severity:"medium",description:"Information disclosure in logging subsystem",exploitAvailable:!1,patchedInVersion:"7.2.6",published:"2024-01-10"}],maintenanceWindow:"2024-02-10T01:00:00Z",autoUpdateSupported:!0,updateRisk:"low",affectedServices:["DMZ Services","Public Web Servers"],complianceImpact:[]},{id:"uptodate-001",firewallName:"CP-HQ-FW-01",firewallId:"cp-001",vendor:"checkpoint",location:"us-east-2",currentVersion:"R81.20",latestVersion:"R81.20",patchStatus:"up_to_date",daysOutdated:0,vulnerabilities:[],maintenanceWindow:null,autoUpdateSupported:!0,updateRisk:"low",affectedServices:[],complianceImpact:[]}],q={totalFirewalls:12,firewallsWithDrift:3,totalNSGViolations:47,criticalViolations:8,expiredWhitelists:15,unpatchedFirewalls:3,autoRemediationAvailable:28,complianceScore:78,byFramework:{"PCI-DSS":{score:82,passed:47,failed:11,status:"partial"},SOC2:{score:88,passed:52,failed:7,status:"partial"},"CIS AWS":{score:75,passed:38,failed:12,status:"partial"},"NIST 800-53":{score:91,passed:64,failed:6,status:"compliant"},"ISO 27001":{score:85,passed:45,failed:8,status:"partial"}}},ee={id:"audit-2024-01",generatedAt:"2024-01-19T14:00:00Z",period:{from:"2024-01-01T00:00:00Z",to:"2024-01-19T23:59:59Z"},summary:{totalFirewalls:12,autoRemediationAvailable:28,complianceScore:78,byFramework:{"PCI-DSS":{score:82,passed:47,failed:11,status:"partial"},SOC2:{score:88,passed:52,failed:7,status:"partial"},"CIS AWS":{score:75,passed:38,failed:12,status:"partial"},"NIST 800-53":{score:91,passed:64,failed:6,status:"compliant"},"ISO 27001":{score:85,passed:45,failed:8,status:"partial"}}},findings:[{id:"finding-001",category:"Firewall Policy Drift",severity:"critical",finding:"PA-DC-FW-01: Unauthorized RDP access rule from internet detected",evidence:['Rule "Allow-RDP-All" permits TCP/3389 from 0.0.0.0/0',"Added on 2024-01-18 14:30 UTC without change request","Violates PCI-DSS Requirement 1.3.2","Violates CIS AWS Benchmark 5.2"],remediation:"Remove unauthorized RDP rule and restrict management access to corporate VPN range (10.0.0.0/24). Create change ticket for audit trail.",status:"open"},{id:"finding-002",category:"Cloud NSG Violations",severity:"critical",finding:"AWS Security Group sg-0123456789abcdef0: SSH exposed to entire internet",evidence:['Security group "prod-web-sg" allows TCP/22 from 0.0.0.0/0',"Production workload exposure to brute force attacks","VPC Flow Logs show legitimate SSH only from 10.0.0.0/8","Violates AWS Security Best Practices"],remediation:"Update security group ingress rule to restrict SSH access to corporate VPN range (10.0.0.0/8). Verify connectivity post-change.",status:"in_progress"},{id:"finding-003",category:"Unpatched Firewalls",severity:"critical",finding:"PA-DC-FW-01: Running outdated version with 2 critical CVEs",evidence:["Current version: 10.1.9 (45 days outdated)","CVE-2023-12345: Remote code execution in management interface (CVSS 9.8)","CVE-2023-54321: Authentication bypass in web UI (CVSS 8.1)","Exploits publicly available for CVE-2023-12345"],remediation:"Schedule emergency maintenance to upgrade to version 10.1.14. Patch addresses all known critical vulnerabilities. Maintenance window: 2024-01-27 02:00 UTC.",status:"open"},{id:"finding-004",category:"Expired Whitelists",severity:"high",finding:"15 firewall rules expired and still active in production",evidence:["INC0012345: Temp-Partner-API-Access expired 19 days ago (no recent usage)","CHG0034567: Q4-Vendor-FTP-Access expired 19 days ago (still in active use)","13 additional expired rules identified across multiple firewalls","Average expiration overage: 14 days"],remediation:"Implement automated expiration checking. Remove unused expired rules (8 identified). Extend or replace actively-used expired rules (7 identified). Notify requesters for business validation.",status:"open"},{id:"finding-005",category:"Cloud NSG Violations",severity:"high",finding:"Azure NSG prod-db-nsg: Database access overly permissive",evidence:["MySQL port 3306 accessible from entire /16 range (172.16.0.0/16)","Baseline requires access limited to application tier subnets only","Flow logs confirm traffic only from 172.16.10.0/24 and 172.16.11.0/24","Violates PCI-DSS Requirement 1.3.2"],remediation:"Update NSG rule to restrict MySQL access to approved application subnets: 172.16.10.0/24, 172.16.11.0/24. Test application connectivity. Monitor for connection failures.",status:"open"},{id:"finding-006",category:"Firewall Rule Hit Count",severity:"medium",finding:"7 unused firewall rules identified across fleet",evidence:["PA-DC-FW-01: Legacy-App-Access (0 hits, 310 days active)","FGT-DMZ-01: Holiday-Sales-Promo (0 hits, 49 days active)","5 additional rules with zero hit count","Combined: 357 days of unused rule-base complexity"],remediation:"Remove unused rules to reduce policy complexity and improve firewall performance. Auto-removal available for rules with zero usage and no business justification.",status:"open"},{id:"finding-007",category:"Cloud NSG Violations",severity:"high",finding:"GCP Firewall dev-allow-all: Overly permissive development environment",evidence:["Firewall rule permits all protocols/ports from internet to dev environment","Development VPC (10.10.0.0/16) exposed to unnecessary risk","Violates principle of least privilege","GCP CIS Benchmark 3.7 violation"],remediation:"Audit actual development usage patterns. Create specific rules for required protocols (SSH/HTTP/HTTPS). Restrict sources to developer VPN range. Remove overly permissive rule.",status:"open"},{id:"finding-008",category:"Firewall Policy Drift",severity:"medium",finding:"ASA-BRANCH-01: Configuration drift from baseline detected",evidence:["New HTTPS rule added for third-party vendor access","Rule not present in approved Branch Office Standard baseline v1.5.2","Allows access to 192.168.100.0/24","No associated change request found"],remediation:"Security team review required. If legitimate business need, update baseline and document exception. Otherwise, remove rule and notify requester.",status:"open"},{id:"finding-009",category:"Unpatched Firewalls",severity:"high",finding:"ASA-BRANCH-01: VPN subsystem vulnerability unpatched",evidence:["Current version: 9.16.3 (30 days outdated)","CVE-2024-11111: Denial of service in VPN subsystem (CVSS 7.5)","Patch available in version 9.16.4","No maintenance window scheduled"],remediation:"Schedule maintenance window to upgrade to 9.16.5 (latest). Update risk: Medium. Coordinate with branch office for planned downtime.",status:"open"},{id:"finding-010",category:"Firewall Policy Drift",severity:"medium",finding:"PA-DC-FW-01: Logging disabled for denied traffic",evidence:["Baseline requires all denied traffic to be logged","Current configuration: Logging disabled","Creates gap in audit trail","SOC2 CC6.1 non-compliance"],remediation:"Re-enable logging for denied traffic. Verify log retention meets compliance requirements. Create change ticket for audit documentation.",status:"open"}],recommendations:["Implement automated drift detection with real-time alerting to catch unauthorized changes within minutes","Enable auto-remediation for low-risk violations (unused rules, expired whitelists with no usage)","Establish quarterly firewall patching cadence with emergency process for critical CVEs","Deploy automated expiration enforcement for temporary whitelist rules","Conduct monthly security group audits across all cloud providers","Implement infrastructure-as-code for firewall configurations to prevent drift","Enhance change management process to require approval before rule modifications","Create compliance dashboard for real-time framework adherence monitoring"],auditReadiness:"needs_attention"},ax=({onClose:e,onPrint:s})=>{const a=()=>{window.print(),s()},r=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return t.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:[t.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"print:hidden p-4 border-b border-slate-200 flex items-center justify-between bg-slate-50",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Print Preview"}),t.jsx("p",{className:"text-slate-600 text-sm",children:"Compliance & Audit Report"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:e,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded hover:bg-slate-300 transition-colors",children:"Cancel"}),t.jsxs("button",{onClick:a,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:t.jsxs("div",{className:"p-8 print:p-0 bg-white text-slate-900",children:[t.jsxs("div",{className:"mb-8 print:mb-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-4xl font-bold text-slate-900 mb-2 print:text-3xl",children:"Compliance & Audit Report"}),t.jsx("p",{className:"text-slate-600 text-lg print:text-base",children:"Network Security & Policy Compliance Analysis"})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-slate-500 text-sm",children:"Report Date"}),t.jsx("p",{className:"text-slate-900 font-semibold",children:r})]})]}),t.jsx("div",{className:"h-1 bg-gradient-to-r from-cyan-500 to-blue-500 rounded mb-4"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 border border-slate-200 rounded print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-sm mb-1",children:"Report Period"}),t.jsxs("p",{className:"text-slate-900 font-semibold text-sm",children:[new Date(ee.period.from).toLocaleDateString()," -"," ",new Date(ee.period.to).toLocaleDateString()]})]}),t.jsxs("div",{className:"p-4 border border-slate-200 rounded print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-sm mb-1",children:"Overall Compliance Score"}),t.jsxs("p",{className:"text-slate-900 font-bold text-2xl print:text-xl",children:[q.complianceScore,"%"]})]}),t.jsxs("div",{className:"p-4 border border-slate-200 rounded print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-sm mb-1",children:"Audit Readiness"}),t.jsx("p",{className:"text-slate-900 font-semibold capitalize text-sm",children:ee.auditReadiness.replace("_"," ")})]})]})]}),t.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[t.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Executive Summary"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-slate-50 rounded print:bg-white print:border print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Total Firewalls"}),t.jsx("p",{className:"text-slate-900 font-bold text-2xl print:text-xl",children:q.totalFirewalls})]}),t.jsxs("div",{className:"p-4 bg-red-50 rounded print:bg-white print:border print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Firewalls with Drift"}),t.jsx("p",{className:"text-red-600 font-bold text-2xl print:text-xl",children:q.firewallsWithDrift})]}),t.jsxs("div",{className:"p-4 bg-orange-50 rounded print:bg-white print:border print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Critical Violations"}),t.jsx("p",{className:"text-orange-600 font-bold text-2xl print:text-xl",children:q.criticalViolations})]}),t.jsxs("div",{className:"p-4 bg-emerald-50 rounded print:bg-white print:border print:border-slate-300",children:[t.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Auto-Remediation"}),t.jsx("p",{className:"text-emerald-600 font-bold text-2xl print:text-xl",children:q.autoRemediationAvailable})]})]})]}),t.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[t.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Compliance by Framework"}),t.jsx("div",{className:"space-y-3",children:Object.entries(q.byFramework).map(([n,o])=>t.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h3",{className:"font-semibold text-slate-900",children:n}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"text-slate-600 text-sm",children:[o.passed,"/",o.passed+o.failed," controls"]}),t.jsxs("span",{className:`font-bold text-lg ${o.score>=90?"text-emerald-600":o.score>=75?"text-amber-600":"text-red-600"}`,children:[o.score,"%"]})]})]}),t.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden print:bg-slate-100",children:t.jsx("div",{className:`h-full ${o.score>=90?"bg-emerald-500 print:bg-emerald-400":o.score>=75?"bg-amber-500 print:bg-amber-400":"bg-red-500 print:bg-red-400"}`,style:{width:`${o.score}%`}})})]},n))})]}),t.jsxs("section",{className:"mb-8 print:mb-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Key Findings"}),t.jsx("div",{className:"space-y-4",children:ee.findings.slice(0,10).map((n,o)=>t.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300 print:break-inside-avoid",children:[t.jsx("div",{className:"flex items-start justify-between mb-2",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsxs("span",{className:"text-slate-500 text-sm font-mono",children:["#",o+1]}),t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${n.severity==="critical"?"bg-red-100 text-red-700 print:border print:border-red-300":n.severity==="high"?"bg-orange-100 text-orange-700 print:border print:border-orange-300":n.severity==="medium"?"bg-amber-100 text-amber-700 print:border print:border-amber-300":"bg-blue-100 text-blue-700 print:border print:border-blue-300"}`,children:n.severity.toUpperCase()}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-700 rounded text-xs print:border print:border-slate-300",children:n.category}),t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${n.status==="open"?"bg-red-50 text-red-700 print:border print:border-red-300":n.status==="in_progress"?"bg-amber-50 text-amber-700 print:border print:border-amber-300":"bg-emerald-50 text-emerald-700 print:border print:border-emerald-300"}`,children:n.status.replace("_"," ")})]}),t.jsx("h3",{className:"font-semibold text-slate-900 mb-2",children:n.finding})]})}),t.jsxs("div",{className:"mb-3",children:[t.jsx("p",{className:"text-slate-600 text-sm font-semibold mb-1",children:"Evidence:"}),t.jsx("ul",{className:"list-disc list-inside space-y-1 text-slate-700 text-sm",children:n.evidence.map((i,l)=>t.jsx("li",{children:i},l))})]}),t.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded p-3 print:bg-white print:border-cyan-400",children:[t.jsx("p",{className:"text-slate-600 text-sm font-semibold mb-1",children:"Remediation:"}),t.jsx("p",{className:"text-slate-700 text-sm",children:n.remediation})]})]},n.id))})]}),t.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[t.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Recommendations"}),t.jsx("div",{className:"space-y-3",children:ee.recommendations.map((n,o)=>t.jsxs("div",{className:"flex gap-3 p-4 bg-slate-50 rounded border border-slate-200 print:bg-white print:border-slate-300",children:[t.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-cyan-500 text-white rounded-full flex items-center justify-center text-sm font-bold print:bg-cyan-400",children:o+1}),t.jsx("p",{className:"text-slate-700 text-sm flex-1",children:n})]},o))})]}),t.jsxs("section",{className:"mb-8 print:mb-6 print:break-inside-avoid",children:[t.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4 print:text-xl",children:"Detailed Statistics"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300",children:[t.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Policy Drift"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600",children:"Total NSG Violations:"}),t.jsx("span",{className:"font-semibold text-slate-900",children:q.totalNSGViolations})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600",children:"Expired Whitelists:"}),t.jsx("span",{className:"font-semibold text-slate-900",children:q.expiredWhitelists})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600",children:"Unpatched Firewalls:"}),t.jsx("span",{className:"font-semibold text-slate-900",children:q.unpatchedFirewalls})]})]})]}),t.jsxs("div",{className:"border border-slate-200 rounded p-4 print:border-slate-300",children:[t.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Findings Summary"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600",children:"Total Findings:"}),t.jsx("span",{className:"font-semibold text-slate-900",children:ee.findings.length})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600",children:"Open Issues:"}),t.jsx("span",{className:"font-semibold text-red-600",children:ee.findings.filter(n=>n.status==="open").length})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600",children:"In Progress:"}),t.jsx("span",{className:"font-semibold text-amber-600",children:ee.findings.filter(n=>n.status==="in_progress").length})]})]})]})]})]}),t.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200 text-center text-slate-500 text-sm print:border-slate-300 print:mt-6 print:pt-4",children:[t.jsx("p",{children:"Generated by Network AIOps Platform - Compliance & Audit Module"}),t.jsxs("p",{className:"mt-1",children:["Report ID: ",ee.id," | Generated: ",r]}),t.jsx("p",{className:"mt-2 text-xs",children:"This report is confidential and intended for internal use only"})]})]})})]}),t.jsx("style",{children:`
        @media print {
          @page {
            size: A4;
            margin: 2cm;
          }

          body {
            print-color-adjust: exact;
            -webkit-print-color-adjust: exact;
          }

          .print\\:hidden {
            display: none !important;
          }

          .print\\:p-0 {
            padding: 0 !important;
          }

          .print\\:text-3xl {
            font-size: 1.875rem !important;
          }

          .print\\:text-xl {
            font-size: 1.25rem !important;
          }

          .print\\:text-base {
            font-size: 1rem !important;
          }

          .print\\:mb-6 {
            margin-bottom: 1.5rem !important;
          }

          .print\\:border {
            border-width: 1px !important;
          }

          .print\\:border-slate-300 {
            border-color: rgb(203 213 225) !important;
          }

          .print\\:border-red-300 {
            border-color: rgb(252 165 165) !important;
          }

          .print\\:border-orange-300 {
            border-color: rgb(253 186 116) !important;
          }

          .print\\:border-amber-300 {
            border-color: rgb(252 211 77) !important;
          }

          .print\\:border-blue-300 {
            border-color: rgb(147 197 253) !important;
          }

          .print\\:border-cyan-400 {
            border-color: rgb(34 211 238) !important;
          }

          .print\\:bg-white {
            background-color: white !important;
          }

          .print\\:bg-slate-100 {
            background-color: rgb(241 245 249) !important;
          }

          .print\\:bg-emerald-400 {
            background-color: rgb(52 211 153) !important;
          }

          .print\\:bg-amber-400 {
            background-color: rgb(251 191 36) !important;
          }

          .print\\:bg-red-400 {
            background-color: rgb(248 113 113) !important;
          }

          .print\\:bg-cyan-400 {
            background-color: rgb(34 211 238) !important;
          }

          .print\\:break-inside-avoid {
            break-inside: avoid !important;
          }

          .print\\:mt-6 {
            margin-top: 1.5rem !important;
          }

          .print\\:pt-4 {
            padding-top: 1rem !important;
          }
        }
      `})]})},or={critical:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30",icon:""},high:{color:"text-orange-400",bg:"bg-orange-500/20",border:"border-orange-500/30",icon:""},medium:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30",icon:""},low:{color:"text-yellow-400",bg:"bg-yellow-500/20",border:"border-yellow-500/30",icon:""},info:{color:"text-blue-400",bg:"bg-blue-500/20",border:"border-blue-500/30",icon:""}},ir={open:{color:"text-red-400",bg:"bg-red-500/20",label:"Open"},in_progress:{color:"text-amber-400",bg:"bg-amber-500/20",label:"In Progress"},resolved:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Resolved"}},rx={ready:{color:"text-emerald-400",bg:"bg-emerald-500/20",label:"Audit Ready",icon:""},needs_attention:{color:"text-amber-400",bg:"bg-amber-500/20",label:"Needs Attention",icon:""},not_ready:{color:"text-red-400",bg:"bg-red-500/20",label:"Not Ready",icon:""}},nx=()=>{const[e,s]=f.useState(null),[a,r]=f.useState("all"),[n,o]=f.useState("all"),i=ee.findings.filter(p=>!(a!=="all"&&p.category!==a||n!=="all"&&p.severity!==n)),l=rx[ee.auditReadiness],c=ee.findings.filter(p=>p.severity==="critical").length,d=ee.findings.filter(p=>p.severity==="high").length,u=ee.findings.filter(p=>p.status==="open").length;return t.jsxs(J,{children:[t.jsxs("div",{className:"mb-6 flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Compliance Audit Report"}),t.jsxs("p",{className:"text-slate-400",children:["Generated: ",new Date(ee.generatedAt).toLocaleString()," | Period: ",new Date(ee.period.from).toLocaleDateString()," - ",new Date(ee.period.to).toLocaleDateString()]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),t.jsxs(M,{variant:"primary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export PDF"]})]})]}),t.jsx(b,{className:`p-6 mb-6 border-2 ${l.bg.replace("/20","/30")}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-16 h-16 rounded-full ${l.bg} flex items-center justify-center text-3xl`,children:l.icon}),t.jsxs("div",{children:[t.jsx("h2",{className:`text-2xl font-bold ${l.color} mb-1`,children:l.label}),t.jsxs("p",{className:"text-slate-300",children:[u," open findings require attention before audit certification"]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Overall Compliance Score"}),t.jsxs("p",{className:"text-5xl font-bold text-white",children:[ee.summary.complianceScore,"%"]})]})]})}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total Findings"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:ee.findings.length})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Critical"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:c})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"High"}),t.jsx("p",{className:"text-3xl font-bold text-orange-400",children:d})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Open Items"}),t.jsx("p",{className:"text-3xl font-bold text-amber-400",children:u})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Auto-Fix Available"}),t.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:ee.summary.autoRemediationAvailable})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total Firewalls"}),t.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:ee.summary.totalFirewalls})]})]}),t.jsxs(b,{className:"p-6 mb-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Compliance Framework Status"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:Object.entries(ee.summary.byFramework).map(([p,h])=>t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-white font-semibold",children:p}),t.jsx("span",{className:`px-2 py-1 rounded text-xs ${h.status==="compliant"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"}`,children:h.status==="compliant"?"":""})]}),t.jsxs("p",{className:"text-3xl font-bold text-white mb-2",children:[h.score,"%"]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden mb-2",children:t.jsx("div",{className:`h-full ${h.score>=90?"bg-emerald-500":h.score>=75?"bg-amber-500":"bg-red-500"}`,style:{width:`${h.score}%`}})}),t.jsxs("p",{className:"text-slate-400 text-xs",children:[h.passed," passed / ",h.failed," failed"]})]},p))})]}),t.jsx(b,{className:"p-4 mb-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"text-slate-400 text-sm mb-2 block",children:"Filter by Category"}),t.jsxs("select",{value:a,onChange:p=>r(p.target.value),className:"w-full px-3 py-2 bg-slate-700 text-white rounded border border-slate-600 focus:border-cyan-500 focus:outline-none",children:[t.jsx("option",{value:"all",children:"All Categories"}),t.jsx("option",{value:"Firewall Policy Drift",children:"Firewall Policy Drift"}),t.jsx("option",{value:"Cloud NSG Violations",children:"Cloud NSG Violations"}),t.jsx("option",{value:"Unpatched Firewalls",children:"Unpatched Firewalls"}),t.jsx("option",{value:"Expired Whitelists",children:"Expired Whitelists"}),t.jsx("option",{value:"Firewall Rule Hit Count",children:"Firewall Rule Hit Count"})]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"text-slate-400 text-sm mb-2 block",children:"Filter by Severity"}),t.jsxs("select",{value:n,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 bg-slate-700 text-white rounded border border-slate-600 focus:border-cyan-500 focus:outline-none",children:[t.jsx("option",{value:"all",children:"All Severities"}),t.jsx("option",{value:"critical",children:"Critical"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"low",children:"Low"})]})]})]})}),t.jsxs(b,{className:"p-6 mb-6",children:[t.jsxs("h3",{className:"text-white font-semibold mb-4",children:["Audit Findings (",i.length,")"]}),t.jsx("div",{className:"space-y-3",children:i.map(p=>{const h=or[p.severity],y=ir[p.status];return t.jsx("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500 cursor-pointer transition-colors",onClick:()=>s(p),children:t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"text-xl",children:h.icon}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold border ${h.bg} ${h.border} ${h.color}`,children:p.severity.toUpperCase()}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:p.category}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${y.bg} ${y.color}`,children:y.label})]}),t.jsx("h4",{className:"text-white font-semibold mb-2",children:p.finding}),t.jsxs("p",{className:"text-slate-400 text-sm mb-2",children:["Evidence: ",p.evidence.length," items documented"]}),t.jsxs("p",{className:"text-cyan-400 text-sm",children:[" Remediation: ",p.remediation.substring(0,100),"..."]})]})})},p.id)})})]}),t.jsxs(b,{className:"p-6 mb-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Audit Recommendations"}),t.jsx("div",{className:"space-y-3",children:ee.recommendations.map((p,h)=>t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-700/30 rounded",children:[t.jsx("span",{className:"text-emerald-400 text-xl mt-0.5",children:""}),t.jsx("p",{className:"text-slate-300 text-sm flex-1",children:p})]},h))})]}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx("div",{className:"p-6 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[or[e.severity].icon,t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${or[e.severity].bg} ${or[e.severity].color}`,children:e.severity.toUpperCase()}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:e.category})]}),t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:e.finding}),t.jsxs("p",{className:"text-slate-400 text-sm",children:["Finding ID: ",e.id]})]}),t.jsx("button",{onClick:()=>s(null),className:"text-slate-400 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Evidence"]}),t.jsx("div",{className:"space-y-2",children:e.evidence.map((p,h)=>t.jsxs("div",{className:"flex items-start gap-2 p-3 bg-slate-700/30 rounded",children:[t.jsxs("span",{className:"text-amber-400 text-sm mt-0.5",children:[h+1,"."]}),t.jsx("p",{className:"text-slate-300 text-sm flex-1",children:p})]},h))})]}),t.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsxs("h3",{className:"text-cyan-400 font-semibold mb-3 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Recommended Remediation"]}),t.jsx("p",{className:"text-white text-sm",children:e.remediation})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-2",children:"Current Status"}),t.jsx("span",{className:`px-3 py-2 rounded text-sm font-semibold inline-block ${ir[e.status].bg} ${ir[e.status].color}`,children:ir[e.status].label})]})]}),t.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>s(null),className:"px-4 py-2 bg-slate-700 text-white rounded hover:bg-slate-600 transition-colors",children:"Close"}),t.jsx("button",{className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors",children:"Mark as In Progress"})]})]})})]})},ox=()=>{const[e,s]=f.useState("overview"),[a,r]=f.useState(!1),n=[{id:"drift",title:"Firewall Policy Drift",description:"Configuration drift from baseline",icon:"",value:q.firewallsWithDrift,total:q.totalFirewalls,color:"from-red-500 to-red-600",status:"critical"},{id:"hitcount",title:"Rule Hit Count",description:"Unused and low-usage rules",icon:"",value:Zn.filter(o=>o.status==="unused"||o.status==="low_usage").length,total:Zn.length,color:"from-amber-500 to-amber-600",status:"warning"},{id:"violations",title:"Cloud NSG Violations",description:"Security group policy violations",icon:"",value:q.criticalViolations,total:q.totalNSGViolations,color:"from-orange-500 to-orange-600",status:"high"},{id:"expired",title:"Expired Whitelists",description:"Rules past expiration date",icon:"",value:q.expiredWhitelists,total:uc.length,color:"from-purple-500 to-purple-600",status:"medium"},{id:"unpatched",title:"Unpatched Firewalls",description:"Outdated firmware versions",icon:"",value:q.unpatchedFirewalls,total:q.totalFirewalls,color:"from-cyan-500 to-cyan-600",status:"info"}];return t.jsxs(J,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Compliance, Drift & Audit Dashboard"}),t.jsx("p",{className:"text-slate-400",children:"Real-time compliance monitoring with AI-powered drift detection and auto-remediation"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-6",children:[t.jsxs(b,{className:"p-6 lg:col-span-2",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Overall Compliance Score"}),t.jsxs("p",{className:"text-5xl font-bold text-white",children:[q.complianceScore,"%"]})]}),t.jsx("div",{className:"text-right",children:t.jsx("div",{className:"w-24 h-24 relative",children:t.jsxs("svg",{className:"transform -rotate-90 w-24 h-24",children:[t.jsx("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-slate-700"}),t.jsx("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:`${2*Math.PI*40}`,strokeDashoffset:`${2*Math.PI*40*(1-q.complianceScore/100)}`,className:"text-cyan-500"})]})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{className:"p-2 bg-emerald-500/10 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Auto-Remediation"}),t.jsxs("p",{className:"text-emerald-400 font-semibold",children:[q.autoRemediationAvailable," Available"]})]}),t.jsxs("div",{className:"p-2 bg-red-500/10 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Critical Issues"}),t.jsxs("p",{className:"text-red-400 font-semibold",children:[q.criticalViolations," Items"]})]})]})]}),t.jsxs(b,{className:"p-6 lg:col-span-3",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-3",children:"Compliance Frameworks"}),t.jsx("div",{className:"space-y-2",children:Object.entries(q.byFramework).map(([o,i])=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{className:"text-white",children:o}),t.jsxs("span",{className:"text-slate-400",children:[i.score,"%"]})]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${i.score>=90?"bg-emerald-500":i.score>=75?"bg-amber-500":"bg-red-500"}`,style:{width:`${i.score}%`}})})]},o))})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:n.map(o=>t.jsxs("button",{onClick:()=>s(o.id),className:`p-4 rounded-lg border-2 transition-all text-left ${e===o.id?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[t.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${o.color} rounded-lg flex items-center justify-center text-2xl mb-3`,children:o.icon}),t.jsx("h3",{className:"text-white font-semibold mb-1",children:o.title}),t.jsx("p",{className:"text-slate-400 text-xs mb-2",children:o.description}),t.jsxs("p",{className:"text-2xl font-bold text-white",children:[o.value,t.jsxs("span",{className:"text-sm text-slate-400 font-normal",children:[" / ",o.total]})]})]},o.id))}),e==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Compliance Overview"}),t.jsx("p",{className:"text-slate-300 mb-6",children:"Select a category above to view detailed compliance information, drift detection, and remediation options."}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Key Features"}),t.jsxs("ul",{className:"space-y-2",children:[t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),t.jsx("span",{children:"Real-time firewall policy drift detection from baseline configurations"})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),t.jsx("span",{children:"Firewall rule hit count analysis to identify unused rules"})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),t.jsx("span",{children:"Cloud NSG/Security Group violation detection across AWS, Azure, GCP"})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),t.jsx("span",{children:"Expired whitelist tracking with automated removal recommendations"})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-emerald-400 mt-0.5",children:""}),t.jsx("span",{children:"Unpatched firewall detection with CVE vulnerability tracking"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"AI Capabilities"}),t.jsxs("ul",{className:"space-y-2",children:[t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),t.jsx("span",{children:'"This rule violates baseline X" - Automatic violation detection'})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),t.jsx("span",{children:'"Auto-remediation possible: Yes/No" - Intelligent remediation assessment'})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),t.jsx("span",{children:"Step-by-step remediation plans with confidence scores"})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),t.jsx("span",{children:"Impact analysis and risk assessment for policy changes"})]}),t.jsxs("li",{className:"flex items-start gap-2 text-slate-300 text-sm",children:[t.jsx("span",{className:"text-cyan-400 mt-0.5",children:""}),t.jsx("span",{children:"Audit-ready reporting with compliance framework mapping"})]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(b,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Issues"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:q.firewallsWithDrift+q.totalNSGViolations+q.expiredWhitelists+q.unpatchedFirewalls})]}),t.jsx("span",{className:"text-4xl",children:""})]})}),t.jsx(b,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Auto-Fixable"}),t.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:q.autoRemediationAvailable})]}),t.jsx("span",{className:"text-4xl",children:""})]})}),t.jsx(b,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Audit Ready"}),t.jsxs("p",{className:"text-3xl font-bold text-cyan-400",children:[Object.values(q.byFramework).filter(o=>o.status==="compliant").length,"/",Object.keys(q.byFramework).length]})]}),t.jsx("span",{className:"text-4xl",children:""})]})})]})]}),e==="drift"&&t.jsx(Ug,{drifts:ex}),e==="hitcount"&&t.jsx($g,{hitCounts:Zn}),e==="violations"&&t.jsx(qg,{violations:tx}),e==="expired"&&t.jsx(Yg,{whitelists:uc}),e==="unpatched"&&t.jsx(Jg,{firewalls:sx}),e==="audit"&&t.jsx(nx,{}),t.jsxs("div",{className:"mt-6 flex justify-between",children:[t.jsxs(M,{variant:"ghost",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",onClick:()=>s("audit"),children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"View Audit Report"]}),t.jsxs(M,{variant:"ghost",onClick:()=>r(!0),children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),t.jsxs(M,{variant:"primary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Compliance Report"]})]})]}),a&&t.jsx(ax,{onClose:()=>r(!1),onPrint:()=>r(!1)})]})},ix=(e,s,a)=>Math.max(s,Math.min(a,e)),lr=(e,s,a)=>{const r=(Math.random()-.5)*a;return ix(e+r,s.min,s.max)};function lx(){const[e,s]=f.useState({activeConnections:49,ingress:24,egress:18,firewallCpu:67}),[a,r]=f.useState(!0);f.useEffect(()=>{(async()=>{try{const i=await Eh();s(i)}finally{r(!1)}})()},[]),f.useEffect(()=>{const o=setInterval(()=>{s(i=>({activeConnections:lr(i.activeConnections,ar.activeConnections,4),ingress:lr(i.ingress,ar.ingress,3),egress:lr(i.egress,ar.egress,2),firewallCpu:lr(i.firewallCpu,ar.firewallCpu,5)}))},Hi.REAL_TIME);return()=>clearInterval(o)},[]);const n=f.useCallback(()=>e.firewallCpu>ac.CRITICAL?"critical":e.firewallCpu>ac.WARNING?"warning":"normal",[e.firewallCpu]);return{metrics:e,isLoading:a,getFirewallCpuStatus:n}}function cx(){const[e,s]=f.useState(()=>Mh());f.useEffect(()=>{const n=setInterval(()=>{if(Math.random()>.7){const o=Vh(),i=Gh(o);s(l=>[i,...l].slice(0,Iu.MAX_ALERTS))}},Hi.ALERTS);return()=>clearInterval(n)},[]);const a=f.useCallback(n=>{s(o=>o.map(i=>i.id===n?{...i,acknowledged:!0}:i))},[]),r=Du(e);return{alerts:e,alertCounts:r,acknowledgeAlert:a}}const dx=({currentTime:e,refreshInterval:s=2})=>t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(Dm,{}),t.jsxs("span",{className:"text-slate-400",children:["Auto-refresh: ",s,"s"]})]}),t.jsx(ih,{time:e})]}),ux=({metrics:e,firewallCpuStatus:s})=>t.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[t.jsx(rr,{value:Math.round(e.activeConnections),label:"Active Connections",sublabel:"24,567 / 50,000",status:"normal",icon:""}),t.jsx(rr,{value:Math.round(e.ingress),label:"Ingress Traffic",sublabel:"2.4 Gbps",status:"good",icon:""}),t.jsx(rr,{value:Math.round(e.egress),label:"Egress Traffic",sublabel:"1.8 Gbps",status:"good",icon:""}),t.jsx(rr,{value:Math.round(e.firewallCpu),label:"Firewall CPU",sublabel:"pa-fw-prod-east",status:s,icon:""})]}),px=()=>{const[e,s]=f.useState([]),[a,r]=f.useState([]);return f.useEffect(()=>{(async()=>{const[o,i]=await Promise.all([Rh(),Lh()]);s(o),r(i)})()},[]),t.jsxs("div",{className:"col-span-1 space-y-4",children:[t.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[t.jsx(Ru,{className:"w-5 h-5 text-cyan-400"}),"System Metrics"]}),t.jsx(mx,{stats:e}),t.jsx(hx,{platforms:a})]})},mx=({stats:e})=>{const s=a=>{const r={red:"from-red-500/20 to-red-600/10",amber:"from-amber-500/20 to-amber-600/10",emerald:"from-emerald-500/20 to-emerald-600/10",cyan:"from-cyan-500/20 to-cyan-600/10",purple:"from-purple-500/20 to-purple-600/10"};return r[a]||r.cyan};return t.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.map((a,r)=>t.jsx(ch,{label:a.label,value:a.value,unit:a.unit,icon:a.icon,trend:a.trend,colorClass:s(a.color)},r))})},hx=({platforms:e})=>t.jsxs(b,{variant:"bordered",className:"mt-4",children:[t.jsx("h4",{className:"text-white font-semibold mb-4",children:"Platform Status"}),t.jsx("div",{className:"space-y-3",children:e.map(s=>t.jsx(Mm,{name:s.name,status:s.status,latency:s.latency,icon:s.icon},s.name))})]}),gx=({alerts:e,onAcknowledge:s})=>{const a=Du(e);return t.jsxs(b,{variant:"bordered",padding:"none",className:"col-span-2 rounded-2xl overflow-hidden",children:[t.jsx(xx,{alertCounts:a}),t.jsx(fx,{alerts:e,onAcknowledge:s}),t.jsx(yx,{alertCount:e.length})]})},xx=({alertCounts:e})=>t.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[t.jsx(Lu,{className:"w-5 h-5 text-red-400"}),"Live Alerts Feed"]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),t.jsxs("span",{className:"text-xs text-slate-400",children:[e.unacknowledged," unacknowledged"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(ve,{variant:"error",size:"sm",children:[e.critical," Critical"]}),t.jsxs(ve,{variant:"warning",size:"sm",children:[e.warning," Warning"]})]})]}),fx=({alerts:e,onAcknowledge:s})=>t.jsx("div",{className:"h-[400px] overflow-y-auto",children:t.jsx("div",{className:"divide-y divide-slate-700/50",children:e.map(a=>t.jsx(vx,{alert:a,onAcknowledge:s},a.id))})}),vx=({alert:e,onAcknowledge:s})=>{const a=na.alert[e.type];return t.jsx("div",{className:`p-4 ${a.bg} ${a.hover} border-l-2 ${a.borderLeft} transition-all ${e.acknowledged?"opacity-50":""}`,children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-lg mt-0.5",children:Fh(e.type)}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white text-sm font-medium",children:e.message}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx("span",{className:"text-xs text-slate-400 font-mono bg-slate-700/50 px-2 py-0.5 rounded",children:e.source}),t.jsx("span",{className:"text-xs text-slate-500",children:""}),t.jsx("span",{className:"text-xs text-slate-500",children:Hh(e.time)})]})]})]}),e.acknowledged?t.jsx(ve,{variant:"success",size:"sm",children:" Ack"}):t.jsx(M,{variant:"secondary",size:"sm",onClick:()=>s(e.id),children:"Acknowledge"})]})})},yx=({alertCount:e})=>t.jsxs("div",{className:"p-3 border-t border-slate-700 bg-slate-900/50 flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs text-slate-500",children:["Showing latest ",e," alerts"]}),t.jsx("button",{className:"text-xs text-cyan-400 hover:text-cyan-300 font-medium",children:"View All Alerts "})]}),bx=()=>{const e=f.useMemo(()=>Array.from({length:Iu.TRAFFIC_GRAPH_POINTS}).map((s,a)=>({ingressHeight:20+Math.sin(a*.3)*15+Math.random()*20,egressHeight:15+Math.cos(a*.25)*10+Math.random()*15})),[]);return t.jsxs(b,{variant:"bordered",className:"mt-6 rounded-2xl",children:[t.jsx(_x,{}),t.jsx(wx,{data:e}),t.jsx(jx,{})]})},_x=()=>t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"text-white font-semibold flex items-center gap-2",children:[t.jsx(th,{className:"w-5 h-5 text-cyan-400"}),"Network Traffic (Last 60 Minutes)"]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(qn,{color:"bg-cyan-500",label:"Ingress"}),t.jsx(qn,{color:"bg-purple-500",label:"Egress"}),t.jsx(qn,{color:"bg-red-500",label:"Blocked"})]})]}),qn=({color:e,label:s})=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-3 h-3 ${e} rounded-full`}),t.jsx("span",{className:"text-xs text-slate-400",children:s})]}),wx=({data:e})=>t.jsx("div",{className:"flex items-end gap-1 h-32",children:e.map((s,a)=>t.jsxs("div",{className:"flex-1 flex flex-col gap-0.5",children:[t.jsx("div",{className:"bg-gradient-to-t from-cyan-600 to-cyan-400 rounded-t transition-all duration-300",style:{height:`${s.ingressHeight}%`}}),t.jsx("div",{className:"bg-gradient-to-t from-purple-600 to-purple-400 rounded-t transition-all duration-300",style:{height:`${s.egressHeight}%`}})]},a))}),jx=()=>t.jsxs("div",{className:"flex justify-between mt-2 text-xs text-slate-500",children:[t.jsx("span",{children:"-60m"}),t.jsx("span",{children:"-45m"}),t.jsx("span",{children:"-30m"}),t.jsx("span",{children:"-15m"}),t.jsx("span",{children:"Now"})]}),Nx=()=>{const e=Ou(),{metrics:s,getFirewallCpuStatus:a}=lx(),{alerts:r,acknowledgeAlert:n}=cx();return t.jsxs(J,{children:[t.jsx(dx,{currentTime:e}),t.jsx(ux,{metrics:s,firewallCpuStatus:a()}),t.jsxs(Wi,{cols:3,children:[t.jsx(px,{}),t.jsx(gx,{alerts:r,onAcknowledge:n})]}),t.jsx(bx,{})]})},kx=[{label:"Overall Health",value:"87%",color:"emerald"},{label:"Total Services",value:"17",color:"cyan"},{label:"Healthy",value:"13",color:"emerald"},{label:"Degraded",value:"2",color:"amber"},{label:"Critical",value:"2",color:"red"}],Sx=()=>t.jsxs(J,{children:[t.jsx(Wi,{cols:5,className:"mb-6",children:kx.map((e,s)=>t.jsx(Cx,{stat:e},s))}),t.jsxs(b,{children:[t.jsx("h3",{className:"text-white font-bold mb-4",children:"Service Topology"}),t.jsx("div",{className:"text-center py-16 text-slate-500",children:"Topology visualization displayed here"})]})]}),Cx=({stat:e})=>{const s={emerald:"text-emerald-400",cyan:"text-cyan-400",amber:"text-amber-400",red:"text-red-400"};return t.jsxs(b,{children:[t.jsx("p",{className:"text-sm text-slate-400",children:e.label}),t.jsx("p",{className:`text-3xl font-bold ${s[e.color]}`,children:e.value})]})},Ax=()=>t.jsxs(J,{children:[t.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-rose-600 rounded-xl p-6 text-white mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(ve,{variant:"default",className:"bg-white/20 text-white",children:"CRITICAL"}),t.jsx("span",{className:"font-mono text-sm opacity-80",children:"INC-2026-0113-001"})]}),t.jsx("h2",{className:"text-2xl font-bold",children:"Payment Gateway Service Degradation"})]}),t.jsx("div",{className:"text-center py-16 text-slate-500",children:"Incident correlation and root cause analysis view"})]}),Tx=()=>{const[e,s]=f.useState("aws"),[a,r]=f.useState("vpcs"),[n,o]=f.useState(null),[i,l]=f.useState([]),[c,d]=f.useState(null),[u,p]=f.useState([]),[h,y]=f.useState([]),[j,v]=f.useState(null),[L,x]=f.useState([]),[m,g]=f.useState([]),[w,N]=f.useState(!0),[k,C]=f.useState(!1),[O,P]=f.useState(null);f.useEffect(()=>{(async()=>{try{const G=await je.getOverview(e);o(G)}catch(G){P(G instanceof Error?G.message:"Failed to load overview")}})()},[e]),f.useEffect(()=>{(async()=>{N(!0),P(null),d(null),v(null),p([]);try{switch(a){case"vpcs":const G=await je.getVPCs(e);l(G);break;case"security-groups":const me=await je.getSecurityGroups(e);y(me);break;case"load-balancers":const E=await je.getLoadBalancers(e);x(E);break;case"transit-gateways":const V=await je.getTransitGateways(e);g(V);break}}catch(G){P(G instanceof Error?G.message:"Failed to load resources")}finally{N(!1)}})()},[e,a]);const I=f.useCallback(async T=>{if(!T){d(null),p([]);return}try{const[G,me]=await Promise.all([je.getVPCDetails(e,T),je.getSubnets(e,T)]);d(G),p(me)}catch(G){P(G instanceof Error?G.message:"Failed to load VPC details")}},[e]),W=f.useCallback(async T=>{if(!T){v(null);return}try{const G=await je.getSecurityGroupDetails(e,T);v(G)}catch(G){P(G instanceof Error?G.message:"Failed to load security group details")}},[e]),B=f.useCallback(async()=>{C(!0),P(null);try{if((await je.syncResources(e)).success){const G=await je.getOverview(e);o(G)}}catch(T){P(T instanceof Error?T.message:"Failed to sync resources")}finally{C(!1)}},[e]),A=f.useCallback(async()=>{N(!0),P(null);try{const[T,G,me,E,V]=await Promise.all([je.getOverview(e),je.getVPCs(e),je.getSecurityGroups(e),je.getLoadBalancers(e),je.getTransitGateways(e)]);o(T),l(G),y(me),x(E),g(V)}catch(T){P(T instanceof Error?T.message:"Failed to refresh data")}finally{N(!1)}},[e]),_=f.useCallback(()=>{P(null)},[]);return{activeProvider:e,activeResource:a,overview:n,vpcs:i,selectedVpc:c,subnets:u,securityGroups:h,selectedSecurityGroup:j,loadBalancers:L,transitGateways:m,isLoading:w,isSyncing:k,error:O,setActiveProvider:s,setActiveResource:r,selectVpc:I,selectSecurityGroup:W,syncResources:B,refreshData:A,clearError:_}},Px=[{id:"aws",name:"AWS",color:"from-orange-500 to-orange-600"},{id:"azure",name:"Azure",color:"from-blue-500 to-blue-600"},{id:"gcp",name:"GCP",color:"from-red-500 to-green-500"}],Ix=[{id:"vpcs",name:"VPCs / VNets",icon:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"},{id:"security-groups",name:"Security Groups",icon:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},{id:"load-balancers",name:"Load Balancers",icon:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},{id:"transit-gateways",name:"Transit Gateways",icon:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"}],Ex=()=>{const{activeProvider:e,activeResource:s,overview:a,vpcs:r,selectedVpc:n,subnets:o,securityGroups:i,selectedSecurityGroup:l,loadBalancers:c,transitGateways:d,isLoading:u,isSyncing:p,error:h,setActiveProvider:y,setActiveResource:j,selectVpc:v,selectSecurityGroup:L,syncResources:x}=Tx();return t.jsxs(J,{children:[t.jsx("div",{className:"bg-white rounded-xl shadow-lg mb-6 overflow-hidden flex",children:Px.map(m=>t.jsx("button",{onClick:()=>y(m.id),className:`flex-1 px-6 py-4 font-bold transition-all ${e===m.id?`bg-gradient-to-r ${m.color} text-white`:"text-slate-600 hover:bg-slate-50"}`,children:m.name},m.id))}),a&&t.jsx(Rx,{overview:a,isSyncing:p,onSync:x}),h&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:t.jsx("span",{className:"text-red-700",children:h})}),t.jsx("div",{className:"flex gap-2 mb-6",children:Ix.map(m=>t.jsxs("button",{onClick:()=>j(m.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s===m.id?"bg-cyan-500 text-white":"bg-white text-slate-600 hover:bg-slate-50 shadow"}`,children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:m.icon})}),m.name]},m.id))}),u?t.jsxs("div",{className:"flex items-center justify-center h-64",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),t.jsx("span",{className:"ml-3 text-slate-600",children:"Loading resources..."})]}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s==="vpcs"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsx(Lx,{vpcs:r,selectedId:n==null?void 0:n.id,onSelect:v})}),t.jsx("div",{className:"lg:col-span-2",children:n?t.jsx(Ox,{vpc:n,subnets:o}):t.jsx(pc,{message:"Select a VPC to view details"})})]}),s==="security-groups"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsx(Dx,{groups:i,selectedId:l==null?void 0:l.id,onSelect:L})}),t.jsx("div",{className:"lg:col-span-2",children:l?t.jsx(Mx,{group:l}):t.jsx(pc,{message:"Select a security group to view rules"})})]}),s==="load-balancers"&&t.jsx("div",{className:"lg:col-span-3",children:t.jsx(Vx,{loadBalancers:c})}),s==="transit-gateways"&&t.jsx("div",{className:"lg:col-span-3",children:t.jsx(Gx,{gateways:d})})]})]})},Rx=({overview:e,isSyncing:s,onSync:a})=>{const r=[{label:"VPCs",value:e.vpcCount,color:"text-blue-600"},{label:"Subnets",value:e.subnetCount,color:"text-green-600"},{label:"Security Groups",value:e.securityGroupCount,color:"text-purple-600"},{label:"Load Balancers",value:e.loadBalancerCount,color:"text-orange-600"},{label:"Instances",value:e.totalInstances,color:"text-cyan-600"}];return t.jsxs(b,{className:"bg-white shadow-lg mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${e.healthScore>=90?"bg-green-500":e.healthScore>=70?"bg-amber-500":"bg-red-500"}`}),t.jsxs("span",{className:"text-sm text-slate-600",children:["Health: ",t.jsxs("span",{className:"font-semibold",children:[e.healthScore,"%"]})]})]}),e.issueCount>0&&t.jsxs("span",{className:"text-sm text-red-600 bg-red-50 px-2 py-1 rounded",children:[e.issueCount," issues"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-xs text-slate-500",children:["Last sync: ",new Date(e.lastSync).toLocaleTimeString()]}),t.jsxs("button",{onClick:a,disabled:s,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-cyan-500 text-white rounded hover:bg-cyan-600 disabled:bg-slate-300 transition-colors",children:[t.jsx("svg",{className:`w-4 h-4 ${s?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s?"Syncing...":"Sync"]})]})]}),t.jsx("div",{className:"grid grid-cols-5 gap-4",children:r.map(n=>t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:`text-2xl font-bold ${n.color}`,children:n.value}),t.jsx("p",{className:"text-xs text-slate-500",children:n.label})]},n.label))})]})},Lx=({vpcs:e,selectedId:s,onSelect:a})=>t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["VPCs / VNets (",e.length,")"]}),t.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:e.map(r=>t.jsxs("button",{onClick:()=>a(r.id),className:`w-full text-left p-3 rounded-lg transition-colors ${s===r.id?"bg-cyan-50 border-2 border-cyan-500":"bg-slate-50 hover:bg-slate-100 border-2 border-transparent"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"font-medium text-slate-800",children:r.name}),t.jsx(Ui,{status:r.status})]}),t.jsx("p",{className:"text-xs text-slate-500 font-mono",children:r.cidrBlock}),t.jsxs("div",{className:"flex gap-3 mt-2 text-xs text-slate-500",children:[t.jsxs("span",{children:[r.subnetCount," subnets"]}),t.jsxs("span",{children:[r.instanceCount," instances"]})]})]},r.id))})]}),Ox=({vpc:e,subnets:s})=>t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:e.name}),t.jsx("p",{className:"text-sm text-slate-500 font-mono",children:e.id})]}),t.jsx(Ui,{status:e.status})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-slate-500",children:"CIDR Block"}),t.jsx("p",{className:"font-mono font-medium text-slate-800",children:e.cidrBlock})]}),t.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-slate-500",children:"Region"}),t.jsx("p",{className:"font-medium text-slate-800",children:e.region})]}),t.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-slate-500",children:"Instances"}),t.jsx("p",{className:"font-medium text-slate-800",children:e.instanceCount})]})]}),t.jsxs("h4",{className:"font-semibold text-slate-700 mb-3",children:["Subnets (",s.length,")"]}),t.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:s.map(a=>t.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"font-medium text-slate-800",children:a.name}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.isPublic?"bg-green-100 text-green-700":"bg-slate-200 text-slate-700"}`,children:a.isPublic?"Public":"Private"})]}),t.jsxs("div",{className:"flex gap-4 text-xs text-slate-500",children:[t.jsx("span",{className:"font-mono",children:a.cidrBlock}),t.jsx("span",{children:a.availabilityZone}),t.jsxs("span",{children:[a.availableIps," IPs available"]})]})]},a.id))})]}),Dx=({groups:e,selectedId:s,onSelect:a})=>t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Security Groups (",e.length,")"]}),t.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:e.map(r=>t.jsxs("button",{onClick:()=>a(r.id),className:`w-full text-left p-3 rounded-lg transition-colors ${s===r.id?"bg-cyan-50 border-2 border-cyan-500":"bg-slate-50 hover:bg-slate-100 border-2 border-transparent"}`,children:[t.jsx("div",{className:"flex items-center justify-between mb-1",children:t.jsx("span",{className:"font-medium text-slate-800",children:r.name})}),t.jsx("p",{className:"text-xs text-slate-500 truncate",children:r.description}),t.jsxs("div",{className:"flex gap-3 mt-2 text-xs",children:[t.jsxs("span",{className:"text-green-600",children:[r.inboundRules.length," inbound"]}),t.jsxs("span",{className:"text-blue-600",children:[r.outboundRules.length," outbound"]})]})]},r.id))})]}),Mx=({group:e})=>t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:e.name}),t.jsx("p",{className:"text-sm text-slate-500",children:e.description}),t.jsx("p",{className:"text-xs text-slate-400 font-mono mt-1",children:e.id})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("p",{className:"text-xs text-slate-500",children:["VPC: ",t.jsx("span",{className:"text-slate-700",children:e.vpcName})]})}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),"Inbound Rules (",e.inboundRules.length,")"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs text-slate-500 border-b",children:[t.jsx("th",{className:"pb-2",children:"Protocol"}),t.jsx("th",{className:"pb-2",children:"Port Range"}),t.jsx("th",{className:"pb-2",children:"Source"}),t.jsx("th",{className:"pb-2",children:"Description"})]})}),t.jsx("tbody",{children:e.inboundRules.map(s=>t.jsxs("tr",{className:"border-b border-slate-100",children:[t.jsx("td",{className:"py-2 font-mono",children:s.protocol}),t.jsx("td",{className:"py-2",children:s.portRange}),t.jsx("td",{className:"py-2 font-mono text-xs",children:s.source}),t.jsx("td",{className:"py-2 text-slate-500",children:s.description})]},s.id))})]})})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Outbound Rules (",e.outboundRules.length,")"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs text-slate-500 border-b",children:[t.jsx("th",{className:"pb-2",children:"Protocol"}),t.jsx("th",{className:"pb-2",children:"Port Range"}),t.jsx("th",{className:"pb-2",children:"Destination"}),t.jsx("th",{className:"pb-2",children:"Description"})]})}),t.jsx("tbody",{children:e.outboundRules.map(s=>t.jsxs("tr",{className:"border-b border-slate-100",children:[t.jsx("td",{className:"py-2 font-mono",children:s.protocol}),t.jsx("td",{className:"py-2",children:s.portRange}),t.jsx("td",{className:"py-2 font-mono text-xs",children:s.source}),t.jsx("td",{className:"py-2 text-slate-500",children:s.description})]},s.id))})]})})]})]}),Vx=({loadBalancers:e})=>t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Load Balancers (",e.length,")"]}),t.jsx("div",{className:"space-y-4",children:e.length===0?t.jsx("p",{className:"text-center text-slate-500 py-8",children:"No load balancers found"}):e.map(s=>t.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-slate-800",children:s.name}),t.jsx("p",{className:"text-xs text-slate-500 font-mono",children:s.id})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.type==="application"?"bg-blue-100 text-blue-700":s.type==="network"?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"}`,children:s.type.toUpperCase()}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.scheme==="internet-facing"?"bg-green-100 text-green-700":"bg-slate-200 text-slate-700"}`,children:s.scheme})]})]}),t.jsx("p",{className:"text-xs text-slate-500 font-mono mb-3 truncate",children:s.dnsName}),t.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:"Listeners:"})," ",t.jsx("span",{className:"font-medium",children:s.listenerCount})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:"Target Groups:"})," ",t.jsx("span",{className:"font-medium",children:s.targetGroupCount})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-slate-500",children:"Health:"}),t.jsxs("span",{className:`font-medium ${s.healthyTargets===s.totalTargets?"text-green-600":"text-amber-600"}`,children:[s.healthyTargets,"/",s.totalTargets]}),t.jsx("span",{className:"text-slate-400",children:"targets"})]})]})]},s.id))})]}),Gx=({gateways:e})=>t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:["Transit Gateways (",e.length,")"]}),e.length===0?t.jsx("p",{className:"text-center text-slate-500 py-8",children:"No transit gateways found"}):t.jsx("div",{className:"space-y-6",children:e.map(s=>t.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-slate-800",children:s.name}),t.jsx("p",{className:"text-xs text-slate-500 font-mono",children:s.id})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs text-slate-500",children:s.region}),t.jsx(Ui,{status:s.state==="available"?"active":s.state==="pending"?"pending":"error"})]})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("span",{className:"text-sm text-slate-600",children:[s.routeTables," route tables"]})}),t.jsxs("div",{children:[t.jsxs("h5",{className:"text-sm font-medium text-slate-700 mb-2",children:["Attachments (",s.attachments.length,")"]}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.attachments.map(a=>t.jsxs("div",{className:"bg-white rounded p-2 text-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"font-medium text-slate-800",children:a.resourceName}),t.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${a.resourceType==="vpc"?"bg-blue-100 text-blue-700":a.resourceType==="vpn"?"bg-orange-100 text-orange-700":a.resourceType==="peering"?"bg-purple-100 text-purple-700":"bg-slate-200 text-slate-700"}`,children:a.resourceType})]}),t.jsx("p",{className:"text-xs text-slate-500 font-mono",children:a.resourceId})]},a.id))})]})]},s.id))})]}),Ui=({status:e})=>{const s={active:{bg:"bg-green-100",text:"text-green-700",label:"Active"},available:{bg:"bg-green-100",text:"text-green-700",label:"Available"},inactive:{bg:"bg-slate-100",text:"text-slate-700",label:"Inactive"},pending:{bg:"bg-amber-100",text:"text-amber-700",label:"Pending"},error:{bg:"bg-red-100",text:"text-red-700",label:"Error"},deleting:{bg:"bg-red-100",text:"text-red-700",label:"Deleting"}},a=s[e]||s.inactive;return t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.bg} ${a.text}`,children:a.label})},pc=({message:e})=>t.jsx(b,{className:"bg-slate-50 border-2 border-dashed border-slate-200",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),t.jsx("p",{className:"text-slate-500",children:e})]})}),Hx={aws:{name:"Amazon Web Services",shortName:"AWS",icon:"",color:"from-orange-500 to-orange-600",borderColor:"border-orange-500",bgColor:"bg-orange-500/10"},azure:{name:"Microsoft Azure",shortName:"Azure",icon:"",color:"from-blue-500 to-blue-600",borderColor:"border-blue-500",bgColor:"bg-blue-500/10"},gcp:{name:"Google Cloud Platform",shortName:"GCP",icon:"",color:"from-red-500 to-red-600",borderColor:"border-red-500",bgColor:"bg-red-500/10"},oci:{name:"Oracle Cloud Infrastructure",shortName:"OCI",icon:"",color:"from-red-600 to-orange-600",borderColor:"border-red-600",bgColor:"bg-red-600/10"},onprem:{name:"On-Premises",shortName:"On-Prem",icon:"",color:"from-slate-500 to-slate-600",borderColor:"border-slate-500",bgColor:"bg-slate-500/10"}},Fx={healthy:{label:"Healthy",color:"text-emerald-400",bgColor:"bg-emerald-500/20",borderColor:"border-emerald-500/30"},degraded:{label:"Degraded",color:"text-amber-400",bgColor:"bg-amber-500/20",borderColor:"border-amber-500/30"},critical:{label:"Critical",color:"text-red-400",bgColor:"bg-red-500/20",borderColor:"border-red-500/30"}},Wx=({provider:e,summary:s,selected:a,onClick:r})=>{const n=Hx[e],o=Fx[s.health];return t.jsx("div",{onClick:r,className:`cursor-pointer transition-all ${a?"scale-105":"hover:scale-102"}`,children:t.jsxs(b,{className:`border-2 ${a?n.borderColor+" shadow-lg":"border-slate-600"}`,padding:"none",children:[t.jsx("div",{className:`bg-gradient-to-r ${n.color} p-4`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"text-3xl",children:n.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-bold text-lg",children:n.shortName}),t.jsx("p",{className:"text-white/80 text-xs",children:n.name})]})]}),a&&t.jsx("div",{className:"w-6 h-6 bg-white rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border ${o.bgColor} ${o.borderColor}`,children:[t.jsx("span",{className:"text-sm text-slate-300",children:"Health"}),t.jsx("span",{className:`text-sm font-semibold ${o.color}`,children:o.label})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded",children:[t.jsx("p",{className:"text-xs text-slate-400",children:"Networks"}),t.jsx("p",{className:"text-lg font-bold text-white",children:s.networks})]}),t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded",children:[t.jsx("p",{className:"text-xs text-slate-400",children:"Subnets"}),t.jsx("p",{className:"text-lg font-bold text-white",children:s.subnets})]}),t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded col-span-2",children:[t.jsx("p",{className:"text-xs text-slate-400",children:"Active Resources"}),t.jsx("p",{className:"text-lg font-bold text-white",children:s.activeResources})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Regions"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:s.regions.map(i=>t.jsx("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs",children:i},i))})]})]})]})})},Ux={vpc:"VPC",vnet:"VNet",vcn:"VCN"},zx={active:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30"},inactive:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"},degraded:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30"},error:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30"},unknown:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"}},$x=({networks:e,onSelectNetwork:s})=>t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.map(a=>{const r=zx[a.status],n=a.subnets.length,o=a.routeTables.length,i=a.peerings.length,l=a.gateways.length;return t.jsxs(b,{className:"cursor-pointer hover:border-cyan-500 transition-colors",onClick:()=>s(a),children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h3",{className:"text-white font-semibold text-lg",children:a.name}),t.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs font-mono",children:Ux[a.type]})]}),t.jsx("p",{className:"text-slate-400 text-sm font-mono",children:a.id})]}),t.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${r.bg} ${r.border} ${r.color}`,children:a.status.toUpperCase()})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-2",children:"CIDR Blocks"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a.cidr.map((c,d)=>t.jsx("span",{className:"px-3 py-1 bg-slate-700/50 text-white rounded font-mono text-sm",children:c},d))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("span",{className:"text-slate-400 text-xs",children:"Region: "}),t.jsx("span",{className:"text-white text-sm",children:a.region})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[t.jsx("p",{className:"text-xl font-bold text-white",children:n}),t.jsx("p",{className:"text-xs text-slate-400",children:"Subnets"})]}),t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[t.jsx("p",{className:"text-xl font-bold text-white",children:o}),t.jsx("p",{className:"text-xs text-slate-400",children:"Routes"})]}),t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[t.jsx("p",{className:"text-xl font-bold text-white",children:i}),t.jsx("p",{className:"text-xs text-slate-400",children:"Peerings"})]}),t.jsxs("div",{className:"bg-slate-700/30 p-2 rounded text-center",children:[t.jsx("p",{className:"text-xl font-bold text-white",children:l}),t.jsx("p",{className:"text-xs text-slate-400",children:"Gateways"})]})]}),t.jsxs("div",{className:"flex gap-2 text-xs",children:[a.firewalls.length>0&&t.jsxs("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 border border-red-500/30 rounded",children:[" ",a.firewalls.length," Firewall",a.firewalls.length>1?"s":""]}),a.securityGroups.length>0&&t.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded",children:[" ",a.securityGroups.length," SG/NSG"]})]}),Object.keys(a.tags).length>0&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-2",children:"Tags"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(a.tags).slice(0,3).map(([c,d])=>t.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs",children:[c,": ",d]},c))})]})]},a.id)})}),dt={active:{color:"text-emerald-400",bg:"bg-emerald-500/20",border:"border-emerald-500/30"},inactive:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"},degraded:{color:"text-amber-400",bg:"bg-amber-500/20",border:"border-amber-500/30"},error:{color:"text-red-400",bg:"bg-red-500/20",border:"border-red-500/30"},unknown:{color:"text-slate-400",bg:"bg-slate-500/20",border:"border-slate-500/30"}},Bx={local:{icon:"",color:"text-slate-400"},gateway:{icon:"",color:"text-cyan-400"},peering:{icon:"",color:"text-purple-400"},transit:{icon:"",color:"text-blue-400"},nat:{icon:"",color:"text-green-400"},instance:{icon:"",color:"text-yellow-400"},blackhole:{icon:"",color:"text-red-400"}},Zx=({network:e,onClose:s})=>{const[a,r]=f.useState("overview"),n=[{id:"overview",label:"Overview"},{id:"subnets",label:"Subnets",count:e.subnets.length},{id:"routes",label:"Route Tables",count:e.routeTables.length},{id:"peerings",label:"Peerings",count:e.peerings.length},{id:"gateways",label:"Gateways",count:e.gateways.length},{id:"security",label:"Security",count:e.firewalls.length+e.securityGroups.length}];return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-slate-900 rounded-lg border border-slate-700 w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx("div",{className:"p-6 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:e.name}),t.jsx("p",{className:"text-slate-400 text-sm font-mono mb-3",children:e.id}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded text-xs font-mono",children:e.type.toUpperCase()}),t.jsx("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:e.region}),t.jsx("span",{className:`px-3 py-1 rounded text-xs font-semibold border ${dt[e.status].bg} ${dt[e.status].border} ${dt[e.status].color}`,children:e.status.toUpperCase()})]})]}),t.jsx("button",{onClick:s,className:"text-slate-400 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsx("div",{className:"border-b border-slate-700",children:t.jsx("div",{className:"flex px-6 gap-1 overflow-x-auto",children:n.map(o=>t.jsxs("button",{onClick:()=>r(o.id),className:`px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${a===o.id?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-white"}`,children:[o.label,o.count!==void 0&&t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-slate-700 rounded text-xs",children:o.count})]},o.id))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"CIDR Blocks"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.cidr.map((o,i)=>t.jsx("span",{className:"px-3 py-2 bg-slate-700/50 text-white rounded font-mono",children:o},i))})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Metadata"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Provider"}),t.jsx("p",{className:"text-white",children:e.provider.toUpperCase()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Region"}),t.jsx("p",{className:"text-white",children:e.region})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Created"}),t.jsx("p",{className:"text-white",children:new Date(e.createdAt).toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Last Modified"}),t.jsx("p",{className:"text-white",children:new Date(e.lastModified).toLocaleString()})]})]})]}),Object.keys(e.tags).length>0&&t.jsxs(b,{className:"p-4",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Tags"}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(e.tags).map(([o,i])=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-slate-400 text-sm",children:[o,":"]}),t.jsx("span",{className:"text-white text-sm font-mono",children:i})]},o))})]})]}),a==="subnets"&&t.jsx("div",{className:"space-y-4",children:e.subnets.map(o=>{const i=o.usedIps/(o.usedIps+o.availableIps)*100;return t.jsxs(b,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:o.name}),t.jsx("p",{className:"text-slate-400 text-sm font-mono",children:o.id})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${o.public?"bg-cyan-500/20 text-cyan-400":"bg-slate-500/20 text-slate-400"}`,children:o.public?"Public":"Private"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"CIDR"}),t.jsx("p",{className:"text-white font-mono text-sm",children:o.cidr})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Availability Zone"}),t.jsx("p",{className:"text-white text-sm",children:o.availabilityZone})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Status"}),t.jsx("span",{className:`px-2 py-1 rounded text-xs ${dt[o.status].bg} ${dt[o.status].color}`,children:o.status})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-slate-400",children:"IP Usage"}),t.jsxs("span",{className:"text-white",children:[o.usedIps," / ",o.usedIps+o.availableIps," (",i.toFixed(1),"%)"]})]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${i>80?"bg-red-500":i>60?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${i}%`}})})]}),o.resources.length>0&&t.jsxs("div",{children:[t.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Resources (",o.resources.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[o.resources.slice(0,3).map(l=>t.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-700/30 rounded text-xs",children:[t.jsx("span",{className:"text-slate-400",children:l.type}),t.jsx("span",{className:"text-white font-mono flex-1",children:l.privateIp}),l.publicIp&&t.jsx("span",{className:"text-cyan-400 font-mono",children:l.publicIp})]},l.id)),o.resources.length>3&&t.jsxs("p",{className:"text-slate-400 text-xs text-center",children:["+",o.resources.length-3," more resources"]})]})]})]},o.id)})}),a==="routes"&&t.jsx("div",{className:"space-y-4",children:e.routeTables.map(o=>t.jsxs(b,{className:"p-4",children:[t.jsx("h4",{className:"text-white font-semibold mb-3",children:o.name}),t.jsx("p",{className:"text-slate-400 text-sm font-mono mb-4",children:o.id}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h5",{className:"text-slate-300 font-medium text-sm mb-2",children:"Routes"}),t.jsx("div",{className:"space-y-2",children:o.routes.map((i,l)=>{const c=Bx[i.targetType];return t.jsxs("div",{className:`flex items-center justify-between p-3 rounded border ${i.status==="blackhole"?"bg-red-500/10 border-red-500/30":"bg-slate-700/30 border-slate-600"}`,children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("span",{className:`text-2xl ${c.color}`,children:c.icon}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-mono text-sm",children:i.destination}),t.jsxs("p",{className:"text-slate-400 text-xs",children:[" ",i.target," (",i.targetType,")",i.propagated&&t.jsx("span",{className:"ml-2 text-cyan-400",children:" Propagated"})]})]})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs ${i.status==="active"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:i.status})]},l)})})]}),o.associations.length>0&&t.jsxs("div",{children:[t.jsx("h5",{className:"text-slate-300 font-medium text-sm mb-2",children:"Associated Subnets"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:o.associations.map(i=>t.jsx("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:i.subnetName},i.subnetId))})]})]},o.id))}),a==="peerings"&&t.jsx("div",{className:"space-y-4",children:e.peerings.length===0?t.jsx(b,{className:"p-8 text-center",children:t.jsx("p",{className:"text-slate-400",children:"No peering connections configured"})}):e.peerings.map(o=>t.jsxs(b,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:o.name}),t.jsx("p",{className:"text-slate-400 text-sm font-mono",children:o.id})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${o.status==="active"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":o.status==="pending"?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:o.status.toUpperCase()})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Requester"}),t.jsx("p",{className:"text-white text-sm font-semibold",children:o.requesterNetworkName}),t.jsx("p",{className:"text-cyan-400 text-xs font-mono",children:o.requesterCidr})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Accepter"}),t.jsx("p",{className:"text-white text-sm font-semibold",children:o.accepterNetworkName}),t.jsx("p",{className:"text-cyan-400 text-xs font-mono",children:o.accepterCidr})]})]}),t.jsxs("div",{className:"flex gap-2",children:[o.crossRegion&&t.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs",children:"Cross-Region"}),o.crossAccount&&t.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:"Cross-Account"})]})]},o.id))}),a==="gateways"&&t.jsx("div",{className:"space-y-4",children:e.gateways.length===0?t.jsx(b,{className:"p-8 text-center",children:t.jsx("p",{className:"text-slate-400",children:"No gateways configured"})}):e.gateways.map(o=>t.jsxs(b,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:o.name}),t.jsx("p",{className:"text-slate-400 text-sm font-mono",children:o.id})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs ${dt[o.status].bg} ${dt[o.status].color}`,children:o.status})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Type"}),t.jsx("p",{className:"text-white text-sm",children:o.type.replace("_"," ").toUpperCase()})]}),o.publicIp&&t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Public IP"}),t.jsx("p",{className:"text-cyan-400 text-sm font-mono",children:o.publicIp})]}),o.bandwidth&&t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Bandwidth"}),t.jsx("p",{className:"text-white text-sm",children:o.bandwidth})]}),o.redundancy&&t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Redundancy"}),t.jsx("p",{className:"text-white text-sm",children:o.redundancy.toUpperCase()})]})]})]},o.id))}),a==="security"&&t.jsxs("div",{className:"space-y-6",children:[e.firewalls.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Firewalls"}),t.jsx("div",{className:"space-y-4",children:e.firewalls.map(o=>t.jsxs(b,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:o.name}),t.jsx("p",{className:"text-slate-400 text-sm font-mono",children:o.id})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs ${dt[o.status].bg} ${dt[o.status].color}`,children:o.status})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Type"}),t.jsx("p",{className:"text-white text-sm",children:o.type.replace("_"," ").toUpperCase()})]}),o.vendor&&t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Vendor"}),t.jsx("p",{className:"text-white text-sm",children:o.vendor})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Throughput"}),t.jsx("p",{className:"text-white text-sm",children:o.throughput})]})]}),t.jsxs("div",{className:"flex gap-2 mb-3",children:[o.loggingEnabled&&t.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:"Logging Enabled"}),o.intrusionPrevention&&t.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs",children:"IPS Enabled"})]}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Rules (",o.rules.length,")"]}),t.jsxs("div",{className:"space-y-1",children:[o.rules.slice(0,3).map(i=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-700/30 rounded text-xs",children:[t.jsx("span",{className:"text-white",children:i.name}),t.jsx("span",{className:`px-2 py-1 rounded ${i.action==="allow"?"bg-emerald-500/20 text-emerald-400":i.action==="deny"?"bg-red-500/20 text-red-400":"bg-amber-500/20 text-amber-400"}`,children:i.action.toUpperCase()})]},i.id)),o.rules.length>3&&t.jsxs("p",{className:"text-slate-400 text-xs text-center py-1",children:["+",o.rules.length-3," more rules"]})]})]})]},o.id))})]}),e.securityGroups.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Security Groups / NSGs"}),t.jsx("div",{className:"space-y-4",children:e.securityGroups.map(o=>t.jsxs(b,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:o.name}),t.jsx("p",{className:"text-slate-400 text-sm",children:o.description}),t.jsx("p",{className:"text-slate-400 text-xs font-mono mt-1",children:o.id})]}),t.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:o.type==="security_group"?"Security Group":"NSG"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Inbound Rules (",o.inboundRules.length,")"]}),t.jsx("div",{className:"space-y-1",children:o.inboundRules.slice(0,2).map(i=>t.jsxs("div",{className:"p-2 bg-slate-700/30 rounded text-xs",children:[t.jsxs("div",{className:"flex justify-between mb-1",children:[t.jsx("span",{className:"text-white",children:i.protocol.toUpperCase()}),t.jsx("span",{className:`px-1 rounded ${i.action==="allow"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:i.action})]}),t.jsxs("p",{className:"text-slate-400",children:["Port: ",i.portRange]})]},i.id))})]}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-slate-400 text-xs mb-2",children:["Outbound Rules (",o.outboundRules.length,")"]}),t.jsx("div",{className:"space-y-1",children:o.outboundRules.slice(0,2).map(i=>t.jsxs("div",{className:"p-2 bg-slate-700/30 rounded text-xs",children:[t.jsxs("div",{className:"flex justify-between mb-1",children:[t.jsx("span",{className:"text-white",children:i.protocol.toUpperCase()}),t.jsx("span",{className:`px-1 rounded ${i.action==="allow"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:i.action})]}),t.jsxs("p",{className:"text-slate-400",children:["Port: ",i.portRange]})]},i.id))})]})]})]},o.id))})]})]})]})]})})},qx=[{id:"vpc-0a1b2c3d4e5f6g7h8",name:"Production VPC",provider:"aws",type:"vpc",cidr:["10.100.0.0/16"],region:"us-east-1",status:"active",subnets:[{id:"subnet-pub-1a",name:"Public Subnet 1A",cidr:"10.100.1.0/24",availabilityZone:"us-east-1a",routeTableId:"rtb-public",public:!0,status:"active",usedIps:45,availableIps:206,resources:[{id:"i-123",name:"web-server-01",type:"instance",privateIp:"10.100.1.10",publicIp:"52.94.76.50"},{id:"lb-456",name:"app-load-balancer",type:"loadbalancer",privateIp:"10.100.1.20",publicIp:"52.94.76.51"}]},{id:"subnet-priv-1a",name:"Private Subnet 1A",cidr:"10.100.10.0/24",availabilityZone:"us-east-1a",routeTableId:"rtb-private",public:!1,status:"active",usedIps:82,availableIps:169,resources:[{id:"i-789",name:"app-server-01",type:"instance",privateIp:"10.100.10.10"},{id:"rds-001",name:"prod-database",type:"database",privateIp:"10.100.10.50"}]}],routeTables:[{id:"rtb-public",name:"Public Route Table",status:"active",routes:[{destination:"10.100.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"igw-12345678",targetType:"gateway",status:"active",propagated:!1},{destination:"10.200.0.0/16",target:"pcx-azure-peer",targetType:"peering",status:"active",propagated:!1}],associations:[{subnetId:"subnet-pub-1a",subnetName:"Public Subnet 1A"}]},{id:"rtb-private",name:"Private Route Table",status:"active",routes:[{destination:"10.100.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"nat-0abc123",targetType:"nat",status:"active",propagated:!1},{destination:"172.16.0.0/12",target:"tgw-09876543",targetType:"transit",status:"active",propagated:!0}],associations:[{subnetId:"subnet-priv-1a",subnetName:"Private Subnet 1A"}]}],peerings:[{id:"pcx-azure-peer",name:"AWS-Azure Peering",requesterNetworkId:"vpc-0a1b2c3d4e5f6g7h8",requesterNetworkName:"Production VPC",requesterCidr:"10.100.0.0/16",accepterNetworkId:"vnet-azure-prod",accepterNetworkName:"Azure Production VNet",accepterCidr:"10.200.0.0/16",status:"active",crossRegion:!0,crossAccount:!1}],gateways:[{id:"igw-12345678",name:"Production Internet Gateway",type:"internet",status:"active",attachedTo:["vpc-0a1b2c3d4e5f6g7h8"]},{id:"nat-0abc123",name:"NAT Gateway 1A",type:"nat",status:"active",attachedTo:["subnet-pub-1a"],publicIp:"52.94.76.100"}],firewalls:[],securityGroups:[{id:"sg-web-tier",name:"Web Tier Security Group",type:"security_group",description:"Security group for web servers",status:"active",attachedResources:["i-123"],inboundRules:[{id:"sgr-001",priority:100,name:"Allow HTTP",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"80"},{id:"sgr-002",priority:110,name:"Allow HTTPS",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"443"}],outboundRules:[{id:"sgr-out-001",priority:100,name:"Allow All Outbound",direction:"outbound",action:"allow",protocol:"all",sourceType:"any",source:"any",destinationType:"cidr",destination:"0.0.0.0/0",portRange:"all"}]}],tags:{Environment:"Production",Team:"Platform",CostCenter:"Engineering"},createdAt:"2024-01-15T10:00:00Z",lastModified:"2026-01-19T14:30:00Z"}],Kx=[{id:"vnet-azure-prod",name:"Azure Production VNet",provider:"azure",type:"vnet",cidr:["10.200.0.0/16"],region:"eastus",status:"active",subnets:[{id:"subnet-web",name:"WebSubnet",cidr:"10.200.1.0/24",availabilityZone:"eastus-1",routeTableId:"rt-web",public:!0,status:"active",usedIps:30,availableIps:221,resources:[{id:"vm-web-01",name:"web-vm-01",type:"instance",privateIp:"10.200.1.10",publicIp:"13.82.100.50"}]},{id:"subnet-app",name:"AppSubnet",cidr:"10.200.10.0/24",availabilityZone:"eastus-1",routeTableId:"rt-app",public:!1,status:"active",usedIps:55,availableIps:196,resources:[{id:"vm-app-01",name:"app-vm-01",type:"instance",privateIp:"10.200.10.10"},{id:"sqldb-01",name:"sqldb-prod",type:"database",privateIp:"10.200.10.50"}]}],routeTables:[{id:"rt-web",name:"Web Route Table",status:"active",routes:[{destination:"10.200.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"internet",targetType:"gateway",status:"active",propagated:!1},{destination:"10.100.0.0/16",target:"vnet-peering-aws",targetType:"peering",status:"active",propagated:!1}],associations:[{subnetId:"subnet-web",subnetName:"WebSubnet"}]}],peerings:[{id:"peer-azure-gcp",name:"Azure-GCP Peering",requesterNetworkId:"vnet-azure-prod",requesterNetworkName:"Azure Production VNet",requesterCidr:"10.200.0.0/16",accepterNetworkId:"vpc-gcp-prod",accepterNetworkName:"GCP Production VPC",accepterCidr:"10.150.0.0/16",status:"active",crossRegion:!0,crossAccount:!1}],gateways:[{id:"vgw-azure-01",name:"Azure Virtual Network Gateway",type:"vpn",status:"active",attachedTo:["vnet-azure-prod"],bandwidth:"1 Gbps",redundancy:"ha"}],firewalls:[{id:"azfw-prod-01",name:"Azure Firewall - Production",type:"managed",vendor:"Microsoft",status:"active",throughput:"30 Gbps",loggingEnabled:!0,intrusionPrevention:!0,rules:[{id:"fw-rule-001",name:"Allow-Web-Traffic",priority:100,action:"allow",source:"0.0.0.0/0",destination:"10.200.1.0/24",ports:"80,443",protocol:"tcp",enabled:!0},{id:"fw-rule-002",name:"Deny-All-Inbound",priority:65e3,action:"deny",source:"any",destination:"any",ports:"any",protocol:"any",enabled:!0}]}],securityGroups:[{id:"nsg-web",name:"Web NSG",type:"nsg",description:"Network Security Group for web tier",status:"active",attachedResources:["subnet-web"],inboundRules:[{id:"nsg-in-001",priority:100,name:"Allow-HTTPS",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"443"}],outboundRules:[{id:"nsg-out-001",priority:100,name:"Allow-All-Outbound",direction:"outbound",action:"allow",protocol:"all",sourceType:"any",source:"any",destinationType:"cidr",destination:"0.0.0.0/0",portRange:"all"}]}],tags:{Environment:"Production",Team:"Cloud",Owner:"DevOps"},createdAt:"2024-02-10T09:00:00Z",lastModified:"2026-01-19T13:15:00Z"}],Qx=[{id:"vpc-gcp-prod",name:"GCP Production VPC",provider:"gcp",type:"vpc",cidr:["10.150.0.0/16"],region:"us-central1",status:"active",subnets:[{id:"subnet-gcp-us-central1",name:"us-central1-subnet",cidr:"10.150.1.0/24",availabilityZone:"us-central1-a",routeTableId:"default",public:!1,status:"active",usedIps:25,availableIps:226,resources:[{id:"instance-1",name:"gcp-web-01",type:"instance",privateIp:"10.150.1.10",publicIp:"35.192.50.25"}]}],routeTables:[{id:"default",name:"Default Route Table",status:"active",routes:[{destination:"10.150.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"default-internet-gateway",targetType:"gateway",status:"active",propagated:!1}],associations:[{subnetId:"subnet-gcp-us-central1",subnetName:"us-central1-subnet"}]}],peerings:[],gateways:[{id:"default-internet-gateway",name:"Default Internet Gateway",type:"internet",status:"active",attachedTo:["vpc-gcp-prod"]}],firewalls:[],securityGroups:[],tags:{environment:"production",team:"platform"},createdAt:"2024-03-05T11:30:00Z",lastModified:"2026-01-18T16:45:00Z"}],Yx=[{id:"vcn-oci-prod",name:"OCI Production VCN",provider:"oci",type:"vcn",cidr:["10.50.0.0/16"],region:"us-ashburn-1",status:"active",subnets:[{id:"subnet-oci-public",name:"Public Subnet",cidr:"10.50.1.0/24",availabilityZone:"AD-1",routeTableId:"rt-public",public:!0,status:"active",usedIps:15,availableIps:236,resources:[]}],routeTables:[{id:"rt-public",name:"Public Route Table",status:"active",routes:[{destination:"10.50.0.0/16",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"igw-oci",targetType:"gateway",status:"active",propagated:!1}],associations:[{subnetId:"subnet-oci-public",subnetName:"Public Subnet"}]}],peerings:[],gateways:[{id:"igw-oci",name:"OCI Internet Gateway",type:"internet",status:"active",attachedTo:["vcn-oci-prod"]}],firewalls:[],securityGroups:[{id:"sl-oci-web",name:"Web Security List",type:"security_group",description:"Security list for web tier",status:"active",attachedResources:["subnet-oci-public"],inboundRules:[{id:"sl-in-001",priority:1,name:"Allow-SSH",direction:"inbound",action:"allow",protocol:"tcp",sourceType:"cidr",source:"0.0.0.0/0",destinationType:"any",destination:"any",portRange:"22"}],outboundRules:[{id:"sl-out-001",priority:1,name:"Allow-All",direction:"outbound",action:"allow",protocol:"all",sourceType:"any",source:"any",destinationType:"cidr",destination:"0.0.0.0/0",portRange:"all"}]}],tags:{Environment:"Production"},createdAt:"2024-04-12T08:00:00Z",lastModified:"2026-01-17T10:20:00Z"}],Xx=[{id:"dc-us-east-1",name:"Data Center US-EAST-1",provider:"onprem",type:"vpc",cidr:["172.16.0.0/12"],region:"on-premises",status:"active",subnets:[{id:"subnet-dmz",name:"DMZ Subnet",cidr:"172.16.1.0/24",availabilityZone:"Rack-A",routeTableId:"rt-dmz",public:!0,status:"active",usedIps:50,availableIps:201,resources:[{id:"srv-fw-01",name:"firewall-01",type:"other",privateIp:"172.16.1.1"}]},{id:"subnet-app",name:"Application Subnet",cidr:"172.16.10.0/24",availabilityZone:"Rack-B",routeTableId:"rt-internal",public:!1,status:"active",usedIps:120,availableIps:131,resources:[{id:"srv-app-01",name:"app-server-01",type:"instance",privateIp:"172.16.10.10"}]}],routeTables:[{id:"rt-dmz",name:"DMZ Route Table",status:"active",routes:[{destination:"172.16.0.0/12",target:"local",targetType:"local",status:"active",propagated:!1},{destination:"0.0.0.0/0",target:"edge-router",targetType:"gateway",status:"active",propagated:!1}],associations:[{subnetId:"subnet-dmz",subnetName:"DMZ Subnet"}]}],peerings:[],gateways:[{id:"vpn-aws-direct-connect",name:"AWS Direct Connect",type:"direct_connect",status:"active",attachedTo:["dc-us-east-1"],bandwidth:"10 Gbps",redundancy:"ha"}],firewalls:[{id:"fw-palo-alto-01",name:"Palo Alto NGFW - DC Edge",type:"third_party",vendor:"Palo Alto Networks",status:"active",throughput:"40 Gbps",loggingEnabled:!0,intrusionPrevention:!0,rules:[{id:"pa-rule-001",name:"Allow-Internet-Outbound",priority:10,action:"allow",source:"172.16.0.0/12",destination:"any",ports:"80,443",protocol:"tcp",enabled:!0},{id:"pa-rule-002",name:"Block-High-Risk-Countries",priority:5,action:"deny",source:"high-risk-geoip",destination:"172.16.0.0/12",ports:"any",protocol:"any",enabled:!0}]}],securityGroups:[],tags:{Location:"US-EAST-1",Tier:"Production"},createdAt:"2020-01-01T00:00:00Z",lastModified:"2026-01-19T12:00:00Z"}],Jx=[{id:"tgw-09876543",name:"Production Transit Gateway",provider:"aws",region:"us-east-1",asn:64512,status:"active",attachments:[{id:"tgw-attach-vpc-prod",name:"Prod VPC Attachment",type:"vpc",transitGatewayId:"tgw-09876543",transitGatewayName:"Production Transit Gateway",networkId:"vpc-0a1b2c3d4e5f6g7h8",networkName:"Production VPC",status:"active",routeTableId:"tgw-rtb-main"},{id:"tgw-attach-vpn-onprem",name:"On-Prem VPN Attachment",type:"vpn",transitGatewayId:"tgw-09876543",transitGatewayName:"Production Transit Gateway",networkId:"vpn-connection-001",networkName:"DC US-EAST-1 VPN",status:"active",routeTableId:"tgw-rtb-main"}],routeTables:[{id:"tgw-rtb-main",name:"Main Transit Route Table",routes:[{destination:"10.100.0.0/16",target:"tgw-attach-vpc-prod",targetType:"transit",status:"active",propagated:!0},{destination:"172.16.0.0/12",target:"tgw-attach-vpn-onprem",targetType:"transit",status:"active",propagated:!0}],associations:["tgw-attach-vpc-prod","tgw-attach-vpn-onprem"],propagations:["tgw-attach-vpc-prod","tgw-attach-vpn-onprem"]}]}],e1=[...qx,...Kx,...Qx,...Yx,...Xx],mc=e1,Js=Jx[0],t1=()=>{const[e,s]=f.useState("all"),[a,r]=f.useState(null),[n,o]=f.useState(""),i=f.useMemo(()=>{const d={aws:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},azure:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},gcp:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},oci:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"},onprem:{networks:0,subnets:0,activeResources:0,regions:[],health:"healthy"}};let u=0,p=0,h=0,y=0,j=0,v=0,L=0;return mc.forEach(x=>{const m=x.provider;d[m].networks++,d[m].subnets+=x.subnets.length;const g=x.subnets.reduce((w,N)=>w+N.resources.length,0);d[m].activeResources+=g,d[m].regions.includes(x.region)||d[m].regions.push(x.region),x.status==="error"?d[m].health="critical":x.status==="degraded"&&d[m].health!=="critical"&&(d[m].health="degraded"),u++,p+=x.subnets.length,h+=x.routeTables.length,y+=x.peerings.length,j+=x.gateways.length,v+=x.firewalls.length,L+=x.securityGroups.length}),{totalNetworks:u,totalSubnets:p,totalRouteTables:h,totalPeerings:y,totalGateways:j,totalFirewalls:v,totalSecurityGroups:L,byProvider:d}},[]),l=f.useMemo(()=>{let d=mc;if(e!=="all"&&(d=d.filter(u=>u.provider===e)),n){const u=n.toLowerCase();d=d.filter(p=>p.name.toLowerCase().includes(u)||p.id.toLowerCase().includes(u)||p.region.toLowerCase().includes(u)||p.cidr.some(h=>h.includes(u)))}return d},[e,n]),c=["aws","azure","gcp","oci","onprem"];return t.jsxs(J,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Multi-Cloud Visibility"}),t.jsx("p",{className:"text-slate-400",children:"Unified view of network infrastructure across AWS, Azure, GCP, OCI, and On-Premises"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-6",children:[t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalNetworks}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Networks"})]}),t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalSubnets}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Subnets"})]}),t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalRouteTables}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Route Tables"})]}),t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalPeerings}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Peerings"})]}),t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalGateways}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Gateways"})]}),t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalFirewalls}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Firewalls"})]}),t.jsxs(b,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:i.totalSecurityGroups}),t.jsx("p",{className:"text-slate-400 text-xs",children:"Security Groups"})]})]}),t.jsxs(b,{className:"p-6 mb-6",children:[t.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),"Cloud Providers"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[t.jsxs("button",{onClick:()=>s("all"),className:`p-4 rounded-lg border-2 transition-all ${e==="all"?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-slate-600 to-slate-700 rounded-lg flex items-center justify-center text-2xl mb-2 mx-auto",children:""}),t.jsx("h4",{className:"text-white font-semibold text-sm text-center",children:"All Providers"}),t.jsxs("p",{className:"text-slate-400 text-xs text-center mt-1",children:[i.totalNetworks," networks"]})]}),c.map(d=>t.jsx(Wx,{provider:d,summary:i.byProvider[d],selected:e===d,onClick:()=>s(d)},d))]})]}),t.jsx(b,{className:"p-4 mb-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),t.jsx("input",{type:"text",value:n,onChange:d=>o(d.target.value),placeholder:"Search by name, ID, CIDR, or region...",className:"w-full pl-10 pr-4 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:border-cyan-500 focus:outline-none"})]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export"]})]})]})}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"text-white font-semibold",children:[e==="all"?"All Networks":`${e.toUpperCase()} Networks`,t.jsxs("span",{className:"ml-2 text-slate-400 text-sm font-normal",children:["(",l.length," ",l.length===1?"network":"networks",")"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(M,{variant:"ghost",size:"sm",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),t.jsx(M,{variant:"ghost",size:"sm",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]})]}),l.length===0?t.jsxs(b,{className:"p-12 text-center",children:[t.jsx("svg",{className:"w-16 h-16 text-slate-600 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-slate-400 text-lg mb-2",children:"No networks found"}),t.jsx("p",{className:"text-slate-500 text-sm",children:n?"Try adjusting your search query or filters":"No networks configured for the selected provider"})]}):t.jsx($x,{networks:l,onSelectNetwork:r}),t.jsxs(b,{className:"p-6 mt-6",children:[t.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Transit Gateway"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Name"}),t.jsx("p",{className:"text-white font-semibold",children:Js.name})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Region"}),t.jsx("p",{className:"text-white",children:Js.region})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Attachments"}),t.jsx("p",{className:"text-white font-semibold",children:Js.attachments.length})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Status"}),t.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded text-sm",children:Js.status.toUpperCase()})]})]}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"Attachments"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:Js.attachments.map(d=>t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("p",{className:"text-white text-sm font-semibold",children:d.name}),t.jsx("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:d.type})]}),t.jsx("p",{className:"text-slate-400 text-xs",children:d.networkName})]},d.id))})]})]}),t.jsxs("div",{className:"mt-6 flex justify-between",children:[t.jsxs(M,{variant:"ghost",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"View Topology"]}),t.jsxs(M,{variant:"primary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Network"]})]})]}),a&&t.jsx(Zx,{network:a,onClose:()=>r(null)})]})},s1=()=>{const[e,s]=f.useState("192.168.1.100"),[a,r]=f.useState(""),[n,o]=f.useState("icmp"),[i,l]=f.useState(""),[c,d]=f.useState(null),[u,p]=f.useState([]),[h,y]=f.useState([]),[j,v]=f.useState(!1),[L,x]=f.useState(!0),[m,g]=f.useState(!0),[w,N]=f.useState(null);f.useEffect(()=>{(async()=>{try{const[_,T]=await Promise.all([qe.getHistory(),qe.getSavedPaths()]);p(_),y(T)}catch(_){N(_ instanceof Error?_.message:"Failed to load data")}finally{x(!1),g(!1)}})()},[]);const k=f.useCallback(async()=>{if(!a.trim()){N("Please enter a destination IP address or hostname");return}if((n==="tcp"||n==="udp")&&!i){N("Please enter a port number for TCP/UDP");return}v(!0),N(null),d(null);try{const A={source:e,destination:a,protocol:n,port:i?parseInt(i,10):void 0,maxHops:30,timeout:5e3,probesPerHop:3,resolveHostnames:!0},_=await qe.runAnalysis(A);d(_);const T=await qe.getHistory();p(T)}catch(A){N(A instanceof Error?A.message:"Path analysis failed")}finally{v(!1)}},[e,a,n,i]),C=f.useCallback(async A=>{var _;s(A.source),r(A.destination),o(A.protocol),l(((_=A.port)==null?void 0:_.toString())||""),v(!0),N(null),d(null);try{const T={source:A.source,destination:A.destination,protocol:A.protocol,port:A.port,maxHops:30,timeout:5e3,probesPerHop:3,resolveHostnames:!0},G=await qe.runAnalysis(T);d(G),await qe.updateSavedPathRun(A.id);const me=await qe.getSavedPaths();y(me);const E=await qe.getHistory();p(E)}catch(T){N(T instanceof Error?T.message:"Path analysis failed")}finally{v(!1)}},[]),O=f.useCallback(async A=>{if(!A.trim()){N("Please enter a name for the saved path");return}if(!a.trim()){N("Please enter a destination before saving");return}try{const _=await qe.savePath({name:A,source:e,destination:a,protocol:n,port:i?parseInt(i,10):void 0});y(T=>[_,...T])}catch(_){N(_ instanceof Error?_.message:"Failed to save path")}},[e,a,n,i]),P=f.useCallback(async A=>{try{await qe.deleteSavedPath(A),y(_=>_.filter(T=>T.id!==A))}catch(_){N(_ instanceof Error?_.message:"Failed to delete path")}},[]),I=f.useCallback(async()=>{try{await qe.clearHistory(),p([])}catch(A){N(A instanceof Error?A.message:"Failed to clear history")}},[]),W=f.useCallback(()=>{d(null)},[]),B=f.useCallback(()=>{N(null)},[]);return{source:e,destination:a,protocol:n,port:i,result:c,history:u,savedPaths:h,isRunning:j,isLoadingHistory:L,isLoadingSaved:m,error:w,setSource:s,setDestination:r,setProtocol:o,setPort:l,runAnalysis:k,runSavedPath:C,savePath:O,deleteSavedPath:P,clearHistory:I,clearResult:W,clearError:B}},a1=[{name:"Google DNS",ip:"8.8.8.8"},{name:"Cloudflare DNS",ip:"1.1.1.1"},{name:"AWS us-east-1",ip:"52.94.76.1"},{name:"Azure East US",ip:"13.82.0.1"},{name:"GCP us-central1",ip:"35.192.0.1"}],hc=({health:e})=>{const s={healthy:"success",degraded:"warning",critical:"error",unknown:"default"};return t.jsx(ve,{variant:s[e],children:e})},r1=({status:e,latency:s})=>{const a=()=>e==="timeout"?"bg-gray-400":e==="unreachable"?"bg-red-500":s>100?"bg-yellow-500":"bg-green-500";return t.jsx("div",{className:`w-3 h-3 rounded-full ${a()}`,title:e})},n1=({hop:e,isLast:s})=>{const[a,r]=f.useState(!1);return t.jsxs("div",{className:"relative",children:[!s&&t.jsx("div",{className:"absolute left-[18px] top-10 w-0.5 h-8 bg-gray-300"}),t.jsxs("div",{className:`border rounded-lg p-3 mb-2 cursor-pointer transition-all ${a?"bg-gray-50 border-blue-300":"bg-white hover:bg-gray-50"}`,onClick:()=>r(!a),children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2 w-16",children:[t.jsx(r1,{status:e.status,latency:e.avgLatency}),t.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",e.hopNumber]})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-mono text-sm text-gray-900",children:e.ipAddress}),e.hostname&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.hostname})]}),t.jsx("div",{className:"hidden md:block w-32 text-sm text-gray-600",children:e.location||"-"}),t.jsx("div",{className:"w-24 text-right",children:e.status==="timeout"?t.jsx("span",{className:"text-gray-400",children:"* * *"}):t.jsxs("span",{className:`font-medium ${e.avgLatency>100?"text-yellow-600":e.avgLatency>50?"text-blue-600":"text-green-600"}`,children:[e.avgLatency.toFixed(1)," ms"]})}),t.jsx("div",{className:"w-20 text-right",children:t.jsxs("span",{className:`text-sm ${e.packetLoss>5?"text-red-600":"text-gray-500"}`,children:[e.packetLoss.toFixed(1),"% loss"]})}),t.jsx("div",{className:"w-20",children:e.cloudProvider&&t.jsx(ve,{variant:"default",className:"text-xs",children:e.cloudProvider.toUpperCase()})}),t.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&t.jsxs("div",{className:"mt-3 pt-3 border-t grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Min Latency"}),t.jsxs("div",{className:"font-medium",children:[e.minLatency.toFixed(2)," ms"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Max Latency"}),t.jsxs("div",{className:"font-medium",children:[e.maxLatency.toFixed(2)," ms"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Jitter"}),t.jsxs("div",{className:"font-medium",children:[e.jitter.toFixed(2)," ms"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Device Type"}),t.jsx("div",{className:"font-medium capitalize",children:e.deviceType||"Unknown"})]}),e.asn&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"ASN"}),t.jsx("div",{className:"font-medium",children:e.asn})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Organization"}),t.jsx("div",{className:"font-medium",children:e.asnOrg||"-"})]})]}),e.region&&t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Region"}),t.jsx("div",{className:"font-medium",children:e.region})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"RTT Samples"}),t.jsx("div",{className:"font-mono text-xs",children:e.latency.length>0?e.latency.map(n=>n.toFixed(1)).join(" / "):"* / * / *"})]})]})]})]})},o1=()=>{const{source:e,destination:s,protocol:a,port:r,result:n,history:o,savedPaths:i,isRunning:l,isLoadingHistory:c,isLoadingSaved:d,error:u,setSource:p,setDestination:h,setProtocol:y,setPort:j,runAnalysis:v,runSavedPath:L,savePath:x,deleteSavedPath:m,clearHistory:g,clearResult:w,clearError:N}=s1(),[k,C]=f.useState(!1),[O,P]=f.useState(""),[I,W]=f.useState("results"),B=async()=>{await x(O),C(!1),P("")},A=_=>new Date(_).toLocaleString();return t.jsxs(J,{children:[u&&t.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",children:[t.jsx("span",{className:"text-red-700",children:u}),t.jsx("button",{onClick:N,className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx(b,{className:"bg-white shadow-lg mb-6",children:t.jsxs("div",{className:"p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Path Analysis"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source IP"}),t.jsx(nr,{value:e,onChange:_=>p(_.target.value),placeholder:"e.g., 192.168.1.100"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),t.jsx(nr,{value:s,onChange:_=>h(_.target.value),placeholder:"e.g., 8.8.8.8"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Protocol"}),t.jsxs(dh,{value:a,onChange:_=>y(_.target.value),children:[t.jsx("option",{value:"icmp",children:"ICMP"}),t.jsx("option",{value:"tcp",children:"TCP"}),t.jsx("option",{value:"udp",children:"UDP"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),t.jsx(nr,{type:"number",value:r,onChange:_=>j(_.target.value),placeholder:"e.g., 443",disabled:a==="icmp"})]}),t.jsx("div",{className:"flex items-end",children:t.jsx(M,{onClick:v,disabled:l,className:"w-full",children:l?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Tracing..."]}):"Run Traceroute"})})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("span",{className:"text-sm text-gray-500 mr-2",children:"Quick targets:"}),a1.map(_=>t.jsx("button",{onClick:()=>h(_.ip),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded text-gray-700",children:_.name},_.ip))]})]})}),t.jsx("div",{className:"flex gap-2 mb-4",children:["results","saved","history"].map(_=>t.jsxs("button",{onClick:()=>W(_),className:`px-4 py-2 rounded-lg font-medium transition-colors ${I===_?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[_==="results"&&"Results",_==="saved"&&`Saved Paths (${i.length})`,_==="history"&&`History (${o.length})`]},_))}),I==="results"&&t.jsx(t.Fragment,{children:n?t.jsx(b,{className:"bg-white shadow-lg",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Path: ",n.source,"  ",n.destination]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[n.protocol.toUpperCase(),n.port?`:${n.port}`:""," | Completed at ",A(n.endTime||n.startTime)]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(hc,{health:n.health}),t.jsx(M,{variant:"secondary",onClick:()=>C(!0),children:"Save Path"}),t.jsx(M,{variant:"secondary",onClick:w,children:"Clear"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.totalHops}),t.jsx("div",{className:"text-sm text-gray-500",children:"Total Hops"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[n.avgLatency.toFixed(1)," ms"]}),t.jsx("div",{className:"text-sm text-gray-500",children:"Avg Latency"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[n.totalLatency.toFixed(1)," ms"]}),t.jsx("div",{className:"text-sm text-gray-500",children:"Total RTT"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:`text-2xl font-bold ${n.packetLoss>5?"text-red-600":"text-green-600"}`,children:[n.packetLoss.toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-500",children:"Packet Loss"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.mtu}),t.jsx("div",{className:"text-sm text-gray-500",children:"MTU"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Hop-by-Hop Path"}),t.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm text-gray-600",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),t.jsx("span",{children:"Healthy (<50ms)"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),t.jsx("span",{children:"Normal (50-100ms)"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),t.jsx("span",{children:"High Latency (>100ms)"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),t.jsx("span",{children:"Unreachable"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-400"}),t.jsx("span",{children:"Timeout"})]})]}),t.jsx("div",{className:"space-y-0",children:n.hops.map((_,T)=>t.jsx(n1,{hop:_,isLast:T===n.hops.length-1},_.hopNumber))})]})]})}):t.jsx(b,{className:"bg-white shadow-lg",children:t.jsx("div",{className:"text-center py-16 text-gray-400",children:l?t.jsxs("div",{children:[t.jsxs("svg",{className:"animate-spin mx-auto h-12 w-12 text-blue-500 mb-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),t.jsx("p",{className:"text-gray-600",children:"Running path analysis..."}),t.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Discovering network hops to ",s]})]}):t.jsxs("div",{children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),t.jsx("p",{children:'Enter a destination and click "Run Traceroute" to analyze the network path'})]})})})}),I==="saved"&&t.jsx(b,{className:"bg-white shadow-lg",children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Saved Paths"}),d?t.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading saved paths..."}):i.length===0?t.jsx("div",{className:"text-center py-8 text-gray-400",children:"No saved paths. Run an analysis and save it for quick access."}):t.jsx("div",{className:"space-y-3",children:i.map(_=>t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900",children:_.name}),t.jsxs("div",{className:"text-sm text-gray-500",children:[_.source,"  ",_.destination,t.jsx("span",{className:"mx-2",children:"|"}),_.protocol.toUpperCase(),_.port?`:${_.port}`:""]}),t.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[_.runCount," runs | Last: ",_.lastRun?A(_.lastRun):"Never"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(M,{variant:"primary",onClick:()=>L(_),disabled:l,children:"Run"}),t.jsx(M,{variant:"secondary",onClick:()=>m(_.id),children:"Delete"})]})]},_.id))})]})}),I==="history"&&t.jsx(b,{className:"bg-white shadow-lg",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Analysis History"}),o.length>0&&t.jsx(M,{variant:"secondary",onClick:g,children:"Clear History"})]}),c?t.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading history..."}):o.length===0?t.jsx("div",{className:"text-center py-8 text-gray-400",children:"No analysis history yet."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Time"}),t.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Source"}),t.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Destination"}),t.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Hops"}),t.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Avg Latency"}),t.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Health"}),t.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Status"})]})}),t.jsx("tbody",{children:o.map(_=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-3 text-sm text-gray-600",children:A(_.timestamp)}),t.jsx("td",{className:"py-3 px-3 text-sm font-mono text-gray-900",children:_.source}),t.jsx("td",{className:"py-3 px-3 text-sm font-mono text-gray-900",children:_.destination}),t.jsx("td",{className:"py-3 px-3 text-sm text-center text-gray-600",children:_.totalHops}),t.jsxs("td",{className:"py-3 px-3 text-sm text-center text-gray-600",children:[_.avgLatency.toFixed(1)," ms"]}),t.jsx("td",{className:"py-3 px-3 text-center",children:t.jsx(hc,{health:_.health})}),t.jsx("td",{className:"py-3 px-3 text-center",children:t.jsx(ve,{variant:_.status==="completed"?"success":"error",children:_.status})})]},_.id))})]})})]})}),k&&t.jsx(uh,{isOpen:k,onClose:()=>C(!1),title:"Save Path",children:t.jsxs("div",{className:"p-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Path Name"}),t.jsx(nr,{value:O,onChange:_=>P(_.target.value),placeholder:"e.g., Production to AWS",className:"mb-4"}),t.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[e,"  ",s," (",a.toUpperCase(),r?`:${r}`:"",")"]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(M,{variant:"secondary",onClick:()=>C(!1),children:"Cancel"}),t.jsx(M,{onClick:B,children:"Save"})]})]})})]})},i1={source:{icon:"",label:"Source",color:"from-blue-500 to-blue-600",borderColor:"border-blue-500"},firewall:{icon:"",label:"Firewall",color:"from-red-500 to-red-600",borderColor:"border-red-500"},cloud_gateway:{icon:"",label:"Cloud Gateway",color:"from-cyan-500 to-cyan-600",borderColor:"border-cyan-500"},nsg:{icon:"",label:"Network Security Group",color:"from-blue-500 to-indigo-600",borderColor:"border-blue-500"},security_group:{icon:"",label:"Security Group",color:"from-orange-500 to-orange-600",borderColor:"border-orange-500"},router:{icon:"",label:"Router",color:"from-purple-500 to-purple-600",borderColor:"border-purple-500"},destination:{icon:"",label:"Destination",color:"from-emerald-500 to-emerald-600",borderColor:"border-emerald-500"},unknown:{icon:"",label:"Unknown",color:"from-slate-500 to-slate-600",borderColor:"border-slate-500"}},l1={low:"bg-slate-500/20 text-slate-400 border-slate-500/30",medium:"bg-amber-500/20 text-amber-400 border-amber-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",critical:"bg-red-500/20 text-red-400 border-red-500/30"},c1=({type:e})=>e==="blocked"?t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}):e==="asymmetric_routing"?t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}):e==="missing_rule"?t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),d1=({hop:e,isLast:s})=>{var d,u,p;const[a,r]=f.useState(!1),n=i1[e.hopType],o=e.issues&&e.issues.length>0,i=(d=e.issues)==null?void 0:d.some(h=>h.type==="blocked"),l=(u=e.issues)==null?void 0:u.some(h=>h.type==="asymmetric_routing"),c=(p=e.issues)==null?void 0:p.some(h=>h.type==="missing_rule");return t.jsxs("div",{className:"relative",children:[!s&&t.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-1 h-12 flex flex-col items-center",children:[t.jsx("div",{className:`flex-1 w-1 ${i?"bg-red-500 animate-pulse":"bg-slate-600"}`}),t.jsx("svg",{className:`w-6 h-6 ${i?"text-red-500":"text-slate-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 16l-6-6h12z"})})]}),t.jsxs("div",{onClick:()=>r(!a),className:`relative bg-slate-800 rounded-lg border-2 ${i?"border-red-500 shadow-red-500/50":l?"border-amber-500 shadow-amber-500/50":c?"border-orange-500 shadow-orange-500/50":n.borderColor} shadow-lg cursor-pointer transition-all hover:scale-105 ${a?"ring-2 ring-cyan-500":""}`,children:[o&&t.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-xs font-bold text-white border-2 border-slate-900",children:e.issues.length}),t.jsx("div",{className:`bg-gradient-to-r ${n.color} p-4 rounded-t-lg`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"text-3xl",children:n.icon}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold text-lg",children:e.deviceName||n.label}),t.jsx("p",{className:"text-white/80 text-sm font-mono",children:e.ipAddress})]})]}),t.jsxs("div",{className:"text-white/90 font-mono text-sm",children:["#",e.hopNumber]})]})}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{className:"bg-slate-700/50 p-2 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Latency"}),t.jsxs("p",{className:`font-bold ${e.avgLatency>100?"text-red-400":e.avgLatency>50?"text-amber-400":"text-emerald-400"}`,children:[e.avgLatency.toFixed(1)," ms"]})]}),t.jsxs("div",{className:"bg-slate-700/50 p-2 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Packet Loss"}),t.jsxs("p",{className:`font-bold ${e.packetLoss>0?"text-red-400":"text-emerald-400"}`,children:[e.packetLoss.toFixed(1),"%"]})]})]}),(e.location||e.cloudProvider)&&t.jsxs("div",{className:"flex gap-2 text-sm",children:[e.location&&t.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs",children:[" ",e.location]}),e.cloudProvider&&t.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 text-slate-300 rounded text-xs uppercase",children:[e.cloudProvider==="aws"&&" AWS",e.cloudProvider==="azure"&&" Azure",e.cloudProvider==="gcp"&&" GCP"]})]}),o&&t.jsx("div",{className:"space-y-2",children:e.issues.map((h,y)=>t.jsx("div",{className:`p-3 rounded-lg border ${l1[h.severity]}`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(c1,{type:h.type}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h5",{className:"font-semibold text-sm capitalize",children:h.type.replace(/_/g," ")}),t.jsx("span",{className:"text-xs uppercase font-bold",children:h.severity})]}),t.jsx("p",{className:"text-sm",children:h.message}),a&&t.jsx("div",{className:"mt-2 pt-2 border-t border-current/20",children:t.jsxs("p",{className:"text-xs opacity-80",children:[" ",h.recommendation]})})]})]})},y))}),a&&e.securityRules&&e.securityRules.length>0&&t.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[t.jsxs("h5",{className:"text-white font-semibold text-sm mb-2 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Security Rules"]}),t.jsx("div",{className:"space-y-1",children:e.securityRules.map(h=>t.jsxs("div",{className:`p-2 rounded text-xs font-mono ${h.matched?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-slate-700/30 text-slate-400"}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"font-semibold",children:h.name}),t.jsx("span",{className:`uppercase font-bold ${h.action==="allow"?"text-emerald-400":"text-red-400"}`,children:h.action})]}),t.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[h.source,"  ",h.destination,":",h.port,"/",h.protocol]})]},h.id))})]}),a&&e.returnPath&&t.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[t.jsx("h5",{className:"text-white font-semibold text-sm mb-2",children:"Return Path"}),t.jsx("div",{className:`p-2 rounded text-sm ${e.returnPath.isSymmetric?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-amber-500/20 text-amber-400 border border-amber-500/30"}`,children:e.returnPath.isSymmetric?t.jsxs("span",{children:[" Symmetric routing via ",e.returnPath.ipAddress]}):t.jsxs("div",{children:[t.jsx("p",{children:" Asymmetric routing detected"}),t.jsx("p",{className:"text-xs mt-1 opacity-80",children:e.returnPath.asymmetryReason})]})})]}),t.jsx("div",{className:"text-center",children:t.jsxs("button",{className:"text-xs text-slate-400 hover:text-cyan-400 flex items-center justify-center gap-1 mx-auto",children:[a?"Less Details":"More Details",t.jsx("svg",{className:`w-3 h-3 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})]})]})},u1=({pathData:e})=>t.jsxs(b,{children:[t.jsx($,{title:"Network Path Graph",subtitle:`${e.source}  ${e.destination}`}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-6 grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-slate-700/50 p-4 rounded-lg border border-slate-600",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-slate-400 text-sm",children:"Total Hops"}),t.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})]}),t.jsx("div",{className:"text-3xl font-bold text-white",children:e.hops.length})]}),t.jsxs("div",{className:`p-4 rounded-lg border ${e.issues.blocked>0?"bg-red-500/10 border-red-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-slate-400 text-sm",children:"Blocked Hops"}),t.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})]}),t.jsx("div",{className:`text-3xl font-bold ${e.issues.blocked>0?"text-red-400":"text-emerald-400"}`,children:e.issues.blocked})]}),t.jsxs("div",{className:`p-4 rounded-lg border ${e.issues.asymmetricRouting>0?"bg-amber-500/10 border-amber-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-slate-400 text-sm",children:"Asymmetric Routes"}),t.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})]}),t.jsx("div",{className:`text-3xl font-bold ${e.issues.asymmetricRouting>0?"text-amber-400":"text-emerald-400"}`,children:e.issues.asymmetricRouting})]}),t.jsxs("div",{className:`p-4 rounded-lg border ${e.issues.missingRules>0?"bg-orange-500/10 border-orange-500/30":"bg-emerald-500/10 border-emerald-500/30"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-slate-400 text-sm",children:"Missing Rules"}),t.jsx("svg",{className:"w-5 h-5 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),t.jsx("div",{className:`text-3xl font-bold ${e.issues.missingRules>0?"text-orange-400":"text-emerald-400"}`,children:e.issues.missingRules})]})]}),t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:`p-4 rounded-lg border-2 ${e.health==="healthy"?"bg-emerald-500/10 border-emerald-500/30":e.health==="degraded"?"bg-amber-500/10 border-amber-500/30":e.health==="critical"?"bg-red-500/10 border-red-500/30":"bg-slate-500/10 border-slate-500/30"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold mb-1",children:"Overall Path Health"}),t.jsxs("p",{className:"text-sm text-slate-400",children:[e.health==="healthy"&&"All hops are operational with no issues detected",e.health==="degraded"&&"Some issues detected - path is functional but may have performance impacts",e.health==="critical"&&"Critical issues detected - path may be blocked or severely degraded",e.health==="unknown"&&"Unable to determine path health"]})]}),t.jsx("div",{className:`px-6 py-3 rounded-lg text-lg font-bold uppercase ${e.health==="healthy"?"bg-emerald-500 text-white":e.health==="degraded"?"bg-amber-500 text-white":e.health==="critical"?"bg-red-500 text-white":"bg-slate-500 text-white"}`,children:e.health})]})})}),t.jsx("div",{className:"relative",children:t.jsx("div",{className:"grid grid-cols-1 gap-12 max-w-4xl mx-auto",children:e.hops.map((s,a)=>t.jsx(d1,{hop:s,isFirst:a===0,isLast:a===e.hops.length-1},s.hopNumber))})}),t.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-700",children:[t.jsx("h4",{className:"text-white font-semibold mb-4",children:"Legend"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-red-500 rounded animate-pulse"}),t.jsx("span",{className:"text-slate-300",children:"Blocked Traffic"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-amber-500 rounded"}),t.jsx("span",{className:"text-slate-300",children:"Asymmetric Routing"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),t.jsx("span",{className:"text-slate-300",children:"Missing Rule"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-emerald-500 rounded"}),t.jsx("span",{className:"text-slate-300",children:"Healthy"})]})]})]})]})]}),p1={id:"path-001",source:"10.100.5.10",destination:"52.94.76.50",health:"healthy",hasReturnPath:!0,issues:{blocked:0,asymmetricRouting:0,missingRules:0,total:0},hops:[{hopNumber:1,hopType:"source",deviceName:"App Server - prod-web-01",ipAddress:"10.100.5.10",hostname:"prod-web-01.company.local",location:"DC-US-EAST-1",asn:null,asnOrg:null,latency:[.8,.9,.7],avgLatency:.8,minLatency:.7,maxLatency:.9,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[],securityRules:[],returnPath:{hopNumber:1,ipAddress:"10.100.5.10",isSymmetric:!0}},{hopNumber:2,hopType:"router",deviceName:"Core Router",ipAddress:"10.100.1.1",hostname:"core-rtr-01.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[2.1,2.3,2],avgLatency:2.1,minLatency:2,maxLatency:2.3,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[],returnPath:{hopNumber:2,ipAddress:"10.100.1.1",isSymmetric:!0}},{hopNumber:3,hopType:"firewall",deviceName:"Production Edge Firewall",ipAddress:"10.100.0.1",hostname:"fw-prod-edge-01.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[4.5,4.8,4.3],avgLatency:4.5,minLatency:4.3,maxLatency:4.8,jitter:.3,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:null,issues:[],securityRules:[{id:"rule-001",name:"Allow-Outbound-HTTPS",action:"allow",source:"10.100.0.0/16",destination:"any",port:"443",protocol:"tcp",priority:100,matched:!0}],returnPath:{hopNumber:3,ipAddress:"10.100.0.1",isSymmetric:!0}},{hopNumber:4,hopType:"cloud_gateway",deviceName:"AWS Direct Connect",ipAddress:"169.254.1.1",hostname:"dx-vif-aws.company.local",location:"us-east-1",asn:"AS16509",asnOrg:"Amazon.com Inc.",latency:[8.2,8.5,8.1],avgLatency:8.3,minLatency:8.1,maxLatency:8.5,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:"aws",region:"us-east-1",issues:[],returnPath:{hopNumber:4,ipAddress:"169.254.1.1",isSymmetric:!0}},{hopNumber:5,hopType:"security_group",deviceName:"App-Tier Security Group",ipAddress:"172.31.10.1",hostname:null,location:"us-east-1a",asn:"AS16509",asnOrg:"Amazon.com Inc.",latency:[10.1,10.4,9.9],avgLatency:10.1,minLatency:9.9,maxLatency:10.4,jitter:.3,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:"aws",region:"us-east-1",issues:[],securityRules:[{id:"sg-rule-001",name:"Allow-Inbound-HTTPS",action:"allow",source:"10.100.0.0/16",destination:"172.31.10.0/24",port:"443",protocol:"tcp",priority:100,matched:!0}],returnPath:{hopNumber:5,ipAddress:"172.31.10.1",isSymmetric:!0}},{hopNumber:6,hopType:"destination",deviceName:"AWS Application Server",ipAddress:"52.94.76.50",hostname:"ec2-52-94-76-50.compute-1.amazonaws.com",location:"us-east-1a",asn:"AS16509",asnOrg:"Amazon.com Inc.",latency:[12.3,12.6,12.1],avgLatency:12.3,minLatency:12.1,maxLatency:12.6,jitter:.3,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:"aws",region:"us-east-1",issues:[],returnPath:{hopNumber:6,ipAddress:"52.94.76.50",isSymmetric:!0}}]},m1={id:"path-002",source:"10.200.15.20",destination:"172.16.50.100",health:"critical",hasReturnPath:!1,issues:{blocked:1,asymmetricRouting:0,missingRules:0,total:1},hops:[{hopNumber:1,hopType:"source",deviceName:"UAT Server",ipAddress:"10.200.15.20",hostname:"uat-app-02.company.local",location:"DC-US-WEST-1",asn:null,asnOrg:null,latency:[.9,1,.8],avgLatency:.9,minLatency:.8,maxLatency:1,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[],securityRules:[]},{hopNumber:2,hopType:"router",deviceName:"Distribution Router",ipAddress:"10.200.1.1",hostname:"dist-rtr-02.company.local",location:"DC-US-WEST-1",asn:"AS64512",asnOrg:"Company Network",latency:[3.2,3.5,3.1],avgLatency:3.3,minLatency:3.1,maxLatency:3.5,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[]},{hopNumber:3,hopType:"firewall",deviceName:"UAT Firewall",ipAddress:"10.200.0.1",hostname:"fw-uat-01.company.local",location:"DC-US-WEST-1",asn:"AS64512",asnOrg:"Company Network",latency:[0,0,0],avgLatency:0,minLatency:0,maxLatency:0,jitter:0,packetLoss:100,status:"unreachable",deviceType:"firewall",cloudProvider:null,issues:[{type:"blocked",severity:"critical",message:"Traffic is being blocked by firewall rule",recommendation:"Review firewall rules and add appropriate allow rule for this traffic",details:"Deny rule at priority 50 is blocking TCP/443 traffic from 10.200.0.0/16 to 172.16.50.0/24"},{type:"missing_rule",severity:"high",message:"No explicit allow rule found for this traffic",recommendation:"Add allow rule: permit tcp 10.200.15.20 172.16.50.100 eq 443"}],securityRules:[{id:"rule-deny-001",name:"Deny-UAT-to-Prod",action:"deny",source:"10.200.0.0/16",destination:"172.16.0.0/16",port:"any",protocol:"any",priority:50,matched:!0}]}]},h1={id:"path-003",source:"10.100.20.30",destination:"13.82.100.50",health:"degraded",hasReturnPath:!0,issues:{blocked:0,asymmetricRouting:2,missingRules:0,total:2},hops:[{hopNumber:1,hopType:"source",deviceName:"Production DB Server",ipAddress:"10.100.20.30",hostname:"prod-db-01.company.local",location:"DC-US-EAST-1",asn:null,asnOrg:null,latency:[.7,.8,.7],avgLatency:.7,minLatency:.7,maxLatency:.8,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[],returnPath:{hopNumber:1,ipAddress:"10.100.20.30",isSymmetric:!0}},{hopNumber:2,hopType:"router",deviceName:"Core Router Primary",ipAddress:"10.100.1.5",hostname:"core-rtr-pri.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[2.5,2.7,2.4],avgLatency:2.5,minLatency:2.4,maxLatency:2.7,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[{type:"asymmetric_routing",severity:"medium",message:"Return path uses different router (core-rtr-sec)",recommendation:"Verify routing policies and ensure symmetric routing for stateful connections",details:"Forward: core-rtr-pri (10.100.1.5), Return: core-rtr-sec (10.100.1.6)"}],returnPath:{hopNumber:2,ipAddress:"10.100.1.6",isSymmetric:!1,asymmetryReason:"Return path uses secondary core router due to ECMP load balancing"}},{hopNumber:3,hopType:"firewall",deviceName:"Production Firewall",ipAddress:"10.100.0.1",hostname:"fw-prod-01.company.local",location:"DC-US-EAST-1",asn:"AS64512",asnOrg:"Company Network",latency:[5.2,5.5,5.1],avgLatency:5.3,minLatency:5.1,maxLatency:5.5,jitter:.2,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:null,issues:[],securityRules:[{id:"rule-002",name:"Allow-Azure-Access",action:"allow",source:"10.100.0.0/16",destination:"13.0.0.0/8",port:"443",protocol:"tcp",priority:100,matched:!0}],returnPath:{hopNumber:3,ipAddress:"10.100.0.1",isSymmetric:!0}},{hopNumber:4,hopType:"cloud_gateway",deviceName:"Azure ExpressRoute",ipAddress:"169.254.2.1",hostname:"er-vnet-azure.company.local",location:"eastus",asn:"AS8075",asnOrg:"Microsoft Corporation",latency:[15.3,15.8,15.1],avgLatency:15.4,minLatency:15.1,maxLatency:15.8,jitter:.4,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:"azure",region:"eastus",issues:[{type:"asymmetric_routing",severity:"medium",message:"Return traffic routed through different ExpressRoute circuit",recommendation:"Configure route preferences to ensure symmetric routing",details:"Forward: Primary circuit, Return: Secondary circuit"}],returnPath:{hopNumber:4,ipAddress:"169.254.2.2",isSymmetric:!1,asymmetryReason:"Return path uses secondary ExpressRoute circuit for load distribution"}},{hopNumber:5,hopType:"nsg",deviceName:"Database NSG",ipAddress:"10.50.20.1",hostname:null,location:"eastus",asn:"AS8075",asnOrg:"Microsoft Corporation",latency:[18.2,18.6,18],avgLatency:18.3,minLatency:18,maxLatency:18.6,jitter:.3,packetLoss:0,status:"reachable",deviceType:"firewall",cloudProvider:"azure",region:"eastus",issues:[],securityRules:[{id:"nsg-rule-001",name:"Allow-Internal-DB",action:"allow",source:"10.100.0.0/16",destination:"10.50.20.0/24",port:"1433",protocol:"tcp",priority:100,matched:!1},{id:"nsg-rule-002",name:"Allow-HTTPS",action:"allow",source:"any",destination:"10.50.20.0/24",port:"443",protocol:"tcp",priority:110,matched:!0}],returnPath:{hopNumber:5,ipAddress:"10.50.20.1",isSymmetric:!0}},{hopNumber:6,hopType:"destination",deviceName:"Azure SQL Database",ipAddress:"13.82.100.50",hostname:"sqldb-prod-01.database.windows.net",location:"eastus",asn:"AS8075",asnOrg:"Microsoft Corporation",latency:[20.5,20.9,20.3],avgLatency:20.6,minLatency:20.3,maxLatency:20.9,jitter:.3,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:"azure",region:"eastus",issues:[],returnPath:{hopNumber:6,ipAddress:"13.82.100.50",isSymmetric:!0}}]},g1={id:"path-004",source:"10.150.10.15",destination:"35.192.50.25",health:"degraded",hasReturnPath:!0,issues:{blocked:0,asymmetricRouting:0,missingRules:1,total:1},hops:[{hopNumber:1,hopType:"source",deviceName:"Dev Application Server",ipAddress:"10.150.10.15",hostname:"dev-app-03.company.local",location:"DC-US-WEST-2",asn:null,asnOrg:null,latency:[1,1.1,.9],avgLatency:1,minLatency:.9,maxLatency:1.1,jitter:.1,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:null,issues:[]},{hopNumber:2,hopType:"router",deviceName:"Access Router",ipAddress:"10.150.1.1",hostname:"access-rtr-03.company.local",location:"DC-US-WEST-2",asn:"AS64512",asnOrg:"Company Network",latency:[3.8,4,3.7],avgLatency:3.8,minLatency:3.7,maxLatency:4,jitter:.2,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:null,issues:[]},{hopNumber:3,hopType:"firewall",deviceName:"Dev Firewall",ipAddress:"10.150.0.1",hostname:"fw-dev-01.company.local",location:"DC-US-WEST-2",asn:"AS64512",asnOrg:"Company Network",latency:[125.3,128.5,124.1],avgLatency:126,minLatency:124.1,maxLatency:128.5,jitter:2.2,packetLoss:2.5,status:"reachable",deviceType:"firewall",cloudProvider:null,issues:[{type:"missing_rule",severity:"high",message:"No explicit rule found - traffic falling back to default policy",recommendation:"Add explicit allow rule to improve performance and security posture",details:"Traffic is allowed by implicit default-allow but causing deep packet inspection delays"},{type:"high_latency",severity:"medium",message:"High latency detected (126ms) - significantly above baseline",recommendation:"Investigate firewall processing load and rule optimization"},{type:"packet_loss",severity:"low",message:"Minor packet loss detected (2.5%)",recommendation:"Monitor for persistent packet loss issues"}],securityRules:[{id:"rule-default",name:"Default-Allow-All",action:"allow",source:"any",destination:"any",port:"any",protocol:"any",priority:9999,matched:!0}]},{hopNumber:4,hopType:"cloud_gateway",deviceName:"GCP Cloud Interconnect",ipAddress:"169.254.3.1",hostname:"interconnect-gcp.company.local",location:"us-west2",asn:"AS15169",asnOrg:"Google LLC",latency:[135.2,136.1,134.8],avgLatency:135.4,minLatency:134.8,maxLatency:136.1,jitter:.7,packetLoss:0,status:"reachable",deviceType:"router",cloudProvider:"gcp",region:"us-west2",issues:[]},{hopNumber:5,hopType:"destination",deviceName:"GCP Compute Instance",ipAddress:"35.192.50.25",hostname:"instance-1.us-west2-a.c.project-id.internal",location:"us-west2-a",asn:"AS15169",asnOrg:"Google LLC",latency:[138.5,139.2,138.1],avgLatency:138.6,minLatency:138.1,maxLatency:139.2,jitter:.6,packetLoss:0,status:"reachable",deviceType:"server",cloudProvider:"gcp",region:"us-west2",issues:[]}]},gc={healthy:p1,blocked:m1,asymmetric:h1,missingRule:g1},x1=()=>{const[e,s]=f.useState("graph"),[a,r]=f.useState("healthy"),[n,o]=f.useState(gc.healthy),i=c=>{r(c),c!=="custom"&&o(gc[c])},l=[{id:"healthy",name:"Healthy Path",description:"Production to AWS - No issues",icon:"",color:"from-emerald-500 to-emerald-600"},{id:"blocked",name:"Blocked Traffic",description:"Firewall blocking UAT to Prod",icon:"",color:"from-red-500 to-red-600"},{id:"asymmetric",name:"Asymmetric Routing",description:"Different forward/return paths",icon:"",color:"from-amber-500 to-amber-600"},{id:"missingRule",name:"Missing Rule",description:"Fallback to default policy",icon:"",color:"from-orange-500 to-orange-600"}];return t.jsxs(J,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Traffic Path Analysis"}),t.jsx("p",{className:"text-slate-400",children:"Graph-based visualization with blocked hop, asymmetric routing, and missing rule detection"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[t.jsxs(b,{className:"p-4",children:[t.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Visualization Mode"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:e==="graph"?"primary":"secondary",onClick:()=>s("graph"),className:"flex-1",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),"Graph View"]}),t.jsxs(M,{variant:e==="list"?"primary":"secondary",onClick:()=>s("list"),className:"flex-1",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),"List View"]})]})]}),t.jsxs(b,{className:"p-4 col-span-2",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Current Path"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Source"}),t.jsx("p",{className:"text-white font-mono",children:n.source})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Destination"}),t.jsx("p",{className:"text-white font-mono",children:n.destination})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 mb-1",children:"Total Hops"}),t.jsx("p",{className:"text-white font-semibold",children:n.hops.length})]})]})]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs(b,{className:"p-6",children:[t.jsxs("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),"Sample Scenarios"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:l.map(c=>t.jsxs("button",{onClick:()=>i(c.id),className:`p-4 rounded-lg border-2 transition-all text-left ${a===c.id?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[t.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${c.color} rounded-lg flex items-center justify-center text-2xl mb-3`,children:c.icon}),t.jsx("h4",{className:"text-white font-semibold mb-1",children:c.name}),t.jsx("p",{className:"text-slate-400 text-xs",children:c.description})]},c.id))})]})}),e==="graph"?t.jsx(u1,{pathData:n}):t.jsxs(b,{className:"p-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"List View"}),t.jsx("p",{className:"text-slate-400 text-center py-8",children:"List view coming soon - showing classic hop-by-hop table format"})]}),t.jsxs("div",{className:"mt-6 flex justify-between",children:[t.jsxs(M,{variant:"ghost",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Report"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Compare Paths"]}),t.jsxs(M,{variant:"primary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Run New Analysis"]})]})]})]})},f1=()=>t.jsx(J,{children:t.jsx(b,{className:"bg-white shadow-lg",children:t.jsx("div",{className:"text-center py-16 text-gray-400",children:"Route Intelligence View - AI-powered routing analysis"})})}),Gu=()=>{const[e,s]=f.useState([]),[a,r]=f.useState(null),[n,o]=f.useState(!0),[i,l]=f.useState(!1),[c,d]=f.useState(null),[u,p]=f.useState({}),[h,y]=f.useState(null),[j,v]=f.useState(!1),L=f.useCallback(async P=>{try{o(!0),d(null);const I=P??u,W=await $t.getTickets(I);s(W)}catch(I){d(I instanceof Error?I.message:"Failed to load tickets")}finally{o(!1)}},[u]);f.useEffect(()=>{L()},[]);const x={awaiting:e.filter(P=>P.status==="awaiting"),approved:e.filter(P=>P.status==="approved"),implementing:e.filter(P=>P.status==="implementing"),completed:e.filter(P=>P.status==="completed"),rejected:e.filter(P=>P.status==="rejected")},m=f.useCallback(async P=>{if(!P){r(null);return}try{const I=await $t.getTicketById(P);r(I)}catch(I){d(I instanceof Error?I.message:"Failed to load ticket details")}},[]),g=f.useCallback(async P=>{l(!0),d(null);try{const I=await $t.createTicket(P);return s(W=>[I,...W]),I}catch(I){const W=I instanceof Error?I.message:"Failed to create ticket";throw d(W),new Error(W)}finally{l(!1)}},[]),w=f.useCallback(async(P,I)=>{try{const W=await $t.updateTicketStatus(P,I);W&&(s(B=>B.map(A=>A.id===P?W:A)),(a==null?void 0:a.id)===P&&r(W))}catch(W){d(W instanceof Error?W.message:"Failed to update ticket status")}},[a]),N=f.useCallback(async(P,I,W)=>{try{const B=await $t.approveTicketStep(P,I,W);B&&(s(A=>A.map(_=>_.id===P?B:_)),(a==null?void 0:a.id)===P&&r(B))}catch(B){d(B instanceof Error?B.message:"Failed to approve ticket step")}},[a]),k=f.useCallback(async(P,I,W)=>{try{const B=await $t.rejectTicketStep(P,I,W);B&&(s(A=>A.map(_=>_.id===P?B:_)),(a==null?void 0:a.id)===P&&r(B))}catch(B){d(B instanceof Error?B.message:"Failed to reject ticket step")}},[a]),C=f.useCallback(async P=>{v(!0);try{const I=await $t.calculateRisk(P);y(I)}catch(I){d(I instanceof Error?I.message:"Failed to calculate risk")}finally{v(!1)}},[]),O=f.useCallback(()=>{d(null)},[]);return{tickets:e,ticketsByStatus:x,selectedTicket:a,isLoading:n,isSubmitting:i,error:c,filter:u,riskAssessment:h,isCalculatingRisk:j,loadTickets:L,selectTicket:m,createTicket:g,updateStatus:w,approveStep:N,rejectStep:k,setFilter:P=>{p(P),L(P)},calculateRisk:C,clearError:O}},xc={title:"",description:"",priority:"medium",category:"firewall_rule",changeType:"add",sourceIp:"",destinationIp:"",port:"",protocol:"tcp",action:"allow",platform:"aws",justification:"",scheduledAt:"",rollbackPlan:""},v1=[{value:"firewall_rule",label:"Firewall Rule"},{value:"security_group",label:"Security Group"},{value:"network_acl",label:"Network ACL"},{value:"routing",label:"Routing"},{value:"load_balancer",label:"Load Balancer"},{value:"vpn",label:"VPN"},{value:"dns",label:"DNS"},{value:"other",label:"Other"}],y1=[{value:"low",label:"Low",color:"bg-slate-500"},{value:"medium",label:"Medium",color:"bg-amber-500"},{value:"high",label:"High",color:"bg-orange-500"},{value:"critical",label:"Critical",color:"bg-red-500"}],b1=[{value:"add",label:"Add Rule",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})},{value:"modify",label:"Modify Rule",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{value:"delete",label:"Delete Rule",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}],_1=({assessment:e,isLoading:s})=>{if(s)return t.jsxs("div",{className:"flex items-center justify-center py-8",children:[t.jsxs("svg",{className:"animate-spin h-6 w-6 text-cyan-500",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("span",{className:"ml-2 text-slate-400",children:"Calculating risk..."})]});if(!e)return t.jsx("div",{className:"text-center py-8 text-slate-500",children:"Fill in the rule details to see risk assessment"});const a={low:"text-emerald-400 bg-emerald-500/20",medium:"text-amber-400 bg-amber-500/20",high:"text-orange-400 bg-orange-500/20",critical:"text-red-400 bg-red-500/20"},r={low:"bg-emerald-500",medium:"bg-amber-500",high:"bg-orange-500",critical:"bg-red-500"};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-400",children:"Risk Score"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-3xl font-bold text-white",children:e.score}),t.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a[e.level]}`,children:e.level.toUpperCase()})]})]})}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${r[e.level]} transition-all duration-500`,style:{width:`${e.score}%`}})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Risk Factors"}),e.factors.map((n,o)=>t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[n.impact==="negative"?t.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):t.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-slate-300",children:n.name})]}),t.jsxs("span",{className:n.weight>0?"text-red-400":"text-emerald-400",children:[n.weight>0?"+":"",n.weight]})]},o))]}),t.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[t.jsx("p",{className:"text-sm text-slate-400",children:"Recommendation"}),t.jsx("p",{className:"text-white",children:e.recommendation})]})]})},w1=()=>{const{createTicket:e,isSubmitting:s,riskAssessment:a,isCalculatingRisk:r,calculateRisk:n,error:o,clearError:i}=Gu(),[l,c]=f.useState(xc),[d,u]=f.useState(!1),[p,h]=f.useState(null);f.useEffect(()=>{const v=setTimeout(()=>{(l.sourceIp||l.destinationIp||l.port)&&n(l)},500);return()=>clearTimeout(v)},[l.sourceIp,l.destinationIp,l.port,l.action,l.changeType,l.priority,n]);const y=async v=>{v.preventDefault();try{const L=await e(l);h(L.serviceNowId),u(!0)}catch{}},j=()=>{c(xc),u(!1),h(null),i()};return d&&p?t.jsx(J,{children:t.jsx("div",{className:"max-w-2xl mx-auto",children:t.jsx(b,{className:"text-center",children:t.jsxs("div",{className:"py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Change Request Submitted"}),t.jsx("p",{className:"text-slate-400 mb-4",children:"Your request has been submitted to ServiceNow for review."}),t.jsxs("div",{className:"inline-block px-4 py-2 bg-slate-700 rounded-lg mb-6",children:[t.jsx("p",{className:"text-sm text-slate-400",children:"ServiceNow Ticket ID"}),t.jsx("p",{className:"text-xl font-mono font-bold text-cyan-400",children:p})]}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(M,{variant:"primary",onClick:j,children:"Create Another Request"}),t.jsx(M,{variant:"secondary",children:"View in ServiceNow"})]})]})})})}):t.jsx(J,{children:t.jsx("form",{onSubmit:y,children:t.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[t.jsxs("div",{className:"col-span-2 space-y-6",children:[o&&t.jsxs("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg flex items-center justify-between",children:[t.jsx("span",{className:"text-red-400",children:o}),t.jsx("button",{type:"button",onClick:i,className:"text-red-400 hover:text-red-300",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs(b,{children:[t.jsx($,{title:"Request Details"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Request Title *"}),t.jsx("input",{type:"text",required:!0,value:l.title,onChange:v=>c({...l,title:v.target.value}),placeholder:"e.g., Allow HTTPS traffic from DMZ to Production",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Description *"}),t.jsx("textarea",{required:!0,rows:3,value:l.description,onChange:v=>c({...l,description:v.target.value}),placeholder:"Describe the change and business justification...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Category *"}),t.jsx("select",{value:l.category,onChange:v=>c({...l,category:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:v1.map(v=>t.jsx("option",{value:v.value,children:v.label},v.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Target Platform *"}),t.jsxs("select",{value:l.platform,onChange:v=>c({...l,platform:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"aws",children:"AWS"}),t.jsx("option",{value:"azure",children:"Azure"}),t.jsx("option",{value:"gcp",children:"GCP"}),t.jsx("option",{value:"onprem",children:"On-Premises"})]})]})]})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Change Type"}),t.jsx("div",{className:"grid grid-cols-3 gap-3",children:b1.map(v=>t.jsxs("button",{type:"button",onClick:()=>c({...l,changeType:v.value}),className:`p-4 rounded-lg border-2 transition-all flex flex-col items-center gap-2 ${l.changeType===v.value?"border-cyan-500 bg-cyan-500/10 text-cyan-400":"border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600"}`,children:[v.icon,t.jsx("span",{className:"font-medium",children:v.label})]},v.value))})]}),t.jsxs(b,{children:[t.jsx($,{title:"Rule Details"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Source IP/CIDR *"}),t.jsx("input",{type:"text",required:!0,value:l.sourceIp,onChange:v=>c({...l,sourceIp:v.target.value}),placeholder:"e.g., 10.0.1.0/24",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Destination IP/CIDR *"}),t.jsx("input",{type:"text",required:!0,value:l.destinationIp,onChange:v=>c({...l,destinationIp:v.target.value}),placeholder:"e.g., 10.0.2.0/24",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Port *"}),t.jsx("input",{type:"text",required:!0,value:l.port,onChange:v=>c({...l,port:v.target.value}),placeholder:"e.g., 443",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Protocol *"}),t.jsxs("select",{value:l.protocol,onChange:v=>c({...l,protocol:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"tcp",children:"TCP"}),t.jsx("option",{value:"udp",children:"UDP"}),t.jsx("option",{value:"icmp",children:"ICMP"}),t.jsx("option",{value:"any",children:"Any"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Action *"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("button",{type:"button",onClick:()=>c({...l,action:"allow"}),className:`px-4 py-2 rounded-lg font-medium transition-all ${l.action==="allow"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:"Allow"}),t.jsx("button",{type:"button",onClick:()=>c({...l,action:"deny"}),className:`px-4 py-2 rounded-lg font-medium transition-all ${l.action==="deny"?"bg-red-500 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:"Deny"})]})]})]})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Implementation Details"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Business Justification *"}),t.jsx("textarea",{required:!0,rows:2,value:l.justification,onChange:v=>c({...l,justification:v.target.value}),placeholder:"Why is this change necessary?",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Scheduled Date/Time"}),t.jsx("input",{type:"datetime-local",value:l.scheduledAt,onChange:v=>c({...l,scheduledAt:v.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Priority *"}),t.jsx("div",{className:"flex gap-2",children:y1.map(v=>t.jsx("button",{type:"button",onClick:()=>c({...l,priority:v.value}),className:`flex-1 px-3 py-2 rounded-lg font-medium text-sm transition-all ${l.priority===v.value?`${v.color} text-white`:"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:v.label},v.value))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Rollback Plan"}),t.jsx("textarea",{rows:2,value:l.rollbackPlan,onChange:v=>c({...l,rollbackPlan:v.target.value}),placeholder:"How will you revert this change if needed?",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx(M,{type:"button",variant:"ghost",onClick:j,children:"Clear Form"}),t.jsx(M,{type:"submit",variant:"primary",isLoading:s,children:"Submit Change Request"})]})]}),t.jsx("div",{className:"col-span-1",children:t.jsx("div",{className:"sticky top-6",children:t.jsxs(b,{children:[t.jsx($,{title:"Risk Assessment"}),t.jsx(_1,{assessment:a,isLoading:r})]})})})]})})})},$o={awaiting:{label:"Awaiting Approval",color:"bg-amber-500",bgColor:"bg-amber-50"},approved:{label:"Approved",color:"bg-blue-500",bgColor:"bg-blue-50"},implementing:{label:"Implementing",color:"bg-purple-500",bgColor:"bg-purple-50"},completed:{label:"Completed",color:"bg-green-500",bgColor:"bg-green-50"},rejected:{label:"Rejected",color:"bg-red-500",bgColor:"bg-red-50"}},Hu={low:{label:"Low",color:"text-slate-600",dotColor:"bg-slate-400"},medium:{label:"Medium",color:"text-blue-600",dotColor:"bg-blue-500"},high:{label:"High",color:"text-amber-600",dotColor:"bg-amber-500"},critical:{label:"Critical",color:"text-red-600",dotColor:"bg-red-500"}},Fu={low:{color:"text-green-700",bgColor:"bg-green-100"},medium:{color:"text-amber-700",bgColor:"bg-amber-100"},high:{color:"text-orange-700",bgColor:"bg-orange-100"},critical:{color:"text-red-700",bgColor:"bg-red-100"}},Wu={firewall_rule:"Firewall Rule",security_group:"Security Group",network_acl:"Network ACL",routing:"Routing",load_balancer:"Load Balancer",vpn:"VPN",dns:"DNS",other:"Other"},j1=()=>{const{ticketsByStatus:e,isLoading:s,error:a,selectedTicket:r,selectTicket:n,updateStatus:o,approveStep:i,rejectStep:l}=Gu(),[c,d]=f.useState(!1),[u,p]=f.useState(""),[h,y]=f.useState(""),[j,v]=f.useState(null),L=async k=>{await n(k.id),d(!0),p(""),y(""),v(null)},x=()=>{d(!1),n(null)},m=async k=>{r&&(await i(r.id,k,u),p(""),v(null))},g=async k=>{r&&h.trim()&&(await l(r.id,k,h),y(""),v(null))},w=async(k,C)=>{await o(k,C)},N=["awaiting","approved","implementing","completed","rejected"];return s?t.jsx(J,{children:t.jsxs("div",{className:"flex items-center justify-center h-64",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),t.jsx("span",{className:"ml-3 text-slate-600",children:"Loading tickets..."})]})}):a?t.jsx(J,{children:t.jsxs("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg",children:["Error loading tickets: ",a]})}):t.jsx(J,{children:t.jsxs("div",{className:"flex gap-6 h-[calc(100vh-200px)]",children:[t.jsx("div",{className:`flex-1 grid grid-cols-5 gap-4 transition-all ${c?"w-2/3":"w-full"}`,children:N.map(k=>t.jsx(N1,{status:k,config:$o[k],tickets:e[k],onTicketClick:L,onStatusChange:w,selectedTicketId:r==null?void 0:r.id},k))}),c&&r&&t.jsx(S1,{ticket:r,onClose:x,approvalComment:u,setApprovalComment:p,rejectComment:h,setRejectComment:y,activeApprovalStep:j,setActiveApprovalStep:v,onApprove:m,onReject:g})]})})},N1=({config:e,tickets:s,onTicketClick:a,selectedTicketId:r})=>t.jsxs("div",{className:`${e.bgColor} rounded-xl overflow-hidden flex flex-col`,children:[t.jsxs("div",{className:`${e.color} px-4 py-3 text-white font-semibold flex items-center justify-between`,children:[t.jsx("span",{children:e.label}),t.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-sm",children:s.length})]}),t.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-3",children:s.length===0?t.jsx("div",{className:"text-center text-slate-400 py-8 text-sm",children:"No tickets"}):s.map(n=>t.jsx(k1,{ticket:n,onClick:()=>a(n),isSelected:n.id===r},n.id))})]}),k1=({ticket:e,onClick:s,isSelected:a})=>{const r=Hu[e.priority],n=Fu[e.riskAssessment.level],o=e.approvalSteps.filter(l=>l.status==="pending").length,i=e.approvalSteps.length;return t.jsxs("div",{onClick:s,className:`bg-white rounded-lg p-3 shadow-sm cursor-pointer transition-all hover:shadow-md ${a?"ring-2 ring-cyan-500 shadow-md":""}`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsx("span",{className:"text-xs font-mono text-slate-500",children:e.serviceNowId}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${r.dotColor}`}),t.jsx("span",{className:`text-xs ${r.color}`,children:r.label})]})]}),t.jsx("h4",{className:"font-medium text-slate-800 text-sm mb-2 line-clamp-2",children:e.title}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded",children:Wu[e.category]||e.category}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.changeType==="add"?"bg-green-100 text-green-700":e.changeType==="delete"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:e.changeType.charAt(0).toUpperCase()+e.changeType.slice(1)})]}),t.jsxs("div",{className:`text-xs px-2 py-1 rounded ${n.bgColor} ${n.color} mb-2 inline-block`,children:["Risk: ",e.riskAssessment.level.charAt(0).toUpperCase()+e.riskAssessment.level.slice(1)," (",e.riskAssessment.score,"/100)"]}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 pt-2 border-t border-slate-100",children:[t.jsx("span",{children:e.assignee}),i>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),i-o,"/",i]})]})]})},S1=({ticket:e,onClose:s,approvalComment:a,setApprovalComment:r,rejectComment:n,setRejectComment:o,activeApprovalStep:i,setActiveApprovalStep:l,onApprove:c,onReject:d})=>{const u=Hu[e.priority],p=Fu[e.riskAssessment.level];return t.jsxs("div",{className:"w-1/3 min-w-[400px] bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"bg-slate-800 text-white p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-mono text-sm text-slate-300",children:e.serviceNowId}),t.jsx("button",{onClick:s,className:"text-slate-400 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("h3",{className:"font-semibold text-lg",children:e.title}),t.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[t.jsx("span",{className:`${$o[e.status].color} text-white text-xs px-2 py-1 rounded`,children:$o[e.status].label}),t.jsxs("span",{className:`flex items-center gap-1 text-xs ${u.color}`,children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${u.dotColor}`}),u.label," Priority"]})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.jsxs("section",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Description"}),t.jsx("p",{className:"text-sm text-slate-600",children:e.description})]}),t.jsxs("section",{className:"grid grid-cols-2 gap-3",children:[t.jsx(hs,{label:"Category",value:Wu[e.category]||e.category}),t.jsx(hs,{label:"Change Type",value:e.changeType.charAt(0).toUpperCase()+e.changeType.slice(1)}),t.jsx(hs,{label:"Requester",value:e.requester}),t.jsx(hs,{label:"Assignee",value:e.assignee}),t.jsx(hs,{label:"Created",value:new Date(e.createdAt).toLocaleDateString()}),e.scheduledAt&&t.jsx(hs,{label:"Scheduled",value:new Date(e.scheduledAt).toLocaleDateString()})]}),t.jsxs("section",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Risk Assessment"}),t.jsxs("div",{className:`${p.bgColor} ${p.color} rounded-lg p-3`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("span",{className:"font-semibold",children:[e.riskAssessment.level.charAt(0).toUpperCase()+e.riskAssessment.level.slice(1)," Risk"]}),t.jsxs("span",{className:"text-lg font-bold",children:[e.riskAssessment.score,"/100"]})]}),t.jsx("p",{className:"text-sm",children:e.riskAssessment.recommendation}),e.riskAssessment.factors.length>0&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-current/20",children:[t.jsx("p",{className:"text-xs font-medium mb-1",children:"Risk Factors:"}),t.jsx("ul",{className:"text-xs space-y-1",children:e.riskAssessment.factors.slice(0,3).map((h,y)=>t.jsxs("li",{className:"flex items-start gap-1",children:[t.jsx("span",{children:h.impact==="negative"?"":h.impact==="positive"?"":""}),t.jsx("span",{children:h.description})]},y))})]})]})]}),e.affectedResources.length>0&&t.jsxs("section",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Affected Resources"}),t.jsx("div",{className:"space-y-2",children:e.affectedResources.map(h=>t.jsxs("div",{className:"bg-slate-50 rounded p-2 text-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"font-medium",children:h.name}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${h.platform==="aws"?"bg-orange-100 text-orange-700":h.platform==="azure"?"bg-blue-100 text-blue-700":h.platform==="gcp"?"bg-red-100 text-red-700":"bg-slate-200 text-slate-700"}`,children:h.platform.toUpperCase()})]}),t.jsxs("p",{className:"text-xs text-slate-500",children:[h.type," ",h.region&&` ${h.region}`]})]},h.id))})]}),t.jsxs("section",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Approval Workflow"}),t.jsx("div",{className:"space-y-2",children:e.approvalSteps.map(h=>t.jsx(C1,{step:h,isActive:i===h.id,onToggle:()=>l(i===h.id?null:h.id),approvalComment:a,setApprovalComment:r,rejectComment:n,setRejectComment:o,onApprove:()=>c(h.id),onReject:()=>d(h.id)},h.id))})]}),e.rollbackPlan&&t.jsxs("section",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Rollback Plan"}),t.jsx("p",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3",children:e.rollbackPlan})]}),e.implementationNotes&&t.jsxs("section",{children:[t.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Implementation Notes"}),t.jsx("p",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3",children:e.implementationNotes})]})]})]})},hs=({label:e,value:s})=>t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-slate-500",children:e}),t.jsx("p",{className:"text-sm font-medium text-slate-700",children:s})]}),C1=({step:e,isActive:s,onToggle:a,approvalComment:r,setApprovalComment:n,rejectComment:o,setRejectComment:i,onApprove:l,onReject:c})=>{const u={pending:{icon:"",color:"text-amber-600",bg:"bg-amber-50"},approved:{icon:"",color:"text-green-600",bg:"bg-green-50"},rejected:{icon:"",color:"text-red-600",bg:"bg-red-50"}}[e.status];return t.jsxs("div",{className:`${u.bg} rounded-lg overflow-hidden`,children:[t.jsxs("div",{className:`p-3 flex items-center justify-between cursor-pointer ${e.status==="pending"?"hover:bg-amber-100":""}`,onClick:e.status==="pending"?a:void 0,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${u.bg} ${u.color}`,children:u.icon}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-slate-700",children:e.name}),t.jsx("p",{className:"text-xs text-slate-500",children:e.approver})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:`text-xs font-medium ${u.color}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.timestamp&&t.jsx("p",{className:"text-xs text-slate-400",children:new Date(e.timestamp).toLocaleDateString()})]})]}),e.status==="pending"&&s&&t.jsxs("div",{className:"p-3 border-t border-amber-200 space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Approval Comment (optional)"}),t.jsx("textarea",{value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-cyan-500 focus:border-transparent",rows:2,placeholder:"Add a comment..."})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:l,className:"flex-1 bg-green-500 text-white py-2 px-3 rounded text-sm font-medium hover:bg-green-600 transition-colors",children:"Approve"}),t.jsx("button",{onClick:()=>{o.trim()||i("")},className:"flex-1 bg-white text-slate-700 py-2 px-3 rounded text-sm font-medium border border-slate-300 hover:bg-slate-50 transition-colors",children:"Reject"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Rejection Reason (required to reject)"}),t.jsx("textarea",{value:o,onChange:p=>i(p.target.value),className:"w-full px-3 py-2 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-red-500 focus:border-transparent",rows:2,placeholder:"Explain why this is being rejected..."}),o.trim()&&t.jsx("button",{onClick:c,className:"mt-2 w-full bg-red-500 text-white py-2 px-3 rounded text-sm font-medium hover:bg-red-600 transition-colors",children:"Confirm Rejection"})]})]}),e.comments&&t.jsx("div",{className:"px-3 pb-3",children:t.jsxs("p",{className:"text-xs text-slate-500 italic",children:['"',e.comments,'"']})})]})},A1={production:"bg-red-500/20 text-red-400 border-red-500/30",uat:"bg-amber-500/20 text-amber-400 border-amber-500/30",development:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"},T1=({parsedData:e})=>t.jsxs(b,{children:[t.jsx($,{title:"AI Ticket Analysis",subtitle:"Automatically extracted from ServiceNow"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{children:t.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold border ${A1[e.environment]}`,children:[e.environment.toUpperCase()," Environment"]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Source IP/CIDR"}),t.jsx("p",{className:"text-white font-mono font-semibold",children:e.sourceIp})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Destination IP"}),t.jsx("p",{className:"text-white font-mono font-semibold",children:e.destinationIp})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Port"}),t.jsx("p",{className:"text-white font-mono font-semibold",children:e.port})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Protocol"}),t.jsx("p",{className:"text-white font-mono font-semibold uppercase",children:e.protocol})]})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Description"}),t.jsx("p",{className:"text-white text-sm",children:e.description})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Business Justification"}),t.jsx("p",{className:"text-white text-sm",children:e.businessJustification})]})]})]}),P1={aws:"",azure:"",gcp:"",onprem:""},I1={aws:"bg-orange-500/20 text-orange-400 border-orange-500/30",azure:"bg-blue-500/20 text-blue-400 border-blue-500/30",gcp:"bg-red-500/20 text-red-400 border-red-500/30",onprem:"bg-slate-500/20 text-slate-400 border-slate-500/30"},E1={firewall:"Firewall",nsg:"Network Security Group",security_group:"Security Group",nacl:"Network ACL"},R1=({firewalls:e})=>t.jsxs(b,{children:[t.jsx($,{title:"Firewalls in Traffic Path",subtitle:`${e.length} security control${e.length!==1?"s":""} identified`}),t.jsx("div",{className:"space-y-3",children:e.map((s,a)=>t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg border border-slate-600 hover:border-cyan-500/50 transition-colors",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-cyan-500/20 rounded-full flex items-center justify-center border border-cyan-500/30",children:t.jsx("span",{className:"text-cyan-400 font-semibold text-sm",children:a+1})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"text-white font-semibold",children:s.name}),t.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium border ${I1[s.platform]}`,children:[P1[s.platform]," ",s.platform.toUpperCase()]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-400",children:"Type:"})," ",t.jsx("span",{className:"text-white",children:E1[s.type]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-400",children:"Location:"})," ",t.jsx("span",{className:"text-white",children:s.location})]}),s.zone&&t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-slate-400",children:"Zone:"})," ",t.jsx("span",{className:"text-white font-mono text-xs",children:s.zone})]}),s.managementUrl&&t.jsx("div",{className:"col-span-2",children:t.jsxs("a",{href:s.managementUrl,target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:text-cyan-300 text-xs flex items-center gap-1",children:["Open Management Console",t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})]}),a<e.length-1&&t.jsx("div",{className:"flex justify-center mt-3",children:t.jsx("svg",{className:"w-6 h-6 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})]},s.id))})]}),L1=({recommendations:e})=>{var n;const[s,a]=f.useState(((n=e[0])==null?void 0:n.firewallId)||null),r=o=>{navigator.clipboard.writeText(o)};return t.jsxs(b,{children:[t.jsx($,{title:"Rule Recommendations",subtitle:"Platform-specific firewall rules generated by AI"}),t.jsx("div",{className:"space-y-3",children:e.map(o=>{const i=s===o.firewallId;return t.jsxs("div",{className:"border border-slate-600 rounded-lg overflow-hidden",children:[t.jsxs("button",{onClick:()=>a(i?null:o.firewallId),className:"w-full p-4 bg-slate-700/30 hover:bg-slate-700/50 transition-colors flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${o.platform==="aws"?"bg-orange-500/20":o.platform==="azure"?"bg-blue-500/20":o.platform==="gcp"?"bg-red-500/20":"bg-slate-500/20"}`,children:t.jsx("span",{className:"text-lg",children:o.platform==="aws"?"":o.platform==="azure"?"":o.platform==="gcp"?"":""})}),t.jsxs("div",{className:"text-left",children:[t.jsx("h4",{className:"text-white font-semibold",children:o.firewallName}),t.jsx("p",{className:"text-sm text-slate-400",children:o.ruleType.replace(/_/g," ")})]})]}),t.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&t.jsxs("div",{className:"p-4 bg-slate-800/50 space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[t.jsx("span",{className:"text-slate-400",children:"Action:"})," ",t.jsx("span",{className:`font-semibold ${o.rule.action==="allow"?"text-emerald-400":"text-red-400"}`,children:o.rule.action.toUpperCase()})]}),t.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[t.jsx("span",{className:"text-slate-400",children:"Protocol:"})," ",t.jsx("span",{className:"text-white font-mono",children:o.rule.protocol.toUpperCase()})]}),t.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[t.jsx("span",{className:"text-slate-400",children:"Source:"})," ",t.jsx("span",{className:"text-white font-mono text-xs",children:o.rule.source})]}),t.jsxs("div",{className:"p-2 bg-slate-700/30 rounded",children:[t.jsx("span",{className:"text-slate-400",children:"Port:"})," ",t.jsx("span",{className:"text-white font-mono",children:o.rule.port})]}),t.jsxs("div",{className:"col-span-2 p-2 bg-slate-700/30 rounded",children:[t.jsx("span",{className:"text-slate-400",children:"Destination:"})," ",t.jsx("span",{className:"text-white font-mono text-xs",children:o.rule.destination})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Platform-Specific Syntax"}),t.jsxs(M,{variant:"ghost",size:"sm",onClick:()=>r(o.syntax),children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})]}),t.jsx("pre",{className:"p-3 bg-slate-900 rounded-lg border border-slate-700 overflow-x-auto",children:t.jsx("code",{className:"text-cyan-400 text-xs font-mono",children:o.syntax})})]})]})]},o.firewallId)})})]})},Uu={low:"bg-slate-500/20 text-slate-400 border-slate-500/30",medium:"bg-amber-500/20 text-amber-400 border-amber-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",critical:"bg-red-500/20 text-red-400 border-red-500/30"},O1={shadowing:"Rule Shadowing",overlap:"Rule Overlap",contradiction:"Rule Contradiction",redundancy:"Rule Redundancy"},D1={broad_rule:"Broad Rule Scope",high_risk_port:"High Risk Port",cross_environment:"Cross-Environment Access",compliance:"Compliance Concern"},M1=({conflict:e})=>t.jsx("div",{className:`p-4 rounded-lg border ${Uu[e.severity]}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"font-semibold",children:O1[e.type]}),t.jsx("span",{className:"text-xs uppercase font-bold",children:e.severity})]}),t.jsx("p",{className:"text-sm mb-3",children:e.message}),t.jsxs("div",{className:"p-3 bg-slate-900/50 rounded border border-slate-700",children:[t.jsx("p",{className:"text-xs uppercase font-semibold mb-2 opacity-70",children:"Existing Rule"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs font-mono",children:[t.jsxs("div",{children:[t.jsx("span",{className:"opacity-70",children:"Source:"})," ",e.existingRule.source]}),t.jsxs("div",{children:[t.jsx("span",{className:"opacity-70",children:"Destination:"})," ",e.existingRule.destination]}),t.jsxs("div",{children:[t.jsx("span",{className:"opacity-70",children:"Port:"})," ",e.existingRule.port]}),t.jsxs("div",{children:[t.jsx("span",{className:"opacity-70",children:"Action:"})," ",e.existingRule.action]})]})]}),t.jsxs("div",{className:"mt-3 p-2 bg-slate-900/30 rounded text-sm",children:[t.jsx("span",{className:"opacity-70",children:" Recommendation:"})," ",e.recommendation]})]})]})}),V1=({warning:e})=>t.jsx("div",{className:`p-3 rounded-lg border ${Uu[e.severity]}`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h5",{className:"font-medium text-sm",children:D1[e.type]}),t.jsx("span",{className:"text-xs uppercase font-bold",children:e.severity})]}),t.jsx("p",{className:"text-sm",children:e.message})]})]})}),G1=({conflictCheck:e})=>{const s=e.hasConflicts||e.warnings.length>0;return t.jsxs(b,{children:[t.jsx($,{title:"Conflict & Security Analysis",subtitle:"Automated conflict detection and risk assessment"}),s?t.jsxs("div",{className:"space-y-4",children:[e.conflicts.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Rule Conflicts (",e.conflicts.length,")"]}),t.jsx("div",{className:"space-y-3",children:e.conflicts.map(a=>t.jsx(M1,{conflict:a},a.id))})]}),e.warnings.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Security Warnings (",e.warnings.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.warnings.map(a=>t.jsx(V1,{warning:a},a.id))})]})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:"No Conflicts Detected"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"No rule conflicts or major security concerns found"})]})]})},H1={low:{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30",gauge:"bg-emerald-500"},medium:{bg:"bg-amber-500/20",text:"text-amber-400",border:"border-amber-500/30",gauge:"bg-amber-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/30",gauge:"bg-orange-500"},critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500/30",gauge:"bg-red-500"}},F1=({assessment:e})=>{const s=H1[e.level];return t.jsxs(b,{children:[t.jsx($,{title:"Risk Assessment",subtitle:"AI-calculated risk score based on multiple factors"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"text-center",children:t.jsxs("div",{className:"inline-flex flex-col items-center",children:[t.jsx("div",{className:`w-32 h-32 rounded-full ${s.bg} border-4 ${s.border} flex items-center justify-center mb-3`,children:t.jsxs("div",{children:[t.jsx("div",{className:`text-4xl font-bold ${s.text}`,children:e.score}),t.jsx("div",{className:"text-xs text-slate-400",children:"/ 100"})]})}),t.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-bold uppercase ${s.bg} ${s.text} border ${s.border}`,children:[e.level," Risk"]})]})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-2",children:[t.jsx("span",{children:"Low"}),t.jsx("span",{children:"Medium"}),t.jsx("span",{children:"High"}),t.jsx("span",{children:"Critical"})]}),t.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${s.gauge} transition-all duration-1000 ease-out`,style:{width:`${e.score}%`}})})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Risk Factors"]}),t.jsx("div",{className:"space-y-2",children:e.factors.map((a,r)=>{const n=a.impact==="negative",o=a.impact==="positive";return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[n&&t.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),o&&t.jsx("svg",{className:"w-5 h-5 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.impact==="neutral"&&t.jsx("svg",{className:"w-5 h-5 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium capitalize",children:a.name}),t.jsx("p",{className:"text-xs text-slate-400",children:a.description})]})]}),t.jsxs("span",{className:`text-lg font-bold min-w-[3rem] text-right ${a.weight>0?"text-red-400":a.weight<0?"text-emerald-400":"text-slate-400"}`,children:[a.weight>0?"+":"",a.weight]})]},r)})})]}),t.jsx("div",{className:`p-4 rounded-lg border ${s.bg} ${s.border}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("svg",{className:`w-6 h-6 ${s.text} flex-shrink-0 mt-0.5`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),t.jsxs("div",{children:[t.jsx("h5",{className:`font-semibold ${s.text} mb-1`,children:"Recommendation"}),t.jsx("p",{className:"text-white text-sm",children:e.recommendation})]})]})})]})]})},W1=({status:e})=>e==="approved"?t.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-full flex items-center justify-center border-2 border-emerald-500",children:t.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):e==="rejected"?t.jsx("div",{className:"w-10 h-10 bg-red-500/20 rounded-full flex items-center justify-center border-2 border-red-500",children:t.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):t.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-full flex items-center justify-center border-2 border-slate-600",children:t.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),U1=({ticket:e,onApprove:s,onReject:a,onImplement:r,onRollback:n})=>{const[o,i]=f.useState(!1),[l,c]=f.useState(null),d=e.approvalChain.every(m=>m.status==="approved"),u=e.approvalChain.some(m=>m.status==="rejected"),p=d&&(e.status==="approved"||e.status==="pending_approval"),h=e.status==="analyzed"||e.status==="pending_approval",y=e.status==="implementing",v=(e.status==="completed"||e.status==="rolled_back")&&e.rollbackAvailable,L=m=>{c(m),i(!0)},x=()=>{l==="approve"&&s&&s(),l==="reject"&&a&&a(),l==="implement"&&r&&r(),l==="rollback"&&n&&n(),i(!1),c(null)};return t.jsxs(b,{children:[t.jsx($,{title:"Approval Workflow",subtitle:e.mode==="automatic"?"Automatic Implementation Mode":"Manual Implementation Mode"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center gap-2",children:e.mode==="automatic"?t.jsxs("span",{className:"px-3 py-1 bg-cyan-500/20 text-cyan-400 border border-cyan-500/30 rounded-full text-sm font-semibold flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Auto-Implement"]}):t.jsx("span",{className:"px-3 py-1 bg-slate-500/20 text-slate-400 border border-slate-500/30 rounded-full text-sm font-semibold",children:"Manual Mode"})}),t.jsx("div",{className:"space-y-3",children:e.approvalChain.map((m,g)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(W1,{status:m.status}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h4",{className:"text-white font-semibold",children:m.name}),t.jsx("span",{className:`text-xs uppercase font-bold ${m.status==="approved"?"text-emerald-400":m.status==="rejected"?"text-red-400":"text-slate-400"}`,children:m.status==="pending"?"Pending":m.status})]}),t.jsx("p",{className:"text-sm text-slate-400",children:m.approver}),m.timestamp&&t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:new Date(m.timestamp).toLocaleString()}),m.comments&&t.jsxs("div",{className:"mt-2 p-2 bg-slate-700/30 rounded text-sm text-slate-300",children:[" ",m.comments]})]})]}),g<e.approvalChain.length-1&&t.jsx("div",{className:"ml-5 h-6 border-l-2 border-slate-700"})]},m.id))}),y&&e.implementationStatus&&t.jsxs("div",{className:"p-4 bg-cyan-500/10 border border-cyan-500/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsxs("svg",{className:"w-5 h-5 text-cyan-400 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-cyan-400 font-semibold",children:e.implementationStatus.step}),t.jsx("p",{className:"text-sm text-cyan-300/70",children:e.implementationStatus.message})]})]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-cyan-500 transition-all duration-500",style:{width:`${e.implementationStatus.progress}%`}})})]}),!o&&t.jsxs("div",{className:"flex gap-3",children:[h&&!u&&t.jsxs(t.Fragment,{children:[t.jsxs(M,{variant:"primary",className:"flex-1",onClick:()=>L("approve"),children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve"]}),t.jsx(M,{variant:"ghost",onClick:()=>L("reject"),children:"Reject"})]}),p&&e.mode==="automatic"&&t.jsxs(M,{variant:"primary",className:"flex-1",onClick:()=>L("implement"),children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Auto-Implement Rules"]}),v&&t.jsxs(M,{variant:"ghost",className:"border-red-500/30 text-red-400 hover:bg-red-500/10",onClick:()=>L("rollback"),children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Rollback Changes"]})]}),o&&t.jsxs("div",{className:"p-4 bg-slate-700 border border-slate-600 rounded-lg space-y-3",children:[t.jsxs("p",{className:"text-white font-semibold",children:[l==="approve"&&"Confirm Approval",l==="reject"&&"Confirm Rejection",l==="implement"&&"Confirm Auto-Implementation",l==="rollback"&&"Confirm Rollback"]}),t.jsxs("p",{className:"text-sm text-slate-400",children:[l==="approve"&&"This will approve the change request and move it to the next approval stage.",l==="reject"&&"This will reject the change request. The ticket will be closed.",l==="implement"&&"This will automatically implement all firewall rules. The process cannot be stopped once started.",l==="rollback"&&"This will remove all implemented rules in reverse order. This action cannot be undone."]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(M,{variant:"primary",onClick:x,className:"flex-1",children:"Confirm"}),t.jsx(M,{variant:"ghost",onClick:()=>{i(!1),c(null)},children:"Cancel"})]})]}),e.rollbackPlan&&!y&&t.jsx("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-slate-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-slate-300 mb-1",children:"Rollback Plan"}),t.jsx("p",{className:"text-sm text-slate-400",children:e.rollbackPlan})]})]})})]})]})},z1=async e=>(await new Promise(a=>setTimeout(a,1500)),{sourceIp:"10.100.5.0/24",destinationIp:"172.16.20.50",port:"443",protocol:"tcp",environment:"production",description:"Allow HTTPS traffic from application servers to database endpoint",businessJustification:"Required for new microservice deployment to access production database"}),$1=async(e,s,a)=>{await new Promise(n=>setTimeout(n,1e3));const r=[];return a==="production"?r.push({id:"fw-prod-edge-01",name:"Production Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-prod-edge-01.company.com"},{id:"sg-0a1b2c3d4e5f",name:"App-Tier Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-12345678",managementUrl:"https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#SecurityGroups"},{id:"nsg-db-tier-prod",name:"Database NSG - Production",type:"nsg",platform:"azure",location:"eastus",zone:"vnet-prod-001",managementUrl:"https://portal.azure.com/#resource/subscriptions/.../networkSecurityGroups/nsg-db-tier-prod"}):a==="uat"?r.push({id:"fw-uat-edge-01",name:"UAT Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-uat-edge-01.company.com"},{id:"sg-uat-9z8y7x6w5v",name:"UAT Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-uat-001"}):r.push({id:"fw-dev-edge-01",name:"Development Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-WEST-1",managementUrl:"https://fw-dev-edge-01.company.com"}),r},B1=async(e,s)=>(await new Promise(r=>setTimeout(r,800)),s.map(r=>{const n={source:e.sourceIp,destination:e.destinationIp,port:e.port,protocol:e.protocol,action:"allow"};let o="";switch(r.platform){case"aws":o=`{
  "IpProtocol": "${e.protocol}",
  "FromPort": ${e.port},
  "ToPort": ${e.port},
  "IpRanges": [{ "CidrIp": "${e.sourceIp}" }],
  "Description": "${e.description}"
}`;break;case"azure":o=`{
  "name": "Allow-${e.port}-Inbound",
  "protocol": "${e.protocol.toUpperCase()}",
  "sourceAddressPrefix": "${e.sourceIp}",
  "destinationAddressPrefix": "${e.destinationIp}",
  "destinationPortRange": "${e.port}",
  "access": "Allow",
  "priority": 100,
  "direction": "Inbound"
}`;break;case"gcp":o=`{
  "name": "allow-${e.protocol}-${e.port}",
  "network": "default",
  "sourceRanges": ["${e.sourceIp}"],
  "allowed": [{
    "IPProtocol": "${e.protocol}",
    "ports": ["${e.port}"]
  }]
}`;break;case"onprem":o=`access-list ${r.id} extended permit ${e.protocol} ${e.sourceIp} ${e.destinationIp} eq ${e.port}`;break}return{firewallId:r.id,firewallName:r.name,ruleType:r.type,rule:n,syntax:o,platform:r.platform}})),Z1=async(e,s)=>{await new Promise(o=>setTimeout(o,1200));const a=[],r=[];return e.sourceIp.includes("10.100")&&a.push({id:"conflict-001",type:"shadowing",severity:"medium",existingRule:{id:"rule-12345",source:"10.100.0.0/16",destination:"any",port:"any",action:"deny"},message:"Existing deny rule may shadow this allow rule",recommendation:"Review rule priority or modify existing rule scope"}),["22","23","3389","445","139"].includes(e.port)&&r.push({id:"warn-001",type:"high_risk_port",severity:"high",message:`Port ${e.port} is commonly targeted by attackers`}),(e.sourceIp.includes("/8")||e.sourceIp.includes("/16"))&&r.push({id:"warn-002",type:"broad_rule",severity:"medium",message:"Source IP range is very broad - consider narrowing the scope"}),s==="production"&&e.sourceIp.includes("10.200")&&r.push({id:"warn-003",type:"cross_environment",severity:"high",message:"Production access from non-production network detected"}),{hasConflicts:a.length>0,conflicts:a,warnings:r}},q1=(e,s,a)=>{let r=20;const n=[];a==="production"?(r+=15,n.push({name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"})):a==="uat"?(r+=8,n.push({name:"UAT Environment",impact:"negative",weight:8,description:"UAT environment changes require careful testing"})):n.push({name:"Development Environment",impact:"positive",weight:-5,description:"Development environment has lower risk"}),s.conflicts.forEach(c=>{const d=c.severity==="critical"?25:c.severity==="high"?18:c.severity==="medium"?12:6;r+=d,n.push({name:`Rule ${c.type}`,impact:"negative",weight:d,description:c.message})}),s.warnings.forEach(c=>{const d=c.severity==="high"?12:c.severity==="medium"?7:3;r+=d,n.push({name:c.type.replace(/_/g," "),impact:"negative",weight:d,description:c.message})}),["80","443","22","3389"].includes(e.port)&&n.push({name:"Well-known port",impact:"neutral",weight:0,description:"Standard service port"});let i,l;return r>=70?(i="critical",l="Critical risk - Requires security team review and change advisory board approval"):r>=50?(i="high",l="High risk - Requires senior approval and detailed testing plan"):r>=30?(i="medium",l="Medium risk - Standard approval process with peer review"):(i="low",l="Low risk - Can proceed with standard L1 approval"),{score:Math.min(r,100),level:i,factors:n,recommendation:l}},K1=async(e,s)=>{const a=await z1(),r=await $1(a.sourceIp,a.destinationIp,a.environment),n=await B1(a,r),o=await Z1(a,a.environment),i=q1(a,o,a.environment),l=[{id:"step-1",name:"L1 Engineer Review",approver:"L1 Operations Team",status:"pending"}];return(i.level==="high"||i.level==="critical")&&l.push({id:"step-2",name:"Security Team Review",approver:"Security Operations",status:"pending"}),a.environment==="production"&&l.push({id:"step-3",name:"Change Advisory Board",approver:"CAB Team",status:"pending"}),{id:`L1-${Date.now()}`,serviceNowId:e,status:"analyzed",mode:s,parsedData:a,firewallsInPath:r,recommendations:n,riskAssessment:i,conflictCheck:o,approvalChain:l,rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order of implementation",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"system"}},Q1=async(e,s)=>{await new Promise(a=>setTimeout(a,2e3))},Y1=async e=>{await new Promise(s=>setTimeout(s,1500))},X1=[{id:"L1-1705847230001",serviceNowId:"CHG0012345",status:"completed",mode:"automatic",parsedData:{sourceIp:"10.100.5.0/24",destinationIp:"172.16.20.50",port:"443",protocol:"tcp",environment:"production",description:"Allow HTTPS traffic from application servers to database endpoint",businessJustification:"Required for new microservice deployment to access production database"},firewallsInPath:[{id:"fw-prod-edge-01",name:"Production Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-prod-edge-01.company.com"},{id:"sg-0a1b2c3d4e5f",name:"App-Tier Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-12345678"}],recommendations:[{firewallId:"fw-prod-edge-01",firewallName:"Production Edge Firewall",ruleType:"firewall",rule:{source:"10.100.5.0/24",destination:"172.16.20.50",port:"443",protocol:"tcp",action:"allow"},syntax:"access-list fw-prod-edge-01 extended permit tcp 10.100.5.0/24 172.16.20.50 eq 443",platform:"onprem"},{firewallId:"sg-0a1b2c3d4e5f",firewallName:"App-Tier Security Group",ruleType:"security_group",rule:{source:"10.100.5.0/24",destination:"172.16.20.50",port:"443",protocol:"tcp",action:"allow"},syntax:`{
  "IpProtocol": "tcp",
  "FromPort": 443,
  "ToPort": 443,
  "IpRanges": [{ "CidrIp": "10.100.5.0/24" }]
}`,platform:"aws"}],riskAssessment:{score:35,level:"medium",factors:[{name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"},{name:"Well-known port",impact:"neutral",weight:0,description:"Standard HTTPS port"}],recommendation:"Medium risk - Standard approval process with peer review"},conflictCheck:{hasConflicts:!1,conflicts:[],warnings:[]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"John Smith",status:"approved",timestamp:"2026-01-18T14:30:00Z",comments:"Verified rule details and business justification"},{id:"step-2",name:"Change Advisory Board",approver:"CAB Team",status:"approved",timestamp:"2026-01-18T15:45:00Z",comments:"Approved for implementation during next change window"}],rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-18T14:00:00Z",updatedAt:"2026-01-18T16:30:00Z",completedAt:"2026-01-18T16:30:00Z",createdBy:"system",approvedBy:"CAB Team"},{id:"L1-1705847230002",serviceNowId:"CHG0012346",status:"pending_approval",mode:"automatic",parsedData:{sourceIp:"192.168.10.0/24",destinationIp:"10.50.100.25",port:"22",protocol:"tcp",environment:"production",description:"SSH access from jump server to production web servers",businessJustification:"Required for emergency maintenance access"},firewallsInPath:[{id:"fw-prod-dmz-01",name:"Production DMZ Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-prod-dmz-01.company.com"},{id:"nsg-web-tier-prod",name:"Web Tier NSG - Production",type:"nsg",platform:"azure",location:"eastus",zone:"vnet-prod-001"}],recommendations:[{firewallId:"fw-prod-dmz-01",firewallName:"Production DMZ Firewall",ruleType:"firewall",rule:{source:"192.168.10.0/24",destination:"10.50.100.25",port:"22",protocol:"tcp",action:"allow"},syntax:"access-list fw-prod-dmz-01 extended permit tcp 192.168.10.0/24 10.50.100.25 eq 22",platform:"onprem"},{firewallId:"nsg-web-tier-prod",firewallName:"Web Tier NSG - Production",ruleType:"nsg",rule:{source:"192.168.10.0/24",destination:"10.50.100.25",port:"22",protocol:"tcp",action:"allow",priority:100},syntax:`{
  "name": "Allow-22-Inbound",
  "protocol": "TCP",
  "sourceAddressPrefix": "192.168.10.0/24",
  "destinationPortRange": "22",
  "access": "Allow"
}`,platform:"azure"}],riskAssessment:{score:58,level:"high",factors:[{name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"},{name:"high risk port",impact:"negative",weight:12,description:"Port 22 is commonly targeted by attackers"}],recommendation:"High risk - Requires senior approval and detailed testing plan"},conflictCheck:{hasConflicts:!1,conflicts:[],warnings:[{id:"warn-001",type:"high_risk_port",severity:"high",message:"Port 22 is commonly targeted by attackers"}]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"L1 Operations Team",status:"pending"},{id:"step-2",name:"Security Team Review",approver:"Security Operations",status:"pending"},{id:"step-3",name:"Change Advisory Board",approver:"CAB Team",status:"pending"}],rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-19T09:15:00Z",updatedAt:"2026-01-19T09:15:00Z",createdBy:"system"},{id:"L1-1705847230003",serviceNowId:"CHG0012347",status:"analyzed",mode:"manual",parsedData:{sourceIp:"10.200.15.0/24",destinationIp:"172.31.50.100",port:"3306",protocol:"tcp",environment:"uat",description:"MySQL access from UAT application to database",businessJustification:"Testing new database connection for upcoming release"},firewallsInPath:[{id:"fw-uat-edge-01",name:"UAT Edge Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1",managementUrl:"https://fw-uat-edge-01.company.com"},{id:"sg-uat-db-9z8y7x6w",name:"UAT Database Security Group",type:"security_group",platform:"aws",location:"us-east-1",zone:"vpc-uat-001"}],recommendations:[{firewallId:"fw-uat-edge-01",firewallName:"UAT Edge Firewall",ruleType:"firewall",rule:{source:"10.200.15.0/24",destination:"172.31.50.100",port:"3306",protocol:"tcp",action:"allow"},syntax:"access-list fw-uat-edge-01 extended permit tcp 10.200.15.0/24 172.31.50.100 eq 3306",platform:"onprem"},{firewallId:"sg-uat-db-9z8y7x6w",firewallName:"UAT Database Security Group",ruleType:"security_group",rule:{source:"10.200.15.0/24",destination:"172.31.50.100",port:"3306",protocol:"tcp",action:"allow"},syntax:`{
  "IpProtocol": "tcp",
  "FromPort": 3306,
  "ToPort": 3306,
  "IpRanges": [{ "CidrIp": "10.200.15.0/24" }]
}`,platform:"aws"}],riskAssessment:{score:28,level:"low",factors:[{name:"UAT Environment",impact:"negative",weight:8,description:"UAT environment changes require careful testing"}],recommendation:"Low risk - Can proceed with standard L1 approval"},conflictCheck:{hasConflicts:!1,conflicts:[],warnings:[]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"L1 Operations Team",status:"pending"}],rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-19T10:30:00Z",updatedAt:"2026-01-19T10:30:00Z",createdBy:"system"},{id:"L1-1705847230004",serviceNowId:"CHG0012348",status:"implementing",mode:"automatic",parsedData:{sourceIp:"10.100.0.0/16",destinationIp:"172.16.0.0/16",port:"80",protocol:"tcp",environment:"production",description:"HTTP traffic from internal network to application tier",businessJustification:"Legacy application access requirement"},firewallsInPath:[{id:"fw-prod-core-01",name:"Production Core Firewall",type:"firewall",platform:"onprem",location:"DC-US-EAST-1"}],recommendations:[{firewallId:"fw-prod-core-01",firewallName:"Production Core Firewall",ruleType:"firewall",rule:{source:"10.100.0.0/16",destination:"172.16.0.0/16",port:"80",protocol:"tcp",action:"allow"},syntax:"access-list fw-prod-core-01 extended permit tcp 10.100.0.0/16 172.16.0.0/16 eq 80",platform:"onprem"}],riskAssessment:{score:52,level:"high",factors:[{name:"Production Environment",impact:"negative",weight:15,description:"Changes to production carry higher risk"},{name:"broad rule",impact:"negative",weight:7,description:"Source IP range is very broad - consider narrowing the scope"},{name:"Rule shadowing",impact:"negative",weight:12,description:"Existing deny rule may shadow this allow rule"}],recommendation:"High risk - Requires senior approval and detailed testing plan"},conflictCheck:{hasConflicts:!0,conflicts:[{id:"conflict-001",type:"shadowing",severity:"medium",existingRule:{id:"rule-12345",source:"10.100.0.0/16",destination:"any",port:"any",action:"deny"},message:"Existing deny rule may shadow this allow rule",recommendation:"Review rule priority or modify existing rule scope"}],warnings:[{id:"warn-002",type:"broad_rule",severity:"medium",message:"Source IP range is very broad - consider narrowing the scope"}]},approvalChain:[{id:"step-1",name:"L1 Engineer Review",approver:"Sarah Johnson",status:"approved",timestamp:"2026-01-19T11:00:00Z"},{id:"step-2",name:"Security Team Review",approver:"Mike Chen",status:"approved",timestamp:"2026-01-19T11:30:00Z",comments:"Approved with recommendation to narrow scope in next iteration"}],implementationStatus:{step:"Applying rule to Production Core Firewall",progress:75,message:"Verifying rule application..."},rollbackAvailable:!0,rollbackPlan:"Automated rollback available - rules will be removed in reverse order",createdAt:"2026-01-19T10:45:00Z",updatedAt:"2026-01-19T11:35:00Z",createdBy:"system",approvedBy:"Mike Chen"}],J1=()=>{const[e,s]=f.useState(""),[a,r]=f.useState("automatic"),[n,o]=f.useState(!1),[i,l]=f.useState(null),[c,d]=f.useState(null),[u,p]=f.useState(!1),h=async g=>{g.preventDefault(),d(null),o(!0);try{const w=await K1(e,a);l(w)}catch{d("Failed to process ServiceNow ticket. Please check the ticket ID and try again.")}finally{o(!1)}},y=async()=>{if(!i)return;const g={...i,status:"approved",approvalChain:i.approvalChain.map((w,N)=>N===0?{...w,status:"approved",timestamp:new Date().toISOString(),approver:"Current User",comments:"Reviewed and approved"}:w)};l(g)},j=()=>{if(!i)return;const g={...i,status:"rejected",approvalChain:i.approvalChain.map((w,N)=>N===0?{...w,status:"rejected",timestamp:new Date().toISOString(),approver:"Current User",comments:"Rejected - does not meet security requirements"}:w)};l(g)},v=async()=>{if(!i)return;l({...i,status:"implementing",implementationStatus:{step:"Initializing implementation",progress:0,message:"Preparing to apply firewall rules..."}});const g=[{step:"Applying rule to Production Edge Firewall",progress:25,message:"Connecting to firewall..."},{step:"Applying rule to Production Edge Firewall",progress:50,message:"Rule applied successfully"},{step:"Applying rule to App-Tier Security Group",progress:75,message:"Updating AWS Security Group..."},{step:"Finalizing implementation",progress:95,message:"Verifying all changes..."}];for(const w of g)await new Promise(N=>setTimeout(N,1500)),l(N=>N?{...N,implementationStatus:w}:null);await new Promise(w=>setTimeout(w,1e3)),await Q1(i.id),l(w=>w?{...w,status:"completed",completedAt:new Date().toISOString(),implementationStatus:void 0}:null)},L=async()=>{i&&(l({...i,status:"implementing",implementationStatus:{step:"Rolling back changes",progress:50,message:"Removing firewall rules in reverse order..."}}),await Y1(i.id),await new Promise(g=>setTimeout(g,2e3)),l({...i,status:"rolled_back",implementationStatus:void 0,updatedAt:new Date().toISOString()}))},x=()=>{l(null),s(""),d(null)},m=g=>{l(g),s(g.serviceNowId),p(!1)};return t.jsxs(J,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"L1 Firewall Whitelisting"}),t.jsx("p",{className:"text-slate-400",children:"AI-powered ticket processing with automatic firewall rule implementation"})]}),!i&&t.jsx("div",{className:"max-w-2xl mx-auto",children:t.jsxs(b,{children:[t.jsx($,{title:"Process ServiceNow Ticket",subtitle:"Enter a ServiceNow ticket ID to begin AI analysis"}),t.jsxs("form",{onSubmit:h,className:"space-y-4",children:[c&&t.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg",children:t.jsx("p",{className:"text-red-400",children:c})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"ServiceNow Ticket ID"}),t.jsx("input",{type:"text",value:e,onChange:g=>s(g.target.value),placeholder:"e.g., CHG0012345",required:!0,className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500 font-mono"}),t.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"The AI will automatically extract source IP, destination IP, port, protocol, and environment"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Implementation Mode"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{type:"button",onClick:()=>r("automatic"),className:`p-4 rounded-lg border-2 transition-all ${a==="automatic"?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:`w-5 h-5 ${a==="automatic"?"text-cyan-400":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),t.jsx("span",{className:`font-semibold ${a==="automatic"?"text-cyan-400":"text-slate-400"}`,children:"Automatic"})]}),t.jsx("p",{className:"text-xs text-slate-400 text-left",children:"Rules implemented automatically after approval"})]}),t.jsxs("button",{type:"button",onClick:()=>r("manual"),className:`p-4 rounded-lg border-2 transition-all ${a==="manual"?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:`w-5 h-5 ${a==="manual"?"text-cyan-400":"text-slate-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),t.jsx("span",{className:`font-semibold ${a==="manual"?"text-cyan-400":"text-slate-400"}`,children:"Manual"})]}),t.jsx("p",{className:"text-xs text-slate-400 text-left",children:"Review recommendations, implement manually"})]})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(M,{type:"submit",variant:"primary",isLoading:n,className:"flex-1",children:n?"Processing Ticket...":"Process Ticket"}),t.jsx(M,{type:"button",variant:"ghost",onClick:()=>p(!u),children:u?"Hide History":"View History"})]})]}),u&&t.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700",children:[t.jsx("h4",{className:"text-white font-semibold mb-3",children:"Recent Tickets"}),t.jsx("div",{className:"space-y-2",children:X1.slice(0,4).map(g=>t.jsx("button",{onClick:()=>m(g),className:"w-full p-3 bg-slate-700/30 hover:bg-slate-700/50 rounded-lg border border-slate-600 hover:border-cyan-500/50 transition-all text-left",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium font-mono text-sm",children:g.serviceNowId}),t.jsx("p",{className:"text-xs text-slate-400 mt-1",children:g.parsedData.description})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${g.status==="completed"?"bg-emerald-500/20 text-emerald-400":g.status==="implementing"?"bg-cyan-500/20 text-cyan-400":g.status==="pending_approval"?"bg-amber-500/20 text-amber-400":"bg-slate-500/20 text-slate-400"}`,children:g.status.replace(/_/g," ")})]})},g.id))})]})]})}),i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(b,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-white mb-1",children:["Ticket: ",t.jsx("span",{className:"text-cyan-400 font-mono",children:i.serviceNowId})]}),t.jsxs("p",{className:"text-slate-400",children:["Created ",new Date(i.createdAt).toLocaleString()]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-bold uppercase border ${i.status==="completed"?"bg-emerald-500/20 text-emerald-400 border-emerald-500/30":i.status==="implementing"?"bg-cyan-500/20 text-cyan-400 border-cyan-500/30":i.status==="approved"||i.status==="pending_approval"?"bg-amber-500/20 text-amber-400 border-amber-500/30":i.status==="rejected"?"bg-red-500/20 text-red-400 border-red-500/30":i.status==="rolled_back"?"bg-slate-500/20 text-slate-400 border-slate-500/30":"bg-blue-500/20 text-blue-400 border-blue-500/30"}`,children:i.status.replace(/_/g," ")}),t.jsx(M,{variant:"ghost",onClick:x,children:"New Ticket"})]})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[t.jsxs("div",{className:"col-span-2 space-y-6",children:[t.jsx(T1,{parsedData:i.parsedData}),t.jsx(R1,{firewalls:i.firewallsInPath}),t.jsx(L1,{recommendations:i.recommendations}),t.jsx(G1,{conflictCheck:i.conflictCheck})]}),t.jsxs("div",{className:"col-span-1 space-y-6",children:[t.jsx(F1,{assessment:i.riskAssessment}),t.jsx(U1,{ticket:i,onApprove:y,onReject:j,onImplement:v,onRollback:L})]})]})]})]})},ef={name:"",description:"",sourceIp:"",destinationIp:"",port:"",protocol:"tcp",action:"allow",direction:"inbound"},zi={aws:{id:"aws",name:"AWS Security Group",category:"cloud",icon:"aws",description:"Amazon Web Services Security Groups",syntaxExample:"aws ec2 authorize-security-group-ingress ..."},azure:{id:"azure",name:"Azure NSG",category:"cloud",icon:"azure",description:"Azure Network Security Groups",syntaxExample:"az network nsg rule create ..."},gcp:{id:"gcp",name:"GCP Firewall",category:"cloud",icon:"gcp",description:"Google Cloud Platform Firewall Rules",syntaxExample:"gcloud compute firewall-rules create ..."},palo_alto:{id:"palo_alto",name:"Palo Alto",category:"firewall",icon:"firewall",description:"Palo Alto Networks PAN-OS",syntaxExample:"set rulebase security rules ..."},cisco_asa:{id:"cisco_asa",name:"Cisco ASA",category:"firewall",icon:"firewall",description:"Cisco Adaptive Security Appliance",syntaxExample:"access-list outside_access_in extended ..."},fortinet:{id:"fortinet",name:"Fortinet FortiGate",category:"firewall",icon:"firewall",description:"Fortinet FortiGate Firewall",syntaxExample:"config firewall policy ..."},iptables:{id:"iptables",name:"Linux iptables",category:"linux",icon:"linux",description:"Linux iptables/nftables",syntaxExample:"iptables -A INPUT -p tcp ..."}},tf=["aws","azure","gcp","palo_alto","cisco_asa","fortinet","iptables"],sf=()=>{const[e,s]=f.useState(ef),[a,r]=f.useState(["aws","azure","gcp"]),[n,o]=f.useState([]),[i,l]=f.useState([]),[c,d]=f.useState(!1),[u,p]=f.useState(!0),[h,y]=f.useState(null);f.useEffect(()=>{(async()=>{try{const C=await oc.getTemplates();l(C)}catch(C){y(C instanceof Error?C.message:"Failed to load templates")}finally{p(!1)}})()},[]);const j=f.useCallback(k=>{s(C=>({...C,...k}))},[]),v=f.useCallback(k=>{r(C=>C.includes(k)?C.filter(O=>O!==k):[...C,k])},[]),L=f.useCallback(()=>{r(tf)},[]),x=f.useCallback(()=>{r([])},[]),m=f.useCallback(async()=>{if(a.length===0){y("Please select at least one platform");return}d(!0),y(null);try{const k=await oc.generateRules(e,a);o(k)}catch(k){y(k instanceof Error?k.message:"Failed to generate rules")}finally{d(!1)}},[e,a]),g=f.useCallback(k=>{s(k.input),r(k.platforms),o([])},[]),w=f.useCallback(()=>{o([])},[]),N=f.useCallback(()=>{y(null)},[]);return{input:e,selectedPlatforms:a,generatedRules:n,templates:i,isGenerating:c,isLoadingTemplates:u,error:h,setInput:s,updateInput:j,togglePlatform:v,selectAllPlatforms:L,clearPlatforms:x,generateRules:m,applyTemplate:g,clearOutput:w,clearError:N}},fc={web:{bg:"bg-blue-100",text:"text-blue-700"},database:{bg:"bg-purple-100",text:"text-purple-700"},application:{bg:"bg-green-100",text:"text-green-700"},management:{bg:"bg-amber-100",text:"text-amber-700"},security:{bg:"bg-red-100",text:"text-red-700"},custom:{bg:"bg-slate-100",text:"text-slate-700"}},af=()=>{const{input:e,selectedPlatforms:s,generatedRules:a,templates:r,isGenerating:n,error:o,updateInput:i,togglePlatform:l,selectAllPlatforms:c,clearPlatforms:d,generateRules:u,applyTemplate:p,clearOutput:h,clearError:y}=sf(),[j,v]=f.useState("input"),[L,x]=f.useState(null),m=async g=>{try{await navigator.clipboard.writeText(g.syntax),x(g.platform),setTimeout(()=>x(null),2e3)}catch{}};return t.jsx(J,{children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>v("input"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${j==="input"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Custom Rule"}),t.jsx("button",{onClick:()=>v("templates"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${j==="templates"?"bg-cyan-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Templates"})]}),o&&t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-red-700",children:o})]}),t.jsx("button",{onClick:y,className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j==="input"?t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Rule Configuration"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Rule Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:e.name,onChange:g=>i({name:g.target.value}),placeholder:"e.g., Allow-HTTPS-Inbound",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),t.jsx("input",{type:"text",value:e.description,onChange:g=>i({description:g.target.value}),placeholder:"Brief description of the rule",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Source IP/CIDR"}),t.jsx("input",{type:"text",value:e.sourceIp,onChange:g=>i({sourceIp:g.target.value}),placeholder:"10.0.0.0/8 or * for any",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Destination IP/CIDR"}),t.jsx("input",{type:"text",value:e.destinationIp,onChange:g=>i({destinationIp:g.target.value}),placeholder:"192.168.1.0/24 or * for any",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Port"}),t.jsx("input",{type:"text",value:e.port,onChange:g=>i({port:g.target.value}),placeholder:"443 or 80-443",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Protocol"}),t.jsxs("select",{value:e.protocol,onChange:g=>i({protocol:g.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[t.jsx("option",{value:"tcp",children:"TCP"}),t.jsx("option",{value:"udp",children:"UDP"}),t.jsx("option",{value:"icmp",children:"ICMP"}),t.jsx("option",{value:"any",children:"Any"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Action"}),t.jsxs("select",{value:e.action,onChange:g=>i({action:g.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[t.jsx("option",{value:"allow",children:"Allow"}),t.jsx("option",{value:"deny",children:"Deny"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Direction"}),t.jsxs("select",{value:e.direction,onChange:g=>i({direction:g.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[t.jsx("option",{value:"inbound",children:"Inbound"}),t.jsx("option",{value:"outbound",children:"Outbound"}),t.jsx("option",{value:"both",children:"Both"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Priority (optional)"}),t.jsx("input",{type:"number",value:e.priority||"",onChange:g=>i({priority:g.target.value?parseInt(g.target.value):void 0}),placeholder:"100",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]})]}):t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Rule Templates"}),t.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:r.map(g=>t.jsx(rf,{template:g,onApply:()=>{p(g),v("input")}},g.id))})]}),t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Target Platforms"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:c,className:"text-sm text-cyan-600 hover:text-cyan-700",children:"Select All"}),t.jsx("span",{className:"text-slate-300",children:"|"}),t.jsx("button",{onClick:d,className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear"})]})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.values(zi).map(g=>t.jsx(nf,{platform:g,isSelected:s.includes(g.id),onToggle:()=>l(g.id)},g.id))})]}),t.jsx("button",{onClick:u,disabled:n||s.length===0,className:"w-full bg-cyan-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:n?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Generate Rules (",s.length," platforms)"]})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Generated Rules"}),a.length>0&&t.jsx("button",{onClick:h,className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear Output"})]}),a.length===0?t.jsx(b,{className:"bg-slate-50 border-2 border-dashed border-slate-200",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),t.jsx("p",{className:"text-slate-500",children:"Configure a rule and select platforms to generate firewall rules"})]})}):t.jsx("div",{className:"space-y-4 max-h-[calc(100vh-250px)] overflow-y-auto",children:a.map(g=>t.jsx(of,{rule:g,onCopy:()=>m(g),isCopied:L===g.platform},g.platform))})]})]})})},rf=({template:e,onApply:s})=>{const a=fc[e.category]||fc.custom;return t.jsx("div",{className:"border border-slate-200 rounded-lg p-3 hover:border-cyan-300 hover:bg-cyan-50/30 transition-colors",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"font-medium text-slate-800",children:e.name}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.bg} ${a.text}`,children:e.category})]}),t.jsx("p",{className:"text-sm text-slate-500 mb-2",children:e.description}),t.jsxs("div",{className:"flex gap-1",children:[e.platforms.slice(0,4).map(r=>{var n;return t.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-1.5 py-0.5 rounded",children:((n=zi[r])==null?void 0:n.name.split(" ")[0])||r},r)}),e.platforms.length>4&&t.jsxs("span",{className:"text-xs text-slate-400",children:["+",e.platforms.length-4]})]})]}),t.jsx("button",{onClick:s,className:"text-cyan-600 hover:text-cyan-700 hover:bg-cyan-100 p-2 rounded-lg transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},nf=({platform:e,isSelected:s,onToggle:a})=>{const r={cloud:"border-blue-200 bg-blue-50",firewall:"border-orange-200 bg-orange-50",linux:"border-slate-200 bg-slate-50"};return t.jsx("button",{onClick:a,className:`p-3 rounded-lg border-2 text-left transition-all ${s?"border-cyan-500 bg-cyan-50 ring-2 ring-cyan-200":r[e.category]||"border-slate-200 bg-white"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center ${s?"border-cyan-500 bg-cyan-500":"border-slate-300"}`,children:s&&t.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:`text-sm font-medium ${s?"text-cyan-700":"text-slate-700"}`,children:e.name})]})})},of=({rule:e,onCopy:s,isCopied:a})=>{const r=zi[e.platform];return t.jsxs(b,{className:"bg-white shadow-lg overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`w-8 h-8 rounded flex items-center justify-center text-white ${r.category==="cloud"?"bg-blue-500":r.category==="firewall"?"bg-orange-500":"bg-slate-500"}`,children:r.name.charAt(0)}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-slate-800",children:r.name}),t.jsx("p",{className:"text-xs text-slate-500",children:r.description})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[e.isValid?t.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:"Valid"}):t.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded",children:"Invalid"}),t.jsx("button",{onClick:s,disabled:!e.isValid,className:"p-2 text-slate-500 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors disabled:opacity-50",title:"Copy to clipboard",children:a?t.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e.warnings&&e.warnings.length>0&&t.jsx("div",{className:"mb-3",children:e.warnings.map((n,o)=>t.jsxs("div",{className:"flex items-start gap-2 text-amber-700 bg-amber-50 p-2 rounded text-sm mb-1",children:[t.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsx("span",{children:n})]},o))}),e.validationErrors&&e.validationErrors.length>0&&t.jsx("div",{className:"mb-3",children:e.validationErrors.map((n,o)=>t.jsxs("div",{className:"flex items-start gap-2 text-red-700 bg-red-50 p-2 rounded text-sm mb-1",children:[t.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:n})]},o))}),e.syntax&&t.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-sm font-mono whitespace-pre-wrap",children:e.syntax})]})},lf=()=>{const[e,s]=f.useState("aws"),[a,r]=f.useState(""),[n,o]=f.useState(null),[i,l]=f.useState([]),[c,d]=f.useState([]),[u,p]=f.useState(!1),[h,y]=f.useState(!0),[j,v]=f.useState(null);f.useEffect(()=>{(async()=>{try{const k=await us.getValidationHistory();d(k)}catch(k){v(k instanceof Error?k.message:"Failed to load history")}finally{y(!1)}})()},[]);const L=f.useCallback(async()=>{if(!a.trim()){v("Please enter rule content to validate");return}p(!0),v(null);try{const[N,k]=await Promise.all([us.validateRules(e,a),us.runSecurityAnalysis(a)]);o(N),l(k);const C=await us.getValidationHistory();d(C)}catch(N){v(N instanceof Error?N.message:"Validation failed")}finally{p(!1)}},[e,a]),x=f.useCallback(async()=>{if(!a.trim()){v("Please enter rule content to analyze");return}p(!0),v(null);try{const N=await us.runSecurityAnalysis(a);l(N)}catch(N){v(N instanceof Error?N.message:"Security analysis failed")}finally{p(!1)}},[a]),m=f.useCallback(()=>{o(null),l([])},[]),g=f.useCallback(async()=>{try{await us.clearHistory(),d([])}catch(N){v(N instanceof Error?N.message:"Failed to clear history")}},[]),w=f.useCallback(()=>{v(null)},[]);return{platform:e,content:a,result:n,securityChecks:i,history:c,isValidating:u,isLoadingHistory:h,error:j,setPlatform:s,setContent:r,validate:L,runSecurityAnalysis:x,clearResult:m,clearHistory:g,clearError:w}},vc={aws:`# AWS Security Group Rules (CLI format)
aws ec2 authorize-security-group-ingress \\
  --group-id sg-12345678 \\
  --protocol tcp \\
  --port 443 \\
  --cidr 10.0.0.0/8

aws ec2 authorize-security-group-ingress \\
  --group-id sg-12345678 \\
  --protocol tcp \\
  --port 22 \\
  --cidr 10.0.0.0/8`,azure:`# Azure NSG Rules (CLI format)
az network nsg rule create \\
  --resource-group myRG \\
  --nsg-name myNSG \\
  --name Allow-HTTPS \\
  --priority 100 \\
  --direction Inbound \\
  --access Allow \\
  --protocol Tcp \\
  --source-address-prefixes 10.0.0.0/8 \\
  --destination-port-ranges 443`,gcp:`# GCP Firewall Rules (gcloud format)
gcloud compute firewall-rules create allow-https \\
  --network=my-vpc \\
  --direction=INGRESS \\
  --action=ALLOW \\
  --rules=tcp:443 \\
  --source-ranges=10.0.0.0/8`,palo_alto:`# Palo Alto PAN-OS Rules
set rulebase security rules "Allow-HTTPS" from untrust to trust
set rulebase security rules "Allow-HTTPS" source any
set rulebase security rules "Allow-HTTPS" destination 10.0.0.0/8
set rulebase security rules "Allow-HTTPS" application ssl
set rulebase security rules "Allow-HTTPS" service application-default
set rulebase security rules "Allow-HTTPS" action allow`,cisco_asa:`! Cisco ASA Access List
access-list outside_access_in extended permit tcp any host 10.0.0.50 eq 443
access-list outside_access_in extended permit tcp 10.0.0.0 255.0.0.0 any eq 22
access-list outside_access_in extended deny ip any any log`,fortinet:`# FortiGate Firewall Policy
config firewall policy
    edit 1
        set name "Allow-HTTPS"
        set srcintf "wan1"
        set dstintf "lan"
        set srcaddr "all"
        set dstaddr "webservers"
        set action accept
        set schedule "always"
        set service "HTTPS"
        set logtraffic all
    next
end`,iptables:`# Linux iptables Rules
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp --dport 22 -s 10.0.0.0/8 -j ACCEPT
iptables -A INPUT -p tcp --dport 3306 -s 10.1.0.0/16 -j ACCEPT
iptables -A INPUT -j DROP`},_r=[{id:"aws",name:"AWS Security Group",category:"cloud"},{id:"azure",name:"Azure NSG",category:"cloud"},{id:"gcp",name:"GCP Firewall",category:"cloud"},{id:"palo_alto",name:"Palo Alto",category:"firewall"},{id:"cisco_asa",name:"Cisco ASA",category:"firewall"},{id:"fortinet",name:"Fortinet",category:"firewall"},{id:"iptables",name:"iptables",category:"linux"}],cf=()=>{var v,L;const{platform:e,content:s,result:a,securityChecks:r,history:n,isValidating:o,error:i,setPlatform:l,setContent:c,validate:d,clearResult:u,clearError:p}=lf(),[h,y]=f.useState(!1),j=()=>{c(vc[e]),y(!1),u()};return t.jsx(J,{children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Select Platform"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:_r.map(x=>t.jsx("button",{onClick:()=>{l(x.id),u()},className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${e===x.id?"bg-cyan-500 text-white":x.category==="cloud"?"bg-blue-50 text-blue-700 hover:bg-blue-100":x.category==="firewall"?"bg-orange-50 text-orange-700 hover:bg-orange-100":"bg-slate-50 text-slate-700 hover:bg-slate-100"}`,children:x.name},x.id))})]}),i&&t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-red-700",children:i})]}),t.jsx("button",{onClick:p,className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Rule Content"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>y(!h),className:"text-sm text-cyan-600 hover:text-cyan-700",children:h?"Hide Example":"Show Example"}),t.jsx("span",{className:"text-slate-300",children:"|"}),t.jsx("button",{onClick:()=>{c(""),u()},className:"text-sm text-slate-500 hover:text-slate-700",children:"Clear"})]})]}),h&&t.jsxs("div",{className:"mb-4 p-3 bg-slate-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("span",{className:"text-sm text-slate-600",children:["Example for ",(v=_r.find(x=>x.id===e))==null?void 0:v.name]}),t.jsx("button",{onClick:j,className:"text-sm text-cyan-600 hover:text-cyan-700 font-medium",children:"Load Example"})]}),t.jsxs("pre",{className:"text-xs text-slate-500 overflow-x-auto whitespace-pre-wrap",children:[vc[e].substring(0,200),"..."]})]}),t.jsx("textarea",{value:s,onChange:x=>c(x.target.value),placeholder:`Enter ${(L=_r.find(x=>x.id===e))==null?void 0:L.name} rules to validate...`,className:"w-full h-64 px-4 py-3 font-mono text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent resize-none",spellCheck:!1}),t.jsx("div",{className:"flex gap-4 mt-4",children:t.jsx("button",{onClick:d,disabled:o||!s.trim(),className:"flex-1 bg-cyan-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Validating..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Validate Rules"]})})})]}),a&&t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Validation Results"}),t.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a.isValid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.isValid?"Valid":"Invalid"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsx(Kn,{label:"Syntax",score:a.syntaxScore}),t.jsx(Kn,{label:"Security",score:a.securityScore}),t.jsx(Kn,{label:"Compliance",score:a.complianceScore})]}),a.issues.length>0?t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-slate-700 mb-3",children:["Issues Found (",a.issues.length,")"]}),t.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:a.issues.map(x=>t.jsx(df,{issue:x},x.id))})]}):t.jsxs("div",{className:"text-center py-8 text-green-600",children:[t.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"font-medium",children:"No issues found!"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Your rules passed all validation checks."})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[r.length>0&&t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Security Analysis"}),t.jsx("div",{className:"space-y-2",children:r.map(x=>t.jsx(uf,{check:x},x.id))})]}),t.jsxs(b,{className:"bg-white shadow-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Recent Validations"}),n.length===0?t.jsx("p",{className:"text-center text-slate-500 py-4",children:"No validation history"}):t.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:n.map(x=>t.jsx(pf,{item:x},x.id))})]}),t.jsxs(b,{className:"bg-gradient-to-br from-cyan-500 to-blue-600 text-white shadow-lg",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Validation Tips"}),t.jsxs("ul",{className:"space-y-2 text-sm text-cyan-100",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-cyan-200 mt-0.5",children:"1."}),t.jsx("span",{children:"Never open SSH (22) or RDP (3389) to 0.0.0.0/0"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-cyan-200 mt-0.5",children:"2."}),t.jsx("span",{children:'Use specific IP ranges instead of "any" when possible'})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-cyan-200 mt-0.5",children:"3."}),t.jsx("span",{children:"Keep database ports restricted to internal networks"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-cyan-200 mt-0.5",children:"4."}),t.jsx("span",{children:"Use HTTPS instead of HTTP for web traffic"})]})]})]})]})]})})},Kn=({label:e,score:s})=>{const a=n=>n>=90?"text-green-600":n>=70?"text-amber-600":"text-red-600",r=n=>n>=90?"bg-green-500":n>=70?"bg-amber-500":"bg-red-500";return t.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[t.jsx("p",{className:"text-sm text-slate-500 mb-1",children:e}),t.jsxs("p",{className:`text-2xl font-bold ${a(s)}`,children:[s,"%"]}),t.jsx("div",{className:"w-full h-2 bg-slate-200 rounded-full mt-2",children:t.jsx("div",{className:`h-full rounded-full transition-all ${r(s)}`,style:{width:`${s}%`}})})]})},df=({issue:e})=>{const a={error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-700",icon:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},warning:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-700",icon:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-700",icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}[e.severity];return t.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-3`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:`w-5 h-5 ${a.text} flex-shrink-0 mt-0.5`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a.icon})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.line>0&&t.jsxs("span",{className:"text-xs bg-slate-200 text-slate-600 px-1.5 py-0.5 rounded",children:["Line ",e.line]}),t.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${e.category==="syntax"?"bg-purple-100 text-purple-700":e.category==="security"?"bg-red-100 text-red-700":e.category==="compliance"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:e.category})]}),t.jsx("p",{className:`text-sm ${a.text}`,children:e.message}),e.suggestion&&t.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Suggestion:"})," ",e.suggestion]})]})]})})},uf=({check:e})=>{const a={pass:{bg:"bg-green-50",text:"text-green-700",icon:"M5 13l4 4L19 7"},fail:{bg:"bg-red-50",text:"text-red-700",icon:"M6 18L18 6M6 6l12 12"},warning:{bg:"bg-amber-50",text:"text-amber-700",icon:"M12 9v2m0 4h.01"},skipped:{bg:"bg-slate-50",text:"text-slate-500",icon:"M20 12H4"}}[e.status];return t.jsx("div",{className:`${a.bg} rounded-lg p-3`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${a.text}`,children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a.icon})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:`text-sm font-medium ${a.text}`,children:e.name}),t.jsx("p",{className:"text-xs text-slate-500",children:e.description}),e.details&&t.jsx("p",{className:"text-xs text-slate-600 mt-1",children:e.details})]})]})})},pf=({item:e})=>{var a;const s=((a=_r.find(r=>r.id===e.platform))==null?void 0:a.name)||e.platform;return t.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"text-sm font-medium text-slate-800",children:s}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.isValid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.isValid?"Valid":"Invalid"})]}),t.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[t.jsxs("span",{children:[e.ruleCount," rules"]}),t.jsxs("span",{children:[e.issueCount," issues"]})]}),t.jsx("p",{className:"text-xs text-slate-400 mt-1 truncate font-mono",children:e.snippet}),t.jsx("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]})},mf=()=>t.jsx(J,{children:t.jsx(b,{className:"bg-white shadow-lg",children:t.jsx("div",{className:"text-center py-16 text-gray-400",children:"Conflict Detection View - Allow/Deny conflicts and shadowing detection"})})}),hf=()=>{const[e,s]=f.useState(null),[a,r]=f.useState([]),[n,o]=f.useState("cloud"),[i,l]=f.useState(!0),[c,d]=f.useState(null),[u,p]=f.useState(null),[h,y]=f.useState(null),j=f.useCallback(async()=>{try{l(!0),d(null);const A=await Ae.getSettings();s(A)}catch(A){d(A instanceof Error?A.message:"Failed to load settings")}finally{l(!1)}},[]);f.useEffect(()=>{j()},[j]);const v=f.useCallback(async A=>{p(A),y(null);try{const _=await Ae.testCloudConnection(A);y(_)}catch(_){y({success:!1,message:_ instanceof Error?_.message:"Test failed"})}finally{p(null)}},[]),L=f.useCallback(async(A,_)=>{try{const T=await Ae.updateCloudConnection(A,_);s(G=>G&&{...G,cloudConnections:G.cloudConnections.map(me=>me.id===A?T:me)})}catch(T){d(T instanceof Error?T.message:"Failed to update connection")}},[]),x=f.useCallback(async A=>{try{const _=await Ae.addCloudConnection(A);s(T=>T&&{...T,cloudConnections:[...T.cloudConnections,_]})}catch(_){d(_ instanceof Error?_.message:"Failed to add connection")}},[]),m=f.useCallback(async A=>{try{await Ae.deleteCloudConnection(A),s(_=>_&&{..._,cloudConnections:_.cloudConnections.filter(T=>T.id!==A)})}catch(_){d(_ instanceof Error?_.message:"Failed to delete connection")}},[]),g=f.useCallback(async A=>{try{const _=await Ae.updateServiceNowConfig(A);s(T=>T&&{...T,serviceNow:_})}catch(_){d(_ instanceof Error?_.message:"Failed to update ServiceNow config")}},[]),w=f.useCallback(async()=>{p("servicenow"),y(null);try{const A=await Ae.testServiceNowConnection();y(A)}catch(A){y({success:!1,message:A instanceof Error?A.message:"Test failed"})}finally{p(null)}},[]),N=f.useCallback(async A=>{try{const _=await Ae.updateSIEMConfig(A);s(T=>T&&{...T,siem:_})}catch(_){d(_ instanceof Error?_.message:"Failed to update SIEM config")}},[]),k=f.useCallback(async A=>{try{const _=await Ae.updateAPMConfig(A);s(T=>T&&{...T,apm:_})}catch(_){d(_ instanceof Error?_.message:"Failed to update APM config")}},[]),C=f.useCallback(async A=>{try{const _=await Ae.addUser(A);s(T=>T&&{...T,users:[...T.users,_]})}catch(_){d(_ instanceof Error?_.message:"Failed to add user")}},[]),O=f.useCallback(async(A,_)=>{try{const T=await Ae.updateUser(A,_);s(G=>G&&{...G,users:G.users.map(me=>me.id===A?T:me)})}catch(T){d(T instanceof Error?T.message:"Failed to update user")}},[]),P=f.useCallback(async A=>{try{await Ae.deleteUser(A),s(_=>_&&{..._,users:_.users.filter(T=>T.id!==A)})}catch(_){d(_ instanceof Error?_.message:"Failed to delete user")}},[]),I=f.useCallback(async A=>{try{const _=await Ae.updateNotificationPreferences(A);s(T=>T&&{...T,notifications:_})}catch(_){d(_ instanceof Error?_.message:"Failed to update notification preferences")}},[]),W=f.useCallback(async A=>{try{const _=await Ae.getAuditLogs(A);r(_)}catch(_){d(_ instanceof Error?_.message:"Failed to load audit logs")}},[]),B=f.useCallback(()=>{y(null)},[]);return{settings:e,auditLogs:a,activeTab:n,isLoading:i,error:c,testingConnection:u,testResult:h,setActiveTab:o,testCloudConnection:v,updateCloudConnection:L,addCloudConnection:x,deleteCloudConnection:m,updateServiceNowConfig:g,testServiceNowConnection:w,updateSIEMConfig:N,updateAPMConfig:k,addUser:C,updateUser:O,deleteUser:P,updateNotificationPreferences:I,loadAuditLogs:W,clearTestResult:B,refreshSettings:j}},gf=[{id:"cloud",label:"Cloud Connections",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})},{id:"servicenow",label:"ServiceNow",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})},{id:"siem",label:"SIEM",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},{id:"apm",label:"APM",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"users",label:"Users",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{id:"notifications",label:"Notifications",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})},{id:"audit",label:"Audit Logs",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}],xf=({activeTab:e,onTabChange:s})=>t.jsx("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-2",children:t.jsx("nav",{className:"flex flex-col gap-1",children:gf.map(a=>{const r=e===a.id;return t.jsxs("button",{onClick:()=>s(a.id),className:`flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-all ${r?"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 text-cyan-400 border border-cyan-500/30":"text-slate-400 hover:bg-slate-700/50 hover:text-white"}`,children:[a.icon,t.jsx("span",{className:"font-medium",children:a.label})]},a.id)})})}),ff={aws:{name:"AWS",color:"from-orange-500 to-orange-600",icon:t.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 01-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 01-.287-.375 6.18 6.18 0 01-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 01-.28.104.488.488 0 01-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 01.224-.167c.279-.144.614-.264 1.005-.36a4.84 4.84 0 011.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 00-.735-.136 6.02 6.02 0 00-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 01-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 01.32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 01.311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 01-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 01-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 01-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 00.415-.758.777.777 0 00-.215-.559c-.144-.151-.415-.287-.806-.407l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 01-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 01.24.2.43.43 0 01.071.263v.375c0 .168-.064.256-.184.256a.83.83 0 01-.303-.096 3.652 3.652 0 00-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167z"})})},azure:{name:"Azure",color:"from-blue-500 to-blue-600",icon:t.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M5.483 21.3H24L14.025 4.013l-3.038 8.347 5.836 6.938L5.483 21.3zM13.23 2.7L6.105 8.677 0 19.253h5.505l7.725-16.553z"})})},gcp:{name:"GCP",color:"from-red-500 to-yellow-500",icon:t.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12.19 2.38a9.344 9.344 0 00-9.234 6.893c.053-.02-.055.013 0 0-3.875 2.551-3.922 8.11-.247 10.941l.006-.007-.007.03a6.717 6.717 0 006.212 3.76h10.39c2.51-.034 4.659-1.9 5.42-4.287a5.91 5.91 0 00-.49-4.643 5.906 5.906 0 00-3.83-2.799l-.006-.004-.001-.009A9.34 9.34 0 0012.19 2.38zm-.358 4.146c1.244-.04 2.518.368 3.486 1.15a5.186 5.186 0 011.862 4.078v.518c3.53-.07 3.53 5.262 0 5.193h-5.193v-.518c-1.243.04-2.517-.368-3.485-1.15a5.186 5.186 0 01-1.863-4.078v-.518c-3.53.07-3.53-5.262 0-5.193h5.193v.518z"})})},onprem:{name:"On-Premises",color:"from-slate-500 to-slate-600",icon:t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})})}},vf={connected:{label:"Connected",variant:"success"},disconnected:{label:"Disconnected",variant:"default"},error:{label:"Error",variant:"error"},pending:{label:"Pending",variant:"warning"}},yf=({connections:e,testingConnection:s,testResult:a,onTestConnection:r,onAddConnection:n,onDeleteConnection:o,onClearTestResult:i})=>{const[l,c]=f.useState(null),d=u=>u?new Date(u).toLocaleString():"Never";return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Cloud Connections"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Manage connections to AWS, Azure, GCP, and On-Premises infrastructure"})]}),t.jsxs(M,{variant:"primary",size:"md",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Connection"]})]}),a&&t.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between ${a.success?"bg-emerald-500/20 border border-emerald-500/30":"bg-red-500/20 border border-red-500/30"}`,children:[t.jsxs("div",{className:"flex items-center gap-3",children:[a.success?t.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):t.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),t.jsx("span",{className:a.success?"text-emerald-400":"text-red-400",children:a.message})]}),t.jsx("button",{onClick:i,className:"text-slate-400 hover:text-white",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"grid gap-4",children:e.map(u=>{const p=ff[u.provider],h=vf[u.status],y=l===u.id,j=s===u.id;return t.jsxs(b,{padding:"none",className:"overflow-hidden",children:[t.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>c(y?null:u.id),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${p.color} flex items-center justify-center text-white`,children:p.icon}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h3",{className:"font-bold text-white",children:u.name}),t.jsx(ve,{variant:h.variant,size:"sm",children:h.label})]}),t.jsxs("p",{className:"text-sm text-slate-400",children:[p.name," ",u.region&&`- ${u.region}`]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(M,{variant:"secondary",size:"sm",isLoading:j,onClick:v=>{v.stopPropagation(),r(u.id)},children:"Test Connection"}),t.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),y&&t.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-slate-700",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Account/Project ID"}),t.jsx("p",{className:"text-sm text-slate-300 font-mono",children:u.accountId||u.subscriptionId||u.projectId||u.datacenterName||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Last Sync"}),t.jsx("p",{className:"text-sm text-slate-300",children:d(u.lastSync)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Credentials Type"}),t.jsx("p",{className:"text-sm text-slate-300 capitalize",children:u.credentials.type.replace("_"," ")})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Credentials Status"}),t.jsx(ve,{variant:u.credentials.configured?"success":"warning",size:"sm",children:u.credentials.configured?"Configured":"Not Configured"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"ghost",size:"sm",children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),t.jsxs(M,{variant:"ghost",size:"sm",children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sync Now"]}),t.jsxs(M,{variant:"danger",size:"sm",onClick:v=>{v.stopPropagation(),o(u.id)},children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})]},u.id)})})]})},bf=({config:e,testingConnection:s,testResult:a,onUpdate:r,onTestConnection:n,onClearTestResult:o})=>{const[i,l]=f.useState(!1),[c,d]=f.useState(e),u=()=>{r(c),l(!1)},p=()=>{d(e),l(!1)},h=s==="servicenow";return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"ServiceNow Integration"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Configure ServiceNow ITSM integration for ticket management"})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(ve,{variant:e.isConfigured?"success":"warning",size:"lg",children:e.isConfigured?"Configured":"Not Configured"})})]}),a&&t.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between ${a.success?"bg-emerald-500/20 border border-emerald-500/30":"bg-red-500/20 border border-red-500/30"}`,children:[t.jsxs("div",{className:"flex items-center gap-3",children:[a.success?t.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):t.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),t.jsx("span",{className:a.success?"text-emerald-400":"text-red-400",children:a.message})]}),t.jsx("button",{onClick:o,className:"text-slate-400 hover:text-white",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs(b,{children:[t.jsx($,{title:"Connection Settings",action:!i&&t.jsxs(M,{variant:"ghost",size:"sm",onClick:()=>l(!0),children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Instance URL"}),i?t.jsx("input",{type:"url",value:c.instanceUrl,onChange:y=>d({...c,instanceUrl:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://your-instance.service-now.com"}):t.jsx("p",{className:"text-white font-mono",children:e.instanceUrl})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Username"}),i?t.jsx("input",{type:"text",value:c.username,onChange:y=>d({...c,username:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"}):t.jsx("p",{className:"text-white font-mono",children:e.username})]})]}),i&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Password"}),t.jsx("input",{type:"password",placeholder:"Enter new password to change",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),i&&t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsx(M,{variant:"primary",size:"sm",onClick:u,children:"Save Changes"}),t.jsx(M,{variant:"ghost",size:"sm",onClick:p,children:"Cancel"})]}),!i&&t.jsx(M,{variant:"secondary",size:"sm",isLoading:h,onClick:n,children:"Test Connection"})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Ticket Settings"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Auto-Create Tickets"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Automatically create tickets for critical alerts"})]}),t.jsx("button",{onClick:()=>r({autoCreateTickets:!e.autoCreateTickets}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.autoCreateTickets?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.autoCreateTickets?"translate-x-6":"translate-x-1"}`})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Default Assignment Group"}),t.jsxs("select",{value:e.defaultAssignmentGroup,onChange:y=>r({defaultAssignmentGroup:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"Network Operations",children:"Network Operations"}),t.jsx("option",{value:"Security Operations",children:"Security Operations"}),t.jsx("option",{value:"Cloud Infrastructure",children:"Cloud Infrastructure"}),t.jsx("option",{value:"Application Support",children:"Application Support"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Default Priority"}),t.jsxs("select",{value:e.defaultPriority,onChange:y=>r({defaultPriority:y.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"critical",children:"Critical"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Sync Interval (minutes)"}),t.jsx("input",{type:"number",min:"1",max:"60",value:e.syncInterval,onChange:y=>r({syncInterval:parseInt(y.target.value,10)}),className:"w-32 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]})]})]})},_f=[{value:"splunk",label:"Splunk",icon:"S"},{value:"qradar",label:"IBM QRadar",icon:"Q"},{value:"sentinel",label:"Microsoft Sentinel",icon:"M"},{value:"elastic",label:"Elastic Security",icon:"E"},{value:"none",label:"None",icon:"-"}],wf=({config:e,onUpdate:s})=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"SIEM Integration"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Configure Security Information and Event Management integration"})]}),t.jsx(ve,{variant:e.isConfigured?"success":"warning",size:"lg",children:e.isConfigured?"Configured":"Not Configured"})]}),t.jsxs(b,{children:[t.jsx($,{title:"SIEM Platform"}),t.jsx("div",{className:"grid grid-cols-5 gap-3",children:_f.map(a=>t.jsxs("button",{onClick:()=>s({type:a.value}),className:`p-4 rounded-lg border-2 transition-all ${e.type===a.value?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[t.jsx("div",{className:`w-10 h-10 mx-auto mb-2 rounded-lg flex items-center justify-center text-lg font-bold ${e.type===a.value?"bg-cyan-500 text-white":"bg-slate-700 text-slate-400"}`,children:a.icon}),t.jsx("p",{className:`text-sm font-medium text-center ${e.type===a.value?"text-cyan-400":"text-slate-400"}`,children:a.label})]},a.value))})]}),e.type!=="none"&&t.jsxs(t.Fragment,{children:[t.jsxs(b,{children:[t.jsx($,{title:"Connection Settings"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Endpoint"}),t.jsx("input",{type:"url",value:e.endpoint,onChange:a=>s({endpoint:a.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://your-siem.example.com:8089"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Key / Token"}),t.jsx("input",{type:"password",placeholder:"Enter API key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Index / Data Source"}),t.jsx("input",{type:"text",placeholder:"main",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),t.jsx(M,{variant:"secondary",size:"sm",children:"Test Connection"})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Data Forwarding"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Forward Alerts"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Send security alerts to SIEM platform"})]}),t.jsx("button",{onClick:()=>s({forwardAlerts:!e.forwardAlerts}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.forwardAlerts?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.forwardAlerts?"translate-x-6":"translate-x-1"}`})})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Forward Logs"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Send audit and system logs to SIEM"})]}),t.jsx("button",{onClick:()=>s({forwardLogs:!e.forwardLogs}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.forwardLogs?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.forwardLogs?"translate-x-6":"translate-x-1"}`})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Alert Severity Threshold"}),t.jsxs("select",{value:e.alertSeverityThreshold,onChange:a=>s({alertSeverityThreshold:a.target.value}),className:"w-48 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"low",children:"Low and above"}),t.jsx("option",{value:"medium",children:"Medium and above"}),t.jsx("option",{value:"high",children:"High and above"}),t.jsx("option",{value:"critical",children:"Critical only"})]}),t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Only forward alerts at or above this severity"})]})]})]})]})]}),jf=[{value:"datadog",label:"Datadog",color:"from-purple-500 to-purple-600"},{value:"newrelic",label:"New Relic",color:"from-teal-500 to-teal-600"},{value:"dynatrace",label:"Dynatrace",color:"from-blue-500 to-blue-600"},{value:"appdynamics",label:"AppDynamics",color:"from-cyan-500 to-cyan-600"},{value:"none",label:"None",color:"from-slate-500 to-slate-600"}],Nf=({config:e,onUpdate:s})=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"APM Integration"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Configure Application Performance Monitoring integration"})]}),t.jsx(ve,{variant:e.isConfigured?"success":"warning",size:"lg",children:e.isConfigured?"Configured":"Not Configured"})]}),t.jsxs(b,{children:[t.jsx($,{title:"APM Platform"}),t.jsx("div",{className:"grid grid-cols-5 gap-3",children:jf.map(a=>t.jsxs("button",{onClick:()=>s({type:a.value}),className:`p-4 rounded-lg border-2 transition-all ${e.type===a.value?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[t.jsx("div",{className:`w-10 h-10 mx-auto mb-2 rounded-lg bg-gradient-to-br ${a.color} flex items-center justify-center text-white font-bold`,children:a.label.charAt(0)}),t.jsx("p",{className:`text-sm font-medium text-center ${e.type===a.value?"text-cyan-400":"text-slate-400"}`,children:a.label})]},a.value))})]}),e.type!=="none"&&t.jsxs(t.Fragment,{children:[t.jsxs(b,{children:[t.jsx($,{title:"Connection Settings"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Endpoint"}),t.jsx("input",{type:"url",value:e.apiEndpoint,onChange:a=>s({apiEndpoint:a.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"https://api.datadoghq.com"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"API Key"}),t.jsx("input",{type:"password",placeholder:"Enter API key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Application Key"}),t.jsx("input",{type:"password",placeholder:"Enter application key",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),t.jsx(M,{variant:"secondary",size:"sm",children:"Test Connection"})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Data Collection"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Collect Metrics"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Import application metrics from APM platform"})]}),t.jsx("button",{onClick:()=>s({collectMetrics:!e.collectMetrics}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.collectMetrics?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.collectMetrics?"translate-x-6":"translate-x-1"}`})})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Collect Traces"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Import distributed traces for path analysis"})]}),t.jsx("button",{onClick:()=>s({collectTraces:!e.collectTraces}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.collectTraces?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.collectTraces?"translate-x-6":"translate-x-1"}`})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Sample Rate"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:e.sampleRate,onChange:a=>s({sampleRate:parseFloat(a.target.value)}),className:"flex-1 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),t.jsxs("span",{className:"text-white font-mono w-16 text-right",children:[(e.sampleRate*100).toFixed(0),"%"]})]}),t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Percentage of traces to collect. Lower values reduce overhead."})]})]})]})]})]}),qt={admin:{label:"Administrator",color:"bg-purple-500/20 text-purple-400",description:"Full access to all features and settings"},operator:{label:"Operator",color:"bg-blue-500/20 text-blue-400",description:"Can manage rules and view all dashboards"},viewer:{label:"Viewer",color:"bg-slate-500/20 text-slate-400",description:"Read-only access to dashboards"},auditor:{label:"Auditor",color:"bg-amber-500/20 text-amber-400",description:"Can view audit logs and export reports"}},zu={admin:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!0,canModifySettings:!0,canViewAuditLogs:!0,canManageUsers:!0,canExportData:!0},operator:{canViewDashboard:!0,canManageRules:!0,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!0},viewer:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!1,canManageUsers:!1,canExportData:!1},auditor:{canViewDashboard:!0,canManageRules:!1,canApproveTickets:!1,canModifySettings:!1,canViewAuditLogs:!0,canManageUsers:!1,canExportData:!0}},kf=({onClose:e,onAdd:s})=>{const[a,r]=f.useState({email:"",name:"",role:"viewer"}),n=o=>{o.preventDefault(),s({...a,status:"pending",permissions:zu[a.role]}),e()};return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Add New User"}),t.jsxs("form",{onSubmit:n,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Email"}),t.jsx("input",{type:"email",required:!0,value:a.email,onChange:o=>r({...a,email:o.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"user@company.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Full Name"}),t.jsx("input",{type:"text",required:!0,value:a.name,onChange:o=>r({...a,name:o.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"John Doe"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Role"}),t.jsx("select",{value:a.role,onChange:o=>r({...a,role:o.target.value}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:Object.entries(qt).map(([o,{label:i}])=>t.jsx("option",{value:o,children:i},o))}),t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:qt[a.role].description})]}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsx(M,{type:"submit",variant:"primary",children:"Add User"}),t.jsx(M,{type:"button",variant:"ghost",onClick:e,children:"Cancel"})]})]})]})})},Sf=({users:e,onAddUser:s,onUpdateUser:a,onDeleteUser:r})=>{const[n,o]=f.useState(!1),[i,l]=f.useState(null),c=u=>u?new Date(u).toLocaleString():"Never",d=i?e.find(u=>u.id===i):null;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"User Management"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Manage user accounts and permissions"})]}),t.jsxs(M,{variant:"primary",onClick:()=>o(!0),children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Role Permissions Matrix"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-700",children:[t.jsx("th",{className:"text-left py-2 px-3 text-slate-400 font-medium",children:"Permission"}),Object.entries(qt).map(([u,{label:p}])=>t.jsx("th",{className:"text-center py-2 px-3 text-slate-400 font-medium",children:p},u))]})}),t.jsx("tbody",{children:[{key:"canViewDashboard",label:"View Dashboards"},{key:"canManageRules",label:"Manage Rules"},{key:"canApproveTickets",label:"Approve Tickets"},{key:"canModifySettings",label:"Modify Settings"},{key:"canViewAuditLogs",label:"View Audit Logs"},{key:"canManageUsers",label:"Manage Users"},{key:"canExportData",label:"Export Data"}].map(u=>t.jsxs("tr",{className:"border-b border-slate-700/50",children:[t.jsx("td",{className:"py-2 px-3 text-slate-300",children:u.label}),Object.keys(qt).map(p=>t.jsx("td",{className:"text-center py-2 px-3",children:zu[p][u.key]?t.jsx("svg",{className:"w-5 h-5 text-emerald-400 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):t.jsx("svg",{className:"w-5 h-5 text-slate-600 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})},p))]},u.key))})]})})]}),t.jsxs(b,{children:[t.jsx($,{title:`Users (${e.length})`}),t.jsx("div",{className:"divide-y divide-slate-700",children:e.map(u=>t.jsxs("div",{className:"py-3 flex items-center justify-between hover:bg-slate-700/30 -mx-6 px-6 cursor-pointer",onClick:()=>l(u.id===i?null:u.id),children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white font-bold",children:u.name.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-white font-medium",children:u.name}),t.jsx(ve,{variant:u.status==="active"?"success":u.status==="pending"?"warning":"default",size:"sm",children:u.status})]}),t.jsx("p",{className:"text-sm text-slate-400",children:u.email})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${qt[u.role].color}`,children:qt[u.role].label}),t.jsx("svg",{className:`w-5 h-5 text-slate-400 transition-transform ${i===u.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]},u.id))})]}),d&&t.jsxs(b,{children:[t.jsx($,{title:`User Details: ${d.name}`,action:t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"ghost",size:"sm",onClick:()=>{const u=d.status==="active"?"inactive":"active";a(d.id,{status:u})},children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),d.status==="active"?"Deactivate":"Activate"]}),t.jsxs(M,{variant:"danger",size:"sm",onClick:()=>{r(d.id),l(null)},children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Email"}),t.jsx("p",{className:"text-slate-300",children:d.email})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Role"}),t.jsx("p",{className:"text-slate-300",children:qt[d.role].label})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Created"}),t.jsx("p",{className:"text-slate-300",children:c(d.createdAt)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Last Login"}),t.jsx("p",{className:"text-slate-300",children:c(d.lastLogin)})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-2",children:"Permissions"}),t.jsx("div",{className:"space-y-2",children:Object.entries(d.permissions).map(([u,p])=>t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-slate-400",children:u.replace(/^can/,"").replace(/([A-Z])/g," $1").trim()}),p?t.jsx("span",{className:"text-emerald-400",children:"Allowed"}):t.jsx("span",{className:"text-slate-600",children:"Denied"})]},u))})]})]})]}),n&&t.jsx(kf,{onClose:()=>o(!1),onAdd:s})]})},Cf={email:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),slack:t.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"})}),pagerduty:t.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M16.965 1.18C15.085.164 13.769 0 10.683 0H3.73v14.55h6.926c2.743 0 4.8-.164 6.61-1.37 1.975-1.303 3.004-3.453 3.004-6.14 0-2.605-.933-4.673-3.305-5.86zM10.437 10.2H7.744V4.177h2.952c2.99 0 4.618.886 4.618 2.991 0 2.36-1.628 3.031-4.877 3.031zM3.73 24h4.015V17.29H3.73V24z"})}),webhook:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),teams:t.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M20.625 8.073h-5.27V5.138c0-.666.535-1.21 1.193-1.21h3.885c.656 0 1.192.544 1.192 1.21v1.925c0 .555-.448 1.01-1 1.01zm.25 1.49v5.22c0 .84-.68 1.52-1.52 1.52h-4.27v-6.74h5.79zm-7.74-5.1v11.84c0 .84-.68 1.52-1.52 1.52H4.94c-.84 0-1.52-.68-1.52-1.52V4.463c0-.84.68-1.52 1.52-1.52h6.675c.84 0 1.52.68 1.52 1.52z"})})},Af={email:"bg-blue-500/20 text-blue-400",slack:"bg-purple-500/20 text-purple-400",pagerduty:"bg-emerald-500/20 text-emerald-400",webhook:"bg-slate-500/20 text-slate-400",teams:"bg-indigo-500/20 text-indigo-400"},Tf=({preferences:e,onUpdate:s})=>{const a=r=>{const n=e.channels.map(o=>o.id===r?{...o,isEnabled:!o.isEnabled}:o);s({channels:n})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Notification Preferences"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Configure how and when you receive alerts"})]}),t.jsxs(M,{variant:"primary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Channel"]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Alert Channels"}),t.jsx("div",{className:"space-y-3",children:e.channels.map(r=>t.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Af[r.type]}`,children:Cf[r.type]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-white font-medium",children:r.name}),t.jsx(ve,{variant:"info",size:"sm",children:r.type.charAt(0).toUpperCase()+r.type.slice(1)})]}),t.jsxs("p",{className:"text-sm text-slate-400",children:[r.type==="email"&&r.config.recipients,r.type==="slack"&&r.config.channel,r.type==="pagerduty"&&`Service: ${r.config.severity}`,r.type==="webhook"&&"Custom webhook",r.type==="teams"&&"Microsoft Teams"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>a(r.id),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.isEnabled?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.isEnabled?"translate-x-6":"translate-x-1"}`})}),t.jsx(M,{variant:"ghost",size:"sm",children:t.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]},r.id))})]}),t.jsxs(b,{children:[t.jsx($,{title:"Alert Threshold"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-slate-400",children:"Receive notifications for alerts at or above the selected severity level"}),t.jsx("div",{className:"grid grid-cols-3 gap-3",children:["all","warning","critical"].map(r=>t.jsxs("button",{onClick:()=>s({alertThreshold:r}),className:`p-4 rounded-lg border-2 transition-all ${e.alertThreshold===r?"border-cyan-500 bg-cyan-500/10":"border-slate-700 bg-slate-800 hover:border-slate-600"}`,children:[t.jsx("p",{className:`font-medium capitalize ${e.alertThreshold===r?"text-cyan-400":"text-slate-400"}`,children:r==="all"?"All Alerts":`${r} & Above`}),t.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[r==="all"&&"Info, Warning, Critical",r==="warning"&&"Warning, Critical",r==="critical"&&"Critical only"]})]},r))})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Quiet Hours"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Enable Quiet Hours"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Suppress non-critical notifications during specified hours"})]}),t.jsx("button",{onClick:()=>s({quietHours:{...e.quietHours,enabled:!e.quietHours.enabled}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.quietHours.enabled?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.quietHours.enabled?"translate-x-6":"translate-x-1"}`})})]}),e.quietHours.enabled&&t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Start Time"}),t.jsx("input",{type:"time",value:e.quietHours.start,onChange:r=>s({quietHours:{...e.quietHours,start:r.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"End Time"}),t.jsx("input",{type:"time",value:e.quietHours.end,onChange:r=>s({quietHours:{...e.quietHours,end:r.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Timezone"}),t.jsxs("select",{value:e.quietHours.timezone,onChange:r=>s({quietHours:{...e.quietHours,timezone:r.target.value}}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"America/New_York",children:"Eastern Time"}),t.jsx("option",{value:"America/Chicago",children:"Central Time"}),t.jsx("option",{value:"America/Denver",children:"Mountain Time"}),t.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),t.jsx("option",{value:"UTC",children:"UTC"})]})]})]})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Email Digest"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Enable Digest Emails"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Receive a summary of alerts and activities"})]}),t.jsx("button",{onClick:()=>s({digest:{...e.digest,enabled:!e.digest.enabled}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${e.digest.enabled?"bg-cyan-500":"bg-slate-600"}`,children:t.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${e.digest.enabled?"translate-x-6":"translate-x-1"}`})})]}),e.digest.enabled&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Frequency"}),t.jsxs("select",{value:e.digest.frequency,onChange:r=>s({digest:{...e.digest,frequency:r.target.value}}),className:"w-48 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[t.jsx("option",{value:"hourly",children:"Hourly"}),t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]})]})]})]})]})},Pf={UPDATE_SETTINGS:"bg-blue-500/20 text-blue-400",CREATE_RULE:"bg-emerald-500/20 text-emerald-400",TEST_CONNECTION:"bg-amber-500/20 text-amber-400",ADD_USER:"bg-purple-500/20 text-purple-400",UPDATE_PERMISSIONS:"bg-indigo-500/20 text-indigo-400",APPROVE_TICKET:"bg-cyan-500/20 text-cyan-400",EXPORT_REPORT:"bg-slate-500/20 text-slate-400",SYNC_CLOUD:"bg-teal-500/20 text-teal-400",DELETE_RULE:"bg-red-500/20 text-red-400"},If=[{value:"",label:"All Actions"},{value:"UPDATE_SETTINGS",label:"Update Settings"},{value:"CREATE_RULE",label:"Create Rule"},{value:"DELETE_RULE",label:"Delete Rule"},{value:"TEST_CONNECTION",label:"Test Connection"},{value:"ADD_USER",label:"Add User"},{value:"UPDATE_PERMISSIONS",label:"Update Permissions"},{value:"APPROVE_TICKET",label:"Approve Ticket"},{value:"EXPORT_REPORT",label:"Export Report"},{value:"SYNC_CLOUD",label:"Sync Cloud"}],Ef=({logs:e,onLoadLogs:s})=>{const[a,r]=f.useState(""),[n,o]=f.useState("");f.useEffect(()=>{s()},[s]);const i=()=>{s({user:a||void 0,action:n||void 0})},l=()=>{r(""),o(""),s()},c=u=>{const p=new Date(u),y=new Date().getTime()-p.getTime(),j=Math.floor(y/6e4),v=Math.floor(y/36e5),L=Math.floor(y/864e5);return j<60?`${j} min ago`:v<24?`${v} hours ago`:L<7?`${L} days ago`:p.toLocaleDateString()},d=u=>u.replace(/_/g," ").toLowerCase().replace(/\b\w/g,p=>p.toUpperCase());return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Audit Logs"}),t.jsx("p",{className:"text-slate-400 text-sm",children:"Track all system activities and changes"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export CSV"]}),t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export JSON"]})]})]}),t.jsxs(b,{children:[t.jsx($,{title:"Filters"}),t.jsxs("div",{className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"User"}),t.jsx("input",{type:"text",value:a,onChange:u=>r(u.target.value),placeholder:"Search by email or username",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]}),t.jsxs("div",{className:"w-48",children:[t.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Action"}),t.jsx("select",{value:n,onChange:u=>o(u.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:If.map(u=>t.jsx("option",{value:u.value,children:u.label},u.value))})]}),t.jsx(M,{variant:"primary",onClick:i,children:"Apply Filters"}),t.jsx(M,{variant:"ghost",onClick:l,children:"Clear"})]})]}),t.jsxs(b,{padding:"none",children:[t.jsx("div",{className:"p-4 border-b border-slate-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"font-bold text-white",children:"Activity Log"}),t.jsxs("span",{className:"text-sm text-slate-400",children:[e.length," entries"]})]})}),t.jsx("div",{className:"divide-y divide-slate-700",children:e.length===0?t.jsx("div",{className:"p-8 text-center text-slate-400",children:"No audit logs found matching your criteria"}):e.map(u=>t.jsx("div",{className:"p-4 hover:bg-slate-700/30 transition-colors",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:`mt-1 w-2 h-2 rounded-full ${u.status==="success"?"bg-emerald-400":"bg-red-400"}`}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${Pf[u.action]||"bg-slate-500/20 text-slate-400"}`,children:d(u.action)}),t.jsx("span",{className:"text-white font-medium",children:u.resource})]}),t.jsx("p",{className:"text-sm text-slate-400 mb-2",children:u.details}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),u.user]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),u.ipAddress]})]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-slate-400",children:c(u.timestamp)}),t.jsx(ve,{variant:u.status==="success"?"success":"error",size:"sm",children:u.status})]})]})},u.id))})]})]})},Rf=()=>{const{settings:e,auditLogs:s,activeTab:a,isLoading:r,testingConnection:n,testResult:o,setActiveTab:i,testCloudConnection:l,updateCloudConnection:c,addCloudConnection:d,deleteCloudConnection:u,updateServiceNowConfig:p,testServiceNowConnection:h,updateSIEMConfig:y,updateAPMConfig:j,addUser:v,updateUser:L,deleteUser:x,updateNotificationPreferences:m,loadAuditLogs:g,clearTestResult:w}=hf();if(r||!e)return t.jsx(J,{children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[t.jsxs("svg",{className:"animate-spin h-6 w-6",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading settings..."]})})});const N=()=>{switch(a){case"cloud":return t.jsx(yf,{connections:e.cloudConnections,testingConnection:n,testResult:o,onTestConnection:l,onUpdateConnection:c,onAddConnection:d,onDeleteConnection:u,onClearTestResult:w});case"servicenow":return t.jsx(bf,{config:e.serviceNow,testingConnection:n,testResult:o,onUpdate:p,onTestConnection:h,onClearTestResult:w});case"siem":return t.jsx(wf,{config:e.siem,onUpdate:y});case"apm":return t.jsx(Nf,{config:e.apm,onUpdate:j});case"users":return t.jsx(Sf,{users:e.users,onAddUser:v,onUpdateUser:L,onDeleteUser:x});case"notifications":return t.jsx(Tf,{preferences:e.notifications,onUpdate:m});case"audit":return t.jsx(Ef,{logs:s,onLoadLogs:g});default:return null}};return t.jsx(J,{children:t.jsxs("div",{className:"flex gap-6",children:[t.jsx("div",{className:"w-64 flex-shrink-0",children:t.jsx(xf,{activeTab:a,onTabChange:i})}),t.jsx("div",{className:"flex-1 min-w-0",children:N()})]})})},Lf={beforeAIOps:{averageTATHours:48.5,p50Hours:36,p95Hours:96,totalTickets:1245},afterAIOps:{averageTATHours:8.2,p50Hours:4,p95Hours:18,totalTickets:1567},improvement:{percentageReduction:83.1,hoursSaved:63156,ticketsAccelerated:1567},trendData:[{month:"Jul 2023",beforeAIOps:52,afterAIOps:0,ticketCount:189},{month:"Aug 2023",beforeAIOps:49,afterAIOps:0,ticketCount:203},{month:"Sep 2023",beforeAIOps:47,afterAIOps:0,ticketCount:195},{month:"Oct 2023",beforeAIOps:48,afterAIOps:18,ticketCount:211},{month:"Nov 2023",beforeAIOps:46,afterAIOps:14,ticketCount:224},{month:"Dec 2023",beforeAIOps:51,afterAIOps:11,ticketCount:198},{month:"Jan 2024",beforeAIOps:0,afterAIOps:9,ticketCount:247}]},Of={manual:{count:234,averageTimeHours:4.5,errorRate:12.8,totalEffort:1053},automated:{count:1876,averageTimeMinutes:8,errorRate:2.1,totalEffort:250},improvement:{automationRate:88.9,timeSavingsHours:6593,errorReduction:83.6},byCategory:[{category:"Firewall Rule Changes",manual:45,automated:523,automationRate:92.1,timeSaved:1892},{category:"ACL Updates",manual:67,automated:412,automationRate:86,timeSaved:1345},{category:"Compliance Remediation",manual:89,automated:567,automationRate:86.4,timeSaved:2134},{category:"Network Policy Validation",manual:23,automated:289,automationRate:92.6,timeSaved:876},{category:"Security Group Changes",manual:10,automated:85,automationRate:89.5,timeSaved:346}]},Df={totalChanges:2345,successful:2267,failed:56,failureRate:2.4,failuresByReason:[{reason:"Configuration Syntax Error",count:18,percentage:32.1,avgResolutionTime:1.2},{reason:"Conflicting Rules",count:14,percentage:25,avgResolutionTime:2.8},{reason:"Resource Capacity",count:9,percentage:16.1,avgResolutionTime:4.5},{reason:"Network Connectivity",count:8,percentage:14.3,avgResolutionTime:3.1},{reason:"Permission Issues",count:7,percentage:12.5,avgResolutionTime:.8}],trendData:[{month:"Jul 2023",totalChanges:298,failures:24,failureRate:8.1},{month:"Aug 2023",totalChanges:312,failures:19,failureRate:6.1},{month:"Sep 2023",totalChanges:287,failures:15,failureRate:5.2},{month:"Oct 2023",totalChanges:334,failures:12,failureRate:3.6},{month:"Nov 2023",totalChanges:389,failures:9,failureRate:2.3},{month:"Dec 2023",totalChanges:356,failures:7,failureRate:2},{month:"Jan 2024",totalChanges:369,failures:6,failureRate:1.6}],mttr:2.1,impactAnalysis:{highImpactFailures:8,mediumImpactFailures:23,lowImpactFailures:25,totalDowntimeHours:47.3}},Mf={currentScore:87.3,previousScore:64.2,improvement:23.1,riskReduction:{criticalIssues:{before:47,after:8,reduction:83},highRiskIssues:{before:132,after:23,reduction:82.6},mediumRiskIssues:{before:287,after:67,reduction:76.7}},byFramework:[{framework:"PCI-DSS",previousScore:68.5,currentScore:91.2,improvement:22.7,issuesResolved:34},{framework:"SOC2",previousScore:71.3,currentScore:89.7,improvement:18.4,issuesResolved:28},{framework:"CIS AWS",previousScore:59.8,currentScore:85.1,improvement:25.3,issuesResolved:42},{framework:"NIST 800-53",previousScore:62.4,currentScore:84.8,improvement:22.4,issuesResolved:38},{framework:"ISO 27001",previousScore:66.1,currentScore:86.3,improvement:20.2,issuesResolved:31}],estimatedFinancialImpact:{potentialFinesSaved:245e4,auditCostReduction:38e4,incidentCostAvoidance:182e4,totalValue:465e4}},F={timeSavings:{hours:69749,monetaryValue:4184940},errorReduction:{incidents:203,monetaryValue:2842e3},complianceValue:{riskReduction:83,monetaryValue:465e4},totalROI:11676940,costOfAIOps:85e4,netBenefit:10826940,roiPercentage:1373.8},R={ticketTAT:Lf,automation:Of,firewallChanges:Df,complianceRisk:Mf},Vf=()=>{const[e,s]=f.useState("summary"),a=[{id:"tat",title:"Ticket TAT",description:"Before vs After AIOps",icon:"",value:`${R.ticketTAT.improvement.percentageReduction.toFixed(1)}%`,label:"Reduction",color:"from-emerald-500 to-emerald-600",improvement:R.ticketTAT.improvement.percentageReduction},{id:"automation",title:"Automation Rate",description:"Manual vs Automated",icon:"",value:`${R.automation.improvement.automationRate.toFixed(1)}%`,label:"Automated",color:"from-cyan-500 to-cyan-600",improvement:R.automation.improvement.automationRate},{id:"failures",title:"Change Success",description:"Firewall change quality",icon:"",value:`${(100-R.firewallChanges.failureRate).toFixed(1)}%`,label:"Success Rate",color:"from-blue-500 to-blue-600",improvement:100-R.firewallChanges.failureRate},{id:"compliance",title:"Compliance Score",description:"Risk reduction",icon:"",value:`${R.complianceRisk.improvement.toFixed(1)}%`,label:"Improvement",color:"from-purple-500 to-purple-600",improvement:R.complianceRisk.improvement},{id:"roi",title:"ROI",description:"Return on investment",icon:"",value:`${F.roiPercentage.toFixed(0)}%`,label:"ROI",color:"from-amber-500 to-amber-600",improvement:F.roiPercentage}];return t.jsxs(J,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Ops Value Dashboard"}),t.jsx("p",{className:"text-slate-400",children:"Operational metrics demonstrating AIOps value and business impact"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6",children:a.map(r=>t.jsxs("button",{onClick:()=>s(r.id),className:`p-4 rounded-lg border-2 transition-all text-left ${e===r.id?"border-cyan-500 bg-cyan-500/10 scale-105":"border-slate-600 bg-slate-800 hover:border-slate-500"}`,children:[t.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${r.color} rounded-lg flex items-center justify-center text-2xl mb-3`,children:r.icon}),t.jsx("h3",{className:"text-white font-semibold mb-1",children:r.title}),t.jsx("p",{className:"text-slate-400 text-xs mb-2",children:r.description}),t.jsx("p",{className:"text-2xl font-bold text-white mb-1",children:r.value}),t.jsx("p",{className:"text-xs text-emerald-400",children:r.label})]},r.id))}),e==="summary"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Executive Summary"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[t.jsx("p",{className:"text-emerald-400 font-semibold mb-1",children:"Total ROI"}),t.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(F.totalROI/1e6).toFixed(2),"M"]}),t.jsxs("p",{className:"text-sm text-slate-300 mt-2",children:[F.roiPercentage.toFixed(0),"% return on $",(F.costOfAIOps/1e3).toFixed(0),"K investment"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Time Saved"}),t.jsxs("p",{className:"text-white font-semibold",children:[R.ticketTAT.improvement.hoursSaved.toLocaleString()," hrs"]})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Errors Avoided"}),t.jsxs("p",{className:"text-white font-semibold",children:[F.errorReduction.incidents," incidents"]})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Automation Rate"}),t.jsxs("p",{className:"text-white font-semibold",children:[R.automation.improvement.automationRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Compliance"}),t.jsxs("p",{className:"text-white font-semibold",children:[R.complianceRisk.currentScore.toFixed(1),"%"]})]})]})]})]}),t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Financial Impact"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-slate-300",children:"Time Savings Value"}),t.jsxs("span",{className:"text-white font-semibold",children:["$",(F.timeSavings.monetaryValue/1e6).toFixed(2),"M"]})]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600",style:{width:`${F.timeSavings.monetaryValue/F.totalROI*100}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-slate-300",children:"Error Reduction Value"}),t.jsxs("span",{className:"text-white font-semibold",children:["$",(F.errorReduction.monetaryValue/1e6).toFixed(2),"M"]})]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-600",style:{width:`${F.errorReduction.monetaryValue/F.totalROI*100}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-slate-300",children:"Compliance Value"}),t.jsxs("span",{className:"text-white font-semibold",children:["$",(F.complianceValue.monetaryValue/1e6).toFixed(2),"M"]})]}),t.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600",style:{width:`${F.complianceValue.monetaryValue/F.totalROI*100}%`}})})]}),t.jsx("div",{className:"pt-3 border-t border-slate-600",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-white font-semibold",children:"Net Benefit"}),t.jsxs("span",{className:"text-2xl font-bold text-emerald-400",children:["$",(F.netBenefit/1e6).toFixed(2),"M"]})]})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Avg TAT (Before)"}),t.jsxs("p",{className:"text-2xl font-bold text-red-400",children:[R.ticketTAT.beforeAIOps.averageTATHours.toFixed(1),"h"]})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Avg TAT (After)"}),t.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:[R.ticketTAT.afterAIOps.averageTATHours.toFixed(1),"h"]})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Manual Changes"}),t.jsx("p",{className:"text-2xl font-bold text-amber-400",children:R.automation.manual.count})]}),t.jsxs(b,{className:"p-4",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Automated Changes"}),t.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:R.automation.automated.count})]})]})]}),e==="tat"&&t.jsx("div",{className:"space-y-6",children:t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Ticket Turnaround Time Analysis"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[t.jsxs("div",{className:"p-6 bg-red-500/10 rounded-lg border border-red-500/30",children:[t.jsx("p",{className:"text-red-400 font-semibold mb-4",children:"Before AIOps"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Average TAT"}),t.jsxs("span",{className:"text-white font-bold",children:[R.ticketTAT.beforeAIOps.averageTATHours.toFixed(1)," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"P50 (Median)"}),t.jsxs("span",{className:"text-white font-bold",children:[R.ticketTAT.beforeAIOps.p50Hours," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"P95"}),t.jsxs("span",{className:"text-white font-bold",children:[R.ticketTAT.beforeAIOps.p95Hours," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Total Tickets"}),t.jsx("span",{className:"text-white font-bold",children:R.ticketTAT.beforeAIOps.totalTickets})]})]})]}),t.jsxs("div",{className:"p-6 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[t.jsx("p",{className:"text-emerald-400 font-semibold mb-4",children:"After AIOps"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Average TAT"}),t.jsxs("span",{className:"text-white font-bold",children:[R.ticketTAT.afterAIOps.averageTATHours.toFixed(1)," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"P50 (Median)"}),t.jsxs("span",{className:"text-white font-bold",children:[R.ticketTAT.afterAIOps.p50Hours," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"P95"}),t.jsxs("span",{className:"text-white font-bold",children:[R.ticketTAT.afterAIOps.p95Hours," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Total Tickets"}),t.jsx("span",{className:"text-white font-bold",children:R.ticketTAT.afterAIOps.totalTickets})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"p-4 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"TAT Reduction"}),t.jsxs("p",{className:"text-3xl font-bold text-cyan-400",children:[R.ticketTAT.improvement.percentageReduction.toFixed(1),"%"]})]}),t.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Hours Saved"}),t.jsx("p",{className:"text-3xl font-bold text-purple-400",children:R.ticketTAT.improvement.hoursSaved.toLocaleString()})]}),t.jsxs("div",{className:"p-4 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Tickets Accelerated"}),t.jsx("p",{className:"text-3xl font-bold text-amber-400",children:R.ticketTAT.improvement.ticketsAccelerated.toLocaleString()})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"TAT Trend Over Time"}),t.jsx("div",{className:"space-y-2",children:R.ticketTAT.trendData.map(r=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-slate-400 text-sm w-24",children:r.month}),t.jsxs("div",{className:"flex-1 flex gap-2",children:[r.beforeAIOps>0&&t.jsx("div",{className:"relative flex-1",children:t.jsx("div",{className:"h-8 bg-gradient-to-r from-red-500 to-red-600 rounded flex items-center justify-end px-3",style:{width:`${r.beforeAIOps/60*100}%`},children:t.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.beforeAIOps,"h"]})})}),r.afterAIOps>0&&t.jsx("div",{className:"relative flex-1",children:t.jsx("div",{className:"h-8 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded flex items-center justify-end px-3",style:{width:`${r.afterAIOps/60*100}%`},children:t.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.afterAIOps,"h"]})})})]}),t.jsxs("span",{className:"text-slate-400 text-sm w-20 text-right",children:[r.ticketCount," tickets"]})]},r.month))}),t.jsxs("div",{className:"flex gap-4 mt-4 justify-center",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-red-500 to-red-600 rounded"}),t.jsx("span",{className:"text-slate-400 text-sm",children:"Before AIOps"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded"}),t.jsx("span",{className:"text-slate-400 text-sm",children:"After AIOps"})]})]})]})]})}),e==="automation"&&t.jsx("div",{className:"space-y-6",children:t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Manual vs Automated Changes"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[t.jsxs("div",{className:"p-6 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[t.jsx("p",{className:"text-amber-400 font-semibold mb-4",children:"Manual Changes"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Total Count"}),t.jsx("span",{className:"text-white font-bold",children:R.automation.manual.count})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Avg Time"}),t.jsxs("span",{className:"text-white font-bold",children:[R.automation.manual.averageTimeHours," hours"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Error Rate"}),t.jsxs("span",{className:"text-white font-bold",children:[R.automation.manual.errorRate,"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Total Effort"}),t.jsxs("span",{className:"text-white font-bold",children:[R.automation.manual.totalEffort,"h"]})]})]})]}),t.jsxs("div",{className:"p-6 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsx("p",{className:"text-cyan-400 font-semibold mb-4",children:"Automated Changes"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Total Count"}),t.jsx("span",{className:"text-white font-bold",children:R.automation.automated.count})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Avg Time"}),t.jsxs("span",{className:"text-white font-bold",children:[R.automation.automated.averageTimeMinutes," minutes"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Error Rate"}),t.jsxs("span",{className:"text-white font-bold",children:[R.automation.automated.errorRate,"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-300",children:"Total Effort"}),t.jsxs("span",{className:"text-white font-bold",children:[R.automation.automated.totalEffort,"h"]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Automation Rate"}),t.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[R.automation.improvement.automationRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Time Savings"}),t.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:[R.automation.improvement.timeSavingsHours.toLocaleString(),"h"]})]}),t.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Error Reduction"}),t.jsxs("p",{className:"text-3xl font-bold text-blue-400",children:[R.automation.improvement.errorReduction.toFixed(1),"%"]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Automation by Category"}),t.jsx("div",{className:"space-y-3",children:R.automation.byCategory.map(r=>t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h4",{className:"text-white font-semibold",children:r.category}),t.jsxs("span",{className:"text-emerald-400 font-bold",children:[r.automationRate.toFixed(1),"% Automated"]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Manual"}),t.jsx("p",{className:"text-white font-semibold",children:r.manual})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Automated"}),t.jsx("p",{className:"text-white font-semibold",children:r.automated})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Time Saved"}),t.jsxs("p",{className:"text-white font-semibold",children:[r.timeSaved,"h"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-xs",children:"Total"}),t.jsx("p",{className:"text-white font-semibold",children:r.manual+r.automated})]})]}),t.jsx("div",{className:"mt-2 h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-600",style:{width:`${r.automationRate}%`}})})]},r.category))})]})]})}),e==="failures"&&t.jsx("div",{className:"space-y-6",children:t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Firewall Change Quality Metrics"}),t.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[t.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Changes"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:R.firewallChanges.totalChanges})]}),t.jsxs("div",{className:"p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Successful"}),t.jsx("p",{className:"text-3xl font-bold text-emerald-400",children:R.firewallChanges.successful})]}),t.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Failed"}),t.jsx("p",{className:"text-3xl font-bold text-red-400",children:R.firewallChanges.failed})]}),t.jsxs("div",{className:"p-4 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Failure Rate"}),t.jsxs("p",{className:"text-3xl font-bold text-amber-400",children:[R.firewallChanges.failureRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"MTTR"}),t.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:[R.firewallChanges.mttr.toFixed(1),"h"]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Failure Rate Trend"}),t.jsx("div",{className:"space-y-2",children:R.firewallChanges.trendData.map(r=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-slate-400 text-sm w-24",children:r.month}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsxs("span",{className:"text-slate-400",children:[r.totalChanges," changes"]}),t.jsxs("span",{className:"text-white",children:[r.failureRate.toFixed(1),"% failure rate"]})]}),t.jsx("div",{className:"h-6 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-end px-2",style:{width:`${r.failureRate*10}%`},children:t.jsx("span",{className:"text-white text-xs font-semibold",children:r.failures})})})]})]},r.month))})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Failure Root Causes"}),t.jsx("div",{className:"space-y-3",children:R.firewallChanges.failuresByReason.map(r=>t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h4",{className:"text-white font-semibold",children:r.reason}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"text-slate-400 text-sm",children:["Avg Resolution: ",r.avgResolutionTime,"h"]}),t.jsxs("span",{className:"text-red-400 font-bold",children:[r.count," failures"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600",style:{width:`${r.percentage}%`}})}),t.jsxs("span",{className:"text-white text-sm font-semibold w-16 text-right",children:[r.percentage.toFixed(1),"%"]})]})]},r.reason))})]}),t.jsxs("div",{className:"p-6 bg-slate-700/30 rounded-lg",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Failure Impact Analysis"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"p-3 bg-red-500/10 rounded border border-red-500/30",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"High Impact"}),t.jsx("p",{className:"text-2xl font-bold text-red-400",children:R.firewallChanges.impactAnalysis.highImpactFailures})]}),t.jsxs("div",{className:"p-3 bg-orange-500/10 rounded border border-orange-500/30",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Medium Impact"}),t.jsx("p",{className:"text-2xl font-bold text-orange-400",children:R.firewallChanges.impactAnalysis.mediumImpactFailures})]}),t.jsxs("div",{className:"p-3 bg-yellow-500/10 rounded border border-yellow-500/30",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Low Impact"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:R.firewallChanges.impactAnalysis.lowImpactFailures})]}),t.jsxs("div",{className:"p-3 bg-purple-500/10 rounded border border-purple-500/30",children:[t.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total Downtime"}),t.jsxs("p",{className:"text-2xl font-bold text-purple-400",children:[R.firewallChanges.impactAnalysis.totalDowntimeHours.toFixed(1),"h"]})]})]})]})]})}),e==="compliance"&&t.jsx("div",{className:"space-y-6",children:t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Compliance Risk Reduction"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[t.jsxs("div",{className:"p-6 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[t.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"Previous Score"}),t.jsxs("p",{className:"text-5xl font-bold text-white mb-4",children:[R.complianceRisk.previousScore.toFixed(1),"%"]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-slate-300",children:"Critical Issues"}),t.jsx("span",{className:"text-red-400 font-semibold",children:R.complianceRisk.riskReduction.criticalIssues.before})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-slate-300",children:"High Risk Issues"}),t.jsx("span",{className:"text-orange-400 font-semibold",children:R.complianceRisk.riskReduction.highRiskIssues.before})]})]})]}),t.jsxs("div",{className:"p-6 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[t.jsx("p",{className:"text-emerald-400 font-semibold mb-2",children:"Current Score"}),t.jsxs("p",{className:"text-5xl font-bold text-white mb-4",children:[R.complianceRisk.currentScore.toFixed(1),"%"]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-slate-300",children:"Critical Issues"}),t.jsx("span",{className:"text-emerald-400 font-semibold",children:R.complianceRisk.riskReduction.criticalIssues.after})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-slate-300",children:"High Risk Issues"}),t.jsx("span",{className:"text-cyan-400 font-semibold",children:R.complianceRisk.riskReduction.highRiskIssues.after})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Critical Issues Resolved"}),t.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[R.complianceRisk.riskReduction.criticalIssues.reduction.toFixed(0),"%"]}),t.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[R.complianceRisk.riskReduction.criticalIssues.before,"  ",R.complianceRisk.riskReduction.criticalIssues.after]})]}),t.jsxs("div",{className:"p-4 bg-orange-500/10 rounded-lg border border-orange-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"High Risk Resolved"}),t.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[R.complianceRisk.riskReduction.highRiskIssues.reduction.toFixed(0),"%"]}),t.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[R.complianceRisk.riskReduction.highRiskIssues.before,"  ",R.complianceRisk.riskReduction.highRiskIssues.after]})]}),t.jsxs("div",{className:"p-4 bg-amber-500/10 rounded-lg border border-amber-500/30",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Medium Risk Resolved"}),t.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[R.complianceRisk.riskReduction.mediumRiskIssues.reduction.toFixed(0),"%"]}),t.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[R.complianceRisk.riskReduction.mediumRiskIssues.before,"  ",R.complianceRisk.riskReduction.mediumRiskIssues.after]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"Compliance by Framework"}),t.jsx("div",{className:"space-y-3",children:R.complianceRisk.byFramework.map(r=>t.jsxs("div",{className:"p-4 bg-slate-700/30 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h4",{className:"text-white font-semibold",children:r.framework}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"text-emerald-400 font-bold",children:["+",r.improvement.toFixed(1),"%"]}),t.jsxs("span",{className:"text-slate-400 text-sm",children:[r.issuesResolved," issues resolved"]})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-slate-400 text-sm w-20",children:"Before:"}),t.jsx("div",{className:"flex-1 h-6 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-amber-600 flex items-center justify-end px-3",style:{width:`${r.previousScore}%`},children:t.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.previousScore.toFixed(1),"%"]})})})]}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsx("span",{className:"text-slate-400 text-sm w-20",children:"After:"}),t.jsx("div",{className:"flex-1 h-6 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600 flex items-center justify-end px-3",style:{width:`${r.currentScore}%`},children:t.jsxs("span",{className:"text-white text-xs font-semibold",children:[r.currentScore.toFixed(1),"%"]})})})]})]},r.framework))})]}),t.jsxs("div",{className:"p-6 bg-gradient-to-r from-emerald-500/10 to-cyan-500/10 rounded-lg border border-emerald-500/30",children:[t.jsx("h3",{className:"text-white font-semibold mb-4",children:"Estimated Financial Impact"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Potential Fines Saved"}),t.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:["$",(R.complianceRisk.estimatedFinancialImpact.potentialFinesSaved/1e6).toFixed(2),"M"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Audit Cost Reduction"}),t.jsxs("p",{className:"text-2xl font-bold text-cyan-400",children:["$",(R.complianceRisk.estimatedFinancialImpact.auditCostReduction/1e3).toFixed(0),"K"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Incident Cost Avoidance"}),t.jsxs("p",{className:"text-2xl font-bold text-blue-400",children:["$",(R.complianceRisk.estimatedFinancialImpact.incidentCostAvoidance/1e6).toFixed(2),"M"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Value"}),t.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",(R.complianceRisk.estimatedFinancialImpact.totalValue/1e6).toFixed(2),"M"]})]})]})]})]})}),e==="roi"&&t.jsx("div",{className:"space-y-6",children:t.jsxs(b,{className:"p-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Return on Investment Analysis"}),t.jsxs("div",{className:"p-8 bg-gradient-to-r from-emerald-500/20 to-cyan-500/20 rounded-lg border-2 border-emerald-500/50 mb-6",children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsx("p",{className:"text-slate-300 text-lg mb-2",children:"Total ROI"}),t.jsxs("p",{className:"text-6xl font-bold text-white mb-2",children:[F.roiPercentage.toFixed(0),"%"]}),t.jsxs("p",{className:"text-emerald-400 text-xl font-semibold",children:["$",(F.netBenefit/1e6).toFixed(2),"M Net Benefit"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{className:"text-center p-4 bg-slate-800/50 rounded-lg",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Investment"}),t.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",(F.costOfAIOps/1e3).toFixed(0),"K"]})]}),t.jsxs("div",{className:"text-center p-4 bg-slate-800/50 rounded-lg",children:[t.jsx("p",{className:"text-slate-400 text-sm mb-1",children:"Total Value"}),t.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:["$",(F.totalROI/1e6).toFixed(2),"M"]})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-white font-semibold",children:"Value Breakdown"}),t.jsxs("div",{className:"p-6 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-emerald-400 font-semibold mb-1",children:"Time Savings Value"}),t.jsxs("p",{className:"text-slate-400 text-sm",children:[F.timeSavings.hours.toLocaleString()," hours saved"]})]}),t.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(F.timeSavings.monetaryValue/1e6).toFixed(2),"M"]})]}),t.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600",style:{width:`${F.timeSavings.monetaryValue/F.totalROI*100}%`}})}),t.jsxs("p",{className:"text-slate-400 text-xs mt-2",children:[(F.timeSavings.monetaryValue/F.totalROI*100).toFixed(1),"% of total value"]})]}),t.jsxs("div",{className:"p-6 bg-cyan-500/10 rounded-lg border border-cyan-500/30",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-cyan-400 font-semibold mb-1",children:"Error Reduction Value"}),t.jsxs("p",{className:"text-slate-400 text-sm",children:[F.errorReduction.incidents," incidents avoided"]})]}),t.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(F.errorReduction.monetaryValue/1e6).toFixed(2),"M"]})]}),t.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 to-cyan-600",style:{width:`${F.errorReduction.monetaryValue/F.totalROI*100}%`}})}),t.jsxs("p",{className:"text-slate-400 text-xs mt-2",children:[(F.errorReduction.monetaryValue/F.totalROI*100).toFixed(1),"% of total value"]})]}),t.jsxs("div",{className:"p-6 bg-purple-500/10 rounded-lg border border-purple-500/30",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-purple-400 font-semibold mb-1",children:"Compliance Value"}),t.jsxs("p",{className:"text-slate-400 text-sm",children:[F.complianceValue.riskReduction.toFixed(1),"% risk reduction"]})]}),t.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",(F.complianceValue.monetaryValue/1e6).toFixed(2),"M"]})]}),t.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600",style:{width:`${F.complianceValue.monetaryValue/F.totalROI*100}%`}})}),t.jsxs("p",{className:"text-slate-400 text-xs mt-2",children:[(F.complianceValue.monetaryValue/F.totalROI*100).toFixed(1),"% of total value"]})]})]})]})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs(M,{variant:"ghost",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(M,{variant:"secondary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),t.jsxs(M,{variant:"primary",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export to PDF"]})]})]})]})},Gf=({activeView:e,onNavigate:s})=>{if(e==="dashboard")return t.jsx(Hg,{onNavigate:s});const r={opsvalue:Vf,compliance:ox,monitoring:Nx,dependencymap:Sx,incidents:Ax,cloudmanagement:Ex,multicloudvisibility:t1,pathanalysis:o1,pathanalysisenhanced:x1,routeintelligence:f1,tickets:w1,statusboard:j1,l1whitelisting:J1,rulegenerator:af,validation:cf,conflicts:mf,settings:Rf}[e];return r?t.jsx(r,{}):t.jsx(Hf,{})},Hf=()=>t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-slate-400",children:"View not found"})}),Ff=()=>{const{activeView:e,viewInfo:s,setActiveView:a}=Sh(),[r,n]=kh(!1),[o]=f.useState(3);return t.jsx(wh,{menuItems:Pm,activeView:e,viewInfo:s,sidebarCollapsed:r,notifications:o,onViewChange:a,onToggleSidebar:n,children:t.jsx(Gf,{activeView:e,onNavigate:a})})},Wf=Qn.createRoot(document.getElementById("root"));Wf.render(t.jsx(c0.StrictMode,{children:t.jsx(Ff,{})}));

/**
 * Mock data for Rule Validation Dashboard
 */

import type {
  ValidationHistory,
  ValidationMetrics,
  ValidationBestPractice,
  ValidationIssue,
  ValidationMessage,
  ValidationDashboardData,
} from '../types/validation';

export const validationMetrics: ValidationMetrics = {
  totalValidations: 1247,
  successfulValidations: 982,
  failedValidations: 265,
  totalIssues: 1834,
  errorCount: 345,
  warningCount: 876,
  infoCount: 613,
  avgSyntaxScore: 87.5,
  avgSecurityScore: 82.3,
  avgComplianceScore: 91.2,
  topPlatform: 'aws',
  lastValidation: '2024-01-19T15:23:45Z',
};

export const recentValidations: ValidationHistory[] = [
  {
    id: 'VAL-2024-001',
    timestamp: '2024-01-19T15:23:45Z',
    platform: 'aws',
    ruleCount: 12,
    issueCount: 3,
    isValid: true,
    snippet: 'aws ec2 authorize-security-group-ingress --group-id sg-12345678 --protocol tcp --port 443...',
  },
  {
    id: 'VAL-2024-002',
    timestamp: '2024-01-19T14:45:12Z',
    platform: 'palo_alto',
    ruleCount: 8,
    issueCount: 0,
    isValid: true,
    snippet: 'set rulebase security rules "Allow-HTTPS" from untrust to trust...',
  },
  {
    id: 'VAL-2024-003',
    timestamp: '2024-01-19T13:12:33Z',
    platform: 'cisco_asa',
    ruleCount: 15,
    issueCount: 7,
    isValid: false,
    snippet: 'access-list outside_access_in extended permit tcp 0.0.0.0 0.0.0.0 any eq 22...',
  },
  {
    id: 'VAL-2024-004',
    timestamp: '2024-01-19T11:30:21Z',
    platform: 'azure',
    ruleCount: 10,
    issueCount: 2,
    isValid: true,
    snippet: 'az network nsg rule create --resource-group myRG --nsg-name myNSG...',
  },
  {
    id: 'VAL-2024-005',
    timestamp: '2024-01-19T10:15:50Z',
    platform: 'gcp',
    ruleCount: 6,
    issueCount: 1,
    isValid: true,
    snippet: 'gcloud compute firewall-rules create allow-https --network=my-vpc...',
  },
  {
    id: 'VAL-2024-006',
    timestamp: '2024-01-19T09:22:14Z',
    platform: 'fortinet',
    ruleCount: 20,
    issueCount: 12,
    isValid: false,
    snippet: 'config firewall policy edit 1 set srcaddr "all" set dstaddr "all"...',
  },
  {
    id: 'VAL-2024-007',
    timestamp: '2024-01-19T08:45:38Z',
    platform: 'iptables',
    ruleCount: 25,
    issueCount: 5,
    isValid: true,
    snippet: 'iptables -A INPUT -p tcp --dport 443 -j ACCEPT...',
  },
  {
    id: 'VAL-2024-008',
    timestamp: '2024-01-19T07:30:19Z',
    platform: 'aws',
    ruleCount: 18,
    issueCount: 9,
    isValid: false,
    snippet: 'aws ec2 authorize-security-group-ingress --group-id sg-98765432 --cidr 0.0.0.0/0...',
  },
];

export const validationBestPractices: ValidationBestPractice[] = [
  {
    id: 'BP-001',
    title: 'Avoid Allowing Traffic from 0.0.0.0/0 (Any)',
    description: 'Opening ports to the entire internet (0.0.0.0/0) exposes your infrastructure to potential attacks. Restrict access to known IP ranges.',
    category: 'security',
    severity: 'error',
    examples: {
      bad: 'aws ec2 authorize-security-group-ingress --cidr 0.0.0.0/0 --port 22',
      good: 'aws ec2 authorize-security-group-ingress --cidr 10.0.0.0/8 --port 22',
      explanation: 'SSH (port 22) should only be accessible from trusted IP ranges, not the entire internet. Use VPN or bastion hosts for remote access.',
    },
    platforms: ['aws', 'azure', 'gcp', 'palo_alto', 'cisco_asa', 'fortinet', 'iptables'],
  },
  {
    id: 'BP-002',
    title: 'Use Specific Protocols Instead of "any"',
    description: 'Specifying exact protocols (TCP, UDP, ICMP) provides better security and makes rules easier to understand and audit.',
    category: 'best_practice',
    severity: 'warning',
    examples: {
      bad: 'access-list ACL_IN extended permit ip any any',
      good: 'access-list ACL_IN extended permit tcp 10.0.0.0 255.0.0.0 any eq 443',
      explanation: 'Using "any" protocol allows all traffic types. Specify TCP/UDP with exact ports for better security control.',
    },
    platforms: ['cisco_asa', 'palo_alto', 'fortinet'],
  },
  {
    id: 'BP-003',
    title: 'Explicitly Deny All at End of Rules',
    description: 'Always end your rule set with an explicit deny-all rule to ensure default-deny posture.',
    category: 'security',
    severity: 'warning',
    examples: {
      bad: 'iptables -A INPUT -p tcp --dport 443 -j ACCEPT\niptables -A INPUT -p tcp --dport 80 -j ACCEPT',
      good: 'iptables -A INPUT -p tcp --dport 443 -j ACCEPT\niptables -A INPUT -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -j DROP',
      explanation: 'Without explicit deny-all, default policy may allow unintended traffic. Always add final deny/drop rule.',
    },
    platforms: ['iptables', 'cisco_asa', 'palo_alto'],
  },
  {
    id: 'BP-004',
    title: 'Restrict Database Ports to Application Tier Only',
    description: 'Database ports (3306, 5432, 1433, etc.) should only be accessible from application servers, never from the internet.',
    category: 'security',
    severity: 'error',
    examples: {
      bad: 'aws ec2 authorize-security-group-ingress --port 3306 --cidr 0.0.0.0/0',
      good: 'aws ec2 authorize-security-group-ingress --port 3306 --source-group sg-app-tier',
      explanation: 'Exposing database ports to the internet is a critical security risk. Use security groups or IP restrictions.',
    },
    platforms: ['aws', 'azure', 'gcp'],
  },
  {
    id: 'BP-005',
    title: 'Use Descriptive Rule Names and Comments',
    description: 'Clear rule names and comments make firewall policies easier to manage, audit, and troubleshoot.',
    category: 'best_practice',
    severity: 'info',
    examples: {
      bad: 'set rulebase security rules "rule1" action allow',
      good: 'set rulebase security rules "Allow-Web-From-LB" description "HTTPS from load balancer to web tier" action allow',
      explanation: 'Descriptive names help teams understand rule purpose without analyzing every detail.',
    },
    platforms: ['palo_alto', 'fortinet', 'cisco_asa'],
  },
  {
    id: 'BP-006',
    title: 'Use Named Port Numbers',
    description: 'Reference well-known services by name (https, ssh, mysql) instead of numbers for better readability.',
    category: 'best_practice',
    severity: 'info',
    examples: {
      bad: 'az network nsg rule create --destination-port-ranges 443',
      good: 'az network nsg rule create --destination-port-ranges https',
      explanation: 'Named services are more readable and some platforms provide additional validation.',
    },
    platforms: ['azure', 'gcp', 'palo_alto'],
  },
  {
    id: 'BP-007',
    title: 'Implement Egress Filtering',
    description: 'Control outbound traffic as well as inbound. Egress filtering prevents data exfiltration and lateral movement.',
    category: 'security',
    severity: 'warning',
    examples: {
      bad: '# Only inbound rules defined\niptables -A INPUT -p tcp --dport 443 -j ACCEPT',
      good: '# Both ingress and egress\niptables -A INPUT -p tcp --dport 443 -j ACCEPT\niptables -A OUTPUT -p tcp --dport 443 -d trusted-apis.com -j ACCEPT\niptables -A OUTPUT -j DROP',
      explanation: 'Egress filtering prevents compromised servers from connecting to attacker infrastructure.',
    },
    platforms: ['iptables', 'aws', 'azure', 'gcp', 'palo_alto'],
  },
  {
    id: 'BP-008',
    title: 'Regular Rule Audits and Cleanup',
    description: 'Periodically review firewall rules to remove unused or outdated entries that accumulate over time.',
    category: 'best_practice',
    severity: 'info',
    examples: {
      bad: '# 500 rules accumulated over 3 years, many unused',
      good: '# Quarterly audit: disabled 45 unused rules, removed 23 obsolete rules, consolidated 12 duplicates',
      explanation: 'Rule bloat makes policies harder to manage and can hide security issues. Regular cleanup is essential.',
    },
    platforms: ['aws', 'azure', 'gcp', 'palo_alto', 'cisco_asa', 'fortinet'],
  },
];

export const commonIssues: ValidationIssue[] = [
  {
    id: 'ISSUE-001',
    line: 3,
    column: 45,
    severity: 'error',
    category: 'security',
    message: 'SSH port 22 open to internet (0.0.0.0/0)',
    suggestion: 'Restrict SSH access to specific IP ranges or use VPN. Replace 0.0.0.0/0 with trusted CIDR blocks.',
    ruleId: 'SEC-SSH-001',
  },
  {
    id: 'ISSUE-002',
    line: 7,
    column: 23,
    severity: 'error',
    category: 'security',
    message: 'Database port 3306 (MySQL) exposed to internet',
    suggestion: 'Database ports should only be accessible from application tier. Use security group references or private subnets.',
    ruleId: 'SEC-DB-001',
  },
  {
    id: 'ISSUE-003',
    line: 12,
    severity: 'warning',
    category: 'best_practice',
    message: 'Using "any" for protocol - consider specifying TCP/UDP',
    suggestion: 'Replace "any" with specific protocol (tcp, udp, icmp) for better security control.',
    ruleId: 'BP-PROTO-001',
  },
  {
    id: 'ISSUE-004',
    line: 15,
    severity: 'error',
    category: 'syntax',
    message: 'Invalid CIDR notation: 10.0.0.256/24',
    suggestion: 'IP octets must be 0-255. Change to valid IP address like 10.0.0.0/24.',
    ruleId: 'SYN-CIDR-001',
  },
  {
    id: 'ISSUE-005',
    line: 18,
    column: 67,
    severity: 'warning',
    category: 'security',
    message: 'Overly broad source range 0.0.0.0/0 for production service',
    suggestion: 'Restrict source to known client IP ranges or use CloudFront/CDN origin restrictions.',
    ruleId: 'SEC-BROAD-001',
  },
  {
    id: 'ISSUE-006',
    line: 22,
    severity: 'info',
    category: 'best_practice',
    message: 'Consider adding rule description for maintainability',
    suggestion: 'Add --description parameter to document the purpose of this rule.',
    ruleId: 'BP-DESC-001',
  },
  {
    id: 'ISSUE-007',
    line: 28,
    severity: 'warning',
    category: 'compliance',
    message: 'Rule violates PCI-DSS requirement 1.2.1 - missing explicit deny',
    suggestion: 'Add explicit deny-all rule at end of policy to ensure default-deny posture.',
    ruleId: 'COMP-PCI-001',
  },
  {
    id: 'ISSUE-008',
    line: 35,
    column: 12,
    severity: 'error',
    category: 'syntax',
    message: 'Missing required parameter: --protocol',
    suggestion: 'Add --protocol parameter (tcp, udp, icmp, or -1 for all).',
    ruleId: 'SYN-PARAM-001',
  },
];

export const validationMessages: ValidationMessage[] = [
  {
    id: 'MSG-001',
    type: 'warning',
    title: 'High Volume of Security Violations Detected',
    message: 'In the last 24 hours, 34% of validations contained security violations (primarily SSH and RDP exposure to internet). Consider implementing automated security scanning in CI/CD.',
    timestamp: '2024-01-19T15:00:00Z',
    dismissible: true,
    actionLabel: 'View Security Report',
    actionUrl: '#security-report',
  },
  {
    id: 'MSG-002',
    type: 'success',
    title: 'Validation Success Rate Improved',
    message: 'Validation success rate increased from 75% to 79% this week. Great progress on firewall rule quality!',
    timestamp: '2024-01-19T14:30:00Z',
    dismissible: true,
  },
  {
    id: 'MSG-003',
    type: 'info',
    title: 'New Best Practice Guide Available',
    message: 'Updated AWS Security Group best practices guide now includes VPC endpoint patterns and IMDSv2 requirements.',
    timestamp: '2024-01-19T13:00:00Z',
    dismissible: true,
    actionLabel: 'Read Guide',
    actionUrl: '#best-practices',
  },
  {
    id: 'MSG-004',
    type: 'error',
    title: 'Critical: Production Rules Failed Validation',
    message: '3 production firewall rules failed validation with critical security issues. Immediate review required.',
    timestamp: '2024-01-19T12:45:00Z',
    dismissible: false,
    actionLabel: 'Review Now',
    actionUrl: '#critical-issues',
  },
  {
    id: 'MSG-005',
    type: 'info',
    title: 'Platform Support Update',
    message: 'Added support for Fortinet FortiGate v7.2 firewall policy validation with enhanced security checks.',
    timestamp: '2024-01-19T10:00:00Z',
    dismissible: true,
  },
];

export const validationDashboardData: ValidationDashboardData = {
  recentValidations,
  metrics: validationMetrics,
  bestPractices: validationBestPractices,
  commonIssues,
  messages: validationMessages,
};

/**
 * Audit Report Mock Data
 */

import type { AuditReport } from '../types/complianceEnhanced';

export const auditReport: AuditReport = {
  id: 'audit-2024-01',
  reportType: 'comprehensive',
  generatedAt: '2024-01-19T14:00:00Z',
  period: {
    from: '2024-01-01T00:00:00Z',
    to: '2024-01-19T23:59:59Z',
  },
  summary: {
    totalFirewalls: 12,
    firewallsWithDrift: 3,
    totalNSGViolations: 47,
    criticalViolations: 8,
    expiredWhitelists: 15,
    unpatchedFirewalls: 3,
    autoRemediationAvailable: 28,
    complianceScore: 78,
    byFramework: {
      'PCI-DSS': {
        score: 82,
        passed: 47,
        failed: 11,
        status: 'partial',
      },
      'SOC2': {
        score: 88,
        passed: 52,
        failed: 7,
        status: 'partial',
      },
      'CIS AWS': {
        score: 75,
        passed: 38,
        failed: 12,
        status: 'partial',
      },
      'NIST 800-53': {
        score: 91,
        passed: 64,
        failed: 6,
        status: 'compliant',
      },
      'ISO 27001': {
        score: 85,
        passed: 45,
        failed: 8,
        status: 'partial',
      },
    },
  },
  findings: [
    {
      id: 'finding-001',
      category: 'Firewall Policy Drift',
      severity: 'critical',
      finding: 'PA-DC-FW-01: Unauthorized RDP access rule from internet detected',
      evidence: [
        'Rule "Allow-RDP-All" permits TCP/3389 from 0.0.0.0/0',
        'Added on 2024-01-18 14:30 UTC without change request',
        'Violates PCI-DSS Requirement 1.3.2',
        'Violates CIS AWS Benchmark 5.2',
      ],
      remediation: 'Remove unauthorized RDP rule and restrict management access to corporate VPN range (10.0.0.0/24). Create change ticket for audit trail.',
      status: 'open',
    },
    {
      id: 'finding-002',
      category: 'Cloud NSG Violations',
      severity: 'critical',
      finding: 'AWS Security Group sg-0123456789abcdef0: SSH exposed to entire internet',
      evidence: [
        'Security group "prod-web-sg" allows TCP/22 from 0.0.0.0/0',
        'Production workload exposure to brute force attacks',
        'VPC Flow Logs show legitimate SSH only from 10.0.0.0/8',
        'Violates AWS Security Best Practices',
      ],
      remediation: 'Update security group ingress rule to restrict SSH access to corporate VPN range (10.0.0.0/8). Verify connectivity post-change.',
      status: 'in_progress',
    },
    {
      id: 'finding-003',
      category: 'Unpatched Firewalls',
      severity: 'critical',
      finding: 'PA-DC-FW-01: Running outdated version with 2 critical CVEs',
      evidence: [
        'Current version: 10.1.9 (45 days outdated)',
        'CVE-2023-12345: Remote code execution in management interface (CVSS 9.8)',
        'CVE-2023-54321: Authentication bypass in web UI (CVSS 8.1)',
        'Exploits publicly available for CVE-2023-12345',
      ],
      remediation: 'Schedule emergency maintenance to upgrade to version 10.1.14. Patch addresses all known critical vulnerabilities. Maintenance window: 2024-01-27 02:00 UTC.',
      status: 'open',
    },
    {
      id: 'finding-004',
      category: 'Expired Whitelists',
      severity: 'high',
      finding: '15 firewall rules expired and still active in production',
      evidence: [
        'INC0012345: Temp-Partner-API-Access expired 19 days ago (no recent usage)',
        'CHG0034567: Q4-Vendor-FTP-Access expired 19 days ago (still in active use)',
        '13 additional expired rules identified across multiple firewalls',
        'Average expiration overage: 14 days',
      ],
      remediation: 'Implement automated expiration checking. Remove unused expired rules (8 identified). Extend or replace actively-used expired rules (7 identified). Notify requesters for business validation.',
      status: 'open',
    },
    {
      id: 'finding-005',
      category: 'Cloud NSG Violations',
      severity: 'high',
      finding: 'Azure NSG prod-db-nsg: Database access overly permissive',
      evidence: [
        'MySQL port 3306 accessible from entire /16 range (172.16.0.0/16)',
        'Baseline requires access limited to application tier subnets only',
        'Flow logs confirm traffic only from 172.16.10.0/24 and 172.16.11.0/24',
        'Violates PCI-DSS Requirement 1.3.2',
      ],
      remediation: 'Update NSG rule to restrict MySQL access to approved application subnets: 172.16.10.0/24, 172.16.11.0/24. Test application connectivity. Monitor for connection failures.',
      status: 'open',
    },
    {
      id: 'finding-006',
      category: 'Firewall Rule Hit Count',
      severity: 'medium',
      finding: '7 unused firewall rules identified across fleet',
      evidence: [
        'PA-DC-FW-01: Legacy-App-Access (0 hits, 310 days active)',
        'FGT-DMZ-01: Holiday-Sales-Promo (0 hits, 49 days active)',
        '5 additional rules with zero hit count',
        'Combined: 357 days of unused rule-base complexity',
      ],
      remediation: 'Remove unused rules to reduce policy complexity and improve firewall performance. Auto-removal available for rules with zero usage and no business justification.',
      status: 'open',
    },
    {
      id: 'finding-007',
      category: 'Cloud NSG Violations',
      severity: 'high',
      finding: 'GCP Firewall dev-allow-all: Overly permissive development environment',
      evidence: [
        'Firewall rule permits all protocols/ports from internet to dev environment',
        'Development VPC (10.10.0.0/16) exposed to unnecessary risk',
        'Violates principle of least privilege',
        'GCP CIS Benchmark 3.7 violation',
      ],
      remediation: 'Audit actual development usage patterns. Create specific rules for required protocols (SSH/HTTP/HTTPS). Restrict sources to developer VPN range. Remove overly permissive rule.',
      status: 'open',
    },
    {
      id: 'finding-008',
      category: 'Firewall Policy Drift',
      severity: 'medium',
      finding: 'ASA-BRANCH-01: Configuration drift from baseline detected',
      evidence: [
        'New HTTPS rule added for third-party vendor access',
        'Rule not present in approved Branch Office Standard baseline v1.5.2',
        'Allows access to 192.168.100.0/24',
        'No associated change request found',
      ],
      remediation: 'Security team review required. If legitimate business need, update baseline and document exception. Otherwise, remove rule and notify requester.',
      status: 'open',
    },
    {
      id: 'finding-009',
      category: 'Unpatched Firewalls',
      severity: 'high',
      finding: 'ASA-BRANCH-01: VPN subsystem vulnerability unpatched',
      evidence: [
        'Current version: 9.16.3 (30 days outdated)',
        'CVE-2024-11111: Denial of service in VPN subsystem (CVSS 7.5)',
        'Patch available in version 9.16.4',
        'No maintenance window scheduled',
      ],
      remediation: 'Schedule maintenance window to upgrade to 9.16.5 (latest). Update risk: Medium. Coordinate with branch office for planned downtime.',
      status: 'open',
    },
    {
      id: 'finding-010',
      category: 'Firewall Policy Drift',
      severity: 'medium',
      finding: 'PA-DC-FW-01: Logging disabled for denied traffic',
      evidence: [
        'Baseline requires all denied traffic to be logged',
        'Current configuration: Logging disabled',
        'Creates gap in audit trail',
        'SOC2 CC6.1 non-compliance',
      ],
      remediation: 'Re-enable logging for denied traffic. Verify log retention meets compliance requirements. Create change ticket for audit documentation.',
      status: 'open',
    },
  ],
  recommendations: [
    'Implement automated drift detection with real-time alerting to catch unauthorized changes within minutes',
    'Enable auto-remediation for low-risk violations (unused rules, expired whitelists with no usage)',
    'Establish quarterly firewall patching cadence with emergency process for critical CVEs',
    'Deploy automated expiration enforcement for temporary whitelist rules',
    'Conduct monthly security group audits across all cloud providers',
    'Implement infrastructure-as-code for firewall configurations to prevent drift',
    'Enhance change management process to require approval before rule modifications',
    'Create compliance dashboard for real-time framework adherence monitoring',
  ],
  auditReadiness: 'needs_attention',
};

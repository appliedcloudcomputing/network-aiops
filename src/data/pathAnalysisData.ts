/**
 * Mock data for Path Analysis with graph-based visualization
 * Includes scenarios: Blocked hops, Asymmetric routing, Missing rules
 */

import type { PathGraphVisualization } from '../types/pathAnalysis';

// Scenario 1: Healthy path - Production to AWS
export const healthyPathData: PathGraphVisualization = {
  id: 'path-001',
  source: '10.100.5.10',
  destination: '52.94.76.50',
  health: 'healthy',
  hasReturnPath: true,
  issues: {
    blocked: 0,
    asymmetricRouting: 0,
    missingRules: 0,
    total: 0,
  },
  hops: [
    {
      hopNumber: 1,
      hopType: 'source',
      deviceName: 'App Server - prod-web-01',
      ipAddress: '10.100.5.10',
      hostname: 'prod-web-01.company.local',
      location: 'DC-US-EAST-1',
      asn: null,
      asnOrg: null,
      latency: [0.8, 0.9, 0.7],
      avgLatency: 0.8,
      minLatency: 0.7,
      maxLatency: 0.9,
      jitter: 0.1,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: null,
      issues: [],
      securityRules: [],
      returnPath: {
        hopNumber: 1,
        ipAddress: '10.100.5.10',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 2,
      hopType: 'router',
      deviceName: 'Core Router',
      ipAddress: '10.100.1.1',
      hostname: 'core-rtr-01.company.local',
      location: 'DC-US-EAST-1',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [2.1, 2.3, 2.0],
      avgLatency: 2.1,
      minLatency: 2.0,
      maxLatency: 2.3,
      jitter: 0.2,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: null,
      issues: [],
      returnPath: {
        hopNumber: 2,
        ipAddress: '10.100.1.1',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 3,
      hopType: 'firewall',
      deviceName: 'Production Edge Firewall',
      ipAddress: '10.100.0.1',
      hostname: 'fw-prod-edge-01.company.local',
      location: 'DC-US-EAST-1',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [4.5, 4.8, 4.3],
      avgLatency: 4.5,
      minLatency: 4.3,
      maxLatency: 4.8,
      jitter: 0.3,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'firewall',
      cloudProvider: null,
      issues: [],
      securityRules: [
        {
          id: 'rule-001',
          name: 'Allow-Outbound-HTTPS',
          action: 'allow',
          source: '10.100.0.0/16',
          destination: 'any',
          port: '443',
          protocol: 'tcp',
          priority: 100,
          matched: true,
        },
      ],
      returnPath: {
        hopNumber: 3,
        ipAddress: '10.100.0.1',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 4,
      hopType: 'cloud_gateway',
      deviceName: 'AWS Direct Connect',
      ipAddress: '169.254.1.1',
      hostname: 'dx-vif-aws.company.local',
      location: 'us-east-1',
      asn: 'AS16509',
      asnOrg: 'Amazon.com Inc.',
      latency: [8.2, 8.5, 8.1],
      avgLatency: 8.3,
      minLatency: 8.1,
      maxLatency: 8.5,
      jitter: 0.2,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: 'aws',
      region: 'us-east-1',
      issues: [],
      returnPath: {
        hopNumber: 4,
        ipAddress: '169.254.1.1',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 5,
      hopType: 'security_group',
      deviceName: 'App-Tier Security Group',
      ipAddress: '172.31.10.1',
      hostname: null,
      location: 'us-east-1a',
      asn: 'AS16509',
      asnOrg: 'Amazon.com Inc.',
      latency: [10.1, 10.4, 9.9],
      avgLatency: 10.1,
      minLatency: 9.9,
      maxLatency: 10.4,
      jitter: 0.3,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'firewall',
      cloudProvider: 'aws',
      region: 'us-east-1',
      issues: [],
      securityRules: [
        {
          id: 'sg-rule-001',
          name: 'Allow-Inbound-HTTPS',
          action: 'allow',
          source: '10.100.0.0/16',
          destination: '172.31.10.0/24',
          port: '443',
          protocol: 'tcp',
          priority: 100,
          matched: true,
        },
      ],
      returnPath: {
        hopNumber: 5,
        ipAddress: '172.31.10.1',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 6,
      hopType: 'destination',
      deviceName: 'AWS Application Server',
      ipAddress: '52.94.76.50',
      hostname: 'ec2-52-94-76-50.compute-1.amazonaws.com',
      location: 'us-east-1a',
      asn: 'AS16509',
      asnOrg: 'Amazon.com Inc.',
      latency: [12.3, 12.6, 12.1],
      avgLatency: 12.3,
      minLatency: 12.1,
      maxLatency: 12.6,
      jitter: 0.3,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: 'aws',
      region: 'us-east-1',
      issues: [],
      returnPath: {
        hopNumber: 6,
        ipAddress: '52.94.76.50',
        isSymmetric: true,
      },
    },
  ],
};

// Scenario 2: Blocked hop at firewall
export const blockedPathData: PathGraphVisualization = {
  id: 'path-002',
  source: '10.200.15.20',
  destination: '172.16.50.100',
  health: 'critical',
  hasReturnPath: false,
  issues: {
    blocked: 1,
    asymmetricRouting: 0,
    missingRules: 0,
    total: 1,
  },
  hops: [
    {
      hopNumber: 1,
      hopType: 'source',
      deviceName: 'UAT Server',
      ipAddress: '10.200.15.20',
      hostname: 'uat-app-02.company.local',
      location: 'DC-US-WEST-1',
      asn: null,
      asnOrg: null,
      latency: [0.9, 1.0, 0.8],
      avgLatency: 0.9,
      minLatency: 0.8,
      maxLatency: 1.0,
      jitter: 0.1,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: null,
      issues: [],
      securityRules: [],
    },
    {
      hopNumber: 2,
      hopType: 'router',
      deviceName: 'Distribution Router',
      ipAddress: '10.200.1.1',
      hostname: 'dist-rtr-02.company.local',
      location: 'DC-US-WEST-1',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [3.2, 3.5, 3.1],
      avgLatency: 3.3,
      minLatency: 3.1,
      maxLatency: 3.5,
      jitter: 0.2,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: null,
      issues: [],
    },
    {
      hopNumber: 3,
      hopType: 'firewall',
      deviceName: 'UAT Firewall',
      ipAddress: '10.200.0.1',
      hostname: 'fw-uat-01.company.local',
      location: 'DC-US-WEST-1',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [0, 0, 0],
      avgLatency: 0,
      minLatency: 0,
      maxLatency: 0,
      jitter: 0,
      packetLoss: 100,
      status: 'unreachable',
      deviceType: 'firewall',
      cloudProvider: null,
      issues: [
        {
          type: 'blocked',
          severity: 'critical',
          message: 'Traffic is being blocked by firewall rule',
          recommendation: 'Review firewall rules and add appropriate allow rule for this traffic',
          details: 'Deny rule at priority 50 is blocking TCP/443 traffic from 10.200.0.0/16 to 172.16.50.0/24',
        },
        {
          type: 'missing_rule',
          severity: 'high',
          message: 'No explicit allow rule found for this traffic',
          recommendation: 'Add allow rule: permit tcp 10.200.15.20 172.16.50.100 eq 443',
        },
      ],
      securityRules: [
        {
          id: 'rule-deny-001',
          name: 'Deny-UAT-to-Prod',
          action: 'deny',
          source: '10.200.0.0/16',
          destination: '172.16.0.0/16',
          port: 'any',
          protocol: 'any',
          priority: 50,
          matched: true,
        },
      ],
    },
  ],
};

// Scenario 3: Asymmetric routing detected
export const asymmetricPathData: PathGraphVisualization = {
  id: 'path-003',
  source: '10.100.20.30',
  destination: '13.82.100.50',
  health: 'degraded',
  hasReturnPath: true,
  issues: {
    blocked: 0,
    asymmetricRouting: 2,
    missingRules: 0,
    total: 2,
  },
  hops: [
    {
      hopNumber: 1,
      hopType: 'source',
      deviceName: 'Production DB Server',
      ipAddress: '10.100.20.30',
      hostname: 'prod-db-01.company.local',
      location: 'DC-US-EAST-1',
      asn: null,
      asnOrg: null,
      latency: [0.7, 0.8, 0.7],
      avgLatency: 0.7,
      minLatency: 0.7,
      maxLatency: 0.8,
      jitter: 0.1,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: null,
      issues: [],
      returnPath: {
        hopNumber: 1,
        ipAddress: '10.100.20.30',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 2,
      hopType: 'router',
      deviceName: 'Core Router Primary',
      ipAddress: '10.100.1.5',
      hostname: 'core-rtr-pri.company.local',
      location: 'DC-US-EAST-1',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [2.5, 2.7, 2.4],
      avgLatency: 2.5,
      minLatency: 2.4,
      maxLatency: 2.7,
      jitter: 0.2,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: null,
      issues: [
        {
          type: 'asymmetric_routing',
          severity: 'medium',
          message: 'Return path uses different router (core-rtr-sec)',
          recommendation: 'Verify routing policies and ensure symmetric routing for stateful connections',
          details: 'Forward: core-rtr-pri (10.100.1.5), Return: core-rtr-sec (10.100.1.6)',
        },
      ],
      returnPath: {
        hopNumber: 2,
        ipAddress: '10.100.1.6',
        isSymmetric: false,
        asymmetryReason: 'Return path uses secondary core router due to ECMP load balancing',
      },
    },
    {
      hopNumber: 3,
      hopType: 'firewall',
      deviceName: 'Production Firewall',
      ipAddress: '10.100.0.1',
      hostname: 'fw-prod-01.company.local',
      location: 'DC-US-EAST-1',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [5.2, 5.5, 5.1],
      avgLatency: 5.3,
      minLatency: 5.1,
      maxLatency: 5.5,
      jitter: 0.2,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'firewall',
      cloudProvider: null,
      issues: [],
      securityRules: [
        {
          id: 'rule-002',
          name: 'Allow-Azure-Access',
          action: 'allow',
          source: '10.100.0.0/16',
          destination: '13.0.0.0/8',
          port: '443',
          protocol: 'tcp',
          priority: 100,
          matched: true,
        },
      ],
      returnPath: {
        hopNumber: 3,
        ipAddress: '10.100.0.1',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 4,
      hopType: 'cloud_gateway',
      deviceName: 'Azure ExpressRoute',
      ipAddress: '169.254.2.1',
      hostname: 'er-vnet-azure.company.local',
      location: 'eastus',
      asn: 'AS8075',
      asnOrg: 'Microsoft Corporation',
      latency: [15.3, 15.8, 15.1],
      avgLatency: 15.4,
      minLatency: 15.1,
      maxLatency: 15.8,
      jitter: 0.4,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: 'azure',
      region: 'eastus',
      issues: [
        {
          type: 'asymmetric_routing',
          severity: 'medium',
          message: 'Return traffic routed through different ExpressRoute circuit',
          recommendation: 'Configure route preferences to ensure symmetric routing',
          details: 'Forward: Primary circuit, Return: Secondary circuit',
        },
      ],
      returnPath: {
        hopNumber: 4,
        ipAddress: '169.254.2.2',
        isSymmetric: false,
        asymmetryReason: 'Return path uses secondary ExpressRoute circuit for load distribution',
      },
    },
    {
      hopNumber: 5,
      hopType: 'nsg',
      deviceName: 'Database NSG',
      ipAddress: '10.50.20.1',
      hostname: null,
      location: 'eastus',
      asn: 'AS8075',
      asnOrg: 'Microsoft Corporation',
      latency: [18.2, 18.6, 18.0],
      avgLatency: 18.3,
      minLatency: 18.0,
      maxLatency: 18.6,
      jitter: 0.3,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'firewall',
      cloudProvider: 'azure',
      region: 'eastus',
      issues: [],
      securityRules: [
        {
          id: 'nsg-rule-001',
          name: 'Allow-Internal-DB',
          action: 'allow',
          source: '10.100.0.0/16',
          destination: '10.50.20.0/24',
          port: '1433',
          protocol: 'tcp',
          priority: 100,
          matched: false,
        },
        {
          id: 'nsg-rule-002',
          name: 'Allow-HTTPS',
          action: 'allow',
          source: 'any',
          destination: '10.50.20.0/24',
          port: '443',
          protocol: 'tcp',
          priority: 110,
          matched: true,
        },
      ],
      returnPath: {
        hopNumber: 5,
        ipAddress: '10.50.20.1',
        isSymmetric: true,
      },
    },
    {
      hopNumber: 6,
      hopType: 'destination',
      deviceName: 'Azure SQL Database',
      ipAddress: '13.82.100.50',
      hostname: 'sqldb-prod-01.database.windows.net',
      location: 'eastus',
      asn: 'AS8075',
      asnOrg: 'Microsoft Corporation',
      latency: [20.5, 20.9, 20.3],
      avgLatency: 20.6,
      minLatency: 20.3,
      maxLatency: 20.9,
      jitter: 0.3,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: 'azure',
      region: 'eastus',
      issues: [],
      returnPath: {
        hopNumber: 6,
        ipAddress: '13.82.100.50',
        isSymmetric: true,
      },
    },
  ],
};

// Scenario 4: Missing firewall rule (high latency fallback)
export const missingRulePathData: PathGraphVisualization = {
  id: 'path-004',
  source: '10.150.10.15',
  destination: '35.192.50.25',
  health: 'degraded',
  hasReturnPath: true,
  issues: {
    blocked: 0,
    asymmetricRouting: 0,
    missingRules: 1,
    total: 1,
  },
  hops: [
    {
      hopNumber: 1,
      hopType: 'source',
      deviceName: 'Dev Application Server',
      ipAddress: '10.150.10.15',
      hostname: 'dev-app-03.company.local',
      location: 'DC-US-WEST-2',
      asn: null,
      asnOrg: null,
      latency: [1.0, 1.1, 0.9],
      avgLatency: 1.0,
      minLatency: 0.9,
      maxLatency: 1.1,
      jitter: 0.1,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: null,
      issues: [],
    },
    {
      hopNumber: 2,
      hopType: 'router',
      deviceName: 'Access Router',
      ipAddress: '10.150.1.1',
      hostname: 'access-rtr-03.company.local',
      location: 'DC-US-WEST-2',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [3.8, 4.0, 3.7],
      avgLatency: 3.8,
      minLatency: 3.7,
      maxLatency: 4.0,
      jitter: 0.2,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: null,
      issues: [],
    },
    {
      hopNumber: 3,
      hopType: 'firewall',
      deviceName: 'Dev Firewall',
      ipAddress: '10.150.0.1',
      hostname: 'fw-dev-01.company.local',
      location: 'DC-US-WEST-2',
      asn: 'AS64512',
      asnOrg: 'Company Network',
      latency: [125.3, 128.5, 124.1],
      avgLatency: 126.0,
      minLatency: 124.1,
      maxLatency: 128.5,
      jitter: 2.2,
      packetLoss: 2.5,
      status: 'reachable',
      deviceType: 'firewall',
      cloudProvider: null,
      issues: [
        {
          type: 'missing_rule',
          severity: 'high',
          message: 'No explicit rule found - traffic falling back to default policy',
          recommendation: 'Add explicit allow rule to improve performance and security posture',
          details: 'Traffic is allowed by implicit default-allow but causing deep packet inspection delays',
        },
        {
          type: 'high_latency',
          severity: 'medium',
          message: 'High latency detected (126ms) - significantly above baseline',
          recommendation: 'Investigate firewall processing load and rule optimization',
        },
        {
          type: 'packet_loss',
          severity: 'low',
          message: 'Minor packet loss detected (2.5%)',
          recommendation: 'Monitor for persistent packet loss issues',
        },
      ],
      securityRules: [
        {
          id: 'rule-default',
          name: 'Default-Allow-All',
          action: 'allow',
          source: 'any',
          destination: 'any',
          port: 'any',
          protocol: 'any',
          priority: 9999,
          matched: true,
        },
      ],
    },
    {
      hopNumber: 4,
      hopType: 'cloud_gateway',
      deviceName: 'GCP Cloud Interconnect',
      ipAddress: '169.254.3.1',
      hostname: 'interconnect-gcp.company.local',
      location: 'us-west2',
      asn: 'AS15169',
      asnOrg: 'Google LLC',
      latency: [135.2, 136.1, 134.8],
      avgLatency: 135.4,
      minLatency: 134.8,
      maxLatency: 136.1,
      jitter: 0.7,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'router',
      cloudProvider: 'gcp',
      region: 'us-west2',
      issues: [],
    },
    {
      hopNumber: 5,
      hopType: 'destination',
      deviceName: 'GCP Compute Instance',
      ipAddress: '35.192.50.25',
      hostname: 'instance-1.us-west2-a.c.project-id.internal',
      location: 'us-west2-a',
      asn: 'AS15169',
      asnOrg: 'Google LLC',
      latency: [138.5, 139.2, 138.1],
      avgLatency: 138.6,
      minLatency: 138.1,
      maxLatency: 139.2,
      jitter: 0.6,
      packetLoss: 0,
      status: 'reachable',
      deviceType: 'server',
      cloudProvider: 'gcp',
      region: 'us-west2',
      issues: [],
    },
  ],
};

export const mockPathScenarios = {
  healthy: healthyPathData,
  blocked: blockedPathData,
  asymmetric: asymmetricPathData,
  missingRule: missingRulePathData,
};

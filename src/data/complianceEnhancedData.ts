/**
 * Enhanced Compliance Mock Data
 * Includes: Drift, Hit Counts, NSG Violations, Expired Whitelists, Unpatched Firewalls
 */

import type {
  FirewallPolicyDrift,
  FirewallRuleHitCount,
  CloudNSGViolation,
  ExpiredWhitelist,
  UnpatchedFirewall,
  ComplianceSummary,
} from '../types/complianceEnhanced';

// Firewall Policy Drift Data
export const firewallPolicyDrifts: FirewallPolicyDrift[] = [
  {
    id: 'drift-001',
    firewallName: 'PA-DC-FW-01',
    firewallId: 'pa-fw-001',
    vendor: 'palo_alto',
    location: 'us-east-1',
    status: 'critical_drift',
    baselineName: 'PCI-DSS Production Baseline',
    baselineVersion: '2.1.0',
    driftDetectedAt: '2024-01-18T14:30:00Z',
    driftItems: [
      {
        id: 'drift-item-001',
        type: 'rule_added',
        description: 'Unauthorized rule allowing RDP from internet',
        severity: 'critical',
        baseline: 'No RDP access from 0.0.0.0/0',
        current: 'RDP allowed from 0.0.0.0/0 on port 3389',
        impact: 'Critical security exposure - PCI-DSS violation',
      },
      {
        id: 'drift-item-002',
        type: 'rule_modified',
        description: 'Management access rule expanded beyond approved IPs',
        severity: 'high',
        baseline: 'Management access: 10.0.0.0/24',
        current: 'Management access: 0.0.0.0/0',
        impact: 'Increases attack surface for management interface',
      },
      {
        id: 'drift-item-003',
        type: 'config_changed',
        description: 'Logging disabled for denied traffic',
        severity: 'medium',
        baseline: 'Log all denied traffic',
        current: 'Logging disabled',
        impact: 'Audit trail incomplete - SOC2 non-compliance',
      },
    ],
    aiAnalysis: {
      violatesBaseline: ['PCI-DSS Requirement 1.3.2', 'CIS AWS 5.2', 'SOC2 CC6.1'],
      autoRemediationPossible: true,
      remediationSteps: [
        'Remove unauthorized RDP rule (id: rule-12345)',
        'Revert management access rule to 10.0.0.0/24',
        'Re-enable logging for denied traffic',
        'Create change ticket for audit trail',
      ],
      confidence: 0.95,
      reasoning: 'Changes detected are clear violations of baseline policy. All modifications can be automatically reverted without service disruption.',
      estimatedImpact: 'low',
    },
    remediationStatus: 'possible',
  },
  {
    id: 'drift-002',
    firewallName: 'ASA-BRANCH-01',
    firewallId: 'asa-001',
    vendor: 'cisco_asa',
    location: 'us-west-2',
    status: 'drift_detected',
    baselineName: 'Branch Office Standard',
    baselineVersion: '1.5.2',
    driftDetectedAt: '2024-01-19T09:15:00Z',
    driftItems: [
      {
        id: 'drift-item-004',
        type: 'rule_added',
        description: 'New HTTPS rule for third-party vendor',
        severity: 'medium',
        baseline: 'No third-party vendor access',
        current: 'HTTPS access to 192.168.100.0/24',
        impact: 'Requires approval from security team',
      },
    ],
    aiAnalysis: {
      violatesBaseline: ['Internal Policy Section 4.2.1'],
      autoRemediationPossible: false,
      confidence: 0.88,
      reasoning: 'Rule appears to be intentional for business need. Requires security team review before removal.',
      estimatedImpact: 'medium',
    },
    remediationStatus: 'manual_required',
  },
  {
    id: 'drift-003',
    firewallName: 'FGT-DMZ-01',
    firewallId: 'fgt-001',
    vendor: 'fortinet',
    location: 'eu-west-1',
    status: 'compliant',
    baselineName: 'DMZ Hardening Standard',
    baselineVersion: '3.0.1',
    driftDetectedAt: '2024-01-15T08:00:00Z',
    driftItems: [],
    aiAnalysis: {
      violatesBaseline: [],
      autoRemediationPossible: false,
      confidence: 1.0,
      reasoning: 'Configuration matches baseline perfectly. No violations detected.',
      estimatedImpact: 'low',
    },
    remediationStatus: 'completed',
  },
];

// Firewall Rule Hit Count Data
export const firewallRuleHitCounts: FirewallRuleHitCount[] = [
  {
    id: 'hitcount-001',
    firewallName: 'PA-DC-FW-01',
    firewallId: 'pa-fw-001',
    vendor: 'palo_alto',
    ruleName: 'Legacy-App-Access',
    ruleId: 'rule-54321',
    hitCount: 0,
    lastHit: null,
    createdAt: '2023-03-15T10:00:00Z',
    daysActive: 310,
    status: 'unused',
    recommendation: 'Rule has not been used in 310 days. Consider removing to reduce policy complexity.',
    autoRemediationPossible: true,
  },
  {
    id: 'hitcount-002',
    firewallName: 'PA-DC-FW-01',
    firewallId: 'pa-fw-001',
    vendor: 'palo_alto',
    ruleName: 'Temp-Contractor-VPN',
    ruleId: 'rule-67890',
    hitCount: 3,
    lastHit: '2023-11-20T15:30:00Z',
    createdAt: '2023-11-01T09:00:00Z',
    daysActive: 79,
    status: 'low_usage',
    recommendation: 'Low usage detected. Last hit 60 days ago. Verify if still needed.',
    autoRemediationPossible: false,
  },
  {
    id: 'hitcount-003',
    firewallName: 'ASA-BRANCH-01',
    firewallId: 'asa-001',
    vendor: 'cisco_asa',
    ruleName: 'Production-API-Gateway',
    ruleId: 'rule-11111',
    hitCount: 1547892,
    lastHit: '2024-01-19T12:45:00Z',
    createdAt: '2023-01-10T08:00:00Z',
    daysActive: 374,
    status: 'high_usage',
    recommendation: 'Critical production rule. Do not remove.',
    autoRemediationPossible: false,
  },
  {
    id: 'hitcount-004',
    firewallName: 'FGT-DMZ-01',
    firewallId: 'fgt-001',
    vendor: 'fortinet',
    ruleName: 'Holiday-Sales-Promo',
    ruleId: 'rule-22222',
    hitCount: 0,
    lastHit: null,
    createdAt: '2023-12-01T00:00:00Z',
    daysActive: 49,
    status: 'unused',
    recommendation: 'Promotional rule never used. Created for Black Friday event. Safe to remove.',
    autoRemediationPossible: true,
  },
  {
    id: 'hitcount-005',
    firewallName: 'CP-HQ-FW-01',
    firewallId: 'cp-001',
    vendor: 'checkpoint',
    ruleName: 'Test-Environment-Access',
    ruleId: 'rule-33333',
    hitCount: 1,
    lastHit: '2024-01-05T10:00:00Z',
    createdAt: '2024-01-05T09:55:00Z',
    daysActive: 14,
    status: 'low_usage',
    recommendation: 'Test rule with minimal usage. Validate if still required.',
    autoRemediationPossible: false,
  },
];

// Cloud NSG Violations Data
export const cloudNSGViolations: CloudNSGViolation[] = [
  {
    id: 'violation-001',
    provider: 'aws',
    resourceType: 'security_group',
    resourceName: 'prod-web-sg',
    resourceId: 'sg-0123456789abcdef0',
    region: 'us-east-1',
    accountId: '123456789012',
    violationType: 'open_to_internet',
    severity: 'critical',
    description: 'Security group allows SSH access from entire internet',
    detectedAt: '2024-01-19T08:00:00Z',
    affectedRules: [
      {
        ruleId: 'sgr-001',
        ruleName: 'Allow SSH',
        protocol: 'tcp',
        sourceRange: '0.0.0.0/0',
        destinationRange: 'sg-0123456789abcdef0',
        portRange: '22',
        action: 'allow',
        issue: 'SSH exposed to internet - brute force risk',
      },
    ],
    baselineViolation: {
      baselineName: 'AWS Production Security Baseline',
      requirement: 'SSH access must be restricted to corporate VPN range',
      expectedValue: '10.0.0.0/8',
      actualValue: '0.0.0.0/0',
      complianceFramework: ['CIS AWS 5.2', 'NIST 800-53 AC-4'],
    },
    aiRemediation: {
      autoRemediationPossible: true,
      remediationPlan: [
        'Identify legitimate SSH source IPs from VPC Flow Logs',
        'Update security group rule to restrict to 10.0.0.0/8',
        'Verify connectivity after change',
        'Document change in CMDB',
      ],
      estimatedTime: '5 minutes',
      riskLevel: 'low',
      reasoning: 'SSH restriction is standard security practice. VPC Flow Logs show all legitimate access comes from corporate VPN range.',
    },
  },
  {
    id: 'violation-002',
    provider: 'azure',
    resourceType: 'nsg',
    resourceName: 'prod-db-nsg',
    resourceId: '/subscriptions/xxx/resourceGroups/prod-rg/providers/Microsoft.Network/networkSecurityGroups/prod-db-nsg',
    region: 'eastus',
    accountId: 'sub-12345',
    violationType: 'unauthorized_port',
    severity: 'high',
    description: 'Database port exposed to wider range than approved',
    detectedAt: '2024-01-18T16:30:00Z',
    affectedRules: [
      {
        ruleId: 'nsg-rule-001',
        ruleName: 'Allow-MySQL',
        protocol: 'tcp',
        sourceRange: '172.16.0.0/16',
        destinationRange: '10.1.2.0/24',
        portRange: '3306',
        action: 'allow',
        issue: 'Source range exceeds approved application subnets',
      },
    ],
    baselineViolation: {
      baselineName: 'Azure Database Security Standard',
      requirement: 'Database access restricted to application tier only',
      expectedValue: '172.16.10.0/24, 172.16.11.0/24',
      actualValue: '172.16.0.0/16',
      complianceFramework: ['PCI-DSS 1.3.2', 'Azure CIS 6.4'],
    },
    aiRemediation: {
      autoRemediationPossible: true,
      remediationPlan: [
        'Replace broad /16 range with specific application subnets',
        'Update NSG rule to: 172.16.10.0/24, 172.16.11.0/24',
        'Test application connectivity',
        'Monitor for any connection failures',
      ],
      estimatedTime: '10 minutes',
      riskLevel: 'medium',
      reasoning: 'Legitimate application traffic uses only specific subnets. NSG flow logs confirm no traffic from other subnets in /16 range.',
    },
  },
  {
    id: 'violation-003',
    provider: 'gcp',
    resourceType: 'firewall_policy',
    resourceName: 'dev-allow-all',
    resourceId: 'projects/project-123/global/firewalls/dev-allow-all',
    region: 'us-central1',
    accountId: 'project-123',
    violationType: 'overly_permissive',
    severity: 'high',
    description: 'Development firewall rule allows all protocols from anywhere',
    detectedAt: '2024-01-19T10:00:00Z',
    affectedRules: [
      {
        ruleId: 'fw-rule-001',
        ruleName: 'dev-allow-all',
        protocol: 'all',
        sourceRange: '0.0.0.0/0',
        destinationRange: '10.10.0.0/16',
        portRange: 'all',
        action: 'allow',
        issue: 'Permits any protocol/port from internet to dev environment',
      },
    ],
    baselineViolation: {
      baselineName: 'GCP Network Security Baseline',
      requirement: 'Development environments must follow principle of least privilege',
      expectedValue: 'Specific protocols and ports only',
        actualValue: 'all/all from 0.0.0.0/0',
      complianceFramework: ['GCP CIS 3.7', 'GDPR Article 32'],
    },
    aiRemediation: {
      autoRemediationPossible: false,
      manualSteps: [
        'Audit actual development usage patterns',
        'Create specific rules for SSH (22), HTTP (80), HTTPS (443)',
        'Restrict sources to developer VPN range',
        'Remove overly permissive rule after validation',
      ],
      estimatedTime: '30 minutes',
      riskLevel: 'high',
      reasoning: 'Development environment may have legitimate need for various protocols. Manual review required to avoid breaking developer workflows.',
    },
  },
];

// Expired Whitelists Data
export const expiredWhitelists: ExpiredWhitelist[] = [
  {
    id: 'expired-001',
    ticketId: 'INC0012345',
    ruleName: 'Temp-Partner-API-Access',
    firewallName: 'PA-DC-FW-01',
    firewallId: 'pa-fw-001',
    location: 'us-east-1',
    sourceIp: '203.0.113.50',
    destinationIp: '10.100.50.100',
    port: '8443',
    protocol: 'tcp',
    createdAt: '2023-10-01T09:00:00Z',
    expiresAt: '2023-12-31T23:59:59Z',
    status: 'expired',
    daysOverdue: 19,
    requestedBy: 'john.doe@company.com',
    businessJustification: 'Temporary API access for Partner XYZ integration testing',
    autoRemovalPossible: true,
    removalRisk: 'low',
    aiAnalysis: {
      stillInUse: false,
      lastUsed: '2023-11-15T14:30:00Z',
      usageCount: 47,
      removalImpact: 'No traffic detected in last 65 days. Safe to remove.',
      recommendation: 'Auto-remove: No recent usage, project completed, expired 19 days ago.',
    },
  },
  {
    id: 'expired-002',
    ticketId: 'CHG0034567',
    ruleName: 'Q4-Vendor-FTP-Access',
    firewallName: 'ASA-BRANCH-01',
    firewallId: 'asa-001',
    location: 'us-west-2',
    sourceIp: '198.51.100.0/24',
    destinationIp: '172.16.20.50',
    port: '21',
    protocol: 'tcp',
    createdAt: '2023-09-01T00:00:00Z',
    expiresAt: '2023-12-31T23:59:59Z',
    status: 'expired',
    daysOverdue: 19,
    requestedBy: 'finance@company.com',
    businessJustification: 'Q4 financial data transfer to external auditor',
    autoRemovalPossible: false,
    removalRisk: 'medium',
    aiAnalysis: {
      stillInUse: true,
      lastUsed: '2024-01-18T08:00:00Z',
      usageCount: 234,
      removalImpact: 'Active usage detected. Recent connection 1 day ago. May impact ongoing operations.',
      recommendation: 'Manual review required: Rule expired but still actively used. Contact requester to extend or find alternative.',
    },
  },
  {
    id: 'expired-003',
    ticketId: 'INC0045678',
    ruleName: 'Emergency-Support-Access',
    firewallName: 'FGT-DMZ-01',
    firewallId: 'fgt-001',
    location: 'eu-west-1',
    sourceIp: '192.0.2.100',
    destinationIp: '10.50.100.200',
    port: '22',
    protocol: 'tcp',
    createdAt: '2024-01-10T18:00:00Z',
    expiresAt: '2024-01-17T18:00:00Z',
    status: 'expired',
    daysOverdue: 2,
    requestedBy: 'ops-team@company.com',
    businessJustification: 'Emergency SSH access for critical incident resolution',
    autoRemovalPossible: true,
    removalRisk: 'low',
    aiAnalysis: {
      stillInUse: false,
      lastUsed: '2024-01-12T20:15:00Z',
      usageCount: 8,
      removalImpact: 'Incident resolved. No usage in last 7 days. Safe to remove.',
      recommendation: 'Auto-remove: Emergency access no longer needed, incident closed.',
    },
  },
  {
    id: 'expiring-001',
    ticketId: 'CHG0056789',
    ruleName: 'Contractor-Remote-Access',
    firewallName: 'CP-HQ-FW-01',
    firewallId: 'cp-001',
    location: 'us-east-2',
    sourceIp: '203.0.113.0/24',
    destinationIp: '10.200.50.0/24',
    port: '443',
    protocol: 'tcp',
    createdAt: '2023-12-01T00:00:00Z',
    expiresAt: '2024-01-31T23:59:59Z',
    status: 'expiring_soon',
    daysOverdue: 0,
    requestedBy: 'hr@company.com',
    businessJustification: 'Contractor access for Q4 project work',
    autoRemovalPossible: true,
    removalRisk: 'low',
    aiAnalysis: {
      stillInUse: true,
      lastUsed: '2024-01-19T11:00:00Z',
      usageCount: 567,
      removalImpact: 'Expires in 12 days. Currently active. Consider extension if contractor still working.',
      recommendation: 'Notify requester: Rule expires soon. Extend if contractor engagement continues.',
    },
  },
];

// Unpatched Firewalls Data
export const unpatchedFirewalls: UnpatchedFirewall[] = [
  {
    id: 'unpatched-001',
    firewallName: 'PA-DC-FW-01',
    firewallId: 'pa-fw-001',
    vendor: 'palo_alto',
    location: 'us-east-1',
    currentVersion: '10.1.9',
    latestVersion: '10.1.14',
    patchStatus: 'critical',
    daysOutdated: 45,
    vulnerabilities: [
      {
        cveId: 'CVE-2023-12345',
        severity: 'critical',
        description: 'Remote code execution in management interface',
        exploitAvailable: true,
        patchedInVersion: '10.1.10',
        published: '2023-12-01',
      },
      {
        cveId: 'CVE-2023-54321',
        severity: 'high',
        description: 'Authentication bypass in web UI',
        exploitAvailable: false,
        patchedInVersion: '10.1.12',
        published: '2023-12-15',
      },
    ],
    maintenanceWindow: '2024-01-27T02:00:00Z',
    autoUpdateSupported: true,
    updateRisk: 'low',
    affectedServices: ['Production Web Traffic', 'API Gateway'],
    complianceImpact: ['PCI-DSS 6.2', 'SOC2 CC7.1', 'ISO 27001 A.12.6.1'],
  },
  {
    id: 'unpatched-002',
    firewallName: 'ASA-BRANCH-01',
    firewallId: 'asa-001',
    vendor: 'cisco_asa',
    location: 'us-west-2',
    currentVersion: '9.16.3',
    latestVersion: '9.16.5',
    patchStatus: 'high_priority',
    daysOutdated: 30,
    vulnerabilities: [
      {
        cveId: 'CVE-2024-11111',
        severity: 'high',
        description: 'Denial of service in VPN subsystem',
        exploitAvailable: false,
        patchedInVersion: '9.16.4',
        published: '2024-01-05',
      },
    ],
    maintenanceWindow: null,
    autoUpdateSupported: false,
    updateRisk: 'medium',
    affectedServices: ['Branch Office VPN', 'Remote Access'],
    complianceImpact: ['CIS Cisco ASA 1.1.2'],
  },
  {
    id: 'unpatched-003',
    firewallName: 'FGT-DMZ-01',
    firewallId: 'fgt-001',
    vendor: 'fortinet',
    location: 'eu-west-1',
    currentVersion: '7.2.5',
    latestVersion: '7.2.6',
    patchStatus: 'normal',
    daysOutdated: 15,
    vulnerabilities: [
      {
        cveId: 'CVE-2024-22222',
        severity: 'medium',
        description: 'Information disclosure in logging subsystem',
        exploitAvailable: false,
        patchedInVersion: '7.2.6',
        published: '2024-01-10',
      },
    ],
    maintenanceWindow: '2024-02-10T01:00:00Z',
    autoUpdateSupported: true,
    updateRisk: 'low',
    affectedServices: ['DMZ Services', 'Public Web Servers'],
    complianceImpact: [],
  },
  {
    id: 'uptodate-001',
    firewallName: 'CP-HQ-FW-01',
    firewallId: 'cp-001',
    vendor: 'checkpoint',
    location: 'us-east-2',
    currentVersion: 'R81.20',
    latestVersion: 'R81.20',
    patchStatus: 'up_to_date',
    daysOutdated: 0,
    vulnerabilities: [],
    maintenanceWindow: null,
    autoUpdateSupported: true,
    updateRisk: 'low',
    affectedServices: [],
    complianceImpact: [],
  },
];

// Compliance Summary
export const complianceSummary: ComplianceSummary = {
  totalFirewalls: 12,
  firewallsWithDrift: 3,
  totalNSGViolations: 47,
  criticalViolations: 8,
  expiredWhitelists: 15,
  unpatchedFirewalls: 3,
  autoRemediationAvailable: 28,
  complianceScore: 78,
  byFramework: {
    'PCI-DSS': {
      score: 82,
      passed: 47,
      failed: 11,
      status: 'partial',
    },
    'SOC2': {
      score: 88,
      passed: 52,
      failed: 7,
      status: 'partial',
    },
    'CIS AWS': {
      score: 75,
      passed: 38,
      failed: 12,
      status: 'partial',
    },
    'NIST 800-53': {
      score: 91,
      passed: 64,
      failed: 6,
      status: 'compliant',
    },
    'ISO 27001': {
      score: 85,
      passed: 45,
      failed: 8,
      status: 'partial',
    },
  },
};

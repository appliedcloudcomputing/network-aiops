/**
 * Mock data for Conflict Detection Engine
 */

import type {
  FirewallRuleConflict,
  PolicyViolation,
  ConflictAnalysisMetrics,
  ConflictTrend,
  FirewallRuleStats,
  ConflictDetectionData,
} from '../types/conflictDetection';

export const conflictAnalysisMetrics: ConflictAnalysisMetrics = {
  totalRulesAnalyzed: 8247,
  totalConflictsDetected: 127,
  criticalConflicts: 8,
  highSeverityConflicts: 23,
  mediumSeverityConflicts: 48,
  lowSeverityConflicts: 48,
  resolvedConflicts: 89,
  activeConflicts: 38,
  falsePositives: 12,
  policyViolations: 15,
  averageResolutionTime: '4.2 hours',
  conflictsByType: {
    shadowing: 28,
    redundancy: 34,
    correlation: 15,
    generalization: 18,
    overlap: 22,
    contradiction: 5,
    policy_violation: 15,
  },
  firewallsCovered: 24,
  lastAnalysisTime: '2024-01-19T14:45:00Z',
};

export const ruleConflicts: FirewallRuleConflict[] = [
  {
    id: 'CONFLICT-001',
    type: 'shadowing',
    severity: 'critical',
    status: 'active',
    title: 'Production Database Access Rule Completely Shadowed',
    description: 'Critical database access rule (PROD-DB-ACCESS-001) is completely shadowed by earlier broad ANY-ANY rule, potentially blocking legitimate database traffic',
    detectedAt: '2024-01-19T10:23:15Z',
    rule1: {
      ruleId: 'FW-PROD-001',
      ruleName: 'Allow-Internal-Any',
      firewall: 'PA-FW-PROD-01',
      zone: 'trust-to-dmz',
      priority: 100,
      action: 'allow',
      source: '10.0.0.0/8',
      destination: 'any',
      service: 'any',
      enabled: true,
      createdAt: '2023-08-15T09:00:00Z',
      lastModified: '2023-08-15T09:00:00Z',
      owner: 'legacy-migration@company.com',
    },
    rule2: {
      ruleId: 'FW-PROD-125',
      ruleName: 'PROD-DB-ACCESS-001',
      firewall: 'PA-FW-PROD-01',
      zone: 'trust-to-dmz',
      priority: 125,
      action: 'allow',
      source: '10.50.0.0/24',
      destination: '172.16.10.0/24',
      service: 'tcp/3306,tcp/5432',
      application: 'mysql,postgresql',
      enabled: true,
      createdAt: '2024-01-10T14:20:00Z',
      lastModified: '2024-01-10T14:20:00Z',
      owner: 'database-team@company.com',
    },
    evidence: [
      {
        description: 'Rule FW-PROD-001 at priority 100 matches all traffic that FW-PROD-125 at priority 125 would match',
        technicalDetail: 'FW-PROD-001 (10.0.0.0/8 → any:any) is a superset of FW-PROD-125 (10.50.0.0/24 → 172.16.10.0/24:tcp/3306,5432)',
        trafficExample: 'Traffic from 10.50.0.15:54321 → 172.16.10.5:3306 matches FW-PROD-001 and never reaches FW-PROD-125',
        riskScore: 95,
      },
      {
        description: 'FW-PROD-125 has never processed any traffic since creation (0 hit count)',
        technicalDetail: 'Database team believes this rule is active, but monitoring shows zero hits in 9 days',
        riskScore: 90,
      },
      {
        description: 'Security policy requires specific database access control with application-level inspection',
        technicalDetail: 'FW-PROD-001 uses "any" service without application filtering, bypassing required database security controls',
        riskScore: 88,
      },
    ],
    impact: {
      securityRisk: 'high',
      performanceImpact: 'low',
      complianceViolation: true,
      affectedTraffic: 'All database traffic from application tier (10.50.0.0/24) to database tier (172.16.10.0/24)',
      estimatedHitCount: 145000,
      potentialDataExposure: true,
    },
    resolutionOptions: [
      {
        id: 'RES-001-A',
        strategy: 'reorder',
        title: 'Move Specific Rule Before Broad Rule (Recommended)',
        description: 'Change rule priority to place FW-PROD-125 (priority 125 → 99) before FW-PROD-001 (priority 100)',
        steps: [
          'Backup current firewall configuration',
          'Change FW-PROD-125 priority from 125 to 99',
          'Commit and verify rule order in policy',
          'Monitor traffic for 24 hours to confirm expected behavior',
          'Update documentation with new rule order',
        ],
        affectedRules: ['FW-PROD-001', 'FW-PROD-125'],
        automationAvailable: true,
        riskLevel: 'low',
        estimatedEffort: '30 minutes',
        recommendationScore: 95,
        rollbackPlan: 'Revert priority to 125 if issues detected',
      },
      {
        id: 'RES-001-B',
        strategy: 'modify',
        title: 'Narrow Scope of Broad Rule',
        description: 'Modify FW-PROD-001 to exclude database subnet (172.16.10.0/24) from destination',
        steps: [
          'Create address object "DB-Exclude" for 172.16.10.0/24',
          'Modify FW-PROD-001 destination to exclude DB subnet',
          'Test with non-database traffic to verify functionality',
          'Verify FW-PROD-125 now processes database traffic',
          'Update change management documentation',
        ],
        affectedRules: ['FW-PROD-001'],
        automationAvailable: false,
        riskLevel: 'medium',
        estimatedEffort: '1 hour',
        recommendationScore: 78,
        rollbackPlan: 'Restore FW-PROD-001 to original "any" destination',
      },
      {
        id: 'RES-001-C',
        strategy: 'remove',
        title: 'Remove Legacy Broad Rule (High Risk)',
        description: 'Delete FW-PROD-001 as it was a temporary migration rule from 2023',
        steps: [
          'Analyze all traffic currently hitting FW-PROD-001',
          'Create specific rules for each legitimate traffic pattern',
          'Test new rules in staging environment',
          'Disable (not delete) FW-PROD-001 for 7-day monitoring period',
          'Permanently delete if no issues detected',
        ],
        affectedRules: ['FW-PROD-001'],
        automationAvailable: false,
        riskLevel: 'high',
        estimatedEffort: '4 hours',
        recommendationScore: 65,
        rollbackPlan: 'Re-enable FW-PROD-001 immediately if traffic breaks',
      },
    ],
    similarConflicts: ['CONFLICT-007', 'CONFLICT-012'],
    tags: ['critical', 'shadowing', 'database', 'compliance', 'production'],
    assignedTo: 'security-team@company.com',
  },
  {
    id: 'CONFLICT-002',
    type: 'redundancy',
    severity: 'high',
    status: 'active',
    title: 'Duplicate SSH Access Rules Creating Management Overhead',
    description: 'Three nearly identical SSH access rules exist for the same source/destination, causing unnecessary policy bloat and maintenance complexity',
    detectedAt: '2024-01-19T09:15:30Z',
    rule1: {
      ruleId: 'FW-MGMT-042',
      ruleName: 'SSH-Mgmt-Access-v1',
      firewall: 'PA-FW-MGMT-01',
      zone: 'mgmt-to-servers',
      priority: 200,
      action: 'allow',
      source: '10.100.0.0/24',
      destination: '10.200.0.0/16',
      service: 'tcp/22',
      application: 'ssh',
      enabled: true,
      createdAt: '2023-06-12T10:00:00Z',
      lastModified: '2023-06-12T10:00:00Z',
      owner: 'ops-team@company.com',
    },
    rule2: {
      ruleId: 'FW-MGMT-087',
      ruleName: 'SSH-Admin-Access',
      firewall: 'PA-FW-MGMT-01',
      zone: 'mgmt-to-servers',
      priority: 201,
      action: 'allow',
      source: '10.100.0.0/24',
      destination: '10.200.0.0/16',
      service: 'tcp/22',
      enabled: true,
      createdAt: '2023-09-23T14:30:00Z',
      lastModified: '2023-09-23T14:30:00Z',
      owner: 'admin-team@company.com',
    },
    evidence: [
      {
        description: 'Rules FW-MGMT-042 and FW-MGMT-087 have identical match criteria',
        technicalDetail: 'Both rules match source 10.100.0.0/24, destination 10.200.0.0/16, service tcp/22, action allow',
        trafficExample: 'SSH from 10.100.0.50:55123 → 10.200.5.10:22 matches FW-MGMT-042 and never reaches FW-MGMT-087',
        riskScore: 45,
      },
      {
        description: 'FW-MGMT-087 has 0 hit count in past 120 days',
        technicalDetail: 'All matching traffic is processed by FW-MGMT-042 (avg 2,340 hits/day), FW-MGMT-087 is unused',
        riskScore: 40,
      },
      {
        description: 'Third similar rule FW-MGMT-098 also exists with 99% overlap',
        technicalDetail: 'Total of 3 rules performing same function, increasing policy complexity',
        riskScore: 35,
      },
    ],
    impact: {
      securityRisk: 'low',
      performanceImpact: 'low',
      complianceViolation: false,
      affectedTraffic: 'SSH management traffic from jump hosts to server infrastructure',
      estimatedHitCount: 2340,
      potentialDataExposure: false,
    },
    resolutionOptions: [
      {
        id: 'RES-002-A',
        strategy: 'merge',
        title: 'Consolidate All SSH Rules Into Single Rule',
        description: 'Keep FW-MGMT-042, delete redundant FW-MGMT-087 and FW-MGMT-098',
        steps: [
          'Verify FW-MGMT-042 covers all required SSH access',
          'Update FW-MGMT-042 description to note consolidated rule',
          'Disable FW-MGMT-087 and FW-MGMT-098 for 7-day monitoring',
          'Permanently delete after confirmation',
          'Update firewall documentation',
        ],
        affectedRules: ['FW-MGMT-042', 'FW-MGMT-087', 'FW-MGMT-098'],
        automationAvailable: true,
        riskLevel: 'low',
        estimatedEffort: '20 minutes',
        recommendationScore: 92,
      },
    ],
    similarConflicts: ['CONFLICT-009', 'CONFLICT-015'],
    tags: ['redundancy', 'ssh', 'management', 'cleanup'],
    assignedTo: 'ops-team@company.com',
  },
  {
    id: 'CONFLICT-003',
    type: 'contradiction',
    severity: 'critical',
    status: 'active',
    title: 'Contradictory Allow/Deny Rules for Production API',
    description: 'Critical contradiction: Rule allows API traffic (priority 150) but later rule denies same traffic (priority 180), causing intermittent access issues',
    detectedAt: '2024-01-19T11:45:22Z',
    rule1: {
      ruleId: 'FW-API-023',
      ruleName: 'Allow-Partner-API-Access',
      firewall: 'PA-FW-EDGE-02',
      zone: 'untrust-to-dmz',
      priority: 150,
      action: 'allow',
      source: '203.0.113.0/24',
      destination: '198.51.100.50',
      service: 'tcp/443',
      application: 'web-browsing,ssl',
      enabled: true,
      createdAt: '2024-01-05T09:00:00Z',
      lastModified: '2024-01-05T09:00:00Z',
      owner: 'api-team@company.com',
    },
    rule2: {
      ruleId: 'FW-SEC-112',
      ruleName: 'Block-Untrusted-API-Access',
      firewall: 'PA-FW-EDGE-02',
      zone: 'untrust-to-dmz',
      priority: 180,
      action: 'deny',
      source: 'any',
      destination: '198.51.100.0/24',
      service: 'tcp/443',
      enabled: true,
      createdAt: '2024-01-12T16:30:00Z',
      lastModified: '2024-01-12T16:30:00Z',
      owner: 'security-team@company.com',
    },
    evidence: [
      {
        description: 'Allow rule at priority 150 is contradicted by deny rule at priority 180',
        technicalDetail: 'Traffic from 203.0.113.0/24 matches FW-API-023 (allow) first, but FW-SEC-112 (deny) could block if source is outside partner range',
        trafficExample: 'Traffic from 203.0.113.50:48932 → 198.51.100.50:443 allowed, but from 203.0.114.50 denied',
        riskScore: 92,
      },
      {
        description: 'Partner complaints of intermittent API access failures correlate with FW-SEC-112 deployment',
        technicalDetail: 'Support tickets increased 400% starting Jan 12 when FW-SEC-112 was added',
        riskScore: 88,
      },
      {
        description: 'FW-SEC-112 blocks legitimate traffic when partner IPs rotate outside 203.0.113.0/24',
        technicalDetail: 'Partner uses dynamic IP pool including 203.0.113.0/24 and 203.0.114.0/24',
        riskScore: 85,
      },
    ],
    impact: {
      securityRisk: 'medium',
      performanceImpact: 'low',
      complianceViolation: true,
      affectedTraffic: 'External partner API access to production endpoints',
      estimatedHitCount: 45000,
      potentialDataExposure: false,
    },
    resolutionOptions: [
      {
        id: 'RES-003-A',
        strategy: 'modify',
        title: 'Expand Allow Rule to Include All Partner IPs',
        description: 'Update FW-API-023 to include 203.0.114.0/24 in source',
        steps: [
          'Contact partner to confirm complete IP range',
          'Create address group "Partner-API-Sources"',
          'Add 203.0.113.0/24 and 203.0.114.0/24 to group',
          'Update FW-API-023 source to use address group',
          'Test with partner for 48 hours',
        ],
        affectedRules: ['FW-API-023'],
        automationAvailable: false,
        riskLevel: 'low',
        estimatedEffort: '45 minutes',
        recommendationScore: 94,
      },
      {
        id: 'RES-003-B',
        strategy: 'modify',
        title: 'Modify Deny Rule to Exclude API Subnet',
        description: 'Update FW-SEC-112 destination to exclude 198.51.100.50',
        steps: [
          'Create address object "API-Servers-Exclude"',
          'Modify FW-SEC-112 destination to exclude API servers',
          'Test deny rule still blocks unauthorized access',
          'Verify partner access restored',
          'Update security documentation',
        ],
        affectedRules: ['FW-SEC-112'],
        automationAvailable: false,
        riskLevel: 'medium',
        estimatedEffort: '1 hour',
        recommendationScore: 82,
      },
    ],
    similarConflicts: [],
    tags: ['critical', 'contradiction', 'api', 'partner', 'production-impact'],
    assignedTo: 'security-team@company.com',
  },
  {
    id: 'CONFLICT-004',
    type: 'generalization',
    severity: 'medium',
    status: 'active',
    title: 'Overly Broad Web Access Rule Can Be Optimized',
    description: 'General web access rule matches traffic better handled by more specific rules, reducing policy effectiveness',
    detectedAt: '2024-01-19T08:30:45Z',
    rule1: {
      ruleId: 'FW-WEB-001',
      ruleName: 'General-Web-Access',
      firewall: 'PA-FW-CORP-01',
      zone: 'trust-to-untrust',
      priority: 300,
      action: 'allow',
      source: '10.0.0.0/8',
      destination: 'any',
      service: 'tcp/80,tcp/443',
      enabled: true,
      createdAt: '2022-03-15T10:00:00Z',
      lastModified: '2022-03-15T10:00:00Z',
      owner: 'network-team@company.com',
    },
    rule2: {
      ruleId: 'FW-WEB-045',
      ruleName: 'Dev-Team-Web-Access',
      firewall: 'PA-FW-CORP-01',
      zone: 'trust-to-untrust',
      priority: 350,
      action: 'allow',
      source: '10.50.0.0/24',
      destination: 'any',
      service: 'tcp/80,tcp/443',
      application: 'web-browsing,ssl',
      enabled: true,
      createdAt: '2023-11-20T14:00:00Z',
      lastModified: '2023-11-20T14:00:00Z',
      owner: 'dev-team@company.com',
    },
    evidence: [
      {
        description: 'FW-WEB-001 generalizes FW-WEB-045 by matching all sources including dev team subnet',
        technicalDetail: 'FW-WEB-001 (10.0.0.0/8) is superset of FW-WEB-045 (10.50.0.0/24), making specific rule redundant',
        riskScore: 55,
      },
      {
        description: 'FW-WEB-045 intended for application-level inspection never triggers',
        technicalDetail: 'Dev team rule includes app-id filtering (web-browsing,ssl) but general rule processes traffic first',
        riskScore: 48,
      },
    ],
    impact: {
      securityRisk: 'medium',
      performanceImpact: 'low',
      complianceViolation: false,
      affectedTraffic: 'General internet web access from corporate network',
      estimatedHitCount: 125000,
      potentialDataExposure: false,
    },
    resolutionOptions: [
      {
        id: 'RES-004-A',
        strategy: 'split',
        title: 'Split General Rule to Exclude Specific Subnets',
        description: 'Create exception in FW-WEB-001 for subnets with specific rules',
        steps: [
          'Create address group "Web-Specific-Subnets"',
          'Add 10.50.0.0/24 and other specific subnets to group',
          'Modify FW-WEB-001 source to exclude specific subnets',
          'Verify specific rules now process their designated traffic',
        ],
        affectedRules: ['FW-WEB-001', 'FW-WEB-045'],
        automationAvailable: false,
        riskLevel: 'low',
        estimatedEffort: '45 minutes',
        recommendationScore: 75,
      },
    ],
    similarConflicts: ['CONFLICT-011', 'CONFLICT-018'],
    tags: ['generalization', 'web-access', 'optimization'],
  },
];

export const policyViolations: PolicyViolation[] = [
  {
    id: 'VIOLATION-001',
    policyName: 'Database Access Control Policy',
    violationType: 'Missing Application Filtering',
    severity: 'high',
    description: 'Database access rules must use application-level filtering (App-ID) to enforce protocol compliance',
    violatingRules: [
      {
        ruleId: 'FW-PROD-001',
        ruleName: 'Allow-Internal-Any',
        firewall: 'PA-FW-PROD-01',
        zone: 'trust-to-dmz',
        priority: 100,
        action: 'allow',
        source: '10.0.0.0/8',
        destination: 'any',
        service: 'any',
        enabled: true,
        createdAt: '2023-08-15T09:00:00Z',
        lastModified: '2023-08-15T09:00:00Z',
        owner: 'legacy-migration@company.com',
      },
    ],
    policyRequirement: 'All database traffic must specify application (mysql, postgresql, mssql-db) for deep packet inspection',
    detectedAt: '2024-01-19T10:23:15Z',
    complianceFramework: ['PCI-DSS 1.2.1', 'SOC2 CC6.6'],
    remediationRequired: true,
  },
  {
    id: 'VIOLATION-002',
    policyName: 'Default Deny Policy',
    violationType: 'Any-Any Allow Rule',
    severity: 'critical',
    description: 'Explicit "any-any-allow" rules violate zero trust security model and must be removed',
    violatingRules: [
      {
        ruleId: 'FW-PROD-001',
        ruleName: 'Allow-Internal-Any',
        firewall: 'PA-FW-PROD-01',
        zone: 'trust-to-dmz',
        priority: 100,
        action: 'allow',
        source: '10.0.0.0/8',
        destination: 'any',
        service: 'any',
        enabled: true,
        createdAt: '2023-08-15T09:00:00Z',
        lastModified: '2023-08-15T09:00:00Z',
        owner: 'legacy-migration@company.com',
      },
    ],
    policyRequirement: 'All rules must specify explicit source, destination, and service - no "any" values allowed',
    detectedAt: '2024-01-19T10:23:15Z',
    complianceFramework: ['NIST 800-53 SC-7', 'CIS Benchmark 1.1.4'],
    remediationRequired: true,
  },
  {
    id: 'VIOLATION-003',
    policyName: 'Change Management Policy',
    violationType: 'Untracked Rule Modification',
    severity: 'medium',
    description: 'Firewall rule modifications must reference change ticket, but no ticket found',
    violatingRules: [
      {
        ruleId: 'FW-SEC-112',
        ruleName: 'Block-Untrusted-API-Access',
        firewall: 'PA-FW-EDGE-02',
        zone: 'untrust-to-dmz',
        priority: 180,
        action: 'deny',
        source: 'any',
        destination: '198.51.100.0/24',
        service: 'tcp/443',
        enabled: true,
        createdAt: '2024-01-12T16:30:00Z',
        lastModified: '2024-01-12T16:30:00Z',
        owner: 'security-team@company.com',
      },
    ],
    policyRequirement: 'All firewall changes must include change ticket number in rule description',
    detectedAt: '2024-01-19T11:45:22Z',
    complianceFramework: ['ITIL Change Management'],
    remediationRequired: false,
  },
];

export const conflictTrends: ConflictTrend[] = [
  { date: '2024-01-13', totalConflicts: 145, criticalConflicts: 12, resolvedConflicts: 8, newConflicts: 15 },
  { date: '2024-01-14', totalConflicts: 152, criticalConflicts: 14, resolvedConflicts: 6, newConflicts: 13 },
  { date: '2024-01-15', totalConflicts: 148, criticalConflicts: 13, resolvedConflicts: 11, newConflicts: 7 },
  { date: '2024-01-16', totalConflicts: 141, criticalConflicts: 10, resolvedConflicts: 15, newConflicts: 8 },
  { date: '2024-01-17', totalConflicts: 134, criticalConflicts: 9, resolvedConflicts: 12, newConflicts: 5 },
  { date: '2024-01-18', totalConflicts: 130, criticalConflicts: 8, resolvedConflicts: 9, newConflicts: 5 },
  { date: '2024-01-19', totalConflicts: 127, criticalConflicts: 8, resolvedConflicts: 7, newConflicts: 4 },
];

export const firewallStats: FirewallRuleStats[] = [
  {
    firewall: 'PA-FW-PROD-01',
    totalRules: 847,
    conflictingRules: 23,
    shadowedRules: 8,
    redundantRules: 12,
    unusedRules: 34,
    healthScore: 87,
  },
  {
    firewall: 'PA-FW-EDGE-02',
    totalRules: 623,
    conflictingRules: 15,
    shadowedRules: 5,
    redundantRules: 7,
    unusedRules: 28,
    healthScore: 91,
  },
  {
    firewall: 'PA-FW-CORP-01',
    totalRules: 1245,
    conflictingRules: 38,
    shadowedRules: 12,
    redundantRules: 18,
    unusedRules: 67,
    healthScore: 82,
  },
  {
    firewall: 'PA-FW-MGMT-01',
    totalRules: 345,
    conflictingRules: 9,
    shadowedRules: 3,
    redundantRules: 5,
    unusedRules: 15,
    healthScore: 94,
  },
  {
    firewall: 'ASA-FW-DC1',
    totalRules: 2134,
    conflictingRules: 67,
    shadowedRules: 24,
    redundantRules: 31,
    unusedRules: 189,
    healthScore: 68,
  },
  {
    firewall: 'ASA-FW-DC2',
    totalRules: 2087,
    conflictingRules: 62,
    shadowedRules: 21,
    redundantRules: 28,
    unusedRules: 175,
    healthScore: 71,
  },
];

export const conflictDetectionData: ConflictDetectionData = {
  conflicts: ruleConflicts,
  policyViolations,
  metrics: conflictAnalysisMetrics,
  trends: conflictTrends,
  firewallStats,
  lastUpdated: '2024-01-19T14:45:00Z',
};

{
  "metadata": {
    "dataset": "Multi-Platform Firewall Rules",
    "platform": "Azure NSG",
    "total_rules": 115,
    "description": "Azure Network Security Group rules with ASG references across production and development environments",
    "generated_date": "2026-01-13"
  },
  "azure_nsg_rules": [
    {"rule_name": "Allow-HTTPS-Internet-Inbound", "priority": 100, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-webapp-servers", "port": "443", "source": "Internet", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-HTTP-Internet-Inbound", "priority": 110, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-webapp-servers", "port": "80", "source": "Internet", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-AppGW-Health-Probe", "priority": 120, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "65200-65535", "source": "GatewayManager", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-VPN-SSH", "priority": 130, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "22", "source": "10.100.0.0/16", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-Bastion-SSH", "priority": 140, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "22", "source": "10.20.1.0/24", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-LB-Health-Probe", "priority": 150, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "AzureLoadBalancer", "destination": "*"},
    {"rule_name": "Allow-Prometheus-Scrape", "priority": 160, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-monitoring-servers", "destination_asg": null, "port": "9100", "source": null, "destination": "VirtualNetwork"},
    {"rule_name": "Allow-API-Internal", "priority": 170, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": "asg-webapp-servers", "port": "8080", "source": null, "destination": null},
    {"rule_name": "Deny-SSH-Internet-Inbound", "priority": 4091, "direction": "Inbound", "access": "Deny", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "22", "source": "Internet", "destination": "*"},
    {"rule_name": "Deny-RDP-Internet-Inbound", "priority": 4092, "direction": "Inbound", "access": "Deny", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "3389", "source": "Internet", "destination": "*"},
    {"rule_name": "Allow-HTTPS-Outbound", "priority": 100, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "Internet"},
    {"rule_name": "Allow-SQL-to-Database", "priority": 110, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": "asg-database-servers", "port": "5432", "source": null, "destination": null},
    {"rule_name": "Allow-Redis-to-Cache", "priority": 120, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "6379", "source": "VirtualNetwork", "destination": "10.35.0.0/24"},
    {"rule_name": "Allow-Storage-Outbound", "priority": 130, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "Storage"},
    {"rule_name": "Allow-AzureMonitor-Outbound", "priority": 140, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureMonitor"},
    {"rule_name": "Allow-DNS-Outbound", "priority": 200, "direction": "Outbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "53", "source": "VirtualNetwork", "destination": "168.63.129.16"},
    {"rule_name": "Allow-WebApp-to-SQL", "priority": 100, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": "asg-database-servers", "port": "5432", "source": null, "destination": null},
    {"rule_name": "Allow-API-to-SQL", "priority": 110, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": "asg-database-servers", "port": "5432", "source": null, "destination": null},
    {"rule_name": "Allow-Analytics-to-SQL", "priority": 120, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-analytics-servers", "destination_asg": "asg-database-servers", "port": "5432", "source": null, "destination": null},
    {"rule_name": "Allow-Bastion-to-DB-SSH", "priority": 130, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-database-servers", "port": "22", "source": "10.20.1.0/24", "destination": null},
    {"rule_name": "Allow-Prometheus-to-DB", "priority": 140, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-monitoring-servers", "destination_asg": "asg-database-servers", "port": "9100", "source": null, "destination": null},
    {"rule_name": "Deny-All-Internet-to-DB", "priority": 4096, "direction": "Inbound", "access": "Deny", "protocol": "*", "source_asg": null, "destination_asg": "asg-database-servers", "port": "*", "source": "Internet", "destination": null},
    {"rule_name": "Allow-Storage-Backup-DB", "priority": 100, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-database-servers", "destination_asg": null, "port": "443", "source": null, "destination": "Storage"},
    {"rule_name": "Allow-DR-Replication", "priority": 110, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-database-servers", "destination_asg": null, "port": "5432", "source": null, "destination": "10.120.0.0/16"},
    {"rule_name": "Allow-KeyVault-Access-DB", "priority": 120, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-database-servers", "destination_asg": null, "port": "443", "source": null, "destination": "AzureKeyVault"},
    {"rule_name": "Deny-Internet-Outbound-DB", "priority": 4096, "direction": "Outbound", "access": "Deny", "protocol": "*", "source_asg": "asg-database-servers", "destination_asg": null, "port": "*", "source": null, "destination": "Internet"},
    {"rule_name": "Allow-AKS-Node-Internal", "priority": 100, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": "asg-aks-nodes", "destination_asg": "asg-aks-nodes", "port": "*", "source": null, "destination": null},
    {"rule_name": "Allow-AKS-API-VPN", "priority": 110, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-aks-nodes", "port": "443", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-NodePort-Range", "priority": 120, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-aks-nodes", "port": "30000-32767", "source": "AzureLoadBalancer", "destination": null},
    {"rule_name": "Allow-Istio-Control-Plane", "priority": 130, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": "asg-aks-nodes", "port": "15010-15014", "source": null, "destination": null},
    {"rule_name": "Allow-Kiali-VPN", "priority": 140, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-aks-nodes", "port": "20001", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-Jaeger-VPN", "priority": 150, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-aks-nodes", "port": "16686", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-Prometheus-to-AKS", "priority": 160, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-monitoring-servers", "destination_asg": "asg-aks-nodes", "port": "9100", "source": null, "destination": null},
    {"rule_name": "Allow-Bastion-to-AKS-SSH", "priority": 170, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-aks-nodes", "port": "22", "source": "10.20.1.0/24", "destination": null},
    {"rule_name": "Allow-ACR-Outbound", "priority": 100, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": null, "port": "443", "source": null, "destination": "AzureContainerRegistry"},
    {"rule_name": "Allow-HTTPS-Outbound-AKS", "priority": 110, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": null, "port": "443", "source": null, "destination": "Internet"},
    {"rule_name": "Allow-Database-Access-AKS", "priority": 120, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": "asg-database-servers", "port": "5432", "source": null, "destination": null},
    {"rule_name": "Allow-Redis-Access-AKS", "priority": 130, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": null, "port": "6379", "source": null, "destination": "10.35.0.0/24"},
    {"rule_name": "Allow-AzureMonitor-AKS", "priority": 140, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": null, "port": "443", "source": null, "destination": "AzureMonitor"},
    {"rule_name": "Allow-Bastion-Inbound", "priority": 100, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "Internet", "destination": "*"},
    {"rule_name": "Allow-GatewayManager-Bastion", "priority": 110, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "GatewayManager", "destination": "*"},
    {"rule_name": "Allow-AzureLB-Bastion", "priority": 120, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "AzureLoadBalancer", "destination": "*"},
    {"rule_name": "Allow-BastionHost-Comm", "priority": 130, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "8080,5701", "source": "VirtualNetwork", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-Bastion-SSH-RDP-Out", "priority": 100, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "22,3389", "source": "*", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-AzureCloud-Bastion", "priority": 110, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "*", "destination": "AzureCloud"},
    {"rule_name": "Allow-Grafana-VPN", "priority": 100, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-monitoring-servers", "port": "3000", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-Prometheus-VPN", "priority": 110, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-monitoring-servers", "port": "9090", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-Alertmanager-VPN", "priority": 120, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-monitoring-servers", "port": "9093", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-Metrics-Push", "priority": 130, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-monitoring-servers", "port": "9091", "source": "VirtualNetwork", "destination": null},
    {"rule_name": "Allow-Node-Exporter", "priority": 140, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-monitoring-servers", "port": "9100", "source": "VirtualNetwork", "destination": null},
    {"rule_name": "Allow-Bastion-SSH-Mon", "priority": 150, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-monitoring-servers", "port": "22", "source": "10.20.1.0/24", "destination": null},
    {"rule_name": "Allow-Prometheus-Scrape-All", "priority": 100, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-monitoring-servers", "destination_asg": null, "port": "9100", "source": null, "destination": "VirtualNetwork"},
    {"rule_name": "Allow-HTTPS-Mon-Out", "priority": 110, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-monitoring-servers", "destination_asg": null, "port": "443", "source": null, "destination": "Internet"},
    {"rule_name": "Allow-SMTP-Mon-Out", "priority": 120, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-monitoring-servers", "destination_asg": null, "port": "587", "source": null, "destination": "Internet"},
    {"rule_name": "Allow-CosmosDB-Inbound", "priority": 100, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": null, "port": "443", "source": null, "destination": "10.45.0.0/24"},
    {"rule_name": "Allow-CosmosDB-MongoDB", "priority": 110, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": null, "port": "10255", "source": null, "destination": "10.45.0.0/24"},
    {"rule_name": "Allow-ServiceBus-Inbound", "priority": 120, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "5671", "source": null, "destination": "ServiceBus"},
    {"rule_name": "Allow-EventHub-Inbound", "priority": 130, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "9093", "source": null, "destination": "EventHub"},
    {"rule_name": "Allow-SQL-MI-Inbound", "priority": 140, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": null, "port": "1433", "source": null, "destination": "10.42.0.0/24"},
    {"rule_name": "Allow-Redis-Enterprise", "priority": 150, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "10000-10001", "source": null, "destination": "10.35.0.0/24"},
    {"rule_name": "Allow-AppService-VNet", "priority": 160, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-webapp-servers", "port": "443", "source": "AppService", "destination": null},
    {"rule_name": "Allow-FunctionApp-VNet", "priority": 170, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-api-servers", "port": "443", "source": "AzureFunction", "destination": null},
    {"rule_name": "Allow-LogicApp-VNet", "priority": 180, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-api-servers", "port": "443", "source": "LogicApps", "destination": null},
    {"rule_name": "Allow-APIM-Inbound", "priority": 190, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "3443", "source": "ApiManagement", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-APIM-Gateway", "priority": 200, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "Internet", "destination": "10.25.0.0/24"},
    {"rule_name": "Allow-Synapse-Inbound", "priority": 210, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-analytics-servers", "destination_asg": null, "port": "1433", "source": null, "destination": "Sql"},
    {"rule_name": "Allow-DataFactory-Inbound", "priority": 220, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-database-servers", "port": "5432", "source": "DataFactory", "destination": null},
    {"rule_name": "Allow-Databricks-Cluster", "priority": 230, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": "asg-databricks-nodes", "destination_asg": "asg-databricks-nodes", "port": "*", "source": null, "destination": null},
    {"rule_name": "Allow-HDInsight-Mgmt", "priority": 240, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "HDInsight", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-BatchAI-Nodes", "priority": 250, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": "asg-batch-nodes", "destination_asg": "asg-batch-nodes", "port": "*", "source": null, "destination": null},
    {"rule_name": "Allow-ML-Workspace", "priority": 260, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "AzureMachineLearning", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-CognitiveServices", "priority": 270, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": null, "port": "443", "source": null, "destination": "CognitiveServicesManagement"},
    {"rule_name": "Allow-SignalR-Outbound", "priority": 280, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "443", "source": null, "destination": "AzureSignalR"},
    {"rule_name": "Allow-IoTHub-Outbound", "priority": 290, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-iot-devices", "destination_asg": null, "port": "8883", "source": null, "destination": "AzureIoTHub"},
    {"rule_name": "Allow-DevOps-Agent", "priority": 300, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-devops-agents", "destination_asg": null, "port": "443", "source": null, "destination": "AzureDevOps"},
    {"rule_name": "Allow-GitHub-Actions", "priority": 310, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-devops-agents", "port": "443", "source": "140.82.112.0/20", "destination": null},
    {"rule_name": "Allow-ContainerApps-Env", "priority": 320, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "Internet", "destination": "10.28.0.0/24"},
    {"rule_name": "Allow-AppConfig-Outbound", "priority": 330, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "443", "source": null, "destination": "AppConfiguration"},
    {"rule_name": "Allow-FrontDoor-Inbound", "priority": 340, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-webapp-servers", "port": "443", "source": "AzureFrontDoor.Backend", "destination": null},
    {"rule_name": "Allow-TrafficManager-Probe", "priority": 350, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-webapp-servers", "port": "443", "source": "AzureTrafficManager", "destination": null},
    {"rule_name": "Allow-PrivateLink-MySQL", "priority": 360, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-api-servers", "destination_asg": null, "port": "3306", "source": null, "destination": "10.43.0.0/24"},
    {"rule_name": "Allow-PrivateLink-Storage", "priority": 370, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "443", "source": null, "destination": "10.44.0.0/24"},
    {"rule_name": "Allow-ExpressRoute-GW", "priority": 380, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "172.16.0.0/12", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-VPN-Gateway", "priority": 390, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "192.168.0.0/16", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-P2S-VPN-Clients", "priority": 400, "direction": "Inbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "10.100.0.0/16", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-Defender-Scan", "priority": 410, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "SecurityCenter", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-Sentinel-Collection", "priority": 420, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureSentinel"},
    {"rule_name": "Allow-KeyVault-PrivateLink", "priority": 430, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "443", "source": null, "destination": "10.46.0.0/24"},
    {"rule_name": "Allow-ACR-PrivateLink", "priority": 440, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-aks-nodes", "destination_asg": null, "port": "443", "source": null, "destination": "10.47.0.0/24"},
    {"rule_name": "Deny-All-Inbound-Default", "priority": 4093, "direction": "Inbound", "access": "Deny", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "*", "destination": "*"},
    {"rule_name": "Allow-Backup-Outbound", "priority": 450, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureBackup"},
    {"rule_name": "Allow-SiteRecovery-Out", "priority": 460, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureSiteRecovery"},
    {"rule_name": "Allow-AzureAD-Auth", "priority": 470, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureActiveDirectory"},
    {"rule_name": "Allow-GuestConfig-Agent", "priority": 480, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "GuestAndHybridManagement"},
    {"rule_name": "Allow-UpdateManagement", "priority": 490, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureUpdateDelivery"},
    {"rule_name": "Allow-Automation-Webhook", "priority": 500, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "AzureAutomation", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-DevTestLabs-VMs", "priority": 510, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-devtest-vms", "port": "22,3389", "source": "10.100.0.0/16", "destination": null},
    {"rule_name": "Allow-SpringApps-Internal", "priority": 520, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443,1433,445", "source": "AzureSpringCloud", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-NetApp-Files", "priority": 530, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-webapp-servers", "destination_asg": null, "port": "2049", "source": null, "destination": "10.48.0.0/24"},
    {"rule_name": "Allow-AVD-HostPool", "priority": 540, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-avd-hosts", "port": "3389", "source": "WindowsVirtualDesktop", "destination": null},
    {"rule_name": "Allow-AVD-Broker-Out", "priority": 550, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-avd-hosts", "destination_asg": null, "port": "443", "source": null, "destination": "WindowsVirtualDesktop"},
    {"rule_name": "Allow-Purview-Scan", "priority": 560, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzurePurview"},
    {"rule_name": "Allow-DataExplorer", "priority": 570, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-analytics-servers", "destination_asg": null, "port": "443", "source": null, "destination": "AzureDataExplorerManagement"},
    {"rule_name": "Allow-MediaServices", "priority": 580, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": "asg-media-servers", "destination_asg": null, "port": "443", "source": null, "destination": "Media"},
    {"rule_name": "Allow-CDN-Origin", "priority": 590, "direction": "Inbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": "asg-webapp-servers", "port": "443", "source": "AzureCDN", "destination": null},
    {"rule_name": "Deny-Outbound-Default", "priority": 4094, "direction": "Outbound", "access": "Deny", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "*", "source": "*", "destination": "Internet"},
    {"rule_name": "Allow-DNS-Internal", "priority": 600, "direction": "Outbound", "access": "Allow", "protocol": "*", "source_asg": null, "destination_asg": null, "port": "53", "source": "VirtualNetwork", "destination": "10.200.1.0/24"},
    {"rule_name": "Allow-NTP-Outbound", "priority": 610, "direction": "Outbound", "access": "Allow", "protocol": "Udp", "source_asg": null, "destination_asg": null, "port": "123", "source": "VirtualNetwork", "destination": "*"},
    {"rule_name": "Allow-ICMP-Internal", "priority": 620, "direction": "Inbound", "access": "Allow", "protocol": "Icmp", "source_asg": null, "destination_asg": null, "port": "*", "source": "VirtualNetwork", "destination": "VirtualNetwork"},
    {"rule_name": "Allow-Arc-Servers", "priority": 630, "direction": "Outbound", "access": "Allow", "protocol": "Tcp", "source_asg": null, "destination_asg": null, "port": "443", "source": "VirtualNetwork", "destination": "AzureArcInfrastructure"}
  ]
}
